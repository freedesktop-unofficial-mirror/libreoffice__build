<pre class="java"><span style="color: #808080; font-style: italic;">/**
 * Highlighter implementation using the GeSHi algorithm adapted to OpenOffice.org API.
 * 
 * @author cbosdonnat
 */</span>
<span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #000000; font-weight: bold;">class</span> HighlighterImpl <span style="color: #000000; font-weight: bold;">extends</span> WeakBase <span style="color: #000000; font-weight: bold;">implements</span> XServiceInfo, XHighlighter <span style="color: #66cc66;">&#123;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;bntI=I%27m%20Feeling%20Lucky"><span style="color: #aaaadd; font-weight: bold;">String</span></a> IMPLEMENTATION_NAME = HighlighterImpl.<span style="color: #000000; font-weight: bold;">class</span>.<span style="color: #006600;">getName</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;bntI=I%27m%20Feeling%20Lucky"><span style="color: #aaaadd; font-weight: bold;">String</span></a><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> SERVICE_NAMES = <span style="color: #66cc66;">&#123;</span> <span style="color: #ff0000;">&quot;org.openoffice.coooder.Highlighter&quot;</span> <span style="color: #66cc66;">&#125;</span>;
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #993333;">int</span> OPEN = <span style="color: #cc66cc;">0</span>;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #993333;">int</span> CLOSE = <span style="color: #cc66cc;">1</span>;
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;bntI=I%27m%20Feeling%20Lucky"><span style="color: #aaaadd; font-weight: bold;">String</span></a> NUMBER_REGEX = <span style="color: #ff0000;">&quot;[-+]?<span style="color: #000099; font-weight: bold;">\\</span>b(?:[0-9]*<span style="color: #000099; font-weight: bold;">\\</span>.)?[0-9]+<span style="color: #000099; font-weight: bold;">\\</span>b&quot;</span>;
&nbsp;
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">final</span> XComponentContext mContext;
    <span style="color: #000000; font-weight: bold;">private</span> XLanguage mLanguage;
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> CompiledPatternsCache mPatternsCache;
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> XTextRange mSelectionStart;
    <span style="color: #000000; font-weight: bold;">private</span> XTextDocument mTextDocument;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #993333;">int</span> mLength;
&nbsp;
&nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> HighlighterImpl<span style="color: #66cc66;">&#40;</span>XComponentContext pContext<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
        mContext = pContext;
        mPatternsCache = <span style="color: #000000; font-weight: bold;">new</span> CompiledPatternsCache<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
    <span style="color: #66cc66;">&#125;</span>;
&nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">static</span> XSingleComponentFactory __getComponentFactory<span style="color: #66cc66;">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;bntI=I%27m%20Feeling%20Lucky"><span style="color: #aaaadd; font-weight: bold;">String</span></a> pImplementationName<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
        XSingleComponentFactory xFactory = <span style="color: #000000; font-weight: bold;">null</span>;
&nbsp;
        <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>pImplementationName.<span style="color: #006600;">equals</span><span style="color: #66cc66;">&#40;</span>IMPLEMENTATION_NAME<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
            xFactory = Factory.<span style="color: #006600;">createComponentFactory</span><span style="color: #66cc66;">&#40;</span>HighlighterImpl.<span style="color: #000000; font-weight: bold;">class</span>, SERVICE_NAMES<span style="color: #66cc66;">&#41;</span>;   
        <span style="color: #66cc66;">&#125;</span>
        <span style="color: #000000; font-weight: bold;">return</span> xFactory;
    <span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span></pre>