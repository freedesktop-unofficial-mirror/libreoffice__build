Win32-specific notes about testtool

The testtool.ini file is located in the user's Application Data folder
(typically below the profile directory). In the OOoProgramDir section
you need to set the Current value to the folder where OOo is installed
including a trailing backslash:

[OOoProgramDir]
Current=c:\Program Files\OpenOffice.org 2.0\
All=

The FindBuildID function in
qa/qatesttool/global/tools/inc/t_tools2.inc tries to look for a
"buildid" value in the OpenOffice.org installation's
program/bootstrap.ini. In current OOo, the buildid is actually in a
file called version.ini and not in bootstrap.ini. Sigh. You can either
edit qatesttool/global/tools/inc/t_tools2.inc to look in the [Version]
section in version.ini for buildid instead, or just hardcode an
assignment to sTemp in it before the place where it starts looking for
a buildID in the nonexisting iso*.res files. For instance, I did:

--- /tmp/qa/qatesttool/global/tools/inc/t_tools2.inc	Thu May 12 18:00:24 2005
+++ ../qa/qatesttool/global/tools/inc/t_tools2.inc	Fri Apr  7 03:35:41 2006
@@ -789,4 +789,7 @@
    end if
    
+   ' Sigh...
+   sTemp = "680m5(Build:9011)"
+
    ' fallback to get the buildID via isoxxx??.res part
    if (sTemp = "") then

For some reason you need to pass an extra parameter to soffice.exe for
it to accept UNO commands from testtool:

--- /tmp/qa/qatesttool/global/system/inc/master.inc	Tue Apr 26 20:01:54 2005
+++ ../qa/qatesttool/global/system/inc/master.inc	Fri Apr  7 15:04:27 2006
@@ -311,5 +311,5 @@
             sParameter = "-env:RTL_LOGFILE=" + sProfPath + sProfParameter
             'Running soffice WITH CRASHREPORTER:
-            Start sAppExe, "-enableautomation -norestore -nolockcheck -autocrashreport " & sAppParameter & " " & sParameter & " " & sFactory
+            Start sAppExe, "-enableautomation -accept=socket,host=localhost,port=1035;urp -norestore -nolockcheck -autocrashreport " & sAppParameter & " " & sParameter & " " & sFactory
         else
             'Running soffice WITH CRASHREPORTER:

If you don't do the above, testtool won't be able to control OOo
through UNO, only through the TT connection. This means that for
instance controlling the Path options in Tools>Options and file open
and save dialogs will fail.
