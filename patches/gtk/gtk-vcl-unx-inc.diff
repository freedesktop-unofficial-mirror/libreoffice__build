Index: vcl/unx/inc/dtint.hxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/dtint.hxx,v
retrieving revision 1.8
retrieving revision 1.7.2.2
diff -u -p -u -r1.8 -r1.7.2.2
--- vcl/unx/inc/dtint.hxx	6 Jan 2004 14:23:15 -0000	1.8
+++ vcl/unx/inc/dtint.hxx	21 Jan 2004 20:32:18 -0000	1.7.2.2
@@ -114,17 +114,6 @@ protected:
 
 	static DtIntegratorList	aIntegratorList;
 	static String			aHomeDir;
-
-    // executes pCommand and parses its output
-    // to get system look information
-    // different DtIntegrators can rely
-    // on native programs to query system settings
-    // pass NULL as command to read the VCL_SYSTEM_SETTINGS property
-    void GetSystemLook( const char* pCommand, AllSettings& rSettings );
-    bool StartSystemLookProcess( const char* pCommand );
-
-    Color parseColor( const ByteString& );
-    Font parseFont( const ByteString& );
 
 public:
 	static DtIntegrator* CreateDtIntegrator();
Index: vcl/unx/inc/gnomeint.hxx
===================================================================
RCS file: vcl/unx/inc/gnomeint.hxx
diff -N vcl/unx/inc/gnomeint.hxx
--- vcl/unx/inc/gnomeint.hxx	18 Nov 2003 14:36:03 -0000	1.2
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,80 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile$
- *
- *  $Revision$
- *
- *  last change: $Author$ $Date$
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-#ifndef _SV_GNOMEINT_HXX
-#define _SV_GNOMEINT_HXX
-
-#ifndef _SV_DTINT_HXX
-#include <dtint.hxx>
-#endif
-
-class GNOMEIntegrator : public DtIntegrator
-{
-	friend DtIntegrator* DtIntegrator::CreateDtIntegrator();
-private:
-	GNOMEIntegrator();
-
-public:
-	virtual ~GNOMEIntegrator();
-
-	virtual void GetSystemLook( AllSettings& rSettings );
-};
-
-#endif
Index: vcl/unx/inc/pspgraphics.h
===================================================================
RCS file: vcl/unx/inc/pspgraphics.h
diff -N vcl/unx/inc/pspgraphics.h
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/pspgraphics.h	22 Jan 2004 12:09:27 -0000	1.1.2.2
@@ -0,0 +1,218 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_PSPGRAPHICS_H
+#define _VCL_PSPGRAPHICS_H
+
+
+#ifndef _SV_SALGDI_HXX
+#include <salgdi.hxx>
+#endif
+#ifndef _PSPRINT_FONTMANAGER_HXX
+#include <psprint/fontmanager.hxx>
+#endif
+#ifndef _SV_SALLAYOUT_HXX
+#include <sallayout.hxx>
+#endif
+
+#ifndef _USE_PRINT_EXTENSION_
+namespace psp { struct JobData; class PrinterGfx; }
+#endif
+
+class ServerFont;
+
+class PspGraphics : public SalGraphics
+{
+    psp::JobData*				m_pJobData;
+    psp::PrinterGfx*			m_pPrinterGfx;
+    String*						m_pPhoneNr;
+    bool						m_bSwallowFaxNo;
+
+    ServerFont*					m_pServerFont[ MAX_FALLBACK ];
+    bool						m_bFontVertical;
+public:
+    PspGraphics( psp::JobData* pJob, psp::PrinterGfx* pGfx, String* pPhone = NULL, bool bSwallow = false )
+            : m_pJobData( pJob ),
+              m_pPrinterGfx( pGfx ),
+              m_pPhoneNr( pPhone ),
+              m_bSwallowFaxNo( bSwallow ),
+              m_bFontVertical( false )
+    { for( int i = 0; i < MAX_FALLBACK; i++ ) m_pServerFont[i] = 0; }
+    virtual ~PspGraphics();
+
+    String            FaxPhoneComment( const String& rOrig, xub_StrLen nIndex, xub_StrLen& rLen, xub_StrLen& rCutStart, xub_StrLen& rCutStop ) const;
+
+    // helper methods for sharing with X11SalGraphics
+    static bool DoCreateFontSubset( const rtl::OUString& rToFile,
+                                    psp::fontID aFont,
+                                    long* pGlyphIDs,
+                                    sal_uInt8* pEncoding,
+                                    sal_Int32* pWidths,
+                                    int nGlyphs,
+                                    FontSubsetInfo& rInfo );
+    static const void* DoGetEmbedFontData( psp::fontID aFont, const sal_Unicode* pUnicodes, sal_Int32* pWidths, FontSubsetInfo& rInfo, long* pDataLen );
+    static void DoFreeEmbedFontData( const void* pData, long nLen );
+    static const std::map< sal_Unicode, sal_Int32 >* DoGetFontEncodingVector( psp::fontID aFont, const std::map< sal_Unicode, rtl::OString >** pNonEncoded );
+    static void SetImplFontData( const psp::FastPrintFontInfo& aInfo, ImplFontData& rData );
+    static FontWidth	ToFontWidth (psp::width::type eWidth);
+    static FontWeight	ToFontWeight (psp::weight::type eWeight);
+    static FontPitch	ToFontPitch (psp::pitch::type ePitch);
+    static FontItalic	ToFontItalic (psp::italic::type eItalic);
+    static FontFamily	ToFontFamily (psp::family::type eFamily);
+
+    // overload all pure virtual methods
+    virtual void			GetResolution( long& rDPIX, long& rDPIY );
+    virtual void			GetScreenFontResolution( long& rDPIX, long& rDPIY );
+    virtual USHORT			GetBitCount();
+    virtual long			GetGraphicsWidth();
+
+    virtual void			ResetClipRegion();
+    virtual void			BeginSetClipRegion( ULONG nCount );
+    virtual BOOL			unionClipRegion( long nX, long nY, long nWidth, long nHeight );
+    virtual void			EndSetClipRegion();
+
+    virtual void			SetLineColor();
+    virtual void			SetLineColor( SalColor nSalColor );
+    virtual void			SetFillColor();
+
+    virtual void          	SetFillColor( SalColor nSalColor );
+
+    virtual void			SetXORMode( BOOL bSet );
+
+    virtual void			SetROPLineColor( SalROPColor nROPColor );
+    virtual void			SetROPFillColor( SalROPColor nROPColor );
+
+    virtual void			SetTextColor( SalColor nSalColor );
+    virtual USHORT         SetFont( ImplFontSelectData*, int nFallbackLevel );
+    virtual void			GetFontMetric( ImplFontMetricData* );
+    virtual ULONG			GetKernPairs( ULONG nPairs, ImplKernPairData* pKernPairs );
+    virtual ULONG			GetFontCodeRanges( sal_uInt32* pCodePairs ) const;
+    virtual void			GetDevFontList( ImplDevFontList* );
+    virtual void			GetDevFontSubstList( OutputDevice* );
+    virtual ImplFontData*	AddTempDevFont( const String& rFileURL, const String& rFontName );
+    virtual BOOL			CreateFontSubset( const rtl::OUString& rToFile,
+                                              ImplFontData* pFont,
+                                              long* pGlyphIDs,
+                                              sal_uInt8* pEncoding,
+                                              sal_Int32* pWidths,
+                                              int nGlyphs,
+                                              FontSubsetInfo& rInfo
+                                              );
+    virtual const std::map< sal_Unicode, sal_Int32 >* GetFontEncodingVector( ImplFontData* pFont, const std::map< sal_Unicode, rtl::OString >** ppNonEncoded );
+    virtual const void*	GetEmbedFontData( ImplFontData* pFont,
+                                          const sal_Unicode* pUnicodes,
+                                          sal_Int32* pWidths,
+                                          FontSubsetInfo& rInfo,
+                                          long* pDataLen );
+    virtual void			FreeEmbedFontData( const void* pData, long nDataLen );
+    virtual BOOL			GetGlyphBoundRect( long nIndex, Rectangle& );
+    virtual BOOL			GetGlyphOutline( long nIndex, PolyPolygon& );
+    virtual SalLayout*		GetTextLayout( ImplLayoutArgs&, int nFallbackLevel );
+    virtual void			DrawServerFontLayout( const ServerFontLayout& );
+    virtual void			drawPixel( long nX, long nY );
+    virtual void			drawPixel( long nX, long nY, SalColor nSalColor );
+    virtual void			drawLine( long nX1, long nY1, long nX2, long nY2 );
+    virtual void			drawRect( long nX, long nY, long nWidth, long nHeight );
+    virtual void			drawPolyLine( ULONG nPoints, const SalPoint* pPtAry );
+    virtual void			drawPolygon( ULONG nPoints, const SalPoint* pPtAry );
+    virtual void			drawPolyPolygon( ULONG nPoly,
+                                             const ULONG* pPoints,
+                                             PCONSTSALPOINT* pPtAry );
+    virtual sal_Bool		drawPolyLineBezier( ULONG nPoints,
+                                                const SalPoint* pPtAry,
+                                                const BYTE* pFlgAry );
+    virtual sal_Bool		drawPolygonBezier( ULONG nPoints,
+                                               const SalPoint* pPtAry,
+                                               const BYTE* pFlgAry );
+    virtual sal_Bool		drawPolyPolygonBezier( ULONG nPoly,
+                                                   const ULONG* pPoints,
+                                                   const SalPoint* const* pPtAry,
+                                                   const BYTE* const* pFlgAry );
+    virtual void			copyArea( long nDestX,
+                                      long nDestY,
+                                      long nSrcX,
+                                      long nSrcY,
+                                      long nSrcWidth,
+                                      long nSrcHeight,
+                                      USHORT nFlags );
+    virtual void			copyBits( const SalTwoRect* pPosAry,
+                                      SalGraphics* pSrcGraphics );
+    virtual void			drawBitmap( const SalTwoRect* pPosAry,
+                                        const SalBitmap& rSalBitmap );
+    virtual void			drawBitmap( const SalTwoRect* pPosAry,
+                                        const SalBitmap& rSalBitmap,
+                                        SalColor nTransparentColor );
+    virtual void			drawBitmap( const SalTwoRect* pPosAry,
+                                        const SalBitmap& rSalBitmap,
+                                        const SalBitmap& rTransparentBitmap );
+    virtual void			drawMask( const SalTwoRect* pPosAry,
+                                      const SalBitmap& rSalBitmap,
+                                      SalColor nMaskColor );
+    virtual SalBitmap*		getBitmap( long nX, long nY, long nWidth, long nHeight );
+    virtual SalColor		getPixel( long nX, long nY );
+    virtual void			invert( long nX, long nY, long nWidth, long nHeight, SalInvert nFlags );
+    virtual void			invert( ULONG nPoints, const SalPoint* pPtAry, SalInvert nFlags );
+
+    virtual BOOL			drawEPS( long nX, long nY, long nWidth, long nHeight, void* pPtr, ULONG nSize );
+
+};
+
+#endif // _VCL_PSPGRAPHICS_H
Index: vcl/unx/inc/saldata.hxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/saldata.hxx,v
retrieving revision 1.7
retrieving revision 1.7.2.1
diff -u -p -u -r1.7 -r1.7.2.1
--- vcl/unx/inc/saldata.hxx	18 Nov 2003 14:37:21 -0000	1.7
+++ vcl/unx/inc/saldata.hxx	4 Dec 2003 14:49:43 -0000	1.7.2.1
@@ -85,11 +85,6 @@ class X11SalFrame;
 class SalPrinter;
 
 // -=-= typedefs -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-#ifndef SIG_PF
-typedef void SIG_FUNC_TYP(int);
-typedef SIG_FUNC_TYP *SIG_TYP;
-#define SIG_PF SIG_TYP
-#endif
 
 DECLARE_LIST( SalDisplays, SalDisplay* )
 
@@ -102,7 +97,7 @@ typedef	unsigned int pthread_t;
 // -=-= SalData =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 class SalData
 {
-			SIG_TYP				sig_[30];
+protected:
 			BOOL				bNoExceptions_;
 
 			SalXLib			   *pXLib_;
@@ -118,9 +113,9 @@ public:
 
 public:
 								SalData();
-								~SalData();
+			virtual			~SalData();
 	
-			void				Init();
+			virtual void		Init();
 
 			long				ShutDown() const;
 			long				Close() const;
@@ -148,6 +143,8 @@ public:
 	inline	void				StopTimer();
 	        void				Timeout() const;
 
+    static int XErrorHdl( Display*, XErrorEvent* );
+    static int XIOErrorHdl( Display* );
 };
 
 // -=-= inlines =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
@@ -171,7 +168,6 @@ inline void SalData::XError( Display *pD
 class YieldMutexReleaser
 {
 	ULONG				m_nYieldCount;
-	SalYieldMutex*		m_pSalInstYieldMutex;
 public:
 	inline YieldMutexReleaser();
 	inline ~YieldMutexReleaser();
@@ -179,30 +175,12 @@ public:
 
 inline YieldMutexReleaser::YieldMutexReleaser()
 {
-	SalData *pSalData		= GetSalData();
-	m_pSalInstYieldMutex	= static_cast<SalYieldMutex*>(pSalData->pInstance_->GetYieldMutex());
-
-    // release YieldMutex as often as acquired
-	ULONG i;
-	if ( m_pSalInstYieldMutex->GetThreadId() ==
-		 NAMESPACE_VOS(OThread)::getCurrentIdentifier() )
-	{
-		m_nYieldCount = m_pSalInstYieldMutex->GetAcquireCount();
-		for ( i = 0; i < m_nYieldCount; i++ )
-			m_pSalInstYieldMutex->release();
-	}
-	else
-		m_nYieldCount = 0;
+	m_nYieldCount = GetSalData()->pInstance_->ReleaseYieldMutex();
 }
 
 inline YieldMutexReleaser::~YieldMutexReleaser()
 {
-	// acquire YieldMutex again
-	while ( m_nYieldCount )
-	{
-		m_pSalInstYieldMutex->acquire();
-		m_nYieldCount--;
-	}
+    GetSalData()->pInstance_->AcquireYieldMutex( m_nYieldCount );
 }
 
 #endif // _SV_SALDATA_HXX
Index: vcl/unx/inc/saldisp.hxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/saldisp.hxx,v
retrieving revision 1.21
retrieving revision 1.19.2.9
diff -u -p -u -r1.21 -r1.19.2.9
--- vcl/unx/inc/saldisp.hxx	6 Jan 2004 14:24:12 -0000	1.21
+++ vcl/unx/inc/saldisp.hxx	21 Jan 2004 20:31:43 -0000	1.19.2.9
@@ -63,15 +63,10 @@
 #define _SV_SALDISP_HXX
 
 // -=-= exports =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-struct	SalAppXResource;
 class	SalDisplay;
 class	SalColormap;
-class	SalColormapRef;
-class	SalTrueColorConverter;
 class	SalVisual;
 class	SalXLib;
-class	SalImageList;
-class	SalBitmapList;
 
 // -=-= #includes =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 #ifndef _SALUNX_H
@@ -86,32 +81,25 @@ class	SalBitmapList;
 #ifndef _SAL_TYPES_H_
 #include <sal/types.h>
 #endif
-
+#ifndef _OSL_MUTEX_H
+#include <osl/mutex.h>
+#endif
 #include <vector>
+#include <list>
 #ifndef _GEN_HXX
 #include <tools/gen.hxx>
 #endif
+#ifndef _SV_SALWTYPE_HXX
+#include <salwtype.hxx>
+#endif
 
 // -=-= forwards -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 class	BitmapPalette;
-class	SalImage;
-class	SalBitmap;
 class	SalFrame;
 class	ColorMask;
-class	SalSystemData;
 
 namespace vcl_sal { class WMAdaptor; }
 
-#ifndef _XSHM_H_
-struct XShmSegmentInfo;
-#endif
-
-// -=-= typedefs -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-typedef struct _oslMutexImpl *oslThreadMutex;
-
-DECLARE_LIST( SalImageList, SalImage* )
-DECLARE_LIST( SalBitmapList,SalBitmap*)
-
 // -=-= #defines -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 #define PROPERTY_SUPPORT_WM_SetPos				0x00000001
 #define PROPERTY_SUPPORT_WM_Screen				0x00000002
@@ -208,8 +196,8 @@ public:
          	BOOL			Convert( int &n0, int &n1, int &n2 ); // 24bit
 };
 
-// -=-= SalColormap/SalColormapRef=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-class SalColormap : public SvRefBase
+// -=-= SalColormap =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+class SalColormap
 {
     SalDisplay	   *pDisplay_;
     Colormap		hColormap_;
@@ -228,7 +216,7 @@ public:
     SalColormap( const BitmapPalette &rpPalette );
     SalColormap( USHORT               nDepth );
     SalColormap();
-	virtual					~SalColormap();
+	~SalColormap();
     
 	inline	Colormap		GetXColormap() const { return hColormap_; }
 	inline	SalDisplay	   *GetDisplay() const { return pDisplay_; }
@@ -253,19 +241,17 @@ public:
     void			SetPalette( const BitmapPalette &rPalette );
 };
 
-SV_DECL_IMPL_REF( SalColormap )
-
 // -=-= SalXLib =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 typedef int(*YieldFunc)(int fd, void* data);
 struct YieldEntry;
 
 class SalXLib
 {
+protected:
     timeval			Timeout_;
     ULONG           nTimeoutMS_;
 	int             pTimeoutFDS_[2];
 
-    int 		    nStateOfYield_;
     BOOL			bWasXError_;
     BOOL			bIgnoreXErrors_;
     int                         nIgnoreErrorLevel;
@@ -277,17 +263,17 @@ class SalXLib
 
 public:
     SalXLib();
-    ~SalXLib();
-    void			Init();
+    virtual			~SalXLib();
+    virtual void		Init();
 	
-    void			Yield( BOOL bWait );
-    void			Wakeup();
+    virtual void		Yield( BOOL bWait );
+    virtual void        Wakeup();
     
-    void			Insert( int fd, void* data,
+    virtual void    Insert( int fd, void* data,
                             YieldFunc	pending,
                             YieldFunc	queued,
                             YieldFunc	handle );
-    void			Remove( int fd );
+    virtual void    Remove( int fd );
     
     void			XError( Display *pDisp, XErrorEvent *pEvent );
 	inline  void                    PushErrorTrap() { nIgnoreErrorLevel++; }
@@ -303,13 +289,6 @@ public:
     bool            CheckTimeout( bool bExecuteTimers = true );
 };
 
-// -=-= SalXEvent =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-struct SalXEvent
-{
-         	SalXEvent      *pNext_;				// Stack
-	        XEvent			event_;
-};
-
 // -=-= SalDisplay -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 
 class SalI18N_InputMethod;
@@ -330,6 +309,21 @@ extern "C" {
 
 class SalDisplay
 {
+// -=-= UserEvent =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+    struct SalUserEvent
+    {
+        SalFrame*		m_pFrame;
+        void*			m_pData;
+        USHORT			m_nEvent;
+        
+        SalUserEvent( SalFrame* pFrame, void* pData, USHORT nEvent = SALEVENT_USEREVENT ) 
+                : m_pFrame( pFrame ),
+                  m_pData( pData ),
+                  m_nEvent( nEvent )
+        {}
+    };
+
+protected:	
     SalXLib		   *pXLib_;
     SalI18N_InputMethod			*mpInputMethod;
     SalI18N_KeyboardExtension	*mpKbdExtension;
@@ -338,9 +332,6 @@ class SalDisplay
     XlfdStorage	   				*mpFontList;
     const ExtendedXlfd			*mpFallbackFactory;
     
-    SalSystemData  *mpSalSystemData;
-    // the one to get create and destroy notify events
-    
     Display		   *pDisp_;				// X Display
     Screen		   *pScreen_;			// XDefaultScreenOfDisplay
     int				nScreen_;			// XDefaultScreen
@@ -357,15 +348,10 @@ class SalDisplay
     BOOL			bLocal_;			// Server==Client? Init 
     // in SalDisplay::IsLocal()
     BOOL			mbLocalIsValid;		// bLocal_ is valid ?
-    ULONG			nImageDepths_;		// Supported Image Depths
-    ULONG			nSharedImages_;		// Supports MIT-SHM Extension
     // until x bytes
 	
-    int				nStateOfYield_;
-    int             nStateOfSendEvent_;
-    oslThreadMutex  hEventGuard_;
-    SalXEvent	   *pEventQueue_;		// threaded user event queue
-    SalXEvent      *pDispatchStack_;	// Dispatch/Yield
+    oslMutex        hEventGuard_;
+    std::list< SalUserEvent > m_aUserEvents;
     
     XLIB_Cursor		aPointerCache_[POINTER_COUNT];
     SalFrame       *pCapture_;
@@ -380,12 +366,10 @@ class SalDisplay
     GC				pOrGC_;
     GC				pStippleGC_;
     Pixmap			hInvert50_;
-    SalColormapRef  xColor_;
+    SalColormap    *m_pColormap;
     
     SalFontCache   *pFontCache_;
     
-    int				nBeepVolume_;		// Sound
-    
     // Keyboard
     BOOL			bNumLockFromXS_;	// Num Lock handled by X Server
     int				nNumLockIndex_;		// modifier index in modmap
@@ -395,11 +379,7 @@ class SalDisplay
     KeySym			nMod1KeySym_;		// first mod1 modifier
     ByteString		m_aKeyboardName;
     
-    SalBitmapList	Bitmaps_;			// to destroy bitmap resources;
-    
-    SalImageList	SharedImages_;
-    
-    ::vcl_sal::WMAdaptor*	m_pWMAdaptor;
+    vcl_sal::WMAdaptor*	m_pWMAdaptor;
 
     bool			m_bXinerama;
     std::vector< Rectangle > m_aXineramaScreens;
@@ -410,6 +390,8 @@ class SalDisplay
     void			DestroyFontCache();
     long			Dispatch( XEvent *pEvent );
     void			InitXinerama();
+
+    void			doDestruct();
 public:
 	static	SalDisplay	   *GetSalDisplay( Display* display );
 	static	BOOL			BestVisual( Display     *pDisp,
@@ -417,21 +399,14 @@ public:
 										XVisualInfo &rVI );
 
 							SalDisplay( Display* pDisp,
-										Visual* pVisual = NULL,
-										Colormap aColMap = None);
+										Colormap aColMap = None );
     
-    ~SalDisplay();
+    virtual ~SalDisplay();
     
-    void			Init( Colormap hXColmap, const XVisualInfo* pXVI );
+    void			Init( Colormap hXColmap, Visual *pVisual );
     
-    BOOL			IsEvent();
-    void			SendEvent( Atom			aEvent,
-                               void		   *pData,
-                               XLIB_Window	hReceiver = 0 ) const;
-    void			SendEvent( Atom			aEvent,
-                               UINT32	   *pData = 0,
-                               XLIB_Window	hReceiver = 0 ) const;
-    void			Yield( BOOL bWait );
+    void			SendInternalEvent( SalFrame* pFrame, void* pData, USHORT nEvent = SALEVENT_USEREVENT );
+    bool			DispatchInternalEvent();
     void			PrintInfo() const;
     
     void			PrintEvent( const ByteString &rComment,
@@ -462,12 +437,7 @@ public:
     int				CaptureMouse( SalFrame *pCapture );
     
     BOOL			IsLocal();
-	inline  void			Insert( SalBitmap *pBitmap );
-	inline  void			Remove( SalBitmap *pBitmap );
-    
-	inline	SalImage	   *Seek( SalImage *pImage );
-	inline  void			Insert( SalImage *pImage );
-	inline  void			Remove( SalImage *pImage );
+
     void			Remove( XEvent   *pEvent );
 	
 	XLIB_Window		GetRootWindow() const { return hRootWindow_; }
@@ -485,7 +455,7 @@ public:
 	GC				GetStippleGC() const { return pStippleGC_; }
 	GC				GetGC( USHORT nDepth ) const;
 	Pixmap			GetInvert50() const { return hInvert50_; }
-	SalColormap    &GetColormap() const { return *xColor_; }
+	SalColormap    &GetColormap() const { return *m_pColormap; }
 	SalVisual	   *GetVisual() const { return pVisual_; }
 	SalVisual	   *GetRootVisual() const { return pRootVisual_; }
 	const Size	   &GetScreenSize() const { return aSize_; }
@@ -493,9 +463,6 @@ public:
     bool			GetExactResolution() const { return mbExactResolution; }
 	ULONG			GetProperties() const { return nProperties_; }
 	ULONG			GetMaxRequestSize() const { return nMaxRequestSize_; }
-	ULONG			GetImageDepths() const { return nImageDepths_; }
-    ULONG			SupportsShm() const { return nSharedImages_; }
-	void			DisableShm() { nSharedImages_ /= 2; } // = 0
     void			GetScreenFontResolution( long& rDPIX, long& rDPIY ) const;
 	
 	BOOL			MouseCaptured( const SalFrame *pFrameData ) const
@@ -518,21 +485,6 @@ public:
 
 // -=-= inlines =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 
-inline void SalDisplay::Remove( SalBitmap *pBitmap )
-{ Bitmaps_.Remove( pBitmap ); }
-	
-inline void SalDisplay::Insert( SalBitmap *pBitmap )
-{ Bitmaps_.Insert( pBitmap ); }
-	
-inline SalImage *SalDisplay::Seek( SalImage *pImage )
-{ return SharedImages_.Seek( pImage ); }
-	
-inline void SalDisplay::Remove( SalImage *pImage )
-{ SharedImages_.Remove( pImage ); }
-	
-inline void SalDisplay::Insert( SalImage *pImage )
-{ SharedImages_.Insert( pImage ); }
-	
 inline GC SalDisplay::GetGC( USHORT nDepth ) const
 { return 1 == nDepth
 	     ? pMonoGC_
@@ -551,6 +503,17 @@ inline Visual *SalColormap::GetXVisual()
 
 inline int SalColormap::GetClass() const
 { return pVisual_ ? pVisual_->GetClass() : PseudoColor; }
+
+class SalX11Display : public SalDisplay
+{
+public:
+		     SalX11Display( Display* pDisp,
+						 Visual* pVisual = NULL,
+						 Colormap aColMap = None );
+    virtual ~SalX11Display();
+    BOOL	 IsEvent();
+    void     Yield( BOOL bWait );
+};
 
 /*----------------------------------------------------------
  keep track of correct size of the initial window
Index: vcl/unx/inc/salframe.h
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/salframe.h,v
retrieving revision 1.34
retrieving revision 1.33.2.2
diff -u -p -u -r1.34 -r1.33.2.2
--- vcl/unx/inc/salframe.h	6 Jan 2004 14:24:37 -0000	1.34
+++ vcl/unx/inc/salframe.h	21 Jan 2004 20:32:34 -0000	1.33.2.2
@@ -94,7 +94,6 @@
 class	SalDisplay;
 class	X11SalGraphics;
 class SalGraphicsLayout;
-class	SalColormap;
 class   SalI18N_InputContext;
 
 namespace vcl_sal { class WMAdaptor; class NetWMAdaptor; class GnomeWMAdaptor; }
@@ -252,7 +251,6 @@ public:
     void			PostExtTextEvent (sal_uInt16 nExtTextEventType, 
                                       void *pExtTextEvent);
 #endif
-	inline	SalColormap	   &GetColormap() const;
     bool					IsOverrideRedirect() const;
     bool					IsFloatGrabWindow() const;
     SalI18N_InputContext* getInputContext() const { return mpInputContext; }
@@ -311,9 +309,6 @@ inline Display *X11SalFrame::GetXDisplay
 
 inline XLIB_Window X11SalFrame::GetDrawable() const
 { return GetWindow(); }
-
-inline	SalColormap	&X11SalFrame::GetColormap() const
-{ return pDisplay_->GetColormap(); }
 
 #endif
 
Index: vcl/unx/inc/salgdi.h
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/salgdi.h,v
retrieving revision 1.25
retrieving revision 1.23.2.4
diff -u -p -u -r1.25 -r1.23.2.4
--- vcl/unx/inc/salgdi.h	6 Jan 2004 14:25:03 -0000	1.25
+++ vcl/unx/inc/salgdi.h	21 Jan 2004 20:32:45 -0000	1.23.2.4
@@ -100,34 +100,18 @@ class   ImplLayoutArgs;
 class   X11FontLayout;
 class   ServerFontLayout;
 
-#ifndef _USE_PRINT_EXTENSION_
-namespace psp { struct JobData; class PrinterGfx; }
-#endif
-
-#ifndef _SV_SALDISP_HXX
-typedef SalColormap         *SalColormapRef;
-#endif
-
 // -=-= SalGraphicsData =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 
 class X11SalGraphics : public SalGraphics
 {
-    friend class            PspSalPrinter;
-    friend class            PspSalInfoPrinter;
     friend class            X11FontLayout;
     friend class            ServerFontLayout;
 
     SalFrame*				m_pFrame; // the SalFrame which created this Graphics or NULL
     X11SalVirtualDevice*	m_pVDev;  // the SalVirtualDevice which created this Graphics or NULL
 
-#ifndef _USE_PRINT_EXTENSION_
-    ::psp::JobData*         m_pJobData;
-    ::psp::PrinterGfx*      m_pPrinterGfx;
-    String*                 m_pPhoneNr;
-    bool                    m_bSwallowFaxNo;
-#endif
-
-    SalColormapRef  xColormap_;
+    SalColormap    *m_pColormap;
+    SalColormap    *m_pDeleteColormap;
     Drawable        hDrawable_;     // use
     
     XLIB_Region     pPaintRegion_;
@@ -143,7 +127,6 @@ class X11SalGraphics : public SalGraphic
 
     SalColor        nTextColor_;
     Pixel           nTextPixel_;
-    short           nFontOrientation_;
     BOOL            bFontVertical_;
     
     GC              pBrushGC_;      // Brush attributes
@@ -182,7 +165,6 @@ class X11SalGraphics : public SalGraphic
     GC				GetInvert50GC();
     GC				CreateGC( Drawable      hDrawable,
                               unsigned long nMask = GCGraphicsExposures );
-
     GC				SelectPen();
     GC				SelectBrush();
     void			DrawLines( ULONG              nPoints,
@@ -237,7 +219,7 @@ public:
                             X11SalGraphics();
     virtual				~X11SalGraphics();
 
-            void            Init( SalFrame *pFrame );
+            void            Init( SalFrame *pFrame, Drawable aDrawable );
             void            Init( X11SalVirtualDevice *pVirtualDevice );
             void            Init( class ImplSalPrinterData *pPrinter );
             void            DeInit();
@@ -247,13 +229,9 @@ public:
     inline  SalVisual		*GetVisual() const;
     inline  Drawable        GetDrawable() const { return hDrawable_; }
     inline  void            SetDrawable( Drawable d ) { hDrawable_ = d; }
-    inline  SalColormap    &GetColormap() const { return *xColormap_; }
-    inline  BOOL            IsCompatible( USHORT nDepth,
-                                          SalColormap *pMap ) const;
+    inline  SalColormap    &GetColormap() const { return *m_pColormap; }
     inline  Pixel           GetPixel( SalColor nSalColor ) const;
 
-            String            FaxPhoneComment( const String& rOrig, xub_StrLen nIndex, xub_StrLen& rLen, xub_StrLen& rCutStart, xub_StrLen& rCutStop ) const;
-
     // overload all pure virtual methods
     virtual void			GetResolution( long& rDPIX, long& rDPIY );
     virtual void			GetScreenFontResolution( long& rDPIX, long& rDPIY );
@@ -359,12 +337,6 @@ inline SalVisual *X11SalGraphics::GetVis
 
 inline Display *X11SalGraphics::GetXDisplay() const
 { return GetColormap().GetXDisplay(); }
-
-inline BOOL X11SalGraphics::IsCompatible( USHORT       nDepth,
-                                          SalColormap *pMap ) const
-{
-    return (GetDisplay()->GetImageDepths() & (1 << (nDepth-1))) != 0 && &xColormap_ == pMap;
-}
 
 inline Pixel X11SalGraphics::GetPixel( SalColor nSalColor ) const
 { return GetColormap().GetPixel( nSalColor ); }
Index: vcl/unx/inc/salinst.h
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/salinst.h,v
retrieving revision 1.6
retrieving revision 1.6.2.1
diff -u -p -u -r1.6 -r1.6.2.1
--- vcl/unx/inc/salinst.h	18 Nov 2003 16:01:06 -0000	1.6
+++ vcl/unx/inc/salinst.h	4 Dec 2003 14:49:45 -0000	1.6.2.1
@@ -78,6 +78,7 @@
 
 class SalYieldMutex : public NAMESPACE_VOS(OMutex)
 {
+protected:
 	ULONG										mnCount;
 	NAMESPACE_VOS(OThread)::TThreadIdentifier	mnThreadId;
 
@@ -95,11 +96,15 @@ public:
 // -=-= SalInstanceData =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 class X11SalInstance : public SalInstance
 {
+protected:
 	SalYieldMutex*					mpSalYieldMutex;
     bool							mbPrinterInit;
 
 public:
-    X11SalInstance();
+    X11SalInstance( SalYieldMutex* pMutex ) 
+            : mpSalYieldMutex( pMutex ),
+              mbPrinterInit( false )
+    {}
     virtual ~X11SalInstance();
 
     virtual SalFrame*      	CreateChildFrame( SystemParentData* pParent, ULONG nStyle );
Index: vcl/unx/inc/salpdec1.h
===================================================================
RCS file: vcl/unx/inc/salpdec1.h
diff -N vcl/unx/inc/salpdec1.h
--- vcl/unx/inc/salpdec1.h	18 Sep 2000 17:05:41 -0000	1.1.1.1
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,410 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile$
- *
- *  $Revision$
- *
- *  last change: $Author$ $Date$
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-extern Pixel XSalBlackPixel( Display *, int );
-
-extern Colormap XSalDefaultColormap( Display *, int );
-
-extern int XSalDefaultDepth( Display *, int );
-
-extern int XSalDefaultScreen( Display * );
-
-extern Screen* XSalDefaultScreenOfDisplay( Display * );
-
-extern Visual* XSalDefaultVisual( Display *, int );
-
-extern int XSalDisplayHeight( Display *, int );
-
-extern int XSalDisplayHeightMM( Display *, int );
-
-extern int XSalDisplayWidth( Display *, int );
-
-extern int XSalDisplayWidthMM( Display *, int );
-
-extern Window XSalRootWindow( Display *, int );
-
-extern Pixel XSalWhitePixel( Display *, int );
-
-extern int XSalAllocColor( Display *, Colormap, XColor * );
-
-extern int XSalAllocNamedColor( Display *, Colormap, const char *, XColor *, XColor * );
-
-extern int XSalBell( Display *, int );
-
-extern int XSalChangeActivePointerGrab( Display *, unsigned int, Cursor, long unsigned int );
-
-extern int XSalChangeGC( Display *, GC, long unsigned int, XGCValues * );
-
-extern int XSalCheckIfEvent( Display *, XEvent *, XSalPeekEventPredicate, char * );
-
-extern int XSalCheckMaskEvent( Display *, long int, XEvent * );
-
-extern int XSalCheckTypedEvent( Display *, int, XEvent * );
-
-extern int XSalCheckWindowEvent( Display *, Window, long int, XEvent * );
-
-extern int XSalClipBox( Region, XRectangle * );
-
-extern int XSalCloseDisplay( Display * );
-
-extern int XSalCopyArea( Display *, Drawable, Drawable, GC, int, int, unsigned int, unsigned int, int, int );
-
-extern Pixmap XSalCreateBitmapFromData( Display *, Drawable, const char *, unsigned int, unsigned int );
-
-extern Colormap XSalCreateColormap( Display *, Window, Visual *, int );
-
-extern Cursor XSalCreateFontCursor( Display *, unsigned int );
-
-extern GC XSalCreateGC( Display *, Drawable, long unsigned int, XGCValues * );
-
-extern XImage * XSalCreateImage( Display *, Visual *, unsigned int, int, int, char *, unsigned int, unsigned int, int, int );
-
-extern Pixmap XSalCreatePixmap( Display *, Drawable, unsigned int, unsigned int, unsigned int );
-
-extern Cursor XSalCreatePixmapCursor( Display *, Pixmap, Pixmap, XColor *, XColor *, unsigned int, unsigned int );
-
-extern Window XSalCreateWindow( Display *, Window, int, int, unsigned int, unsigned int, unsigned int, int, unsigned int, Visual *, long unsigned int, XSetWindowAttributes * );
-
-extern int XSalDefineCursor( Display *, Window, Cursor );
-
-extern void XSalDestroyImage( XImage * );
-
-extern int XSalDestroyRegion( Region );
-
-extern int XSalDestroyWindow( Display *, Window );
-
-extern int XSalDrawImageString( Display *, Drawable, GC, int, int, const char *, int );
-
-extern int XSalDrawImageString16( Display *, Drawable, GC, int, int, const XChar2b *, int );
-
-extern int XSalDrawLine( Display *, Drawable, GC, int, int, int, int );
-
-extern int XSalDrawLines( Display *, Drawable, GC, XPoint *, int, int );
-
-extern int XSalDrawPoint( Display *, Drawable, GC, int, int );
-
-extern int XSalDrawRectangle( Display *, Drawable, GC, int, int, unsigned int, unsigned int );
-
-extern int XSalDrawString( Display *, Drawable, GC, int, int, const char *, int );
-
-extern int XSalDrawString16( Display *, Drawable, GC, int, int, const XChar2b *, int );
-
-extern int XSalDrawText( Display *, Drawable, GC, int, int, XTextItem *, int );
-
-extern int XSalEmptyRegion( Region );
-
-extern int XSalEventsQueued( Display *, int );
-
-extern long int XSalExtendedMaxRequestSize( Display * );
-
-extern int XSalFillPolygon( Display *, Drawable, GC, XPoint *, int, int, int );
-
-extern int XSalFillRectangle( Display *, Drawable, GC, int, int, unsigned int, unsigned int );
-
-extern int XSalFlush( Display * );
-
-extern int XSalFree( void * );
-
-extern int XSalFreeColormap( Display *, Colormap );
-
-extern int XSalFreeCursor( Display *, Cursor );
-
-extern int XSalFreeFont( Display *, XFontStruct * );
-
-extern int XSalFreeFontInfo( char **, XFontStruct *, int );
-
-extern int XSalFreeFontNames( char ** );
-
-extern int XSalFreeFontPath( char ** );
-
-extern int XSalFreeGC( Display *, GC );
-
-extern int XSalFreeModifiermap( XModifierKeymap * );
-
-extern int XSalFreePixmap( Display *, Pixmap );
-
-extern int XSalGetClassHint( Display *, Window, XClassHint * );
-
-extern int XSalGetErrorText( Display *, int, char *, int );
-
-extern char ** XSalGetFontPath( Display *, int * );
-
-extern XImage * XSalGetImage( Display *, Drawable, int, int, unsigned int, unsigned int, long unsigned int, int );
-
-extern XModifierKeymap * XSalGetModifierMapping( Display * );
-
-extern Pixel XSalGetPixel( XImage *, int, int );
-
-extern int XSalGetScreenSaver( Display *, int *, int *, int *, int * );
-
-extern XImage * XSalGetSubImage( Display *, Drawable, int, int, unsigned int, unsigned int, long unsigned int, int, XImage *, int, int );
-
-extern XVisualInfo * XSalGetVisualInfo( Display *, long int, XVisualInfo *, int * );
-
-extern XWMHints * XSalGetWMHints( Display *, Window );
-
-extern int XSalGetWMNormalHints( Display *, Window, XSizeHints *, long int * );
-
-extern int XSalGetWindowAttributes( Display *, Window, XWindowAttributes * );
-
-extern int XSalGetWindowProperty( Display *, Window, long unsigned int, long int, long int, int, long unsigned int, long unsigned int *, int *, long unsigned int *, long unsigned int *, unsigned char ** );
-
-extern int XSalGrabPointer( Display *, Window, int, unsigned int, int, int, Window, Cursor, long unsigned int );
-
-extern int XSalIconifyWindow( Display *, Window, int );
-
-extern int XSalIntersectRegion( Region, Region, Region );
-
-extern KeySym XSalKeycodeToKeysym( Display *, unsigned int, int );
-
-extern unsigned char XSalKeysymToKeycode( Display *, KeySym );
-
-extern char * XSalKeysymToString( KeySym );
-
-extern int * XSalListDepths( Display *, int, int * );
-
-extern char ** XSalListFonts( Display *, const char *, int, int * );
-
-extern char ** XSalListFontsWithInfo( Display *, const char *, int, int *, XFontStruct ** );
-
-extern Font XSalLoadFont( Display *, const char * );
-
-extern XFontStruct * XSalLoadQueryFont( Display *, const char * );
-
-extern KeySym XSalLookupKeysym( XKeyEvent *, int );
-
-extern int XSalLookupString( XKeyEvent *, char *, int, KeySym *, struct _XComposeStatus * );
-
-extern int XSalMapWindow( Display *, Window );
-
-extern int XSalMatchVisualInfo( Display *, int, int, int, XVisualInfo * );
-
-extern long int XSalMaxRequestSize( Display * );
-
-extern int XSalMoveWindow( Display *, Window, int, int );
-
-extern int XSalNextEvent( Display *, XEvent * );
-
-extern int XSalPeekIfEvent( Display *, XEvent *, XSalPeekEventPredicate, char * );
-
-extern int XSalPending( Display * );
-
-extern Region XSalPolygonRegion( XPoint *, int, int );
-
-extern int XSalPutImage( Display *, Drawable, GC, XImage *, int, int, int, int, unsigned int, unsigned int );
-
-extern void XSalPutPixel( XImage *, int, int, unsigned long );
-
-extern int XSalQueryBestStipple( Display *, Drawable, unsigned int, unsigned int, unsigned int *, unsigned int * );
-
-extern int XSalQueryColor( Display *, Colormap, XColor * );
-
-extern int XSalQueryColors( Display *, Colormap, XColor *, int );
-
-extern int XSalQueryTree( Display *, Window, Window *, Window *, Window **, unsigned int * );
-
-extern int XSalRaiseWindow( Display *, Window );
-
-extern int XSalReconfigureWMWindow( Display *, Window, int, unsigned int, XWindowChanges * );
-
-extern int XSalRectInRegion( Region, int, int, unsigned int, unsigned int );
-
-extern int XSalRefreshKeyboardMapping( XMappingEvent * );
-
-extern int XSalResetScreenSaver( Display * );
-
-extern int XSalSelectInput( Display *, Window, long int );
-
-extern int XSalSendEvent( Display *, Window, int, long int, XEvent * );
-
-extern int XSalSetArcMode( Display *, GC, int );
-
-extern int XSalSetBackground( Display *, GC, long unsigned int );
-
-extern int XSalSetClipMask( Display *, GC, Pixmap );
-
-extern int XSalSetClipOrigin( Display *, GC, int, int );
-
-extern XErrorHandler XSalSetErrorHandler( XErrorHandler );
-
-extern int XSalSetFillStyle( Display *, GC, int );
-
-extern int XSalSetFont( Display *, GC, Font );
-
-extern int XSalSetFontPath( Display *, char **, int );
-
-extern int XSalSetForeground( Display *, GC, long unsigned int );
-
-extern int XSalSetFunction( Display *, GC, int );
-
-extern XIOErrorHandler XSalSetIOErrorHandler( XIOErrorHandler );
-
-extern int XSalSetInputFocus( Display *, Window, int, long unsigned int );
-
-extern int XSalSetLineAttributes( Display *, GC, unsigned int, int, int, int );
-
-extern int XSalSetRegion( Display *, GC, Region );
-
-extern int XSalSetScreenSaver( Display *, int, int, int, int );
-
-extern int XSalSetStipple( Display *, GC, Pixmap );
-
-extern int XSalSetTSOrigin( Display *, GC, int, int );
-
-extern int XSalSetTile( Display *, GC, Pixmap );
-
-extern int XSalSetWMHints( Display *, Window, XWMHints * );
-
-extern void XSalSetWMIconName( Display *, Window, XTextProperty * );
-
-extern void XSalSetWMName( Display *, Window, XTextProperty * );
-
-extern void XSalSetWMNormalHints( Display *, Window, XSizeHints * );
-
-extern void XSalSetWMProperties( Display *, Window, XTextProperty *, XTextProperty *, char **, int, XSizeHints *, XWMHints *, XClassHint * );
-
-extern int XSalSetWMProtocols( Display *, Window, long unsigned int *, int );
-
-extern int XSalSetWindowBackgroundPixmap( Display *, Window, Pixmap );
-
-#ifdef _XSHM_H_
-extern int XSalShmAttach( Display *, XShmSegmentInfo * );
-#endif
-
-#ifdef _XSHM_H_
-extern XImage * XSalShmCreateImage( Display *, Visual *, unsigned int, int, char *, XShmSegmentInfo *, unsigned int, unsigned int );
-#endif
-
-#ifdef _XSHM_H_
-extern int XSalShmDetach( Display *, XShmSegmentInfo * );
-#endif
-
-#ifdef _XSHM_H_
-extern int XSalShmGetEventBase( Display * );
-#endif
-
-#ifdef _XSHM_H_
-extern int XSalShmGetImage( Display *, Drawable, XImage *, int, int, long unsigned int );
-#endif
-
-#ifdef _XSHM_H_
-extern int XSalShmPutImage( Display *, Drawable, GC, XImage *, int, int, int, int, unsigned int, unsigned int, int );
-#endif
-
-#ifdef _XSHM_H_
-extern int XSalShmQueryVersion( Display *, int *, int *, int * );
-#endif
-
-extern int XSalStringListToTextProperty( char **, int, XTextProperty * );
-
-extern int XSalSubtractRegion( Region, Region, Region );
-
-extern int XSalSync( Display *, int );
-
-extern XSalAfterFunction XSalSynchronize( Display *, int );
-
-extern int XSalTranslateCoordinates( Display *, Window, Window, int, int, int *, int *, Window * );
-
-extern int XSalUngrabKeyboard( Display *, long unsigned int );
-
-extern int XSalUngrabPointer( Display *, long unsigned int );
-
-extern int XSalUnionRectWithRegion( XRectangle *, Region, Region );
-
-extern int XSalUnionRegion( Region, Region, Region );
-
-extern int XSalUnloadFont( Display *, Font );
-
-extern int XSalUnmapWindow( Display *, Window );
-
-extern long unsigned int XSalVisualIDFromVisual( Visual * );
-
-extern int XSalWarpPointer( Display *, Window, Window, int, int, unsigned int, unsigned int, int, int );
-
-extern int XSalXorRegion( Region, Region, Region );
-
-extern char * XSalGetAtomName( Display *, long unsigned int );
-
-extern int XSalGetHostname( char *, int );
-
-extern void XSalInternStrings( Display *, char **, unsigned int, long unsigned int * );
-
-/*
-extern Widget XSalAppCreateShell( const char *, const char *, struct _WidgetClassRec *, Display *, ArgList, unsigned int );
-extern XtErrorHandler XSalAppSetErrorHandler( XtAppContext, XtErrorHandler );
-extern XtErrorHandler XSalAppSetWarningHandler( XtAppContext, XtErrorHandler );
-*/
-
-extern XtAppContext XSalCreateApplicationContext(  );
-
-extern void XSalDestroyWidget( Widget );
-
-extern void XSalGetValues( Widget, ArgList, unsigned int );
-
-/* extern Display * XSalOpenDisplay( XtAppContext, const char *, const char *, const char *, XrmOptionDescRec *, unsigned int, int *, char ** ); */
-
-extern void XSalRealizeWidget( Widget );
-
-extern void XSalSetMappedWhenManaged( Widget, int );
-
-extern void XSalSetValues( Widget, ArgList, unsigned int );
-
-extern void XSalToolkitInitialize(  );
-
Index: vcl/unx/inc/salpdecl.h
===================================================================
RCS file: vcl/unx/inc/salpdecl.h
diff -N vcl/unx/inc/salpdecl.h
--- vcl/unx/inc/salpdecl.h	27 Mar 2003 17:58:32 -0000	1.2
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,122 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile$
- *
- *  $Revision$
- *
- *  last change: $Author$ $Date$
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-#ifndef __salpdecl_h
-#define __salpdecl_h
-
-#include <X11/Xlib.h>
-#include <X11/Xutil.h>
-
-#include <X11/Xmu/Atoms.h>
-#include <X11/Xmu/SysUtil.h>
-
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-#if defined AIX
-#define NO_SHM_FUNCTIONS
-#endif
-
-#ifndef NO_SHM_FUNCTIONS
-#include <X11/extensions/XShm.h>
-#else
-typedef struct XShmSegmentInfo XShmSegmentInfo;
-#endif
-
-/* error handling */
-
-typedef int (*XSalPeekEventPredicate)( Display*, XEvent*, XPointer );
-typedef int (*XSalAfterFunction)( );
-
-/* funtions for drawing rotated strings */
-extern int	XSalCanDrawRotString( Display*, GC );
-extern int	XSalDrawRotString( Display*, Drawable, GC,
-							   int x, int y,
-							   const char* string, int length,
-							   int angle );
-extern int	XSalDrawRotImageString( Display*, Drawable, GC,
-									int x, int y,
-									const char* string, int length,
-									int angle );
-extern int	XSalDrawRotString16( Display*, Drawable, GC,
-								 int x, int y,
-								 const unsigned short* string, int length,
-								 int angle );
-extern int	XSalDrawRotImageString16( Display*, Drawable, GC,
-									  int x, int y,
-									  const unsigned short* string, int length,
-									  int angle );
-
-
-
-#include <salpdec1.h>
-
-
-
-/* printer interface */
-extern int XSalIsDisplay( const Display * );
-extern int XSalIsPrinter( const Display * );
-
-#ifdef __cplusplus
-} // extern "C"
-#endif
-
-#endif
Index: vcl/unx/inc/salpmac1.h
===================================================================
RCS file: vcl/unx/inc/salpmac1.h
diff -N vcl/unx/inc/salpmac1.h
--- vcl/unx/inc/salpmac1.h	18 Sep 2000 17:05:41 -0000	1.1.1.1
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,247 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile$
- *
- *  $Revision$
- *
- *  last change: $Author$ $Date$
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-#define BlackPixel(arg1,arg2)	XSalBlackPixel( arg1, arg2 )
-#define DefaultColormap(arg1,arg2)	XSalDefaultColormap( arg1, arg2 )
-#define DefaultDepth(arg1,arg2)	XSalDefaultDepth( arg1, arg2 )
-#define DefaultScreen(arg1)	XSalDefaultScreen( arg1 )
-#define DefaultScreenOfDisplay(arg1)	XSalDefaultScreenOfDisplay( arg1 )
-#define DefaultVisual(arg1,arg2)	XSalDefaultVisual( arg1, arg2 )
-#define DisplayHeight(arg1,arg2)	XSalDisplayHeight( arg1, arg2 )
-#define DisplayHeightMM(arg1,arg2)	XSalDisplayHeightMM( arg1, arg2 )
-#define DisplayWidth(arg1,arg2)	XSalDisplayWidth( arg1, arg2 )
-#define DisplayWidthMM(arg1,arg2)	XSalDisplayWidthMM( arg1, arg2 )
-#define RootWindow(arg1,arg2)	XSalRootWindow( arg1, arg2 )
-#define WhitePixel(arg1,arg2)	XSalWhitePixel( arg1, arg2 )
-#define XAllocColor(arg1,arg2,arg3)	XSalAllocColor( arg1, arg2, arg3 )
-#define XAllocNamedColor(arg1,arg2,arg3,arg4,arg5)	XSalAllocNamedColor( arg1, arg2, arg3, arg4, arg5 )
-#define XBell(arg1,arg2)	XSalBell( arg1, arg2 )
-#define XChangeActivePointerGrab(arg1,arg2,arg3,arg4)	XSalChangeActivePointerGrab( arg1, arg2, arg3, arg4 )
-#define XChangeGC(arg1,arg2,arg3,arg4)	XSalChangeGC( arg1, arg2, arg3, arg4 )
-#define XCheckIfEvent(arg1,arg2,arg3,arg4)	XSalCheckIfEvent( arg1, arg2, arg3, arg4 )
-#define XCheckMaskEvent(arg1,arg2,arg3)	XSalCheckMaskEvent( arg1, arg2, arg3 )
-#define XCheckTypedEvent(arg1,arg2,arg3)	XSalCheckTypedEvent( arg1, arg2, arg3 )
-#define XCheckWindowEvent(arg1,arg2,arg3,arg4)	XSalCheckWindowEvent( arg1, arg2, arg3, arg4 )
-#define XClipBox(arg1,arg2)	XSalClipBox( arg1, arg2 )
-#define XCloseDisplay(arg1)	XSalCloseDisplay( arg1 )
-#define XCopyArea(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10)	XSalCopyArea( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10 )
-#define XCreateBitmapFromData(arg1,arg2,arg3,arg4,arg5)	XSalCreateBitmapFromData( arg1, arg2, arg3, arg4, arg5 )
-#define XCreateColormap(arg1,arg2,arg3,arg4)	XSalCreateColormap( arg1, arg2, arg3, arg4 )
-#define XCreateFontCursor(arg1,arg2)	XSalCreateFontCursor( arg1, arg2 )
-#define XCreateGC(arg1,arg2,arg3,arg4)	XSalCreateGC( arg1, arg2, arg3, arg4 )
-#define XCreateImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10)	XSalCreateImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10 )
-#define XCreatePixmap(arg1,arg2,arg3,arg4,arg5)	XSalCreatePixmap( arg1, arg2, arg3, arg4, arg5 )
-#define XCreatePixmapCursor(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalCreatePixmapCursor( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XCreateWindow(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12)	XSalCreateWindow( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11, arg12 )
-#define XDefineCursor(arg1,arg2,arg3)	XSalDefineCursor( arg1, arg2, arg3 )
-#define XDestroyImage(arg1)	XSalDestroyImage( arg1 )
-#define XDestroyRegion(arg1)	XSalDestroyRegion( arg1 )
-#define XDestroyWindow(arg1,arg2)	XSalDestroyWindow( arg1, arg2 )
-#define XDrawImageString(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawImageString( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawImageString16(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawImageString16( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawLine(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawLine( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawLines(arg1,arg2,arg3,arg4,arg5,arg6)	XSalDrawLines( arg1, arg2, arg3, arg4, arg5, arg6 )
-#define XDrawPoint(arg1,arg2,arg3,arg4,arg5)	XSalDrawPoint( arg1, arg2, arg3, arg4, arg5 )
-#define XDrawRectangle(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawRectangle( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawString(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawString( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawString16(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawString16( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XDrawText(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalDrawText( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XEmptyRegion(arg1)	XSalEmptyRegion( arg1 )
-#define XEventsQueued(arg1,arg2)	XSalEventsQueued( arg1, arg2 )
-#define XExtendedMaxRequestSize(arg1)	XSalExtendedMaxRequestSize( arg1 )
-#define XFillPolygon(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalFillPolygon( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XFillRectangle(arg1,arg2,arg3,arg4,arg5,arg6,arg7)	XSalFillRectangle( arg1, arg2, arg3, arg4, arg5, arg6, arg7 )
-#define XFlush(arg1)	XSalFlush( arg1 )
-#define XFree(arg1)	XSalFree( arg1 )
-#define XFreeColormap(arg1,arg2)	XSalFreeColormap( arg1, arg2 )
-#define XFreeCursor(arg1,arg2)	XSalFreeCursor( arg1, arg2 )
-#define XFreeFont(arg1,arg2)	XSalFreeFont( arg1, arg2 )
-#define XFreeFontInfo(arg1,arg2,arg3)	XSalFreeFontInfo( arg1, arg2, arg3 )
-#define XFreeFontNames(arg1)	XSalFreeFontNames( arg1 )
-#define XFreeFontPath(arg1)	XSalFreeFontPath( arg1 )
-#define XFreeGC(arg1,arg2)	XSalFreeGC( arg1, arg2 )
-#define XFreeModifiermap(arg1)	XSalFreeModifiermap( arg1 )
-#define XFreePixmap(arg1,arg2)	XSalFreePixmap( arg1, arg2 )
-#define XGetClassHint(arg1,arg2,arg3)	XSalGetClassHint( arg1, arg2, arg3 )
-#define XGetErrorText(arg1,arg2,arg3,arg4)	XSalGetErrorText( arg1, arg2, arg3, arg4 )
-#define XGetFontPath(arg1,arg2)	XSalGetFontPath( arg1, arg2 )
-#define XGetImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8)	XSalGetImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8 )
-#define XGetModifierMapping(arg1)	XSalGetModifierMapping( arg1 )
-#define XGetPixel(arg1,arg2,arg3)	XSalGetPixel( arg1, arg2, arg3 )
-#define XGetScreenSaver(arg1,arg2,arg3,arg4,arg5)	XSalGetScreenSaver( arg1, arg2, arg3, arg4, arg5 )
-#define XGetSubImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11)	XSalGetSubImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11 )
-#define XGetVisualInfo(arg1,arg2,arg3,arg4)	XSalGetVisualInfo( arg1, arg2, arg3, arg4 )
-#define XGetWMHints(arg1,arg2)	XSalGetWMHints( arg1, arg2 )
-#define XGetWMNormalHints(arg1,arg2,arg3,arg4)	XSalGetWMNormalHints( arg1, arg2, arg3, arg4 )
-#define XGetWindowAttributes(arg1,arg2,arg3)	XSalGetWindowAttributes( arg1, arg2, arg3 )
-#define XGetWindowProperty(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12)	XSalGetWindowProperty( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11, arg12 )
-#define XGrabPointer(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9)	XSalGrabPointer( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9 )
-#define XIconifyWindow(arg1,arg2,arg3)	XSalIconifyWindow( arg1, arg2, arg3 )
-#define XIntersectRegion(arg1,arg2,arg3)	XSalIntersectRegion( arg1, arg2, arg3 )
-#define XKeycodeToKeysym(arg1,arg2,arg3)	XSalKeycodeToKeysym( arg1, arg2, arg3 )
-#define XKeysymToKeycode(arg1,arg2)	XSalKeysymToKeycode( arg1, arg2 )
-#define XKeysymToString(arg1)	XSalKeysymToString( arg1 )
-#define XListDepths(arg1,arg2,arg3)	XSalListDepths( arg1, arg2, arg3 )
-#define XListFonts(arg1,arg2,arg3,arg4)	XSalListFonts( arg1, arg2, arg3, arg4 )
-#define XListFontsWithInfo(arg1,arg2,arg3,arg4,arg5)	XSalListFontsWithInfo( arg1, arg2, arg3, arg4, arg5 )
-#define XLoadFont(arg1,arg2)	XSalLoadFont( arg1, arg2 )
-#define XLoadQueryFont(arg1,arg2)	XSalLoadQueryFont( arg1, arg2 )
-#define XLookupKeysym(arg1,arg2)	XSalLookupKeysym( arg1, arg2 )
-#define XLookupString(arg1,arg2,arg3,arg4,arg5)	XSalLookupString( arg1, arg2, arg3, arg4, arg5 )
-#define XMapWindow(arg1,arg2)	XSalMapWindow( arg1, arg2 )
-#define XMatchVisualInfo(arg1,arg2,arg3,arg4,arg5)	XSalMatchVisualInfo( arg1, arg2, arg3, arg4, arg5 )
-#define XMaxRequestSize(arg1)	XSalMaxRequestSize( arg1 )
-#define XMoveWindow(arg1,arg2,arg3,arg4)	XSalMoveWindow( arg1, arg2, arg3, arg4 )
-#define XNextEvent(arg1,arg2)	XSalNextEvent( arg1, arg2 )
-#define XPeekIfEvent(arg1,arg2,arg3,arg4)	XSalPeekIfEvent( arg1, arg2, arg3, arg4 )
-#define XPending(arg1)	XSalPending( arg1 )
-#define XPolygonRegion(arg1,arg2,arg3)	XSalPolygonRegion( arg1, arg2, arg3 )
-#define XPutImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10)	XSalPutImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10 )
-#define XPutPixel(arg1,arg2,arg3,arg4)	XSalPutPixel( arg1, arg2, arg3, arg4 )
-#define XQueryBestStipple(arg1,arg2,arg3,arg4,arg5,arg6)	XSalQueryBestStipple( arg1, arg2, arg3, arg4, arg5, arg6 )
-#define XQueryColor(arg1,arg2,arg3)	XSalQueryColor( arg1, arg2, arg3 )
-#define XQueryColors(arg1,arg2,arg3,arg4)	XSalQueryColors( arg1, arg2, arg3, arg4 )
-#define XQueryTree(arg1,arg2,arg3,arg4,arg5,arg6)	XSalQueryTree( arg1, arg2, arg3, arg4, arg5, arg6 )
-#define XRaiseWindow(arg1,arg2)	XSalRaiseWindow( arg1, arg2 )
-#define XReconfigureWMWindow(arg1,arg2,arg3,arg4,arg5)	XSalReconfigureWMWindow( arg1, arg2, arg3, arg4, arg5 )
-#define XRectInRegion(arg1,arg2,arg3,arg4,arg5)	XSalRectInRegion( arg1, arg2, arg3, arg4, arg5 )
-#define XRefreshKeyboardMapping(arg1)	XSalRefreshKeyboardMapping( arg1 )
-#define XResetScreenSaver(arg1)	XSalResetScreenSaver( arg1 )
-#define XSelectInput(arg1,arg2,arg3)	XSalSelectInput( arg1, arg2, arg3 )
-#define XSendEvent(arg1,arg2,arg3,arg4,arg5)	XSalSendEvent( arg1, arg2, arg3, arg4, arg5 )
-#define XSetArcMode(arg1,arg2,arg3)	XSalSetArcMode( arg1, arg2, arg3 )
-#define XSetBackground(arg1,arg2,arg3)	XSalSetBackground( arg1, arg2, arg3 )
-#define XSetClipMask(arg1,arg2,arg3)	XSalSetClipMask( arg1, arg2, arg3 )
-#define XSetClipOrigin(arg1,arg2,arg3,arg4)	XSalSetClipOrigin( arg1, arg2, arg3, arg4 )
-#define XSetErrorHandler(arg1)	XSalSetErrorHandler( arg1 )
-#define XSetFillStyle(arg1,arg2,arg3)	XSalSetFillStyle( arg1, arg2, arg3 )
-#define XSetFont(arg1,arg2,arg3)	XSalSetFont( arg1, arg2, arg3 )
-#define XSetFontPath(arg1,arg2,arg3)	XSalSetFontPath( arg1, arg2, arg3 )
-#define XSetForeground(arg1,arg2,arg3)	XSalSetForeground( arg1, arg2, arg3 )
-#define XSetFunction(arg1,arg2,arg3)	XSalSetFunction( arg1, arg2, arg3 )
-#define XSetIOErrorHandler(arg1)	XSalSetIOErrorHandler( arg1 )
-#define XSetInputFocus(arg1,arg2,arg3,arg4)	XSalSetInputFocus( arg1, arg2, arg3, arg4 )
-#define XSetLineAttributes(arg1,arg2,arg3,arg4,arg5,arg6)	XSalSetLineAttributes( arg1, arg2, arg3, arg4, arg5, arg6 )
-#define XSetRegion(arg1,arg2,arg3)	XSalSetRegion( arg1, arg2, arg3 )
-#define XSetScreenSaver(arg1,arg2,arg3,arg4,arg5)	XSalSetScreenSaver( arg1, arg2, arg3, arg4, arg5 )
-#define XSetStipple(arg1,arg2,arg3)	XSalSetStipple( arg1, arg2, arg3 )
-#define XSetTSOrigin(arg1,arg2,arg3,arg4)	XSalSetTSOrigin( arg1, arg2, arg3, arg4 )
-#define XSetTile(arg1,arg2,arg3)	XSalSetTile( arg1, arg2, arg3 )
-#define XSetWMHints(arg1,arg2,arg3)	XSalSetWMHints( arg1, arg2, arg3 )
-#define XSetWMIconName(arg1,arg2,arg3)	XSalSetWMIconName( arg1, arg2, arg3 )
-#define XSetWMName(arg1,arg2,arg3)	XSalSetWMName( arg1, arg2, arg3 )
-#define XSetWMNormalHints(arg1,arg2,arg3)	XSalSetWMNormalHints( arg1, arg2, arg3 )
-#define XSetWMProperties(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9)	XSalSetWMProperties( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9 )
-#define XSetWMProtocols(arg1,arg2,arg3,arg4)	XSalSetWMProtocols( arg1, arg2, arg3, arg4 )
-#define XSetWindowBackgroundPixmap(arg1,arg2,arg3)	XSalSetWindowBackgroundPixmap( arg1, arg2, arg3 )
-#ifdef _XSHM_H_
-#define XShmAttach(arg1,arg2)	XSalShmAttach( arg1, arg2 )
-#endif
-#ifdef _XSHM_H_
-#define XShmCreateImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8)	XSalShmCreateImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8 )
-#endif
-#ifdef _XSHM_H_
-#define XShmDetach(arg1,arg2)	XSalShmDetach( arg1, arg2 )
-#endif
-#ifdef _XSHM_H_
-#define XShmGetEventBase(arg1)	XSalShmGetEventBase( arg1 )
-#endif
-#ifdef _XSHM_H_
-#define XShmGetImage(arg1,arg2,arg3,arg4,arg5,arg6)	XSalShmGetImage( arg1, arg2, arg3, arg4, arg5, arg6 )
-#endif
-#ifdef _XSHM_H_
-#define XShmPutImage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11)	XSalShmPutImage( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11 )
-#endif
-#ifdef _XSHM_H_
-#define XShmQueryVersion(arg1,arg2,arg3,arg4)	XSalShmQueryVersion( arg1, arg2, arg3, arg4 )
-#endif
-#define XStringListToTextProperty(arg1,arg2,arg3)	XSalStringListToTextProperty( arg1, arg2, arg3 )
-#define XSubtractRegion(arg1,arg2,arg3)	XSalSubtractRegion( arg1, arg2, arg3 )
-#define XSync(arg1,arg2)	XSalSync( arg1, arg2 )
-#define XSynchronize(arg1,arg2)	XSalSynchronize( arg1, arg2 )
-#define XTranslateCoordinates(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8)	XSalTranslateCoordinates( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8 )
-#define XUngrabKeyboard(arg1,arg2)	XSalUngrabKeyboard( arg1, arg2 )
-#define XUngrabPointer(arg1,arg2)	XSalUngrabPointer( arg1, arg2 )
-#define XUnionRectWithRegion(arg1,arg2,arg3)	XSalUnionRectWithRegion( arg1, arg2, arg3 )
-#define XUnionRegion(arg1,arg2,arg3)	XSalUnionRegion( arg1, arg2, arg3 )
-#define XUnloadFont(arg1,arg2)	XSalUnloadFont( arg1, arg2 )
-#define XUnmapWindow(arg1,arg2)	XSalUnmapWindow( arg1, arg2 )
-#define XVisualIDFromVisual(arg1)	XSalVisualIDFromVisual( arg1 )
-#define XWarpPointer(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9)	XSalWarpPointer( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9 )
-#define XXorRegion(arg1,arg2,arg3)	XSalXorRegion( arg1, arg2, arg3 )
-#define XmuGetAtomName(arg1,arg2)	XSalGetAtomName( arg1, arg2 )
-#define XmuGetHostname(arg1,arg2)	XSalGetHostname( arg1, arg2 )
-#define XmuInternStrings(arg1,arg2,arg3,arg4)	XSalInternStrings( arg1, arg2, arg3, arg4 )
-
-#if 0
-
-#define XtAppCreateShell(arg1,arg2,arg3,arg4,arg5,arg6)	XSalAppCreateShell( arg1, arg2, arg3, arg4, arg5, arg6 )
-#define XtAppSetErrorHandler(arg1,arg2)	XSalAppSetErrorHandler( arg1, arg2 )
-#define XtAppSetWarningHandler(arg1,arg2)	XSalAppSetWarningHandler( arg1, arg2 )
-#define XtCreateApplicationContext()	XSalCreateApplicationContext(  )
-#define XtDestroyWidget(arg1)	XSalDestroyWidget( arg1 )
-#define XtGetValues(arg1,arg2,arg3)	XSalGetValues( arg1, arg2, arg3 )
-#define XtOpenDisplay(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8)	XSalOpenDisplay( arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8 )
-#define XtRealizeWidget(arg1)	XSalRealizeWidget( arg1 )
-#define XtSetMappedWhenManaged(arg1,arg2)	XSalSetMappedWhenManaged( arg1, arg2 )
-#define XtSetValues(arg1,arg2,arg3)	XSalSetValues( arg1, arg2, arg3 )
-#define XtToolkitInitialize()	XSalToolkitInitialize(  )
-
-#endif
Index: vcl/unx/inc/salpmacr.h
===================================================================
RCS file: vcl/unx/inc/salpmacr.h
diff -N vcl/unx/inc/salpmacr.h
--- vcl/unx/inc/salpmacr.h	18 Sep 2000 17:05:41 -0000	1.1.1.1
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,82 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile$
- *
- *  $Revision$
- *
- *  last change: $Author$ $Date$
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-#ifndef __salpmacr_h
-#define __salpmacr_h
-
-#undef DefaultColormap
-#undef DefaultDepth
-#undef DefaultScreen
-#undef DefaultScreenOfDisplay
-#undef DefaultVisual
-#undef DisplayHeight
-#undef DisplayHeightMM
-#undef DisplayWidth
-#undef DisplayWidthMM
-#undef RootWindow
-#undef BlackPixel
-#undef WhitePixel
-#undef XGetPixel
-#undef XPutPixel
-#undef XDestroyImage
-
-#include <salpmac1.h>
-
-#endif
Index: vcl/unx/inc/salprn.h
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/salprn.h,v
retrieving revision 1.10
retrieving revision 1.10.2.1
diff -u -p -u -r1.10 -r1.10.2.1
--- vcl/unx/inc/salprn.h	18 Nov 2003 14:38:52 -0000	1.10
+++ vcl/unx/inc/salprn.h	5 Dec 2003 16:33:27 -0000	1.10.2.1
@@ -75,12 +75,12 @@
 #include <salprn.hxx>
 #endif
 
-class X11SalGraphics;
+class PspGraphics;
 
 class PspSalInfoPrinter : public SalInfoPrinter
 {
 public:
-	X11SalGraphics*			m_pGraphics;
+	PspGraphics*			m_pGraphics;
 	psp::JobData			m_aJobData;
 	psp::PrinterGfx			m_aPrinterGfx;
 
@@ -113,10 +113,10 @@ public:
 	bool					m_bFax:1;
 	bool					m_bPdf:1;
 	bool					m_bSwallowFaxNo:1;
-	X11SalGraphics*			m_pGraphics;
-	::psp::PrinterJob		m_aPrintJob;
-	::psp::JobData			m_aJobData;
-	::psp::PrinterGfx		m_aPrinterGfx;
+	PspGraphics*			m_pGraphics;
+	psp::PrinterJob			m_aPrintJob;
+	psp::JobData			m_aJobData;
+	psp::PrinterGfx			m_aPrinterGfx;
     ULONG					m_nCopies;
 
     PspSalPrinter();
Index: vcl/unx/inc/salsys.h
===================================================================
RCS file: vcl/unx/inc/salsys.h
diff -N vcl/unx/inc/salsys.h
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/salsys.h	22 Jan 2004 12:49:30 -0000	1.2.2.3
@@ -0,0 +1,98 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+// -=-= includes -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+#ifndef _SV_SALSYS_H
+#define _SV_SALSYS_H
+
+#ifndef _SV_SV_H
+#include <sv.h>
+#endif
+#ifndef _VOS_MUTEX_HXX
+#include <vos/mutex.hxx>
+#endif
+#ifndef _VOS_THREAD_HXX
+#include <vos/thread.hxx>
+#endif
+#ifndef _SV_SALSYS_HXX
+#include <salsys.hxx>
+#endif
+#include <list>
+
+class X11SalSystem : public SalSystem
+{
+public:
+    X11SalSystem() {}
+    virtual ~X11SalSystem();
+    
+    // overload pure virtual methods
+    virtual bool GetSalSystemDisplayInfo( DisplayInfo& rInfo );
+    virtual int ShowNativeDialog( const String& rTitle,
+                                  const String& rMessage,
+                                  const std::list< String >& rButtons,
+                                  int nDefButton );
+    virtual int ShowNativeMessageBox( const String& rTitle,
+                                      const String& rMessage,
+                                      int nButtonCombination,
+                                      int nDefaultButton);
+};
+
+#endif // _SV_SALSYS_H
Index: vcl/unx/inc/plugins/gtk/gtkdata.hxx
===================================================================
RCS file: vcl/unx/inc/plugins/gtk/gtkdata.hxx
diff -N vcl/unx/inc/plugins/gtk/gtkdata.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/plugins/gtk/gtkdata.hxx	18 Dec 2003 13:09:58 -0000	1.1.2.8
@@ -0,0 +1,113 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKDATA_HXX
+#define _VCL_GTKDATA_HXX
+
+#include <prex.h>
+#include <gdk/gdk.h>
+#include <gdk/gdkx.h>
+#include <gtk/gtk.h>
+#include <postx.h>
+
+#include <saldisp.hxx>
+#include <saldata.hxx>
+#include <ptrstyle.hxx>
+
+#include <list>
+
+class GtkData : public SalData
+{
+public:
+    GtkData() {}
+    virtual ~GtkData();
+    
+    virtual void Init();
+};
+
+class GtkSalFrame;
+
+class GtkSalDisplay : public SalDisplay
+{
+    GdkDisplay*						m_pGdkDisplay;
+    std::list< GtkSalFrame* >		m_aFrames;
+	GtkSalFrame*					m_pCapture;
+	GdkCursor                      *m_aCursors[ POINTER_COUNT ];
+	GdkCursor *getFromXPM( const char *pBitmap, const char *pMask,
+						   int nWidth, int nHeight, int nXHot, int nYHot );
+public:
+			 GtkSalDisplay( GdkDisplay* pDisplay, Visual* pVis, Colormap aCol );
+    virtual ~GtkSalDisplay();
+
+    GdkDisplay* GetGdkDisplay() const { return m_pGdkDisplay; }
+
+    void registerFrame( GtkSalFrame* pFrame );
+    void deregisterFrame( GtkSalFrame* pFrame );
+	GdkCursor *getCursor( PointerStyle ePointerStyle );
+	void captureMouse( GtkSalFrame* pFrame );
+
+    static GdkFilterReturn filterGdkEvent( GdkXEvent* sys_event,
+                                           GdkEvent* event,
+                                           gpointer data );
+};
+
+
+#endif // _VCL_GTKDATA_HXX
Index: vcl/unx/inc/plugins/gtk/gtkframe.hxx
===================================================================
RCS file: vcl/unx/inc/plugins/gtk/gtkframe.hxx
diff -N vcl/unx/inc/plugins/gtk/gtkframe.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/plugins/gtk/gtkframe.hxx	21 Jan 2004 13:20:40 -0000	1.1.2.19
@@ -0,0 +1,239 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKFRAME_HXX
+#define _VCL_GTKFRAME_HXX
+
+#include <prex.h>
+#include <gtk/gtk.h>
+#include <gdk/gdkx.h>
+#include <gdk/gdkkeysyms.h>
+#include <postx.h>
+
+#ifndef _SV_SALFRAME_HXX
+#include <salframe.hxx>
+#endif
+#ifndef _SV_SYSDATA_HXX
+#include <sysdata.hxx>
+#endif
+
+class X11SalGraphics;
+class GtkSalDisplay;
+
+class GtkSalFrame : public SalFrame
+{
+    static const int nMaxGraphics = 2;
+
+    struct GraphicsHolder
+    {
+        X11SalGraphics*		pGraphics;
+        bool				bInUse;
+        GraphicsHolder() 
+                : pGraphics( NULL ),
+                  bInUse( false )
+        {}
+        ~GraphicsHolder();
+    };
+
+    GtkWindow*				m_pWindow;
+    ULONG					m_nStyle;
+    GtkFixed*				m_pFixedContainer;
+    GtkSalFrame*			m_pParent;
+    GdkWindowState			m_nState;
+    GtkIMContext*			m_pIMContext;
+    SystemEnvData			m_aSystemData;
+    GraphicsHolder			m_aGraphics[ nMaxGraphics ];
+	USHORT                  m_nKeyModifiers;
+	GdkCursor              *m_pCurrentCursor;
+	int						m_nSavedScreenSaverTimeout;
+    bool					m_bResizeable;
+	bool					m_bSingleAltPress;
+    bool					m_bDefaultPos;
+    bool					m_bSendModChangeOnRelease;
+
+    void Init( SalFrame* pParent, ULONG nStyle );
+    void Init( SystemParentData* pSysData );
+    void InitCommon();    
+
+    // signals
+    static gboolean		signalButton( GtkWidget*, GdkEventButton*, gpointer );
+    static void			signalStyleSet( GtkWidget*, GtkStyle* pPrevious, gpointer );
+    static gboolean		signalExpose( GtkWidget*, GdkEventExpose*, gpointer );
+    static gboolean		signalFocus( GtkWidget*, GdkEventFocus*, gpointer );
+    static gboolean		signalMap( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalUnmap( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalConfigure( GtkWidget*, GdkEventConfigure*, gpointer );
+    static gboolean		signalMotion( GtkWidget*, GdkEventMotion*, gpointer );
+    static gboolean		signalKey( GtkWidget*, GdkEventKey*, gpointer );
+    static gboolean		signalDelete( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalState( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalScroll( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalCrossing( GtkWidget*, GdkEventCrossing*, gpointer );
+    static void			signalIMCommit( GtkIMContext*, gchar*, gpointer );
+    static gboolean		signalIMDeleteSurrounding( GtkIMContext*, gint, gint, gpointer );
+    static void			signalIMPreeditChanged( GtkIMContext*, gpointer );
+    static void			signalIMPreeditEnd( GtkIMContext*, gpointer );
+    static void			signalIMPreeditStart( GtkIMContext*, gpointer );
+    static gboolean		signalIMRetrieveSurrounding( GtkIMContext*, gpointer );
+    
+
+	GtkSalDisplay *getDisplay();
+	GdkDisplay    *getGdkDisplay();
+    void		   Center();
+	void		   setAutoLock( bool bLock );
+	void		   setScreenSaverTimeout( int nTimeout );
+
+public:
+    GtkSalFrame( SalFrame* pParent, ULONG nStyle );
+    GtkSalFrame( SystemParentData* pSysData );
+
+    // dispatches an event, returns true if dispatched
+    // and false else; if true was returned the event should
+    // be swallowed
+    bool Dispatch( const XEvent* pEvent );
+	void grabPointer( BOOL bGrab );
+
+    GtkWindow* getWindow() const { return m_pWindow; }
+    GtkFixed* getFixedContainer() const { return m_pFixedContainer; }
+
+    virtual ~GtkSalFrame();
+
+    // SalGraphics or NULL, but two Graphics for all SalFrames
+    // must be returned
+    virtual SalGraphics*		GetGraphics();
+    virtual void				ReleaseGraphics( SalGraphics* pGraphics );
+
+    // Event must be destroyed, when Frame is destroyed
+    // When Event is called, SalInstance::Yield() must be returned
+    virtual BOOL				PostEvent( void* pData );
+
+    virtual void				SetTitle( const XubString& rTitle );
+    virtual void				SetIcon( USHORT nIcon );
+    virtual void              SetMenu( SalMenu *pSalMenu );
+    virtual void              DrawMenuBar();
+
+    // Before the window is visible, a resize event
+    // must be sent with the correct size
+    virtual void				Show( BOOL bVisible, BOOL bNoActivate = FALSE );
+    virtual void				Enable( BOOL bEnable );
+    // Set ClientSize and Center the Window to the desktop
+    // and send/post a resize message
+    virtual void              SetMinClientSize( long nWidth, long nHeight );
+    virtual void				SetPosSize( long nX, long nY, long nWidth, long nHeight, USHORT nFlags );
+    virtual void				GetClientSize( long& rWidth, long& rHeight );
+    virtual void				GetWorkArea( Rectangle& rRect );
+    virtual SalFrame*			GetParent() const;
+    virtual void				SetWindowState( const SalFrameState* pState );
+    virtual BOOL				GetWindowState( SalFrameState* pState );
+    virtual void				ShowFullScreen( BOOL bFullScreen );
+    // Enable/Disable ScreenSaver, SystemAgents, ...
+    virtual void				StartPresentation( BOOL bStart );
+    // Show Window over all other Windows
+    virtual void				SetAlwaysOnTop( BOOL bOnTop );
+
+    // Window to top and grab focus
+    virtual void				ToTop( USHORT nFlags );
+
+    // this function can call with the same
+    // pointer style
+    virtual void				SetPointer( PointerStyle ePointerStyle );
+    virtual void				CaptureMouse( BOOL bMouse );
+    virtual void				SetPointerPos( long nX, long nY );
+
+    // flush output buffer
+    virtual void				Flush();
+    // flush output buffer, wait till outstanding operations are done
+    virtual void				Sync();
+
+    virtual void				SetInputContext( SalInputContext* pContext );
+    virtual void				EndExtTextInput( USHORT nFlags );
+
+    virtual String				GetKeyName( USHORT nKeyCode );
+    virtual String				GetSymbolKeyName( const XubString& rFontName, USHORT nKeyCode );
+
+    // returns the input language used for the last key stroke
+    // may be LANGUAGE_DONTKNOW if not supported by the OS
+    virtual LanguageType		GetInputLanguage();
+
+    virtual SalBitmap*			SnapShot();
+
+    virtual void				UpdateSettings( AllSettings& rSettings );
+
+    virtual void				Beep( SoundType eSoundType );
+
+    // returns system data (most prominent: window handle)
+    virtual const SystemEnvData*	GetSystemData() const;
+
+
+    // get current modifier and button mask
+    virtual ULONG				GetCurrentModButtons();
+
+    // set new parent window
+    virtual void				SetParent( SalFrame* pNewParent );
+    // reparent window to act as a plugin; implementation
+    // may choose to use a new system window internally
+    // return false to indicate failure
+    virtual bool				SetPluginParent( SystemParentData* pNewParent );
+
+};
+
+
+#endif //_VCL_GTKFRAME_HXX
Index: vcl/unx/inc/plugins/gtk/gtkinst.hxx
===================================================================
RCS file: vcl/unx/inc/plugins/gtk/gtkinst.hxx
diff -N vcl/unx/inc/plugins/gtk/gtkinst.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/plugins/gtk/gtkinst.hxx	22 Jan 2004 12:52:41 -0000	1.1.2.8
@@ -0,0 +1,137 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKINST_HXX
+#define _VCL_GTKINST_HXX
+
+#include <salinst.h>
+#include <salsys.h>
+
+class GtkYieldMutex : public SalYieldMutex
+{
+public:
+												GtkYieldMutex();
+	virtual void								acquire();
+	virtual void								release();
+	virtual sal_Bool 							tryToAcquire();
+
+    virtual int Grab();
+    virtual void Ungrab( int );
+
+    class GtkYieldGuard
+    {
+        GtkYieldMutex*	m_pMutex;
+        int				m_nGrab;
+    public:
+        GtkYieldGuard( GtkYieldMutex* pMutex ) 
+                : m_pMutex( pMutex )
+        {
+            m_nGrab = m_pMutex->Grab();
+        }
+        ~GtkYieldGuard()
+        {
+            m_pMutex->Ungrab( m_nGrab );
+        }
+    };
+};
+
+class GtkHookedYieldMutex : public GtkYieldMutex
+{
+	virtual int		Grab()				{ return 0; };
+	virtual void		Ungrab(int )		{};
+	std::list<ULONG> aYieldStack;
+public:
+	GtkHookedYieldMutex();
+	virtual void      acquire() { SalYieldMutex::acquire(); }
+	virtual void      release() { SalYieldMutex::release(); }
+	virtual sal_Bool  tryToAcquire() { return SalYieldMutex::tryToAcquire(); }
+	void ThreadsEnter();
+	void ThreadsLeave();
+};
+
+
+#define GTK_YIELD_GRAB() GtkYieldMutex::GtkYieldGuard aLocalGtkYieldGuard( static_cast<GtkYieldMutex*>(GetSalData()->pInstance_->GetYieldMutex()) )
+
+class GtkInstance : public X11SalInstance
+{
+public:
+    GtkInstance( SalYieldMutex* pMutex ) 
+            : X11SalInstance( pMutex )
+    {}
+    virtual ~GtkInstance();
+
+    virtual SalFrame*			CreateFrame( SalFrame* pParent, ULONG nStyle );
+    virtual SalObject*			CreateObject( SalFrame* pParent );
+    virtual SalSystem*			CreateSalSystem();
+};
+
+class GtkSalSystem : public X11SalSystem
+{
+public:
+	GtkSalSystem() : X11SalSystem() {}
+    virtual ~GtkSalSystem();
+    virtual int ShowNativeDialog( const String& rTitle,
+                                  const String& rMessage,
+                                  const std::list< String >& rButtons,
+                                  int nDefButton );
+};
+
+#endif // _VCL_GTKINST_HXX
Index: vcl/unx/inc/plugins/gtk/gtkobject.hxx
===================================================================
RCS file: vcl/unx/inc/plugins/gtk/gtkobject.hxx
diff -N vcl/unx/inc/plugins/gtk/gtkobject.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ vcl/unx/inc/plugins/gtk/gtkobject.hxx	20 Jan 2004 16:44:47 -0000	1.1.2.3
@@ -0,0 +1,110 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKOBJECT_HXX
+#define _VCL_GTKOBJECT_HXX
+
+#ifndef _SV_SV_H
+#include <sv.h>
+#endif
+#ifndef _SV_SYSDATA_HXX
+#include <sysdata.hxx>
+#endif
+#ifndef _SV_SALOBJ_HXX
+#include <salobj.hxx>
+#endif
+#ifndef _VCL_GTKFRAME_HXX
+#include <plugins/gtk/gtkframe.hxx>
+#endif
+
+class GtkSalObject : public SalObject
+{
+	SystemChildData		m_aSystemData;
+    GtkWidget*			m_pSocket;
+    GdkRegion*			m_pRegion;
+
+    // signals
+    static gboolean		signalButton( GtkWidget*, GdkEventButton*, gpointer );
+    static gboolean		signalFocus( GtkWidget*, GdkEventFocus*, gpointer );
+public:
+    GtkSalObject( GtkSalFrame* pParent );
+    virtual ~GtkSalObject();
+
+    // overload all pure virtual methods
+ 	virtual void					ResetClipRegion();
+	virtual USHORT					GetClipRegionType();
+	virtual void					BeginSetClipRegion( ULONG nRects );
+	virtual void					UnionClipRegion( long nX, long nY, long nWidth, long nHeight );
+	virtual void					EndSetClipRegion();
+
+	virtual void					SetPosSize( long nX, long nY, long nWidth, long nHeight );
+	virtual void					Show( BOOL bVisible );
+	virtual void					Enable( BOOL nEnable );
+	virtual void					GrabFocus();
+
+	virtual void					SetBackground();
+	virtual void					SetBackground( SalColor nSalColor );
+
+	virtual const SystemEnvData*	GetSystemData() const;
+   
+};
+
+#endif // _SV_SALOBJ_H


