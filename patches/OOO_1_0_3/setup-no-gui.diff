Index: setup2/inc/main.hxx
===================================================================
RCS file: /cvs/oo/installation/setup2/inc/main.hxx,v
retrieving revision 1.12.4.3
diff -u -p -u -r1.12.4.3 main.hxx
--- setup2/inc/main.hxx	26 Mar 2003 11:07:27 -0000	1.12.4.3
+++ setup2/inc/main.hxx	28 Apr 2003 10:45:17 -0000
@@ -153,6 +153,7 @@ enum SetupParameter
     PAR_FOLLOW_APP,
     PAR_DONT_DELETE_TEMP,
     PAR_PATCH,
+    PAR_NO_GUI,
     PAR_UNKNOWN
 };
 
@@ -185,6 +186,7 @@ private:
 	BOOL				m_bInterrupt			: 1;
 	BOOL				m_bParamDoCRCCheck		: 1;
 	BOOL 				m_bOfficeMode			: 1;
+	BOOL                            m_bParamDisableGUI              : 1;
 	BOOL 				m_bIsAppServerInstall	: 1;
 	BOOL 				m_bResponseWizard		: 1;
 	#if defined WIN || defined WNT
Index: setup2/source/ui/main.cxx
===================================================================
RCS file: /cvs/oo/installation/setup2/source/ui/main.cxx,v
retrieving revision 1.67.2.5
diff -u -p -u -r1.67.2.5 main.cxx
--- setup2/source/ui/main.cxx	26 Mar 2003 11:07:39 -0000	1.67.2.5
+++ setup2/source/ui/main.cxx	28 Apr 2003 10:45:39 -0000
@@ -304,6 +304,7 @@ SetupApp::SetupApp()
 	m_bInterrupt		= FALSE;
 	m_bParamDoCRCCheck	= FALSE;
 	m_bOfficeMode		= FALSE;
+	m_bParamDisableGUI      = FALSE;
 	m_bResponseWizard	= FALSE;
     m_bNoVcl            = FALSE;
 
@@ -402,8 +403,9 @@ void SetupApp::Main()
 	UniString aParamError = ReadParams();
 
 	USHORT nResponseStep = m_pEnv->GetResponseStep();
+
     if( m_pEnv->GetResponseFilename().Len() &&
-        ( ( nResponseStep == 1 ) || ( nResponseStep == 2 ) ) )
+	( m_bParamDisableGUI || ( nResponseStep == 1 ) || ( nResponseStep == 2 ) ) )
     {
         m_bNoVcl = TRUE;
 		m_pEnv->SetHasVCL( FALSE );
@@ -1099,6 +1101,8 @@ SetupParameter SetupApp::GetParameter( c
         eParameter = PAR_DONT_DELETE_TEMP;
     else if( aParameter == "PATCH" )                        // Patch
         eParameter = PAR_PATCH;
+    else if( aParameter == "NOGUI" )                        // Disable GUI
+        eParameter = PAR_NO_GUI;
     else
         eParameter = PAR_UNKNOWN;
 
@@ -1265,6 +1269,10 @@ UniString SetupApp::ReadParams()
                             else
                                 bExtParamError = TRUE;
                             break;
+
+        case PAR_NO_GUI:
+			    m_bParamDisableGUI = TRUE;
+			    break;
 
         default:            bParameterError = TRUE;
         } // end switch ( eParameter )
