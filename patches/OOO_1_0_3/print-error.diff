Index: sfx2/source/view/prnmon.cxx
===================================================================
RCS file: /cvs/oo/framework/sfx2/source/view/prnmon.cxx,v
retrieving revision 1.4
diff -u -p -u -r1.4 prnmon.cxx
--- sfx2/source/view/prnmon.cxx	27 Sep 2001 13:13:38 -0000	1.4
+++ sfx2/source/view/prnmon.cxx	1 May 2003 14:15:07 -0000
@@ -321,11 +321,8 @@ IMPL_LINK_INLINE_START( SfxPrintProgress
 {
 	if ( pImp->pMonitor )
 		pImp->pMonitor->Hide();
-	pImp->pPrinter->AbortJob();
 	InfoBox( pImp->GetViewShell()->GetWindow(),
 			 String( SfxResId(STR_ERROR_PRINT) ) ).Execute();
-    if ( pImp->bRestoreFlag && pImp->pViewShell->GetObjectShell()->IsEnableSetModified() != pImp->bOldFlag )
-        pImp->pViewShell->GetObjectShell()->EnableSetModified( pImp->bOldFlag );
 	return 0;
 }
 IMPL_LINK_INLINE_END( SfxPrintProgress, PrintErrorNotify, void *, pvoid )
Index: vcl/source/gdi/impprn.cxx
===================================================================
RCS file: /cvs/oo/gsl/vcl/source/gdi/impprn.cxx,v
retrieving revision 1.4
diff -u -p -u -r1.4 impprn.cxx
--- vcl/source/gdi/impprn.cxx	4 Jul 2001 11:28:52 -0000	1.4
+++ vcl/source/gdi/impprn.cxx	1 May 2003 14:16:49 -0000
@@ -324,7 +324,8 @@ IMPL_LINK( ImplQPrinter, ImplPrintHdl, T
 	{
 		maTimer.Stop();
 		delete pActPage;
-		EndJob();
+		if (!EndJob())
+			mpParent->Error();
 		mpParent->ImplEndPrint();
 	}
 	else
