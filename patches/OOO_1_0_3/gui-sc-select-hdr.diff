Index: sc/source/ui/view/hdrcont.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/hdrcont.cxx,v
retrieving revision 1.3
diff -u -r1.3 hdrcont.cxx
--- sc/source/ui/view/hdrcont.cxx	24 Sep 2001 17:34:46 -0000	1.3
+++ sc/source/ui/view/hdrcont.cxx	5 Dec 2002 11:57:49 -0000
@@ -86,14 +86,15 @@
 //	(selection left/right must be first because the continuous lines
 //	are partly overwritten later)
 
-#define SC_HDRPAINT_SEL_RIGHT	0
-#define SC_HDRPAINT_SEL_LEFT	1
-#define SC_HDRPAINT_TOP			2
-#define SC_HDRPAINT_SEL_TOP		3
-#define SC_HDRPAINT_SEL_BOTTOM	4
-#define SC_HDRPAINT_BOTTOM		5
-#define SC_HDRPAINT_TEXT		6
-#define SC_HDRPAINT_COUNT		7
+#define SC_HDRPAINT_BG    	0
+//#define SC_HDRPAINT_SEL_RIGHT	1
+//#define SC_HDRPAINT_SEL_LEFT	2
+#define SC_HDRPAINT_TOP			1
+//#define SC_HDRPAINT_SEL_TOP		4
+//#define SC_HDRPAINT_SEL_BOTTOM	5
+#define SC_HDRPAINT_BOTTOM		2
+#define SC_HDRPAINT_TEXT		3
+#define SC_HDRPAINT_COUNT		4
 
 //==================================================================
 
@@ -255,6 +256,7 @@
 	SetTextColor( rStyleSettings.GetButtonTextColor() );
 	SetFillColor( rStyleSettings.GetFaceColor() );
 	SetLineColor();
+
 	DrawRect( rRect );
 
 	const FunctionSet*	pFuncSet = pSelEngine->GetFunctionSet();
@@ -324,21 +326,29 @@
 		//	set line color etc. before entry loop
 		switch ( nPass )
 		{
+			case SC_HDRPAINT_BG:
+			  SetFillColor( rStyleSettings.GetCheckedColor() );
+			  SetLineColor();
+			  break;
+#if 0
 			case SC_HDRPAINT_SEL_RIGHT:
 				SetLineColor( rStyleSettings.GetShadowColor() );
 				break;
 			case SC_HDRPAINT_SEL_LEFT:
 				SetLineColor( rStyleSettings.GetLightColor() );
 				break;
+#endif
 			case SC_HDRPAINT_TOP:
 				SetLineColor( rStyleSettings.GetLightColor() );
 				break;
+#if 0
 			case SC_HDRPAINT_SEL_TOP:
 				SetLineColor( rStyleSettings.GetLightColor() );
 				break;
 			case SC_HDRPAINT_SEL_BOTTOM:
 				SetLineColor( rStyleSettings.GetShadowColor() );
 				break;
+#endif
 			case SC_HDRPAINT_BOTTOM:
 				SetLineColor( rStyleSettings.GetDarkShadowColor() );
 				break;
@@ -380,6 +390,12 @@
 
 					switch ( nPass )
 					{
+						case SC_HDRPAINT_BG:
+							if (bMark)
+								DrawRect( Rectangle( aScrPos.X() + 1, aScrPos.Y() + 1,
+										     aEndPos.X() - 1, aEndPos.Y() - 1 ) );
+							break;
+#if 0
 						case SC_HDRPAINT_SEL_LEFT:
 							if (bMark)
 							{
@@ -391,16 +407,6 @@
 							}
 							break;
 
-						case SC_HDRPAINT_SEL_TOP:
-							if (bMark)
-							{
-								if (bVertical)
-									aGrid.AddHorLine( aScrPos.X()+1, aEndPos.X()-2, aScrPos.Y()+1 );
-								else
-									aGrid.AddVerLine( aScrPos.X()+1, aScrPos.Y()+1, aEndPos.Y()-2 );
-							}
-							break;
-
 						case SC_HDRPAINT_SEL_RIGHT:
 							if (bMark)
 							{
@@ -411,7 +417,6 @@
 									aGrid.AddHorLine( aScrPos.X(), aEndPos.X(), aEndPos.Y()-1 );
 							}
 							break;
-
 						case SC_HDRPAINT_SEL_BOTTOM:
 							if (bMark)
 							{
@@ -421,6 +426,7 @@
 									aGrid.AddVerLine( aEndPos.X()-1, aScrPos.Y()+1, aEndPos.Y()-1 );
 							}
 							break;
+#endif
 
 						case SC_HDRPAINT_TOP:
 							if (bVertical)
