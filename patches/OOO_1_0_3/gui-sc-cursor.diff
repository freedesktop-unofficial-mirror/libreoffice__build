Index: sc/source/ui/view/gridwin4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin4.cxx,v
retrieving revision 1.9
diff -u -r1.9 gridwin4.cxx
--- sc/source/ui/view/gridwin4.cxx	12 Nov 2001 20:04:36 -0000	1.9
+++ sc/source/ui/view/gridwin4.cxx	5 Dec 2002 14:57:03 -0000
@@ -1520,6 +1526,8 @@
 
 // -------------------------------------------------------------------------
 
+#include <stdio.h>
+
 void ScGridWindow::DrawCursor()
 {
 	USHORT nTab = pViewData->GetTabNo();
@@ -1580,10 +1588,24 @@
 				aScrPos.Y() -= 2;
 				Rectangle aRect( aScrPos, Size( nSizeXPix + 3, nSizeYPix + 3 ) );
 
+//				fprintf (stderr, "Render cursor\n");
+				// Ugly cut and paste coding idiot been here ...
+				RasterOp oldOp = GetRasterOp ();
+				SetRasterOp (ROP_XOR);
+
+				SetLineColor( COL_WHITE );
+				SetFillColor( );
+
+				DrawRect( aRect );
+				DrawRect( Rectangle( aRect.Left()+2, aRect.Top()+2, aRect.Right()-2, aRect.Bottom()-2 ) );
+				
+				SetRasterOp (oldOp);
+#if 0
 				Invert(Rectangle( aRect.Left(), aRect.Top(), aRect.Left()+2, aRect.Bottom() ));
 				Invert(Rectangle( aRect.Right()-2, aRect.Top(), aRect.Right(), aRect.Bottom() ));
 				Invert(Rectangle( aRect.Left()+3, aRect.Top(), aRect.Right()-3, aRect.Top()+2 ));
 				Invert(Rectangle( aRect.Left()+3, aRect.Bottom()-2, aRect.Right()-3, aRect.Bottom() ));
+#endif
 			}
 			else
 			{

