Index: sw/source/filter/ww8/wrtww8.cxx
===================================================================
RCS file: /cvs/oo/sw/sw/source/filter/ww8/wrtww8.cxx,v
retrieving revision 1.19.4.1.2.1
diff -u -p -u -r1.19.4.1.2.1 wrtww8.cxx
--- sw/source/filter/ww8/wrtww8.cxx	1 Jun 2002 05:19:14 -0000	1.19.4.1.2.1
+++ sw/source/filter/ww8/wrtww8.cxx	14 May 2003 08:59:42 -0000
@@ -2011,6 +2011,13 @@ ULONG SwWW8Writer::StoreDoc()
 
 	PrepareStorage();
 
+	USHORT nRedlineMode = pDoc->GetRedlineMode();
+        if (pDoc->GetRedlineTbl().Count())
+	{
+		pDoc->SetRedlineMode(nRedlineMode | REDLINE_SHOW_DELETE |
+				     REDLINE_SHOW_INSERT);
+	}
+
 	PutNumFmtFontsInAttrPool();
 	PutEditEngFontsInAttrPool();
 	PutCJKandCTLFontsInAttrPool();
@@ -2115,12 +2122,8 @@ ULONG SwWW8Writer::StoreDoc()
 	pPiece = new WW8_WrPct( pFib->fcMin, bWrtWW8 );
 	pDop = new WW8Dop;
 
-	USHORT nRedlineMode = pDoc->GetRedlineMode();
 	pDop->fRevMarking = 0 != (REDLINE_ON & nRedlineMode);
 	pDop->fRMView = 0 != ( REDLINE_SHOW_DELETE & nRedlineMode );
-	if( pDoc->GetRedlineTbl().Count() )
-		pDoc->SetRedlineMode( nRedlineMode | REDLINE_SHOW_DELETE |
-											REDLINE_SHOW_INSERT );
 
 	// set AutoHyphenation flag if found in default para style
 	const SfxPoolItem* pItem;
