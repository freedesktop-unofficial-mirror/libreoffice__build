From 39149d2e881ef4c38f82d46b7c60e410d3933343 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:01:34 +0200
Subject: [PATCH 467/878] gstreamer-vcl.diff

---
 vcl/inc/vcl/salobj.hxx                |    2 ++
 vcl/inc/vcl/syschild.hxx              |    1 +
 vcl/source/window/syschild.cxx        |    6 ++++++
 vcl/unx/gtk/window/gtkobject.cxx      |    9 +++++++++
 vcl/unx/inc/plugins/gtk/gtkobject.hxx |    2 ++
 5 files changed, 20 insertions(+), 0 deletions(-)

diff --git a/vcl/inc/vcl/salobj.hxx b/vcl/inc/vcl/salobj.hxx
index 4124ec5..a6043b5 100644
--- a/vcl/inc/vcl/salobj.hxx
+++ b/vcl/inc/vcl/salobj.hxx
@@ -71,6 +71,8 @@ public:
     virtual void					SetBackground() = 0;
     virtual void					SetBackground( SalColor nSalColor ) = 0;
 
+        virtual void                                    SetForwardKey( BOOL bEnable ) {}
+
     virtual const SystemEnvData*	GetSystemData() const = 0;
 
     void					SetCallback( void* pInst, SALOBJECTPROC pProc )
diff --git a/vcl/inc/vcl/syschild.hxx b/vcl/inc/vcl/syschild.hxx
index f3d7511..8695ce1 100644
--- a/vcl/inc/vcl/syschild.hxx
+++ b/vcl/inc/vcl/syschild.hxx
@@ -62,6 +62,7 @@ public:
     //  however, this might not always be required
     void                    EnableEraseBackground( BOOL bEnable = TRUE );
     BOOL                    IsEraseBackgroundEnabled();
+     void                    SetForwardKey( BOOL bEnable );
 };
 
 #endif // _SV_SYSCHILD_HXX
diff --git a/vcl/source/window/syschild.cxx b/vcl/source/window/syschild.cxx
index ef71f83..0ff9189 100644
--- a/vcl/source/window/syschild.cxx
+++ b/vcl/source/window/syschild.cxx
@@ -190,3 +190,9 @@ BOOL SystemChildWindow::IsEraseBackgroundEnabled()
     else
         return FALSE;
 }
+
+void SystemChildWindow::SetForwardKey( BOOL bEnable )
+{
+       if ( mpWindowImpl->mpSysObj )
+               mpWindowImpl->mpSysObj->SetForwardKey( bEnable );
+}
diff --git a/vcl/unx/gtk/window/gtkobject.cxx b/vcl/unx/gtk/window/gtkobject.cxx
index 42a2e6d..53bd262 100644
--- a/vcl/unx/gtk/window/gtkobject.cxx
+++ b/vcl/unx/gtk/window/gtkobject.cxx
@@ -209,3 +209,12 @@ void GtkSalObject::signalDestroy( GtkObject* pObj, gpointer object )
         pThis->m_pSocket = NULL;
     }
 }
+
+void GtkSalObject::SetForwardKey( BOOL bEnable )
+{
+    printf ("GtkSalObject::SetForwardKey\n");
+    if( bEnable )
+        gtk_widget_add_events( GTK_WIDGET( m_pSocket ), GDK_KEY_PRESS_MASK | GDK_KEY_RELEASE );
+    else
+        gtk_widget_set_events( GTK_WIDGET( m_pSocket ), ~(GDK_KEY_PRESS_MASK | GDK_KEY_RELEASE) & gtk_widget_get_events( GTK_WIDGET( m_pSocket ) ) );
+}
diff --git a/vcl/unx/inc/plugins/gtk/gtkobject.hxx b/vcl/unx/inc/plugins/gtk/gtkobject.hxx
index 82f1a98..20bd093 100644
--- a/vcl/unx/inc/plugins/gtk/gtkobject.hxx
+++ b/vcl/unx/inc/plugins/gtk/gtkobject.hxx
@@ -62,6 +62,8 @@ public:
     virtual void					SetBackground();
     virtual void					SetBackground( SalColor nSalColor );
 
+        virtual void                                    SetForwardKey( BOOL bEnable );
+
     virtual const SystemEnvData*	GetSystemData() const;
    
 };
-- 
1.7.0.1

