From d881e7417fa011abf8e457d9f20650283592d1a4 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:01:27 +0200
Subject: [PATCH 462/878] gstreamer-config-office.diff

---
 configure.in |   27 +++++++++++++++++++++++++++
 set_soenv.in |    1 +
 2 files changed, 28 insertions(+), 0 deletions(-)

diff --git a/configure.in b/configure.in
index 02d34da..c5e3d72 100644
--- a/configure.in
+++ b/configure.in
@@ -299,6 +299,9 @@ AC_ARG_ENABLE(randr-link,
 [  --disable-randr-link    disable linking with libXrandr, instead dynamically 
                            open it at runtime
 ],,enable_randr_link=yes)
+AC_ARG_ENABLE(gstreamer,
+[  --disable-gstreamer     disable building the gstreamer avmedia backend
+],,enable_gstreamer=yes)
 AC_ARG_WITH(myspell-dicts,
 [  --without-myspell-dicts Removes myspell dictionaries from openoffice.org
                           installation set, for people building for specific
@@ -945,6 +948,7 @@ case "$build_os" in
 	solaris*)
 		test_gtk=yes
 		test_cairo=yes
+        build_gstreamer=yes
 		test_kde=yes
 		test_cups=yes
         test_randr=yes
@@ -978,6 +982,7 @@ case "$build_os" in
 	linux-gnu*)
 		test_gtk=yes
 		test_cairo=yes
+        build_gstreamer=yes
 		test_kde=yes
 		test_kde4=yes
 		test_cups=yes
@@ -1022,6 +1027,7 @@ case "$build_os" in
 	freebsd*)
 		test_gtk=yes
 		test_cairo=yes
+        build_gstreamer=yes
 		test_kde=yes
 		test_kde4=yes
 		test_cups=yes
@@ -1056,6 +1062,7 @@ case "$build_os" in
 	netbsd)
 		test_gtk=yes
 		test_cairo=yes
+        build_gstreamer=yes
 		test_kde=yes
 		test_kde4=yes
 		test_cups=no
@@ -6004,6 +6011,26 @@ AC_SUBST(CAIRO_CFLAGS)
 AC_SUBST(CAIRO_LIBS)
 
 dnl ===================================================================
+dnl Check whether the GStreamer libraries are available.
+dnl ===================================================================
+
+ENABLE_GSTREAMER=""
+
+if test  "$build_gstreamer" = "yes"; then
+
+    AC_MSG_CHECKING([whether to enable the GStreamer avmedia backend])
+    if test "x$enable_gstreamer" != "xno" ; then
+        ENABLE_GSTREAMER="TRUE"
+    AC_MSG_RESULT([yes])
+    PKG_CHECK_MODULES( GSTREAMER, gstreamer-0.10 gstreamer-plugins-base-0.10 )
+    else
+         AC_MSG_RESULT([no])
+    fi
+fi
+
+AC_SUBST(ENABLE_GSTREAMER)
+
+dnl ===================================================================
 dnl Check whether the OpenGL libraries are available
 dnl ===================================================================
 
diff --git a/set_soenv.in b/set_soenv.in
index ca2f1e4..c760fbe 100644
--- a/set_soenv.in
+++ b/set_soenv.in
@@ -1681,6 +1681,7 @@ ToFile( "ENABLE_DBUS",       "@ENABLE_DBUS@",      "e" );
 ToFile( "ENABLE_GCONF",      "@ENABLE_GCONF@",     "e" );
 ToFile( "ENABLE_GNOMEVFS",   "@ENABLE_GNOMEVFS@",  "e" );
 ToFile( "GNOMEVFS_HAS_LOCKING","@GNOMEVFS_HAS_LOCKING@",  "e" );
+ToFile( "ENABLE_GSTREAMER",  "@ENABLE_GSTREAMER@", "e" );
 ToFile( "ENABLE_GIO",        "@ENABLE_GIO@",       "e" );
 ToFile( "ENABLE_KDE",        "@ENABLE_KDE@",       "e" );
 ToFile( "KDE_CFLAGS",        "@KDE_CFLAGS@",       "e" );
-- 
1.7.0.1

