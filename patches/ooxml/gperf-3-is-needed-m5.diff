--- config_office/configure.in	16 Jan 2008 14:28:09 -0000	1.241
+++ config_office/configure.in	25 Jan 2008 15:19:31 -0000
@@ -761,6 +761,7 @@
 dnl Configure pre-requisites.
 dnl ===================================================================
 cat /dev/null > warn
+AC_PROG_EGREP
 AC_PROG_AWK
 AC_PATH_PROG( AWK, $AWK)
 if test -z "$AWK"; then
@@ -2981,6 +2981,12 @@
 if test -z "$GPERF"; then
 	AC_MSG_ERROR([gperf not found but needed. Install it.])
 fi
+AC_MSG_CHECKING([gperf version])
+if test "`$GPERF --version | $EGREP "^GNU\ gperf" | $AWK '{ print $3 }' | cut -d. -f1`" -ge "3"; then
+	AC_MSG_RESULT([OK])
+else
+	AC_MSG_ERROR([too old, you need at least 3.0.0])
+fi
 
 dnl ===================================================================
 dnl Check for building ODK
