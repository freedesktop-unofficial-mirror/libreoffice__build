--- vcl/unx/kde/kdedata.cxx	2004-09-08 17:37:08.000000000 +0200
+++ vcl/unx/kde/kdedata.cxx	2004-11-03 18:10:47.846181448 +0100
@@ -173,7 +173,9 @@ void KDEXLib::Init()
 
 	KCmdLineArgs::init( nFakeArgc, pFakeArgv, kAboutData );
 
+	KApplication::disableAutoDcopRegistration();
 	new KApplication();
+
     Display* pDisp = QPaintDevice::x11AppDisplay();
 	XVisualInfo aVI;
 	Colormap	aColMap;
--- vcl/unx/kde/makefile.mk	2004-11-03 18:15:44.184131232 +0100
+++ vcl/unx/kde/makefile.mk	2004-11-03 18:19:25.333511416 +0100
@@ -84,7 +84,7 @@ dummy:
 
 .IF "$(ENABLE_KDE)" != ""
 
-CFLAGS+=$(WIDGETSET_KDE_CFLAGS)
+CFLAGS+=$(KDE_CFLAGS)
 
 SLOFILES=\
 	$(SLO)$/kdedata.obj	\
--- vcl/unx/kde/salnativewidgets-kde.cxx	2004-09-08 17:37:30.000000000 +0200
+++ vcl/unx/kde/salnativewidgets-kde.cxx	2004-11-03 18:10:47.921170048 +0100
@@ -108,10 +108,6 @@
 #include <salframe.h>
 #endif
 
-#ifndef _SV_KDEINT_HXX
-#include <kdeint.hxx>
-#endif
-
 #ifndef _SV_SETTINGS_HXX
 #include <settings.hxx>
 #endif
@@ -116,6 +112,10 @@
 #include <settings.hxx>
 #endif
 
+#ifndef _RTL_USTRBUF_HXX_
+#include <rtl/ustrbuf.hxx>
+#endif
+
 #ifndef _VCL_KDEDATA_HXX
 #include <plugins/kde/kdedata.hxx>
 #endif
@@ -404,12 +404,12 @@ WidgetPainter::~WidgetPainter( void )
     delete m_pLineEdit, m_pLineEdit = NULL;
     delete m_pSpinWidget, m_pSpinWidget = NULL;
     delete m_pSpinEdit, m_pSpinEdit = NULL;
-    delete m_pTabLeft, m_pTabLeft = NULL;
-    delete m_pTabMiddle, m_pTabMiddle = NULL;
-    delete m_pTabRight, m_pTabRight = NULL;
     delete m_pTabAlone, m_pTabAlone = NULL;
     delete m_pTabBarParent, m_pTabBarParent = NULL;
-    delete m_pTabBar, m_pTabBar = NULL;
+    m_pTabBar = NULL;    // Deleted in m_pTabBarParent's destructor
+    m_pTabLeft = NULL;
+    m_pTabMiddle = NULL;
+    m_pTabRight = NULL;
     delete m_pTabWidget, m_pTabWidget = NULL;
     delete m_pListView, m_pListView = NULL;
     delete m_pScrollBar, m_pScrollBar = NULL;
@@ -1428,9 +1428,28 @@ static void modifyFont( Font &rFont, con
 {
     QFontInfo qFontInfo( rQFont );
     
-    rFont.SetName( String( qFontInfo.family().utf8(), RTL_TEXTENCODING_UTF8 ) );
-    
-    rFont.SetHeight( qFontInfo.pointSize() );
+    // Prepend the KDE font, do not override
+    OUString aQFontName = String( rQFont.family().utf8(), RTL_TEXTENCODING_UTF8 );
+    OUString aFontName = rFont.GetName();
+
+    if ( aQFontName.getLength() > 0 &&
+         aFontName.compareTo( aQFontName, aQFontName.getLength() ) != 0 )
+    {
+        OUStringBuffer aBuffer( 1024 );
+        aBuffer.append( aQFontName );
+        aBuffer.appendAscii( ";", 1 );
+        aBuffer.append( aFontName );
+        
+        rFont.SetName( aBuffer.makeStringAndClear() );
+    }
+    
+    // QFontInfo should give the right point size, but sometimes it does not,
+    // it seems.
+    int nPointSize = qFontInfo.pointSize();
+    if ( nPointSize <= 0 )
+        nPointSize = rQFont.pointSize();
+    if ( nPointSize > 0 )
+        rFont.SetHeight( nPointSize );
     
     rFont.SetItalic( qFontInfo.italic()? ITALIC_NORMAL: ITALIC_NONE );
     
