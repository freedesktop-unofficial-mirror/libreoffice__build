unchanged:
--- vcl/prj/d.lst	28 Jan 2004 15:21:59 -0000	1.29.102.1
+++ vcl/prj/d.lst	3 Mar 2004 15:32:07 -0000
@@ -131,6 +131,8 @@ hedabu: ..\inc\salctype.hxx %_DEST%\inc%
 hedabu: ..\inc\salgtype.hxx %_DEST%\inc%_EXT%\vcl\salgtype.hxx
 hedabu: ..\inc\salotype.hxx %_DEST%\inc%_EXT%\vcl\salotype.hxx
 hedabu: ..\inc\salstype.hxx %_DEST%\inc%_EXT%\vcl\salstype.hxx
+hedabu: ..\inc\salnativewidgets.hxx %_DEST%\inc%_EXT%\vcl\salnativewidgets.hxx
+hedabu: ..\unx\inc\salnativewidgets.h %_DEST%\inc%_EXT%\vcl\salnativewidgets.h
 hedabu: ..\inc\scrbar.hxx %_DEST%\inc%_EXT%\vcl\scrbar.hxx
 hedabu: ..\inc\seleng.hxx %_DEST%\inc%_EXT%\vcl\seleng.hxx
 hedabu: ..\inc\settings.hxx %_DEST%\inc%_EXT%\vcl\settings.hxx
unchanged:
unchanged:
--- vcl/source/app/svmain.cxx	11 Apr 2003 17:28:07 -0000	1.41
+++ vcl/source/app/svmain.cxx	3 Mar 2004 15:32:07 -0000
@@ -316,6 +316,8 @@ BOOL InitVCL( const ::com::sun::star::un
     InitSalMain();
 #endif
 
+    VCLInitNativeWidgets();
+
 #ifdef WNT
     // remember data, copied from WinMain
     SalData* pData = GetAppSalData();
@@ -643,6 +645,9 @@ void DeInitVCL()
 #ifndef REMOTE_APPSERVER
     DeInitSalMain();
 #endif
+
+    VCLDeinitNativeWidgets();
+
     if( pOwnSvApp )
     {
         delete pOwnSvApp;

unchanged:
--- vcl/unx/source/app/makefile.mk	15 Aug 2003 11:25:34 -0000	1.9.250.1
+++ vcl/unx/source/app/makefile.mk	3 Mar 2004 15:32:07 -0000
@@ -116,6 +116,10 @@ CDEFS+=-DHAVE_LIBSN
 CFLAGS+=$(LIBSN_CFLAGS)
 .ENDIF
 
+.IF "$(WITH_WIDGETSET)"!=""
+CFLAGS+= $(WIDGETSET_CFLAGS)
+.ENDIF
+
 .IF "$(OS)$(CPU)" == "SOLARISS"
 .IF "$(COM)"!="GCC"
 SLOFILES+=$(SLO)$/getfpsols.obj

unchanged:
--- vcl/unx/source/gdi/makefile.mk	27 Aug 2002 14:52:35 -0000	1.9
+++ vcl/unx/source/gdi/makefile.mk	3 Mar 2004 15:32:07 -0000
@@ -89,7 +89,6 @@ SLOFILES=	\
 		$(SLO)$/salogl.obj		\
 		$(SLO)$/charnames.obj	\
 		$(SLO)$/dtint.obj		\
-		$(SLO)$/kdeint.obj		\
 		$(SLO)$/gnomeint.obj	\
 		$(SLO)$/salcvt.obj		\
 		$(SLO)$/ansi1252.obj	\
@@ -98,6 +97,22 @@ SLOFILES=	\
 		$(SLO)$/xlfd_extd.obj	\
 		$(SLO)$/xlfd_smpl.obj	\
 		$(SLO)$/salgdi3.obj
+
+.IF "$(WITH_WIDGETSET)"=="gtk"
+	SLOFILES+= \
+		$(SLO)/salnativewidgets-gtk.obj \
+		$(SLO)$/kdeint.obj
+	CFLAGS+= $(WIDGETSET_CFLAGS)
+.ELIF "$(WITH_WIDGETSET)"=="kde"
+	# salnativewidgets-kde.cxx contains own implementation of KDEintegrator
+	SLOFILES+= \
+		$(SLO)/salnativewidgets-kde.obj
+	CFLAGS+= $(WIDGETSET_CFLAGS)
+.ELSE
+	SLOFILES+= \
+		$(SLO)/salnativewidgets-none.obj \
+		$(SLO)$/kdeint.obj
+.ENDIF
 
 .IF "$(USE_XPRINT)" == "TRUE"
 CFLAGS+=-D_USE_PRINT_EXTENSION_=1
unchanged:
--- vcl/unx/source/window/makefile.mk	27 Aug 2002 17:49:59 -0000	1.2
+++ vcl/unx/source/window/makefile.mk	3 Mar 2004 15:32:07 -0000
@@ -85,7 +85,13 @@ dummy:
 
 .IF "$(remote)"
 SLOFILES=	\
-		$(SLO)/FWS.obj $(SLO)/salframe.obj $(SLO)/salobj.obj
+		$(SLO)/FWS.obj		\
+		$(SLO)/salframe.obj	\
+		$(SLO)/salobj.obj
+.ENDIF
+
+.IF "$(WITH_WIDGETSET)"!=""
+CFLAGS+= $(WIDGETSET_CFLAGS)
 .ENDIF
 
 .ENDIF		# "$(GUIBASE)"!="unx"
unchanged:
--- vcl/util/makefile.mk	15 Aug 2003 11:26:42 -0000	1.47.10.1
+++ vcl/util/makefile.mk	3 Mar 2004 15:32:07 -0000
@@ -275,6 +275,10 @@ SHL1STDLIBS += -framework Cocoa
 
 .IF "$(GUIBASE)"=="unx"
 
+.IF "$(WITH_WIDGETSET)"=="gtk" || "$(WITH_WIDGETSET)"=="kde"
+	SHL1STDLIBS+=$(WIDGETSET_LIBS)
+.ENDIF
+
 .IF "$(WITH_LIBSN)"=="YES"
 SHL1STDLIBS+=$(LIBSN_LIBS)
 .ENDIF

unchanged:
--- vcl/win/source/gdi/MAKEFILE.MK	11 Apr 2003 17:35:54 -0000	1.4
+++ vcl/win/source/gdi/MAKEFILE.MK	3 Mar 2004 15:32:07 -0000
@@ -34,7 +34,9 @@ SLOFILES=   $(SLO)$/salgdi.obj   \
             $(SLO)$/salvd.obj    \
             $(SLO)$/salprn.obj   \
             $(SLO)$/salbmp.obj	 \
-            $(SLO)$/salogl.obj
+            $(SLO)$/salogl.obj  \
+	        $(SLO)$/salnativewidgets-luna.obj
+            
 
 .IF "$(ENABLE_CTL)" != ""
 SLOFILES+=$(SLO)$/winlayout.obj
@@ -53,7 +55,9 @@ OBJFILES=   $(OBJ)$/salgdi.obj   \
             $(OBJ)$/salvd.obj    \
             $(OBJ)$/salprn.obj   \
             $(OBJ)$/salbmp.obj	 \
-			$(OBJ)$/salogl.obj
+			$(OBJ)$/salogl.obj  \
+	        $(OBJ)$/salnativewidgets-luna.obj
+			
 .ENDIF
 
 # --- Targets ------------------------------------------------------
