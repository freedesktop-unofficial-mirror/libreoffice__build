diff -u vcl/source/control/button.cxx vcl/source/control/button.cxx
diff -u vcl/source/control/combobox.cxx vcl/source/control/combobox.cxx
--- vcl/source/control/combobox.cxx	3 Mar 2004 15:32:07 -0000
+++ vcl/source/control/combobox.cxx	2004-03-17 17:25:30.000000000 +0100
@@ -268,8 +268,8 @@
 
 	if ( mpFloatWin )
 		mpFloatWin->SetImplListBox( mpImplLB );
-//	else
-//		mpImplLB->GetMainWindow()->AllowGrabFocus( TRUE );
+	else
+		mpImplLB->GetMainWindow()->AllowGrabFocus( TRUE );
 
 	ImplCalcEditHeight();
 
@@ -653,9 +653,48 @@
 	if( IsDropDownBox() )
 	{
 		long nSBWidth = GetSettings().GetStyleSettings().GetScrollBarSize();
-		nSBWidth = CalcZoom( nSBWidth );
-		mpSubEdit->SetSizePixel( Size( aOutSz.Width() - nSBWidth, aOutSz.Height() ) );
-		mpBtn->SetPosSizePixel( aOutSz.Width() - nSBWidth, 0, nSBWidth, aOutSz.Height() );
+		long	nTop = 0;
+		long	nBottom = aOutSz.Height();
+
+        Window *pBorder = GetWindow( WINDOW_BORDER );
+		ImplControlValue aControlValue;
+		Point aPoint;
+		Region aContent, aBound;
+
+        // use the full extent of the control
+		Region aArea( Rectangle(aPoint, pBorder->GetOutputSizePixel()) );
+
+		if ( GetNativeControlRegion(CTRL_COMBOBOX, PART_BUTTON_DOWN,
+				aArea, 0, aControlValue, rtl::OUString(), aBound, aContent) )
+		{
+            // convert back from border space to local coordinates
+            aPoint = pBorder->ScreenToOutputPixel( OutputToScreenPixel( aPoint ) );
+            aContent.Move(-aPoint.X(), -aPoint.Y());
+
+			// use the themes drop down size for the button
+            aOutSz.Width() = aContent.GetBoundRect().Left();
+		    mpBtn->SetPosSizePixel( aContent.GetBoundRect().Left(), nTop, aContent.GetBoundRect().getWidth(), (nBottom-nTop) );
+
+            // adjust the size of the edit field
+            if ( GetNativeControlRegion(CTRL_COMBOBOX, PART_SUB_EDIT,
+                        aArea, 0, aControlValue, rtl::OUString(), aBound, aContent) )
+            {
+                // convert back from border space to local coordinates
+                aContent.Move(-aPoint.X(), -aPoint.Y());
+
+                // use the themes drop down size
+                Rectangle aContentRect = aContent.GetBoundRect();
+                mpSubEdit->SetPosSizePixel( aContentRect.TopLeft(), aContentRect.GetSize() );
+            }
+            else
+                mpSubEdit->SetSizePixel( aOutSz );
+		}
+		else
+        {
+            nSBWidth = CalcZoom( nSBWidth );
+		    mpSubEdit->SetSizePixel( Size( aOutSz.Width() - nSBWidth, aOutSz.Height() ) );
+		    mpBtn->SetPosSizePixel( aOutSz.Width() - nSBWidth, nTop, nSBWidth, (nBottom-nTop) );
+        }
 	}
 	else
 	{
@@ -768,6 +807,8 @@
 		}
 		Resize();
 		mpImplLB->Resize(); // Wird nicht durch ComboBox::Resize() gerufen, wenn sich die ImplLB nicht aendert.
+        SetBackground();    // due to a hack in Window::UpdateSettings the background must be reset 
+                            // otherwise it will overpaint NWF drawn comboboxes
 	}
 }
 
