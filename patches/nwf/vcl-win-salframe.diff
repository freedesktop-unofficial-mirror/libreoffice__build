unchanged:
--- vcl/win/source/window/salframe.cxx	15 Jan 2004 14:21:12 -0000	1.94.112.4
+++ vcl/win/source/window/salframe.cxx	3 Mar 2004 15:32:07 -0000
@@ -169,6 +169,10 @@ const unsigned int WM_USER_SYSTEM_WINDOW
 #define IMN_CLOSECANDIDATE              0x0004
 #endif
 
+#ifndef WM_THEMECHANGED
+#define WM_THEMECHANGED                 0x031A
+#endif
+
 // Macros for support of WM_UNICHAR & Keyman 6.0
 #define Uni_UTF32ToSurrogate1(ch)   (((unsigned long) (ch) - 0x10000) / 0x400 + 0xD800)
 #define Uni_UTF32ToSurrogate2(ch)   (((unsigned long) (ch) - 0x10000) % 0x400 + 0xDC00)
@@ -2754,6 +2758,7 @@ void SalFrame::UpdateSettings( AllSettin
         aStyleSettings.SetMenuColor( ImplWinColorToSal( GetSysColor( COLOR_MENU ) ) );
         aStyleSettings.SetMenuBarColor( aStyleSettings.GetMenuColor() );
         aStyleSettings.SetMenuBorderColor( aStyleSettings.GetLightBorderColor() ); // overriden below for flat menus
+        aStyleSettings.SetUseFlatBorders( FALSE );
         aStyleSettings.SetUseFlatMenues( FALSE );
         aStyleSettings.SetMenuTextColor( ImplWinColorToSal( GetSysColor( COLOR_MENUTEXT ) ) );
         aStyleSettings.SetActiveColor( ImplWinColorToSal( GetSysColor( COLOR_ACTIVECAPTION ) ) );
@@ -2771,6 +2776,10 @@ void SalFrame::UpdateSettings( AllSettin
                 aStyleSettings.SetMenuBarColor( ImplWinColorToSal( GetSysColor( COLOR_MENUBAR ) ) );
                 aStyleSettings.SetMenuHighlightColor( ImplWinColorToSal( GetSysColor( COLOR_MENUHILIGHT ) ) );
                 aStyleSettings.SetMenuBorderColor( ImplWinColorToSal( GetSysColor( COLOR_3DSHADOW ) ) );
+
+                // flat borders for our controls etc. as well in this mode (ie, no 3d borders)
+                // this is not active in the classic style appearance
+                aStyleSettings.SetUseFlatBorders( TRUE );
             }
         }
     }
@@ -3894,6 +3903,14 @@ static void UpdateFrameGeometry( HWND hW
 
     RECT aInnerRect;
     GetClientRect( hWnd, &aInnerRect );
+    if( aInnerRect.right )
+    {
+        // improve right decoration
+        aPt.x=aInnerRect.right;
+        aPt.y=aInnerRect.top;
+        ClientToScreen(hWnd, &aPt);
+        pFrame->maGeometry.nRightDecoration = aRect.right - aPt.x;
+    }
     if( aInnerRect.bottom ) // may be zero if window was not shown yet
         pFrame->maGeometry.nBottomDecoration += aRect.bottom - aPt.y - aInnerRect.bottom;
     else
@@ -5187,6 +5204,10 @@ LRESULT CALLBACK SalFrameWndProc( HWND h
         case WM_SYSCOLORCHANGE:
         case WM_TIMECHANGE:
             ImplHandleSettingsChangeMsg( hWnd, nMsg, wParam, lParam );
+            break;
+
+        case WM_THEMECHANGED:
+            GetSalData()->mbThemeChanged = TRUE;
             break;
 
         case SAL_MSG_USEREVENT:

