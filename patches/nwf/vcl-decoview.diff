unchanged:
--- vcl/source/window/decoview.cxx	27 Mar 2003 17:58:20 -0000	1.4
+++ vcl/source/window/decoview.cxx	3 Mar 2004 15:32:07 -0000
@@ -969,9 +969,14 @@ static void ImplDrawFrame( OutputDevice*
 				{
 					if ( nFrameStyle == FRAME_DRAW_DOUBLEIN )
 					{
-						pDev->ImplDraw2ColorFrame( rRect,
-												   rStyleSettings.GetShadowColor(),
-												   rStyleSettings.GetLightColor() );
+                        if( rStyleSettings.GetUseFlatBorders() ) // no 3d effect
+                            pDev->ImplDraw2ColorFrame( rRect,
+												    rStyleSettings.GetShadowColor(),
+												    rStyleSettings.GetShadowColor() );
+                        else
+						    pDev->ImplDraw2ColorFrame( rRect,
+												    rStyleSettings.GetShadowColor(),
+												    rStyleSettings.GetLightColor() );
 					}
 					else
 					{
@@ -989,9 +994,14 @@ static void ImplDrawFrame( OutputDevice*
 
 					if ( nFrameStyle == FRAME_DRAW_DOUBLEIN )
 					{
-						pDev->ImplDraw2ColorFrame( rRect,
-												   rStyleSettings.GetDarkShadowColor(),
-												   rStyleSettings.GetLightBorderColor() );
+                        if( rStyleSettings.GetUseFlatBorders() ) // no 3d effect
+						    pDev->ImplDraw2ColorFrame( rRect,
+												    rStyleSettings.GetFaceColor(),
+												    rStyleSettings.GetFaceColor() );
+                        else
+						    pDev->ImplDraw2ColorFrame( rRect,
+												    rStyleSettings.GetDarkShadowColor(),
+												    rStyleSettings.GetLightBorderColor() );
 					}
 					else
 					{
