--- /data4/sles/ooo-build-NEWEST-Latest/ooo-build/build/ooe680-m2/basic/source/classes/sbunoobj.cxx	2006-11-28 12:26:41.000000000 +0000
+++ basic/source/classes/sbunoobj.cxx	2006-11-29 14:36:06.000000000 +0000
@@ -510,7 +510,7 @@ SbxDataType unoToSbxType( const Referenc
 	return eRetType;
 }
 void unoToSbxValue( SbxVariable* pVar, const Any& aValue );
-static void implSequenceToMultiDimArray( SbxDimArray*& pArray, Sequence< sal_Int32 >& indices, Sequence< sal_Int32 >& sizes, const Any& aValue, sal_Int32& dimension, sal_Bool bIsZeroIndex )
+static void implSequenceToMultiDimArray( SbxDimArray*& pArray, Sequence< sal_Int32 >& indices, Sequence< sal_Int32 >& sizes, const Any& aValue, sal_Int32& dimension, sal_Bool bIsZeroIndex, Type* pType = NULL )
 {
 	Type aType = aValue.getValueType();
 	TypeClass eTypeClass = aType.getTypeClass();
@@ -522,6 +522,11 @@ static void implSequenceToMultiDimArray(
 	{
 		Reference< XIdlClass > xIdlTargetClass = TypeToIdlClass( aType );
 		Reference< XIdlArray > xIdlArray = xIdlTargetClass->getArray();
+		typelib_TypeDescription * pTD = 0;
+        aType.getDescription( &pTD );
+		Type aElementType( ((typelib_IndirectTypeDescription *)pTD)->pType );
+		::typelib_typedescription_release( pTD );
+
 		sal_Int32 nLen = xIdlArray->getLen( aValue );
 		for ( sal_Int32 index = 0; index < nLen; ++index )
 		{
@@ -544,7 +549,7 @@ static void implSequenceToMultiDimArray(
 			else 
 				indices[ dimCopy - 1] = index + 1;
 
-			implSequenceToMultiDimArray( pArray, indices, sizes, aElementAny, dimCopy, bIsZeroIndex );
+			implSequenceToMultiDimArray( pArray, indices, sizes, aElementAny, dimCopy, bIsZeroIndex, &aElementType );
 		}
 		
 	}
@@ -560,9 +565,9 @@ static void implSequenceToMultiDimArray(
 			return;
 		}
 
+		SbxDataType eSbxElementType = unoToSbxType( pType ? pType->getTypeClass() : aValue.getValueTypeClass() );
 		if ( !pArray )
 		{
-			SbxDataType eSbxElementType = unoToSbxType( aValue.getValueTypeClass() );
 			pArray = new SbxDimArray( eSbxElementType );
 			sal_Int32 nIndexLen = indices.getLength();
 		
@@ -579,7 +584,6 @@ static void implSequenceToMultiDimArray(
 
 		if ( pArray )
 		{
-			SbxDataType eSbxElementType = unoToSbxType( aValue.getValueTypeClass() );
 			SbxVariableRef xVar = new SbxVariable( eSbxElementType );
 			unoToSbxValue( (SbxVariable*)xVar, aValue );
 
