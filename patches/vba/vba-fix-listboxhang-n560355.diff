From 4d146ed12801f3f3deb7e0cd5d3a627be256c7ee Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:00:04 +0200
Subject: [PATCH 393/878] vba-fix-listboxhang-n560355.diff

---
 toolkit/source/awt/vclxwindows.cxx |   17 -----------------
 1 files changed, 0 insertions(+), 17 deletions(-)

diff --git a/toolkit/source/awt/vclxwindows.cxx b/toolkit/source/awt/vclxwindows.cxx
index 55e7041..7fb2f97 100644
--- a/toolkit/source/awt/vclxwindows.cxx
+++ b/toolkit/source/awt/vclxwindows.cxx
@@ -1179,16 +1179,6 @@ void VCLXRadioButton::setProperty( const ::rtl::OUString& PropertyName, const ::
                         pButton->Check( b );
                     else
                         pButton->SetState( b );
-                    // If VBA - need to be able to test
-                    // simulate click event
-                    if ( maActionListeners.getLength() )
-                    {
-                        ::com::sun::star::awt::ActionEvent aEvent;
-                        aEvent.Source = (::cppu::OWeakObject*)this;
-                        aEvent.ActionCommand = maActionCommand;
-                        maActionListeners.actionPerformed( aEvent );
-                    }
-
                 }
             }
             break;
@@ -1951,11 +1941,8 @@ void VCLXListBox::setProperty( const ::rtl::OUString& PropertyName, const ::com:
                 ::com::sun::star::uno::Sequence< ::rtl::OUString> aItems;
                 if ( Value >>= aItems )
                 {
-                    sal_Int16 nElem  = pListBox->GetEntryCount();
                     pListBox->Clear();
                     addItems( aItems, 0 );
-                    if ( aItems.getLength() == 0 && nElem && maItemListeners.getLength() )
-                        ImplCallItemListeners();
                 }
             }
             break;
@@ -1968,11 +1955,7 @@ void VCLXListBox::setProperty( const ::rtl::OUString& PropertyName, const ::com:
                         pListBox->SelectEntryPos( --n, sal_False );
 
                     if ( aItems.getLength() )
-                    {
                         selectItemsPos( aItems, sal_True );
-                       if ( maItemListeners.getLength() )
-                           ImplCallItemListeners();
-                    }
                     else
                         pListBox->SetNoSelection();
 
-- 
1.7.0.1

