 sc/source/ui/vba/vbarange.cxx |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

diff --git sc/source/ui/vba/vbarange.cxx sc/source/ui/vba/vbarange.cxx
index d9cc4ea..2e6eae1 100644
--- sc/source/ui/vba/vbarange.cxx
+++ sc/source/ui/vba/vbarange.cxx
@@ -1044,7 +1044,7 @@ public:
 };
 
 bool
-getCellRangesForAddress( USHORT& rResFlags, const rtl::OUString& sAddress, ScDocShell* pDocSh, ScRangeList& rCellRanges, formula::FormulaGrammar::AddressConvention& eConv )
+getCellRangesForAddress( USHORT& rResFlags, const rtl::OUString& sAddress, ScDocShell* pDocSh, ScRangeList& rCellRanges, formula::FormulaGrammar::AddressConvention& eConv, char cDelimiter = 0 )
 {
     
     ScDocument* pDoc = NULL;
@@ -1054,7 +1054,7 @@ getCellRangesForAddress( USHORT& rResFlags, const rtl::OUString& sAddress, ScDoc
         pDoc = pDocSh->GetDocument();
         String aString(sAddress);
         USHORT nMask = SCA_VALID;
-        rResFlags = rCellRanges.Parse( sAddress, pDoc, nMask, eConv, 0 );
+        rResFlags = rCellRanges.Parse( sAddress, pDoc, nMask, eConv, cDelimiter );
         if ( rResFlags & SCA_VALID )
         {
             return true;
@@ -1107,6 +1107,7 @@ bool getScRangeListForAddress( const rtl::OUString& sName, ScDocShell* pDocSh, S
                 }
             }
         }
+        char aChar = 0;
         if ( xNameAccess->hasByName( sAddress ) )
         {
             uno::Reference< sheet::XNamedRange > xNamed( xNameAccess->getByName( sAddress ), uno::UNO_QUERY_THROW );
@@ -1114,10 +1115,11 @@ bool getScRangeListForAddress( const rtl::OUString& sName, ScDocShell* pDocSh, S
             // As the address comes from OOO, the addressing
             // style is may not be XL_A1
             eConv = pDocSh->GetDocument()->GetAddressConvention();
+            aChar = ';';
         }	
 
         USHORT nFlags = 0;
-        if ( !getCellRangesForAddress( nFlags, sAddress, pDocSh, aCellRanges, eConv ) )
+        if ( !getCellRangesForAddress( nFlags, sAddress, pDocSh, aCellRanges, eConv, aChar ) )
             return false;
     
         bool bTabFromReferrer = !( nFlags & SCA_TAB_3D );
