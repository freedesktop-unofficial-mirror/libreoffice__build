--- basic/source/runtime/methods.cxx.dateserial	2008-01-23 22:38:41.000000000 +0800
+++ basic/source/runtime/methods.cxx	2008-01-23 22:42:42.000000000 +0800
@@ -2039,17 +2039,16 @@ RTLFUNC(DateValue)
 		double fResult;
 		String aStr( rPar.Get(1)->GetString() );
 		BOOL bSuccess = pFormatter->IsNumberFormat( aStr, nIndex, fResult );
-		short nType = pFormatter->GetType( nIndex );
-		if(bSuccess && (nType==NUMBERFORMAT_DATE || nType==NUMBERFORMAT_DATETIME))
-		{
-			if ( nType == NUMBERFORMAT_DATETIME )
-			{
-				// Zeit abschneiden
-				if ( fResult  > 0.0 )
-					fResult = floor( fResult );
-				else
-					fResult = ceil( fResult );
-			}
+
+		// not check the type of number format. For most number 
+		// can be treated as a date type
+		if(bSuccess)
+		{
+			// Zeit abschneiden
+			if ( fResult  > 0.0 )
+				fResult = floor( fResult );
+			else
+				fResult = ceil( fResult );
 			// fResult += 2.0; // Anpassung  StarCalcFormatter
 			rPar.Get(0)->PutDate( fResult ); // JSM
 		}
