--- /dev/null	2004-08-25 23:04:59.000000000 +0530
+++ sc/source/ui/vba/vbarange.cxx	2005-05-19 13:31:56.003665598 +0530
@@ -0,0 +1,65 @@
+#include <cppuhelper/queryinterface.hxx>
+
+#include "vbarange.hxx"
+
+using namespace ::org::openoffice;
+using namespace ::com::sun::star;
+
+// XInterface implementation
+uno::Any ScVbaRange::queryInterface( const uno::Type & rType ) throw (uno::RuntimeException)
+{
+    return cppu::queryInterface
+			(rType, 
+			 static_cast< uno::XInterface * >( static_cast< vba::XRange * >( this ) ),
+			 static_cast< vba::XRange * >( this ) );
+}
+
+double
+ScVbaRange::getValue() throw (::com::sun::star::uno::RuntimeException)
+{
+	uno::Reference< table::XCell > xCell = mxRange->getCellByPosition( 0, 0 );
+	return xCell->getValue();
+}
+
+void
+ScVbaRange::setValue( double value ) throw (::com::sun::star::uno::RuntimeException)
+{
+	uno::Reference< table::XCell > xCell = mxRange->getCellByPosition( 0, 0 );
+	xCell->setValue( value );
+}
+
+void
+ScVbaRange::clear( ) throw (::com::sun::star::uno::RuntimeException)
+{
+	//FIXME: should get cell range by name ? and not by position 
+	uno::Reference< sheet::XSheetOperation > xSheetOperation(mxRange->getCellRangeByPosition( 0, 0, 0, 0 ), uno::UNO_QUERY);
+	//FIXME: add all flags here?
+	xSheetOperation->clearContents(sheet::CellFlags::VALUE );
+}
+
+void
+ScVbaRange::clearcomments( ) throw (::com::sun::star::uno::RuntimeException)
+{
+	//FIXME: should get cell range by name ? and not by position 
+	uno::Reference< sheet::XSheetOperation > xSheetOperation(mxRange->getCellRangeByPosition( 0, 0, 0, 0 ), uno::UNO_QUERY);
+	//FIXME: STRING is not the correct type; May require special handling; clearNotes?
+	xSheetOperation->clearContents(sheet::CellFlags::STRING);
+}
+
+void
+ScVbaRange::clearcontents( ) throw (::com::sun::star::uno::RuntimeException)
+{
+	//FIXME: should get cell range by name ? and not by position 
+	uno::Reference< sheet::XSheetOperation > xSheetOperation(mxRange->getCellRangeByPosition( 0, 0, 0, 0 ), uno::UNO_QUERY);
+	xSheetOperation->clearContents(sheet::CellFlags::VALUE | sheet::CellFlags::STRING );
+}
+
+void
+ScVbaRange::clearformats( ) throw (::com::sun::star::uno::RuntimeException)
+{
+	//FIXME: should get cell range by name ? and not by position 
+	uno::Reference< sheet::XSheetOperation > xSheetOperation(mxRange->getCellRangeByPosition( 0, 0, 0, 0 ), uno::UNO_QUERY);
+	//FIXME: need to check if we need to combine sheet::CellFlags::FORMATTED
+	xSheetOperation->clearContents(sheet::CellFlags::HARDATTR | sheet::CellFlags::FORMATTED | sheet::CellFlags::EDITATTR);
+}
+
