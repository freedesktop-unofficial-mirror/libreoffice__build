Index: offuh/prj/d.lst
===================================================================
RCS file: /cvs/api/offuh/prj/d.lst,v
retrieving revision 1.59
diff -u -r1.59 d.lst
--- offuh/prj/d.lst	9 Jun 2005 14:54:16 -0000	1.59
+++ offuh/prj/d.lst	19 Sep 2005 10:54:08 -0000
@@ -114,6 +114,13 @@
 mkdir: %_DEST%\inc%_EXT%\com\sun\star\xml\wrapper
 #i20156 - end
 
+mkdir: %_DEST%\inc%_EXT%\MSForms
+
+mkdir: %_DEST%\inc%_EXT%\org
+mkdir: %_DEST%\inc%_EXT%\org\openoffice
+mkdir: %_DEST%\inc%_EXT%\org\openoffice\vba
+mkdir: %_DEST%\inc%_EXT%\org\openoffice\vba\Excel
+
 ..\%__SRC%\inc\com\sun\star\auth\*.hdl %_DEST%\inc%_EXT%\com\sun\star\auth\*.hdl
 ..\%__SRC%\inc\com\sun\star\auth\*.hpp %_DEST%\inc%_EXT%\com\sun\star\auth\*.hpp
 ..\%__SRC%\inc\com\sun\star\accessibility\*.hpp %_DEST%\inc%_EXT%\com\sun\star\accessibility\*.hpp
@@ -319,3 +326,11 @@
 ..\%__SRC%\inc\com\sun\star\xml\wrapper\*.hdl %_DEST%\inc%_EXT%\com\sun\star\xml\wrapper\*.hdl
 #i20156 - end
 dos: sh -c "if test %OS% = MACOSX; then create-bundle %_DEST%\lib%_EXT%\*.dylib; fi"
+
+..\%__SRC%\inc\MSForms\*.hpp %_DEST%\inc%_EXT%\MSForms\*.hpp
+..\%__SRC%\inc\MSForms\*.hdl %_DEST%\inc%_EXT%\MSForms\*.hdl
+
+..\%__SRC%\inc\org\openoffice\vba\*.hpp %_DEST%\inc%_EXT%\org\openoffice\vba\*.hpp
+..\%__SRC%\inc\org\openoffice\vba\*.hdl %_DEST%\inc%_EXT%\org\openoffice\vba\*.hdl
+..\%__SRC%\inc\org\openoffice\vba\Excel\*.hpp %_DEST%\inc%_EXT%\org\openoffice\vba\Excel\*.hpp
+..\%__SRC%\inc\org\openoffice\vba\Excel\*.hdl %_DEST%\inc%_EXT%\org\openoffice\vba\Excel\*.hdl
Index: offapi/prj/build.lst
===================================================================
RCS file: /cvs/api/offapi/prj/build.lst,v
retrieving revision 1.74
diff -u -r1.74 build.lst
--- offapi/prj/build.lst	10 Mar 2005 13:02:47 -0000	1.74
+++ offapi/prj/build.lst	19 Sep 2005 10:54:13 -0000
@@ -86,4 +86,6 @@
 oa	offapi\com\sun\star\geometry		    nmake	-	all	oa_geometry NULL
 oa	offapi\com\sun\star\rendering	        nmake	-	all oa_rendering oa_geometry NULL
 oa	offapi\drafts\com\sun\star\form         nmake	-	all	oa_drafts_form NULL
-oa     offapi\util                             nmake   -   all oa_util oa_auth oa_awt oa_chart oa_chart2 oa_config oa_configbootstrap oa_configbackend oa_configbackend_xml oa_datatrans_clip oa_datatrans_dnd oa_datatransfer oa_docu oa_draw oa_embed oa_fcomp oa_finsp oa_fcontr oa_fieldmaster oa_form oa_xforms oa_formula oa_frame oa_i18n oa_inst oa_ldap oa_ling2 oa_mail oa_media oa_mozilla oa_packages oa_manifest oa_zippackage oa_plug oa_pres oa_animations oa_putil oa_resrc oa_sax oa_xml_input oa_scan oa_sdb oa_sdbc oa_sdbcx oa_setup oa_sheet oa_style oa_svg oa_sync oa_sync2 oa_system oa_table oa_task oa_text oa_textfield oa_docinfo oa_ucb oa_view oa_xml oa_xml_dom oa_xml_xpath oa_xml_views oa_xml_events oa_image oa_xsd oa_inspection oa_ui oa_ui_dialogs oa_accessibility oa_form_binding oa_form_validation oa_form_submission oa_geometry oa_rendering oa_sfprovider oa_sfbrowse oa_drafts_form oa_deployment oa_deployment_ui oa_frame_status oa_gallery oa_graphic oa_security oa_crypto_sax oa_crypto oa_csax oa_wrapper NULL
+oa	offapi\org\openoffice\vba         nmake	-	all	oa_vba NULL
+oa	offapi\org\openoffice\vba\Excel         nmake	-	all	oa_excel NULL
+oa     offapi\util                             nmake   -   all oa_util oa_auth oa_awt oa_chart oa_chart2 oa_config oa_configbootstrap oa_configbackend oa_configbackend_xml oa_datatrans_clip oa_datatrans_dnd oa_datatransfer oa_docu oa_draw oa_embed oa_fcomp oa_finsp oa_fcontr oa_fieldmaster oa_form oa_xforms oa_formula oa_frame oa_i18n oa_inst oa_ldap oa_ling2 oa_mail oa_media oa_mozilla oa_packages oa_manifest oa_zippackage oa_plug oa_pres oa_animations oa_putil oa_resrc oa_sax oa_xml_input oa_scan oa_sdb oa_sdbc oa_sdbcx oa_setup oa_sheet oa_style oa_svg oa_sync oa_sync2 oa_system oa_table oa_task oa_text oa_textfield oa_docinfo oa_ucb oa_view oa_xml oa_xml_dom oa_xml_xpath oa_xml_views oa_xml_events oa_image oa_xsd oa_inspection oa_ui oa_ui_dialogs oa_accessibility oa_form_binding oa_form_validation oa_form_submission oa_geometry oa_rendering oa_sfprovider oa_sfbrowse oa_drafts_form oa_deployment oa_deployment_ui oa_frame_status oa_gallery oa_graphic oa_security oa_crypto_sax oa_crypto oa_csax oa_wrapper oa_vba oa_excel NULL
Index: offapi/prj/d.lst
===================================================================
RCS file: /cvs/api/offapi/prj/d.lst,v
retrieving revision 1.73
diff -u -r1.73 d.lst
--- offapi/prj/d.lst	10 Mar 2005 13:03:07 -0000	1.73
+++ offapi/prj/d.lst	19 Sep 2005 10:54:17 -0000
@@ -104,6 +104,11 @@
 mkdir: %COMMON_DEST%\idl%_EXT%\com\sun\star\xml\wrapper
 #i20156 - end
 
+mkdir: %COMMON_DEST%\idl%_EXT%\org
+mkdir: %COMMON_DEST%\idl%_EXT%\org\openoffice
+mkdir: %COMMON_DEST%\idl%_EXT%\org\openoffice\vba
+mkdir: %COMMON_DEST%\idl%_EXT%\org\openoffice\vba\Excel
+
 ..\%__SRC%\ucr\offapi.db %_DEST%\bin%_EXT%\offapi.rdb
 ..\%__SRC%\ucrdoc\offapi_doc.db %_DEST%\bin%_EXT%\offapi_doc.rdb
 ..\%__SRC%\ucr\types.db %_DEST%\bin%_EXT%\types.rdb
@@ -201,6 +206,9 @@
 ..\drafts\com\sun\star\chart\*.idl %COMMON_DEST%\idl%_EXT%\drafts\com\sun\star\chart
 ..\drafts\com\sun\star\form\*.idl %COMMON_DEST%\idl%_EXT%\drafts\com\sun\star\form
 
+..\org\openoffice\vba\*.idl %COMMON_DEST%\idl%_EXT%\org\openoffice\vba
+..\org\openoffice\vba\Excel\*.idl %COMMON_DEST%\idl%_EXT%\org\openoffice\vba\Excel
+
 #i20156 - add xmlsecurity module related
 ..\com\sun\star\security\*.idl %COMMON_DEST%\idl%_EXT%\com\sun\star\security
 ..\com\sun\star\xml\crypto\*.idl %COMMON_DEST%\idl%_EXT%\com\sun\star\xml\crypto
Index: offapi/util/makefile.mk
===================================================================
RCS file: /cvs/api/offapi/util/makefile.mk,v
retrieving revision 1.89
diff -u -r1.89 makefile.mk
--- offapi/util/makefile.mk	10 Mar 2005 13:03:32 -0000	1.89
+++ offapi/util/makefile.mk	19 Sep 2005 10:54:20 -0000
@@ -132,6 +132,11 @@
 	$(UCR)$/xsec-sax.db \
 	$(UCR)$/xsec-wrapper.db
 
+.IF "$(ENABLE_VBA)"=="YES"
+	UNOIDLDBFILES+=$(UCR)$/vba.db
+	UNOIDLDBFILES+=$(UCR)$/excel.db
+.ENDIF
+
 REFERENCE_RDB=$(PRJ)$/type_reference$/types.rdb
 
 REGISTRYCHECKFLAG=$(MISC)$/registrycheck.flag
Index: sc/prj/d.lst
===================================================================
RCS file: /cvs/sc/sc/prj/d.lst,v
retrieving revision 1.21
diff -u -r1.21 d.lst
--- sc/prj/d.lst	14 Mar 2005 09:46:35 -0000	1.21
+++ sc/prj/d.lst	29 Jul 2005 14:33:37 -0000
@@ -27,6 +27,7 @@
 ..\%__SRC%\misc\*.map %_DEST%\bin%_EXT%\*.map
 ..\%__SRC%\misc\sc.csv %_DEST%\inc%_EXT%\sc.csv
 ..\%__SRC%\lib\sci.lib %_DEST%\lib%_EXT%\sci.lib
+..\%__SRC%\lib\vba*.* %_DEST%\lib%_EXT%\vba*.*
 ..\%__SRC%\slb\lib*.* %_DEST%\lib%_EXT%\lib*.*
 ..\%__SRC%\lib\lib*.* %_DEST%\lib%_EXT%\lib*.*
 ..\xml\*.xml %_DEST%\xml%_EXT%\*.xml
Index: sc/util/makefile.mk
===================================================================
RCS file: /cvs/sc/sc/util/makefile.mk,v
retrieving revision 1.30
diff -u -p -u -r1.30 makefile.mk
--- sc/util/makefile.mk	15 Apr 2005 10:32:42 -0000	1.30
+++ sc/util/makefile.mk	8 Sep 2005 08:24:05 -0000
@@ -316,6 +316,35 @@ LIB8OBJFILES = \
 	    $(SLO)$/dpgroupdlg.obj	\
 		$(SLO)$/editfield.obj
 
+.IF "$(ENABLE_VBA)"=="YES"
+
+TARGET_VBA=vbaobj
+SHL9TARGET=$(TARGET_VBA)$(UPD)$(DLLPOSTFIX).uno
+SHL9IMPLIB=	i$(TARGET_VBA)
+
+SHL9VERSIONMAP=$(TARGET_VBA).map
+SHL9DEF=$(MISC)$/$(SHL9TARGET).def
+DEF9NAME=$(SHL9TARGET)
+
+SHL9STDLIBS= \
+		$(CPPUHELPERLIB) \
+		$(CPPULIB) \
+		$(COMPHELPERLIB) \
+		$(TOOLSLIB) \
+		$(SALLIB)\
+		$(BASICLIB)	\
+		$(SFXLIB)	\
+		$(SVXLIB)	\
+		$(SVTOOLLIB)    \
+		$(SVLLIB)       \
+		-l$(SHL8TARGET) \
+		-l$(SHL1TARGET)
+
+SHL9DEPN=$(SHL1TARGETN) $(SHL8TARGETN)
+SHL9LIBS=$(SLB)$/$(TARGET_VBA).lib
+
+.ENDIF
+
 # --- Targets -------------------------------------------------------------
 
 .INCLUDE :  target.mk
Index: unoil/util/makefile.mk
===================================================================
RCS file: /cvs/udk/unoil/util/makefile.mk,v
retrieving revision 1.2
diff -u -r1.2 makefile.mk
--- unoil/util/makefile.mk	26 Nov 2001 17:44:41 -0000	1.2
+++ unoil/util/makefile.mk	19 Sep 2005 13:49:43 -0000
@@ -71,6 +71,10 @@
 MAXLINELENGTH = 100000
 
 JARCLASSDIRS	= com drafts
+.IF "$(ENABLE_VBA)"=="YES"
+JARCLASSDIRS += org
+.ENDIF 
+
 JARTARGET		= $(TARGET).jar
 JARCOMPRESS 	= TRUE
 
