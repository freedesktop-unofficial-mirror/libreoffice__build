--- sc/source/ui/vba/vbaapplication.cxx	2007-02-07 17:08:52.000000000 +0000
+++ sc/source/ui/vba/vbaapplication.cxx	2007-02-19 19:43:32.000000000 +0000
@@ -302,13 +302,27 @@ ScVbaApplication::CountA( const uno::Any
 ::sal_Int32 SAL_CALL 
 ScVbaApplication::getCalculation() throw (css::uno::RuntimeException)
 {
-	return m_xCalculation;
+	uno::Reference<sheet::XCalculatable> xCalc(getCurrentDocument(), uno::UNO_QUERY_THROW);
+	if(xCalc->isAutomaticCalculationEnabled())
+		return excel::XlCalculation::xlCalculationAutomatic;
+	else
+		return excel::XlCalculation::xlCalculationManual;
 }
 
 void SAL_CALL 
 ScVbaApplication::setCalculation( ::sal_Int32 _calculation ) throw (css::uno::RuntimeException)
 {
-	m_xCalculation = _calculation;
+	uno::Reference< sheet::XCalculatable > xCalc(getCurrentDocument(), uno::UNO_QUERY_THROW);
+	switch(_calculation)
+	{
+		case excel::XlCalculation::xlCalculationManual:
+			xCalc->enableAutomaticCalculation(sal_False);
+			break;
+		case excel::XlCalculation::xlCalculationAutomatic:
+		case excel::XlCalculation::xlCalculationSemiautomatic:
+			xCalc->enableAutomaticCalculation(sal_True);
+			break;
+	}
 }
 
 uno::Any SAL_CALL 
