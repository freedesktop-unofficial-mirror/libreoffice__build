--- basic.orig/source/classes/sb.cxx	2006-11-10 14:45:24.000000000 +0000
+++ basic/source/classes/sb.cxx	2006-11-13 17:09:45.000000000 +0000
@@ -845,8 +845,16 @@ void StarBASIC::InitAllModules( StarBASI
 		SbModule* pModule = (SbModule*)pModules->Get( nMod );
 		if(	!pModule->IsCompiled() )
 			pModule->Compile();
+	}
+	// compile modules first then RunInit ( otherwise there is 
+	// can be order dependency, e.g. classmodule A has a member
+	// of of type classmodule B and classmodule B hasn't been compiled yet )
+	for ( USHORT nMod = 0; nMod < pModules->Count(); nMod++ )
+	{
+		SbModule* pModule = (SbModule*)pModules->Get( nMod );
 		pModule->RunInit();
 	}
+
 	// Alle Objekte ueberpruefen, ob es sich um ein Basic handelt
 	// Wenn ja, auch dort initialisieren
 	for ( USHORT nObj = 0; nObj < pObjs->Count(); nObj++ )
