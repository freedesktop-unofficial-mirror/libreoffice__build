diff --git basic/source/comp/dim.cxx basic/source/comp/dim.cxx
index 6227a6d..fd70f31 100644
--- basic/source/comp/dim.cxx
+++ basic/source/comp/dim.cxx
@@ -227,12 +227,6 @@ void SbiParser::DefVar( SbiOpcode eOp, BOOL bStatic )
             Next();
             DefStatic( bPrivate );
         }
-		else if( eCurTok == DECLARE )
-                {
-			Next();
-                        DefDeclare( bPrivate ); 
-                        return;
-                }
         else if( eCurTok == SUB || eCurTok == FUNCTION || eCurTok == PROPERTY )
         {
             // End global chain if necessary (not done in 
diff --git sc/source/filter/excel/excimp8.cxx sc/source/filter/excel/excimp8.cxx
index a42f0b1..5c629fd 100644
--- sc/source/filter/excel/excimp8.cxx
+++ sc/source/filter/excel/excimp8.cxx
@@ -289,7 +289,7 @@ void ImportExcel8::ReadBasic( void )
                 if ( pAppMgr )
                     pAppMgr->SetGlobalUNOConstant( "ThisExcelDoc", aArgs[ 0 ] );
             }
-            aBasicImport.Import( EXC_STORAGE_VBA_PROJECT, EXC_STORAGE_VBA, bAsComment );
+            aBasicImport.Import( EXC_STORAGE_VBA_PROJECT, EXC_STORAGE_VBA, AutoGeneratedCodeNames, bAsComment );
             if ( !bAsComment )
             {
                 GetObjectManager().SetOleNameOverrideInfo( aBasicImport.ControlNameForObjectId() );
diff --git svx/inc/svx/msvbahelper.hxx svx/inc/svx/msvbahelper.hxx
index 7d89456..294f26e 100644
--- svx/inc/svx/msvbahelper.hxx
+++ svx/inc/svx/msvbahelper.hxx
@@ -56,61 +56,3 @@ namespace ooo { namespace vba
 } }
 
 #endif
-/*************************************************************************
- *
- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
- * 
- * Copyright 2008 by Sun Microsystems, Inc.
- *
- * OpenOffice.org - a multi-platform office productivity suite
- *
- * $RCSfile: 
- * $Revision: 
- *
- * This file is part of OpenOffice.org.
- *
- * OpenOffice.org is free software: you can redistribute it and/or modify
- * it under the terms of the GNU Lesser General Public License version 3
- * only, as published by the Free Software Foundation.
- *
- * OpenOffice.org is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU Lesser General Public License version 3 for more details
- * (a copy is included in the LICENSE file that accompanied this code).
- *
- * You should have received a copy of the GNU Lesser General Public License
- * version 3 along with OpenOffice.org.  If not, see
- * <http://www.openoffice.org/license.html>
- * for a copy of the LGPLv3 License.
- *
- ************************************************************************/
-#ifndef _MSVBAHELPER_HXX
-#define _MSVBAHELPER_HXX
-
-#include <sfx2/objsh.hxx>
-#include "svx/svxdllapi.h"
-
-namespace ooo { namespace vba 
-{
-    class SVX_DLLPUBLIC VBAMacroResolvedInfo
-    {
-        SfxObjectShell* mpDocContext;
-        bool mbFound;
-        String msResolvedMacro;
-        public:
-        VBAMacroResolvedInfo() : mpDocContext(NULL), mbFound( false ){}
-        void SetResolved( bool bRes ) { mbFound = bRes; }
-        bool IsResolved() { return mbFound; }
-        void SetMacroDocContext(SfxObjectShell* pShell )  { mpDocContext = pShell; }
-        SfxObjectShell* MacroDocContext() { return mpDocContext; }
-        String ResolvedMacro() { return msResolvedMacro; }
-        void SetResolvedMacro(const String& sMacro ) { msResolvedMacro = sMacro; }
-    };
-
-    SVX_DLLPUBLIC String makeMacroURL( const String& sMacroName );
-    SVX_DLLPUBLIC  VBAMacroResolvedInfo resolveVBAMacro( SfxObjectShell* pShell, const rtl::OUString& sMod, bool bSearchGlobalTemplates = false );
-    SVX_DLLPUBLIC sal_Bool executeMacro( SfxObjectShell* pShell, const String& sMacroName, com::sun::star::uno::Sequence< com::sun::star::uno::Any >& aArgs, com::sun::star::uno::Any& aRet, const com::sun::star::uno::Any& aCaller );
-} }
-
-#endif

diff -r 012b41aad175 -r db4f7efff395 toolkit/source/awt/vclxwindows.cxx
--- toolkit/source/awt/vclxwindows.cxx	Fri Dec 18 19:20:13 2009 +0000
+++ toolkit/source/awt/vclxwindows.cxx	Mon Jan 11 10:31:59 2010 +0000
@@ -678,7 +678,6 @@
                      BASEPROPERTY_TABSTOP,
                      BASEPROPERTY_WRITING_MODE,
                      BASEPROPERTY_CONTEXT_WRITING_MODE,
-                     BASEPROPERTY_GROUPNAME,
                      0);
     VCLXImageConsumer::ImplGetPropertyIds( rIds );
 }




