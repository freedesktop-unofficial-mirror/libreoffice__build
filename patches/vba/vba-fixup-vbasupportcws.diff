From b8c116054c43910a8f64b3b4c7f21291ef983d64 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:00:09 +0200
Subject: [PATCH 397/878] vba-fixup-vbasupportcws.diff

---
 basic/source/comp/dim.cxx          |    6 ----
 sc/source/filter/excel/excimp8.cxx |    2 +-
 svx/inc/svx/msvbahelper.hxx        |   58 ------------------------------------
 toolkit/source/awt/vclxwindows.cxx |    1 -
 4 files changed, 1 insertions(+), 66 deletions(-)

diff --git a/basic/source/comp/dim.cxx b/basic/source/comp/dim.cxx
index 6131209..d0931ac 100644
--- a/basic/source/comp/dim.cxx
+++ b/basic/source/comp/dim.cxx
@@ -224,12 +224,6 @@ void SbiParser::DefVar( SbiOpcode eOp, BOOL bStatic )
             Next();
             DefStatic( bPrivate );
         }
-        else if( eCurTok == DECLARE )
-                {
-            Next();
-                        DefDeclare( bPrivate );
-                        return;
-                }
         else if( eCurTok == SUB || eCurTok == FUNCTION || eCurTok == PROPERTY )
         {
             // End global chain if necessary (not done in 
diff --git a/sc/source/filter/excel/excimp8.cxx b/sc/source/filter/excel/excimp8.cxx
index 32a529a..a049429 100644
--- a/sc/source/filter/excel/excimp8.cxx
+++ b/sc/source/filter/excel/excimp8.cxx
@@ -286,7 +286,7 @@ void ImportExcel8::ReadBasic( void )
                 if ( pAppMgr )
                     pAppMgr->SetGlobalUNOConstant( "ThisExcelDoc", aArgs[ 0 ] );
             }
-            aBasicImport.Import( EXC_STORAGE_VBA_PROJECT, EXC_STORAGE_VBA, bAsComment );
+            aBasicImport.Import( EXC_STORAGE_VBA_PROJECT, EXC_STORAGE_VBA, AutoGeneratedCodeNames, bAsComment );
             if ( !bAsComment )
             {
                 GetObjectManager().SetOleNameOverrideInfo( aBasicImport.ControlNameForObjectId() );
diff --git a/svx/inc/svx/msvbahelper.hxx b/svx/inc/svx/msvbahelper.hxx
index 40814db..b1db442 100644
--- a/svx/inc/svx/msvbahelper.hxx
+++ b/svx/inc/svx/msvbahelper.hxx
@@ -56,61 +56,3 @@ namespace ooo { namespace vba
 } }
 
 #endif
-/*************************************************************************
- *
- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
- *
- * Copyright 2008 by Sun Microsystems, Inc.
- *
- * OpenOffice.org - a multi-platform office productivity suite
- *
- * $RCSfile:
- * $Revision:
- *
- * This file is part of OpenOffice.org.
- *
- * OpenOffice.org is free software: you can redistribute it and/or modify
- * it under the terms of the GNU Lesser General Public License version 3
- * only, as published by the Free Software Foundation.
- *
- * OpenOffice.org is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU Lesser General Public License version 3 for more details
- * (a copy is included in the LICENSE file that accompanied this code).
- *
- * You should have received a copy of the GNU Lesser General Public License
- * version 3 along with OpenOffice.org.  If not, see
- * <http://www.openoffice.org/license.html>
- * for a copy of the LGPLv3 License.
- *
- ************************************************************************/
-#ifndef _MSVBAHELPER_HXX
-#define _MSVBAHELPER_HXX
-
-#include <sfx2/objsh.hxx>
-#include "svx/svxdllapi.h"
-
-namespace ooo { namespace vba
-{
-    class SVX_DLLPUBLIC VBAMacroResolvedInfo
-    {
-        SfxObjectShell* mpDocContext;
-        bool mbFound;
-        String msResolvedMacro;
-        public:
-        VBAMacroResolvedInfo() : mpDocContext(NULL), mbFound( false ){}
-        void SetResolved( bool bRes ) { mbFound = bRes; }
-        bool IsResolved() { return mbFound; }
-        void SetMacroDocContext(SfxObjectShell* pShell )  { mpDocContext = pShell; }
-        SfxObjectShell* MacroDocContext() { return mpDocContext; }
-        String ResolvedMacro() { return msResolvedMacro; }
-        void SetResolvedMacro(const String& sMacro ) { msResolvedMacro = sMacro; }
-    };
-
-    SVX_DLLPUBLIC String makeMacroURL( const String& sMacroName );
-    SVX_DLLPUBLIC  VBAMacroResolvedInfo resolveVBAMacro( SfxObjectShell* pShell, const rtl::OUString& sMod, bool bSearchGlobalTemplates = false );
-    SVX_DLLPUBLIC sal_Bool executeMacro( SfxObjectShell* pShell, const String& sMacroName, com::sun::star::uno::Sequence< com::sun::star::uno::Any >& aArgs, com::sun::star::uno::Any& aRet, const com::sun::star::uno::Any& aCaller );
-} }
-
-#endif
diff --git a/toolkit/source/awt/vclxwindows.cxx b/toolkit/source/awt/vclxwindows.cxx
index 7fb2f97..2878cf8 100644
--- a/toolkit/source/awt/vclxwindows.cxx
+++ b/toolkit/source/awt/vclxwindows.cxx
@@ -677,7 +677,6 @@ void VCLXImageControl::ImplGetPropertyIds( std::list< sal_uInt16 > &rIds )
                      BASEPROPERTY_TABSTOP,
                      BASEPROPERTY_WRITING_MODE,
                      BASEPROPERTY_CONTEXT_WRITING_MODE,
-                     BASEPROPERTY_GROUPNAME,
                      0);
     VCLXImageConsumer::ImplGetPropertyIds( rIds );
 }
-- 
1.7.0.1

