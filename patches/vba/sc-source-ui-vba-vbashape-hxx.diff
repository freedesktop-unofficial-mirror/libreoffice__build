--- sc/source/ui/vba/vbashape.hxx	
+++ sc/source/ui/vba/vbashape.hxx
@@ -38,13 +38,17 @@
 #include <org/openoffice/office/MsoShapeType.hpp>
 #include <com/sun/star/drawing/XShape.hpp>
 #include <com/sun/star/drawing/XShapes.hpp>
+#include <com/sun/star/lang/XEventListener.hpp>
 #include <com/sun/star/beans/XPropertySet.hpp>
 #include <org/openoffice/msforms/XShape.hpp>
 #include <org/openoffice/msforms/XLineFormat.hpp>
+#include <cppuhelper/implbase2.hxx>
 
 #include "vbahelperinterface.hxx"
 
-typedef InheritedHelperInterfaceImpl1< oo::msforms::XShape > ScVbaShape_BASE;
+typedef  ::cppu::WeakImplHelper2< oo::msforms::XShape, css::lang::XEventListener > ListeningShape;
+
+typedef InheritedHelperInterfaceImpl< ListeningShape > ScVbaShape_BASE;
 
 class ScVbaShape : public ScVbaShape_BASE
 {
@@ -52,18 +56,18 @@ private:
     css::uno::Reference< css::drawing::XShape > m_xShape;
     css::uno::Reference< css::drawing::XShapes > m_xShapes;
     css::uno::Reference< css::beans::XPropertySet > m_xPropertySet;
-    css::uno::Reference< css::lang::XEventListener > m_xEventListener;
-    css::uno::Reference< css::lang::XComponent > m_xComponent;
     sal_Int32 m_nType;
     css::uno::Any m_aRange;
 protected:
+	virtual void addListeners();
+	virtual void removeShapeListener() throw( css::uno::RuntimeException );
+	virtual void removeShapesListener() throw( css::uno::RuntimeException );
 	virtual rtl::OUString& getServiceImplName();
 	virtual css::uno::Sequence<rtl::OUString> getServiceNames();
 public:
     ScVbaShape( const css::uno::Reference< oo::vba::XHelperInterface >& xParent, const css::uno::Reference< css::uno::XComponentContext >& xContext, const css::uno::Reference< css::drawing::XShape > xShape, const css::uno::Reference< css::drawing::XShapes > xShapes, sal_Int32 nType ) throw ( css::lang::IllegalArgumentException );
     ScVbaShape( const css::uno::Reference< css::uno::XComponentContext >& xContext, const css::uno::Reference< css::drawing::XShape > xShape ) throw ( css::lang::IllegalArgumentException );
     virtual ~ScVbaShape();
-    virtual void removeResource() throw( css::uno::RuntimeException );
     css::uno::Any getRange() { return m_aRange; };
     void setRange( css::uno::Any aRange ) { m_aRange = aRange; };
 
@@ -101,5 +105,8 @@ public:
     virtual void SAL_CALL ScaleWidth( double Factor, sal_Bool RelativeToOriginalSize, sal_Int32 Scale ) throw (css::uno::RuntimeException);
     // Replace??
     virtual void SAL_CALL Select( const css::uno::Any& Replace ) throw (css::uno::RuntimeException);
+    virtual css::uno::Any SAL_CALL ShapeRange( const css::uno::Any& index ) throw ( css::uno::RuntimeException );
+    // XEventListener
+    virtual void SAL_CALL disposing( const css::lang::EventObject& rEventObject ) throw( css::uno::RuntimeException );
 };
 #endif//SC_VBA_SHAPE_HXX
