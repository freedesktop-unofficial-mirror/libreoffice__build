diff --git a/sc/source/ui/vba/vbaworkbook.cxx b/sc/source/ui/vba/vbaworkbook.cxx
index d2e40b8..d21ad52 100644
--- sc/source/ui/vba/vbaworkbook.cxx
+++ sc/source/ui/vba/vbaworkbook.cxx
@@ -436,8 +436,8 @@ uno::Any SAL_CALL
 ScVbaWorkbook::Names( ) throw (uno::RuntimeException)
 {
 	uno::Reference< frame::XModel > xModel( getModel() );
-	ScDocShell * pDocShell = ( ScDocShell* )SfxObjectShell::GetWorkingDocument();
-	if ( !pDocShell )
+	const uno::Reference< frame::XModel > xWorkingDoc( SfxObjectShell::GetWorkingDocument(), uno::UNO_SET_THROW );
+	if ( !xWorkingDoc.is() )
 		throw uno::RuntimeException(::rtl::OUString(
                                 RTL_CONSTASCII_USTRINGPARAM( "Cann't recognise the 'Names' interface. ") ),
                                 uno::Reference< XInterface >() );
