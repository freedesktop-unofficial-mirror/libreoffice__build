--- /dev/null	2004-07-26 12:51:14.000000000 +0100
+++ sc/source/ui/inc/vbaglobals.hxx	2005-05-18 10:57:28.228483296 +0100
@@ -0,0 +1,39 @@
+#ifndef SC_VBA_GLOBALS
+#define SC_VBA_GLOBALS
+
+#include <org/openoffice/vba/XGlobals.hpp>
+#include <com/sun/star/uno/Sequence.hxx>
+
+#define SC_VBA_GLOBALS_PROP "VBAGlobals"
+
+class ::org::openoffice::vba::XApplication;
+class ScVbaGlobalsImpl;
+
+class ScVbaGlobals : public org::openoffice::vba::XGlobals
+{
+	// UNO sucks for not providing a sane, thread-safe
+	// base-class for this.
+	sal_uInt32 mnRefCount;
+	ScVbaGlobalsImpl *pImpl;
+
+	public:
+	ScVbaGlobals();
+	virtual ~ScVbaGlobals() {}
+	static ScVbaGlobals *get();
+	static ::com::sun::star::uno::Sequence< ::com::sun::star::uno::Any > getGlobals();
+
+	public:
+	// XInterface
+    virtual void acquire() throw () { ++mnRefCount; }
+    virtual void release() throw () { if (! --mnRefCount) delete this; }
+    virtual com::sun::star::uno::Any queryInterface(
+			const com::sun::star::uno::Type & rType )
+				throw (com::sun::star::uno::RuntimeException);
+
+	// XGlobals
+	virtual ::com::sun::star::uno::Reference<
+			::org::openoffice::vba::XApplication > SAL_CALL getApplication()
+			throw (::com::sun::star::uno::RuntimeException);
+};
+
+#endif SC_VBA_GLOBALS
