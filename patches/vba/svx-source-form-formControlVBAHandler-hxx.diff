--- /dev/null	2005-06-05 14:44:09.000000000 +0100
+++ svx/source/form/formControlVBAHandler.hxx	2005-08-29 16:50:48.000000000 +0100
@@ -0,0 +1,53 @@
+#ifndef FORMCONTROLVBAHANDLER_HXX
+#define FORMCONTROLVBAHANDLER_HXX
+
+
+#include <com/sun/star/script/XEventAttacherManager.hpp>
+#include <com/sun/star/uno/XComponentContext.hpp>
+#include <com/sun/star/awt/XControl.hpp>
+#include <com/sun/star/script/ScriptEventDescriptor.hpp>
+#include <com/sun/star/script/XScriptListener.hpp>
+#include <cppuhelper/implbase1.hxx>
+
+#define css ::com::sun::star
+
+
+class FormControlVBAHandler
+{
+public:
+    FormControlVBAHandler( const css::uno::Reference< css::script::XEventAttacherManager >& xEvtAttachMgr, const css::uno::Reference< css::awt::XControl >& xControl);
+    ~FormControlVBAHandler() {}
+    bool createEventBindings( sal_Int32 nPos );
+
+private:
+   bool hasEvtBinding( sal_Int32 nPos, css::script::ScriptEventDescriptor& desc );
+   css::uno::Reference< css::script::XEventAttacherManager > m_xEvtAttachMgr; 
+   css::uno::Reference< css::awt::XControl > m_xControl; 
+   css::uno::Reference< css::uno::XComponentContext > m_xCtx;
+   ::rtl::OUString m_sControl;
+
+   
+};
+// don't need to know about this at de moment
+class FmFormModel;
+
+typedef ::cppu::WeakImplHelper1< css::script::XScriptListener > VBAScriptEventListener_BASE;
+class VBAScriptEventListener : public VBAScriptEventListener_BASE
+{
+public:
+    VBAScriptEventListener( FmFormModel& _rModel) : pModel( &_rModel ) {}
+    VBAScriptEventListener() : pModel( NULL ) {}
+    // XEventListener
+    virtual void SAL_CALL disposing(const ::com::sun::star::lang::EventObject& Source) throw( ::com::sun::star::uno::RuntimeException );
+
+    // XScriptListener
+    virtual void SAL_CALL firing(const  ::com::sun::star::script::ScriptEvent& evt) throw(::com::sun::star::uno::RuntimeException);
+    virtual ::com::sun::star::uno::Any SAL_CALL approveFiring(const  ::com::sun::star::script::ScriptEvent& evt) throw(::com::sun::star::reflection::InvocationTargetException, ::com::sun::star::uno::RuntimeException);
+    
+private:
+    void firing_Impl( const  css::script::ScriptEvent& evt, css::uno::Any *pSyncRet=0 ) throw( ::com::sun::star::uno::RuntimeException );
+     FmFormModel* pModel;
+
+};
+
+#endif
