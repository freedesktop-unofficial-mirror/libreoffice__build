--- /data4/scratch/oof680-m7/svx/source/msfilter/svxmsbas.cxx	2007-02-14 22:31:57.000000000 +0000
+++ svx//source/msfilter/svxmsbas.cxx	2007-02-19 10:53:15.000000000 +0000
@@ -435,15 +435,17 @@ BOOL SvxImportMSVBasic::ImportCode_Impl(
 						aSource += rtl::OUString::createFromAscii("\nEnd Sub");
 				}
 				::rtl::OUString aModName( sModule );
-
-				aSource = modeTypeComment + aSource;
-
-				Any aSourceAny;
-				aSourceAny <<= aSource;
-				if( xLib->hasByName( aModName ) )
-					xLib->replaceByName( aModName, aSourceAny );
-				else
-					xLib->insertByName( aModName, aSourceAny );
+				if ( aSource.getLength() )
+				{
+					aSource = modeTypeComment + aSource;
+
+					Any aSourceAny;
+					aSourceAny <<= aSource;
+					if( xLib->hasByName( aModName ) )
+						xLib->replaceByName( aModName, aSourceAny );
+					else
+						xLib->insertByName( aModName, aSourceAny );
+				}                                
 
 				bRet = true;
 			}
