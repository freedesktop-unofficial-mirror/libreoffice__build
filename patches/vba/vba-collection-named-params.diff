--- basic.orig/source/classes/sb.cxx	2006-10-27 09:39:26.000000000 +0100
+++ basic/source/classes/sb.cxx	2006-10-27 15:50:43.000000000 +0100
@@ -1548,11 +1548,12 @@ void BasicCollection::SFX_NOTIFY( SfxBro
 		ULONG nId = p->GetId();
 		BOOL bRead  = BOOL( nId == SBX_HINT_DATAWANTED );
 		BOOL bWrite = BOOL( nId == SBX_HINT_DATACHANGED );
+		BOOL bRequestInfo = BOOL( nId == SBX_HINT_INFOWANTED );
 		SbxVariable* pVar = p->GetVar();
 		SbxArray* pArg = pVar->GetParameters();
+		XubString aVarName( pVar->GetName() );
 		if( bRead || bWrite )
 		{
-			XubString aVarName( pVar->GetName() );
 			if( pVar->GetHashCode() == nCountHash
 				  && aVarName.EqualsIgnoreCaseAscii( pCountStr ) )
 				pVar->PutLong( xItemArray->Count32() );
@@ -1569,6 +1570,27 @@ void BasicCollection::SFX_NOTIFY( SfxBro
 				SbxObject::SFX_NOTIFY( rCst, rId1, rHint, rId2 );
 			return;
 		}
+		else if ( bRequestInfo )
+		{
+			if( pVar->GetHashCode() == nAddHash
+				  && aVarName.EqualsIgnoreCaseAscii( pAddStr ) )
+			{
+				SbxInfo* pInfo_ = new SbxInfo;
+				pInfo_->AddParam(  String( RTL_CONSTASCII_USTRINGPARAM("Item") ), SbxVARIANT, SBX_READ );	
+				pInfo_->AddParam(  String( RTL_CONSTASCII_USTRINGPARAM("Key") ), SbxVARIANT, SBX_READ | SBX_OPTIONAL );	
+				pInfo_->AddParam(  String( RTL_CONSTASCII_USTRINGPARAM("Before") ), SbxVARIANT, SBX_READ | SBX_OPTIONAL );	
+				pInfo_->AddParam(  String( RTL_CONSTASCII_USTRINGPARAM("After") ), SbxVARIANT, SBX_READ | SBX_OPTIONAL );	
+				pVar->SetInfo( pInfo_ );
+			}
+			else if( pVar->GetHashCode() == nItemHash
+				  && aVarName.EqualsIgnoreCaseAscii( pItemStr ) )
+			{
+				SbxInfo* pInfo_ = new SbxInfo;
+				pInfo_->AddParam(  String( RTL_CONSTASCII_USTRINGPARAM("Index") ), SbxVARIANT, SBX_READ | SBX_OPTIONAL);	
+				pVar->SetInfo( pInfo_ );
+				
+			}
+		}
 	}
 	SbxObject::SFX_NOTIFY( rCst, rId1, rHint, rId2 );
 }
@@ -1693,7 +1715,8 @@ void BasicCollection::CollItem( SbxArray
 		pRes = xItemArray->Get32( nIndex );
 	if( !pRes )
 		SetError( SbxERR_BAD_INDEX );
-	*(pPar_->Get(0)) = *pRes;
+	else
+		*(pPar_->Get(0)) = *pRes;
 }
 
 void BasicCollection::CollRemove( SbxArray* pPar_ )
