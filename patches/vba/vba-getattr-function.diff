--- basic/source/runtime/methods.cxx.orig	2008-01-01 23:33:26.000000000 +0800
+++ basic/source/runtime/methods.cxx	2008-01-01 23:30:00.000000000 +0800
@@ -2916,6 +2916,16 @@ RTLFUNC(GetAttr)
 	{
 		INT16 nFlags = 0;
 	
+		// In Windows, We want to use Windows API to get the file attributes
+		// for VBA interoperability.
+		BOOL bUCB = TRUE;
+		#ifdef _OLD_FILE_IMPL
+			#if defined( WNT )
+				if( SbiRuntime::isVBAEnabled() )
+					bUCB = FALSE;
+			#endif	
+		#endif
+		
 		// <-- UCB
 		if( hasUno() && bUCB )
 		{
