--- /dev/null	
+++ connectivity/source/drivers/evoab1.5/NResultSet.cxx	
@@ -0,0 +1,830 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  the BSD license.
+ *  
+ *  Copyright (c) 2003 by Sun Microsystems, Inc.
+ *  All rights reserved.
+ *
+ *  Redistribution and use in source and binary forms, with or without
+ *  modification, are permitted provided that the following conditions
+ *  are met:
+ *  1. Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *  2. Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in the
+ *     documentation and/or other materials provided with the distribution.
+ *  3. Neither the name of Sun Microsystems, Inc. nor the names of its
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ *  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ *  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ *  FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ *  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ *  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
+ *  OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ *  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
+ *  TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
+ *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *     
+ *************************************************************************/
+
+#ifndef _COMPHELPER_PROPERTY_HXX_
+#include <comphelper/property.hxx>
+#endif
+#ifndef _COMPHELPER_SEQUENCE_HXX_
+#include <comphelper/sequence.hxx>
+#endif
+#ifndef _CPPUHELPER_TYPEPROVIDER_HXX_
+#include <cppuhelper/typeprovider.hxx>
+#endif
+#ifndef _COMPHELPER_EXTRACT_HXX_
+#include <comphelper/extract.hxx>
+#endif
+#ifndef _COM_SUN_STAR_LANG_DISPOSEDEXCEPTION_HPP_
+#include <com/sun/star/lang/DisposedException.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_RESULTSETTYPE_HPP_
+#include <com/sun/star/sdbc/ResultSetType.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_FETCHDIRECTION_HPP_
+#include <com/sun/star/sdbc/FetchDirection.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_RESULTSETCONCURRENCY_HPP_
+#include <com/sun/star/sdbc/ResultSetConcurrency.hpp>
+#endif
+#ifndef _COMPHELPER_TYPES_HXX_
+#include <comphelper/types.hxx>
+#endif
+#ifndef _DBHELPER_DBEXCEPTION_HXX_
+#include <connectivity/dbexception.hxx>
+#endif
+#ifndef _CONNECTIVITY_TSORTINDEX_HXX_
+#include <TSortIndex.hxx>
+#endif
+#ifndef _RTL_STRING_HXX_
+#include <rtl/string.hxx>
+#endif
+#include <vector>
+#include <algorithm>
+#ifndef _CONNECTIVITY_EVOAB_RESULTSET_HXX_
+#include "NResultSet.hxx"
+#endif
+#ifndef _CONNECTIVITY_EVOAB_DATABASEMETADATA_HXX_
+#include "NDatabaseMetaData.hxx"
+#endif
+#ifndef _COM_SUN_STAR_SDBC_DATATYPE_HPP_
+#include <com/sun/star/sdbc/DataType.hpp>
+#endif
+#ifndef _COM_SUN_STAR_BEANS_PROPERTYATTRIBUTE_HPP_
+#include <com/sun/star/beans/PropertyAttribute.hpp>
+#endif
+//#ifndef _COM_SUN_STAR_SDBCX_COMPAREBOOKMARK_HPP_
+//#include <com/sun/star/sdbcx/CompareBookmark.hpp>
+//#endif
+#ifndef _CPPUHELPER_TYPEPROVIDER_HXX_
+#include <cppuhelper/typeprovider.hxx>
+#endif
+#ifndef _COM_SUN_STAR_LANG_DISPOSEDEXCEPTION_HPP_
+#include <com/sun/star/lang/DisposedException.hpp>
+#endif
+#ifndef _CONNECTIVITY_PROPERTYIDS_HXX_
+#include "propertyids.hxx"
+#endif
+#ifndef _SVTOOLS_LOGINDLG_HXX
+#include <svtools/logindlg.hxx>
+#endif 
+
+using namespace ::comphelper;
+using namespace connectivity;
+using namespace connectivity::evoab;
+using namespace cppu;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace ::com::sun::star::util;
+
+//------------------------------------------------------------------------------
+//	IMPLEMENT_SERVICE_INFO(OEvoabResultSet,"com.sun.star.sdbcx.OResultSet","com.sun.star.sdbc.ResultSet");
+::rtl::OUString SAL_CALL OEvoabResultSet::getImplementationName(  ) throw ( RuntimeException)	\
+{
+	return ::rtl::OUString::createFromAscii("com.sun.star.sdbcx.evoab.ResultSet");
+  	//return ::rtl::OUString::createFromAscii("com.sun.star.sdbc.evoab.ResultSet");
+}
+// -------------------------------------------------------------------------
+ Sequence< ::rtl::OUString > SAL_CALL OEvoabResultSet::getSupportedServiceNames(  ) throw( RuntimeException)
+{
+	 Sequence< ::rtl::OUString > aSupported(1);
+	aSupported[0] = ::rtl::OUString::createFromAscii("com.sun.star.sdbc.ResultSet");
+	return aSupported;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::supportsService( const ::rtl::OUString& _rServiceName ) throw( RuntimeException)
+{
+	Sequence< ::rtl::OUString > aSupported(getSupportedServiceNames());
+	const ::rtl::OUString* pSupported = aSupported.getConstArray();
+	const ::rtl::OUString* pEnd = pSupported + aSupported.getLength();
+	for (;pSupported != pEnd && !pSupported->equals(_rServiceName); ++pSupported)
+		;
+
+	return pSupported != pEnd;
+}
+
+// -------------------------------------------------------------------------
+OEvoabResultSet::OEvoabResultSet(OStatement_Base* pStmt,OEvoabConnection *pConnection) 
+	: OResultSet_BASE(m_aMutex)
+	,OPropertySetHelper(OResultSet_BASE::rBHelper)
+	,m_aStatement((OWeakObject*)pStmt)
+	,m_xMetaData(NULL)
+	,m_pStatement(pStmt)
+	,m_pConnection(pConnection)
+	,m_bWasNull(sal_True)
+	,m_nFetchSize(0)
+	,m_nResultSetType(ResultSetType::SCROLL_INSENSITIVE)
+	,m_nResultSetConcurrency(ResultSetConcurrency::READ_ONLY)
+	,m_nFetchDirection(FetchDirection::FORWARD)
+	,m_pContacts(NULL)
+	,m_nIndex(-1)
+	,m_nLength(0)
+{
+}
+
+// -------------------------------------------------------------------------
+OEvoabResultSet::~OEvoabResultSet()
+{
+}
+
+// -------------------------------------------------------------------------
+
+void OEvoabResultSet::construct(void)
+{
+}
+
+// -------------------------------------------------------------------------
+
+static ESource *
+findSource( const char *name )
+{
+	ESourceList *pSourceList = NULL;
+
+	g_return_val_if_fail (name != NULL, NULL);
+
+	if (!e_book_get_addressbooks (&pSourceList, NULL))
+		pSourceList = NULL;
+
+	for ( GSList *g = e_source_list_peek_groups (pSourceList); g; g = g->next)
+	{
+		for (GSList *s = e_source_group_peek_sources (E_SOURCE_GROUP (g->data)); s; s = s->next)
+		{
+			ESource *pSource = E_SOURCE (s->data);
+			if (!strcmp (e_source_peek_name (pSource), name))
+				return pSource;
+		}
+	}
+	return NULL;
+}
+
+static EBook *
+openBook( const char *abname )
+{
+	ESource *pSource = findSource (abname);
+	EBook *pBook = NULL;
+	if (pSource)
+			pBook = e_book_new (pSource, NULL);
+
+	if (pBook && !e_book_open (pBook, TRUE, NULL))
+	{
+		g_object_unref (G_OBJECT (pBook));
+		pBook = NULL;
+	}
+
+	return pBook;
+}
+
+static bool
+executeQuery (EBook *pBook, EBookQuery *pQuery, GList **ppList, GError **pError)
+{
+	ESource *pSource = e_book_get_source (pBook);
+	const char *pAuth = e_source_get_property (pSource, "auth");
+
+	*ppList = NULL;
+
+	gboolean success = e_book_get_contacts (pBook, pQuery, ppList, pError);
+
+	if (!success && pAuth)
+	{	// Most likely failed authentication
+		do
+		{
+			const char *pUser = e_source_get_property (pSource, "user");
+			::svt::LoginDialog aDlg (NULL,
+									 LF_NO_PATH | LF_NO_ACCOUNT | LF_NO_ERRORTEXT |
+									 LF_USERNAME_READONLY | LF_NO_SAVEPASSWORD |
+									 LF_NO_ERRORTEXT, String(), NULL);
+			aDlg.SetName( ::rtl::OUString::createFromAscii(pUser));
+			aDlg.ClearPassword();  // gives the password field focus
+			aDlg.SetLoginRequestText(::rtl::OUString::createFromAscii(""));
+			sal_Int32 nResult = aDlg.Execute();
+			if ( nResult != TRUE)
+				return false;
+			rtl::OString sPassword = rtl::OUStringToOString( aDlg.GetPassword(),
+															 RTL_TEXTENCODING_UTF8 );
+			if (e_book_authenticate_user (pBook, pUser, sPassword, pAuth, pError))
+				break;
+		} while (true);
+		
+		success = e_book_get_contacts (pBook, pQuery, ppList, pError);
+	}
+	return success;
+}
+
+void OEvoabResultSet::construct(const ::rtl::OUString sql)
+{
+	m_pURI = sql;
+
+	rtl::OString aURI( rtl::OUStringToOString( m_pURI, RTL_TEXTENCODING_UTF8 ) );
+
+#warning This is _totally_ broken
+	fprintf (stderr, "This is really bogus\n" );
+	sal_Int32 firstQuote = aURI.indexOf ('"');
+	sal_Int32 secondQuote = aURI.indexOf ('"', firstQuote + 1);
+	rtl::OString aTable = aURI.copy( firstQuote + 1, secondQuote - firstQuote - 1 );
+
+	EBook *pBook = openBook (aTable);
+
+#warning Jayants query mapper here ...
+
+	if (pBook)
+	{
+		EBookQuery *pQuery;
+		pQuery = e_book_query_field_test (E_CONTACT_FULL_NAME,
+										  E_BOOK_QUERY_CONTAINS, "");
+		executeQuery (pBook, pQuery, &m_pContacts, NULL);
+		m_nLength = g_list_length (m_pContacts);
+		m_nIndex = -1;
+	}
+}
+
+// -------------------------------------------------------------------------
+void OEvoabResultSet::disposing(void)
+{
+	OPropertySetHelper::disposing();
+
+	::osl::MutexGuard aGuard(m_aMutex);
+
+	m_aStatement	= NULL;
+	m_xMetaData		= NULL;
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL OEvoabResultSet::queryInterface( const Type & rType ) throw(RuntimeException)
+{
+	Any aRet = OPropertySetHelper::queryInterface(rType);
+	if(!aRet.hasValue())
+		aRet = OResultSet_BASE::queryInterface(rType);
+	return aRet;
+}
+// -------------------------------------------------------------------------
+ Sequence<  Type > SAL_CALL OEvoabResultSet::getTypes(  ) throw( RuntimeException)
+{
+	OTypeCollection aTypes(	::getCppuType( (const  Reference< ::com::sun::star::beans::XMultiPropertySet > *)0 ),
+												::getCppuType( (const  Reference< ::com::sun::star::beans::XFastPropertySet > *)0 ),
+												::getCppuType( (const  Reference< ::com::sun::star::beans::XPropertySet > *)0 ));
+
+	/* Dont know what is this yet */
+	return ::comphelper::concatSequences(aTypes.getTypes(),OResultSet_BASE::getTypes());
+}
+
+// -------------------------------------------------------------------------
+// XRow Interface 
+
+bool
+OEvoabResultSet::getValue( sal_Int32 nColumnNum, GType nType, GValue *pStackValue)
+{
+	const GParamSpec *pSpec = evoab::getField (nColumnNum - 1);
+	EContact *pContact = getCur();
+	
+	m_bWasNull = true;
+	if (!pSpec || !pContact)
+		return false;
+
+	if (G_PARAM_SPEC_VALUE_TYPE (pSpec) != nType)
+	{
+		g_warning ("Wrong type");
+		return false;
+	}
+	g_value_init (pStackValue, nType);
+	g_object_get_property (G_OBJECT (pContact),
+						   g_param_spec_get_name ((GParamSpec *) pSpec),
+						   pStackValue);
+	if (G_VALUE_TYPE (pStackValue) != nType)
+	{
+		g_warning ("Fetched type mismatch");
+		g_value_unset (pStackValue);
+		return false;
+	}
+
+	m_bWasNull = false;
+	return true;
+}
+
+/**
+ * getString:
+ * @nColumnNum: The column index from the table.
+ *
+ * If the equivalent NResultSetMetaData.cxx marks the columntype of
+ * nColumnNum as DataType::VARCHAR this accessor is used.
+ */
+::rtl::OUString SAL_CALL OEvoabResultSet::getString( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	rtl::OUString aResult;
+
+	GValue aValue = { 0, };
+	if (getValue (nColumnNum, G_TYPE_STRING, &aValue))
+	{
+		const char *pStr = g_value_get_string (&aValue);
+		rtl::OString aStr (pStr ? pStr : "");
+		aResult = rtl::OStringToOUString( aStr, RTL_TEXTENCODING_UTF8 );
+		g_value_unset (&aValue);
+	}
+	return aResult;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::getBoolean( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	sal_Bool bResult = sal_False;
+
+	GValue aValue = { 0, };
+	if (getValue (nColumnNum, G_TYPE_BOOLEAN, &aValue))
+	{
+		bResult = g_value_get_boolean (&aValue);
+		g_value_unset (&aValue);
+	}
+	return bResult ? sal_True : sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int64 SAL_CALL OEvoabResultSet::getLong( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return sal_Int64();
+}
+// -------------------------------------------------------------------------
+Reference< XArray > SAL_CALL OEvoabResultSet::getArray( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XClob > SAL_CALL OEvoabResultSet::getClob( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XBlob > SAL_CALL OEvoabResultSet::getBlob( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XRef > SAL_CALL OEvoabResultSet::getRef( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL OEvoabResultSet::getObject( sal_Int32 nColumnNum, const Reference< ::com::sun::star::container::XNameAccess >& typeMap ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return Any();
+}
+// -------------------------------------------------------------------------
+sal_Int16 SAL_CALL OEvoabResultSet::getShort( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return 0;
+}
+// -------------------------------------------------------------------------
+::com::sun::star::util::Time SAL_CALL OEvoabResultSet::getTime( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return ::com::sun::star::util::Time();
+}
+// -------------------------------------------------------------------------
+DateTime SAL_CALL OEvoabResultSet::getTimestamp( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return ::com::sun::star::util::DateTime();
+}
+// -------------------------------------------------------------------------
+Reference< XInputStream > SAL_CALL OEvoabResultSet::getBinaryStream( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XInputStream > SAL_CALL OEvoabResultSet::getCharacterStream( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return NULL;
+}
+// -------------------------------------------------------------------------
+sal_Int8 SAL_CALL OEvoabResultSet::getByte( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return 0;
+}
+// -------------------------------------------------------------------------
+Sequence< sal_Int8 > SAL_CALL OEvoabResultSet::getBytes( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	::osl::MutexGuard aGuard( m_aMutex );
+	return Sequence< sal_Int8 >();
+}
+// -------------------------------------------------------------------------
+::com::sun::star::util::Date SAL_CALL OEvoabResultSet::getDate( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return ::com::sun::star::util::Date();
+}
+// -------------------------------------------------------------------------
+double SAL_CALL OEvoabResultSet::getDouble( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return 0.0;
+}
+// -------------------------------------------------------------------------
+float SAL_CALL OEvoabResultSet::getFloat( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return 0.0;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL OEvoabResultSet::getInt( sal_Int32 nColumnNum ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	return 0;
+}
+// XRow Interface Ends 
+// -------------------------------------------------------------------------
+
+// XResultSetMetaDataSupplier Interface
+Reference< XResultSetMetaData > SAL_CALL OEvoabResultSet::getMetaData(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	OSL_TRACE("OEvoabResultSet::getMetaData");
+
+	if(!m_xMetaData.is())
+		m_xMetaData = new OEvoabResultSetMetaData(m_pStatement->getOwnConnection());
+	return m_xMetaData;
+}
+// XResultSetMetaDataSupplier Interface Ends
+// -------------------------------------------------------------------------
+
+// XResultSet Interface 
+sal_Bool SAL_CALL OEvoabResultSet::next(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return ++m_nIndex < m_nLength;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::wasNull(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_bWasNull;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::isBeforeFirst(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nIndex < 0;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL OEvoabResultSet::getRow(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nIndex;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::isAfterLast(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nIndex >= m_nLength;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::isFirst(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nIndex == 0;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::isLast(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nIndex == m_nLength - 1;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::beforeFirst(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex = -1;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::afterLast(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex = m_nLength;
+}
+// -------------------------------------------------------------------------
+
+sal_Bool SAL_CALL OEvoabResultSet::first(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex = 0;
+}
+// -------------------------------------------------------------------------
+
+sal_Bool SAL_CALL OEvoabResultSet::last(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex = m_nLength - 1;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::absolute( sal_Int32 row ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex = row;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::relative( sal_Int32 row ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex += row;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::previous(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	m_nIndex--;
+}
+// -------------------------------------------------------------------------
+Reference< XInterface > SAL_CALL OEvoabResultSet::getStatement(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_aStatement.get();
+}
+// -------------------------------------------------------------------------
+
+sal_Bool SAL_CALL OEvoabResultSet::rowDeleted(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+		
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::rowInserted(  ) throw(SQLException, RuntimeException)
+{	
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL OEvoabResultSet::rowUpdated(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+		
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::refreshRow(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+}
+//XResult Interface ends 
+// -------------------------------------------------------------------------
+// XCancellable
+void SAL_CALL OEvoabResultSet::cancel(  ) throw(RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	OSL_TRACE("In/Out: OEvoabResultSet::cancel" );
+
+}
+//XCloseable 
+void SAL_CALL OEvoabResultSet::close(  ) throw(SQLException, RuntimeException)
+{
+	{
+		::osl::MutexGuard aGuard( m_aMutex );
+		checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	}
+	OSL_TRACE("In/Out: OEvoabResultSet::close" );
+	// dispose();
+}
+
+// XWarningsSupplier
+// -------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::clearWarnings(  ) throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("In/Out: OEvoabResultSet::clearWarnings" );
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL OEvoabResultSet::getWarnings(  ) throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("In/Out: OEvoabResultSet::getWarnings" );
+	return Any();
+}
+// -------------------------------------------------------------------------
+//XColumnLocate Interface 
+sal_Int32 SAL_CALL OEvoabResultSet::findColumn( const ::rtl::OUString& columnName ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	// find the first column with the name columnName 
+	Reference< XResultSetMetaData > xMeta = getMetaData();
+	sal_Int32 nLen = xMeta->getColumnCount();
+	sal_Int32 i = 1;
+	for(;i<=nLen;++i)
+		if(xMeta->isCaseSensitive(i) ? columnName == xMeta->getColumnName(i) : 
+				columnName.equalsIgnoreAsciiCase(xMeta->getColumnName(i)))
+			break;
+	return i;
+}
+// -------------------------------------------------------------------------
+//XColumnLocate interface ends 
+
+// -------------------------------------------------------------------------
+IPropertyArrayHelper* OEvoabResultSet::createArrayHelper( ) const
+{
+	Sequence< Property > aProps(6);
+	Property* pProperties = aProps.getArray();
+	sal_Int32 nPos = 0;
+	DECL_PROP1IMPL(CURSORNAME,			::rtl::OUString) PropertyAttribute::READONLY);
+	DECL_PROP0(FETCHDIRECTION,			sal_Int32);
+	DECL_PROP0(FETCHSIZE,				sal_Int32);
+	DECL_BOOL_PROP1IMPL(ISBOOKMARKABLE) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETCONCURRENCY,sal_Int32) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETTYPE,		sal_Int32) PropertyAttribute::READONLY);
+
+	return new OPropertyArrayHelper(aProps);
+}
+// -------------------------------------------------------------------------
+IPropertyArrayHelper & OEvoabResultSet::getInfoHelper()
+{
+	return *const_cast<OEvoabResultSet*>(this)->getArrayHelper();
+}
+// -------------------------------------------------------------------------
+sal_Bool OEvoabResultSet::convertFastPropertyValue(
+							Any & rConvertedValue,
+							Any & rOldValue,
+							sal_Int32 nHandle,
+							const Any& rValue )
+								throw (::com::sun::star::lang::IllegalArgumentException)
+{
+	switch(nHandle)
+	{
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw ::com::sun::star::lang::IllegalArgumentException();
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		default:
+			;
+	}
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+void OEvoabResultSet::setFastPropertyValue_NoBroadcast(
+								sal_Int32 nHandle,
+								const Any& rValue
+												 )
+												 throw (Exception)
+{
+	switch(nHandle)
+	{
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw Exception();
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+			break;
+		case PROPERTY_ID_FETCHSIZE:
+			break;
+		default:
+			;
+	}
+}
+// -------------------------------------------------------------------------
+void OEvoabResultSet::getFastPropertyValue(
+								Any& rValue,
+								sal_Int32 nHandle
+									 ) const
+{
+
+	switch(nHandle)
+	{
+        case PROPERTY_ID_RESULTSETCONCURRENCY:
+            rValue <<= (sal_Int32)m_nResultSetConcurrency;
+            break;
+        case PROPERTY_ID_RESULTSETTYPE:
+            rValue <<= m_nResultSetType;
+            break;
+        case PROPERTY_ID_FETCHDIRECTION:
+            rValue <<= m_nFetchDirection;
+            break;
+        case PROPERTY_ID_FETCHSIZE:
+            rValue <<= m_nFetchSize;
+            break;
+	}
+
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::acquire() throw()
+{
+	OResultSet_BASE::acquire();
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL OEvoabResultSet::release() throw()
+{
+	OResultSet_BASE::release();
+}
+// -----------------------------------------------------------------------------
+::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL
+OEvoabResultSet::getPropertySetInfo(  ) throw(::com::sun::star::uno::RuntimeException)
+{
+	return ::cppu::OPropertySetHelper::createPropertySetInfo(getInfoHelper());
+}
+// -----------------------------------------------------------------------------
