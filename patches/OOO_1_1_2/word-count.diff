Index: sw/inc/cmdid.h
===================================================================
RCS file: /cvs/sw/sw/inc/cmdid.h,v
retrieving revision 1.46
diff -u -p -u -r1.46 cmdid.h
--- sw/inc/cmdid.h	22 May 2003 08:40:37 -0000	1.46
+++ sw/inc/cmdid.h	31 Jul 2003 17:01:16 -0000
@@ -749,6 +749,7 @@ Achtung: Ab sofort sind in diesem File k
 #define FN_MACRO_POPUP				(FN_EXTRA + 37)   /* Alle Macrofunktionen */
 #define FN_BULLET					(FN_EXTRA + 38)   /* Bullet-Liste */
 
+#define FN_WORD_COUNT_DLG                       (FN_EXTRA + 39)
 
 //	Bereich: Gloassaries
 
Index: sw/sdi/swriter.sdi
===================================================================
RCS file: /cvs/sw/sw/sdi/swriter.sdi,v
retrieving revision 1.43
diff -u -p -u -r1.43 swriter.sdi
--- sw/sdi/swriter.sdi	22 May 2003 08:42:09 -0000	1.43
+++ sw/sdi/swriter.sdi	31 Jul 2003 17:01:17 -0000
@@ -8482,6 +8482,29 @@ SfxBoolItem UnderlineDouble FN_UNDERLINE
 ]
 
 //--------------------------------------------------------------------------
+SfxVoidItem WordCount FN_WORD_COUNT_DLG
+()
+[
+	/* flags: */
+	AutoUpdate = FALSE,
+	Cachable = Cachable,
+	FastCall = FALSE,
+	HasCoreId = FALSE,
+	HasDialog = TRUE,
+	ReadOnlyDoc = TRUE,
+	Toggle = TRUE,
+	Container = FALSE,
+	Asynchron;
+
+	/* config: */
+	AccelConfig = TRUE,
+	MenuConfig = TRUE,
+	StatusBarConfig = FALSE,
+	ToolBoxConfig = TRUE,
+	GroupId = GID_DOCUMENT;
+]
+
+//--------------------------------------------------------------------------
 SfxVoidItem UnhainFrames FN_FRAME_UNCHAIN
 
 [
Index: sw/sdi/swslots.src
===================================================================
RCS file: /cvs/sw/sw/sdi/swslots.src,v
retrieving revision 1.109
diff -u -p -u -r1.109 swslots.src
--- sw/sdi/swslots.src	17 Jul 2003 11:48:28 -0000	1.109
+++ sw/sdi/swslots.src	31 Jul 2003 17:01:27 -0000
@@ -3685,6 +3685,55 @@ SfxSlotInfo FN_HYPHENATE_OPT_DLG
 	SlotName[ hindi ] = "‡§π‡§æ‡§á‡§´‡§®‡•á‡§∂‡§®";
 	SlotName[ slovak ] = "Delenie slov";
 };
+SfxSlotInfo FN_WORD_COUNT_DLG
+{
+	SlotName = "Wˆrter z‰hlen...";
+	SlotName[ arabic ] = "≈Õ’«∆Ì« ";
+	SlotName[ english ] = "Word count";
+	SlotName[ english_us ] = "Word count";
+	SlotName[ catalan ] = "Comptador de paraules";
+	SlotName[ czech ] = "Poƒçet slov";
+	SlotName[ danish ] = "Ordopt√¶lling";
+	SlotName[ greek ] = "¡ÒﬂËÏÁÛÁ À›ÓÂ˘Ì";
+	SlotName[ spanish ] = "Contar palabras";
+	SlotName[ estonian ] = "S√µnade arv";
+	SlotName[ finnish ] = "Laske sanat";
+	SlotName[ french ] = "Statistiques";
+	SlotName[ hindi ] = "‡§∂‡§¨‡•ç‡§¶ ‡§ó‡§ø‡§®‡•á‡§Ç";
+	SlotName[ italian ] = "Statistiche";
+	SlotName[ hungarian ] = "Szavak sz√°ma";
+	SlotName[ japanese ] = "„ÉØ„Éº„Éâ„Ç´„Ç¶„É≥„Éà";
+	SlotName[ korean ] = "ÌÜµÍ≥Ñ";
+	SlotName[ norwegian ] = "Ordtelling";
+	SlotName[ dutch ] = "Woorden tellen";
+	SlotName[ polish ] = "Liczba s≥Ûw";
+	SlotName[ portuguese ] = "Contagem palavras";
+	SlotName[ portuguese_brazilian ] = "Contagem palavras";
+	SlotName[ russian ] = " ÓÎË˜ÂÒÚ‚Ó ÒÎÓ‚";
+	SlotName[ slovak ] = "Poƒçet slov";
+	SlotName[ swedish ] = "Ordr√§kning";
+	SlotName[ turkish ] = "›statistik";
+	SlotName[ chinese_simplified ] = "ÁªüËÆ°";
+	SlotName[ chinese_traditional ] = "Áµ±Ë®à";
+	SlotName[ slovenian ] =	"≈†tevilo besed";
+	SlotName[ thai ] = "Word count";
+	SlotName[ hebrew ] = "Word count";
+	SlotName[ estonian ] = "Word count";
+/*	--: "Word count" translations
+	az:	"K…ôlm…ô Miqdarƒ±"
+	bs:	"Zbir rijeƒçi"
+	cy:	"Cyfrif geiriau"
+	eu:	"Hitz kopurua"
+	mk:	"–ë—Ä–æ–µ—ö–µ –Ω–∞ –∑–±–æ—Ä–æ–≤–∏"
+	mt:	"Gƒßadd ta‚Äô kliem"
+	ro:	"NumƒÉrƒÉ cuvintele"
+	sq:	"Llogariti fjal√´t"
+	ta:	"‡Æö‡Øä‡Æ≤‡Øç ‡Æé‡Æ£‡Øç‡Æ£‡Æø"
+	uk:	"–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª—ñ–≤"
+	vi:	"ƒê·∫øm t·ª´"
+	wa:	"Contaedje des mots"
+*/
+};
 SfxSlotInfo FN_IDX_MARK_TO_IDX
 {
 	SlotName = "Indexmarke zum Index";
Index: sw/sdi/viewsh.sdi
===================================================================
RCS file: /cvs/sw/sw/sdi/viewsh.sdi,v
retrieving revision 1.9
diff -u -p -u -r1.9 viewsh.sdi
--- sw/sdi/viewsh.sdi	6 Dec 2002 13:58:48 -0000	1.9
+++ sw/sdi/viewsh.sdi	31 Jul 2003 17:01:27 -0000
@@ -112,6 +112,12 @@ interface TextEditView : BaseTextEditVie
 		StateMethod = GetState ;
 		DisableFlags="SW_DISABLE_ON_PROTECTED_CURSOR";
 	]
+	FN_WORD_COUNT_DLG // status(final|play)
+	[
+		ExecMethod = ExecLingu ;
+		StateMethod = GetState ;
+		DisableFlags="SW_DISABLE_ON_PROTECTED_CURSOR";
+	];
 	FN_CHANGE_PAGENUM // status(final)
 	[
 		ExecMethod = ExecDlg ;
Index: sw/source/ui/inc/swmn.hrc
===================================================================
RCS file: /cvs/sw/sw/source/ui/inc/swmn.hrc,v
retrieving revision 1.133
diff --context=15 -c -r1.133 swmn.hrc
*** sw/source/ui/inc/swmn.hrc.orig	2004-09-22 09:41:21.000000000 -0400
--- sw/source/ui/inc/swmn.hrc	2004-09-23 09:09:01.214282641 -0400
***************
*** 9189,9218 ****
--- 9189,9270 ----
  				Text[ extern ] = "~Hyphenation...";
  				Text[ thai ] = "‡πÉ~‡∏ä‡πâ‡∏¢‡∏±‡∏ï‡∏¥‡∏†‡∏±‡∏á‡∏Ñ‡πå...";
  				Text[ czech ] = "Dƒõlen√≠ slov...";
  				Text[ hebrew ] = "◊©◊ë◊ô◊®◊™ ◊û◊ú◊ô◊ù...";
  				Text[ hindi ] = "~‡§π‡§æ‡§á‡§´‡§®‡•á‡§∂‡§®...";
  				Text[ slovak ] = "~Delenie slov...";
  				Text[ hungarian ] = "~Elv√°laszt√°s...";
  				Text[ slovenian ] = "~Deljenje besed...";
  				Text[ estonian ] = "~Poolitus...";
  				Text[ welsh ] = "~Cyplysnodi...";
  				Text[ northernsotho ] = "~Morathofatso...";
  				Text[ afrikaans ] = "~Woordafbreking...";
  				Text[ zulu ] = "~Ukwahlukaniswa kwamagama...";
  				Text[ norwegian_nynorsk ] = "Orddeli~ng ...";
  			};
+  			MenuItem
+  			{
+  				Identifier = FN_WORD_COUNT_DLG ;
+  				HelpID = FN_WORD_COUNT_DLG ;
+  				Text = "Wˆrter z‰hlen..." ;
+ 				Text [ arabic ] = "≈Õ’«∆Ì« ...";
+ 				Text [ english ] = "Word count...";
+ 				Text [ english_us ] = "Word count...";
+ 				Text [ catalan ] = "Comptador de paraules...";
+ 				Text [ czech ] = "Poƒçet slov...";
+ 				Text [ danish ] = "Ordopt√¶lling...";
+ 				Text [ greek ] = "¡ÒﬂËÏÁÛÁ À›ÓÂ˘Ì";
+ 				Text [ spanish ] = "Contar palabras...";
+ 				Text [ estonian ] = "S√µnade arv...";
+ 				Text [ finnish ] = "Laske sanat...";
+ 				Text [ french ] = "Statistiques...";
+ 				Text [ hindi ] = "‡§∂‡§¨‡•ç‡§¶ ‡§ó‡§ø‡§®‡•á‡§Ç...";
+ 				Text [ italian ] = "Statistiche...";
+ 				Text [ hungarian ] = "Szavak sz√°ma...";
+ 				Text [ japanese ] = "„ÉØ„Éº„Éâ„Ç´„Ç¶„É≥„Éà...";
+ 				Text [ korean ] = "ÌÜµÍ≥Ñ...";
+ 				Text [ norwegian ] = "Ordtelling...";
+ 				Text [ dutch ] = "Woorden tellen...";
+ 				Text [ polish ] = "Liczba s≥Ûw...";
+ 				Text [ portuguese ] = "Contagem palavras...";
+ 				Text [ portuguese_brazilian ] = "Contagem palavras...";
+ 				Text [ russian ] = " ÓÎË˜ÂÒÚ‚Ó ÒÎÓ‚";
+ 				Text [ slovak ] = "Poƒçet slov...";
+ 				Text [ swedish ] = "Ordr√§kning...";
+ 				Text [ turkish ] = "›statistik...";
+ 				Text [ chinese_simplified ] = "ÁªüËÆ°...";
+ 				Text [ chinese_traditional ] = "Áµ±Ë®à...";
+ 				Text [ slovenian ] = "≈†tevilo besed";
+ 				Text [ thai ] = "Word count...";
+ 				Text [ hebrew ] = "Word count...";
+ 				Text [ estonian ] = "Word count...";
+ /*				--: "Word count" translations
+ 				az:	"K…ôlm…ô Miqdarƒ±"
+ 				bs:	"Zbir rijeƒçi"
+ 				cy:	"Cyfrif geiriau"
+ 				eu:	"Hitz kopurua"
+ 				mk:	"–ë—Ä–æ–µ—ö–µ –Ω–∞ –∑–±–æ—Ä–æ–≤–∏"
+ 				mt:	"Gƒßadd ta‚Äô kliem"
+ 				ro:	"NumƒÉrƒÉ cuvintele"
+ 				sl:	"≈†tevilo besed"
+ 				sq:	"Llogariti fjal√´t"
+ 				ta:	"‡Æö‡Øä‡Æ≤‡Øç ‡Æé‡Æ£‡Øç‡Æ£‡Æø"
+ 				uk:	"–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª—ñ–≤"
+ 				vi:	"ƒê·∫øm t·ª´"
+ 				wa:	"Contaedje des mots"
+ */
+   			};
  #endif
  			SEPARATOR ;
  			MenuItem
  			{
                  Identifier = SID_AUTO_CORRECT_DLG;
                  HelpID = SID_AUTO_CORRECT_DLG;
  				Text = "~AutoKorrektur/AutoFormat..." ;
  				Text [ English ] = "~AutoCorrect/AutoFormat..." ;
  				Text [ portuguese ] = "~AutoCorrecÁ„o/AutoFormato..." ;
  				Text [ english_us ] = "~AutoCorrect/AutoFormat..." ;
  				Text [ portuguese_brazilian ] = "~AutoCorreÁ„o/AutoFormataÁ„o..." ;
  				Text [ swedish ] = "~AutoKorrigering/AutoFormat..." ;
  				Text [ danish ] = "~AutoKorrektur/AutoFormat..." ;
  				Text [ italian ] = "Correzione/Formattazione a~utomatica..." ;
  				Text [ spanish ] = "~CorrecciÛn/Formateado autom·tico..." ;
Index: sw/source/ui/uiview/viewling.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/uiview/viewling.cxx,v
retrieving revision 1.13
diff -u -p -u -r1.13 viewling.cxx
--- sw/source/ui/uiview/viewling.cxx	17 Apr 2003 17:51:30 -0000	1.13
+++ sw/source/ui/uiview/viewling.cxx	7 Aug 2003 12:38:22 -0000
@@ -105,6 +105,9 @@
 #ifndef _SVX_DIALMGR_HXX //autogen
 #include <svx/dialmgr.hxx>
 #endif
+#ifndef _SFX_DINFDLG_HXX
+#include <sfx2/dinfdlg.hxx>
+#endif
 #ifndef _SVX_LANGITEM_HXX
 #include <svx/langitem.hxx>
 #endif
@@ -214,6 +217,40 @@ void SwView::ExecLingu(SfxRequest &rReq)
 		case FN_HYPHENATE_OPT_DLG:
 			HyphenateDocument();
 			break;
+	case FN_WORD_COUNT_DLG: {
+
+		SfxObjectShell *pObjectShell = GetObjectShell();
+		if (!pObjectShell)
+			break;
+
+		String aURL, aTitle;
+		SfxDocumentInfo *pTmpDocInfo = new SfxDocumentInfo;
+		*pTmpDocInfo = pObjectShell->GetDocInfo ();
+		pTmpDocInfo->SetReadOnly( true );
+		SfxDocumentInfoItem aDocInfoItem( aURL, *pTmpDocInfo );
+
+		SfxItemSet aSet(GetPool(), SID_DOCINFO, SID_DOCINFO,
+				SID_EXPLORER_PROPS_START, SID_EXPLORER_PROPS_START, 0L );
+		aSet.Put( aDocInfoItem );
+		aSet.Put( SfxStringItem( SID_EXPLORER_PROPS_START, aTitle ) );
+
+		// SwDocShell::CreateDocumentInfoDialog
+		SfxDocumentInfoDialog *pDlg = pObjectShell->CreateDocumentInfoDialog( 0, aSet );
+
+		pDlg->RemoveResetButton();
+		pDlg->RemoveTabPage( TP_DOCINFODESC );
+		pDlg->RemoveTabPage( TP_DOCINFODOC );
+		pDlg->RemoveTabPage( TP_DOCINFOUSER );
+		pDlg->RemoveTabPage( TP_DOCINFORELOAD );
+		pDlg->GetCancelButton().Hide();
+
+		pDlg->Execute(); // discard return value - it's irrelevant.
+
+		delete pDlg;
+		delete pTmpDocInfo;
+		break;
+	}
+		
 		default:
 			ASSERT(!this, falscher Dispatcher);
 			return;
