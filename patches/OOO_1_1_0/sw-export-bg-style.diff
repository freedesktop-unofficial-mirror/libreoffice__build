Backported from fix made in 1.65.82.2 IZ#18671

In 1.1.1a, but different.

Index: sw/source/filter/ww8/ww8atr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8atr.cxx,v
retrieving revision 1.65
diff -u -3 -p -r1.65 ww8atr.cxx
--- sw/source/filter/ww8/ww8atr.cxx	30 Jun 2003 15:54:09 -0000	1.65
+++ sw/source/filter/ww8/ww8atr.cxx	26 Aug 2003 12:47:07 -0000
@@ -1402,21 +1402,19 @@ static Writer& OutWW8_SwFmtCharBackgroun
 		const SvxBrushItem& rBack = (const SvxBrushItem&)rHt;
 		WW8_SHD aSHD;
 
-		if( rWW8Wrt.TransBrush( rBack.GetColor(), aSHD ) )
-		{
-			// sprmCShd
-			rWW8Wrt.InsUInt16( 0x4866 );
-			rWW8Wrt.InsUInt16( aSHD.GetValue() );
-
-            //Quite a few unknowns, some might be transparency or something
-            //of that nature...
-            rWW8Wrt.InsUInt16(0xCA71);
-            rWW8Wrt.pO->Insert(10, rWW8Wrt.pO->Count());
-            rWW8Wrt.InsUInt32(0xFF000000);
-            rWW8Wrt.InsUInt32(wwUtility::RGBToBGR(rBack.GetColor().GetColor()));
-            rWW8Wrt.InsUInt16(0x0000);
-		}
-	}
+		rWW8Wrt.TransBrush(rBack.GetColor(), aSHD);
+        // sprmCShd
+        rWW8Wrt.InsUInt16( 0x4866 );
+        rWW8Wrt.InsUInt16( aSHD.GetValue() );
+
+        //Quite a few unknowns, some might be transparency or something
+        //of that nature...
+        rWW8Wrt.InsUInt16(0xCA71);
+        rWW8Wrt.pO->Insert(10, rWW8Wrt.pO->Count());
+        rWW8Wrt.InsUInt32(0xFF000000);
+        rWW8Wrt.InsUInt32(wwUtility::RGBToBGR(rBack.GetColor().GetColor()));
+        rWW8Wrt.InsUInt16(0x0000);
+    }
 	return rWrt;
 }
 
@@ -3536,27 +3534,25 @@ static Writer& OutWW8_SwFmtBackground( W
 		const SvxBrushItem& rBack = (const SvxBrushItem&)rHt;
 		WW8_SHD aSHD;
 
-		if( rWW8Wrt.TransBrush( rBack.GetColor(), aSHD ) )
-		{
-			// sprmPShd
-			if (rWW8Wrt.bWrtWW8)
-				rWW8Wrt.InsUInt16(0x442D);
-			else
-				rWW8Wrt.pO->Insert(47, rWW8Wrt.pO->Count());
-			rWW8Wrt.InsUInt16( aSHD.GetValue() );
+		rWW8Wrt.TransBrush(rBack.GetColor(), aSHD);
+        // sprmPShd
+        if (rWW8Wrt.bWrtWW8)
+            rWW8Wrt.InsUInt16(0x442D);
+        else
+            rWW8Wrt.pO->Insert(47, rWW8Wrt.pO->Count());
+        rWW8Wrt.InsUInt16( aSHD.GetValue() );
 
-            //Quite a few unknowns, some might be transparency or something
-            //of that nature...
-            if (rWW8Wrt.bWrtWW8)
-            {
-                rWW8Wrt.InsUInt16(0xC64D);
-				rWW8Wrt.pO->Insert(10, rWW8Wrt.pO->Count());
-                rWW8Wrt.InsUInt32(0xFF000000);
-                rWW8Wrt.InsUInt32(wwUtility::RGBToBGR(
-                    rBack.GetColor().GetColor()));
-                rWW8Wrt.InsUInt16(0x0000);
-            }
-		}
+        //Quite a few unknowns, some might be transparency or something
+        //of that nature...
+        if (rWW8Wrt.bWrtWW8)
+        {
+            rWW8Wrt.InsUInt16(0xC64D);
+            rWW8Wrt.pO->Insert(10, rWW8Wrt.pO->Count());
+            rWW8Wrt.InsUInt32(0xFF000000);
+            rWW8Wrt.InsUInt32(wwUtility::RGBToBGR(
+                rBack.GetColor().GetColor()));
+            rWW8Wrt.InsUInt16(0x0000);
+        }
 	}
 	return rWrt;
 }
