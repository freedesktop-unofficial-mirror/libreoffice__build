Index: filter/source/config/fragments/makefile.mk
===================================================================
RCS file: /cvs/framework/filter/source/config/fragments/makefile.mk,v
retrieving revision 1.16
diff -u -p -u -r1.16 makefile.mk
--- filter/source/config/fragments/makefile.mk	14 Dec 2005 14:48:16 -0000	1.16
+++ filter/source/config/fragments/makefile.mk	19 Apr 2006 13:03:36 -0000
@@ -156,11 +156,7 @@ $(ALL_FLAGS) : $(INCLUDE_FRAGMENTS)
 MERGE:=python ../tools/merge/pyAltFCFGMerge
 .ELSE
 MERGE    := $(JAVAI) -jar $(CLASSDIR)$/FCFGMerge.jar
-.IF "$(JDK)" == "gcj"
-XALANCLASS=$(SOLARBINDIR)/xalan.jar
-CLASSPATH:=$(CLASSPATH)$(PATH_SEPERATOR){$(subst,%Z*Z%,$(PATH_SEPERATOR) $(XALANCLASS:s/ /%Z*Z%/))}
-.ENDIF
-PACKLANG := $(JAVAI) org.apache.xalan.xslt.Process -XSL langfilter.xsl
+PACKLANG := $(JAVAI) $(JAVACPS) $(SOLARBINDIR)/xalan.jar org.apache.xalan.xslt.Process -XSL langfilter.xsl
 .ENDIF
 
 # -----------------------------------------------------------------------------
--- /dev/null	2006-04-07 20:25:18.000000000 +0100
+++ filter/source/config/fragments/filters/OfficeOpen.xcu	2006-04-19 13:57:17.000000000 +0100
@@ -0,0 +1,13 @@
+	<node oor:name="Office Open XML" oor:op="replace">
+		<prop oor:name="Flags"><value>IMPORT EXPORT TEMPLATE</value></prop>
+		<prop oor:name="UIComponent"/>
+		<prop oor:name="FilterService"/>
+		<prop oor:name="UserData"><value></value></prop>
+		<prop oor:name="FileFormatVersion"><value>6800</value></prop>
+		<prop oor:name="Type"><value>calc_OfficeOpen</value></prop>
+		<prop oor:name="TemplateName"/>
+		<prop oor:name="DocumentService"><value>com.sun.star.sheet.SpreadsheetDocument</value></prop>
+		<prop oor:name="UIName">
+			<value xml:lang="x-default">ECMA Office Open</value>
+		</prop>
+	</node>
--- /dev/null	2006-04-07 20:25:18.000000000 +0100
+++ filter/source/config/fragments/types/calc_OfficeOpen.xcu	2006-04-19 13:55:29.000000000 +0100
@@ -0,0 +1,12 @@
+	<node oor:name="calc_OfficeOpen" oor:op="replace">
+		<prop oor:name="DetectService"><value>com.sun.star.comp.calc.FormatDetector</value></prop>
+		<prop oor:name="URLPattern"/>
+		<prop oor:name="Extensions"><value>xlsx</value></prop>
+		<prop oor:name="MediaType"><value>application/vnd.ms-excel-FIXME</value></prop>
+		<prop oor:name="Preferred"><value>false</value></prop>
+		<prop oor:name="PreferredFilter"><value>Office Open XML</value></prop>
+		<prop oor:name="UIName">
+			<value>ECMA Office Open</value>
+		</prop>
+		<prop oor:name="ClipboardFormat"><value>OfficeOpen</value></prop>
+	</node>
