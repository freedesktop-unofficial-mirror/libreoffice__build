? sc/sc.callcatcher.log
? sc/sc.vpj
Index: sc/inc/address.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/address.hxx,v
retrieving revision 1.17
retrieving revision 1.17.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.30.2
--- sc/inc/address.hxx	10 Apr 2008 18:10:55 -0000	1.17
+++ sc/inc/address.hxx	9 May 2008 21:22:36 -0000	1.17.30.2
@@ -310,9 +310,6 @@
 
     inline size_t hash() const;
 
-    // moved from ScTripel
-    /// "(1,2,3)"
-    String GetText() const;
     /// "A1" or "$A$1" or R1C1 or R[1]C[1]
     String GetColRowString( bool bAbsolute = FALSE,
                             const Details& rDetails = detailsOOOa1) const;
@@ -455,7 +452,6 @@
     // The document for the maximum defined sheet number
     bool Move( SCsCOL dx, SCsROW dy, SCsTAB dz, ScDocument* =NULL );
     void Justify();
-    void ExtendOne();
     void ExtendTo( const ScRange& rRange );
     bool Intersects( const ScRange& ) const;    // do two ranges intersect?
     inline bool operator==( const ScRange& r ) const;
Index: sc/inc/appoptio.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/appoptio.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.2
--- sc/inc/appoptio.hxx	10 Apr 2008 18:12:54 -0000	1.10
+++ sc/inc/appoptio.hxx	9 May 2008 02:03:24 -0000	1.10.32.2
@@ -88,8 +88,6 @@
 
 
 	const ScAppOptions&	operator=	( const ScAppOptions& rOpt );
-	friend SvStream& 	operator>>	( SvStream& rStream, ScAppOptions& rOpt );
-	friend SvStream&	operator<<	( SvStream& rStream, const ScAppOptions& rOpt );
 
 private:
 	FieldUnit	eMetric;
Index: sc/inc/attarray.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/attarray.hxx,v
retrieving revision 1.9
retrieving revision 1.9.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.3
--- sc/inc/attarray.hxx	10 Apr 2008 18:13:28 -0000	1.9
+++ sc/inc/attarray.hxx	13 May 2008 14:34:06 -0000	1.9.32.3
@@ -166,8 +166,8 @@
 
 	BOOL	IsEmpty() const;
 
-	SCROW	GetFirstEntryPos() const;
-	SCROW	GetLastEntryPos( BOOL bIncludeBottom ) const;
+//UNUSED2008-05  SCROW	GetFirstEntryPos() const;
+//UNUSED2008-05  SCROW	GetLastEntryPos( BOOL bIncludeBottom ) const;
 
     BOOL    GetFirstVisibleAttr( SCROW& rFirstRow ) const;
     BOOL    GetLastVisibleAttr( SCROW& rLastRow, SCROW nLastData ) const;
@@ -188,9 +188,7 @@
 
 	void	DeleteHardAttr( SCROW nStartRow, SCROW nEndRow );
 
-	void	Save( SvStream& rStream ) const;
-	void	Load( SvStream& rStream );
-    void    ConvertFontsAfterLoad();     // old binary file format
+//UNUSED2008-05  void    ConvertFontsAfterLoad();     // old binary file format
 };
 
 
Index: sc/inc/attrib.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/attrib.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.3
--- sc/inc/attrib.hxx	10 Apr 2008 18:13:44 -0000	1.10
+++ sc/inc/attrib.hxx	13 May 2008 14:34:06 -0000	1.10.32.3
@@ -74,7 +74,6 @@
 	virtual int             operator==( const SfxPoolItem& ) const;
 	virtual SfxPoolItem*    Clone( SfxItemPool *pPool = 0 ) const;
 	virtual SfxPoolItem*    Create( SvStream& rStream, USHORT nVer ) const;
-	virtual SvStream&       Store( SvStream& rStream, USHORT nVer ) const;
 
 			SCsCOL          GetColMerge() const {return nColMerge; }
 			SCsROW          GetRowMerge() const {return nRowMerge; }
@@ -136,7 +135,6 @@
 	virtual int             operator==( const SfxPoolItem& ) const;
 	virtual SfxPoolItem*    Clone( SfxItemPool *pPool = 0 ) const;
 	virtual SfxPoolItem*    Create( SvStream& rStream, USHORT nVer ) const;
-	virtual SvStream&       Store( SvStream& rStream, USHORT nVer ) const;
 
 	virtual	BOOL			QueryValue( com::sun::star::uno::Any& rVal, BYTE nMemberId = 0 ) const;
 	virtual	BOOL			PutValue( const com::sun::star::uno::Any& rVal, BYTE nMemberId = 0 );
@@ -188,9 +186,6 @@
 												 String &rText,
                                                  const IntlWrapper* pIntl = 0 ) const;
 	virtual SfxPoolItem*		Clone( SfxItemPool *pPool = 0 ) const;
-	virtual USHORT				GetVersion( USHORT nFileVersion ) const;
-	virtual SfxPoolItem*		Create(SvStream &, USHORT) const;
-	virtual SvStream&			Store( SvStream& rStream, USHORT nVer ) const;
 
 	const ScRange&	GetRange() const 				{ return aRange;  }
 	void			SetRange( const ScRange& rNew )	{ aRange = rNew; }
@@ -235,7 +230,7 @@
 
 	inline	ScTableListItem( const USHORT nWhich );
 			ScTableListItem( const ScTableListItem& rCpy );
-			ScTableListItem( const USHORT nWhich, const List& rList );
+//UNUSED2008-05  ScTableListItem( const USHORT nWhich, const List& rList );
 			~ScTableListItem();
 
 	ScTableListItem& operator=( const ScTableListItem &rCpy );
@@ -248,8 +243,6 @@
 												 String &rText,
                                                  const IntlWrapper* pIntl = 0 ) const;
 	virtual SfxPoolItem*		Clone( SfxItemPool *pPool = 0 ) const;
-	virtual SfxPoolItem*		Create(SvStream &, USHORT) const;
-	virtual SvStream&			Store( SvStream& rStream, USHORT nVer ) const;
 
 	BOOL	GetTableList( List& aList ) const;
 	void	SetTableList( const List& aList );
@@ -287,9 +280,6 @@
 	virtual SfxPoolItem*    Clone( SfxItemPool *pPool = 0 ) const;
 
 	virtual SfxPoolItem*    Create( SvStream& rStream, USHORT nVer ) const;
-	virtual SvStream&       Store( SvStream& rStream, USHORT nVer ) const;
-
-	virtual USHORT			GetVersion( USHORT nFileVersion ) const;
 
 	virtual	BOOL			QueryValue( com::sun::star::uno::Any& rVal, BYTE nMemberId = 0 ) const;
 	virtual	BOOL			PutValue( const com::sun::star::uno::Any& rVal, BYTE nMemberId = 0 );
@@ -347,7 +337,6 @@
 	virtual SfxPoolItem*    Clone( SfxItemPool *pPool = 0 ) const;
 
 	virtual SfxPoolItem*    Create( SvStream& rStream, USHORT nVer ) const;
-	virtual SvStream&       Store( SvStream& rStream, USHORT nVer ) const;
 
 	double GetValue() const		{ return nValue; }
 
Index: sc/inc/autoform.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/autoform.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.3
--- sc/inc/autoform.hxx	10 Apr 2008 18:14:00 -0000	1.8
+++ sc/inc/autoform.hxx	14 May 2008 01:52:00 -0000	1.8.32.3
@@ -245,7 +245,6 @@
     void                        CopyItem( USHORT nToIndex, USHORT nFromIndex, USHORT nWhich );
 
     const ScNumFormatAbbrev&    GetNumFormat( USHORT nIndex ) const;
-    void                        SetNumFormat( USHORT nIndex, const ScNumFormatAbbrev& rNumFormat );
 
     BOOL                        IsEqualData( USHORT nIndex1, USHORT nIndex2 ) const;
 
Index: sc/inc/callform.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/callform.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/inc/callform.hxx	10 Apr 2008 18:15:06 -0000	1.3
+++ sc/inc/callform.hxx	9 May 2008 04:45:54 -0000	1.3.32.1
@@ -98,7 +98,6 @@
 			ParamType	GetReturnType() const { return eParamType[0]; }
 			ParamType	GetAsyncType() const { return eAsyncType; }
 			BOOL        Call(void** ppParam);
-			BOOL        Advice(AdvData pfCallback);
 			BOOL 		Unadvice(double nHandle);
 
 						// Name und Beschreibung des Parameters nParam.
Index: sc/inc/cell.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/cell.hxx,v
retrieving revision 1.29
retrieving revision 1.29.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.29 -r1.29.32.4
--- sc/inc/cell.hxx	10 Apr 2008 18:15:24 -0000	1.29
+++ sc/inc/cell.hxx	13 May 2008 14:34:06 -0000	1.29.32.4
@@ -99,8 +99,6 @@
 	inline void		ForgetBroadcaster();
 	inline void		SwapBroadcaster(ScBaseCell& rOther);	// zum Sortieren
 
-	void			LoadNote( SvStream& rStream, ScDocument* pDoc );
-
 						// String- oder EditCell
 	static ScBaseCell* CreateTextCell( const String& rString, ScDocument* );
 
@@ -139,13 +137,10 @@
 					ScValueCell();
 					ScValueCell( const double& rValue );
 					ScValueCell( const ScValueCell& rScValueCell, ScDocument* pDoc );
-					ScValueCell( SvStream& rStream, USHORT nVer );
 	ScBaseCell*		Clone(ScDocument* pDoc) const;
 
 	void			SetValue( const double& rValue );
 	double			GetValue() const;
-
-	void			Save( SvStream& rStream ) const;
 };
 
 
@@ -166,15 +161,10 @@
 					ScStringCell();
 					ScStringCell( const String& rString );
 					ScStringCell( const ScStringCell& rScStringCell, ScDocument* pDoc );
-					ScStringCell( SvStream& rStream, USHORT nVer );
 	ScBaseCell*		Clone(ScDocument* pDoc) const;
 
 	void			SetString( const String& rString );
 	void			GetString( String& rString ) const;
-
-    void            Save( SvStream& rStream, FontToSubsFontConverter hConv = 0 ) const;
-                    // convert symbol font after loading binary format
-    void            ConvertFont( FontToSubsFontConverter hConv );
 };
 
 
@@ -200,11 +190,9 @@
 
 					~ScEditCell();				// wegen pData immer!
 
-					ScEditCell( ScDocument* );
 					ScEditCell( const EditTextObject* pObject, ScDocument*,
 								const SfxItemPool* pFromPool /* = NULL */ );
 					ScEditCell( const ScEditCell& rEditCell, ScDocument* );
-					ScEditCell( SvStream& rStream, USHORT nVer, ScDocument* );
 					// fuer Zeilenumbrueche
 					ScEditCell( const String& rString, ScDocument* );
 	ScBaseCell*		Clone( ScDocument* ) const;
@@ -215,8 +203,6 @@
 	void			GetString( String& rString ) const;
 
 	const EditTextObject* GetData() const	{ return pData; }
-
-	void			Save( SvStream& rStream ) const;
 };
 
 enum ScMatrixMode {
@@ -330,7 +316,6 @@
 
 	BOOL			HasOneReference( ScRange& r ) const;
 	BOOL			HasRelNameReference() const;
-	BOOL			HasDBArea() const;
 	BOOL			HasColRowName() const;
 
 	void			UpdateReference(UpdateRefMode eUpdateRefMode,
@@ -455,10 +440,7 @@
 					ScNoteCell();
 					ScNoteCell( const ScPostIt& rNote );
 					ScNoteCell( const ScNoteCell& rScNoteCell, ScDocument* pDoc );
-					ScNoteCell( SvStream& rStream, USHORT nVer );
 	ScBaseCell*		Clone(ScDocument* pDoc) const;
-
-	void			Save( SvStream& rStream ) const;
 };
 
 
Index: sc/inc/chartarr.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/chartarr.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.4
--- sc/inc/chartarr.hxx	10 Apr 2008 18:16:47 -0000	1.7
+++ sc/inc/chartarr.hxx	13 May 2008 14:34:06 -0000	1.7.32.4
@@ -90,7 +90,6 @@
 	ScChartArray( ScDocument* pDoc, const ScRangeListRef& rRangeList,
 					const String& rChartName );
 	ScChartArray( const ScChartArray& rArr );
-	ScChartArray( ScDocument* pDoc, SvStream& rStream, ScMultipleReadHeader& rHdr );
 
 	virtual	~ScChartArray();
 	virtual	DataObject* Clone() const;
@@ -98,8 +97,6 @@
 	const ScRangeListRef&	GetRangeList() const { return aPositioner.GetRangeList(); }
 	void	SetRangeList( const ScRangeListRef& rNew ) { aPositioner.SetRangeList(rNew); }
 	void	SetRangeList( const ScRange& rNew ) { aPositioner.SetRangeList(rNew); }
-	void	AddToRangeList( const ScRange& rRange ) { aPositioner.AddToRangeList(rRange); }
-	void	AddToRangeList( const ScRangeListRef& rAdd ) { aPositioner.AddToRangeList(rAdd); }
     const   ScChartPositionMap* GetPositionMap() { return aPositioner.GetPositionMap(); }
 
 	void	SetHeaders(BOOL bCol, BOOL bRow) { aPositioner.SetHeaders(bCol, bRow); }
@@ -109,8 +106,6 @@
 	void	SetName(const String& rNew)		 { aName = rNew; }
 	const String& GetName() const			 { return aName; }
 
-    BOOL	IsAtCursor(const ScAddress& rPos) const { return aPositioner.IsAtCursor(rPos); }
-
 	BOOL	operator==(const ScChartArray& rCmp) const;
 
     ScMemChart* CreateMemChart();
@@ -128,8 +123,6 @@
 						{ return (ScChartArray*)At(nIndex); }
 
 	BOOL	operator==(const ScChartCollection& rCmp) const;
-
-	BOOL	Load( ScDocument* pDoc, SvStream& rStream );
 };
 
 
Index: sc/inc/chartpos.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/chartpos.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.2
--- sc/inc/chartpos.hxx	10 Apr 2008 18:17:44 -0000	1.3
+++ sc/inc/chartpos.hxx	13 May 2008 18:34:41 -0000	1.3.32.2
@@ -135,7 +135,6 @@
 	void		CreatePositionMap();
 
 public:
-    ScChartPositioner( ScDocument* pDoc );
 	ScChartPositioner( ScDocument* pDoc, SCTAB nTab,
 					SCCOL nStartColP, SCROW nStartRowP,
 					SCCOL nEndColP, SCROW nEndRowP );
@@ -144,13 +143,9 @@
 
 	virtual	~ScChartPositioner();
 
-    String  ReadStream( SvStream& rStream, ScMultipleReadHeader& rHdr );
-
 	const ScRangeListRef&	GetRangeList() const { return aRangeListRef; }
 	void	SetRangeList( const ScRangeListRef& rNew ) { aRangeListRef = rNew; }
 	void	SetRangeList( const ScRange& rNew );
-	void	AddToRangeList( const ScRange& rRange );
-	void	AddToRangeList( const ScRangeListRef& rAdd );
 
 	void	SetHeaders(BOOL bCol, BOOL bRow) { bColHeaders=bCol; bRowHeaders=bRow; }
 	BOOL	HasColHeaders() const			 { return bColHeaders; }
@@ -160,8 +155,6 @@
     void    SetStartCol(SCCOL nNew) { nStartCol = nNew; }
     void    SetStartRow(SCROW nNew) { nStartRow = nNew; }
 
-	BOOL	IsAtCursor(const ScAddress& rPos) const;
-
 	BOOL	operator==(const ScChartPositioner& rCmp) const;
 
 	void					InvalidateGlue()
Index: sc/inc/chgtrack.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/chgtrack.hxx,v
retrieving revision 1.31
retrieving revision 1.31.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.4
--- sc/inc/chgtrack.hxx	15 Apr 2008 14:11:53 -0000	1.31
+++ sc/inc/chgtrack.hxx	14 May 2008 01:52:00 -0000	1.31.32.4
@@ -320,10 +320,7 @@
 										pLnk->SetLink( pL );
 										return pLnk;
 									}
-			void				RemoveLink( ScChangeAction* p );
 			void				RemoveAllAnyLinks();
-								// zeigt ein AnyLink auf p?
-			BOOL				DependsOn( ScChangeAction* p ) const;
 
 	virtual	ScChangeActionLinkEntry*	GetDeletedIn() const
 											{ return pLinkDeletedIn; }
@@ -343,7 +340,6 @@
 										return new ScChangeActionLinkEntry(
 											&pLinkDeleted, p );
 									}
-			BOOL				RemoveDeleted( const ScChangeAction* p );
 			void				RemoveAllDeleted();
 
 			ScChangeActionLinkEntry*	AddDependent( ScChangeAction* p )
@@ -351,7 +347,6 @@
 										return new ScChangeActionLinkEntry(
 											&pLinkDependent, p );
 									}
-			void				RemoveDependent( ScChangeAction* p );
 			void				RemoveAllDependent();
 
 			void				RemoveAllLinks();
@@ -611,7 +606,6 @@
 
     virtual const ScChangeTrack*    GetChangeTrack() const { return pTrack; }
 
-	virtual	BOOL				Store( SvStream&, ScMultipleWriteHeader& ) const;
 	virtual	BOOL				StoreLinks( SvStream& ) const;
 	virtual	BOOL				LoadLinks( SvStream&, ScChangeTrack* );
 
@@ -1168,12 +1162,6 @@
 								// Content on top an Position
 		ScChangeActionContent*	SearchContentAt( const ScBigAddress&,
 									ScChangeAction* pButNotThis ) const;
-								// das gleiche fuer generierte Del-Eintraege,
-								// wobei der Content nicht in der angegebenen
-								// Richtung geloescht sein darf
-		ScChangeActionContent*	SearchGeneratedDelContentAt(
-									const ScBigAddress&,
-									ScChangeActionType eNotInDelType ) const;
 			void				DeleteGeneratedDelContent(
 									ScChangeActionContent* );
 		ScChangeActionContent*	GenerateDelContent( const ScAddress&,
Index: sc/inc/chgviset.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/chgviset.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.2
--- sc/inc/chgviset.hxx	10 Apr 2008 18:19:53 -0000	1.6
+++ sc/inc/chgviset.hxx	9 May 2008 02:03:24 -0000	1.6.32.2
@@ -134,10 +134,6 @@
 	BOOL				IsShowRejected() const { return bShowRejected; }
 	void				SetShowRejected( BOOL bVal ) { bShowRejected = bVal; }
 
-
-	void				Load( SvStream& rStream, USHORT nVer );
-	void				Store( SvStream& rStream ) const;
-
 	ScChangeViewSettings&	operator=	( const ScChangeViewSettings& r );
 
                         /// Adjust dates according to selected DateMode
Index: sc/inc/collect.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/collect.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.4
--- sc/inc/collect.hxx	10 Apr 2008 18:20:11 -0000	1.6
+++ sc/inc/collect.hxx	14 May 2008 01:52:00 -0000	1.6.32.4
@@ -161,8 +161,8 @@
 				  nValue(nVal),
 				  nStrType(nType) {}
 
-			TypedStrData( ScDocument* pDoc, SCCOL nCol, SCROW nRow, SCTAB nTab,
-							BOOL bAllStrings );
+//UNUSED2008-05  TypedStrData( ScDocument* pDoc, SCCOL nCol, SCROW nRow, SCTAB nTab,
+//UNUSED2008-05                  BOOL bAllStrings );
 
 			TypedStrData( const TypedStrData& rCpy )
                 : DataObject(),
@@ -178,7 +178,9 @@
 
 private:
 	friend class TypedStrCollection;
+#if OLD_PIVOT_IMPLEMENTATION
 	friend class PivotStrCollection;
+#endif
 
 	String	aStrValue;
 	double	nValue;
Index: sc/inc/column.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/column.hxx,v
retrieving revision 1.21
retrieving revision 1.21.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.32.4
--- sc/inc/column.hxx	10 Apr 2008 18:20:30 -0000	1.21
+++ sc/inc/column.hxx	13 May 2008 14:34:06 -0000	1.21.32.4
@@ -143,7 +143,6 @@
 	void		DeleteAtIndex( SCSIZE nIndex );
 	void 	    FreeAll();
 	void		Resize( SCSIZE nSize );
-	void 		SetNewRow( SCROW nRow1, SCROW nRow2 );
 	void		SwapRow( SCROW nRow1, SCROW nRow2 );
 	void		SwapCell( SCROW nRow, ScColumn& rCol);
 
@@ -179,12 +178,6 @@
 	USHORT		GetBlockMatrixEdges( SCROW nRow1, SCROW nRow2, USHORT nMask ) const;
 	BOOL		HasSelectionMatrixFragment(const ScMarkData& rMark) const;
 
-				// Daten oder Attribute:
-	SCROW		GetFirstEntryPos() const;
-	SCROW		GetLastEntryPos() const;
-
-				// nur Attribute:
-	SCROW		GetLastAttrPos() const;
     BOOL        GetFirstVisibleAttr( SCROW& rFirstRow ) const;
     BOOL        GetLastVisibleAttr( SCROW& rLastRow ) const;
 	BOOL		HasVisibleAttrIn( SCROW nStartRow, SCROW nEndRow ) const;
@@ -379,16 +372,8 @@
 	void		GetFilterEntries(SCROW nStartRow, SCROW nEndRow, TypedStrCollection& rStrings);
 	BOOL		GetDataEntries(SCROW nRow, TypedStrCollection& rStrings, BOOL bLimit);
 
-	SCROW		NoteCount( SCROW nMaxRow = MAXROW ) const;
-
-	void		LoadData( SvStream& rStream );
-	void		SaveData( SvStream& rStream ) const;
-
-	void		LoadNotes( SvStream& rStream );
-	void		SaveNotes( SvStream& rStream ) const;
+//UNUSED2008-05  SCROW		NoteCount( SCROW nMaxRow = MAXROW ) const;
 
-	BOOL		Load( SvStream& rStream, ScMultipleReadHeader& rHdr );
-	BOOL		Save( SvStream& rStream, ScMultipleWriteHeader& rHdr ) const;
 	void		UpdateInsertTabAbs(SCTAB nNewPos);
 	BOOL		TestTabRefAbs(SCTAB nTable);
 	BOOL 		GetNextSpellingCell(SCROW& nRow, BOOL bInSel, const ScMarkData& rData) const;
@@ -414,7 +399,7 @@
 private:
 	ScBaseCell* CloneCell(SCSIZE nIndex, USHORT nFlags,
 							ScDocument* pDestDoc, const ScAddress& rDestPos);
-	void		CorrectSymbolCells( CharSet eStreamCharSet );
+//UNUSED2008-05  void		CorrectSymbolCells( CharSet eStreamCharSet );
 };
 
 
Index: sc/inc/compiler.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/compiler.hxx,v
retrieving revision 1.36
retrieving revision 1.36.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.36 -r1.36.30.3
--- sc/inc/compiler.hxx	10 Apr 2008 18:21:04 -0000	1.36
+++ sc/inc/compiler.hxx	12 May 2008 15:56:55 -0000	1.36.30.3
@@ -177,13 +177,13 @@
     void SetSingleReference( const SingleRefData& rRef );
     void SetDoubleReference( const ComplRefData& rRef );
     void SetDouble( double fVal );
-    void SetInt( int nVal );
+//UNUSED2008-05  void SetInt( int nVal );
+//UNUSED2008-05  void SetMatrix( ScMatrix* p );
+//UNUSED2008-05  // These methods are ok to use, reference count not cleared.
+//UNUSED2008-05  ComplRefData& GetReference();
+//UNUSED2008-05  void SetReference( ComplRefData& rRef );
     void SetName( USHORT n );
-    void SetMatrix( ScMatrix* p );
     void SetExternal(const sal_Unicode* pStr);
-    // These methods are ok to use, reference count not cleared.
-    ComplRefData& GetReference();
-    void SetReference( ComplRefData& rRef );
 
     ScRawToken* Clone() const;      // real copy!
     ScToken* CreateToken() const;   // create typified token
@@ -431,7 +431,6 @@
     BOOL IsColRowName( const String& );
     BOOL IsBoolean( const String& );
     void AutoCorrectParsedSymbol();
-    void AdjustReference( SingleRefData& r );
     void PushTokenArray( ScTokenArray*, BOOL = FALSE );
     void PopTokenArray();
     void SetRelNameReference();
Index: sc/inc/compressedarray.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/compressedarray.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/inc/compressedarray.hxx	10 Apr 2008 18:21:21 -0000	1.7
+++ sc/inc/compressedarray.hxx	9 May 2008 15:31:01 -0000	1.7.32.2
@@ -102,10 +102,6 @@
         not decremented and the value of the first entry is returned again. */
     const D&                    GetPrevValue( size_t& nIndex, A& nStart ) const;
 
-    /** Fill an array with consecutive data between nStart and nEnd. Caller
-        must assure that all elements fit into the array. */
-    void                        FillDataArray( A nStart, A nEnd, D * pArray ) const;
-
     /** Return the last row where an entry meets the condition:
         (aValue != rCompare). If no entry meets this condition
         ::std::numeric_limits<A>::max() is returned. */
Index: sc/inc/conditio.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/conditio.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.4
--- sc/inc/conditio.hxx	10 Apr 2008 18:21:39 -0000	1.13
+++ sc/inc/conditio.hxx	13 May 2008 14:34:06 -0000	1.13.32.4
@@ -106,11 +106,6 @@
 	BOOL	IsValid( double nArg ) const;
 	BOOL	IsValidStr( const String& rArg ) const;
 
-protected:
-			ScConditionEntry( SvStream& rStream, ScMultipleReadHeader& rHdr,
-								ScDocument* pDocument );
-	void	StoreCondition(SvStream& rStream, ScMultipleWriteHeader& rHdr) const;
-
 public:
 			ScConditionEntry( ScConditionMode eOper,
 								const String& rExpr1, const String& rExpr2,
@@ -183,14 +178,10 @@
 								const String& rStyle );
 			ScCondFormatEntry( const ScCondFormatEntry& r );
 			ScCondFormatEntry( ScDocument* pDocument, const ScCondFormatEntry& r );
-			ScCondFormatEntry( SvStream& rStream, ScMultipleReadHeader& rHdr,
-								ScDocument* pDocument );
 	virtual	~ScCondFormatEntry();
 
 	void			SetParent( ScConditionalFormat* pNew )	{ pParent = pNew; }
 
-	void			Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const;
-
 	int				operator== ( const ScCondFormatEntry& r ) const;
 
 	const String&	GetStyle() const		{ return aStyleName; }
@@ -215,15 +206,11 @@
 public:
 			ScConditionalFormat(sal_uInt32 nNewKey, ScDocument* pDocument);
 			ScConditionalFormat(const ScConditionalFormat& r);
-			ScConditionalFormat(SvStream& rStream, ScMultipleReadHeader& rHdr,
-								ScDocument* pDocument);
 			~ScConditionalFormat();
 
 	// echte Kopie der Formeln (fuer Ref-Undo / zwischen Dokumenten)
 	ScConditionalFormat* Clone(ScDocument* pNewDoc = NULL) const;
 
-	void			Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const;
-
 	void			AddEntry( const ScCondFormatEntry& rNew );
 
 	BOOL			IsEmpty() const			{ return (nEntryCount == 0); }
@@ -280,9 +267,7 @@
 
 	ScConditionalFormat* GetFormat( sal_uInt32 nKey );
 
-	void	Load( SvStream& rStream, ScDocument* pDocument );
-	void	Store( SvStream& rStream ) const;
-	void	ResetUsed();
+//UNUSED2008-05  void	ResetUsed();
 
 	void	CompileAll();
 	void	CompileXML();
Index: sc/inc/dapiuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/dapiuno.hxx,v
retrieving revision 1.10
retrieving revision 1.10.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.30.1
--- sc/inc/dapiuno.hxx	10 Apr 2008 18:23:09 -0000	1.10
+++ sc/inc/dapiuno.hxx	13 May 2008 00:33:44 -0000	1.10.30.1
@@ -62,7 +62,9 @@
 #include <vector>
 
 class ScDocShell;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivot;
+#endif
 class ScDPSaveDimension;
 class ScDPSaveGroupDimension;
 class ScDPSaveNumGroupDimension;
Index: sc/inc/datauno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/datauno.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.1
--- sc/inc/datauno.hxx	10 Apr 2008 18:23:26 -0000	1.8
+++ sc/inc/datauno.hxx	9 May 2008 16:11:44 -0000	1.8.32.1
@@ -502,10 +502,6 @@
 							// nField[] hier innerhalb des Bereichs:
 	void					GetQueryParam(ScQueryParam& rQueryParam) const;
 	void					SetQueryParam(const ScQueryParam& rQueryParam);
-	void					GetSortParam(ScSortParam& rSortParam) const;
-	void					SetSortParam(const ScSortParam& rSortParam);
-	void					GetImportParam(ScImportParam& rImportParam) const;
-	void					SetImportParam(const ScImportParam& rImportParam);
 	void					GetSubTotalParam(ScSubTotalParam& rSubTotalParam) const;
 	void					SetSubTotalParam(const ScSubTotalParam& rSubTotalParam);
 
Index: sc/inc/dbcolect.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/dbcolect.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.5
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.5
--- sc/inc/dbcolect.hxx	10 Apr 2008 18:23:44 -0000	1.13
+++ sc/inc/dbcolect.hxx	13 May 2008 14:34:06 -0000	1.13.32.5
@@ -129,7 +129,6 @@
 					 SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2,
 					 BOOL bByR = TRUE, BOOL bHasH = TRUE);
 			ScDBData(const ScDBData& rData);
-			ScDBData( SvStream& rStream, ScMultipleReadHeader& rHdr );
 			~ScDBData();
 
 	virtual	DataObject*	Clone() const;
@@ -138,8 +137,6 @@
 
 			BOOL		operator== (const ScDBData& rData) const;
 
-			BOOL		Store( SvStream& rStream, ScMultipleWriteHeader& rHdr ) const;
-
 			const String& GetName() const				{ return aName; }
 			void		GetName(String& rName) const	{ rName = aName; }
 			void		SetName(const String& rName)	{ aName = rName; }
@@ -160,7 +157,7 @@
 			BOOL		IsStripData() const				{ return bStripData; }
 			void		SetStripData(BOOL bSet)			{ bStripData = bSet; }
 
-			BOOL		IsBeyond(SCROW nMaxRow) const;
+//UNUSED2008-05  BOOL		IsBeyond(SCROW nMaxRow) const;
 
 			String		GetSourceString() const;
 			String		GetOperations() const;
@@ -182,8 +179,6 @@
 			BOOL		IsDBAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab, BOOL bStartOnly) const;
 			BOOL		IsDBAtArea(SCTAB nTab, SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2) const;
 
-			String		GetTargetName(const String& rDocName) const;
-
 			BOOL		HasImportParam() const	 { return bDBImport; }
 			BOOL		HasQueryParam() const	 { return bDoQuery[0]; }
 			BOOL		HasSortParam() const	 { return bDoSort[0]; }
@@ -228,9 +223,6 @@
 			ScDBData*	GetDBAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab, BOOL bStartOnly) const;
 			ScDBData*	GetDBAtArea(SCTAB nTab, SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2) const;
 
-	BOOL	Load( SvStream& rStream );
-	BOOL	Store( SvStream& rStream ) const;
-
 	BOOL	SearchName( const String& rName, USHORT& rIndex ) const;
 
     void    DeleteOnTab( SCTAB nTab );
Index: sc/inc/detdata.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/detdata.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/inc/detdata.hxx	10 Apr 2008 18:24:53 -0000	1.7
+++ sc/inc/detdata.hxx	9 May 2008 02:03:24 -0000	1.7.32.2
@@ -101,9 +101,6 @@
 
 	void	Append( ScDetOpData* pData );
 
-	void	Load( SvStream& rStream );
-	void	Store( SvStream& rStream ) const;
-
 	BOOL	HasAddError() const		{ return bHasAddError; }
 };
 
Index: sc/inc/dociter.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/dociter.hxx,v
retrieving revision 1.9
retrieving revision 1.9.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.2
--- sc/inc/dociter.hxx	10 Apr 2008 18:25:45 -0000	1.9
+++ sc/inc/dociter.hxx	12 May 2008 15:56:55 -0000	1.9.32.2
@@ -105,10 +105,11 @@
 
 	BOOL			GetThis(double& rValue, USHORT& rErr);
 public:
-					ScValueIterator(ScDocument* pDocument,
-									SCCOL nSCol, SCROW nSRow, SCTAB nSTab,
-									SCCOL nECol, SCROW nERow, SCTAB nETab,
-									BOOL bSTotal = FALSE, BOOL bTextAsZero = FALSE);
+//UNUSED2008-05  ScValueIterator(ScDocument* pDocument,
+//UNUSED2008-05                  SCCOL nSCol, SCROW nSRow, SCTAB nSTab,
+//UNUSED2008-05                  SCCOL nECol, SCROW nERow, SCTAB nETab,
+//UNUSED2008-05                  BOOL bSTotal = FALSE, BOOL bTextAsZero = FALSE);
+
 					ScValueIterator(ScDocument* pDocument,
 									const ScRange& rRange, BOOL bSTotal = FALSE,
 									BOOL bTextAsZero = FALSE );
Index: sc/inc/docoptio.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/docoptio.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.4
--- sc/inc/docoptio.hxx	10 Apr 2008 18:26:00 -0000	1.7
+++ sc/inc/docoptio.hxx	12 May 2008 15:56:55 -0000	1.7.32.4
@@ -83,8 +83,6 @@
 
 	void		ResetDocOptions();
 	inline void		CopyTo(ScDocOptions& rOpt);
-	void		Load(SvStream& rStream);
-	void		Save(SvStream& rStream, BOOL bConfig = FALSE) const;
 
 	inline const ScDocOptions&	operator=( const ScDocOptions& rOpt );
 	inline int					operator==( const ScDocOptions& rOpt ) const;
@@ -178,7 +176,7 @@
 {
 public:
 				TYPEINFO();
-				ScTpCalcItem( USHORT nWhich );
+//UNUSED2008-05  ScTpCalcItem( USHORT nWhich );
 				ScTpCalcItem( USHORT nWhich,
 							  const ScDocOptions& rOpt );
 				ScTpCalcItem( const ScTpCalcItem& rItem );
Index: sc/inc/docpool.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/docpool.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/inc/docpool.hxx	10 Apr 2008 18:26:16 -0000	1.10
+++ sc/inc/docpool.hxx	8 May 2008 21:46:13 -0000	1.10.32.1
@@ -62,7 +62,6 @@
 	virtual const SfxPoolItem&	Put( const SfxPoolItem&, USHORT nWhich = 0 );
 	virtual void				Remove( const SfxPoolItem& );
 	static void					CheckRef( const SfxPoolItem& );
-	void						MyLoadCompleted();
 
 	void StyleDeleted( ScStyleSheet* pStyle );		// Loeschen von Vorlagen im Organizer
 	virtual SfxItemPresentation		GetPresentation(
Index: sc/inc/document.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/document.hxx,v
retrieving revision 1.111
retrieving revision 1.111.20.6
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.111 -r1.111.20.6
--- sc/inc/document.hxx	18 Apr 2008 11:30:18 -0000	1.111
+++ sc/inc/document.hxx	13 May 2008 14:34:06 -0000	1.111.20.6
@@ -95,8 +95,10 @@
 class ScMarkData;
 class ScOutlineTable;
 class ScPatternAttr;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivot;
 class ScPivotCollection;
+#endif
 class ScPrintRangeSaver;
 class ScRangeData;
 class ScRangeName;
@@ -118,7 +120,6 @@
 class ScMatrix;
 class ScScriptTypeData;
 class ScPoolHelper;
-class ScImpExpLogMsg;
 struct ScSortParam;
 class ScRefreshTimerControl;
 class ScUnoListenerCalls;
@@ -228,7 +229,9 @@
 friend class ScHorizontalAttrIterator;
 friend class ScDocAttrIterator;
 friend class ScAttrRectIterator;
+#if OLD_PIVOT_IMPLEMENTATION
 friend class ScPivot;
+#endif
 
 private:
 	::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory > xServiceManager;
@@ -249,7 +252,9 @@
 	ScTable*			pTab[MAXTABCOUNT];
 	ScRangeName*		pRangeName;
 	ScDBCollection*		pDBCollection;
+#if OLD_PIVOT_IMPLEMENTATION
 	ScPivotCollection*	pPivotCollection;
+#endif
 	ScDPCollection*		pDPCollection;
 	ScChartCollection*	pChartCollection;
     std::auto_ptr< ScTemporaryChartLock > apTemporaryChartLock;
@@ -285,8 +290,6 @@
 	ScExtDocOptions*	pExtDocOptions;					// fuer Import etc.
 	ScConsolidateParam*	pConsolidateDlgData;
 
-    List*               pLoadedSymbolStringCellList;    // binary file format import of symbol font string cells
-
     ScRecursionHelper*  pRecursionHelper;               // information for recursive and iterative cell formulas
 
     ScAutoNameCache*    pAutoNameCache;                 // for automatic name lookup during CompileXML
@@ -371,8 +374,6 @@
 	BOOL				bChartListenerCollectionNeedsUpdate;
 	// ob RC_FORCED Formelzellen im Dokument sind/waren (einmal an immer an)
 	BOOL				bHasForcedFormulas;
-	// ist beim Laden/Speichern etwas weggelassen worden?
-	BOOL				bLostData;
 	// ob das Doc gerade zerstoert wird (kein Notify-Tracking etc. mehr)
 	BOOL				bInDtorClear;
 	// ob bei Spalte/Zeile einfuegen am Rand einer Referenz die Referenz
@@ -434,7 +435,6 @@
 	XColorTable*	GetColorTable();
 
 	SvxLinkManager*		GetLinkManager() { return pLinkManager; }
-	void				SetLinkManager( SvxLinkManager* pNew );
 
 	const ScDocOptions&		GetDocOptions() const;
 	void					SetDocOptions( const ScDocOptions& rOpt );
@@ -475,20 +475,19 @@
 										BOOL bStartOnly = FALSE) const;
 	ScDBData*		GetDBAtArea(SCTAB nTab, SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2) const;
 
-	ScRangeData*	GetRangeAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab,
-										BOOL bStartOnly = FALSE) const;
+//UNUSED2008-05  ScRangeData*	GetRangeAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab,
+//UNUSED2008-05                                      BOOL bStartOnly = FALSE) const;
 	ScRangeData*	GetRangeAtBlock( const ScRange& rBlock, String* pName=NULL ) const;
 
 	ScDPCollection*		GetDPCollection();
 	ScDPObject*			GetDPAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab) const;
     ScDPObject*         GetDPAtBlock( const ScRange& rBlock ) const;
-
+#if OLD_PIVOT_IMPLEMENTATION
 	ScPivotCollection*	GetPivotCollection() const;
 	void				SetPivotCollection(ScPivotCollection* pNewPivotCollection);
 	ScPivot*			GetPivotAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab) const;
-
+#endif
 	ScChartCollection*	GetChartCollection() const;
-	void				SetChartCollection(ScChartCollection* pNewChartCollection);
 
     void				StopTemporaryChartLock();
 
@@ -532,18 +531,8 @@
 	BOOL			IsBlockEditable( SCTAB nTab, SCCOL nStartCol, SCROW nStartRow,
 										SCCOL nEndCol, SCROW nEndRow,
 										BOOL* pOnlyNotBecauseOfMatrix = NULL ) const;
-	BOOL			IsSelectedBlockEditable( SCCOL nStartCol, SCROW nStartRow,
-											SCCOL nEndCol, SCROW nEndRow,
-											const ScMarkData& rMark ) const;
 	BOOL			IsSelectionEditable( const ScMarkData& rMark,
 										BOOL* pOnlyNotBecauseOfMatrix = NULL ) const;
-	BOOL			IsSelectionOrBlockEditable( SCTAB nTab, SCCOL nStartCol, SCROW nStartRow,
-										SCCOL nEndCol, SCROW nEndRow,
-										const ScMarkData& rMark ) const;
-	BOOL			IsSelectedOrBlockEditable( SCCOL nStartCol, SCROW nStartRow,
-											SCCOL nEndCol, SCROW nEndRow,
-											const ScMarkData& rMark ) const;
-
 	BOOL			HasSelectedBlockMatrixFragment( SCCOL nStartCol, SCROW nStartRow,
 											SCCOL nEndCol, SCROW nEndRow,
 											const ScMarkData& rMark ) const;
@@ -575,7 +564,6 @@
 									BOOL bInsertNew = TRUE,
 									BOOL bResultsOnly = FALSE );
 	void			TransferDrawPage(ScDocument* pSrcDoc, SCTAB nSrcPos, SCTAB nDestPos);
-	void			ClearDrawPage(SCTAB nTab);
 	void			SetVisible( SCTAB nTab, BOOL bVisible );
 	BOOL			IsVisible( SCTAB nTab ) const;
 	void			SetLayoutRTL( SCTAB nTab, BOOL bRTL );
@@ -691,7 +679,6 @@
 	BOOL			HasControl( SCTAB nTab, const Rectangle& rMMRect );
 	void			InvalidateControls( Window* pWin, SCTAB nTab, const Rectangle& rMMRect );
 
-	void			StopAnimations( SCTAB nTab, Window* pWin );
 	void			StartAnimations( SCTAB nTab, Window* pWin );
 
 	BOOL			HasBackgroundDraw( SCTAB nTab, const Rectangle& rMMRect );
@@ -753,13 +740,12 @@
 	void			GetCell( SCCOL nCol, SCROW nRow, SCTAB nTab, ScBaseCell*& rpCell ) const;
 	ScBaseCell*		GetCell( const ScAddress& rPos ) const;
 
-	void			RefreshNoteFlags();
+//UNUSED2008-05  void			RefreshNoteFlags();
 	BOOL			HasNoteObject( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
 
 	BOOL			HasData( SCCOL nCol, SCROW nRow, SCTAB nTab );
 	SC_DLLPUBLIC BOOL			HasStringData( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
 	BOOL			HasValueData( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
-	USHORT			GetErrorData(SCCOL nCol, SCROW nRow, SCTAB nTab) const;
 	BOOL			HasStringCells( const ScRange& rRange ) const;
 
     /** Returns true, if there is any data to create a selection list for rPos. */
@@ -795,7 +781,6 @@
 												ScRange* pLastRange = NULL,
 												Rectangle* pLastMM = NULL ) const;
 
-	BOOL			IsOverlapped( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
 	BOOL			IsHorOverlapped( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
 	BOOL			IsVerOverlapped( SCCOL nCol, SCROW nRow, SCTAB nTab ) const;
 
@@ -803,8 +788,6 @@
 							SCCOL nCol2, SCROW nRow2, SCTAB nTab2, USHORT nMask );
 	BOOL			HasAttrib( const ScRange& rRange, USHORT nMask );
 
-	BOOL			HasLines( const ScRange& rRange, Rectangle& rSizes ) const;
-
 	void			GetBorderLines( SCCOL nCol, SCROW nRow, SCTAB nTab,
 									const SvxBorderLine** ppLeft,
 									const SvxBorderLine** ppTop,
@@ -815,7 +798,6 @@
 
 	void			SetDirty();
 	void			SetDirty( const ScRange& );
-	void			SetDirtyVar();
 	void			SetTableOpDirty( const ScRange& );	// for Interpreter TableOp
 	void			CalcAll();
 	void			CalcAfterLoad();
@@ -842,7 +824,6 @@
 					// if CalcFormulaTree() is currently running
 	BOOL			IsCalculatingFormulaTree() { return bCalculatingFormulaTree; }
 
-	void			GetErrCode( SCCOL nCol, SCROW nRow, SCTAB nTab, USHORT& rErrCode );
 	USHORT			GetErrCode( const ScAddress& ) const;
 
 	void			GetDataArea( SCTAB nTab, SCCOL& rStartCol, SCROW& rStartRow,
@@ -932,7 +913,6 @@
 	void			DeleteObjectsInArea( SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2,
 										const ScMarkData& rMark );
 	void			DeleteObjectsInSelection( const ScMarkData& rMark );
-	void			DeleteObjects( SCTAB nTab );
 
 	void			DeleteArea(SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2,
 							const ScMarkData& rMark, USHORT nDelFlag);
@@ -1087,10 +1067,8 @@
 	void			FindConditionalFormat( ULONG nKey, ScRangeList& rRanges );
 	void			FindConditionalFormat( ULONG nKey, ScRangeList& rRanges, SCTAB nTab );
 	void			ConditionalChanged( ULONG nKey );
-	void			SetConditionalUsed( ULONG nKey );		// beim Speichern
 
 	ULONG			AddValidationEntry( const ScValidationData& rNew );
-	void			SetValidationUsed( ULONG nKey );		// beim Speichern
 
 	const ScValidationData*	GetValidationEntry( ULONG nIndex ) const;
 
@@ -1138,14 +1116,9 @@
 
 	BOOL			IsStyleSheetUsed( const ScStyleSheet& rStyle, BOOL bGatherAllStyles ) const;
 
-					// Rueckgabe TRUE bei ApplyFlags: Wert geaendert
-	BOOL			ApplyFlags( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
-									const ScMarkData& rMark, INT16 nFlags );
 	BOOL			ApplyFlagsTab( SCCOL nStartCol, SCROW nStartRow,
 											SCCOL nEndCol, SCROW nEndRow,
 											SCTAB nTab, INT16 nFlags );
-	BOOL			RemoveFlags( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
-									const ScMarkData& rMark, INT16 nFlags );
 	BOOL			RemoveFlagsTab( SCCOL nStartCol, SCROW nStartRow,
 											SCCOL nEndCol, SCROW nEndRow,
 											SCTAB nTab, INT16 nFlags );
@@ -1250,8 +1223,6 @@
     const ScBitMaskCompressedArray< SCROW, BYTE> & GetRowFlagsArray( SCTAB nTab ) const;
           ScBitMaskCompressedArray< SCROW, BYTE> & GetRowFlagsArrayModifiable( SCTAB nTab );
 
-                    /// @return  the index of the last column with any set flags (auto-pagebreak is ignored).
-    SCCOL           GetLastFlaggedCol( SCTAB nTab ) const;
                     /// @return  the index of the last row with any set flags (auto-pagebreak is ignored).
 	SCROW			GetLastFlaggedRow( SCTAB nTab ) const;
 
@@ -1291,7 +1262,6 @@
 	Size			GetPageSize( SCTAB nTab ) const;
 	void			SetPageSize( SCTAB nTab, const Size& rSize );
 	void			SetRepeatArea( SCTAB nTab, SCCOL nStartCol, SCCOL nEndCol, SCROW nStartRow, SCROW nEndRow );
-	void			UpdatePageBreaks();
 	void			UpdatePageBreaks( SCTAB nTab, const ScRange* pUserArea = NULL );
 	void			RemoveManualBreaks( SCTAB nTab );
 	BOOL			HasManualBreaks( SCTAB nTab ) const;
@@ -1332,12 +1302,6 @@
 								SCCOL nEndCol, SCROW nEndRow, SCTAB nTab );
 	ScRange			GetRange( SCTAB nTab, const Rectangle& rMMRect );
 
-	BOOL			LoadPool( SvStream& rStream, BOOL bLoadRefCounts );
-	BOOL			SavePool( SvStream& rStream ) const;
-
-	BOOL			Load( SvStream& rStream, ScProgress* pProgress );
-	BOOL			Save( SvStream& rStream, ScProgress* pProgress ) const;
-
 	void			UpdStlShtPtrsFrmNms();
 	void			StylesToNames();
 
@@ -1347,9 +1311,6 @@
 	ULONG			GetSrcVersion() const	{ return nSrcVer; }
 	SCROW			GetSrcMaxRow() const	{ return nSrcMaxRow; }
 
-	void			SetLostData();
-	BOOL			HasLostData() const		{ return bLostData; }
-
 	void			SetSrcCharSet( CharSet eNew )	{ eSrcSet = eNew; }
 	void			UpdateFontCharSet();
 
@@ -1427,7 +1388,6 @@
 	BOOL			GetHasMacroFunc() const		 { return bHasMacroFunc; }
 	void			SetHasMacroFunc(BOOL bSet)	 { bHasMacroFunc = bSet; }
 
-	BOOL			HasMacroCallsAfterLoad();
 	BOOL			CheckMacroWarn();
 
     void            SetRangeOverflowType(sal_uInt32 nType)  { nRangeOverflowType = nType; }
@@ -1483,7 +1443,7 @@
 
 
 private:
-	void				SetAutoFilterFlags();
+//UNUSED2008-05  void				SetAutoFilterFlags();
 	void				FindMaxRotCol( SCTAB nTab, RowInfo* pRowInfo, SCSIZE nArrCount,
 										SCCOL nX1, SCCOL nX2 ) const;
 
@@ -1671,19 +1631,11 @@
 	ScNoteEditEngine&	GetNoteEngine();
 	SfxItemPool&	        GetNoteItemPool();
 
-	void			AddToImpExpLog( const ScImpExpLogMsg& rMsg );
-	void			AddToImpExpLog( ScImpExpLogMsg* pMsg );
-
 	ScRefreshTimerControl*	GetRefreshTimerControl() const
 		{ return pRefreshTimerControl; }
 	ScRefreshTimerControl * const * GetRefreshTimerControlAddress() const
 		{ return &pRefreshTimerControl; }
 
-                    /// if symbol string cells of old binary file format are in list
-    BOOL            SymbolStringCellsPending() const;
-                    /// get list of ScSymbolStringCellEntry, create if necessary
-    List&           GetLoadedSymbolStringCellsList();
-
     void            SetPastingDrawFromOtherDoc( BOOL bVal )
                         { bPastingDrawFromOtherDoc = bVal; }
     BOOL            PastingDrawFromOtherDoc() const
@@ -1703,10 +1655,7 @@
                             { return eStorageGrammar; }
 
 private: // CLOOK-Impl-Methoden
-	void	ImplLoadDocOptions( SvStream& rStream );
-	void	ImplLoadViewOptions( SvStream& rStream );
-	void	ImplSaveDocOptions( SvStream& rStream ) const;
-	void	ImplSaveViewOptions( SvStream& rStream ) const;
+
 	void	ImplCreateOptions(); // bei Gelegenheit auf on-demand umstellen?
 	void	ImplDeleteOptions();
 
@@ -1723,8 +1672,6 @@
 
 	void	LoadDdeLinks(SvStream& rStream);
 	void	SaveDdeLinks(SvStream& rStream) const;
-	void	LoadAreaLinks(SvStream& rStream);
-	void	SaveAreaLinks(SvStream& rStream) const;
 
     void    DeleteAreaLinksOnTab( SCTAB nTab );
 	void	UpdateRefAreaLinks( UpdateRefMode eUpdateRefMode,
Index: sc/inc/docuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/docuno.hxx,v
retrieving revision 1.27
retrieving revision 1.27.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.27 -r1.27.32.2
--- sc/inc/docuno.hxx	10 Apr 2008 18:26:48 -0000	1.27
+++ sc/inc/docuno.hxx	12 May 2008 15:56:55 -0000	1.27.32.2
@@ -116,10 +116,7 @@
 
 	ScDocument*				GetDocument() const;
     SfxObjectShell*         GetEmbeddedObject() const;
-	BOOL					IsEmbedded() const;
-	double					GetOutputFactor() const;
 
-	BOOL					AdjustRowHeight( SCROW nStartRow, SCROW nEndRow, SCTAB nTab );
     void                    UpdateAllRowHeights();
 
 	ScDrawLayer*	                        MakeDrawLayer();
@@ -658,7 +655,7 @@
 	ScDocShell*				pDocShell;
 
 public:
-							ScSpreadsheetSettingsObj(ScDocShell* pDocSh);
+//UNUSED2008-05             ScSpreadsheetSettingsObj(ScDocShell* pDocSh);
 	virtual					~ScSpreadsheetSettingsObj();
 
 	virtual void			Notify( SfxBroadcaster& rBC, const SfxHint& rHint );
Index: sc/inc/dpobject.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/dpobject.hxx,v
retrieving revision 1.14
retrieving revision 1.14.30.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.30.4
--- sc/inc/dpobject.hxx	10 Apr 2008 18:27:50 -0000	1.14
+++ sc/inc/dpobject.hxx	13 May 2008 14:34:07 -0000	1.14.30.4
@@ -52,8 +52,10 @@
 struct ScDPPositionData;
 class ScMultipleReadHeader;
 class ScMultipleWriteHeader;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivot;
 class ScPivotCollection;
+#endif
 struct ScPivotParam;
 struct ScImportSourceDesc;
 struct ScSheetSourceDesc;
@@ -176,13 +178,11 @@
 
 	void				ToggleDetails( ScDPPositionData& rElemDesc, ScDPObject* pDestObj );
 
-	BOOL				StoreOld(SvStream& rStream, ScMultipleWriteHeader& rHdr ) const;
-	BOOL				StoreNew(SvStream& rStream, ScMultipleWriteHeader& rHdr ) const;
-	BOOL				LoadNew(SvStream& rStream, ScMultipleReadHeader& rHdr );
 	BOOL				FillOldParam(ScPivotParam& rParam, BOOL bForFile) const;
 	BOOL				FillLabelData(ScPivotParam& rParam);
+#if OLD_PIVOT_IMPLEMENTATION
 	void				InitFromOldPivot(const ScPivot& rOld, ScDocument* pDoc, BOOL bSetSource);
-
+#endif
     BOOL                GetHierarchiesNA( sal_Int32 nDim, com::sun::star::uno::Reference< com::sun::star::container::XNameAccess >& xHiers );
     BOOL                GetHierarchies( sal_Int32 nDim, com::sun::star::uno::Sequence< rtl::OUString >& rHiers );
 
@@ -243,13 +243,9 @@
 	virtual	DataObject*	Clone() const;
 
 	ScDPObject*	operator[](USHORT nIndex) const {return (ScDPObject*)At(nIndex);}
-
-	BOOL		StoreOld( SvStream& rStream ) const;
-	BOOL		StoreNew( SvStream& rStream ) const;
-	BOOL		LoadNew( SvStream& rStream );
-
+#if OLD_PIVOT_IMPLEMENTATION
 	void		ConvertOldTables( ScPivotCollection& rOldColl );
-
+#endif
     void        DeleteOnTab( SCTAB nTab );
 	void		UpdateReference( UpdateRefMode eUpdateRefMode,
 								 const ScRange& r, SCsCOL nDx, SCsROW nDy, SCsTAB nDz );
@@ -258,7 +254,7 @@
 	void		WriteRefsTo( ScDPCollection& r ) const;
 
 	String 		CreateNewName( USHORT nMin = 1 ) const;
-	void		EnsureNames();
+//UNUSED2008-05  void		EnsureNames();
 };
 
 
Index: sc/inc/dpsave.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/dpsave.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.3
--- sc/inc/dpsave.hxx	10 Apr 2008 18:28:26 -0000	1.11
+++ sc/inc/dpsave.hxx	9 May 2008 16:11:45 -0000	1.11.32.3
@@ -146,7 +146,6 @@
 	void					SetLayoutName(const String* pName);
 	const String&			GetLayoutName() const;
 	BOOL					HasLayoutName() const;
-	void					ResetLayoutName();
 
 	const ::com::sun::star::sheet::DataPilotFieldReference* GetReferenceValue() const	{ return pReferenceValue; }
 	void					SetReferenceValue(const ::com::sun::star::sheet::DataPilotFieldReference* pNew);
@@ -233,9 +232,6 @@
 	void					WriteToSource( const com::sun::star::uno::Reference<
 											com::sun::star::sheet::XDimensionsSupplier>& xSource );
 
-	void					Store( SvStream& rStream ) const;
-	void					Load( SvStream& rStream );
-
 	BOOL					IsEmpty() const;
 
     const ScDPDimensionSaveData* GetExistingDimensionData() const   { return pDimensionData; }
Index: sc/inc/drwlayer.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/drwlayer.hxx,v
retrieving revision 1.21
retrieving revision 1.21.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.32.1
--- sc/inc/drwlayer.hxx	10 Apr 2008 18:31:13 -0000	1.21
+++ sc/inc/drwlayer.hxx	9 May 2008 16:11:45 -0000	1.21.32.1
@@ -154,7 +154,6 @@
 									const ScAddress& rDestPos, const Rectangle& rDestRange );
 
 	void			SetPageSize( USHORT nPageNo, const Size& rSize );
-	ULONG			GetDefTextHeight() const;
 
 					//	mirror or move between positive and negative positions for RTL
 	void			MirrorRTL( SdrObject* pObj );
Index: sc/inc/editsrc.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/editsrc.hxx,v
retrieving revision 1.17
retrieving revision 1.17.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.1
--- sc/inc/editsrc.hxx	10 Apr 2008 18:31:29 -0000	1.17
+++ sc/inc/editsrc.hxx	9 May 2008 04:45:54 -0000	1.17.32.1
@@ -190,9 +190,6 @@
 	virtual SvxEditViewForwarder*	GetEditViewForwarder( sal_Bool bCreate = sal_False );
 	virtual void				UpdateData();
 	virtual SfxBroadcaster&		GetBroadcaster() const;
-
-	void						SetDoUpdateData(sal_Bool bValue);
-	sal_Bool					IsDirty() const;
 };
 
 #endif
Index: sc/inc/fielduno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/fielduno.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/inc/fielduno.hxx	10 Apr 2008 18:32:58 -0000	1.8
+++ sc/inc/fielduno.hxx	13 May 2008 14:34:07 -0000	1.8.32.2
@@ -148,8 +148,8 @@
 	String					aRepresentation;
 	String					aTarget;
 
+	ScCellFieldObj(); // disabled
 public:
-							ScCellFieldObj();
 							ScCellFieldObj(ScDocShell* pDocSh, const ScAddress& rPos,
 											const ESelection& rSel);
 	virtual					~ScCellFieldObj();
@@ -345,8 +345,8 @@
 	ESelection					aSelection;
 	sal_Int16					nFileFormat;		// enum SvxFileFormat, valid if not inserted
 
+    ScHeaderFieldObj(); // disabled 
 public:
-							ScHeaderFieldObj();
 							ScHeaderFieldObj(ScHeaderFooterContentObj* pContent, USHORT nP,
 											USHORT nT, const ESelection& rSel);
 	virtual					~ScHeaderFieldObj();
Index: sc/inc/filter.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/filter.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/inc/filter.hxx	10 Apr 2008 18:33:31 -0000	1.8
+++ sc/inc/filter.hxx	12 May 2008 16:10:45 -0000	1.8.32.2
@@ -34,6 +34,8 @@
 #include <tools/string.hxx>
 #include <rtl/textenc.h>
 
+#define ENABLE_LOTUS123_EXPORT 0
+
 class SfxMedium;
 class SvStream;
 
@@ -87,8 +89,6 @@
 
 FltError ScImportLotus123( SfxMedium&, ScDocument*, CharSet eSrc = RTL_TEXTENCODING_DONTKNOW );
 
-FltError ScImportExcel( SfxMedium&, ScDocument* );
-
 FltError ScImportExcel( SfxMedium&, ScDocument*, const EXCIMPFORMAT );
 		// eFormat == EIF_AUTO	-> passender Filter wird automatisch verwendet
 		// eFormat == EIF_BIFF5	-> nur Biff5-Stream fuehrt zum Erfolg (auch wenn in einem Excel97-Doc)
@@ -109,9 +109,9 @@
 // Diverse Exportfilter
 // ***********************************************************************
 
+#if ENABLE_LOTUS123_EXPORT
 FltError ScExportLotus123( SvStream&, ScDocument*, ExportFormatLotus, CharSet eDest );
-
-FltError ScExportExcel234( SvStream&, ScDocument*, ExportFormatExcel, CharSet eDest );
+#endif
 
 FltError ScExportExcel5( SfxMedium&, ScDocument*, const BOOL bTuerk, CharSet eDest );
 
Index: sc/inc/fmtuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/fmtuno.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/inc/fmtuno.hxx	10 Apr 2008 18:34:22 -0000	1.10
+++ sc/inc/fmtuno.hxx	9 May 2008 21:22:37 -0000	1.10.32.1
@@ -86,8 +86,8 @@
 	ScTableConditionalEntry*	GetObjectByIndex_Impl(USHORT nIndex) const;
     void                        AddEntry_Impl(const ScCondFormatEntryItem& aEntry);
 
+	ScTableConditionalFormat(); // disable
 public:
-							ScTableConditionalFormat();
 							ScTableConditionalFormat(ScDocument* pDoc, ULONG nKey,
 														const ScGrammar::Grammar eGrammar);
 	virtual					~ScTableConditionalFormat();
@@ -159,8 +159,8 @@
 	ScTableConditionalFormat*	pParent;
     ScCondFormatEntryItem       aData;
 
+	ScTableConditionalEntry(); // disabled
 public:
-							ScTableConditionalEntry();
                             ScTableConditionalEntry(ScTableConditionalFormat* pPar, 
                                                     const ScCondFormatEntryItem& aItem);
 	virtual					~ScTableConditionalEntry();
@@ -229,8 +229,8 @@
 
 	void					ClearData_Impl();
 
+	ScTableValidationObj(); // disabled
 public:
-							ScTableValidationObj();
 							ScTableValidationObj(ScDocument* pDoc, ULONG nKey,
 												const ScGrammar::Grammar eGrammar);
 	virtual					~ScTableValidationObj();
Index: sc/inc/funcdesc.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/funcdesc.hxx,v
retrieving revision 1.3
retrieving revision 1.3.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.30.1
--- sc/inc/funcdesc.hxx	10 Apr 2008 18:35:17 -0000	1.3
+++ sc/inc/funcdesc.hxx	9 May 2008 16:11:45 -0000	1.3.30.1
@@ -149,8 +149,6 @@
                                              const ScFuncDesc** ppFDesc = NULL,
                                              String***      pppArgs = NULL );
 
-    static const ScFuncDesc*    GetDefaultFuncDesc();
-
     static xub_StrLen           GetFunctionStart( const String& rFormula, xub_StrLen nStart,
                                                     BOOL bBack, String* pFuncName = NULL );
 
Index: sc/inc/global.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/global.hxx,v
retrieving revision 1.53
retrieving revision 1.53.32.8
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.53 -r1.53.32.8
--- sc/inc/global.hxx	10 Apr 2008 18:35:55 -0000	1.53
+++ sc/inc/global.hxx	13 May 2008 14:34:07 -0000	1.53.32.8
@@ -84,6 +84,12 @@
 #define SC_TRANSLITERATION_CASESENSE 0
 #endif
 
+// Remove the old pivot table implementation that the current data pilot
+// implementation has effectively replaced.  The old pivot code was still
+// around to handle loading of the old binary format.  Now that the old
+// binary filter is handled by binfilter, we can safely remove the old pivot
+// handling code.
+#define OLD_PIVOT_IMPLEMENTATION 0
 
 //------------------------------------------------------------------------
 struct LabelData;
@@ -773,9 +779,6 @@
 	void			Clear();
 	ScQueryEntry&	operator=( const ScQueryEntry& r );
 	BOOL			operator==( const ScQueryEntry& r ) const;
-
-	void			Load(SvStream& rStream);
-	void			Store(SvStream& rStream) const;
 };
 
 struct SC_DLLPUBLIC ScQueryParam
@@ -817,9 +820,6 @@
 
 	void			MoveToDest();
 	void			FillInExcelSyntax(String& aCellStr, SCSIZE nIndex);
-
-	void			Load(SvStream& rStream);
-	void			Store(SvStream& rStream) const;
 };
 
 // -----------------------------------------------------------------------
@@ -881,9 +881,6 @@
 	void				Clear			(); // = ClearDataAreas()+Members
 	void				ClearDataAreas	();
 	void				SetAreas		( ScArea* const* ppAreas, USHORT nCount );
-
-	void			Load( SvStream& rStream );
-	void			Store( SvStream& rStream ) const;
 };
 
 // -----------------------------------------------------------------------
Index: sc/inc/hints.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/hints.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/inc/hints.hxx	10 Apr 2008 18:36:55 -0000	1.5
+++ sc/inc/hints.hxx	13 May 2008 14:34:07 -0000	1.5.32.2
@@ -43,9 +43,10 @@
 	USHORT		nParts;
 	BOOL		bPrint;		//	Flag, ob auch Druck/Vorschau betroffen ist
 
+	ScPaintHint(); // disabled
+
 public:
 					TYPEINFO();
-					ScPaintHint();
 					ScPaintHint( const ScRange& rRng, USHORT nPaint = PAINT_ALL );
 					~ScPaintHint();
 
@@ -95,7 +96,7 @@
 public:
 					TYPEINFO();
 
-					ScPointerChangedHint( USHORT nF );
+//UNUSED2008-05     ScPointerChangedHint( USHORT nF );
 					~ScPointerChangedHint();
 
 	USHORT			GetFlags() const			{ return nFlags; }
Index: sc/inc/inputopt.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/inputopt.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/inc/inputopt.hxx	10 Apr 2008 18:37:50 -0000	1.5
+++ sc/inc/inputopt.hxx	13 May 2008 18:34:42 -0000	1.5.32.1
@@ -81,8 +81,6 @@
     BOOL        GetReplaceCellsWarn() const     { return bReplCellsWarn; }
 
 	const ScInputOptions&	operator=	( const ScInputOptions& rOpt );
-	friend SvStream& 		operator>>	( SvStream& rStream, ScInputOptions& rOpt );
-	friend SvStream&		operator<<	( SvStream& rStream, const ScInputOptions& rOpt );
 };
 
 
Index: sc/inc/markarr.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/markarr.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/inc/markarr.hxx	10 Apr 2008 18:39:38 -0000	1.6
+++ sc/inc/markarr.hxx	9 May 2008 21:22:37 -0000	1.6.32.1
@@ -56,7 +56,6 @@
 			~ScMarkArray();
 	void	Reset( BOOL bMarked = FALSE );
 	BOOL	GetMark( SCROW nRow ) const;
-	void	SetMark( SCROW nRow, BOOL bMarked );
 	void	SetMarkArea( SCROW nStartRow, SCROW nEndRow, BOOL bMarked );
 	BOOL	IsAllMarked( SCROW nStartRow, SCROW nEndRow ) const;
 	BOOL	HasOneMark( SCROW& rStartRow, SCROW& rEndRow ) const;
@@ -67,8 +66,6 @@
 
 	BOOL 	Search( SCROW nRow, SCSIZE& nIndex ) const;
 	void	DeleteArea(SCROW nStartRow, SCROW nEndRow);
-	void	SwapCol(ScMarkArray& rMarkArray);
-	void	MoveTo(SCROW nStartRow, SCROW nEndRow, ScMarkArray& rMarkArray);
 
     /// Including current row, may return -1 if bUp and not found
 	SCsROW	GetNextMarked( SCsROW nRow, BOOL bUp ) const;
Index: sc/inc/miscuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/miscuno.hxx,v
retrieving revision 1.9
retrieving revision 1.9.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.4
--- sc/inc/miscuno.hxx	10 Apr 2008 18:40:19 -0000	1.9
+++ sc/inc/miscuno.hxx	13 May 2008 19:05:02 -0000	1.9.32.4
@@ -126,57 +126,55 @@
 								throw(::com::sun::star::uno::RuntimeException);
 };
 
-
-class ScEmptyEnumerationAccess : public cppu::WeakImplHelper2<
-								com::sun::star::container::XEnumerationAccess,
-								com::sun::star::lang::XServiceInfo >
-{
-public:
-							ScEmptyEnumerationAccess();
-	virtual					~ScEmptyEnumerationAccess();
-
-							// XEnumerationAccess
-	virtual ::com::sun::star::uno::Reference< ::com::sun::star::container::XEnumeration > SAL_CALL
-							createEnumeration() throw(::com::sun::star::uno::RuntimeException);
-
-							// XElementAccess
-	virtual ::com::sun::star::uno::Type SAL_CALL getElementType()
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual sal_Bool SAL_CALL hasElements() throw(::com::sun::star::uno::RuntimeException);
-
-							// XServiceInfo
-	virtual ::rtl::OUString SAL_CALL getImplementationName(  )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
-								throw(::com::sun::star::uno::RuntimeException);
-};
-
-
-class ScEmptyEnumeration : public cppu::WeakImplHelper2<
-								com::sun::star::container::XEnumeration,
-								com::sun::star::lang::XServiceInfo >
-{
-public:
-							ScEmptyEnumeration();
-	virtual					~ScEmptyEnumeration();
-
-							// XEnumeration
-	virtual sal_Bool SAL_CALL hasMoreElements() throw(::com::sun::star::uno::RuntimeException);
-	virtual ::com::sun::star::uno::Any SAL_CALL nextElement()
-								throw(::com::sun::star::container::NoSuchElementException,
-										::com::sun::star::lang::WrappedTargetException,
-										::com::sun::star::uno::RuntimeException);
-
-							// XServiceInfo
-	virtual ::rtl::OUString SAL_CALL getImplementationName(  )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
-								throw(::com::sun::star::uno::RuntimeException);
-};
+//UNUSED2008-05  class ScEmptyEnumerationAccess : public cppu::WeakImplHelper2<
+//UNUSED2008-05                                  com::sun::star::container::XEnumerationAccess,
+//UNUSED2008-05                                  com::sun::star::lang::XServiceInfo >
+//UNUSED2008-05  {
+//UNUSED2008-05  public:
+//UNUSED2008-05                              ScEmptyEnumerationAccess();
+//UNUSED2008-05      virtual                 ~ScEmptyEnumerationAccess();
+//UNUSED2008-05  
+//UNUSED2008-05                              // XEnumerationAccess
+//UNUSED2008-05      virtual ::com::sun::star::uno::Reference< ::com::sun::star::container::XEnumeration > SAL_CALL
+//UNUSED2008-05                              createEnumeration() throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  
+//UNUSED2008-05                              // XElementAccess
+//UNUSED2008-05      virtual ::com::sun::star::uno::Type SAL_CALL getElementType()
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual sal_Bool SAL_CALL hasElements() throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  
+//UNUSED2008-05                              // XServiceInfo
+//UNUSED2008-05      virtual ::rtl::OUString SAL_CALL getImplementationName(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  };
+
+//UNUSED2008-05  class ScEmptyEnumeration : public cppu::WeakImplHelper2<
+//UNUSED2008-05                                  com::sun::star::container::XEnumeration,
+//UNUSED2008-05                                  com::sun::star::lang::XServiceInfo >
+//UNUSED2008-05  {
+//UNUSED2008-05  public:
+//UNUSED2008-05                              ScEmptyEnumeration();
+//UNUSED2008-05      virtual                 ~ScEmptyEnumeration();
+//UNUSED2008-05  
+//UNUSED2008-05                              // XEnumeration
+//UNUSED2008-05      virtual sal_Bool SAL_CALL hasMoreElements() throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual ::com::sun::star::uno::Any SAL_CALL nextElement()
+//UNUSED2008-05                                  throw(::com::sun::star::container::NoSuchElementException,
+//UNUSED2008-05                                          ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                          ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  
+//UNUSED2008-05                              // XServiceInfo
+//UNUSED2008-05      virtual ::rtl::OUString SAL_CALL getImplementationName(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  };
 
 //	new (uno 3) variant
 class ScNameToIndexAccess : public cppu::WeakImplHelper2<
@@ -214,63 +212,63 @@
 								throw(::com::sun::star::uno::RuntimeException);
 };
 
-class ScPrintSettingsObj : public cppu::WeakImplHelper2<
-								com::sun::star::beans::XPropertySet,
-								com::sun::star::lang::XServiceInfo >
-{
-public:
-							ScPrintSettingsObj();
-	virtual					~ScPrintSettingsObj();
-
-							// XPropertySet
-	virtual ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo >
-							SAL_CALL getPropertySetInfo()
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual void SAL_CALL	setPropertyValue( const ::rtl::OUString& aPropertyName,
-									const ::com::sun::star::uno::Any& aValue )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::beans::PropertyVetoException,
-									::com::sun::star::lang::IllegalArgumentException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-	virtual ::com::sun::star::uno::Any SAL_CALL getPropertyValue(
-									const ::rtl::OUString& PropertyName )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-	virtual void SAL_CALL	addPropertyChangeListener( const ::rtl::OUString& aPropertyName,
-									const ::com::sun::star::uno::Reference<
-										::com::sun::star::beans::XPropertyChangeListener >& xListener )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-	virtual void SAL_CALL	removePropertyChangeListener( const ::rtl::OUString& aPropertyName,
-									const ::com::sun::star::uno::Reference<
-										::com::sun::star::beans::XPropertyChangeListener >& aListener )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-	virtual void SAL_CALL	addVetoableChangeListener( const ::rtl::OUString& PropertyName,
-									const ::com::sun::star::uno::Reference<
-										::com::sun::star::beans::XVetoableChangeListener >& aListener )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-	virtual void SAL_CALL	removeVetoableChangeListener( const ::rtl::OUString& PropertyName,
-									const ::com::sun::star::uno::Reference<
-										::com::sun::star::beans::XVetoableChangeListener >& aListener )
-								throw(::com::sun::star::beans::UnknownPropertyException,
-									::com::sun::star::lang::WrappedTargetException,
-									::com::sun::star::uno::RuntimeException);
-
-							// XServiceInfo
-	virtual ::rtl::OUString SAL_CALL getImplementationName(  )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
-								throw(::com::sun::star::uno::RuntimeException);
-	virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
-								throw(::com::sun::star::uno::RuntimeException);
-};
+//UNUSED2008-05  class ScPrintSettingsObj : public cppu::WeakImplHelper2<
+//UNUSED2008-05                                  com::sun::star::beans::XPropertySet,
+//UNUSED2008-05                                  com::sun::star::lang::XServiceInfo >
+//UNUSED2008-05  {
+//UNUSED2008-05  public:
+//UNUSED2008-05                              ScPrintSettingsObj();
+//UNUSED2008-05      virtual                 ~ScPrintSettingsObj();
+//UNUSED2008-05  
+//UNUSED2008-05                              // XPropertySet
+//UNUSED2008-05      virtual ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo >
+//UNUSED2008-05                              SAL_CALL getPropertySetInfo()
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual void SAL_CALL   setPropertyValue( const ::rtl::OUString& aPropertyName,
+//UNUSED2008-05                                      const ::com::sun::star::uno::Any& aValue )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::beans::PropertyVetoException,
+//UNUSED2008-05                                      ::com::sun::star::lang::IllegalArgumentException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual ::com::sun::star::uno::Any SAL_CALL getPropertyValue(
+//UNUSED2008-05                                      const ::rtl::OUString& PropertyName )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual void SAL_CALL   addPropertyChangeListener( const ::rtl::OUString& aPropertyName,
+//UNUSED2008-05                                      const ::com::sun::star::uno::Reference<
+//UNUSED2008-05                                          ::com::sun::star::beans::XPropertyChangeListener >& xListener )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual void SAL_CALL   removePropertyChangeListener( const ::rtl::OUString& aPropertyName,
+//UNUSED2008-05                                      const ::com::sun::star::uno::Reference<
+//UNUSED2008-05                                          ::com::sun::star::beans::XPropertyChangeListener >& aListener )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual void SAL_CALL   addVetoableChangeListener( const ::rtl::OUString& PropertyName,
+//UNUSED2008-05                                      const ::com::sun::star::uno::Reference<
+//UNUSED2008-05                                          ::com::sun::star::beans::XVetoableChangeListener >& aListener )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual void SAL_CALL   removeVetoableChangeListener( const ::rtl::OUString& PropertyName,
+//UNUSED2008-05                                      const ::com::sun::star::uno::Reference<
+//UNUSED2008-05                                          ::com::sun::star::beans::XVetoableChangeListener >& aListener )
+//UNUSED2008-05                                  throw(::com::sun::star::beans::UnknownPropertyException,
+//UNUSED2008-05                                      ::com::sun::star::lang::WrappedTargetException,
+//UNUSED2008-05                                      ::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  
+//UNUSED2008-05                              // XServiceInfo
+//UNUSED2008-05      virtual ::rtl::OUString SAL_CALL getImplementationName(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05      virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  )
+//UNUSED2008-05                                  throw(::com::sun::star::uno::RuntimeException);
+//UNUSED2008-05  };
 
 
 class ScUnoHelpFunctions
Index: sc/inc/olinetab.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/olinetab.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.3
--- sc/inc/olinetab.hxx	10 Apr 2008 18:41:55 -0000	1.6
+++ sc/inc/olinetab.hxx	13 May 2008 03:45:32 -0000	1.6.32.3
@@ -54,9 +54,6 @@
 							ScOutlineEntry( SCCOLROW nNewStart, SCCOLROW nNewSize,
 												BOOL bNewHidden = FALSE );
 							ScOutlineEntry( const ScOutlineEntry& rEntry );
-							ScOutlineEntry( SvStream& rStream, ScMultipleReadHeader& rHdr );
-
-	void					Store( SvStream& rStream, ScMultipleWriteHeader& rHdr );
 
 	virtual	DataObject*		Clone() const;
 
@@ -135,9 +132,6 @@
                                 BOOL bShow,
                                 const ScBitMaskCompressedArray< SCCOLROW, BYTE>& rHiddenFlags );
 
-	void					Load( SvStream& rStream );
-	void					Store( SvStream& rStream );
-
 	void					RemoveAll();
 };
 
@@ -163,9 +157,6 @@
 	BOOL					TestInsertRow( SCSIZE nSize );
 	void					InsertRow( SCROW nStartRow, SCSIZE nSize );
 	BOOL					DeleteRow( SCROW nStartRow, SCSIZE nSize );
-
-	void					Load( SvStream& rStream );
-	void					Store( SvStream& rStream );
 };
 
 
Index: sc/inc/patattr.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/patattr.hxx,v
retrieving revision 1.14
retrieving revision 1.14.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.1
--- sc/inc/patattr.hxx	10 Apr 2008 18:44:23 -0000	1.14
+++ sc/inc/patattr.hxx	13 May 2008 18:34:42 -0000	1.14.32.1
@@ -136,18 +136,18 @@
                                 with text encoding RTL_TEXTENC_SYMBOL */
 	BOOL					IsSymbolFont() const;
 
-                            /** Create a FontToSubsFontConverter if needed for
-                                this pattern, else return 0.
-
-                                @param nFlags is the bit mask which shall be
-                                used for CreateFontToSubsFontConverter().
-
-                                The converter must be destroyed by the caller
-                                using DestroyFontToSubsFontConverter() which
-                                should be accomplished using the
-                                ScFontToSubsFontConverter_AutoPtr
-                             */
-    FontToSubsFontConverter GetSubsFontConverter( ULONG nFlags ) const;
+//UNUSED2008-05                          /** Create a FontToSubsFontConverter if needed for
+//UNUSED2008-05                              this pattern, else return 0.
+//UNUSED2008-05  
+//UNUSED2008-05                              @param nFlags is the bit mask which shall be
+//UNUSED2008-05                              used for CreateFontToSubsFontConverter().
+//UNUSED2008-05  
+//UNUSED2008-05                              The converter must be destroyed by the caller
+//UNUSED2008-05                              using DestroyFontToSubsFontConverter() which
+//UNUSED2008-05                              should be accomplished using the
+//UNUSED2008-05                              ScFontToSubsFontConverter_AutoPtr
+//UNUSED2008-05                           */
+//UNUSED2008-05  FontToSubsFontConverter GetSubsFontConverter( ULONG nFlags ) const;
 
 	ULONG					GetNumberFormat( SvNumberFormatter* ) const;
 	ULONG					GetNumberFormat( SvNumberFormatter* pFormatter,
Index: sc/inc/pivot.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/pivot.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.3
--- sc/inc/pivot.hxx	10 Apr 2008 18:44:40 -0000	1.8
+++ sc/inc/pivot.hxx	13 May 2008 00:33:44 -0000	1.8.32.3
@@ -65,12 +65,14 @@
 #include <com/sun/star/sheet/DataPilotFieldLayoutInfo.hpp>
 #include <com/sun/star/sheet/DataPilotFieldAutoShowInfo.hpp>
 
+#if OLD_PIVOT_IMPLEMENTATION
 #define PIVOT_STYLE_INNER		0
 #define PIVOT_STYLE_RESULT		1
 #define PIVOT_STYLE_CATEGORY	2
 #define PIVOT_STYLE_TITLE		3
 #define PIVOT_STYLE_FIELDNAME	4
 #define PIVOT_STYLE_TOP			5
+#endif
 
 class SvStream;
 class ScDocument;
@@ -140,6 +142,7 @@
 
 // -----------------------------------------------------------------------
 
+#if OLD_PIVOT_IMPLEMENTATION
 struct PivotColRef
 {
 	SCSIZE nDataIndex;
@@ -153,10 +156,12 @@
 		nFuncMask = PIVOT_FUNC_NONE;
 	}
 };
+#endif
 
 typedef PivotField			PivotFieldArr[PIVOT_MAXFIELD];
 typedef PivotField          PivotPageFieldArr[PIVOT_MAXPAGEFIELD];
 
+#if OLD_PIVOT_IMPLEMENTATION
 class PivotStrCollection : public StrCollection
 {
 	ScUserListData* pUserData;
@@ -357,6 +362,7 @@
 
 	String 	CreateNewName( USHORT nMin = 1 ) const;
 };
+#endif
 
 //------------------------------------------------------------------------
 
Index: sc/inc/postit.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/postit.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/inc/postit.hxx	10 Apr 2008 18:44:56 -0000	1.7
+++ sc/inc/postit.hxx	13 May 2008 18:34:42 -0000	1.7.32.1
@@ -124,32 +124,6 @@
 		&&  maItemSet	== rPostIt.maItemSet );
 }
 
-inline SvStream& operator>>( SvStream& rStream, ScPostIt& rPostIt )
-{
-	//	without bShown !!!
-
-    CharSet eSet = rStream.GetStreamCharSet();
-    String aText = rPostIt.GetText();
-    rStream.ReadByteString( aText, eSet );
-    rStream.ReadByteString( rPostIt.maStrDate, eSet );
-    rStream.ReadByteString( rPostIt.maStrAuthor, eSet );
-
-    return rStream;
-}
-
-inline SvStream& operator<<( SvStream& rStream, const ScPostIt& rPostIt )
-{
-	//	without bShown !!!
-
-    CharSet eSet = rStream.GetStreamCharSet();
-    String aText = rPostIt.GetText();
-    rStream.WriteByteString( aText, eSet );
-    rStream.WriteByteString( rPostIt.maStrDate, eSet );
-    rStream.WriteByteString( rPostIt.maStrAuthor, eSet );
-
-    return rStream;
-}
-
 // ============================================================================
 
 #endif
Index: sc/inc/printopt.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/printopt.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/inc/printopt.hxx	10 Apr 2008 18:45:13 -0000	1.5
+++ sc/inc/printopt.hxx	12 May 2008 15:56:56 -0000	1.5.32.2
@@ -66,7 +66,7 @@
 {
 public:
 				TYPEINFO();
-				ScTpPrintItem( USHORT nWhich );
+//UNUSED2008-05  ScTpPrintItem( USHORT nWhich );
 				ScTpPrintItem( USHORT nWhich,
 							   const ScPrintOptions& rOpt );
 				ScTpPrintItem( const ScTpPrintItem& rItem );
@@ -94,7 +94,6 @@
 			ScPrintCfg();
 
 	void			SetOptions( const ScPrintOptions& rNew );
-	void			OptionsChanged();	// after direct access to ScPrintOptions base class
 
 	virtual void	Commit();
 };
Index: sc/inc/progress.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/progress.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/inc/progress.hxx	10 Apr 2008 18:45:48 -0000	1.3
+++ sc/inc/progress.hxx	9 May 2008 21:22:37 -0000	1.3.32.1
@@ -68,8 +68,6 @@
 													BOOL bWait = TRUE );
 	static	ScProgress*		GetInterpretProgress() { return pInterpretProgress; }
 	static	void			DeleteInterpretProgress();
-	static	void			SetAllowInterpret( BOOL bVal );
-	static	BOOL			GetAllowInterpret() { return bAllowInterpretProgress; }
 	static	ULONG			GetInterpretCount() { return nInterpretProgress; }
 	static	ULONG			GetGlobalRange()	{ return nGlobalRange; }
 	static	ULONG			GetGlobalPercent()	{ return nGlobalPercent; }
Index: sc/inc/rangelst.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rangelst.hxx,v
retrieving revision 1.9
retrieving revision 1.9.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.3
--- sc/inc/rangelst.hxx	10 Apr 2008 18:46:05 -0000	1.9
+++ sc/inc/rangelst.hxx	9 May 2008 21:22:37 -0000	1.9.32.3
@@ -50,7 +50,6 @@
 	virtual 		~ScRangeList();
 	ScRangeList&	operator=(const ScRangeList& rList);
 	void			RemoveAll();
-	ScRangeList*	Clone() const;
 	void			Append( const ScRange& rRange )
 					{
 						ScRangePtr pR = new ScRange( rRange );
@@ -68,9 +67,6 @@
 									const ScRange& rWhere,
 									SCsCOL nDx, SCsROW nDy, SCsTAB nDz );
 	ScRange*		Find( const ScAddress& ) const;
-	ScRange*		Find( const ScRange& ) const;
-	BOOL			Load( SvStream&, USHORT nVer );
-	BOOL			Store( SvStream& ) const;
 	BOOL			operator==( const ScRangeList& ) const;
 	BOOL			Intersects( const ScRange& ) const;
 	BOOL			In( const ScRange& ) const;
@@ -102,8 +98,6 @@
     void            DeleteOnTab( SCTAB nTab );
 	ScRangePair*	Find( const ScAddress& ) const;
 	ScRangePair*	Find( const ScRange& ) const;
-	BOOL			Load( SvStream&, USHORT nVer );
-	BOOL			Store( SvStream& ) const;
 	ScRangePair**	CreateNameSortedArray( ULONG& nCount, ScDocument* ) const;
 	BOOL			operator==( const ScRangePairList& ) const;
 };
Index: sc/inc/rangenam.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rangenam.hxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/inc/rangenam.hxx	10 Apr 2008 18:46:24 -0000	1.16
+++ sc/inc/rangenam.hxx	9 May 2008 21:22:38 -0000	1.16.32.1
@@ -152,8 +152,6 @@
 
 	void			ReplaceRangeNamesInUse( const ScIndexMap& rMap );
 
-	BOOL			IsBeyond( SCROW nMaxRow ) const;
-
 	static void		MakeValidName( String& rName );
 	SC_DLLPUBLIC static BOOL		IsNameValid( const String& rName, ScDocument* pDoc );
 };
Index: sc/inc/rangeutl.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rangeutl.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.3
--- sc/inc/rangeutl.hxx	10 Apr 2008 18:47:01 -0000	1.10
+++ sc/inc/rangeutl.hxx	13 May 2008 18:34:42 -0000	1.10.32.3
@@ -118,11 +118,6 @@
 							sal_Bool bAppendStr,
                             sal_Unicode cSeperator = ' ');
 
-    static void			AppendString(
-							::rtl::OUString& rString,
-							const ::rtl::OUString& rNewStr,
-                            sal_Unicode cSeperator = ' ');
-
 	static sal_Int32	IndexOf(
 							const ::rtl::OUString& rString,
 							sal_Unicode cSearchChar,
@@ -264,13 +259,9 @@
 
 			ScArea( const ScArea& r );
 
-	void	Clear		();
 	ScArea&	operator=	( const ScArea& r );
 	BOOL	operator==	( const ScArea& r ) const;
 	BOOL	operator!=	( const ScArea& r ) const  { return !( operator==(r) ); }
-	void	GetString	( String& rStr,
-						  BOOL bAbsolute = TRUE, ScDocument* pDoc = NULL,
-						  ScAddress::Details const & rDetails = ScAddress::detailsOOOa1 ) const;
 
 public:
 	SCTAB nTab;
@@ -280,9 +271,6 @@
 	SCROW nRowEnd;
 };
 
-SvStream& operator<< ( SvStream& rStream, const ScArea& rArea );
-SvStream& operator>> ( SvStream& rStream, ScArea& rArea );
-
 //------------------------------------------------------------------------
 
 //
Index: sc/inc/rechead.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rechead.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.2
Index: sc/inc/refdata.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/refdata.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/inc/refdata.hxx	10 Apr 2008 18:48:00 -0000	1.7
+++ sc/inc/refdata.hxx	12 May 2008 15:56:56 -0000	1.7.32.2
@@ -112,9 +112,9 @@
             void SmartRelAbs( const ScAddress& rPos );
             void CalcRelFromAbs( const ScAddress& rPos );
             void CalcAbsIfRel( const ScAddress& rPos );
-            void OldBoolsToNewFlags( const OldSingleRefBools& );
-            BYTE CreateStoreByteFromFlags() const;
-            void CreateFlagsFromLoadByte( BYTE );
+//UNUSED2008-05  void OldBoolsToNewFlags( const OldSingleRefBools& );
+//UNUSED2008-05  BYTE CreateStoreByteFromFlags() const;
+//UNUSED2008-05  void CreateFlagsFromLoadByte( BYTE );
             BOOL operator==( const SingleRefData& ) const;
 };
 
Index: sc/inc/scdll.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/scdll.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/inc/scdll.hxx	10 Apr 2008 18:49:51 -0000	1.5
+++ sc/inc/scdll.hxx	12 May 2008 16:41:58 -0000	1.5.32.2
@@ -70,9 +70,7 @@
 	static void 	Init(); 	// called directly after loading the DLL
 	static void 	Exit(); 	// called directly befor unloading the DLL
 
-
-	static void 	FillStatusBar(StatusBar &rBar);
-
+//UNUSED2008-05  static void 	FillStatusBar(StatusBar &rBar);
 	static ULONG	DetectFilter( SfxMedium& rMedium, const SfxFilter** ppFilter,
 									SfxFilterFlags nMust, SfxFilterFlags nDont );
 };
Index: sc/inc/scimpexpmsg.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/scimpexpmsg.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.2
--- sc/inc/scimpexpmsg.hxx	10 Apr 2008 18:51:18 -0000	1.4
+++ sc/inc/scimpexpmsg.hxx	12 May 2008 16:41:58 -0000	1.4.32.2
@@ -35,74 +35,73 @@
 #include <tools/string.hxx>
 #include <tools/solar.h>
 
-enum ScImpExpMsg
-{
-	SC_IMPEXPMSG_UNKNOWN
-};
-
-
-class String;
-
-
-class ScImpExpLogMsg
-{
-private:
-	ScImpExpMsg				eId;
-	String*					pPos;
-	String*					pHint;
-protected:
-public:
-							ScImpExpLogMsg( ScImpExpMsg eId );
-							ScImpExpLogMsg( ScImpExpMsg eId, const String& rPosition );
-							ScImpExpLogMsg( ScImpExpMsg eId, const String& rPosition, const String& rAdditionalHint );
-							ScImpExpLogMsg( const ScImpExpLogMsg& rCpy );
-	virtual					~ScImpExpLogMsg();
-
-	ScImpExpLogMsg&			operator =( const ScImpExpLogMsg& rCpy );
-
-	void					Set( ScImpExpMsg eId, const String* pPos = NULL, const String* pHint = NULL );
-
-	inline ScImpExpMsg		GetId( void ) const;
-	inline const String*	GetPos( void ) const;
-	inline const String*	GetHint( void ) const;
-
-	static String			GetMsg( ScImpExpMsg eId );
-	inline String			GetMsg( void ) const;
-};
-
-
-
-
-inline ScImpExpLogMsg& ScImpExpLogMsg::operator =( const ScImpExpLogMsg& r )
-{
-	Set( r.eId, r.pPos, r.pHint );
-	return *this;
-}
-
-
-inline ScImpExpMsg ScImpExpLogMsg::GetId( void ) const
-{
-	return eId;
-}
-
-
-inline const String* ScImpExpLogMsg::GetPos( void ) const
-{
-	return pPos;
-}
-
-
-inline const String* ScImpExpLogMsg::GetHint( void ) const
-{
-	return pHint;
-}
-
-
-inline String ScImpExpLogMsg::GetMsg( void ) const
-{
-	return GetMsg( eId );
-}
-
+//UNUSED2008-05  enum ScImpExpMsg
+//UNUSED2008-05  {
+//UNUSED2008-05      SC_IMPEXPMSG_UNKNOWN
+//UNUSED2008-05  };
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  class String;
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  class ScImpExpLogMsg
+//UNUSED2008-05  {
+//UNUSED2008-05  private:
+//UNUSED2008-05      ScImpExpMsg             eId;
+//UNUSED2008-05      String*                 pPos;
+//UNUSED2008-05      String*                 pHint;
+//UNUSED2008-05  protected:
+//UNUSED2008-05  public:
+//UNUSED2008-05                              ScImpExpLogMsg( ScImpExpMsg eId );
+//UNUSED2008-05                              ScImpExpLogMsg( ScImpExpMsg eId, const String& rPosition );
+//UNUSED2008-05                              ScImpExpLogMsg( ScImpExpMsg eId, const String& rPosition, const String& rAdditionalHint );
+//UNUSED2008-05                              ScImpExpLogMsg( const ScImpExpLogMsg& rCpy );
+//UNUSED2008-05      virtual                 ~ScImpExpLogMsg();
+//UNUSED2008-05  
+//UNUSED2008-05      ScImpExpLogMsg&         operator =( const ScImpExpLogMsg& rCpy );
+//UNUSED2008-05  
+//UNUSED2008-05      void                    Set( ScImpExpMsg eId, const String* pPos = NULL, const String* pHint = NULL );
+//UNUSED2008-05  
+//UNUSED2008-05      inline ScImpExpMsg      GetId( void ) const;
+//UNUSED2008-05      inline const String*    GetPos( void ) const;
+//UNUSED2008-05      inline const String*    GetHint( void ) const;
+//UNUSED2008-05  
+//UNUSED2008-05      static String           GetMsg( ScImpExpMsg eId );
+//UNUSED2008-05      inline String           GetMsg( void ) const;
+//UNUSED2008-05  };
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  inline ScImpExpLogMsg& ScImpExpLogMsg::operator =( const ScImpExpLogMsg& r )
+//UNUSED2008-05  {
+//UNUSED2008-05      Set( r.eId, r.pPos, r.pHint );
+//UNUSED2008-05      return *this;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  inline ScImpExpMsg ScImpExpLogMsg::GetId( void ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return eId;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  inline const String* ScImpExpLogMsg::GetPos( void ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return pPos;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  inline const String* ScImpExpLogMsg::GetHint( void ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return pHint;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  inline String ScImpExpLogMsg::GetMsg( void ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return GetMsg( eId );
+//UNUSED2008-05  }
 
 #endif
 
Index: sc/inc/scmatrix.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/scmatrix.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.1
--- sc/inc/scmatrix.hxx	10 Apr 2008 18:51:53 -0000	1.11
+++ sc/inc/scmatrix.hxx	9 May 2008 21:22:38 -0000	1.11.32.1
@@ -199,8 +199,6 @@
     void PutDouble( double fVal, SCSIZE nC, SCSIZE nR);
     void PutDouble( double fVal, SCSIZE nIndex)
         { pMat[nIndex].fVal = fVal; }
-    void PutDoubleAndResetString( double fVal, SCSIZE nC, SCSIZE nR );
-    void PutDoubleAndResetString( double fVal, SCSIZE nIndex );
     void PutString( const String& rStr, SCSIZE nC, SCSIZE nR);
     void PutString( const String& rStr, SCSIZE nIndex);
     void PutEmpty( SCSIZE nC, SCSIZE nR);
@@ -217,8 +215,6 @@
 
     void FillDouble( double fVal,
             SCSIZE nC1, SCSIZE nR1, SCSIZE nC2, SCSIZE nR2 );
-    /// lower left triangle
-    void FillDoubleLowerLeft( double fVal, SCSIZE nC2 );
 
     /** May be used before obtaining the double value of an element to avoid
         passing its NAN around.
@@ -295,10 +291,6 @@
 
     void MatTrans( ScMatrix& mRes) const;
     void MatCopy ( ScMatrix& mRes) const;
-    /** Copy upper left of this matrix to mRes matrix.
-        This matrix's dimensions must be greater than the mRes matrix
-        dimensions. */
-    void MatCopyUpperLeft( ScMatrix& mRes) const;
 
     // Convert ScInterpreter::CompareMat values (-1,0,1) to boolean values
     void CompareEqual();
Index: sc/inc/scmod.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/scmod.hxx,v
retrieving revision 1.24
retrieving revision 1.24.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.24 -r1.24.32.1
--- sc/inc/scmod.hxx	10 Apr 2008 18:52:14 -0000	1.24
+++ sc/inc/scmod.hxx	9 May 2008 21:22:38 -0000	1.24.32.1
@@ -152,7 +152,6 @@
 	virtual void    	FillStatusBar(StatusBar &rBar);
 	virtual void		Notify( SfxBroadcaster& rBC, const SfxHint& rHint );
 	void				DeleteCfg();
-	void				CloseDialogs();
 
 						// von der Applikation verschoben:
 
@@ -238,7 +237,6 @@
 	void				SetRefInputHdl( ScInputHandler* pNew );
 	ScInputHandler*		GetRefInputHdl();
 
-	void				SetInputWindow( ScInputWindow* pWin );
 	void				ViewShellGone(ScTabViewShell* pViewSh);
 	void				ViewShellChanged();
 	// Kommunikation mit Funktionsautopilot
Index: sc/inc/servuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/servuno.hxx,v
retrieving revision 1.14
retrieving revision 1.14.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.2
--- sc/inc/servuno.hxx	10 Apr 2008 18:53:59 -0000	1.14
+++ sc/inc/servuno.hxx	12 May 2008 15:56:56 -0000	1.14.32.2
@@ -105,7 +105,7 @@
 	static ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >
 							MakeInstance( sal_uInt16 nType, ScDocShell* pDocShell );
 	static ::com::sun::star::uno::Sequence<rtl::OUString> GetAllServiceNames();
-	static String			GetProviderName(sal_uInt16 nObjectType);
+//UNUSED2008-05  static String           GetProviderName(sal_uInt16 nObjectType);
 	static sal_uInt16		GetProviderType(const String& rServiceName);
 };
 
Index: sc/inc/stlpool.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/stlpool.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/inc/stlpool.hxx	10 Apr 2008 18:55:31 -0000	1.6
+++ sc/inc/stlpool.hxx	13 May 2008 14:34:07 -0000	1.6.32.1
@@ -56,7 +56,7 @@
 
 	void				CreateStandardStyles();
 	void				CopyStdStylesFrom( ScStyleSheetPool* pSrcPool );
-	void				UpdateStdNames();
+//UNUSED2008-05  void				UpdateStdNames();
 
 	void				CopyStyleFrom( ScStyleSheetPool* pSrcPool,
 										const String& rName, SfxStyleFamily eFamily );
@@ -69,8 +69,6 @@
 	virtual SfxStyleSheetBase& Make( const String&, SfxStyleFamily eFam,
 									 USHORT nMask = 0xffff, USHORT nPos = 0xffff );
 
-    void                ConvertFontsAfterLoad();     // old binary file format
-
 protected:
 	virtual 			~ScStyleSheetPool();
 
Index: sc/inc/styleuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/styleuno.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/inc/styleuno.hxx	10 Apr 2008 18:56:28 -0000	1.6
+++ sc/inc/styleuno.hxx	9 May 2008 21:22:38 -0000	1.6.32.1
@@ -219,8 +219,8 @@
 											throw(::com::sun::star::lang::IllegalArgumentException,
 													::com::sun::star::uno::RuntimeException);
 
+	ScStyleObj(); // disabled
 public:
-							ScStyleObj();
 							ScStyleObj(ScDocShell* pDocSh, SfxStyleFamily eFam, const String& rName);
 	virtual					~ScStyleObj();
 
Index: sc/inc/subtotal.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/subtotal.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/inc/subtotal.hxx	10 Apr 2008 18:56:46 -0000	1.5
+++ sc/inc/subtotal.hxx	13 May 2008 14:34:07 -0000	1.5.32.1
@@ -35,6 +35,7 @@
 
 class SubTotal
 {
+#if OLD_PIVOT_IMPLEMENTATION
 private:
 	long	nCount;
 	long	nCount2;
@@ -62,6 +63,9 @@
 	short	Valid( USHORT nFunction ) const;
 							// return 0 => Fehler, -1 => kein Wert, 1 => ok
 	double	Result( USHORT nFunction ) const;
+#endif
+public:
+
 	static  BOOL SafePlus( double& fVal1, double fVal2);
 	static  BOOL SafeMult( double& fVal1, double fVal2);
 	static  BOOL SafeDiv( double& fVal1, double fVal2);
Index: sc/inc/table.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/table.hxx,v
retrieving revision 1.35
retrieving revision 1.35.30.6
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.35 -r1.35.30.6
--- sc/inc/table.hxx	10 Apr 2008 18:57:06 -0000	1.35
+++ sc/inc/table.hxx	13 May 2008 14:34:07 -0000	1.35.30.6
@@ -350,13 +350,13 @@
 	BOOL		HasData( SCCOL nCol, SCROW nRow );
 	BOOL		HasStringData( SCCOL nCol, SCROW nRow );
 	BOOL		HasValueData( SCCOL nCol, SCROW nRow );
-	USHORT		GetErrorData(SCCOL nCol, SCROW nRow) const;
+//UNUSED2008-05  USHORT		GetErrorData(SCCOL nCol, SCROW nRow) const;
 	BOOL		HasStringCells( SCCOL nStartCol, SCROW nStartRow,
 								SCCOL nEndCol, SCROW nEndRow ) const;
 
 	USHORT		GetErrCode( const ScAddress& rPos ) const
 					{ return aCol[rPos.Col()].GetErrCode( rPos.Row() ); }
-	USHORT		GetErrCode( SCCOL nCol, SCROW nRow ) const;
+//UNUSED2008-05  USHORT		GetErrCode( SCCOL nCol, SCROW nRow ) const;
 
 	void		ResetChanged( const ScRange& rRange );
 
@@ -385,7 +385,7 @@
 	void		UpdateGrow( const ScRange& rArea, SCCOL nGrowX, SCROW nGrowY );
 
 	void		UpdateInsertTab(SCTAB nTable);
-	void		UpdateInsertTabOnlyCells(SCTAB nTable);
+//UNUSED2008-05  void        UpdateInsertTabOnlyCells(SCTAB nTable);
 	void 		UpdateDeleteTab( SCTAB nTable, BOOL bIsMove, ScTable* pRefUndo = NULL );
 	void		UpdateMoveTab(SCTAB nOldPos, SCTAB nNewPos, SCTAB nTabNo, ScProgress& );
 	void		UpdateCompile( BOOL bForceIfNameInUse = FALSE );
@@ -551,8 +551,6 @@
 	void		SetRowFlags( SCROW nRow, BYTE nNewFlags );
 	void		SetRowFlags( SCROW nStartRow, SCROW nEndRow, BYTE nNewFlags );
 
-                /// @return  the index of the last column with any set flags (auto-pagebreak is ignored).
-    SCCOL      GetLastFlaggedCol() const;
                 /// @return  the index of the last row with any set flags (auto-pagebreak is ignored).
     SCROW      GetLastFlaggedRow() const;
 
@@ -580,10 +578,6 @@
 
 	void		StripHidden( SCCOL& rX1, SCROW& rY1, SCCOL& rX2, SCROW& rY2 );
 	void		ExtendHidden( SCCOL& rX1, SCROW& rY1, SCCOL& rX2, SCROW& rY2 );
-
-	BOOL		Load( SvStream& rStream, USHORT nVersion, ScProgress* pProgress );
-	BOOL		Save( SvStream& rStream, long& rSavedDocCells, ScProgress* pProgress ) const;
-
 	void		Sort(const ScSortParam& rSortParam, BOOL bKeepQuery);
     BOOL        ValidQuery(SCROW nRow, const ScQueryParam& rQueryParam,
                     BOOL* pSpecial = NULL, ScBaseCell* pCell = NULL,
Index: sc/inc/textuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/textuno.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.1
--- sc/inc/textuno.hxx	10 Apr 2008 18:58:28 -0000	1.15
+++ sc/inc/textuno.hxx	9 May 2008 16:11:45 -0000	1.15.32.1
@@ -77,8 +77,9 @@
 	EditTextObject*	pRightText;
 	SfxBroadcaster	aBC;
 
+    ScHeaderFooterContentObj(); // disabled
+
 public:
-							ScHeaderFooterContentObj();
 							ScHeaderFooterContentObj( const EditTextObject* pLeft,
 													  const EditTextObject* pCenter,
 													  const EditTextObject* pRight );
@@ -352,7 +353,6 @@
 						ScEditEngineTextObj();
         virtual                         ~ScEditEngineTextObj() throw();
 
-	void				SetText( const String& rStr );
 	void				SetText( const EditTextObject& rTextObject );
 	EditTextObject*		CreateTextObject();
 };
Index: sc/inc/token.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/token.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.2
--- sc/inc/token.hxx	10 Apr 2008 18:58:50 -0000	1.15
+++ sc/inc/token.hxx	12 May 2008 15:56:56 -0000	1.15.32.2
@@ -178,10 +178,10 @@
             BOOL                TextEqual( const ScToken& rToken ) const;
             BOOL                Is3DRef() const;    // reference with 3D flag set
 
-    // If token in RPN resulted from resolving a name and contains an absolute
-    // reference. Token must be obtained through ScTokenArray::GetNextReferenceRPN()
-    // or similar.
-            BOOL                IsRPNReferenceAbsName() const;
+//UNUSED2008-05  // If token in RPN resulted from resolving a name and contains an absolute
+//UNUSED2008-05  // reference. Token must be obtained through ScTokenArray::GetNextReferenceRPN()
+//UNUSED2008-05  // or similar.
+//UNUSED2008-05  BOOL                IsRPNReferenceAbsName() const;
 
     /** If rTok1 and rTok2 both are SingleRef or DoubleRef tokens, extend/merge
         ranges as needed for ocRange.
Index: sc/inc/tokenarray.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/tokenarray.hxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/inc/tokenarray.hxx	10 Apr 2008 18:59:08 -0000	1.12
+++ sc/inc/tokenarray.hxx	12 May 2008 15:56:56 -0000	1.12.32.2
@@ -112,8 +112,9 @@
 
     BOOL    HasOpCode( OpCode ) const;
     BOOL    HasOpCodeRPN( OpCode ) const;
-    /// Token of type svIndex
-    BOOL    HasName() const;
+//UNUSED2008-05  /// Token of type svIndex
+//UNUSED2008-05  BOOL    HasName() const;
+
     /// Token of type svIndex or opcode ocColRowName
     BOOL    HasNameOrColRowName() const;
     /// Exactly and only one range (valid or deleted)
Index: sc/inc/userlist.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/userlist.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.3
--- sc/inc/userlist.hxx	10 Apr 2008 19:01:28 -0000	1.5
+++ sc/inc/userlist.hxx	13 May 2008 14:34:07 -0000	1.5.32.3
@@ -49,11 +49,10 @@
 public:
 					ScUserListData(const String& rStr);
 					ScUserListData(const ScUserListData& rData);
-					ScUserListData( SvStream& rStream );
 	virtual			~ScUserListData();
 
 	virtual	DataObject*		Clone() const { return new ScUserListData(*this); }
-			BOOL			Store( SvStream& rStream ) const;
+
 	const	String&			GetString() const { return aStr; }
 			void			SetString( const String& rStr);
 			USHORT			GetSubCount() const;
@@ -73,8 +72,6 @@
 	virtual	DataObject*		Clone() const;
 
 			ScUserListData*	GetData( const String& rSubStr ) const;
-			BOOL			Load( SvStream& rStream );
-			BOOL			Store( SvStream& rStream ) const;
             /// If the list in rStr is already inserted
             BOOL            HasEntry( const String& rStr ) const;
 
Index: sc/inc/validat.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/validat.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.3
--- sc/inc/validat.hxx	10 Apr 2008 19:01:45 -0000	1.15
+++ sc/inc/validat.hxx	13 May 2008 03:45:32 -0000	1.15.32.3
@@ -98,12 +98,8 @@
 								ScDocument* pDocument, const ScAddress& rPos );
 			ScValidationData( const ScValidationData& r );
 			ScValidationData( ScDocument* pDocument, const ScValidationData& r );
-			ScValidationData( SvStream& rStream, ScMultipleReadHeader& rHdr,
-								ScDocument* pDocument );
 	virtual	~ScValidationData();
 
-	void			Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const;
-
 	ScValidationData* Clone() const		// echte Kopie
 					{ return new ScValidationData( GetDocument(), *this ); }
 	ScValidationData* Clone(ScDocument* pNew) const
@@ -201,8 +197,6 @@
 
 	ScValidationData* GetData( sal_uInt32 nKey );
 
-	void	Load( SvStream& rStream, ScDocument* pDocument );
-	void	Store( SvStream& rStream ) const;
 	void	ResetUsed();
 
 	void	CompileXML();
Index: sc/inc/viewopti.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/viewopti.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.3
--- sc/inc/viewopti.hxx	10 Apr 2008 19:02:02 -0000	1.8
+++ sc/inc/viewopti.hxx	13 May 2008 18:34:42 -0000	1.8.32.3
@@ -90,9 +90,6 @@
 	const ScGridOptions&	operator=  ( const ScGridOptions& rCpy );
 	int						operator== ( const ScGridOptions& rOpt ) const;
 	int						operator!= ( const ScGridOptions& rOpt ) const { return !(operator==(rOpt)); }
-
-	friend SvStream& 		operator>> ( SvStream& rStream, ScGridOptions& rOpt );
-	friend SvStream&		operator<< ( SvStream& rStream, const ScGridOptions& rOpt );
 };
 
 //==================================================================
@@ -128,10 +125,6 @@
 	int						operator== ( const ScViewOptions& rOpt ) const;
 	int						operator!= ( const ScViewOptions& rOpt ) const { return !(operator==(rOpt)); }
 
-	friend SvStream& 		operator>> ( SvStream& rStream, ScViewOptions& rOpt );
-
-	void					Save(SvStream& rStream, BOOL bConfig = FALSE) const;
-
 private:
 	BOOL			aOptArr		[MAX_OPT];
 	ScVObjMode		aModeArr	[MAX_TYPE];
@@ -141,12 +134,6 @@
 	BOOL			bHideAutoSpell;
 };
 
-inline SvStream& operator<<( SvStream& rStream, const ScViewOptions& rOpt )
-{
-	rOpt.Save( rStream, FALSE );
-	return rStream;
-}
-
 //==================================================================
 // Item fuer Einstellungsdialog - Ansicht
 //==================================================================
@@ -155,7 +142,7 @@
 {
 public:
 				TYPEINFO();
-				ScTpViewItem( USHORT nWhich );
+//UNUSED2008-05  ScTpViewItem( USHORT nWhich );
 				ScTpViewItem( USHORT nWhich, const ScViewOptions& rOpt );
 				ScTpViewItem( const ScTpViewItem&  rItem );
 				~ScTpViewItem();
Index: sc/inc/viewuno.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/viewuno.hxx,v
retrieving revision 1.12
retrieving revision 1.12.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.1
--- sc/inc/viewuno.hxx	10 Apr 2008 19:02:17 -0000	1.12
+++ sc/inc/viewuno.hxx	9 May 2008 21:22:39 -0000	1.12.32.1
@@ -211,8 +211,8 @@
     void                    StartActivationListening();
     void                    EndActivationListening();
 
+	ScTabViewObj(); // disabled
 public:
-							ScTabViewObj();
 							ScTabViewObj(ScTabViewShell* pViewSh);
 	virtual					~ScTabViewObj();
 
Index: sc/inc/xmlwrap.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/xmlwrap.hxx,v
retrieving revision 1.16
retrieving revision 1.16.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.2
--- sc/inc/xmlwrap.hxx	10 Apr 2008 19:03:04 -0000	1.16
+++ sc/inc/xmlwrap.hxx	12 May 2008 15:56:56 -0000	1.16.32.2
@@ -58,8 +58,8 @@
 	SfxMedium*		pMedium;
     ::com::sun::star::uno::Reference< ::com::sun::star::embed::XStorage > xStorage;
 
-	com::sun::star::uno::Reference< com::sun::star::task::XStatusIndicator> GetStatusIndicator(
-		com::sun::star::uno::Reference< com::sun::star::frame::XModel >& rModel);
+//UNUSED2008-05  com::sun::star::uno::Reference< com::sun::star::task::XStatusIndicator> GetStatusIndicator(
+//UNUSED2008-05      com::sun::star::uno::Reference< com::sun::star::frame::XModel >& rModel);
 	com::sun::star::uno::Reference< com::sun::star::task::XStatusIndicator> GetStatusIndicator();
 
 	sal_uInt32 ImportFromComponent(com::sun::star::uno::Reference<com::sun::star::lang::XMultiServiceFactory>& xServiceFactory,
Index: sc/source/core/data/attarray.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/attarray.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.2
--- sc/source/core/data/attarray.cxx	10 Apr 2008 19:17:47 -0000	1.25
+++ sc/source/core/data/attarray.cxx	13 May 2008 14:34:07 -0000	1.25.32.2
@@ -1799,39 +1799,39 @@
 }
 
 
-SCROW ScAttrArray::GetFirstEntryPos() const
-{
-	DBG_ASSERT( nCount, "nCount = 0" );
-
-	if ( pData[0].pPattern != pDocument->GetDefPattern() )
-		return 0;
-	else
-	{
-		if (nCount==1)
-			return 0;								// leer
-		else
-			return pData[0].nRow + 1;
-	}
-}
-
-
-SCROW ScAttrArray::GetLastEntryPos( BOOL bIncludeBottom ) const
-{
-	DBG_ASSERT( nCount, "nCount == 0" );
-
-	if (bIncludeBottom)
-		bIncludeBottom = ( pData[nCount-1].pPattern != pDocument->GetDefPattern() );
-
-	if (bIncludeBottom)
-		return MAXROW;
-	else
-	{
-		if (nCount<=1)
-			return 0;								// leer
-		else
-			return pData[nCount-2].nRow;
-	}
-}
+//UNUSED2008-05  SCROW ScAttrArray::GetFirstEntryPos() const
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( nCount, "nCount = 0" );
+//UNUSED2008-05  
+//UNUSED2008-05      if ( pData[0].pPattern != pDocument->GetDefPattern() )
+//UNUSED2008-05          return 0;
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          if (nCount==1)
+//UNUSED2008-05              return 0;                               // leer
+//UNUSED2008-05          else
+//UNUSED2008-05              return pData[0].nRow + 1;
+//UNUSED2008-05      }
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  SCROW ScAttrArray::GetLastEntryPos( BOOL bIncludeBottom ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( nCount, "nCount == 0" );
+//UNUSED2008-05  
+//UNUSED2008-05      if (bIncludeBottom)
+//UNUSED2008-05          bIncludeBottom = ( pData[nCount-1].pPattern != pDocument->GetDefPattern() );
+//UNUSED2008-05  
+//UNUSED2008-05      if (bIncludeBottom)
+//UNUSED2008-05          return MAXROW;
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          if (nCount<=1)
+//UNUSED2008-05              return 0;                               // leer
+//UNUSED2008-05          else
+//UNUSED2008-05              return pData[nCount-2].nRow;
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 
 BOOL ScAttrArray::GetFirstVisibleAttr( SCROW& rFirstRow ) const
@@ -2463,6 +2463,7 @@
 //
 
 
+#if 0
 void ScAttrArray::Save( SvStream& /* rStream */ ) const
 {
 #if SC_ROWLIMIT_STREAM_ACCESS
@@ -2560,42 +2561,43 @@
 	}
 #endif // SC_ROWLIMIT_STREAM_ACCESS
 }
+#endif
 
 
-void ScAttrArray::ConvertFontsAfterLoad()
-{
-    ScFontToSubsFontConverter_AutoPtr xFontConverter;
-    const ULONG nFlags = FONTTOSUBSFONT_IMPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
-    SCSIZE   nIndex = 0;
-    SCROW  nThisRow = 0;
-
-    while ( nThisRow <= MAXROW )
-	{
-        const ScPatternAttr* pOldPattern = pData[nIndex].pPattern;
-        const SfxPoolItem* pItem;
-        if( pOldPattern->GetItemSet().GetItemState( ATTR_FONT, FALSE, &pItem ) == SFX_ITEM_SET )
-        {
-            const SvxFontItem* pFontItem = (const SvxFontItem*) pItem;
-            const String& rOldName = pFontItem->GetFamilyName();
-            xFontConverter = CreateFontToSubsFontConverter( rOldName, nFlags );
-            if ( xFontConverter )
-            {
-                String aNewName( GetFontToSubsFontName( xFontConverter ) );
-                if ( aNewName != rOldName )
-                {
-                    SCROW nAttrRow = pData[nIndex].nRow;
-                    SvxFontItem aNewItem( pFontItem->GetFamily(), aNewName,
-                        pFontItem->GetStyleName(), pFontItem->GetPitch(),
-                        RTL_TEXTENCODING_DONTKNOW, ATTR_FONT );
-                    ScPatternAttr aNewPattern( *pOldPattern );
-                    aNewPattern.GetItemSet().Put( aNewItem );
-                    SetPatternArea( nThisRow, nAttrRow, &aNewPattern, TRUE );
-                    Search( nThisRow, nIndex );     //! data changed
-                }
-            }
-        }
-		++nIndex;
-		nThisRow = pData[nIndex-1].nRow+1;
-	}
-}
+//UNUSED2008-05  void ScAttrArray::ConvertFontsAfterLoad()
+//UNUSED2008-05  {
+//UNUSED2008-05      ScFontToSubsFontConverter_AutoPtr xFontConverter;
+//UNUSED2008-05      const ULONG nFlags = FONTTOSUBSFONT_IMPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
+//UNUSED2008-05      SCSIZE   nIndex = 0;
+//UNUSED2008-05      SCROW  nThisRow = 0;
+//UNUSED2008-05  
+//UNUSED2008-05      while ( nThisRow <= MAXROW )
+//UNUSED2008-05      {
+//UNUSED2008-05          const ScPatternAttr* pOldPattern = pData[nIndex].pPattern;
+//UNUSED2008-05          const SfxPoolItem* pItem;
+//UNUSED2008-05          if( pOldPattern->GetItemSet().GetItemState( ATTR_FONT, FALSE, &pItem ) == SFX_ITEM_SET )
+//UNUSED2008-05          {
+//UNUSED2008-05              const SvxFontItem* pFontItem = (const SvxFontItem*) pItem;
+//UNUSED2008-05              const String& rOldName = pFontItem->GetFamilyName();
+//UNUSED2008-05              xFontConverter = CreateFontToSubsFontConverter( rOldName, nFlags );
+//UNUSED2008-05              if ( xFontConverter )
+//UNUSED2008-05              {
+//UNUSED2008-05                  String aNewName( GetFontToSubsFontName( xFontConverter ) );
+//UNUSED2008-05                  if ( aNewName != rOldName )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      SCROW nAttrRow = pData[nIndex].nRow;
+//UNUSED2008-05                      SvxFontItem aNewItem( pFontItem->GetFamily(), aNewName,
+//UNUSED2008-05                          pFontItem->GetStyleName(), pFontItem->GetPitch(),
+//UNUSED2008-05                          RTL_TEXTENCODING_DONTKNOW, ATTR_FONT );
+//UNUSED2008-05                      ScPatternAttr aNewPattern( *pOldPattern );
+//UNUSED2008-05                      aNewPattern.GetItemSet().Put( aNewItem );
+//UNUSED2008-05                      SetPatternArea( nThisRow, nAttrRow, &aNewPattern, TRUE );
+//UNUSED2008-05                      Search( nThisRow, nIndex );     //! data changed
+//UNUSED2008-05                  }
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05          ++nIndex;
+//UNUSED2008-05          nThisRow = pData[nIndex-1].nRow+1;
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
Index: sc/source/core/data/attrib.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/attrib.cxx,v
retrieving revision 1.19
retrieving revision 1.19.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.19 -r1.19.32.4
--- sc/source/core/data/attrib.cxx	10 Apr 2008 19:18:04 -0000	1.19
+++ sc/source/core/data/attrib.cxx	13 May 2008 18:34:49 -0000	1.19.32.4
@@ -183,18 +183,6 @@
 }
 
 //------------------------------------------------------------------------
-
-SvStream& ScMergeAttr::Store( SvStream& rStream, USHORT /* nVer */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << nColMerge;
-	rStream << nRowMerge;
-#endif
-	return rStream;
-}
-
-//------------------------------------------------------------------------
 // MergeFlag
 //------------------------------------------------------------------------
 
@@ -427,18 +415,6 @@
 
 //------------------------------------------------------------------------
 
-SvStream& ScProtectionAttr::Store( SvStream& rStream, USHORT /* nVer */ ) const
-{
-	rStream << bProtection;
-	rStream << bHideFormula;
-	rStream << bHideCell;
-	rStream << bHidePrint;
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
 BOOL ScProtectionAttr::SetProtection( BOOL bProtect)
 {
 	bProtection =  bProtect;
@@ -525,83 +501,6 @@
 	return ePres;
 }
 
-//-----------------------------------------------------------------------
-
-USHORT ScRangeItem::GetVersion( USHORT /* nFileVersion */ ) const
-{
-	return 2;
-}
-
-//-----------------------------------------------------------------------
-
-SvStream& ScRangeItem::Store( SvStream& rStrm, USHORT /* nVer */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStrm << aRange;
-	rStrm << nFlags;
-
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-	return rStrm;
-}
-
-//-----------------------------------------------------------------------
-
-SfxPoolItem* ScRangeItem::Create( SvStream& /* rStream */, USHORT /* nVersion */ ) const
-{
-	ScRange aNewRange;
-	BOOL	nNewFlags = FALSE;
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-
-	switch ( nVersion )
-	{
-		case 2:
-			rStream >> aNewRange;
-			rStream >> nNewFlags;
-			break;
-
-		case 1:
-			rStream >> aNewRange;
-			nNewFlags = 0;
-			break;
-
-		case 0:
-			{
-				// alte Version mit ScArea -> 5 USHORTs lesen
-				ScAddress&	rStart = aNewRange.aStart;
-				ScAddress&	rEnd   = aNewRange.aEnd;
-				USHORT		n;
-
-				rStream >> n;
-
-				if ( n > static_cast<sal_uInt16>(MAXTAB) )
-				{
-					nNewFlags = SCR_ALLTABS;
-					rStart.SetTab( 0 ); rEnd.SetTab( 0 );
-				}
-				else
-				{
-					nNewFlags = 0;
-					rStart.SetTab( static_cast<SCTAB>(n) ); rEnd.SetTab( static_cast<SCTAB>(n) );
-				}
-
-				rStream >> n; rStart.SetCol( static_cast<SCCOL>(n) );
-				rStream >> n; rStart.SetRow( static_cast<SCROW>(n) );
-				rStream >> n; rEnd  .SetCol( static_cast<SCCOL>(n) );
-				rStream >> n; rEnd  .SetRow( static_cast<SCROW>(n) );
-			}
-			break;
-
-		default:
-			DBG_ERROR( "ScRangeItem::Create: Unknown Version!" );
-	}
-
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-	return ( new ScRangeItem( Which(), aNewRange, nNewFlags ) );
-}
-
-
 // -----------------------------------------------------------------------
 //		ScTableListItem - Liste von Tabellen(-nummern)
 // -----------------------------------------------------------------------
@@ -623,13 +522,13 @@
 
 // -----------------------------------------------------------------------
 
-ScTableListItem::ScTableListItem( const USHORT nWhichP, const List& rList )
-    :   SfxPoolItem ( nWhichP ),
-		nCount		( 0 ),
-		pTabArr		( NULL )
-{
-	SetTableList( rList );
-}
+//UNUSED2008-05  ScTableListItem::ScTableListItem( const USHORT nWhichP, const List& rList )
+//UNUSED2008-05      :   SfxPoolItem ( nWhichP ),
+//UNUSED2008-05          nCount      ( 0 ),
+//UNUSED2008-05          pTabArr     ( NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05      SetTableList( rList );
+//UNUSED2008-05  }
 
 // -----------------------------------------------------------------------
 
@@ -640,45 +539,6 @@
 
 // -----------------------------------------------------------------------
 
-#if 0 /* OBSOLETE */
-void ScTableListItem::Record( SfxArguments& rArgs ) const
-{
-	rArgs.AppendInteger( nCount );
-
-	if ( nCount>0 && pTabArr )
-		for ( USHORT i=0; i<nCount; i++ )
-			rArgs.AppendInteger( pTabArr[i] );
-}
-
-// -----------------------------------------------------------------------
-
-SfxArgumentError ScTableListItem::Construct( USHORT nId, const SfxArguments& rArgs )
-{
-	USHORT nCount = rArgs.Get( 0 ).GetInteger();
-
-	if ( pTabArr )
-		delete [] pTabArr, pTabArr = NULL;
-
-	if ( nCount > 0 )
-	{
-		if ( rArgs.Count()-1 < nCount )
-			return SFX_ARGUMENT_ERROR( rArgs.Count(), SFX_ERR_ARGUMENT_EXPECTED );
-		if ( rArgs.Count()-1 > nCount )
-			return SFX_ARGUMENT_ERROR( rArgs.Count()-1, SFX_ERR_TOO_MANY_ARGUMENTS );
-
-		SetWhich( nId );
-		pTabArr = new SCTAB [nCount];
-
-		for ( USHORT i=0; i<nCount; i++ )
-			pTabArr[i] = rArgs.Get( i+1 ).GetInteger();
-	}
-
-	return 0;
-}
-#endif /* OBSOLETE */
-
-// -----------------------------------------------------------------------
-
 ScTableListItem& ScTableListItem::operator=( const ScTableListItem& rCpy )
 {
 	delete [] pTabArr;
@@ -774,55 +634,6 @@
 	return SFX_ITEM_PRESENTATION_NONE;
 }
 
-//-----------------------------------------------------------------------
-
-SvStream& ScTableListItem::Store( SvStream& rStrm, USHORT /* nVer */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStrm << nCount;
-
-	if ( nCount>0 && pTabArr )
-		for ( USHORT i=0; i<nCount; i++ )
-				rStrm << (USHORT) pTabArr[i];
-
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-	return rStrm;
-}
-
-//-----------------------------------------------------------------------
-
-SfxPoolItem* ScTableListItem::Create( SvStream& /* rStrm */, USHORT ) const
-{
-	ScTableListItem* pNewItem;
-	List			 aList;
-	SCTAB* 		     p;
-//    USHORT           nTabCount;
-//    USHORT           nTabNo;
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStrm >> nTabCount;
-
-	if ( nTabCount > 0 )
-	{
-		for ( USHORT i=0; i<nTabCount; i++ )
-		{
-			rStrm >> nTabNo;
-			aList.Insert( new SCTAB(nTabNo) );
-		}
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-
-	pNewItem = new ScTableListItem( Which(), aList );
-
-	aList.First();
-    while ( ( p = (SCTAB*)aList.Remove() ) != NULL )
-		delete p;
-
-	return pNewItem;
-}
-
 // -----------------------------------------------------------------------
 
 BOOL ScTableListItem::GetTableList( List& aList ) const
@@ -979,16 +790,6 @@
 
 //------------------------------------------------------------------------
 
-USHORT ScPageHFItem::GetVersion( USHORT /* nFileVersion */ ) const
-{
-	// 0 = ohne Feldbefehle
-	// 1 = Titel bzw. Dateiname mit SvxFileField
-	// 2 = Pfad und/oder Dateiname mit SvxExtFileField, Titel mit SvxFileField
-	return 2;
-}
-
-//------------------------------------------------------------------------
-
 void lcl_SetSpace( String& rStr, const ESelection& rSel )
 {
 	// Text durch ein Leerzeichen ersetzen, damit Positionen stimmen:
@@ -1141,25 +942,25 @@
 	BOOL		bConvert;
 
 public:
-				ScFieldChangerEditEngine( SfxItemPool* pEnginePool, BOOL bDeleteEnginePool );
+//UNUSED2008-05  ScFieldChangerEditEngine( SfxItemPool* pEnginePool, BOOL bDeleteEnginePool );
 	virtual		~ScFieldChangerEditEngine() {}
 
 	virtual String	CalcFieldValue( const SvxFieldItem& rField, USHORT nPara,
 									USHORT nPos, Color*& rTxtColor,
 									Color*& rFldColor );
 
-	BOOL			ConvertFields();
+//UNUSED2008-05  BOOL			ConvertFields();
 };
 
-ScFieldChangerEditEngine::ScFieldChangerEditEngine( SfxItemPool* pEnginePoolP,
-            BOOL bDeleteEnginePoolP ) :
-        ScEditEngineDefaulter( pEnginePoolP, bDeleteEnginePoolP ),
-		aExtFileId( TYPE( SvxExtFileField ) ),
-		nConvPara( 0 ),
-		nConvPos( 0 ),
-		bConvert( FALSE )
-{
-}
+//UNUSED2008-05  ScFieldChangerEditEngine::ScFieldChangerEditEngine( SfxItemPool* pEnginePoolP,
+//UNUSED2008-05              BOOL bDeleteEnginePoolP ) :
+//UNUSED2008-05          ScEditEngineDefaulter( pEnginePoolP, bDeleteEnginePoolP ),
+//UNUSED2008-05          aExtFileId( TYPE( SvxExtFileField ) ),
+//UNUSED2008-05          nConvPara( 0 ),
+//UNUSED2008-05          nConvPos( 0 ),
+//UNUSED2008-05          bConvert( FALSE )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 String ScFieldChangerEditEngine::CalcFieldValue( const SvxFieldItem& rField,
 			USHORT nPara, USHORT nPos, Color*& /* rTxtColor */, Color*& /* rFldColor */ )
@@ -1174,96 +975,22 @@
 	return EMPTY_STRING;
 }
 
-BOOL ScFieldChangerEditEngine::ConvertFields()
-{
-	BOOL bConverted = FALSE;
-	do
-	{
-		bConvert = FALSE;
-		UpdateFields();
-		if ( bConvert )
-		{
-			ESelection aSel( nConvPara, nConvPos, nConvPara, nConvPos+1 );
-            QuickInsertField( SvxFieldItem( SvxFileField(), EE_FEATURE_FIELD), aSel );
-			bConverted = TRUE;
-		}
-	} while ( bConvert );
-	return bConverted;
-}
-
-void lcl_StoreOldFields( ScFieldChangerEditEngine& rEngine,
-			const EditTextObject* pArea, SvStream& rStream )
-{
-	rEngine.SetText( *pArea );
-	if ( rEngine.ConvertFields() )
-	{
-		EditTextObject* pObj = rEngine.CreateTextObject();
-		pObj->Store( rStream );
-		delete pObj;
-	}
-	else
-		pArea->Store( rStream );
-}
-
-SvStream& ScPageHFItem::Store( SvStream& rStream, USHORT /* nVer */ ) const
-{
-	if ( pLeftArea && pCenterArea && pRightArea )
-	{
-		if ( rStream.GetVersion() < SOFFICE_FILEFORMAT_50 )
-		{
-			ScFieldChangerEditEngine aEngine( EditEngine::CreatePool(), TRUE );
-			lcl_StoreOldFields( aEngine, pLeftArea, rStream );
-			lcl_StoreOldFields( aEngine, pCenterArea, rStream );
-			lcl_StoreOldFields( aEngine, pRightArea, rStream );
-		}
-		else
-		{
-			pLeftArea->Store(rStream);
-			pCenterArea->Store(rStream);
-			pRightArea->Store(rStream);
-		}
-	}
-	else
-	{
-		//	soll eigentlich nicht sein, kommt aber vor, wenn das Default-Item
-		//	fuer ein ItemSet kopiert wird (#61826#) ...
-
-		ScFieldChangerEditEngine aEngine( EditEngine::CreatePool(), TRUE );
-		EditTextObject* pEmpytObj = aEngine.CreateTextObject();
-
-		DBG_ASSERT( pEmpytObj, "Error creating empty EditTextObject :-(" );
-
-		if ( rStream.GetVersion() < SOFFICE_FILEFORMAT_50 )
-		{
-			if ( pLeftArea )
-				lcl_StoreOldFields( aEngine, pLeftArea, rStream );
-			else
-				pEmpytObj->Store( rStream );
-
-			if ( pCenterArea )
-				lcl_StoreOldFields( aEngine, pCenterArea, rStream );
-			else
-				pEmpytObj->Store( rStream );
-
-			if ( pRightArea )
-				lcl_StoreOldFields( aEngine, pRightArea, rStream );
-			else
-				pEmpytObj->Store( rStream );
-		}
-		else
-		{
-			(pLeftArea   ? pLeftArea   : pEmpytObj )->Store(rStream);
-			(pCenterArea ? pCenterArea : pEmpytObj )->Store(rStream);
-			(pRightArea  ? pRightArea  : pEmpytObj )->Store(rStream);
-		}
-
-		delete pEmpytObj;
-	}
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
+//UNUSED2008-05  BOOL ScFieldChangerEditEngine::ConvertFields()
+//UNUSED2008-05  {
+//UNUSED2008-05      BOOL bConverted = FALSE;
+//UNUSED2008-05      do
+//UNUSED2008-05      {
+//UNUSED2008-05          bConvert = FALSE;
+//UNUSED2008-05          UpdateFields();
+//UNUSED2008-05          if ( bConvert )
+//UNUSED2008-05          {
+//UNUSED2008-05              ESelection aSel( nConvPara, nConvPos, nConvPara, nConvPos+1 );
+//UNUSED2008-05              QuickInsertField( SvxFieldItem( SvxFileField(), EE_FEATURE_FIELD), aSel );
+//UNUSED2008-05              bConverted = TRUE;
+//UNUSED2008-05          }
+//UNUSED2008-05      } while ( bConvert );
+//UNUSED2008-05      return bConverted;
+//UNUSED2008-05  }
 
 void ScPageHFItem::SetLeftArea( const EditTextObject& rNew )
 {
@@ -1483,15 +1210,6 @@
 
 //------------------------------------------------------------------------
 
-SvStream& ScDoubleItem::Store( SvStream& rStream, USHORT /* nVer */ ) const
-{
-	rStream << nValue;
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
 ScDoubleItem::~ScDoubleItem()
 {
 }
Index: sc/source/core/data/cell.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/cell.cxx,v
retrieving revision 1.42
retrieving revision 1.42.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.42 -r1.42.30.3
--- sc/source/core/data/cell.cxx	10 Apr 2008 19:18:53 -0000	1.42
+++ sc/source/core/data/cell.cxx	9 May 2008 04:45:55 -0000	1.42.30.3
@@ -200,12 +200,6 @@
 		return new ScStringCell( rString );
 }
 
-void ScBaseCell::LoadNote( SvStream& rStream, ScDocument* pDoc )
-{
-	pNote = new ScPostIt(pDoc);
-	rStream >> *pNote;
-}
-
 void ScBaseCell::SetBroadcaster(SvtBroadcaster* pNew)
 {
 	delete pBroadcaster;
@@ -724,18 +718,6 @@
 	}
 }
 
-BOOL lcl_IsBeyond( ScTokenArray* pCode, SCROW nMaxRow )
-{
-	ScToken* t;
-	pCode->Reset();
-    while ( ( t = pCode->GetNextReferenceRPN() ) != NULL )  // RPN -> also in names
-		if ( t->GetSingleRef().nRow > nMaxRow ||
-				(t->GetType() == svDoubleRef &&
-				t->GetDoubleRef().Ref2.nRow > nMaxRow) )
-			return TRUE;
-	return FALSE;
-}
-
 ScBaseCell* ScFormulaCell::Clone( ScDocument* pDoc, const ScAddress& rPos,
 		BOOL bNoListening ) const
 {
Index: sc/source/core/data/cell2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/cell2.cxx,v
retrieving revision 1.33
retrieving revision 1.33.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.30.2
--- sc/source/core/data/cell2.cxx	10 Apr 2008 19:19:17 -0000	1.33
+++ sc/source/core/data/cell2.cxx	13 May 2008 14:34:08 -0000	1.33.30.2
@@ -60,14 +60,6 @@
 
 // -----------------------------------------------------------------------
 
-ScEditCell::ScEditCell( ScDocument* pDocP ) :
-        ScBaseCell( CELLTYPE_EDIT ),
-        pData( NULL ),
-        pString( NULL ),
-        pDoc( pDocP )
-{
-}
-
 ScEditCell::ScEditCell( const EditTextObject* pObject, ScDocument* pDocP,
             const SfxItemPool* pFromPool )  :
         ScBaseCell( CELLTYPE_EDIT ),
@@ -85,28 +77,6 @@
     SetTextObject( rEditCell.pData, rEditCell.pDoc->GetEditPool() );
 }
 
-ScEditCell::ScEditCell( SvStream& rStream, USHORT nVer, ScDocument* pDocP ) :
-        ScBaseCell( CELLTYPE_EDIT ),
-        pString( NULL ),
-        pDoc( pDocP )
-{
-    if( nVer >= SC_DATABYTES2 )
-    {
-        BYTE cData;
-        rStream >> cData;
-        if( cData & 0x0F )
-            rStream.SeekRel( cData & 0x0F );
-    }
-    if ( nVer < SC_VERSION_EDITPOOL )
-    {   // jedes hat seinen eigenen Pool, dem neuen zuordnen
-        EditTextObject* pTmp = EditTextObject::Create( rStream );
-        SetTextObject( pTmp, NULL );
-        delete pTmp;
-    }
-    else
-        pData = EditTextObject::Create( rStream, pDoc->GetEditPool() );
-}
-
 ScEditCell::ScEditCell( const String& rString, ScDocument* pDocP )  :
         ScBaseCell( CELLTYPE_EDIT ),
         pString( NULL ),
@@ -171,24 +141,6 @@
         rString.Erase();
 }
 
-void ScEditCell::Save( SvStream& rStream ) const
-{
-    DBG_ASSERT(pData,"StoreTextObject(NULL)");
-    rStream << (BYTE) 0x00;
-    if ( rStream.GetVersion() < SOFFICE_FILEFORMAT_50 )
-    {   // jedem seinen eigenen Pool
-        ScEditEngineDefaulter aEngine( EditEngine::CreatePool(), TRUE );
-        // #52396# richtige Metric schreiben
-        aEngine.SetRefMapMode( MAP_100TH_MM );
-        aEngine.SetText( *pData );
-        EditTextObject* pTmp = aEngine.CreateTextObject();
-        pTmp->Store( rStream );
-        delete pTmp;
-    }
-    else
-        pData->Store( rStream );
-}
-
 void ScEditCell::SetTextObject( const EditTextObject* pObject,
             const SfxItemPool* pFromPool )
 {
@@ -514,12 +466,6 @@
     return FALSE;
 }
 
-BOOL ScFormulaCell::HasDBArea() const
-{
-    pCode->Reset();
-    return (pCode->GetNextDBArea() != NULL);
-}
-
 BOOL ScFormulaCell::HasColRowName() const
 {
     pCode->Reset();
@@ -1390,83 +1336,3 @@
     }
 }
 
-ScValueCell::ScValueCell( SvStream& rStream, USHORT nVer ) :
-    ScBaseCell( CELLTYPE_VALUE )
-{
-    if( nVer >= SC_DATABYTES2 )
-    {
-        BYTE cData;
-        rStream >> cData;
-        if( cData & 0x0F )
-            rStream.SeekRel( cData & 0x0F );
-    }
-    rStream >> aValue;
-}
-
-void ScValueCell::Save( SvStream& rStream ) const
-{
-    rStream << (BYTE) 0x00 << aValue;
-}
-
-ScStringCell::ScStringCell( SvStream& rStream, USHORT nVer ) :
-    ScBaseCell( CELLTYPE_STRING )
-{
-    if( nVer >= SC_DATABYTES2 )
-    {
-        BYTE cData;
-        rStream >> cData;
-        if( cData & 0x0F )
-            rStream.SeekRel( cData & 0x0F );
-    }
-    rStream.ReadByteString( aString, rStream.GetStreamCharSet() );
-}
-
-void ScStringCell::Save( SvStream& rStream, FontToSubsFontConverter hConv ) const
-{
-    rStream << (BYTE) 0x00;
-    if ( !hConv )
-        rStream.WriteByteString( aString, rStream.GetStreamCharSet() );
-    else
-    {
-        String aTmp( aString );
-        sal_Unicode* p = aTmp.GetBufferAccess();
-        sal_Unicode const * const pStop = p + aTmp.Len();
-        for ( ; p < pStop; ++p )
-        {
-            *p = ConvertFontToSubsFontChar( hConv, *p );
-        }
-        aTmp.ReleaseBufferAccess();
-        rStream.WriteByteString( aTmp, rStream.GetStreamCharSet() );
-    }
-}
-
-void ScStringCell::ConvertFont( FontToSubsFontConverter hConv )
-{
-    if ( hConv )
-    {
-        sal_Unicode* p = aString.GetBufferAccess();
-        sal_Unicode const * const pStop = p + aString.Len();
-        for ( ; p < pStop; ++p )
-        {
-            *p = ConvertFontToSubsFontChar( hConv, *p );
-        }
-        aString.ReleaseBufferAccess();
-    }
-}
-
-ScNoteCell::ScNoteCell( SvStream& rStream, USHORT nVer ) :
-    ScBaseCell( CELLTYPE_NOTE )
-{
-    if( nVer >= SC_DATABYTES2 )
-    {
-        BYTE cData;
-        rStream >> cData;
-        if( cData & 0x0F )
-            rStream.SeekRel( cData & 0x0F );
-    }
-}
-
-void ScNoteCell::Save( SvStream& rStream ) const
-{
-    rStream << (BYTE) 0x00;
-}
Index: sc/source/core/data/column.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/column.cxx,v
retrieving revision 1.31
retrieving revision 1.31.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.1
--- sc/source/core/data/column.cxx	10 Apr 2008 19:19:38 -0000	1.31
+++ sc/source/core/data/column.cxx	9 May 2008 04:45:55 -0000	1.31.32.1
@@ -824,41 +824,6 @@
 	pItems = pNewItems;
 }
 
-//	SetNewRow gehoert zu SwapRow
-
-void ScColumn::SetNewRow( SCROW nOldRow, SCROW nNewRow )	// nNewRow muss leer sein
-{
-	SCSIZE	nIndex;
-	if (Search(nOldRow, nIndex))
-	{
-		ScBaseCell* pCell = pItems[nIndex].pCell;
-		--nCount;
-		memmove( &pItems[nIndex], &pItems[nIndex + 1], (nCount - nIndex) * sizeof(ColEntry) );
-
-		SvtBroadcaster* pBC = pCell->GetBroadcaster();
-		if (pBC)
-		{
-			MoveListeners( *pBC, nOldRow );		// Broadcaster bleibt an alter Stelle
-			pCell->SetBroadcaster(NULL);
-		}
-
-		if (pCell->GetCellType() != CELLTYPE_NOTE)		// sonst geloescht
-		{
-			Insert(nNewRow, pCell);
-
-			long dy = (long)nNewRow - (long)nOldRow;
-			if (pCell->GetCellType() == CELLTYPE_FORMULA)
-			{
-				ScFormulaCell* pFormula = (ScFormulaCell*)pCell;
-				ScRange aRange( ScAddress( 0, nNewRow, nTab ),
-								ScAddress( MAXCOL, nNewRow, nTab ) );
-				pFormula->aPos.SetRow( nNewRow );
-				pFormula->UpdateReference(URM_MOVE, aRange, 0, -dy, 0);
-			}
-		}
-	}
-}
-
 //	SwapRow zum Sortieren
 
 void ScColumn::SwapRow(SCROW nRow1, SCROW nRow2)
Index: sc/source/core/data/column2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/column2.cxx,v
retrieving revision 1.32
retrieving revision 1.32.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.32 -r1.32.32.4
--- sc/source/core/data/column2.cxx	10 Apr 2008 19:20:05 -0000	1.32
+++ sc/source/core/data/column2.cxx	13 May 2008 14:34:08 -0000	1.32.32.4
@@ -100,561 +100,92 @@
 
 // -----------------------------------------------------------------------------------------
 
-// special handling for non-convertable characters is no longer needed
-#if 0
-
-//	read string from a string cell in original CharSet
-
-String lcl_ReadOriginalStringCell( SvStream& rStream, USHORT nVer, CharSet eSystemCharSet )
-{
-	if( nVer >= SC_DATABYTES2 )
-	{
-		BYTE cData;
-		rStream >> cData;
-		if( cData & 0x0F )
-			rStream.SeekRel( cData & 0x0F );
-	}
-
-	CharSet eOld = rStream.GetStreamCharSet();
-	rStream.SetStreamCharSet( eSystemCharSet );		// no conversion
-
-	String aString;
-	rStream >> aString;
-
-	rStream.SetStreamCharSet( eOld );
-
-	return aString;
-}
-
-#endif
+//UNUSED2008-05  SCROW ScColumn::NoteCount( SCROW nMaxRow ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      SCROW nNoteCount = 0;
+//UNUSED2008-05      SCSIZE i;
+//UNUSED2008-05  
+//UNUSED2008-05      for (i=0; i<nCount; i++)
+//UNUSED2008-05          if ( pItems[i].pCell->GetNotePtr() && pItems[i].nRow<=nMaxRow )
+//UNUSED2008-05              ++nNoteCount;
+//UNUSED2008-05  
+//UNUSED2008-05      return nNoteCount;
+//UNUSED2008-05  }
 
 // -----------------------------------------------------------------------------------------
 
-void ScColumn::LoadData( SvStream& rStream )
-{
-    SCSIZE      nNewCount = 0;
-    SCROW       nNewRow = 0;
-	BYTE		nByte;
-	USHORT		nVer = (USHORT) pDocument->GetSrcVersion();
-
-	ScMultipleReadHeader aHdr( rStream );
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream >> nNewCount;
-#endif
-	if ( nNewCount > static_cast<SCSIZE>(MAXROW+1) )						// wuerde das Array zu gross?
-	{
-		pDocument->SetLostData();
-		rStream.SetError( SVSTREAM_FILEFORMAT_ERROR );
-		return;
-	}
-
-	Resize( nNewCount );							// veraendert nCount nicht
-	for (SCSIZE i=0; i<nNewCount; i++)
-	{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-		rStream >> nNewRow;
-#endif
-		rStream >> nByte;
-
-		if ( nNewRow > MAXROW )					// Zeilennummer zu gross?
-		{
-			pDocument->SetLostData();
-			rStream.SetError( SVSTREAM_FILEFORMAT_ERROR );
-			return;
-		}
-
-		switch ((CellType) nByte)
-		{
-			case CELLTYPE_VALUE:
-				{
-					ScValueCell* pCell = new ScValueCell( rStream, nVer );
-					Append( nNewRow, pCell );
-				}
-				break;
-			case CELLTYPE_STRING:
-				{
-					ScStringCell* pCell = new ScStringCell( rStream, nVer );
-					Append( nNewRow, pCell );
-				}
-				break;
-			case CELLTYPE_SYMBOLS:
-				{
-                    CharSet eOld = rStream.GetStreamCharSet();
-                    //  convert into true symbol characters
-                    rStream.SetStreamCharSet( RTL_TEXTENCODING_SYMBOL );
-					ScStringCell* pCell = new ScStringCell( rStream, nVer );
-					Append( nNewRow, pCell );
-                    rStream.SetStreamCharSet( eOld );
-                    ScSymbolStringCellEntry * pEntry = new ScSymbolStringCellEntry;
-                    pEntry->pCell = pCell;
-                    pEntry->nRow = nNewRow;
-                    pDocument->GetLoadedSymbolStringCellsList().Insert(
-                        pEntry, LIST_APPEND );
-				}
-				break;
-			case CELLTYPE_EDIT:
-				{
-					ScEditCell* pCell = new ScEditCell( rStream, nVer, pDocument );
-					Append( nNewRow, pCell );
-				}
-				break;
-			case CELLTYPE_FORMULA:
-				{
-                    DBG_ERRORFILE( "REMOVED_BINFILTER");
-				}
-				break;
-			case CELLTYPE_NOTE:
-				{
-					ScNoteCell *pCell = new ScNoteCell( rStream, nVer );
-					Append( nNewRow, pCell);
-				}
-				break;
-			default:
-				DBG_ERROR( "Falscher Zellentyp" );
-				rStream.SetError( SVSTREAM_FILEFORMAT_ERROR );
-				return;
-		}
-	}
-}
-
-BOOL lcl_RemoveAny( ScDocument* pDocument, SCCOL nCol, SCTAB nTab )
-{
-	ScDBCollection* pDBColl = pDocument->GetDBCollection();
-	if ( pDBColl )
-	{
-		USHORT nCount = pDBColl->GetCount();
-		for (USHORT i=0; i<nCount; i++)
-		{
-			ScDBData* pData = (*pDBColl)[i];
-			if ( pData->IsStripData() &&
-					pData->HasImportParam() && !pData->HasImportSelection() )
-			{
-				ScRange aDBRange;
-				pData->GetArea(aDBRange);
-				if ( nTab == aDBRange.aStart.Tab() &&
-					 nCol >= aDBRange.aStart.Col() && nCol <= aDBRange.aEnd.Col() )
-					return TRUE;
-			}
-		}
-	}
-
-	return FALSE;
-}
-
-BOOL lcl_RemoveThis( ScDocument* pDocument, SCCOL nCol, SCROW nRow, SCTAB nTab )
-{
-	ScDBCollection* pDBColl = pDocument->GetDBCollection();
-	if ( pDBColl )
-	{
-		USHORT nCount = pDBColl->GetCount();
-		for (USHORT i=0; i<nCount; i++)
-		{
-			ScDBData* pData = (*pDBColl)[i];
-			if ( pData->IsStripData() &&
-					pData->HasImportParam() && !pData->HasImportSelection() )
-			{
-				ScRange aDBRange;
-				pData->GetArea(aDBRange);
-				if ( nTab == aDBRange.aStart.Tab() &&
-					 nCol >= aDBRange.aStart.Col() && nCol <= aDBRange.aEnd.Col() &&
-					 nRow >= aDBRange.aStart.Row() && nRow <= aDBRange.aEnd.Row() )
-					return TRUE;
-			}
-		}
-	}
-
-	return FALSE;
-}
-
-void ScColumn::SaveData( SvStream& rStream ) const
-{
-	CellType eCellType;
-	ScBaseCell* pCell;
-	SCSIZE i;
-    ScFontToSubsFontConverter_AutoPtr xFontConverter;
-    const ULONG nFontConverterFlags = FONTTOSUBSFONT_EXPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
-
-	ScMultipleWriteHeader aHdr( rStream );
-
-	SCSIZE nSaveCount = nCount;
-
-	//	Zeilen hinter MAXROW abziehen
-	SCROW nSaveMaxRow = pDocument->GetSrcMaxRow();
-	if ( nSaveMaxRow != MAXROW )
-	{
-		if ( nSaveCount && pItems[nSaveCount-1].nRow > nSaveMaxRow )
-		{
-			pDocument->SetLostData();			// Warnung ausgeben
-			do
-				--nSaveCount;
-			while ( nSaveCount && pItems[nSaveCount-1].nRow > nSaveMaxRow );
-		}
-	}
-
-	//	Zellen abziehen, die wegen Import nicht gespeichert werden
-	BOOL bRemoveAny = lcl_RemoveAny( pDocument, nCol, nTab );
-	SCSIZE nEffCount = nSaveCount;
-	if ( bRemoveAny )
-	{
-		for (i=0; i<nSaveCount; i++)
-			if ( lcl_RemoveThis( pDocument, nCol, pItems[i].nRow, nTab ) )
-				--nEffCount;
-
-//		String aDbg("Tab ");aDbg+=nTab;aDbg+=" Col ";aDbg+=nCol;
-//		aDbg+=" Remove ";aDbg+=nSaveCount-nEffCount; DBG_ERROR(aDbg);
-	}
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << nEffCount;			// nEffCount: Zellen, die wirklich gespeichert werden
-#endif
-
-	ScAttrIterator aIter( pAttrArray, 0, MAXROW );
-	SCROW nStt = 0, nEnd = 0;
-	const ScPatternAttr* pAttr;
-	do
-	{
-		pAttr = aIter.Next( nStt, nEnd );
-	}
-    while( pAttr && !(
-        (xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags ))
-        || pAttr->IsSymbolFont()) );
-
-	for (i=0; i<nSaveCount; i++)		// nSaveCount: Ende auf MAXROW angepasst
-	{
-		SCROW nRow = pItems[i].nRow;
-
-		if ( !bRemoveAny || !lcl_RemoveThis( pDocument, nCol, nRow, nTab ) )
-		{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-			rStream << nRow;
-#endif
-
-			pCell = pItems[i].pCell;
-			eCellType = pCell->GetCellType();
-
-			switch( eCellType )
-			{
-				case CELLTYPE_VALUE:
-					rStream << (BYTE) eCellType;
-					((ScValueCell*)pCell)->Save( rStream );
-					break;
-				case CELLTYPE_STRING:
-					if( pAttr )
-					{
-						if( nRow > nEnd )
-                        {
-                            do
-                            {
-                                do
-                                {
-                                    pAttr = aIter.Next( nStt, nEnd );
-                                }
-                                while ( pAttr && nRow > nEnd );     // #99139# skip all formats before this cell
-                            }
-                            while( pAttr && !(
-                                (xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags ))
-                                || pAttr->IsSymbolFont()) );
-                        }
-						if( pAttr && nRow >= nStt && nRow <= nEnd )
-							eCellType = CELLTYPE_SYMBOLS;
-					}
-					rStream << (BYTE) eCellType;
-					if ( eCellType == CELLTYPE_SYMBOLS )
-					{
-						//	cell string contains true symbol characters
-                        CharSet eOld = rStream.GetStreamCharSet();
-                        rStream.SetStreamCharSet( RTL_TEXTENCODING_SYMBOL );
-                        ((ScStringCell*)pCell)->Save( rStream, xFontConverter );
-                        rStream.SetStreamCharSet( eOld );
-					}
-					else
-						((ScStringCell*)pCell)->Save( rStream );
-					break;
-				case CELLTYPE_EDIT:
-					rStream << (BYTE) eCellType;
-					((ScEditCell*)pCell)->Save( rStream );
-					break;
-				case CELLTYPE_FORMULA:
-                    DBG_ERRORFILE( "REMOVED_BINFILTER");
-					break;
-				case CELLTYPE_NOTE:
-					rStream << (BYTE) eCellType;
-					((ScNoteCell*)pCell)->Save( rStream );
-					break;
-				default:
-					{
-						//	#53846# soll zwar nicht vorkommen, aber falls doch,
-						//	eine leere NoteCell speichern, damit das Dokument
-						//	ueberhaupt wieder geladen werden kann.
-						rStream << (BYTE) CELLTYPE_NOTE;
-						ScNoteCell aDummyCell;
-						aDummyCell.Save( rStream );
-						DBG_ERROR( "Falscher Zellentyp" );
-					}
-					break;
-			}
-		}
-	}
-}
-
-// -----------------------------------------------------------------------------------------
-
-void ScColumn::LoadNotes( SvStream& rStream )
-{
-	ScReadHeader aHdr(rStream);
-
-    SCSIZE nNoteCount = 0;
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream >> nNoteCount;
-#endif
-	for (SCSIZE i=0; i<nNoteCount && rStream.GetError() == SVSTREAM_OK; i++)
-	{
-        SCSIZE nPos = 0;
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-		rStream >> nPos;
-#endif
-		if (nPos < nCount)
-			pItems[nPos].pCell->LoadNote(rStream, pDocument);
-		else
-		{
-			DBG_ERROR("falsche Pos in ScColumn::LoadNotes");
-			rStream.SetError( SVSTREAM_FILEFORMAT_ERROR );
-		}
-	}
-}
-
-SCROW ScColumn::NoteCount( SCROW nMaxRow ) const
-{
-	SCROW nNoteCount = 0;
-	SCSIZE i;
-
-	for (i=0; i<nCount; i++)
-		if ( pItems[i].pCell->GetNotePtr() && pItems[i].nRow<=nMaxRow )
-			++nNoteCount;
-
-	return nNoteCount;
-}
-
-void ScColumn::SaveNotes( SvStream& rStream ) const
-{
-	SCROW nSaveMaxRow = pDocument->GetSrcMaxRow();
-	SCSIZE i;
-
-	BOOL bRemoveAny = lcl_RemoveAny( pDocument, nCol, nTab );
-	SCROW nNoteCount;
-	if ( bRemoveAny )
-	{
-		//	vorher zaehlen, wieviele Notizen es werden
-
-		nNoteCount = 0;
-		for (i=0; i<nCount; i++)
-			if ( pItems[i].pCell->GetNotePtr() && pItems[i].nRow<=nSaveMaxRow &&
-					!lcl_RemoveThis( pDocument, nCol, pItems[i].nRow, nTab ) )
-				++nNoteCount;
-	}
-	else
-		nNoteCount = NoteCount(nSaveMaxRow);
-
-	//	Speichern
-	//	Als Positionen muessen die Indizes gespeichert werden, die beim Laden entstehen,
-	//	also ohne die weggelassenen Zellen mitzuzaehlen.
-
-	ScWriteHeader aHdr(rStream);
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << nNoteCount;
-#endif
-
-	USHORT nDestPos = 0;
-	for (i=0; i<nCount && rStream.GetError() == SVSTREAM_OK; i++)
-	{
-		SCROW nRow = pItems[i].nRow;
-		if ( !bRemoveAny || !lcl_RemoveThis( pDocument, nCol, nRow, nTab ) )
-		{
-			const ScPostIt* pNote = pItems[i].pCell->GetNotePtr();
-			if ( pNote && nRow <= nSaveMaxRow )
-			{
-				rStream << nDestPos;
-				rStream << *pNote;
-			}
-			++nDestPos;			// nDestPos zaehlt die in SaveData gespeicherten Zellen
-		}
-	}
-
-	//	SetLostData ist schon in SaveData passiert, wenn noetig
-}
-
-// -----------------------------------------------------------------------------------------
-
-void ScColumn::CorrectSymbolCells( CharSet eStreamCharSet )
-{
-    //  #99139# find and correct string cells that are formatted with a symbol font,
-    //  but are not in the LoadedSymbolStringCellsList
-    //  (because CELLTYPE_SYMBOLS wasn't written in the file)
-
-    ScFontToSubsFontConverter_AutoPtr xFontConverter;
-    const ULONG nFontConverterFlags = FONTTOSUBSFONT_EXPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
-
-    BOOL bListInitialized = FALSE;
-    ScSymbolStringCellEntry* pCurrentEntry = NULL;
-
-    ScAttrIterator aAttrIter( pAttrArray, 0, MAXROW );
-    SCROW nStt, nEnd;
-    const ScPatternAttr* pAttr = aAttrIter.Next( nStt, nEnd );
-    while ( pAttr )
-    {
-        if ( (xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags )) ||
-                pAttr->IsSymbolFont() )
-        {
-            ScColumnIterator aCellIter( this, nStt, nEnd );
-            SCROW nRow;
-            ScBaseCell* pCell;
-            while ( aCellIter.Next( nRow, pCell ) )
-            {
-                if ( pCell->GetCellType() == CELLTYPE_STRING )
-                {
-                    List& rList = pDocument->GetLoadedSymbolStringCellsList();
-                    if (!bListInitialized)
-                    {
-                        pCurrentEntry = (ScSymbolStringCellEntry*)rList.First();
-                        bListInitialized = TRUE;
-                    }
-
-                    while ( pCurrentEntry && pCurrentEntry->nRow < nRow )
-                        pCurrentEntry = (ScSymbolStringCellEntry*)rList.Next();
-
-                    if ( pCurrentEntry && pCurrentEntry->nRow == nRow )
-                    {
-                        //  found
-                    }
-                    else
-                    {
-                        //  not in list -> convert and put into list
-
-                        ScStringCell* pStrCell = (ScStringCell*)pCell;
-                        String aOldStr;
-                        pStrCell->GetString( aOldStr );
-
-                        //  convert back to stream character set (get original data)
-                        ByteString aByteStr( aOldStr, eStreamCharSet );
-
-                        //  convert using symbol encoding, as for CELLTYPE_SYMBOLS cells
-                        String aNewStr( aByteStr, RTL_TEXTENCODING_SYMBOL );
-                        pStrCell->SetString( aNewStr );
-
-                        ScSymbolStringCellEntry * pEntry = new ScSymbolStringCellEntry;
-                        pEntry->pCell = pStrCell;
-                        pEntry->nRow = nRow;
-
-                        if ( pCurrentEntry )
-                            rList.Insert( pEntry );     // before current entry - pCurrentEntry stays valid
-                        else
-                            rList.Insert( pEntry, LIST_APPEND );    // append if already behind last entry
-                    }
-                }
-            }
-        }
-
-        pAttr = aAttrIter.Next( nStt, nEnd );
-    }
-}
-
-BOOL ScColumn::Load( SvStream& rStream, ScMultipleReadHeader& rHdr )
-{
-	rHdr.StartEntry();
-	while (rHdr.BytesLeft() && rStream.GetError() == SVSTREAM_OK)
-	{
-		USHORT nID;
-		rStream >> nID;
-		switch (nID)
-		{
-			case SCID_COLDATA:
-				LoadData( rStream );
-				break;
-			case SCID_COLNOTES:
-				LoadNotes( rStream );
-				break;
-			case SCID_COLATTRIB:
-				pAttrArray->Load( rStream );
-				break;
-			default:
-				{
-					DBG_ERROR("unbekannter Sub-Record in ScColumn::Load");
-					ScReadHeader aDummyHeader( rStream );
-				}
-		}
-	}
-	rHdr.EndEntry();
-
-    //  #99139# old versions didn't always write CELLTYPE_SYMBOLS for symbol string cells,
-    //  so we have to look for remaining string cells in areas that are formatted with
-    //  symbol font:
-    CorrectSymbolCells( rStream.GetStreamCharSet() );
-
-    if ( pDocument->SymbolStringCellsPending() )
-    {
-        ScFontToSubsFontConverter_AutoPtr xFontConverter;
-        const ULONG nFontConverterFlags = FONTTOSUBSFONT_IMPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
-        ScSymbolStringCellEntry* pE;
-        SCROW nStt, nEnd = 0;
-
-        ScAttrIterator aIter( pAttrArray, 0, MAXROW );
-        const ScPatternAttr* pAttr = aIter.Next( nStt, nEnd );
-        xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags );
-
-        List& rList = pDocument->GetLoadedSymbolStringCellsList();
-        for ( pE = (ScSymbolStringCellEntry*) rList.First(); pE;
-                pE = (ScSymbolStringCellEntry*) rList.Next() )
-        {
-            const ScPatternAttr* pLastAttr = pAttr;
-            while ( nEnd < pE->nRow )
-            {
-                pAttr = aIter.Next( nStt, nEnd );
-            }
-            if ( pAttr != pLastAttr )
-                xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags );
-            pE->pCell->ConvertFont( xFontConverter );
-            delete pE;
-        }
-        rList.Clear();
-    }
-    pAttrArray->ConvertFontsAfterLoad();
-
-	return TRUE;
-}
-
-BOOL ScColumn::Save( SvStream& rStream, ScMultipleWriteHeader& rHdr ) const
-{
-	rHdr.StartEntry();
-
-	if (!IsEmptyData())				//!	Test, ob alles weggelassen wird?
-	{
-		rStream << (USHORT) SCID_COLDATA;
-		SaveData( rStream );
-	}
-	SCROW nNotes = NoteCount();	//!	Test, ob alles weggelassen wird?
-	if (nNotes > 0)
-	{
-		rStream << (USHORT) SCID_COLNOTES;
-		SaveNotes( rStream );
-	}
-	if (!IsEmptyAttr())
-	{
-		rStream << (USHORT) SCID_COLATTRIB;
-		pAttrArray->Save( rStream );
-	}
-
-	rHdr.EndEntry();
-
-	return TRUE;
-}
+//UNUSED2008-05  void ScColumn::CorrectSymbolCells( CharSet eStreamCharSet )
+//UNUSED2008-05  {
+//UNUSED2008-05      //  #99139# find and correct string cells that are formatted with a symbol font,
+//UNUSED2008-05      //  but are not in the LoadedSymbolStringCellsList
+//UNUSED2008-05      //  (because CELLTYPE_SYMBOLS wasn't written in the file)
+//UNUSED2008-05  
+//UNUSED2008-05      ScFontToSubsFontConverter_AutoPtr xFontConverter;
+//UNUSED2008-05      const ULONG nFontConverterFlags = FONTTOSUBSFONT_EXPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
+//UNUSED2008-05  
+//UNUSED2008-05      BOOL bListInitialized = FALSE;
+//UNUSED2008-05      ScSymbolStringCellEntry* pCurrentEntry = NULL;
+//UNUSED2008-05  
+//UNUSED2008-05      ScAttrIterator aAttrIter( pAttrArray, 0, MAXROW );
+//UNUSED2008-05      SCROW nStt, nEnd;
+//UNUSED2008-05      const ScPatternAttr* pAttr = aAttrIter.Next( nStt, nEnd );
+//UNUSED2008-05      while ( pAttr )
+//UNUSED2008-05      {
+//UNUSED2008-05          if ( (xFontConverter = pAttr->GetSubsFontConverter( nFontConverterFlags )) ||
+//UNUSED2008-05                  pAttr->IsSymbolFont() )
+//UNUSED2008-05          {
+//UNUSED2008-05              ScColumnIterator aCellIter( this, nStt, nEnd );
+//UNUSED2008-05              SCROW nRow;
+//UNUSED2008-05              ScBaseCell* pCell;
+//UNUSED2008-05              while ( aCellIter.Next( nRow, pCell ) )
+//UNUSED2008-05              {
+//UNUSED2008-05                  if ( pCell->GetCellType() == CELLTYPE_STRING )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      List& rList = pDocument->GetLoadedSymbolStringCellsList();
+//UNUSED2008-05                      if (!bListInitialized)
+//UNUSED2008-05                      {
+//UNUSED2008-05                          pCurrentEntry = (ScSymbolStringCellEntry*)rList.First();
+//UNUSED2008-05                          bListInitialized = TRUE;
+//UNUSED2008-05                      }
+//UNUSED2008-05  
+//UNUSED2008-05                      while ( pCurrentEntry && pCurrentEntry->nRow < nRow )
+//UNUSED2008-05                          pCurrentEntry = (ScSymbolStringCellEntry*)rList.Next();
+//UNUSED2008-05  
+//UNUSED2008-05                      if ( pCurrentEntry && pCurrentEntry->nRow == nRow )
+//UNUSED2008-05                      {
+//UNUSED2008-05                          //  found
+//UNUSED2008-05                      }
+//UNUSED2008-05                      else
+//UNUSED2008-05                      {
+//UNUSED2008-05                          //  not in list -> convert and put into list
+//UNUSED2008-05  
+//UNUSED2008-05                          ScStringCell* pStrCell = (ScStringCell*)pCell;
+//UNUSED2008-05                          String aOldStr;
+//UNUSED2008-05                          pStrCell->GetString( aOldStr );
+//UNUSED2008-05  
+//UNUSED2008-05                          //  convert back to stream character set (get original data)
+//UNUSED2008-05                          ByteString aByteStr( aOldStr, eStreamCharSet );
+//UNUSED2008-05  
+//UNUSED2008-05                          //  convert using symbol encoding, as for CELLTYPE_SYMBOLS cells
+//UNUSED2008-05                          String aNewStr( aByteStr, RTL_TEXTENCODING_SYMBOL );
+//UNUSED2008-05                          pStrCell->SetString( aNewStr );
+//UNUSED2008-05  
+//UNUSED2008-05                          ScSymbolStringCellEntry * pEntry = new ScSymbolStringCellEntry;
+//UNUSED2008-05                          pEntry->pCell = pStrCell;
+//UNUSED2008-05                          pEntry->nRow = nRow;
+//UNUSED2008-05  
+//UNUSED2008-05                          if ( pCurrentEntry )
+//UNUSED2008-05                              rList.Insert( pEntry );     // before current entry - pCurrentEntry stays valid
+//UNUSED2008-05                          else
+//UNUSED2008-05                              rList.Insert( pEntry, LIST_APPEND );    // append if already behind last entry
+//UNUSED2008-05                      }
+//UNUSED2008-05                  }
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05  
+//UNUSED2008-05          pAttr = aAttrIter.Next( nStt, nEnd );
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 // -----------------------------------------------------------------------------------------
 
@@ -1990,30 +1521,6 @@
 
 }
 
-SCROW ScColumn::GetFirstEntryPos() const
-{
-	if (pAttrArray)
-		return Min( GetFirstDataPos(), pAttrArray->GetFirstEntryPos() );
-	else
-		return GetFirstDataPos();
-}
-
-SCROW ScColumn::GetLastEntryPos() const
-{
-	if (pAttrArray)
-		return Max( GetLastDataPos(), pAttrArray->GetLastEntryPos(TRUE) );
-	else
-		return GetLastDataPos();
-}
-
-SCROW ScColumn::GetLastAttrPos() const
-{
-	if (pAttrArray)
-		return pAttrArray->GetLastEntryPos(FALSE);
-	else
-		return 0;
-}
-
 BOOL ScColumn::IsAllAttrEqual( const ScColumn& rCol, SCROW nStartRow, SCROW nEndRow ) const
 {
 	if (pAttrArray && rCol.pAttrArray)
Index: sc/source/core/data/compressedarray.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/compressedarray.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/source/core/data/compressedarray.cxx	10 Apr 2008 19:20:48 -0000	1.10
+++ sc/source/core/data/compressedarray.cxx	9 May 2008 04:45:55 -0000	1.10.32.1
@@ -365,27 +365,6 @@
 }
 
 
-template< typename A, typename D >
-void ScCompressedArray<A,D>::FillDataArray( A nStart, A nEnd, D * pArray ) const
-{
-    size_t nUsed = 0;
-    size_t nIndex = Search( nStart);
-    A nS = ::std::max( (nIndex>0 ? pData[nIndex-1].nEnd+1 : 0), nStart);
-    do
-    {
-        A nE = ::std::min( pData[nIndex].nEnd, nEnd);
-        while (nS <= nE)
-        {
-            pArray[nUsed++] = pData[nIndex].aValue;
-            ++nS;
-        }
-        if (pData[nIndex].nEnd >= nEnd)
-            break;  // while
-        ++nIndex;
-    } while (nIndex < nCount);
-}
-
-
 // === ScSummableCompressedArray ============================================= 
 
 template< typename A, typename D >
Index: sc/source/core/data/conditio.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/conditio.cxx,v
retrieving revision 1.25
retrieving revision 1.25.30.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.30.4
--- sc/source/core/data/conditio.cxx	10 Apr 2008 19:21:09 -0000	1.25
+++ sc/source/core/data/conditio.cxx	13 May 2008 14:34:08 -0000	1.25.30.4
@@ -292,128 +292,6 @@
 	delete pFormula2;
 }
 
-ScConditionEntry::ScConditionEntry( SvStream& /* rStream */, ScMultipleReadHeader& /* rHdr */,
-									ScDocument* pDocument ) :
-	nVal1(0.0),
-	nVal2(0.0),
-	bIsStr1(FALSE),
-	bIsStr2(FALSE),
-	pFormula1(NULL),
-	pFormula2(NULL),
-	pFCell1(NULL),
-	pFCell2(NULL),
-	pDoc(pDocument),
-	bRelRef1(FALSE),
-	bRelRef2(FALSE),
-	bFirstRun(TRUE)
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	USHORT nVer = (USHORT) pDoc->GetSrcVersion();
-
-	rHdr.StartEntry();
-
-	BYTE nOpByte;
-	rStream >> nOpByte;
-	eOp = (ScConditionMode) nOpByte;
-
-	rStream >> nOptions;
-
-	ScAddress aPos;
-	BYTE nTypeByte;
-	rStream >> nTypeByte;
-	ScConditionValType eType = (ScConditionValType) nTypeByte;
-	if ( eType == SC_VAL_FORMULA )
-	{
-		rStream >> aPos;
-		pFormula1 = new ScTokenArray;
-		pFormula1->Load( rStream, nVer, aPos );
-		bRelRef1 = lcl_HasRelRef( pDoc, pFormula1 );
-	}
-	else if ( eType == SC_VAL_VALUE )
-		rStream >> nVal1;
-	else
-	{
-		bIsStr1 = TRUE;
-		rStream.ReadByteString( aStrVal1, rStream.GetStreamCharSet() );
-	}
-
-	if ( eOp == SC_COND_BETWEEN || eOp == SC_COND_NOTBETWEEN )
-	{
-		rStream >> nTypeByte;
-		eType = (ScConditionValType) nTypeByte;
-		if ( eType == SC_VAL_FORMULA )
-		{
-			rStream >> aPos;
-			pFormula2 = new ScTokenArray;
-			pFormula2->Load( rStream, nVer, aPos );
-			bRelRef2 = lcl_HasRelRef( pDoc, pFormula2 );
-		}
-		else if ( eType == SC_VAL_VALUE )
-			rStream >> nVal2;
-		else
-		{
-			bIsStr2 = TRUE;
-			rStream.ReadByteString( aStrVal2, rStream.GetStreamCharSet() );
-		}
-	}
-
-	rHdr.EndEntry();
-
-	aSrcPos = aPos;
-
-	//	Formelzellen werden erst bei IsValid angelegt
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-void ScConditionEntry::StoreCondition(SvStream& /* rStream */, ScMultipleWriteHeader& /* rHdr */) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rHdr.StartEntry();
-
-	//	1) Byte fuer die Operation
-	//	2) USHORT fuer Optionen
-	//	3) Byte, ob Wert, String oder Formel folgt
-	//	4) double, String oder TokenArray
-	//	5) je nach Operation 3 und 4 nochmal
-	//	vor jedem TokenArray noch die Position als ScAddress
-
-	rStream << (BYTE) eOp;
-	rStream << nOptions;
-
-	ScConditionValType eType =
-			pFormula1 ? SC_VAL_FORMULA : ( bIsStr1 ? SC_VAL_STRING : SC_VAL_VALUE );
-	rStream << (BYTE) eType;
-	if ( eType == SC_VAL_FORMULA )
-	{
-		rStream << aSrcPos;
-		pFormula1->Store( rStream, aSrcPos );
-	}
-	else if ( eType == SC_VAL_VALUE )
-		rStream << nVal1;
-	else
-		rStream.WriteByteString( aStrVal1, rStream.GetStreamCharSet() );
-
-	if ( eOp == SC_COND_BETWEEN || eOp == SC_COND_NOTBETWEEN )
-	{
-		eType = pFormula2 ? SC_VAL_FORMULA : ( bIsStr2 ? SC_VAL_STRING : SC_VAL_VALUE );
-		rStream << (BYTE) eType;
-		if ( eType == SC_VAL_FORMULA )
-		{
-			rStream << aSrcPos;
-			pFormula2->Store( rStream, aSrcPos );
-		}
-		else if ( eType == SC_VAL_VALUE )
-			rStream << nVal2;
-		else
-			rStream.WriteByteString( aStrVal2, rStream.GetStreamCharSet() );
-	}
-
-	rHdr.EndEntry();
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
 void ScConditionEntry::Compile( const String& rExpr1, const String& rExpr2,
 								const ScGrammar::Grammar eGrammar, BOOL bTextToReal )
 {
@@ -1262,30 +1140,6 @@
 {
 }
 
-ScCondFormatEntry::ScCondFormatEntry( SvStream& rStream, ScMultipleReadHeader& rHdr,
-										ScDocument* pDocument ) :
-	ScConditionEntry( rStream, rHdr, pDocument ),
-	pParent( NULL )
-{
-	//	im Datei-Header sind getrennte Eintraege fuer ScConditionEntry und ScCondFormatEntry
-
-	rHdr.StartEntry();
-	rStream.ReadByteString( aStyleName, rStream.GetStreamCharSet() );
-	rHdr.EndEntry();
-}
-
-void ScCondFormatEntry::Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const
-{
-	//	im Datei-Header sind getrennte Eintraege fuer ScConditionEntry und ScCondFormatEntry
-
-	StoreCondition( rStream, rHdr );
-
-	rHdr.StartEntry();
-	rStream.WriteByteString( aStyleName, rStream.GetStreamCharSet() );
-	rHdr.EndEntry();
-}
-
-
 int ScCondFormatEntry::operator== ( const ScCondFormatEntry& r ) const
 {
 	return ScConditionEntry::operator==( r ) &&
@@ -1357,54 +1211,6 @@
 	return pNew;
 }
 
-ScConditionalFormat::ScConditionalFormat(SvStream& rStream, ScMultipleReadHeader& rHdr,
-											ScDocument* pDocument) :
-	pDoc( pDocument ),
-	pAreas( NULL ),
-	ppEntries( NULL ),
-	nEntryCount( 0 )
-{
-	//	ein Eintrag im Header fuer die ScConditionalFormat-Daten,
-	//	je zwei Eintraege fuer jede Bedingung (ScConditionEntry und ScCondFormatEntry)
-
-	rHdr.StartEntry();
-
-	rStream >> nKey;
-	rStream >> nEntryCount;
-
-	rHdr.EndEntry();
-
-		//	Eintraege laden
-
-	if (nEntryCount)
-	{
-		ppEntries = new ScCondFormatEntry*[nEntryCount];
-		for (USHORT i=0; i<nEntryCount; i++)
-		{
-			ppEntries[i] = new ScCondFormatEntry(rStream, rHdr, pDocument);
-			ppEntries[i]->SetParent(this);
-		}
-	}
-}
-
-void ScConditionalFormat::Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const
-{
-	//	ein Eintrag im Header fuer die ScConditionalFormat-Daten,
-	//	je zwei Eintraege fuer jede Bedingung (ScConditionEntry und ScCondFormatEntry)
-
-	rHdr.StartEntry();
-
-	rStream << nKey;
-	rStream << nEntryCount;
-
-	rHdr.EndEntry();
-
-		//	Eintraege speichern
-
-	for (USHORT i=0; i<nEntryCount; i++)
-		ppEntries[i]->Store(rStream, rHdr);
-}
-
 BOOL ScConditionalFormat::EqualEntries( const ScConditionalFormat& r ) const
 {
 	if ( nEntryCount != r.nEntryCount )
@@ -1685,41 +1491,6 @@
 	return bEqual;
 }
 
-void ScConditionalFormatList::Load( SvStream& rStream, ScDocument* pDocument )
-{
-	ScMultipleReadHeader aHdr( rStream );
-
-	USHORT nNewCount;
-	rStream >> nNewCount;
-
-	for (USHORT i=0; i<nNewCount; i++)
-	{
-		ScConditionalFormat* pNew = new ScConditionalFormat( rStream, aHdr, pDocument );
-		InsertNew( pNew );
-	}
-}
-
-void ScConditionalFormatList::Store( SvStream& rStream ) const
-{
-	USHORT i;
-	ScMultipleWriteHeader aHdr( rStream );
-
-	USHORT nCount = Count();
-	USHORT nUsed = 0;
-	for (i=0; i<nCount; i++)
-		if ((*this)[i]->IsUsed())
-			++nUsed;
-
-	rStream << nUsed;		// Anzahl der gespeicherten
-
-	for (i=0; i<nCount; i++)
-	{
-		const ScConditionalFormat* pForm = (*this)[i];
-		if (pForm->IsUsed())
-			pForm->Store( rStream, aHdr );
-	}
-}
-
 ScConditionalFormat* ScConditionalFormatList::GetFormat( sal_uInt32 nKey )
 {
 	//!	binaer suchen
@@ -1733,12 +1504,12 @@
 	return NULL;
 }
 
-void ScConditionalFormatList::ResetUsed()
-{
-	USHORT nCount = Count();
-	for (USHORT i=0; i<nCount; i++)
-		(*this)[i]->SetUsed(FALSE);
-}
+//UNUSED2008-05  void ScConditionalFormatList::ResetUsed()
+//UNUSED2008-05  {
+//UNUSED2008-05      USHORT nCount = Count();
+//UNUSED2008-05      for (USHORT i=0; i<nCount; i++)
+//UNUSED2008-05          (*this)[i]->SetUsed(FALSE);
+//UNUSED2008-05  }
 
 void ScConditionalFormatList::CompileAll()
 {
Index: sc/source/core/data/dociter.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dociter.cxx,v
retrieving revision 1.21
retrieving revision 1.21.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.32.2
--- sc/source/core/data/dociter.cxx	10 Apr 2008 19:21:46 -0000	1.21
+++ sc/source/core/data/dociter.cxx	12 May 2008 15:56:56 -0000	1.21.32.2
@@ -221,46 +221,46 @@
 	}
 }
 
-ScValueIterator::ScValueIterator( ScDocument* pDocument,
-									SCCOL nSCol, SCROW nSRow, SCTAB nSTab,
-									SCCOL nECol, SCROW nERow, SCTAB nETab,
-									BOOL bSTotal, BOOL bTextZero ) :
-	pDoc( pDocument ),
-	nNumFmtIndex(0),
-	nStartCol( nSCol),
-	nStartRow( nSRow),
-	nStartTab( nSTab ),
-	nEndCol( nECol ),
-	nEndRow( nERow),
-	nEndTab( nETab ),
-	nNumFmtType( NUMBERFORMAT_UNDEFINED ),
-	bNumValid( FALSE ),
-	bSubTotal(bSTotal),
-	bNextValid( FALSE ),
-	bCalcAsShown( pDocument->GetDocOptions().IsCalcAsShown() ),
-	bTextAsZero( bTextZero )
-{
-	PutInOrder( nStartCol, nEndCol);
-	PutInOrder( nStartRow, nEndRow);
-	PutInOrder( nStartTab, nEndTab );
-
-	if (!ValidCol(nStartCol)) nStartCol = MAXCOL;
-	if (!ValidCol(nEndCol)) nEndCol = MAXCOL;
-	if (!ValidRow(nStartRow)) nStartRow = MAXROW;
-	if (!ValidRow(nEndRow)) nEndRow = MAXROW;
-	if (!ValidTab(nStartTab)) nStartTab = MAXTAB;
-	if (!ValidTab(nEndTab)) nEndTab = MAXTAB;
-
-	nCol = nStartCol;
-	nRow = nStartRow;
-	nTab = nStartTab;
-
-	nColRow = 0;					// wird bei GetFirst initialisiert
-
-	nNumFormat = 0;					// werden bei GetNumberFormat initialisiert
-	pAttrArray = 0;
-	nAttrEndRow = 0;
-}
+//UNUSED2008-05  ScValueIterator::ScValueIterator( ScDocument* pDocument,
+//UNUSED2008-05                                    SCCOL nSCol, SCROW nSRow, SCTAB nSTab,
+//UNUSED2008-05                                    SCCOL nECol, SCROW nERow, SCTAB nETab,
+//UNUSED2008-05                                    BOOL bSTotal, BOOL bTextZero ) :
+//UNUSED2008-05  pDoc( pDocument ),
+//UNUSED2008-05  nNumFmtIndex(0),
+//UNUSED2008-05  nStartCol( nSCol),
+//UNUSED2008-05  nStartRow( nSRow),
+//UNUSED2008-05  nStartTab( nSTab ),
+//UNUSED2008-05  nEndCol( nECol ),
+//UNUSED2008-05  nEndRow( nERow),
+//UNUSED2008-05  nEndTab( nETab ),
+//UNUSED2008-05  nNumFmtType( NUMBERFORMAT_UNDEFINED ),
+//UNUSED2008-05  bNumValid( FALSE ),
+//UNUSED2008-05  bSubTotal(bSTotal),
+//UNUSED2008-05  bNextValid( FALSE ),
+//UNUSED2008-05  bCalcAsShown( pDocument->GetDocOptions().IsCalcAsShown() ),
+//UNUSED2008-05  bTextAsZero( bTextZero )
+//UNUSED2008-05  {
+//UNUSED2008-05      PutInOrder( nStartCol, nEndCol);
+//UNUSED2008-05      PutInOrder( nStartRow, nEndRow);
+//UNUSED2008-05      PutInOrder( nStartTab, nEndTab );
+//UNUSED2008-05  
+//UNUSED2008-05      if (!ValidCol(nStartCol)) nStartCol = MAXCOL;
+//UNUSED2008-05      if (!ValidCol(nEndCol)) nEndCol = MAXCOL;
+//UNUSED2008-05      if (!ValidRow(nStartRow)) nStartRow = MAXROW;
+//UNUSED2008-05      if (!ValidRow(nEndRow)) nEndRow = MAXROW;
+//UNUSED2008-05      if (!ValidTab(nStartTab)) nStartTab = MAXTAB;
+//UNUSED2008-05      if (!ValidTab(nEndTab)) nEndTab = MAXTAB;
+//UNUSED2008-05  
+//UNUSED2008-05      nCol = nStartCol;
+//UNUSED2008-05      nRow = nStartRow;
+//UNUSED2008-05      nTab = nStartTab;
+//UNUSED2008-05  
+//UNUSED2008-05      nColRow = 0;                    // wird bei GetFirst initialisiert
+//UNUSED2008-05  
+//UNUSED2008-05      nNumFormat = 0;                 // werden bei GetNumberFormat initialisiert
+//UNUSED2008-05      pAttrArray = 0;
+//UNUSED2008-05      nAttrEndRow = 0;
+//UNUSED2008-05  }
 
 ScValueIterator::ScValueIterator( ScDocument* pDocument, const ScRange& rRange,
 			BOOL bSTotal, BOOL bTextZero ) :
Index: sc/source/core/data/docpool.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/docpool.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.1
--- sc/source/core/data/docpool.cxx	10 Apr 2008 19:22:06 -0000	1.25
+++ sc/source/core/data/docpool.cxx	8 May 2008 21:46:14 -0000	1.25.32.1
@@ -613,19 +613,6 @@
 	}
 }
 
-void ScDocumentPool::MyLoadCompleted()
-{
-	LoadCompleted();
-
-	USHORT nCount = GetItemCount(ATTR_PATTERN);
-	for (USHORT i=0; i<nCount; i++)
-	{
-		const SfxPoolItem* pItem = GetItem(ATTR_PATTERN, i);
-		if (pItem)
-			CheckRef(*pItem);
-	}
-}
-
 // ----------------------------------------------------------------------------------------
 
 void ScDocumentPool::StyleDeleted( ScStyleSheet* pStyle )
Index: sc/source/core/data/documen2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen2.cxx,v
retrieving revision 1.72
retrieving revision 1.72.28.5
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.72 -r1.72.28.5
--- sc/source/core/data/documen2.cxx	10 Apr 2008 19:22:32 -0000	1.72
+++ sc/source/core/data/documen2.cxx	13 May 2008 14:34:08 -0000	1.72.28.5
@@ -142,7 +142,6 @@
 		pDocOptions( NULL ),
 		pExtDocOptions( NULL ),
 		pConsolidateDlgData( NULL ),
-        pLoadedSymbolStringCellList( NULL ),
         pRecursionHelper( NULL ),
         pAutoNameCache( NULL ),
         pLookupCacheMapImpl( NULL ),
@@ -183,7 +182,6 @@
 		bInLinkUpdate( FALSE ),
 		bChartListenerCollectionNeedsUpdate( FALSE ),
 		bHasForcedFormulas( FALSE ),
-		bLostData(FALSE),
 		bInDtorClear( FALSE ),
 		bExpandRefs( FALSE ),
 		bDetectiveDirty( FALSE ),
@@ -234,7 +232,9 @@
 
 	pRangeName = new ScRangeName( 4, 4, FALSE, this );
 	pDBCollection = new ScDBCollection( 4, 4, FALSE, this );
+#if OLD_PIVOT_IMPLEMENTATION
 	pPivotCollection = new ScPivotCollection(4, 4, this );
+#endif
 	pSelectionAttr = NULL;
 	pChartCollection = new ScChartCollection;
     apTemporaryChartLock = std::auto_ptr< ScTemporaryChartLock >( new ScTemporaryChartLock(this) );
@@ -401,7 +401,9 @@
 	}
 	delete pRangeName;
 	delete pDBCollection;
+#if OLD_PIVOT_IMPLEMENTATION
 	delete pPivotCollection;
+#endif
 	delete pSelectionAttr;
     apTemporaryChartLock.reset();
 	delete pChartCollection;
@@ -574,632 +576,6 @@
 	}
 }
 
-void lcl_RefreshPivotData( ScPivotCollection* pColl )
-{
-	USHORT nCount = pColl->GetCount();
-	for (USHORT i=0; i<nCount; i++)
-	{
-		ScPivot* pPivot = (*pColl)[i];
-		if (pPivot->CreateData(TRUE))
-			pPivot->ReleaseData();
-	}
-}
-
-
-BOOL ScDocument::SymbolStringCellsPending() const
-{
-    return pLoadedSymbolStringCellList && pLoadedSymbolStringCellList->Count();
-}
-
-
-List& ScDocument::GetLoadedSymbolStringCellsList()
-{
-    if ( !pLoadedSymbolStringCellList )
-        pLoadedSymbolStringCellList = new List;
-    return *pLoadedSymbolStringCellList;
-}
-
-
-BOOL ScDocument::Load( SvStream& rStream, ScProgress* pProgress )
-{
-	bLoadingDone = FALSE;
-
-	//----------------------------------------------------
-
-	Clear();
-	USHORT nOldBufSize = rStream.GetBufferSize();
-	rStream.SetBufferSize( 32768 );
-
-		//	Progress-Bar
-
-//	ULONG nCurPos = rStream.Tell();
-//	ULONG nEndPos = rStream.Seek( STREAM_SEEK_TO_END );
-//	rStream.Seek( nCurPos );
-//	ScProgress aProgress( NULL, ScGlobal::GetRscString(STR_LOAD_DOC), nEndPos - nCurPos );
-
-	BOOL bError = FALSE;
-	USHORT nVersion = 0;
-	SCROW nVerMaxRow = MAXROW_30;		// 8191, wenn in der Datei nichts steht
-	SCTAB nTab = 0;
-	USHORT nEnumDummy;
-	String aEmptyName;
-	String aPageStyle;
-	CharSet eOldSet = rStream.GetStreamCharSet();
-
-	USHORT nID;
-	rStream >> nID;
-	if (nID == SCID_DOCUMENT || nID == SCID_NEWDOCUMENT )
-	{
-		ScReadHeader aHdr( rStream );
-		while (aHdr.BytesLeft() && !bError )
-		{
-			USHORT nSubID;
-			rStream >> nSubID;
-			switch (nSubID)
-			{
-				case SCID_DOCFLAGS:
-					{
-						ScReadHeader aFlagsHdr( rStream );
-
-						rStream >> nVersion;				// 312 abwaerts
-						rStream.ReadByteString( aPageStyle, rStream.GetStreamCharSet() );
-						rStream >> bProtected;				// Dokument geschuetzt
-						String aPass;
-						rStream.ReadByteString( aPass, rStream.GetStreamCharSet() );
-						if (aPass.Len())
-							SvPasswordHelper::GetHashPassword(aProtectPass, aPass);
-						if ( aFlagsHdr.BytesLeft() )
-						{
-							rStream >> nEnumDummy;
-							eLanguage = LanguageType( nEnumDummy );
-						}
-						if ( aFlagsHdr.BytesLeft() )
-							rStream >> bAutoCalc;
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-						if ( aFlagsHdr.BytesLeft() )
-							rStream >> nVisibleTab;
-#endif
-						if ( aFlagsHdr.BytesLeft() )
-							rStream >> nVersion;			// echte Version
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-						if ( aFlagsHdr.BytesLeft() )
-							rStream >> nVerMaxRow;			// sonst auf 8191 lassen
-#endif
-
-						nSrcVer		= nVersion;				// Member
-						nSrcMaxRow	= nVerMaxRow;			// Member
-
-						// Fuer Debugging bis hin zur SC 3.0a:
-						if( nVersion > 0x0002 && nVersion < SC_NUMFMT )
-						{
-							bError = TRUE;
-							rStream.SetError( SVSTREAM_WRONGVERSION );
-						}
-
-						// Das obere Byte muss kleiner oder gleich sein
-						//	(3.1 Dateien mit 8192 Zeilen koennen noch gelesen werden)
-
-						if( ( nSrcVer & 0xFF00 ) > ( SC_CURRENT_VERSION & 0xFF00 ) )
-						{
-							bError = TRUE;
-							rStream.SetError( SVSTREAM_WRONGVERSION );
-						}
-					}
-					break;
-				case SCID_CHARSET:
-					{
-						ScReadHeader aSetHdr( rStream );
-						BYTE cSet, cGUI;	// cGUI is dummy, old GUIType
-						rStream >> cGUI >> cSet;
-						eSrcSet = (CharSet) cSet;
-                        rStream.SetStreamCharSet( ::GetSOLoadTextEncoding(
-                            eSrcSet, (USHORT)rStream.GetVersion() ) );
-					}
-					break;
-				case SCID_LINKUPMODE: //	Link Update Mode
-					{
-						ScReadHeader aSetHdr( rStream );
-						BYTE cSet;
-						rStream >> cSet;
-						eLinkMode=(ScLkUpdMode) cSet;
-					}
-					break;
-				case SCID_TABLE:
-					pTab[nTab] = new ScTable(this, nTab, aEmptyName);
-					pTab[nTab]->SetPageStyle( aPageStyle );
-					pTab[nTab]->Load(rStream,nVersion,pProgress);
-					++nTab;
-					break;
-				case SCID_DRAWING:
-					DBG_ERROR("ScDocument::LoadDrawLayer() no longer supported, binary loading removed (!)");
-					break;
-				case SCID_DDELINKS:
-					LoadDdeLinks(rStream);
-					break;
-				case SCID_AREALINKS:
-					LoadAreaLinks(rStream);
-					break;
-				case SCID_RANGENAME:
-                    DBG_ERRORFILE( "REMOVED_BINFILTER SCID_RANGENAME");
-					break;
-				case SCID_DBAREAS:
-					pDBCollection->Load( rStream );
-					break;
-				case SCID_DATAPILOT:
-					GetDPCollection()->LoadNew( rStream );
-					break;
-				case SCID_PIVOT:
-					pPivotCollection->Load( rStream );
-					break;
-				case SCID_CHARTS:
-					pChartCollection->Load( this, rStream );
-					break;
-				case SCID_COLNAMERANGES:
-					xColNameRanges->Load( rStream, nVersion );
-					break;
-				case SCID_ROWNAMERANGES:
-					xRowNameRanges->Load( rStream, nVersion );
-					break;
-				case SCID_CONDFORMATS:
-					if (!pCondFormList)
-						pCondFormList = new ScConditionalFormatList;
-					pCondFormList->Load( rStream, this );
-					break;
-				case SCID_VALIDATION:
-					if (!pValidationList)
-						pValidationList = new ScValidationDataList;
-					pValidationList->Load( rStream, this );
-					break;
-				case SCID_DETOPLIST:
-					if (!pDetOpList)
-						pDetOpList = new ScDetOpList;
-					pDetOpList->Load( rStream );
-					break;
-				case SCID_NUMFORMAT:
-					{
-						ScReadHeader aNumHeader(rStream);
-						xPoolHelper->GetFormTable()->Load(rStream);
-					}
-					break;
-				case SCID_DOCOPTIONS:
-					ImplLoadDocOptions(rStream);
-					break;
-				case SCID_VIEWOPTIONS:
-					ImplLoadViewOptions(rStream);
-					break;
-				case SCID_PRINTSETUP:
-					{
-						ScReadHeader aJobHeader(rStream);
-						SfxItemSet* pSet = new SfxItemSet( *xPoolHelper->GetDocPool(),
-								SID_PRINTER_NOTFOUND_WARN, SID_PRINTER_NOTFOUND_WARN,
-								SID_PRINTER_CHANGESTODOC,  SID_PRINTER_CHANGESTODOC,
-								SID_SCPRINTOPTIONS,        SID_SCPRINTOPTIONS,
-								NULL );
-						SetPrinter( SfxPrinter::Create( rStream, pSet ) );
-					}
-					break;
-				case SCID_CONSOLIDATA:
-					if (!pConsolidateDlgData)
-						pConsolidateDlgData = new ScConsolidateParam;
-					pConsolidateDlgData->Load( rStream );
-					break;
-				case SCID_CHANGETRACK:
-					if ( pChangeTrack )
-						pChangeTrack->Clear();	// es kann nur einen geben
-					else
-						StartChangeTracking();
-					pChangeTrack->Load( rStream, nVersion );
-					break;
-				case SCID_CHGVIEWSET:
-					if (!pChangeViewSettings)
-						pChangeViewSettings = new ScChangeViewSettings;
-					pChangeViewSettings->Load( rStream, nVersion );
-					break;
-				default:
-					{
-						DBG_ERROR("unbekannter Sub-Record in ScDocument::Load");
-						ScReadHeader aDummyHdr( rStream );
-					}
-			}
-
-			if (rStream.GetError() != SVSTREAM_OK)
-				bError = TRUE;
-		}
-	}
-	else
-	{
-		//	Assertion nur, wenn kein Passwort gesetzt ist
-		DBG_ASSERT( rStream.GetKey().Len(), "Load: SCID_DOCUMENT nicht gefunden" );
-		bError = TRUE;
-	}
-
-	rStream.SetStreamCharSet( eOldSet );
-	rStream.SetBufferSize( nOldBufSize );
-
-	if (!bError)									// Neuberechnungen
-	{
-		xPoolHelper->GetStylePool()->UpdateStdNames();	// falls mit Version in anderer Sprache gespeichert
-
-		//	Zahlformat-Sprache
-		//	(kann nicht in LoadPool passieren, weil der Numberformatter geladen sein muss)
-
-		ScDocumentPool* pPool = xPoolHelper->GetDocPool();
-		if ( pPool->GetLoadingVersion() == 0 )				// 0 = Pool-Version bis 3.1
-		{
-			//	in 3.1-Dokumenten gibt es ATTR_LANGUAGE_FORMAT noch nicht
-			//	darum bei Bedarf zu ATTR_VALUE_FORMAT noch die Sprache dazutun
-			//	(Bug #37441#)
-
-			//	harte Attribute:
-
-			SvNumberFormatter* pFormatter = xPoolHelper->GetFormTable();
-			USHORT nCount = pPool->GetItemCount(ATTR_PATTERN);
-			ScPatternAttr* pPattern;
-			for (USHORT i=0; i<nCount; i++)
-			{
-				pPattern = (ScPatternAttr*)pPool->GetItem(ATTR_PATTERN, i);
-				if (pPattern)
-                    ScGlobal::AddLanguage( pPattern->GetItemSet(), *pFormatter );
-			}
-
-			//	Vorlagen:
-
-			SfxStyleSheetIterator aIter( xPoolHelper->GetStylePool(), SFX_STYLE_FAMILY_PARA );
-			for ( SfxStyleSheetBase* pStyle = aIter.First(); pStyle; pStyle = aIter.Next() )
-                ScGlobal::AddLanguage( pStyle->GetItemSet(), *pFormatter );
-		}
-
-        // change FontItems in styles
-        xPoolHelper->GetStylePool()->ConvertFontsAfterLoad();
-
-		//	Druckbereiche etc.
-
-		SfxStyleSheetIterator	aIter( xPoolHelper->GetStylePool(), SFX_STYLE_FAMILY_PAGE );
-		ScStyleSheet*			pStyleSheet = NULL;
-
-		nMaxTableNumber = 0;
-		for (SCTAB i=0; i<=MAXTAB; i++)
-			if (pTab[i])
-			{
-				// MaxTableNumber ermitteln
-
-				nMaxTableNumber = i+1;
-
-				// Druckbereiche aus <= 3.00.2 Dokumenten
-				// aus den PageStyles holen und jetzt an
-				// der Tabelle speichern.
-
-				pStyleSheet = (ScStyleSheet*)aIter.Find( pTab[i]->GetPageStyle() );
-
-				if ( pStyleSheet )
-				{
-					SfxItemSet&			rSet			= pStyleSheet->GetItemSet();
-					const ScRangeItem*	pPrintAreaItem	= NULL;
-					const ScRangeItem*	pRepeatColItem	= NULL;
-					const ScRangeItem*	pRepeatRowItem	= NULL;
-
-					rSet.GetItemState( ATTR_PAGE_PRINTAREA, TRUE,
-									   (const SfxPoolItem**)&pPrintAreaItem );
-					rSet.GetItemState( ATTR_PAGE_REPEATCOL, TRUE,
-									   (const SfxPoolItem**)&pRepeatColItem );
-					rSet.GetItemState( ATTR_PAGE_REPEATROW, TRUE,
-									   (const SfxPoolItem**)&pRepeatRowItem );
-
-					if ( pPrintAreaItem ) // Druckbereiche
-					{
-						if ( !pPrintAreaItem->GetFlags() )
-                            SetPrintRange( i, pPrintAreaItem->GetRange() );
-						rSet.ClearItem( ATTR_PAGE_PRINTAREA );
-					}
-
-					if ( pRepeatColItem ) // Wiederholungsspalte
-					{
-						SetRepeatColRange( i, !pRepeatColItem->GetFlags()
-											? &pRepeatColItem->GetRange()
-											: (const ScRange *)NULL );
-						rSet.ClearItem( ATTR_PAGE_REPEATCOL );
-					}
-
-					if ( pRepeatRowItem ) // Wiederholungszeile
-					{
-						SetRepeatRowRange( i, !pRepeatRowItem->GetFlags()
-											? &pRepeatRowItem->GetRange()
-											: (const ScRange *)NULL );
-						rSet.ClearItem( ATTR_PAGE_REPEATROW );
-					}
-				}
-			}
-
-
-		if ( pDPCollection && pDPCollection->GetCount() )
-			pPivotCollection->FreeAll();
-		else
-		{
-			lcl_RefreshPivotData( pPivotCollection );
-			GetDPCollection()->ConvertOldTables( *pPivotCollection );
-		}
-		if ( pDPCollection )
-			pDPCollection->EnsureNames();	// make sure every table has a name
-
-		SetAutoFilterFlags();
-		if (pDrawLayer)
-			UpdateAllCharts();
-#ifndef PRODUCT
-//2do: wg. #62107
-// ChartListenerCollection speichern/laden, damit nach dem Laden das Update
-// hier einmal eingespart werden kann und somit nicht mehr alle Charts
-// angefasst werden muessen. Die ChartListenerCollection muss dann zum Master
-// der Referenzen werden.
-//		static BOOL bShown = 0;
-//		if ( !bShown && SOFFICE_FILEFORMAT_NOW > SOFFICE_FILEFORMAT_50 )
-//		{
-//			bShown = 1;
-//			DBG_ERRORFILE( "bei inkompatiblem FileFormat ChartListenerCollection speichern!" );
-//		}
-#endif
-		UpdateChartListenerCollection();
-		if (pDrawLayer)
-			RefreshNoteFlags();
-		CalcAfterLoad();
-	}
-
-    if ( pLoadedSymbolStringCellList )
-    {   // we had symbol string cells, list was cleared by columns, delete it
-        delete pLoadedSymbolStringCellList;
-        pLoadedSymbolStringCellList = NULL;
-    }
-
-	//----------------------------------------------------
-
-	bLoadingDone = TRUE;
-
-	return !bError;
-}
-
-BOOL ScDocument::Save( SvStream& rStream, ScProgress* pProgress ) const
-{
-	((ScDocument*)this)->bLoadingDone = FALSE;		// nicht zwischendrin reinpfuschen lassen
-
-	((ScDocument*)this)->bLostData = FALSE;			// wird beim Speichern gesetzt
-
-	((ScDocument*)this)->nSrcVer = SC_CURRENT_VERSION;
-	((ScDocument*)this)->nSrcMaxRow = MAXROW;
-	if ( rStream.GetVersion() <= SOFFICE_FILEFORMAT_31 )
-	{
-		//	3.1 Export -> nur 8192 Zeilen schreiben, und kompatible Versionsnummer
-
-		((ScDocument*)this)->nSrcVer = SC_31_EXPORT_VER;
-		((ScDocument*)this)->nSrcMaxRow = MAXROW_30;
-	}
-	else if ( rStream.GetVersion() <= SOFFICE_FILEFORMAT_40 )
-	{	//	4.0 Export -> kompatible Versionsnummer
-		((ScDocument*)this)->nSrcVer = SC_40_EXPORT_VER;
-	}
-
-	USHORT nOldBufSize = rStream.GetBufferSize();
-	rStream.SetBufferSize( 32768 );
-
-	CharSet eOldSet = rStream.GetStreamCharSet();
-    CharSet eStoreCharSet = ::GetSOStoreTextEncoding(
-        gsl_getSystemTextEncoding(), (USHORT)rStream.GetVersion() );
-    rStream.SetStreamCharSet( eStoreCharSet );
-
-
-		//	Progress-Bar
-
-	long nSavedDocCells = 0;
-//	ScProgress aProgress( NULL, ScGlobal::GetRscString( STR_SAVE_DOC ), GetWeightedCount() + 1 );
-
-	{
-		rStream << (USHORT) SCID_NEWDOCUMENT;
-		ScWriteHeader aHdr( rStream );
-
-		//	Flags
-
-		{
-			rStream << (USHORT) SCID_DOCFLAGS;
-			ScWriteHeader aFlagsHdr( rStream, 18 );			//! ausprobieren
-
-			// wg. Bug in 312 ScToken::RelToRelAbs mit DoubleRefs bekommt
-			// die 312er immer vorgegaukelt, dass es keine RelRefs gaebe,
-			// was auch ok ist, da immer absolut gespeichert wird und
-			// SR_RELATIVE nie zur Verwendung kam und nicht kommen darf.
-			if ( nSrcVer & 0xFF00 )
-				rStream << (USHORT) nSrcVer;
-				// hoehere Major-Version darf von 312 nicht geladen werden
-			else
-				rStream << (USHORT) (SC_RELATIVE_REFS - 1);
-
-			// dummy page style (for compatibility)
-			rStream.WriteByteString(
-						String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM(STRING_STANDARD)),
-						rStream.GetStreamCharSet() );
-			rStream << bProtected;					// Dokument geschuetzt
-			String aPass;
-			//rStream.WriteByteString( aProtectPass, rStream.GetStreamCharSet() );
-			rStream.WriteByteString( aPass, rStream.GetStreamCharSet() );
-			rStream << (USHORT)	eLanguage;
-			rStream << bAutoCalc;
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-			rStream << nVisibleTab;
-#endif
-
-			// und hier jetzt die echte Versionsnummer
-			rStream << (USHORT) nSrcVer;
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-			rStream << nSrcMaxRow;					// Zeilenanzahl
-#endif
-		}
-
-		//	Zeichensatz
-
-		{
-			rStream << (USHORT) SCID_CHARSET;
-			ScWriteHeader aSetHdr( rStream, 2 );
-			rStream << (BYTE) 0		// dummy, old System::GetGUIType()
-                    << (BYTE) eStoreCharSet;
-		}
-
-		//	Link Update Mode
-
-		if(eLinkMode!=LM_UNKNOWN)
-		{
-			rStream << (USHORT) SCID_LINKUPMODE;
-			ScWriteHeader aSetHdr( rStream, 1 );
-			rStream << (BYTE) eLinkMode;
-		}
-
-        DBG_ERRORFILE( "REMOVED_BINFILTER SCID_RANGENAME");
-
-		rStream << (USHORT) SCID_DBAREAS;
-		pDBCollection->Store( rStream );
-
-		rStream << (USHORT) SCID_DDELINKS;
-		SaveDdeLinks( rStream );
-
-		rStream << (USHORT) SCID_AREALINKS;
-		SaveAreaLinks( rStream );
-
-		{
-			rStream << (USHORT) SCID_NUMFORMAT;
-			ScWriteHeader aNumHeader(rStream);
-			xPoolHelper->GetFormTable()->Save(rStream);
-		}
-
-		if ( xColNameRanges->Count() )
-		{
-			rStream << (USHORT) SCID_COLNAMERANGES;
-			xColNameRanges->Store( rStream );
-		}
-		if ( xRowNameRanges->Count() )
-		{
-			rStream << (USHORT) SCID_ROWNAMERANGES;
-			xRowNameRanges->Store( rStream );
-		}
-
-		if (pCondFormList)
-			pCondFormList->ResetUsed();		// wird beim Speichern der Tabellen gesetzt
-		if (pValidationList)
-			pValidationList->ResetUsed();	// wird beim Speichern der Tabellen gesetzt
-
-		//	Tabellen (Daten)
-
-		for (SCTAB i=0; i<=MAXTAB; i++)
-		{
-			if (pTab[i])
-			{
-				rStream << (USHORT) SCID_TABLE;
-				pTab[i]->Save(rStream, nSavedDocCells, pProgress);
-			}
-		}
-
-		//	bedingte Formate / Gueltigkeit
-		//	beim Speichern der Tabellen ist eingetragen worden,
-		//	welche Eintraege benutzt werden
-
-		if (pCondFormList)
-		{
-			rStream << (USHORT) SCID_CONDFORMATS;
-			pCondFormList->Store(rStream);
-		}
-		if (pValidationList)
-		{
-			rStream << (USHORT) SCID_VALIDATION;
-			pValidationList->Store(rStream);
-		}
-
-		//	Liste der Detektiv-Operationen (zum Aktualisieren)
-		if (pDetOpList)
-		{
-			rStream << (USHORT) SCID_DETOPLIST;
-			pDetOpList->Store(rStream);
-		}
-
-		//	Drawing
-		if (pDrawLayer)
-		{
-			DBG_ERROR("ScDocument::StoreDrawLayer() no longer supported, binary saving removed (!)");
-		}
-
-		//	Collections
-
-		//	(new) DataPilot collection must be saved before old Pivot collection
-		//	so old data can be skipped by new office
-		//	not in 3.0 or 4.0 export to avoid warning messages
-
-		if ( nSrcVer > SC_40_EXPORT_VER && pDPCollection && pDPCollection->GetCount() )
-		{
-			rStream << (USHORT) SCID_DATAPILOT;				// new data
-			pDPCollection->StoreNew( rStream );
-		}
-
-		rStream << (USHORT) SCID_PIVOT;						// old data
-		if ( pDPCollection && pDPCollection->GetCount() )
-			pDPCollection->StoreOld( rStream );
-		else
-			pPivotCollection->Store( rStream );				// not converted or all empty
-
-				//	Charts werden hier nicht mehr gespeichert, weil
-				//	jedes Chart seine Daten selber speichert
-
-		DBG_ASSERT(!pChartCollection || !pChartCollection->GetCount(),
-						"wer hat da ein Chart eingetragen?");
-
-		rStream << (USHORT) SCID_DOCOPTIONS;
-		ImplSaveDocOptions(rStream);
-
-		rStream << (USHORT) SCID_VIEWOPTIONS;
-		ImplSaveViewOptions(rStream);
-
-		//	Job-Setup vom Printer
-
-		if (pPrinter)
-		{
-			rStream << (USHORT) SCID_PRINTSETUP;
-			ScWriteHeader aJobHeader(rStream);
-
-			((ScDocument*)this)->GetPrinter()->Store( rStream );
-		}
-
-		if ( nSrcVer > SC_40_EXPORT_VER )	//	Das folgende nicht bei 3.0 oder 4.0 Export...
-		{
-			if (pConsolidateDlgData)		//	Einstellungen fuer den Konsolidieren-Dialog
-			{
-				rStream << (USHORT) SCID_CONSOLIDATA;
-				pConsolidateDlgData->Store( rStream );
-			}
-			if ( pChangeTrack )
-			{
-				rStream << (USHORT) SCID_CHANGETRACK;
-				pChangeTrack->Store( rStream );
-			}
-			if ( pChangeViewSettings )
-			{
-				rStream << (USHORT) SCID_CHGVIEWSET;
-				pChangeViewSettings->Store( rStream );
-			}
-		}
-	}
-
-	rStream.SetStreamCharSet( eOldSet );
-	rStream.SetBufferSize( nOldBufSize );
-
-	((ScDocument*)this)->bLoadingDone = TRUE;
-
-	return ( rStream.GetError() == SVSTREAM_OK );
-}
-
-void ScDocument::SetLostData()
-{
-	bLostData = TRUE;
-}
-
 void ScDocument::DeleteNumberFormat( const sal_uInt32* /* pDelKeys */, sal_uInt32 /* nCount */ )
 {
 /*
@@ -1363,9 +739,11 @@
 				pDBCollection->UpdateMoveTab( nOldPos, nNewPos );
 				xColNameRanges->UpdateReference( URM_REORDER, this, aSourceRange, 0,0,nDz );
 				xRowNameRanges->UpdateReference( URM_REORDER, this, aSourceRange, 0,0,nDz );
+#if OLD_PIVOT_IMPLEMENTATION
 				if (pPivotCollection)
 					pPivotCollection->UpdateReference( URM_REORDER,
 									0,0,nOldPos, MAXCOL,MAXROW,nOldPos, 0,0,nDz );
+#endif
 				if (pDPCollection)
 					pDPCollection->UpdateReference( URM_REORDER, aSourceRange, 0,0,nDz );
 				if (pDetOpList)
@@ -1456,9 +834,11 @@
 				pRangeName->UpdateTabRef(nNewPos, 1);
 				pDBCollection->UpdateReference(
 									URM_INSDEL, 0,0,nNewPos, MAXCOL,MAXROW,MAXTAB, 0,0,1 );
+#if OLD_PIVOT_IMPLEMENTATION
 				if (pPivotCollection)
 					pPivotCollection->UpdateReference(
 									URM_INSDEL, 0,0,nNewPos, MAXCOL,MAXROW,MAXTAB, 0,0,1 );
+#endif
 				if (pDPCollection)
 					pDPCollection->UpdateReference( URM_INSDEL, aRange, 0,0,1 );
 				if (pDetOpList)
@@ -1553,7 +933,6 @@
 		if (VALIDTAB(nDestPos) && pTab[nDestPos])
 		{
 			pTab[nDestPos]->DeleteArea( 0,0, MAXCOL,MAXROW, IDF_ALL );
-//			ClearDrawPage(nDestPos);
 		}
 		else
 			bValid = FALSE;
Index: sc/source/core/data/documen3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen3.cxx,v
retrieving revision 1.41
retrieving revision 1.41.28.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.41 -r1.41.28.3
--- sc/source/core/data/documen3.cxx	10 Apr 2008 19:22:46 -0000	1.41
+++ sc/source/core/data/documen3.cxx	13 May 2008 14:34:08 -0000	1.41.28.3
@@ -95,14 +95,14 @@
 	pRangeName = pNewRangeName;
 }
 
-ScRangeData* ScDocument::GetRangeAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab,
-											BOOL bStartOnly) const
-{
-	if ( pRangeName )
-		return pRangeName->GetRangeAtCursor( ScAddress( nCol, nRow, nTab ), bStartOnly );
-	else
-		return NULL;
-}
+//UNUSED2008-05  ScRangeData* ScDocument::GetRangeAtCursor(SCCOL nCol, SCROW nRow, SCTAB nTab,
+//UNUSED2008-05                                              BOOL bStartOnly) const
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( pRangeName )
+//UNUSED2008-05          return pRangeName->GetRangeAtCursor( ScAddress( nCol, nRow, nTab ), bStartOnly );
+//UNUSED2008-05      else
+//UNUSED2008-05          return NULL;
+//UNUSED2008-05  }
 
 ScRangeData* ScDocument::GetRangeAtBlock( const ScRange& rBlock, String* pName ) const
 {
@@ -225,6 +225,7 @@
     return NULL;
 }
 
+#if OLD_PIVOT_IMPLEMENTATION
 ScPivotCollection* ScDocument::GetPivotCollection() const
 {
 	return pPivotCollection;
@@ -262,19 +263,13 @@
 	else
 		return NULL;
 }
+#endif
 
 ScChartCollection* ScDocument::GetChartCollection() const
 {
 	return pChartCollection;
 }
 
-void ScDocument::SetChartCollection(ScChartCollection* pNewChartCollection)
-{
-	if (pChartCollection)
-		delete pChartCollection;
-	pChartCollection = pNewChartCollection;
-}
-
 void ScDocument::StopTemporaryChartLock()
 {
     if( apTemporaryChartLock.get() )
@@ -826,8 +821,10 @@
 			xRowNameRanges->UpdateReference( eUpdateRefMode, this, aRange, nDx, nDy, nDz );
 			pDBCollection->UpdateReference( eUpdateRefMode, nCol1, nRow1, nTab1, nCol2, nRow2, nTab2, nDx, nDy, nDz );
 			pRangeName->UpdateReference( eUpdateRefMode, aRange, nDx, nDy, nDz );
+#if OLD_PIVOT_IMPLEMENTATION
 			if (pPivotCollection)
 				pPivotCollection->UpdateReference( eUpdateRefMode, nCol1, nRow1, nTab1, nCol2, nRow2, nTab2, nDx, nDy, nDz );
+#endif
 			if ( pDPCollection )
 				pDPCollection->UpdateReference( eUpdateRefMode, aRange, nDx, nDy, nDz );
 			UpdateChartRef( eUpdateRefMode, nCol1, nRow1, nTab1, nCol2, nRow2, nTab2, nDx, nDy, nDz );
@@ -917,7 +914,9 @@
 	//!	UpdateChartRef
 
 	pRangeName->UpdateGrow( rArea, nGrowX, nGrowY );
+#if OLD_PIVOT_IMPLEMENTATION
 	pPivotCollection->UpdateGrow( rArea, nGrowX, nGrowY );
+#endif
 
 	for (SCTAB i=0; i<=MAXTAB && pTab[i]; i++)
 		pTab[i]->UpdateGrow( rArea, nGrowX, nGrowY );
Index: sc/source/core/data/documen4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen4.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.1
--- sc/source/core/data/documen4.cxx	10 Apr 2008 19:23:01 -0000	1.22
+++ sc/source/core/data/documen4.cxx	9 May 2008 16:11:46 -0000	1.22.32.1
@@ -288,14 +288,6 @@
                     pTab[i]->PutCell( j, k, aRefCell.Clone( this, ScAddress( j, k, i ) ) );
 }
 
-USHORT ScDocument::GetErrorData( SCCOL nCol, SCROW nRow, SCTAB nTab ) const
-{
-	if (ValidTab(nTab) && pTab[nTab])
-		return pTab[nTab]->GetErrorData( nCol, nRow );
-	else
-		return 0;
-}
-
 BOOL ScDocument::GetNextSpellingCell(SCCOL& nCol, SCROW& nRow, SCTAB nTab,
 						BOOL bInSel, const ScMarkData& rMark) const
 {
@@ -656,26 +648,6 @@
 	}
 }
 
-void ScDocument::SetConditionalUsed( ULONG nKey )	// aus dem Speichern der Tabellen
-{
-	if ( nKey && pCondFormList )		// nKey==0 -> noop
-	{
-		ScConditionalFormat* pForm = pCondFormList->GetFormat( nKey );
-		if (pForm)
-			pForm->SetUsed(TRUE);
-	}
-}
-
-void ScDocument::SetValidationUsed( ULONG nKey )	// aus dem Speichern der Tabellen
-{
-	if ( nKey && pValidationList )		// nKey==0 -> noop
-	{
-		ScValidationData* pData = pValidationList->GetData( nKey );
-		if (pData)
-			pData->SetUsed(TRUE);
-	}
-}
-
 void ScDocument::SetCondFormList(ScConditionalFormatList* pNew)
 {
 	if (pCondFormList)
Index: sc/source/core/data/documen8.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen8.cxx,v
retrieving revision 1.52
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.52 documen8.cxx
--- sc/source/core/data/documen8.cxx	10 Apr 2008 19:24:13 -0000	1.52
+++ sc/source/core/data/documen8.cxx	14 Jul 2008 16:27:43 -0000
@@ -103,55 +103,6 @@
 
 // STATIC DATA -----------------------------------------------------------
 
-
-
-//------------------------------------------------------------------------
-
-void ScDocument::ImplLoadDocOptions( SvStream& rStream )
-{
-	USHORT d,m,y;
-
-	DBG_ASSERT( pDocOptions, "No DocOptions to load! :-(" );
-
-	pDocOptions->Load( rStream );
-
-	if ( pDocOptions->GetStdPrecision() > 20 ) //!!! ist 20 als Maximum konstant ???
-	{
-		DBG_ERROR( "Document options corrupted. Setting to defaults." );
-		pDocOptions->ResetDocOptions();
-	}
-
-	pDocOptions->GetDate( d,m,y );
-	SvNumberFormatter* pFormatter = xPoolHelper->GetFormTable();
-	pFormatter->ChangeNullDate( d,m,y );
-	pFormatter->ChangeStandardPrec( pDocOptions->GetStdPrecision() );
-	pFormatter->SetYear2000( pDocOptions->GetYear2000() );
-}
-
-//------------------------------------------------------------------------
-
-void ScDocument::ImplLoadViewOptions( SvStream& rStream )
-{
-	DBG_ASSERT( pViewOptions, "No ViewOptions to load! :-(" );
-	rStream >> *pViewOptions;
-}
-
-//------------------------------------------------------------------------
-
-void ScDocument::ImplSaveDocOptions( SvStream& rStream ) const
-{
-	DBG_ASSERT( pDocOptions, "No DocOptions to save! :-(" );
-	pDocOptions->Save( rStream );
-}
-
-//------------------------------------------------------------------------
-
-void ScDocument::ImplSaveViewOptions( SvStream& rStream ) const
-{
-	DBG_ASSERT( pViewOptions, "No ViewOptions to save! :-(" );
-	rStream << *pViewOptions;
-}
-
 //------------------------------------------------------------------------
 
 void ScDocument::ImplCreateOptions()
@@ -175,6 +126,7 @@
 {
 	if ( !pPrinter && bCreateIfNotExist )
 	{
+        { char tmp[256]; sprintf(tmp, "ScDocument::GetPrinter:   creating a new printer instance...\n"); OutputDebugStringA(tmp); }
         SfxItemSet* pSet =
 			new SfxItemSet( *xPoolHelper->GetDocPool(),
                             SID_PRINTER_NOTFOUND_WARN,  SID_PRINTER_NOTFOUND_WARN,
@@ -187,6 +139,9 @@
 		if ( pOffCfg )
 		{
 			USHORT nFlags = 0;
+            { char tmp[256]; sprintf(tmp, "ScDocument::GetPrinter:   orientation warning (%d); paper size warning (%d)\n",
+                                     pOffCfg->IsPaperOrientationWarning(), pOffCfg->IsPaperSizeWarning()); OutputDebugStringA(tmp); }
+
             if ( pOffCfg->IsPaperOrientationWarning() )
 				nFlags |= SFX_PRINTER_CHG_ORIENTATION;
 			if ( pOffCfg->IsPaperSizeWarning() )
@@ -1442,93 +1397,6 @@
     }
 }
 
-void ScDocument::SaveAreaLinks(SvStream& /* rStream */) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	const ::sfx2::SvBaseLinks& rLinks = pLinkManager->GetLinks();
-	USHORT nCount = rLinks.Count();
-
-	//	erstmal zaehlen...
-
-	USHORT nAreaCount = 0;
-	USHORT i;
-	for (i=0; i<nCount; i++)
-		if ((*rLinks[i])->ISA(ScAreaLink))		// rLinks[i] = Pointer auf Ref
-			++nAreaCount;
-
-	//	Header
-
-	ScMultipleWriteHeader aHdr( rStream );
-	rStream << nAreaCount;
-
-	//	Links speichern
-
-	for (i=0; i<nCount; i++)
-	{
-		::sfx2::SvBaseLink* pBase = *rLinks[i];
-		if (pBase->ISA(ScAreaLink))
-		{
-			ScAreaLink* pLink = (ScAreaLink*)pBase;
-
-			aHdr.StartEntry();
-
-			rStream.WriteByteString( pLink->GetFile(), rStream.GetStreamCharSet() );
-			rStream.WriteByteString( pLink->GetFilter(), rStream.GetStreamCharSet() );
-			rStream.WriteByteString( pLink->GetSource(), rStream.GetStreamCharSet() );
-			rStream << pLink->GetDestArea();				// ScRange
-			rStream.WriteByteString( pLink->GetOptions(), rStream.GetStreamCharSet() );
-			//	filter options starting from 336
-
-			aHdr.EndEntry();
-		}
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-void ScDocument::LoadAreaLinks(SvStream& rStream)
-{
-	ScMultipleReadHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-
-	if (!pShell)
-	{
-		DBG_ERROR("AreaLinks koennen nicht ohne Shell geladen werden");
-		return;
-	}
-
-	String aFile, aFilter, aOptions, aSource;
-	ScRange aDestArea;
-
-	USHORT nCount;
-	rStream >> nCount;
-	for (USHORT i=0; i<nCount; i++)
-	{
-		aHdr.StartEntry();
-
-		rStream.ReadByteString( aFile,   rStream.GetStreamCharSet() );
-		rStream.ReadByteString( aFilter, rStream.GetStreamCharSet() );
-		rStream.ReadByteString( aSource, rStream.GetStreamCharSet() );
-		rStream >> aDestArea;
-		if ( aHdr.BytesLeft() )			// Filter-Optionen ab 336
-			rStream.ReadByteString( aOptions, rStream.GetStreamCharSet() );
-		else
-			aOptions.Erase();
-		aHdr.EndEntry();
-
-		ScAreaLink* pLink = new ScAreaLink( pShell, aFile, aFilter, aOptions,
-											aSource, aDestArea.aStart, 0 );
-		pLink->SetInCreate( TRUE );
-		pLink->SetDestArea( aDestArea );
-		pLinkManager->InsertFileLink( *pLink, OBJECT_CLIENT_FILE, aFile, &aFilter, &aSource );
-		pLink->Update();
-		pLink->SetInCreate( FALSE );
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
 //------------------------------------------------------------------------
 
 // TimerDelays etc.
@@ -1550,14 +1418,6 @@
 	return TRUE;
 }
 
-BOOL ScDocument::HasMacroCallsAfterLoad()
-{
-    //  not used any longer
-
-    DBG_ERROR("obsolete method HasMacroCallsAfterLoad called");
-    return FALSE;
-}
-
 //------------------------------------------------------------------------
 
 SfxBindings* ScDocument::GetViewBindings()
Index: sc/source/core/data/documen9.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen9.cxx,v
retrieving revision 1.42
retrieving revision 1.42.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.42 -r1.42.32.3
--- sc/source/core/data/documen9.cxx	10 Apr 2008 19:24:29 -0000	1.42
+++ sc/source/core/data/documen9.cxx	13 May 2008 14:34:08 -0000	1.42.32.3
@@ -78,13 +78,6 @@
 // -----------------------------------------------------------------------
 
 
-void ScDocument::SetLinkManager( SvxLinkManager* pNew )
-{
-	pLinkManager = pNew;
-	if (pDrawLayer)
-		pDrawLayer->SetLinkManager( pNew );
-}
-
 SfxBroadcaster* ScDocument::GetDrawBroadcaster()
 {
 	return pDrawLayer;
@@ -212,20 +205,6 @@
 	}
 }
 
-void ScDocument::ClearDrawPage(SCTAB nTab)
-{
-	if (pDrawLayer)
-	{
-		SdrPage* pPage = pDrawLayer->GetPage(static_cast<sal_uInt16>(nTab));
-		if (pPage)
-			pPage->Clear();
-		else
-		{
-			DBG_ERROR("ScDocument::DeleteDrawObjects: pPage ???");
-		}
-	}
-}
-
 void ScDocument::InitDrawLayer( SfxObjectShell* pDocShell )
 {
 	if (pDocShell && !pShell)
@@ -375,19 +354,6 @@
 			pDrawLayer->DeleteObjectsInArea( nTab, nCol1, nRow1, nCol2, nRow2 );
 }
 
-void ScDocument::DeleteObjects( SCTAB nTab )
-{
-	if (!pDrawLayer)
-		return;
-
-	if ( ValidTab(nTab) && pTab[nTab] )
-		pDrawLayer->DeleteObjects( nTab );
-	else
-	{
-		DBG_ERROR("DeleteObjects: falsche Tabelle");
-	}
-}
-
 void ScDocument::DeleteObjectsInSelection( const ScMarkData& rMark )
 {
 	if (!pDrawLayer)
@@ -440,30 +406,6 @@
 }
 
 
-void ScDocument::StopAnimations( SCTAB nTab, Window* /* pWin */ )
-{
-	if (!pDrawLayer)
-		return;
-	SdrPage* pPage = pDrawLayer->GetPage(static_cast<sal_uInt16>(nTab));
-	DBG_ASSERT(pPage,"Page ?");
-	if (!pPage)
-		return;
-
-	SdrObjListIter aIter( *pPage, IM_FLAT );
-	SdrObject* pObject = aIter.Next();
-	while (pObject)
-	{
-		if (pObject->ISA(SdrGrafObj))
-		{
-			SdrGrafObj* pGrafObj = (SdrGrafObj*)pObject;
-			if ( pGrafObj->IsAnimated() )
-//!				pGrafObj->StopAnimation( pWin );
-				pGrafObj->StopAnimation();
-		}
-		pObject = aIter.Next();
-	}
-}
-
 void ScDocument::StartAnimations( SCTAB nTab, Window* pWin )
 {
 	if (!pDrawLayer)
@@ -517,57 +459,57 @@
 	return bFound;
 }
 
-void ScDocument::RefreshNoteFlags()
-{
-	if (!pDrawLayer)
-		return;
-
-	BOOL bAnyIntObj = FALSE;
-	SCTAB nTab;
-	ScPostIt aNote(this);
-	for (nTab=0; nTab<=MAXTAB && pTab[nTab]; nTab++)
-	{
-		SdrPage* pPage = pDrawLayer->GetPage(static_cast<sal_uInt16>(nTab));
-		DBG_ASSERT(pPage,"Page ?");
-		if (pPage)
-		{
-			SdrObjListIter aIter( *pPage, IM_FLAT );
-			SdrObject* pObject = aIter.Next();
-			while (pObject)
-			{
-				if ( pObject->GetLayer() == SC_LAYER_INTERN )
-				{
-					bAnyIntObj = TRUE;	// for all internal objects, including detective
-
-					if ( pObject->ISA( SdrCaptionObj ) )
-					{
-						ScDrawObjData* pData = ScDrawLayer::GetObjData( pObject );
-						if ( pData )
-						{
-                            if ( GetNote( pData->aStt.Col(), pData->aStt.Row(), nTab, aNote))
-								if ( !aNote.IsShown() )
-								{
-									aNote.SetShown(TRUE);
-                                    SetNote( pData->aStt.Col(), pData->aStt.Row(), nTab, aNote);
-								}
-						}
-					}
-				}
-				pObject = aIter.Next();
-			}
-		}
-	}
-
-	if (bAnyIntObj)
-	{
-		//	update attributes for all note objects and the colors of detective objects
-		//	(we don't know with which settings the file was created)
-
-		ScDetectiveFunc aFunc( this, 0 );
-		aFunc.UpdateAllComments();
-		aFunc.UpdateAllArrowColors();
-	}
-}
+//UNUSED2008-05  void ScDocument::RefreshNoteFlags()
+//UNUSED2008-05  {
+//UNUSED2008-05      if (!pDrawLayer)
+//UNUSED2008-05          return;
+//UNUSED2008-05  
+//UNUSED2008-05      BOOL bAnyIntObj = FALSE;
+//UNUSED2008-05      SCTAB nTab;
+//UNUSED2008-05      ScPostIt aNote(this);
+//UNUSED2008-05      for (nTab=0; nTab<=MAXTAB && pTab[nTab]; nTab++)
+//UNUSED2008-05      {
+//UNUSED2008-05          SdrPage* pPage = pDrawLayer->GetPage(static_cast<sal_uInt16>(nTab));
+//UNUSED2008-05          DBG_ASSERT(pPage,"Page ?");
+//UNUSED2008-05          if (pPage)
+//UNUSED2008-05          {
+//UNUSED2008-05              SdrObjListIter aIter( *pPage, IM_FLAT );
+//UNUSED2008-05              SdrObject* pObject = aIter.Next();
+//UNUSED2008-05              while (pObject)
+//UNUSED2008-05              {
+//UNUSED2008-05                  if ( pObject->GetLayer() == SC_LAYER_INTERN )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      bAnyIntObj = TRUE;  // for all internal objects, including detective
+//UNUSED2008-05  
+//UNUSED2008-05                      if ( pObject->ISA( SdrCaptionObj ) )
+//UNUSED2008-05                      {
+//UNUSED2008-05                          ScDrawObjData* pData = ScDrawLayer::GetObjData( pObject );
+//UNUSED2008-05                          if ( pData )
+//UNUSED2008-05                          {
+//UNUSED2008-05                              if ( GetNote( pData->aStt.Col(), pData->aStt.Row(), nTab, aNote))
+//UNUSED2008-05                                  if ( !aNote.IsShown() )
+//UNUSED2008-05                                  {
+//UNUSED2008-05                                      aNote.SetShown(TRUE);
+//UNUSED2008-05                                      SetNote( pData->aStt.Col(), pData->aStt.Row(), nTab, aNote);
+//UNUSED2008-05                                  }
+//UNUSED2008-05                          }
+//UNUSED2008-05                      }
+//UNUSED2008-05                  }
+//UNUSED2008-05                  pObject = aIter.Next();
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      if (bAnyIntObj)
+//UNUSED2008-05      {
+//UNUSED2008-05          //  update attributes for all note objects and the colors of detective objects
+//UNUSED2008-05          //  (we don't know with which settings the file was created)
+//UNUSED2008-05  
+//UNUSED2008-05          ScDetectiveFunc aFunc( this, 0 );
+//UNUSED2008-05          aFunc.UpdateAllComments();
+//UNUSED2008-05          aFunc.UpdateAllArrowColors();
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 BOOL ScDocument::HasBackgroundDraw( SCTAB nTab, const Rectangle& rMMRect )
 {
Index: sc/source/core/data/document.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/document.cxx,v
retrieving revision 1.88
retrieving revision 1.88.22.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.88 -r1.88.22.4
--- sc/source/core/data/document.cxx	18 Apr 2008 11:32:11 -0000	1.88
+++ sc/source/core/data/document.cxx	13 May 2008 14:34:08 -0000	1.88.22.4
@@ -297,9 +297,11 @@
 				pRangeName->UpdateTabRef( nPos, 1 );
 				pDBCollection->UpdateReference(
 									URM_INSDEL, 0,0,nPos, MAXCOL,MAXROW,MAXTAB, 0,0,1 );
+#if OLD_PIVOT_IMPLEMENTATION
 				if (pPivotCollection)
 					pPivotCollection->UpdateReference(
 									URM_INSDEL, 0,0,nPos, MAXCOL,MAXROW,MAXTAB, 0,0,1 );
+#endif
 				if (pDPCollection)
 					pDPCollection->UpdateReference( URM_INSDEL, aRange, 0,0,1 );
 				if (pDetOpList)
@@ -379,9 +381,11 @@
 				pRangeName->UpdateTabRef( nTab, 2 );
 				pDBCollection->UpdateReference(
 									URM_INSDEL, 0,0,nTab, MAXCOL,MAXROW,MAXTAB, 0,0,-1 );
+#if OLD_PIVOT_IMPLEMENTATION
 				if (pPivotCollection)
 					pPivotCollection->UpdateReference(
 									URM_INSDEL, 0,0,nTab, MAXCOL,MAXROW,MAXTAB, 0,0,-1 );
+#endif
 				if (pDPCollection)
 					pDPCollection->UpdateReference( URM_INSDEL, aRange, 0,0,-1 );
 				if (pDetOpList)
@@ -2392,13 +2396,6 @@
 }
 
 
-void ScDocument::SetDirtyVar()
-{
-	for (SCTAB i=0; i<=MAXTAB; i++)
-		if (pTab[i]) pTab[i]->SetDirtyVar();
-}
-
-
 void ScDocument::SetDirty()
 {
 	BOOL bOldAutoCalc = GetAutoCalc();
@@ -2531,15 +2528,6 @@
 }
 
 
-void ScDocument::GetErrCode( SCCOL nCol, SCROW nRow, SCTAB nTab, USHORT& rErrCode )
-{
-	if ( VALIDTAB(nTab) && pTab[nTab] )
-		rErrCode = pTab[nTab]->GetErrCode( nCol, nRow );
-	else
-		rErrCode = 0;
-}
-
-
 USHORT ScDocument::GetErrCode( const ScAddress& rPos ) const
 {
 	SCTAB nTab = rPos.Tab();
@@ -2872,13 +2860,6 @@
 }
 
 
-SCCOL ScDocument::GetLastFlaggedCol( SCTAB nTab ) const
-{
-	if ( ValidTab(nTab) && pTab[nTab] )
-		return pTab[nTab]->GetLastFlaggedCol();
-	return 0;
-}
-
 SCROW ScDocument::GetLastFlaggedRow( SCTAB nTab ) const
 {
 	if ( ValidTab(nTab) && pTab[nTab] )
@@ -3272,21 +3253,6 @@
 }
 
 
-
-BOOL ScDocument::ApplyFlags( SCCOL nStartCol, SCROW nStartRow,
-						SCCOL nEndCol, SCROW nEndRow,
-						const ScMarkData& rMark,
-						INT16 nFlags )
-{
-	BOOL bChanged = FALSE;
-	for (SCTAB i=0; i <= MAXTAB; i++)
-		if (pTab[i])
-			if (rMark.GetTableSelect(i))
-				bChanged |= pTab[i]->ApplyFlags( nStartCol, nStartRow, nEndCol, nEndRow, nFlags );
-	return bChanged;
-}
-
-
 BOOL ScDocument::ApplyFlagsTab( SCCOL nStartCol, SCROW nStartRow,
 						SCCOL nEndCol, SCROW nEndRow, SCTAB nTab, INT16 nFlags )
 {
@@ -3299,20 +3265,6 @@
 }
 
 
-BOOL ScDocument::RemoveFlags( SCCOL nStartCol, SCROW nStartRow,
-						SCCOL nEndCol, SCROW nEndRow,
-						const ScMarkData& rMark,
-						INT16 nFlags )
-{
-	BOOL bChanged = FALSE;
-	for (SCTAB i=0; i <= MAXTAB; i++)
-		if (pTab[i])
-			if (rMark.GetTableSelect(i))
-				bChanged |= pTab[i]->RemoveFlags( nStartCol, nStartRow, nEndCol, nEndRow, nFlags );
-	return bChanged;
-}
-
-
 BOOL ScDocument::RemoveFlagsTab( SCCOL nStartCol, SCROW nStartRow,
 						SCCOL nEndCol, SCROW nEndRow, SCTAB nTab, INT16 nFlags )
 {
@@ -3522,22 +3474,6 @@
 	}
 }
 
-BOOL ScDocument::HasLines( const ScRange& rRange, Rectangle& rSizes ) const
-{
-	SCTAB nTab1 = rRange.aStart.Tab();
-	SCTAB nTab2 = rRange.aEnd.Tab();
-	PutInOrder( nTab1, nTab2 );
-	BOOL bFound = FALSE;
-	rSizes = Rectangle(0,0,0,0);
-
-	for (SCTAB i=nTab1; i<=nTab2; i++)
-		if (pTab[i])
-			if (pTab[i]->HasLines( rRange, rSizes ))
-				bFound = TRUE;
-
-	return bFound;
-}
-
 void ScDocument::GetBorderLines( SCCOL nCol, SCROW nRow, SCTAB nTab,
 						const SvxBorderLine** ppLeft, const SvxBorderLine** ppTop,
 						const SvxBorderLine** ppRight, const SvxBorderLine** ppBottom ) const
@@ -3649,25 +3585,6 @@
 }
 
 
-BOOL ScDocument::IsSelectedBlockEditable( SCCOL nStartCol, SCROW nStartRow,
-											SCCOL nEndCol, SCROW nEndRow,
-											const ScMarkData& rMark ) const
-{
-    // import into read-only document is possible
-    if ( !bImportingXML && !mbChangeReadOnlyEnabled && pShell && pShell->IsReadOnly() )
-		return FALSE;
-
-	BOOL bOk = TRUE;
-	for (SCTAB i=0; i<=MAXTAB && bOk; i++)
-		if (pTab[i])
-			if (rMark.GetTableSelect(i))
-				if (!pTab[i]->IsBlockEditable( nStartCol, nStartRow, nEndCol, nEndRow ))
-					bOk = FALSE;
-
-	return bOk;
-}
-
-
 BOOL ScDocument::IsSelectionEditable( const ScMarkData& rMark,
 			BOOL* pOnlyNotBecauseOfMatrix /* = NULL */ ) const
 {
@@ -3718,67 +3635,6 @@
 }
 
 
-BOOL ScDocument::IsSelectionOrBlockEditable( SCTAB nTab, SCCOL nStartCol, SCROW nStartRow,
-										SCCOL nEndCol, SCROW nEndRow,
-										const ScMarkData& rMark ) const
-{
-    // import into read-only document is possible
-    if ( !bImportingXML && !mbChangeReadOnlyEnabled && pShell && pShell->IsReadOnly() )
-		return FALSE;
-
-	BOOL bOk = TRUE;
-	if (VALIDTAB(nTab))
-	{
-		if (pTab[nTab])
-		{
-			if (rMark.IsMarked())
-			{
-				ScRange aRange;
-				rMark.GetMarkArea(aRange);
-				bOk = pTab[nTab]->IsBlockEditable( aRange.aStart.Col(), aRange.aStart.Row(),
-												   aRange.aEnd.Col(),   aRange.aEnd.Row() );
-			}
-
-			if (bOk && rMark.IsMultiMarked())
-				bOk = pTab[nTab]->IsSelectionEditable( rMark );
-			if ( bOk && !rMark.IsMarked() && !rMark.IsMultiMarked() )
-				bOk = pTab[nTab]->IsBlockEditable( nStartCol, nStartRow, nEndCol, nEndRow );
-			return bOk;
-		}
-	}
-	DBG_ERROR("Falsche Tabellennummer");
-	return FALSE;
-}
-
-
-BOOL ScDocument::IsSelectedOrBlockEditable( SCCOL nStartCol, SCROW nStartRow,
-											SCCOL nEndCol, SCROW nEndRow,
-											const ScMarkData& rMark ) const
-{
-    // import into read-only document is possible
-    if ( !bImportingXML && !mbChangeReadOnlyEnabled && pShell && pShell->IsReadOnly() )
-		return FALSE;
-
-	BOOL bOk = TRUE;
-	for (SCTAB i=0; i<=MAXTAB && bOk; i++)
-		if (pTab[i])
-			if (rMark.GetTableSelect(i))
-			{
-				if (rMark.IsMarked())
-				{
-					ScRange aRange;
-					rMark.GetMarkArea(aRange);
-					bOk = pTab[i]->IsBlockEditable( aRange.aStart.Col(), aRange.aStart.Row(),
-													aRange.aEnd.Col(),   aRange.aEnd.Row() );
-				}
-				if ( bOk && !rMark.IsMarked() )
-					bOk = pTab[i]->IsBlockEditable( nStartCol, nStartRow, nEndCol, nEndRow );
-			}
-
-	return bOk;
-}
-
-
 BOOL ScDocument::HasSelectedBlockMatrixFragment( SCCOL nStartCol, SCROW nStartRow,
 								SCCOL nEndCol, SCROW nEndRow,
 								const ScMarkData& rMark ) const
@@ -4072,36 +3928,22 @@
 }
 
 
-void ScDocument::SetAutoFilterFlags()
-{
-	USHORT nCount = pDBCollection->GetCount();
-	for (USHORT i=0; i<nCount; i++)
-	{
-		ScDBData* pData = (*pDBCollection)[i];
-		SCTAB nDBTab;
-		SCCOL nDBStartCol;
-		SCROW nDBStartRow;
-		SCCOL nDBEndCol;
-		SCROW nDBEndRow;
-		pData->GetArea( nDBTab, nDBStartCol,nDBStartRow, nDBEndCol,nDBEndRow );
-		pData->SetAutoFilter( HasAttrib( nDBStartCol,nDBStartRow,nDBTab,
-								nDBEndCol,nDBStartRow,nDBTab, HASATTR_AUTOFILTER ) );
-	}
-}
-
-
-BOOL ScDocument::IsOverlapped( SCCOL nCol, SCROW nRow, SCTAB nTab ) const
-{
-	const ScMergeFlagAttr* pAttr = (const ScMergeFlagAttr*)
-										GetAttr( nCol, nRow, nTab, ATTR_MERGE_FLAG );
-	if (pAttr)
-		return pAttr->IsOverlapped();
-	else
-	{
-		DBG_ERROR("Overlapped: Attr==0");
-		return FALSE;
-	}
-}
+//UNUSED2008-05  void ScDocument::SetAutoFilterFlags()
+//UNUSED2008-05  {
+//UNUSED2008-05      USHORT nCount = pDBCollection->GetCount();
+//UNUSED2008-05      for (USHORT i=0; i<nCount; i++)
+//UNUSED2008-05      {
+//UNUSED2008-05          ScDBData* pData = (*pDBCollection)[i];
+//UNUSED2008-05          SCTAB nDBTab;
+//UNUSED2008-05          SCCOL nDBStartCol;
+//UNUSED2008-05          SCROW nDBStartRow;
+//UNUSED2008-05          SCCOL nDBEndCol;
+//UNUSED2008-05          SCROW nDBEndRow;
+//UNUSED2008-05          pData->GetArea( nDBTab, nDBStartCol,nDBStartRow, nDBEndCol,nDBEndRow );
+//UNUSED2008-05          pData->SetAutoFilter( HasAttrib( nDBStartCol,nDBStartRow,nDBTab,
+//UNUSED2008-05                                  nDBEndCol,nDBStartRow,nDBTab, HASATTR_AUTOFILTER ) );
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 
 BOOL ScDocument::IsHorOverlapped( SCCOL nCol, SCROW nRow, SCTAB nTab ) const
@@ -4328,234 +4170,6 @@
 }
 
 
-void lcl_RemoveMergeFromStyles( ScStyleSheetPool* pStylePool )
-{
-	pStylePool->SetSearchMask( SFX_STYLE_FAMILY_ALL );
-
-	USHORT nCount = pStylePool->Count();
-	for (USHORT i=0; i<nCount; i++)
-	{
-		//	in alten Versionen wurden statt SFXSTYLEBIT_USERDEF alle Bits gesetzt
-		SfxStyleSheetBase* pStyle = (*pStylePool)[i];
-		if ( pStyle->GetMask() & SFXSTYLEBIT_READONLY )
-			pStyle->SetMask( pStyle->GetMask() & ~SFXSTYLEBIT_READONLY );
-
-		SfxItemSet& rSet = pStyle->GetItemSet();
-		rSet.ClearItem( ATTR_MERGE );
-		rSet.ClearItem( ATTR_MERGE_FLAG );
-
-		//	Das SvxBoxInfoItem wurde bis zur 358 falsch geladen, so dass
-		//	Seitenvorlagen falsche Items mit bDist = FALSE enthalten koennen
-		if ( pStyle->GetFamily() == SFX_STYLE_FAMILY_PAGE )
-		{
-			const SvxBoxInfoItem& rPageInfo = (const SvxBoxInfoItem&)rSet.Get(ATTR_BORDER_INNER);
-			if ( !rPageInfo.IsDist() )
-			{
-				DBG_WARNING("altes SvxBoxInfoItem muss korrigiert werden");
-				SvxBoxInfoItem aNew( rPageInfo );
-				aNew.SetDist( TRUE );
-				rSet.Put( aNew );
-			}
-			//	Das gilt fuer alle Hdr/Ftr-SetItems, darum kann das SetItem auch
-			//	direkt im Pool geaendert werden (const weggecastet):
-			SfxItemSet& rHdrSet = ((SvxSetItem&)rSet.Get(ATTR_PAGE_HEADERSET)).GetItemSet();
-			const SvxBoxInfoItem& rHdrInfo = (const SvxBoxInfoItem&)rHdrSet.Get(ATTR_BORDER_INNER);
-			if ( !rHdrInfo.IsDist() )
-			{
-				DBG_WARNING("altes SvxBoxInfoItem muss korrigiert werden");
-				SvxBoxInfoItem aNew( rHdrInfo );
-				aNew.SetDist( TRUE );
-				rHdrSet.Put( aNew );
-			}
-			SfxItemSet& rFtrSet = ((SvxSetItem&)rSet.Get(ATTR_PAGE_FOOTERSET)).GetItemSet();
-			const SvxBoxInfoItem& rFtrInfo = (const SvxBoxInfoItem&)rFtrSet.Get(ATTR_BORDER_INNER);
-			if ( !rFtrInfo.IsDist() )
-			{
-				DBG_WARNING("altes SvxBoxInfoItem muss korrigiert werden");
-				SvxBoxInfoItem aNew( rFtrInfo );
-				aNew.SetDist( TRUE );
-				rFtrSet.Put( aNew );
-			}
-			const SfxUInt16Item& rScaleItem = (const SfxUInt16Item&)rSet.Get(ATTR_PAGE_SCALE);
-			USHORT nScale = rScaleItem.GetValue();
-			//! Extra-Konstanten fuer Seitenformat?
-			//	0 ist erlaubt (wird gesetzt bei Scale To Pages)
-			if ( nScale != 0 && ( nScale < MINZOOM || nScale > MAXZOOM ) )
-			{
-				//	konnte anscheinend mal irgendwie kaputtgehen (#34508#)
-				DBG_WARNING("kaputter Zoom im Seitenformat muss korrigiert werden");
-				rSet.Put( SfxUInt16Item( ATTR_PAGE_SCALE, 100 ) );
-			}
-		}
-	}
-}
-
-
-BOOL ScDocument::LoadPool( SvStream& rStream, BOOL /* bLoadRefCounts */ )
-{
-	//	bLoadingDone wird beim Laden des StylePools (ScStyleSheet::GetItemSet) gebraucht
-	bLoadingDone = FALSE;
-
-	USHORT nOldBufSize = rStream.GetBufferSize();
-	rStream.SetBufferSize( 32768 );
-	CharSet eOldSet = rStream.GetStreamCharSet();
-
-	SetPrinter( NULL );
-
-	ScPatternAttr::pDoc = this;
-
-	if ( xPoolHelper.isValid() && !bIsClip )
-		xPoolHelper->SourceDocumentGone();
-
-	xPoolHelper = new ScPoolHelper( this );
-
-	xPoolHelper->GetDocPool()->SetFileFormatVersion( (USHORT)rStream.GetVersion() );
-	BOOL bStylesFound = FALSE;
-
-	BOOL bRet = FALSE;
-	USHORT nID;
-	rStream >> nID;
-	if (nID == SCID_POOLS || nID == SCID_NEWPOOLS)
-	{
-		ScReadHeader aHdr( rStream );
-		while (aHdr.BytesLeft())
-		{
-			USHORT nSubID;
-			rStream >> nSubID;
-			ScReadHeader aSubHdr( rStream );
-			switch (nSubID)
-			{
-				case SCID_CHARSET:
-					{
-						BYTE cSet, cGUI;	// cGUI is dummy, old GUIType
-						rStream >> cGUI >> cSet;
-						eSrcSet = (CharSet) cSet;
-                        rStream.SetStreamCharSet( ::GetSOLoadTextEncoding(
-                            eSrcSet, (USHORT)rStream.GetVersion() ) );
-					}
-					break;
-				case SCID_DOCPOOL:
-					xPoolHelper->GetDocPool()->Load( rStream );
-					break;
-				case SCID_STYLEPOOL:
-					{
-						//	StylePool konvertiert beim Laden selber
-						CharSet eOld = rStream.GetStreamCharSet();
-						rStream.SetStreamCharSet( gsl_getSystemTextEncoding() );	//! ???
-						xPoolHelper->GetStylePool()->Load( rStream );
-						rStream.SetStreamCharSet( eOld );
-						lcl_RemoveMergeFromStyles( xPoolHelper->GetStylePool() );	// setzt auch ReadOnly zurueck
-						bStylesFound = TRUE;
-					}
-					break;
-				case SCID_EDITPOOL :
-					xPoolHelper->GetEditPool()->Load( rStream );
-					break;
-				default:
-					DBG_ERROR("unbekannter Sub-Record in ScDocument::LoadPool");
-			}
-		}
-
-		UpdStlShtPtrsFrmNms();
-		bRet = TRUE;
-	}
-	else
-	{
-		DBG_ERROR("LoadPool: SCID_POOLS nicht gefunden");
-	}
-
-	if (!bStylesFound)
-		xPoolHelper->GetStylePool()->CreateStandardStyles();
-
-	rStream.SetStreamCharSet( eOldSet );
-	rStream.SetBufferSize( nOldBufSize );
-
-	bLoadingDone = TRUE;
-
-	//	Das Uno-Objekt merkt sich einen Pointer auf den NumberFormatter
-	//	-> mitteilen, dass der alte Pointer ungueltig geworden ist
-	BroadcastUno( ScPointerChangedHint(SC_POINTERCHANGED_NUMFMT) );
-
-	return bRet;
-}
-
-
-BOOL ScDocument::SavePool( SvStream& rStream ) const
-{
-	xPoolHelper->GetDocPool()->SetFileFormatVersion( (USHORT)rStream.GetVersion() );
-
-	USHORT nOldBufSize = rStream.GetBufferSize();
-	rStream.SetBufferSize( 32768 );
-	CharSet eOldSet = rStream.GetStreamCharSet();
-    CharSet eStoreCharSet = ::GetSOStoreTextEncoding(
-        gsl_getSystemTextEncoding(), (USHORT)rStream.GetVersion() );
-    rStream.SetStreamCharSet( eStoreCharSet );
-
-	//	Compress-Mode fuer Grafiken in Brush-Items (Hintergrund im Seitenformat)
-
-	USHORT nComprMode = rStream.GetCompressMode() & ~(COMPRESSMODE_ZBITMAP | COMPRESSMODE_NATIVE);
-    BOOL bNative = FALSE;
-    BOOL bCompr = FALSE;
-
-	if ( rStream.GetVersion() >= SOFFICE_FILEFORMAT_40 && bCompr )
-		nComprMode |= COMPRESSMODE_ZBITMAP;				//	komprimiert ab 4.0
-	if ( rStream.GetVersion() > SOFFICE_FILEFORMAT_40 && bNative )
-		nComprMode |= COMPRESSMODE_NATIVE;				//	Originalformat ab 5.0
-	rStream.SetCompressMode( nComprMode );
-
-	{
-		rStream << (USHORT) SCID_NEWPOOLS;
-		ScWriteHeader aHdr( rStream );
-
-		{
-			rStream << (USHORT) SCID_CHARSET;
-			ScWriteHeader aSetHdr( rStream, 2 );
-			rStream << (BYTE) 0		// dummy, old System::GetGUIType()
-                    << (BYTE) eStoreCharSet;
-		}
-
-		//	Force the default style's name to be "Standard" for all languages in the file.
-		//	This is needed for versions up to 5.1, to find the default pattern's style in
-		//	the UpdateStyleSheet call.
-		//	#89078# this has to be set for the DocPool save, too, so the default style name
-		//	is adjusted for the patterns, or a wrong style would be used if other styles
-		//	match the default style's name after CharacterSet conversion.
-
-		String aFileStdName = String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM(STRING_STANDARD));
-		if ( aFileStdName != ScGlobal::GetRscString(STR_STYLENAME_STANDARD) )
-			xPoolHelper->GetStylePool()->SetForceStdName( &aFileStdName );
-
-		{
-			rStream << (USHORT) SCID_DOCPOOL;
-			ScWriteHeader aDocPoolHdr( rStream );
-			xPoolHelper->GetDocPool()->Store( rStream );
-		}
-
-		{
-			rStream << (USHORT) SCID_STYLEPOOL;
-			ScWriteHeader aStylePoolHdr( rStream );
-			xPoolHelper->GetStylePool()->SetSearchMask( SFX_STYLE_FAMILY_ALL );
-
-			xPoolHelper->GetStylePool()->Store( rStream, FALSE );
-		}
-
-		xPoolHelper->GetStylePool()->SetForceStdName( NULL );
-
-		if ( rStream.GetVersion() >= SOFFICE_FILEFORMAT_50 )
-		{
-			rStream << (USHORT) SCID_EDITPOOL;
-			ScWriteHeader aEditPoolHdr( rStream );
-			xPoolHelper->GetEditPool()->SetFileFormatVersion( (USHORT)rStream.GetVersion() );
-			xPoolHelper->GetEditPool()->Store( rStream );
-		}
-	}
-
-	rStream.SetStreamCharSet( eOldSet );
-	rStream.SetBufferSize( nOldBufSize );
-	return TRUE;
-}
-
-
 ULONG ScDocument::GetCellCount() const
 {
 	ULONG nCellCount = 0L;
@@ -4638,14 +4252,6 @@
 }
 
 
-void ScDocument::UpdatePageBreaks()
-{
-	for (SCTAB i=0; i<=MAXTAB; i++)
-		if (pTab[i])
-			pTab[i]->UpdatePageBreaks( NULL );
-}
-
-
 void ScDocument::UpdatePageBreaks( SCTAB nTab, const ScRange* pUserArea )
 {
 	if ( ValidTab(nTab)  && pTab[nTab] )
Index: sc/source/core/data/dpobject.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dpobject.cxx,v
retrieving revision 1.23
retrieving revision 1.23.30.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.30.4
--- sc/source/core/data/dpobject.cxx	10 Apr 2008 19:25:42 -0000	1.23
+++ sc/source/core/data/dpobject.cxx	13 May 2008 14:34:09 -0000	1.23.30.4
@@ -1610,226 +1610,6 @@
 	return nOutCount;
 }
 
-void lcl_SaveOldFieldArr( SvStream& /* rStream */,
-                            const uno::Reference<sheet::XDimensionsSupplier>& /* xSource */,
-                            USHORT /* nOrient */, SCCOL /* nColAdd */, BOOL /* bAddData */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	// PIVOT_MAXFIELD = max. number in old files
-    DBG_ASSERT( nOrient != sheet::DataPilotFieldOrientation_PAGE, "lcl_SaveOldFieldArr - do not try to save page fields" );
-	PivotField aFields[PIVOT_MAXFIELD];
-	SCSIZE nOutCount = lcl_FillOldFields( aFields, xSource, nOrient, nColAdd, bAddData );
-
-	rStream << nOutCount;
-	for (USHORT i=0; i<nOutCount; i++)
-	{
-		rStream << (BYTE) 0x00
-				<< aFields[i].nCol
-				<< aFields[i].nFuncMask
-				<< aFields[i].nFuncCount;
-	}
-#endif
-}
-
-BOOL ScDPObject::StoreNew( SvStream& /* rStream */, ScMultipleWriteHeader& /* rHdr */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	//	save all data
-
-	rHdr.StartEntry();
-
-	if ( pImpDesc )
-	{
-		rStream << (BYTE) SC_DP_SOURCE_DATABASE;
-		rStream.WriteByteString( pImpDesc->aDBName, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( pImpDesc->aObject, rStream.GetStreamCharSet() );
-		rStream << pImpDesc->nType;		// USHORT
-		rStream << pImpDesc->bNative;
-	}
-	else if ( pServDesc )
-	{
-		rStream << (BYTE) SC_DP_SOURCE_SERVICE;
-		rStream.WriteByteString( pServDesc->aServiceName, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( pServDesc->aParSource,	  rStream.GetStreamCharSet() );
-		rStream.WriteByteString( pServDesc->aParName,	  rStream.GetStreamCharSet() );
-		rStream.WriteByteString( pServDesc->aParUser,	  rStream.GetStreamCharSet() );
-		rStream.WriteByteString( pServDesc->aParPass,	  rStream.GetStreamCharSet() );
-	}
-	else
-	{
-		if (!pSheetDesc)
-		{
-			DBG_ERROR("no source descriptor");
-			((ScDPObject*)this)->pSheetDesc = new ScSheetSourceDesc;		// dummy defaults
-		}
-
-		rStream << (BYTE) SC_DP_SOURCE_SHEET;
-		rStream << pSheetDesc->aSourceRange;
-		pSheetDesc->aQueryParam.Store( rStream );
-	}
-
-	rStream << aOutRange;
-
-	DBG_ASSERT(pSaveData, "ScDPObject::StoreNew no SaveData");
-	pSaveData->Store( rStream );
-
-	//	additional data starting from 561b
-	rStream.WriteByteString( aTableName, rStream.GetStreamCharSet() );
-	rStream.WriteByteString( aTableTag,  rStream.GetStreamCharSet() );
-
-	rHdr.EndEntry();
-	return TRUE;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-BOOL ScDPObject::LoadNew(SvStream& /* rStream */, ScMultipleReadHeader& /* rHdr */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rHdr.StartEntry();
-
-	DELETEZ( pImpDesc );
-	DELETEZ( pSheetDesc );
-	DELETEZ( pServDesc );
-
-	BYTE nType;
-	rStream >> nType;
-	switch (nType)
-	{
-		case SC_DP_SOURCE_DATABASE:
-			pImpDesc = new ScImportSourceDesc;
-			rStream.ReadByteString( pImpDesc->aDBName, rStream.GetStreamCharSet() );
-			rStream.ReadByteString( pImpDesc->aObject, rStream.GetStreamCharSet() );
-			rStream >> pImpDesc->nType;		// USHORT
-			rStream >> pImpDesc->bNative;
-			break;
-
-		case SC_DP_SOURCE_SHEET:
-			pSheetDesc = new ScSheetSourceDesc;
-			rStream >> pSheetDesc->aSourceRange;
-			pSheetDesc->aQueryParam.Load( rStream );
-			break;
-
-		case SC_DP_SOURCE_SERVICE:
-			{
-				String aServiceName, aParSource, aParName, aParUser, aParPass;
-				rStream.ReadByteString( aServiceName, rStream.GetStreamCharSet() );
-				rStream.ReadByteString( aParSource,	  rStream.GetStreamCharSet() );
-				rStream.ReadByteString( aParName,	  rStream.GetStreamCharSet() );
-				rStream.ReadByteString( aParUser,	  rStream.GetStreamCharSet() );
-				rStream.ReadByteString( aParPass,	  rStream.GetStreamCharSet() );
-				pServDesc = new ScDPServiceDesc( aServiceName,
-										aParSource, aParName, aParUser, aParPass );
-			}
-			break;
-
-		default:
-			DBG_ERROR("unknown source type");
-	}
-
-	rStream >> aOutRange;
-
-	SetSaveData(ScDPSaveData());
-	pSaveData->Load( rStream );
-
-	if (rHdr.BytesLeft())		//	additional data starting from 561b
-	{
-		rStream.ReadByteString( aTableName, rStream.GetStreamCharSet() );
-		rStream.ReadByteString( aTableTag,  rStream.GetStreamCharSet() );
-	}
-
-	rHdr.EndEntry();
-	return TRUE;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-BOOL ScDPObject::StoreOld( SvStream& rStream, ScMultipleWriteHeader& rHdr ) const
-{
-	//	write compatible data for office 5.1 and below
-
-	DBG_ASSERT( pSheetDesc, "StoreOld: !pSheetDesc" );
-	ScRange aStoreRange;
-	ScQueryParam aStoreQuery;
-	if (pSheetDesc)
-	{
-		aStoreRange = pSheetDesc->aSourceRange;
-		aStoreQuery = pSheetDesc->aQueryParam;
-	}
-
-	((ScDPObject*)this)->CreateObjects();		// xSource is needed for field numbers
-
-	rHdr.StartEntry();
-
-	rStream << (BOOL) TRUE;			// bHasHeader
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << aStoreRange.aStart.Col();
-	rStream << aStoreRange.aStart.Row();
-	rStream << aStoreRange.aEnd.Col();
-	rStream << aStoreRange.aEnd.Row();
-	rStream << aStoreRange.aStart.Tab();
-
-	//!	make sure aOutRange is initialized
-
-	rStream << aOutRange.aStart.Col();
-	rStream << aOutRange.aStart.Row();
-	rStream << aOutRange.aEnd.Col();
-	rStream << aOutRange.aEnd.Row();
-	rStream << aOutRange.aStart.Tab();
-#endif
-
-	BOOL bAddData = ( lcl_GetDataGetOrientation( xSource ) == sheet::DataPilotFieldOrientation_HIDDEN );
-
-	lcl_SaveOldFieldArr( rStream, xSource, sheet::DataPilotFieldOrientation_ROW,    aStoreRange.aStart.Col(), bAddData );
-	lcl_SaveOldFieldArr( rStream, xSource, sheet::DataPilotFieldOrientation_COLUMN, aStoreRange.aStart.Col(), FALSE );
-	lcl_SaveOldFieldArr( rStream, xSource, sheet::DataPilotFieldOrientation_DATA,   aStoreRange.aStart.Col(), FALSE );
-
-	aStoreQuery.Store( rStream );
-
-	BOOL bColumnGrand	= TRUE;
-	BOOL bRowGrand		= TRUE;
-	BOOL bIgnoreEmpty	= FALSE;
-	BOOL bRepeatIfEmpty	= FALSE;
-
-	uno::Reference<beans::XPropertySet> xProp( xSource, uno::UNO_QUERY );
-	if (xProp.is())
-	{
-		bColumnGrand = ScUnoHelpFunctions::GetBoolProperty( xProp,
-						rtl::OUString::createFromAscii(DP_PROP_COLUMNGRAND), TRUE );
-		bRowGrand = ScUnoHelpFunctions::GetBoolProperty( xProp,
-						rtl::OUString::createFromAscii(DP_PROP_ROWGRAND), TRUE );
-
-		// following properties may be missing for external sources
-		bIgnoreEmpty = ScUnoHelpFunctions::GetBoolProperty( xProp,
-						rtl::OUString::createFromAscii(DP_PROP_IGNOREEMPTY) );
-		bRepeatIfEmpty = ScUnoHelpFunctions::GetBoolProperty( xProp,
-						rtl::OUString::createFromAscii(DP_PROP_REPEATIFEMPTY) );
-	}
-
-	rStream << bIgnoreEmpty;		// bIgnoreEmpty
-	rStream << bRepeatIfEmpty;		// bDetectCat
-
-	rStream << bColumnGrand;		// bMakeTotalCol
-	rStream << bRowGrand;			// bMakeTotalRow
-
-	if( rStream.GetVersion() > SOFFICE_FILEFORMAT_40 )
-	{
-		rStream.WriteByteString( aTableName, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( aTableTag,  rStream.GetStreamCharSet() );
-		rStream << (USHORT)0;		// nColNameCount
-	}
-
-	rHdr.EndEntry();
-	return TRUE;
-}
-
 BOOL ScDPObject::FillOldParam(ScPivotParam& rParam, BOOL bForFile) const
 {
 	((ScDPObject*)this)->CreateObjects();		// xSource is needed for field numbers
@@ -2272,6 +2052,7 @@
 	}
 }
 
+#if OLD_PIVOT_IMPLEMENTATION
 void ScDPObject::InitFromOldPivot( const ScPivot& rOld, ScDocument* pDocP, BOOL bSetSource )
 {
 	ScDPSaveData aSaveData;
@@ -2313,6 +2094,7 @@
 	aTableName = rOld.GetName();
 	aTableTag  = rOld.GetTag();
 }
+#endif
 
 // -----------------------------------------------------------------------
 
@@ -2456,82 +2238,6 @@
 	return new ScDPCollection(*this);
 }
 
-BOOL ScDPCollection::StoreOld( SvStream& rStream ) const
-{
-	BOOL bSuccess = TRUE;
-
-	USHORT nSheetCount = 0;
-	USHORT i;
-	for (i=0; i<nCount; i++)
-		if ( ((const ScDPObject*)At(i))->IsSheetData() )
-			++nSheetCount;
-
-	ScMultipleWriteHeader aHdr( rStream );
-
-	rStream << nSheetCount;			// only tables from sheet data
-
-	for (i=0; i<nCount && bSuccess; i++)
-	{
-		const ScDPObject* pObj = (const ScDPObject*)At(i);
-		if ( pObj->IsSheetData() )
-			bSuccess = pObj->StoreOld( rStream, aHdr );
-	}
-
-	return bSuccess;
-}
-
-BOOL ScDPCollection::StoreNew( SvStream& rStream ) const
-{
-	BOOL bSuccess = TRUE;
-
-	ScMultipleWriteHeader aHdr( rStream );
-
-	rStream << (long)SC_DP_VERSION_CURRENT;
-	rStream << (long)nCount;
-
-	for (USHORT i=0; i<nCount && bSuccess; i++)
-		bSuccess = ((const ScDPObject*)At(i))->StoreNew( rStream, aHdr );
-
-	return bSuccess;
-}
-
-BOOL ScDPCollection::LoadNew( SvStream& rStream )
-{
-	BOOL bSuccess = TRUE;
-
-	FreeAll();
-	ScMultipleReadHeader aHdr( rStream );
-
-	long nVer;
-	rStream >> nVer;
-
-	//	check for all supported versions here..
-
-	if ( nVer != SC_DP_VERSION_CURRENT )
-	{
-		DBG_ERROR("skipping unknown version of data pilot obejct");
-		if ( rStream.GetError() == SVSTREAM_OK )
-			rStream.SetError( SCWARN_IMPORT_INFOLOST );
-		return FALSE;
-	}
-
-	long nNewCount;
-	rStream >> nNewCount;
-	for (long i=0; i<nNewCount; i++)
-	{
-		ScDPObject* pObj = new ScDPObject( pDoc );
-		if ( pObj->LoadNew(rStream, aHdr) )
-		{
-			pObj->SetAlive( TRUE );
-			Insert( pObj );
-		}
-		else
-			delete pObj;
-	}
-
-	return bSuccess;
-}
-
 void ScDPCollection::DeleteOnTab( SCTAB nTab )
 {
     USHORT nPos = 0;
@@ -2629,16 +2335,17 @@
 	return String();					// should not happen
 }
 
-void ScDPCollection::EnsureNames()
-{
-	for (USHORT i=0; i<nCount; i++)
-		if (!((const ScDPObject*)At(i))->GetName().Len())
-			((ScDPObject*)At(i))->SetName( CreateNewName() );
-}
+//UNUSED2008-05  void ScDPCollection::EnsureNames()
+//UNUSED2008-05  {
+//UNUSED2008-05      for (USHORT i=0; i<nCount; i++)
+//UNUSED2008-05          if (!((const ScDPObject*)At(i))->GetName().Len())
+//UNUSED2008-05              ((ScDPObject*)At(i))->SetName( CreateNewName() );
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 //	convert old pivot tables into new datapilot tables
 
+#if OLD_PIVOT_IMPLEMENTATION
 void ScDPCollection::ConvertOldTables( ScPivotCollection& rOldColl )
 {
 	//	convert old pivot tables into new datapilot tables
@@ -2653,6 +2360,7 @@
 	}
 	rOldColl.FreeAll();
 }
+#endif
 
 
 
Index: sc/source/core/data/dpoutput.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dpoutput.cxx,v
retrieving revision 1.17
retrieving revision 1.17.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.30.1
--- sc/source/core/data/dpoutput.cxx	10 Apr 2008 19:26:00 -0000	1.17
+++ sc/source/core/data/dpoutput.cxx	8 May 2008 21:46:15 -0000	1.17.30.1
@@ -166,15 +166,6 @@
 	pDoc->ApplyFrameAreaTab( ScRange( nCol1, nRow1, nTab, nCol2, nRow2, nTab ), &aBox, &aBoxInfo );
 }
 
-void lcl_AttrArea( ScDocument* pDoc, SCTAB nTab,
-					SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2,
-					const SfxPoolItem& rItem )
-{
-	ScPatternAttr aPattern( pDoc->GetPool() );
-	aPattern.GetItemSet().Put( rItem );
-	pDoc->ApplyPatternAreaTab( nCol1,nRow1, nCol2,nRow2, nTab, aPattern );
-}
-
 // -----------------------------------------------------------------------
 
 void lcl_FillNumberFormats( UINT32*& rFormats, long& rCount,
@@ -611,7 +602,6 @@
 		//!	limit frames to horizontal or vertical?
 		if (bColHeader)
 		{
-//			lcl_AttrArea( pDoc,nTab, nCol,nMemberStartRow+(SCROW)nLevel, nCol,nTabEndRow, aItem );
 			lcl_SetFrame( pDoc,nTab, nCol,nMemberStartRow+(SCROW)nLevel, nCol,nTabEndRow, 20 );
 			lcl_SetStyleById( pDoc,nTab, nCol,nMemberStartRow+(SCROW)nLevel, nCol,nDataStartRow-1,
 									STR_PIVOT_STYLE_TITLE );
@@ -620,7 +610,6 @@
 		}
 		else
 		{
-//			lcl_AttrArea( pDoc,nTab, nMemberStartCol+(SCCOL)nLevel,nRow, nTabEndCol,nRow, aItem );
 			lcl_SetFrame( pDoc,nTab, nMemberStartCol+(SCCOL)nLevel,nRow, nTabEndCol,nRow, 20 );
 			lcl_SetStyleById( pDoc,nTab, nMemberStartCol+(SCCOL)nLevel,nRow, nDataStartCol-1,nRow,
 									STR_PIVOT_STYLE_TITLE );
Index: sc/source/core/data/dpsave.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dpsave.cxx,v
retrieving revision 1.13
retrieving revision 1.13.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.3
--- sc/source/core/data/dpsave.cxx	10 Apr 2008 19:26:17 -0000	1.13
+++ sc/source/core/data/dpsave.cxx	9 May 2008 16:11:46 -0000	1.13.32.3
@@ -493,12 +493,6 @@
 	return ( pLayoutName != NULL );
 }
 
-void ScDPSaveDimension::ResetLayoutName()
-{
-	delete pLayoutName;
-	pLayoutName = NULL;
-}
-
 void ScDPSaveDimension::SetLayoutName(const String* pName)
 {
 	delete pLayoutName;
@@ -1196,48 +1190,6 @@
 	}
 }
 
-void ScDPSaveData::Store( SvStream& rStream ) const
-{
-	//!	multi-header for individual entries
-
-	long nCount = aDimList.Count();
-	rStream << nCount;
-	for (long i=0; i<nCount; i++)
-	{
-		const ScDPSaveDimension* pDim = (const ScDPSaveDimension*)aDimList.GetObject(i);
-		pDim->Store( rStream );
-	}
-
-	rStream << nColumnGrandMode;
-	rStream << nRowGrandMode;
-	rStream << nIgnoreEmptyMode;
-	rStream << nRepeatEmptyMode;
-
-	rStream << (USHORT) 0;	// nExtra
-}
-
-void ScDPSaveData::Load( SvStream& rStream )
-{
-	//!	multi-header for individual entries
-
-	DBG_ASSERT( aDimList.Count()==0, "ScDPSaveData::Load not empty" );
-
-	long nNewCount;
-	rStream >> nNewCount;
-	for (long i=0; i<nNewCount; i++)
-	{
-		ScDPSaveDimension* pNew = new ScDPSaveDimension( rStream );
-		aDimList.Insert( pNew, LIST_APPEND );
-	}
-
-	rStream >> nColumnGrandMode;
-	rStream >> nRowGrandMode;
-	rStream >> nIgnoreEmptyMode;
-	rStream >> nRepeatEmptyMode;
-
-	lcl_SkipExtra( rStream );		// reads at least 1 USHORT
-}
-
 BOOL ScDPSaveData::IsEmpty() const
 {
 	long nCount = aDimList.Count();
Index: sc/source/core/data/drwlayer.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/drwlayer.cxx,v
retrieving revision 1.55
retrieving revision 1.55.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.55 -r1.55.32.1
--- sc/source/core/data/drwlayer.cxx	10 Apr 2008 19:28:43 -0000	1.55
+++ sc/source/core/data/drwlayer.cxx	9 May 2008 16:11:46 -0000	1.55.32.1
@@ -1830,11 +1830,6 @@
 	}
 }
 
-ULONG ScDrawLayer::GetDefTextHeight() const
-{
-	return nDefTextHgt;		// protected in SdrModel
-}
-
 void ScDrawLayer::SetAnchor( SdrObject* pObj, ScAnchorType eType )
 {
 	// Ein an der Seite verankertes Objekt zeichnet sich durch eine Anker-Pos
Index: sc/source/core/data/global.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/global.cxx,v
retrieving revision 1.55
retrieving revision 1.55.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.55 -r1.55.30.1
--- sc/source/core/data/global.cxx	10 Apr 2008 19:29:17 -0000	1.55
+++ sc/source/core/data/global.cxx	9 May 2008 16:11:46 -0000	1.55.30.1
@@ -1067,11 +1067,6 @@
 
 ScFuncDesc aDefaultFuncDesc;
 
-const ScFuncDesc* ScFormulaUtil::GetDefaultFuncDesc()
-{
-	return &aDefaultFuncDesc;
-}
-
 BOOL ScFormulaUtil::GetNextFunc( const String&	rFormula,
 								 BOOL			bBack,
 								 xub_StrLen&	rFStart,   // Ein- und Ausgabe
Index: sc/source/core/data/global2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/global2.cxx,v
retrieving revision 1.23
retrieving revision 1.23.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.32.2
--- sc/source/core/data/global2.cxx	10 Apr 2008 19:29:36 -0000	1.23
+++ sc/source/core/data/global2.cxx	9 May 2008 02:03:25 -0000	1.23.32.2
@@ -230,37 +230,6 @@
 	//! pSearchParam und pSearchText nicht vergleichen
 }
 
-void ScQueryEntry::Load( SvStream& /* rStream */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	BYTE cOp, cConnect;
-	rStream >> bDoQuery
-			>> bQueryByString
-			>> cOp
-			>> cConnect
-			>> nField
-			>> nVal;
-	rStream.ReadByteString( *pStr, rStream.GetStreamCharSet() );
-	eOp = (ScQueryOp) cOp;
-	eConnect = (ScQueryConnect) cConnect;
-#endif
-}
-
-void ScQueryEntry::Store( SvStream& /* rStream */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << bDoQuery
-			<< bQueryByString
-			<< (BYTE) eOp
-			<< (BYTE) eConnect
-			<< nField
-			<< nVal;
-	rStream.WriteByteString( *pStr, rStream.GetStreamCharSet() );
-#endif
-}
-
 utl::TextSearch* ScQueryEntry::GetSearchTextPtr( BOOL bCaseSens )
 {
 	if ( !pSearchParam )
@@ -505,76 +474,6 @@
 }
 
 //------------------------------------------------------------------------
-
-void ScQueryParam::Load( SvStream& rStream )		// z.B. fuer Pivot-Tabelle
-{
-	// bDestPers wird nicht geladen/gespeichert
-
-	ScReadHeader aHdr( rStream );
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream >> nCol1
-			>> nRow1
-			>> nCol2
-			>> nRow2
-			>> nDestTab
-			>> nDestCol
-			>> nDestRow
-			>> bHasHeader
-			>> bInplace
-			>> bCaseSens
-			>> bRegExp
-			>> bDuplicate
-			>> bByRow;
-#endif
-
-	Resize( MAXQUERY );
-
-	for (USHORT i=0; i<MAXQUERY; i++)
-		pEntries[i].Load(rStream);
-}
-
-//------------------------------------------------------------------------
-
-void ScQueryParam::Store( SvStream& rStream ) const		// z.B. fuer Pivot-Tabelle
-{
-	// bDestPers wird nicht geladen/gespeichert
-
-	ScWriteHeader aHdr( rStream );
-
-	DBG_ASSERT( nEntryCount <= MAXQUERY || !pEntries[MAXQUERY].bDoQuery,
-					"zuviele Eintraege bei ScQueryParam::Store" );
-
-
-	if ( nEntryCount < MAXQUERY )
-	{
-		DBG_ERROR("ScQueryParam::Store - zuwenig Eintraege");
-		((ScQueryParam*)this)->Resize( MAXQUERY );
-	}
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << nCol1
-			<< nRow1
-			<< nCol2
-			<< nRow2
-			<< nDestTab
-			<< nDestCol
-			<< nDestRow
-			<< bHasHeader
-			<< bInplace
-			<< bCaseSens
-			<< bRegExp
-			<< bDuplicate
-			<< bByRow;
-#endif
-
-	for (USHORT i=0; i<MAXQUERY; i++)
-		pEntries[i].Store(rStream);
-}
-
-//------------------------------------------------------------------------
 // struct ScSubTotalParam:
 
 ScSubTotalParam::ScSubTotalParam()
@@ -893,47 +792,6 @@
 	}
 }
 
-void ScConsolidateParam::Load( SvStream& rStream )
-{
-	ClearDataAreas();
-
-	ScReadHeader aHdr( rStream );
-
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	BYTE nByte;
-	rStream >> nCol >> nRow >> nTab
-			>> bByCol >> bByRow >> bReferenceData >> nByte;
-	eFunction = (ScSubTotalFunc) nByte;
-
-	rStream >> nDataAreaCount;
-	if ( nDataAreaCount )
-	{
-		ppDataAreas = new ScArea*[nDataAreaCount];
-		for ( USHORT i=0; i<nDataAreaCount; i++ )
-		{
-			ppDataAreas[i] = new ScArea();
-			rStream >> *ppDataAreas[i];
-		}
-	}
-#endif
-}
-
-void ScConsolidateParam::Store( SvStream& rStream ) const
-{
-	ScWriteHeader aHdr( rStream, 12+10*nDataAreaCount );
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-
-	rStream << nCol << nRow << nTab
-			<< bByCol << bByRow << bReferenceData << (BYTE) eFunction;
-
-	rStream << nDataAreaCount;
-	for (USHORT i=0; i<nDataAreaCount; i++)
-		rStream << *ppDataAreas[i];
-#endif
-}
-
 // -----------------------------------------------------------------------
 
 PivotField::PivotField( SCsCOL nNewCol, USHORT nNewFuncMask ) :
Index: sc/source/core/data/markarr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/markarr.cxx,v
retrieving revision 1.11
retrieving revision 1.11.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.1
--- sc/source/core/data/markarr.cxx	10 Apr 2008 19:30:33 -0000	1.11
+++ sc/source/core/data/markarr.cxx	9 May 2008 21:22:39 -0000	1.11.32.1
@@ -126,11 +126,6 @@
 
 //------------------------------------------------------------------------
 
-void ScMarkArray::SetMark( SCROW nRow, BOOL bMarked )
-{
-	SetMarkArea( nRow, nRow, bMarked );
-}
-
 void ScMarkArray::SetMarkArea( SCROW nStartRow, SCROW nEndRow, BOOL bMarked )
 {
 	if (ValidRow(nStartRow) && ValidRow(nEndRow))
@@ -316,35 +311,6 @@
 	return bRet;
 }
 
-void ScMarkArray::SwapCol(ScMarkArray& rMarkArray)
-{
-	SCSIZE nTemp = rMarkArray.nCount;
-	rMarkArray.nCount = nCount;
-	nCount = nTemp;
-
-    nTemp = rMarkArray.nLimit;
-    rMarkArray.nLimit = nLimit;
-    nLimit = nTemp;
-
-	ScMarkEntry* pTemp = rMarkArray.pData;
-	rMarkArray.pData = pData;
-	pData = pTemp;
-}
-
-void ScMarkArray::MoveTo(SCROW nStartRow, SCROW nEndRow, ScMarkArray& rMarkArray)
-{
-	SCROW nStart = nStartRow;
-	for (SCSIZE i = 0; i < nCount; i++)
-	{
-		if ((pData[i].nRow >= nStartRow) && ((i==0) ? TRUE : pData[i-1].nRow < nEndRow))
-		{
-			rMarkArray.SetMarkArea(nStart, Min(pData[i].nRow,nEndRow), pData[i].bMarked);
-		}
-		nStart = Max((SCROW)nStart, (SCROW)(pData[i].nRow + 1) );
-	}
-	DeleteArea(nStartRow, nEndRow);
-}
-
 void ScMarkArray::CopyMarksTo( ScMarkArray& rDestMarkArray ) const
 {
 	delete[] rDestMarkArray.pData;
Index: sc/source/core/data/olinetab.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/olinetab.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.3
--- sc/source/core/data/olinetab.cxx	10 Apr 2008 19:31:08 -0000	1.10
+++ sc/source/core/data/olinetab.cxx	13 May 2008 03:45:32 -0000	1.10.32.3
@@ -64,36 +64,6 @@
 {
 }
 
-ScOutlineEntry::ScOutlineEntry( SvStream& /* rStream */, ScMultipleReadHeader& rHdr )
-{
-	rHdr.StartEntry();
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-
-	rStream >> nStart;
-	rStream >> nSize;
-	rStream >> bHidden;
-	rStream >> bVisible;
-
-#endif
-	rHdr.EndEntry();
-}
-
-void ScOutlineEntry::Store( SvStream& /* rStream */, ScMultipleWriteHeader& rHdr )
-{
-	rHdr.StartEntry();
-
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	rStream << nStart;
-	rStream << nSize;
-	rStream << bHidden;
-	rStream << bVisible;
-
-#endif
-	rHdr.EndEntry();
-}
-
 DataObject* ScOutlineEntry::Clone() const
 {
 	return new ScOutlineEntry( *this );
@@ -714,37 +684,6 @@
 	nDepth = 0;
 }
 
-void ScOutlineArray::Load( SvStream& rStream )
-{
-	ScMultipleReadHeader aHdr( rStream );
-
-	rStream >> nDepth;
-	for (USHORT nLevel=0; nLevel<nDepth; nLevel++)
-	{
-		USHORT nCount;
-		rStream >> nCount;
-		for (USHORT nIndex=0; nIndex<nCount; nIndex++)
-		{
-			ScOutlineEntry* pEntry = new ScOutlineEntry( rStream, aHdr );
-			aCollections[nLevel].Insert( pEntry );
-		}
-	}
-}
-
-void ScOutlineArray::Store( SvStream& rStream )
-{
-	ScMultipleWriteHeader aHdr( rStream );
-
-	rStream << nDepth;
-	for (USHORT nLevel=0; nLevel<nDepth; nLevel++)
-	{
-		USHORT nCount = aCollections[nLevel].GetCount();
-		rStream << nCount;
-		for (USHORT nIndex=0; nIndex<nCount; nIndex++)
-			((ScOutlineEntry*) aCollections[nLevel].At(nIndex))->Store( rStream, aHdr );
-	}
-}
-
 //------------------------------------------------------------------------
 
 ScOutlineTable::ScOutlineTable()
@@ -787,20 +726,6 @@
 	return aRowOutline.DeleteSpace( nStartRow, nSize );
 }
 
-void ScOutlineTable::Load( SvStream& rStream )
-{
-	DBG_ASSERT( aColOutline.GetDepth()==0 && aRowOutline.GetDepth()==0,
-					"Load auf nicht leere ScOutlineTable" );
-	aColOutline.Load( rStream );
-	aRowOutline.Load( rStream );
-}
-
-void ScOutlineTable::Store( SvStream& rStream )
-{
-	aColOutline.Store( rStream );
-	aRowOutline.Store( rStream );
-}
-
 //------------------------------------------------------------------------
 
 ScSubOutlineIterator::ScSubOutlineIterator( ScOutlineArray* pOutlineArray ) :
Index: sc/source/core/data/patattr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/patattr.cxx,v
retrieving revision 1.34
retrieving revision 1.34.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.32.1
--- sc/source/core/data/patattr.cxx	10 Apr 2008 19:31:45 -0000	1.34
+++ sc/source/core/data/patattr.cxx	13 May 2008 18:34:49 -0000	1.34.32.1
@@ -1212,15 +1212,15 @@
 		return FALSE;
 }
 
-FontToSubsFontConverter ScPatternAttr::GetSubsFontConverter( ULONG nFlags ) const
-{
-	const SfxPoolItem* pItem;
-	if( GetItemSet().GetItemState( ATTR_FONT, TRUE, &pItem ) == SFX_ITEM_SET )
-        return CreateFontToSubsFontConverter(
-            ((const SvxFontItem*) pItem)->GetFamilyName(), nFlags );
-	else
-        return 0;
-}
+//UNUSED2008-05  FontToSubsFontConverter ScPatternAttr::GetSubsFontConverter( ULONG nFlags ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      const SfxPoolItem* pItem;
+//UNUSED2008-05      if( GetItemSet().GetItemState( ATTR_FONT, TRUE, &pItem ) == SFX_ITEM_SET )
+//UNUSED2008-05          return CreateFontToSubsFontConverter(
+//UNUSED2008-05              ((const SvxFontItem*) pItem)->GetFamilyName(), nFlags );
+//UNUSED2008-05      else
+//UNUSED2008-05          return 0;
+//UNUSED2008-05  }
 
 
 ULONG ScPatternAttr::GetNumberFormat( SvNumberFormatter* pFormatter ) const
Index: sc/source/core/data/pivot.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/pivot.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.3
--- sc/source/core/data/pivot.cxx	10 Apr 2008 19:32:03 -0000	1.12
+++ sc/source/core/data/pivot.cxx	13 May 2008 00:33:45 -0000	1.12.32.3
@@ -34,7 +34,7 @@
 
 
 // -----------------------------------------------------------------------
-
+#if OLD_PIVOT_IMPLEMENTATION
 #ifdef _MSC_VER
 #pragma optimize("",off)
 #endif
@@ -2025,5 +2025,5 @@
 	return nRow;
 }
 
-
+#endif
 
Index: sc/source/core/data/pivot2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/pivot2.cxx,v
retrieving revision 1.14
retrieving revision 1.14.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.3
--- sc/source/core/data/pivot2.cxx	10 Apr 2008 19:32:28 -0000	1.14
+++ sc/source/core/data/pivot2.cxx	13 May 2008 00:33:45 -0000	1.14.32.3
@@ -64,6 +64,7 @@
 
 // STATIC DATA -----------------------------------------------------------
 
+#if OLD_PIVOT_IMPLEMENTATION
 //--------------------------------------------------------------------------------------------------
 // Hilfsmethoden von ScPivot
 //--------------------------------------------------------------------------------------------------
@@ -487,6 +488,8 @@
 	return new ScPivotCollection(*this);
 }
 
+#endif
+
 // ============================================================================
 
 LabelData::LabelData( const String& rName, short nCol, bool bIsValue ) :
Index: sc/source/core/data/scimpexpmsg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/scimpexpmsg.cxx,v
retrieving revision 1.5
retrieving revision 1.5.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.3
--- sc/source/core/data/scimpexpmsg.cxx	10 Apr 2008 19:33:22 -0000	1.5
+++ sc/source/core/data/scimpexpmsg.cxx	12 May 2008 16:41:58 -0000	1.5.32.3
@@ -40,91 +40,77 @@
 
 #include <tools/string.hxx>
 
-
-void ScDocument::AddToImpExpLog( const ScImpExpLogMsg& /* r */ )
-{
-}
-
-
-void ScDocument::AddToImpExpLog( ScImpExpLogMsg* p )
-{
-	delete p;
-}
-
-
-
-
-ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e ) : eId( e ), pPos( NULL ), pHint( NULL )
-{
-}
-
-
-ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e, const String& r ) : eId( e ), pHint( NULL )
-{
-	pPos = new String( r );
-}
-
-
-ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e, const String& rP, const String& rH ) : eId( e )
-{
-	pPos = new String( rP );
-	pHint = new String( rH );
-}
-
-ScImpExpLogMsg::ScImpExpLogMsg( const ScImpExpLogMsg& r ) : eId( r.eId )
-{
-	if( r.pPos )
-		pPos = new String( *r.pPos );
-	else
-		pPos = NULL;
-
-	if( r.pHint )
-		pHint = new String( *r.pHint );
-	else
-		pHint = NULL;
-}
-
-
-ScImpExpLogMsg::~ScImpExpLogMsg()
-{
-	if( pPos )
-		delete pPos;
-
-	if( pHint )
-		delete pHint;
-}
-
-
-void ScImpExpLogMsg::Set( ScImpExpMsg e, const String* pP, const String* pH )
-{
-	eId = e;
-	if( pPos )
-		delete pPos;
-
-	if( pHint )
-		delete pHint;
-
-	if( pP )
-		pPos = new String( *pP );
-	else
-		pPos = NULL;
-
-	if( pH )
-		pHint = new String( *pH );
-}
-
-
-String ScImpExpLogMsg::GetMsg( ScImpExpMsg e )
-{
-	const sal_Char*		p;
-	switch( e )
-	{
-		case SC_IMPEXPMSG_UNKNOWN:	p = "unknown log message";					break;
-		default:					p = "Not specified type of log message";
-	}
-
-	String	aRet;
-	aRet.AssignAscii( p );
-	return aRet;
-}
+//UNUSED2008-05  ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e ) : eId( e ), pPos( NULL ), pHint( NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e, const String& r ) : eId( e ), pHint( NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05      pPos = new String( r );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  ScImpExpLogMsg::ScImpExpLogMsg( ScImpExpMsg e, const String& rP, const String& rH ) : eId( e )
+//UNUSED2008-05  {
+//UNUSED2008-05      pPos = new String( rP );
+//UNUSED2008-05      pHint = new String( rH );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  ScImpExpLogMsg::ScImpExpLogMsg( const ScImpExpLogMsg& r ) : eId( r.eId )
+//UNUSED2008-05  {
+//UNUSED2008-05      if( r.pPos )
+//UNUSED2008-05          pPos = new String( *r.pPos );
+//UNUSED2008-05      else
+//UNUSED2008-05          pPos = NULL;
+//UNUSED2008-05  
+//UNUSED2008-05      if( r.pHint )
+//UNUSED2008-05          pHint = new String( *r.pHint );
+//UNUSED2008-05      else
+//UNUSED2008-05          pHint = NULL;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  ScImpExpLogMsg::~ScImpExpLogMsg()
+//UNUSED2008-05  {
+//UNUSED2008-05      if( pPos )
+//UNUSED2008-05          delete pPos;
+//UNUSED2008-05  
+//UNUSED2008-05      if( pHint )
+//UNUSED2008-05          delete pHint;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  void ScImpExpLogMsg::Set( ScImpExpMsg e, const String* pP, const String* pH )
+//UNUSED2008-05  {
+//UNUSED2008-05      eId = e;
+//UNUSED2008-05      if( pPos )
+//UNUSED2008-05          delete pPos;
+//UNUSED2008-05  
+//UNUSED2008-05      if( pHint )
+//UNUSED2008-05          delete pHint;
+//UNUSED2008-05  
+//UNUSED2008-05      if( pP )
+//UNUSED2008-05          pPos = new String( *pP );
+//UNUSED2008-05      else
+//UNUSED2008-05          pPos = NULL;
+//UNUSED2008-05  
+//UNUSED2008-05      if( pH )
+//UNUSED2008-05          pHint = new String( *pH );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  String ScImpExpLogMsg::GetMsg( ScImpExpMsg e )
+//UNUSED2008-05  {
+//UNUSED2008-05      const sal_Char*     p;
+//UNUSED2008-05      switch( e )
+//UNUSED2008-05      {
+//UNUSED2008-05          case SC_IMPEXPMSG_UNKNOWN:  p = "unknown log message";                  break;
+//UNUSED2008-05          default:                    p = "Not specified type of log message";
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      String  aRet;
+//UNUSED2008-05      aRet.AssignAscii( p );
+//UNUSED2008-05      return aRet;
+//UNUSED2008-05  }
 
Index: sc/source/core/data/stlpool.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/stlpool.cxx,v
retrieving revision 1.18
retrieving revision 1.18.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.32.1
--- sc/source/core/data/stlpool.cxx	10 Apr 2008 19:34:02 -0000	1.18
+++ sc/source/core/data/stlpool.cxx	13 May 2008 14:34:09 -0000	1.18.32.1
@@ -511,112 +511,112 @@
 
 //------------------------------------------------------------------------
 
-void ScStyleSheetPool::UpdateStdNames()
-{
-	//	Standard-Styles den richtigen Namen in der Programm-Sprache geben
-
-	String aHelpFile;
-	sal_uInt32 nCount = aStyles.size();
-	for (sal_uInt32 n=0; n<nCount; n++)
-	{
-		SfxStyleSheetBase* pStyle = aStyles[n].get();
-		if (!pStyle->IsUserDefined())
-		{
-			String aOldName		= pStyle->GetName();
-			ULONG nHelpId		= pStyle->GetHelpId( aHelpFile );
-			SfxStyleFamily eFam	= pStyle->GetFamily();
-
-			BOOL bHelpKnown = TRUE;
-			String aNewName;
-			USHORT nNameId = 0;
-			switch( nHelpId )
-			{
-				case HID_SC_SHEET_CELL_STD:
-				case HID_SC_SHEET_PAGE_STD:	 nNameId = STR_STYLENAME_STANDARD;	break;
-				case HID_SC_SHEET_CELL_ERG:	 nNameId = STR_STYLENAME_RESULT;	break;
-				case HID_SC_SHEET_CELL_ERG1: nNameId = STR_STYLENAME_RESULT1;	break;
-				case HID_SC_SHEET_CELL_UEB:	 nNameId = STR_STYLENAME_HEADLINE;	break;
-				case HID_SC_SHEET_CELL_UEB1: nNameId = STR_STYLENAME_HEADLINE1;	break;
-				case HID_SC_SHEET_PAGE_REP:	 nNameId = STR_STYLENAME_REPORT;	break;
-				default:
-					// 0 oder falsche (alte) HelpId
-					bHelpKnown = FALSE;
-			}
-			if (bHelpKnown)
-			{
-				if ( nNameId )
-					aNewName = SCSTR( nNameId );
-
-				if ( aNewName.Len() && aNewName != aOldName && !Find( aNewName, eFam ) )
-				{
-					DBG_TRACE( "Renaming style..." );
-
-					pStyle->SetName( aNewName );	// setzt auch Parents um
-
-					//	Styles in Patterns sind schon auf Pointer umgesetzt
-					if (eFam == SFX_STYLE_FAMILY_PAGE)
-					{
-						//	Page-Styles umsetzen
-						//	TableCount am Doc ist noch nicht initialisiert
-						for (SCTAB nTab=0; nTab<=MAXTAB && pDoc->HasTable(nTab); nTab++)
-							if (pDoc->GetPageStyle(nTab) == aOldName)
-								pDoc->SetPageStyle(nTab, aNewName);
-					}
-				}
-			}
-			else
-			{
-				//	wrong or no HelpId -> set new HelpId
-
-				//	no assertion for wrong HelpIds because this happens
-				//  with old files (#67218#) or with old files that were
-				//	saved again with a new version in a different language
-				//	(so SrcVersion doesn't help)
-
-				USHORT nNewId = 0;
-				if ( eFam == SFX_STYLE_FAMILY_PARA )
-				{
-					if ( aOldName == SCSTR( STR_STYLENAME_STANDARD ) )
-						nNewId = HID_SC_SHEET_CELL_STD;
-					else if ( aOldName == SCSTR( STR_STYLENAME_RESULT ) )
-						nNewId = HID_SC_SHEET_CELL_ERG;
-					else if ( aOldName == SCSTR( STR_STYLENAME_RESULT1 ) )
-						nNewId = HID_SC_SHEET_CELL_ERG1;
-					else if ( aOldName == SCSTR( STR_STYLENAME_HEADLINE ) )
-						nNewId = HID_SC_SHEET_CELL_UEB;
-					else if ( aOldName == SCSTR( STR_STYLENAME_HEADLINE1 ) )
-						nNewId = HID_SC_SHEET_CELL_UEB1;
-				}
-				else		// PAGE
-				{
-					if ( aOldName == SCSTR( STR_STYLENAME_STANDARD ) )
-						nNewId = HID_SC_SHEET_PAGE_STD;
-					else if ( aOldName == SCSTR( STR_STYLENAME_REPORT ) )
-						nNewId = HID_SC_SHEET_PAGE_REP;
-				}
-
-				if ( nNewId )				// new ID found from name -> set ID
-				{
-					pStyle->SetHelpId( aHelpFile, nNewId );
-				}
-				else if ( nHelpId == 0 )	// no old and no new ID
-				{
-					//	#71471# probably user defined style without SFXSTYLEBIT_USERDEF set
-					//	(from StarCalc 1.0 import), fixed in src563 and above
-					//!	may also be default style from a different language
-					//!	test if name was generated from StarCalc 1.0 import?
-					DBG_ASSERT(pDoc->GetSrcVersion() <= SC_SUBTOTAL_BUGFIX,
-								"user defined style without SFXSTYLEBIT_USERDEF");
-					pStyle->SetMask( pStyle->GetMask() | SFXSTYLEBIT_USERDEF );
-				}
-				// else: wrong old ID and no new ID found:
-				//	probably default style from a different language
-				//	-> leave unchanged (HelpId will be set if loaded with matching
-				//	language version later)
-			}
-		}
-	}
-}
+//UNUSED2008-05  void ScStyleSheetPool::UpdateStdNames()
+//UNUSED2008-05  {
+//UNUSED2008-05      //  Standard-Styles den richtigen Namen in der Programm-Sprache geben
+//UNUSED2008-05  
+//UNUSED2008-05      String aHelpFile;
+//UNUSED2008-05      sal_uInt32 nCount = aStyles.size();
+//UNUSED2008-05      for (sal_uInt32 n=0; n<nCount; n++)
+//UNUSED2008-05      {
+//UNUSED2008-05          SfxStyleSheetBase* pStyle = aStyles[n].get();
+//UNUSED2008-05          if (!pStyle->IsUserDefined())
+//UNUSED2008-05          {
+//UNUSED2008-05              String aOldName     = pStyle->GetName();
+//UNUSED2008-05              ULONG nHelpId       = pStyle->GetHelpId( aHelpFile );
+//UNUSED2008-05              SfxStyleFamily eFam = pStyle->GetFamily();
+//UNUSED2008-05  
+//UNUSED2008-05              BOOL bHelpKnown = TRUE;
+//UNUSED2008-05              String aNewName;
+//UNUSED2008-05              USHORT nNameId = 0;
+//UNUSED2008-05              switch( nHelpId )
+//UNUSED2008-05              {
+//UNUSED2008-05                  case HID_SC_SHEET_CELL_STD:
+//UNUSED2008-05                  case HID_SC_SHEET_PAGE_STD:  nNameId = STR_STYLENAME_STANDARD;  break;
+//UNUSED2008-05                  case HID_SC_SHEET_CELL_ERG:  nNameId = STR_STYLENAME_RESULT;    break;
+//UNUSED2008-05                  case HID_SC_SHEET_CELL_ERG1: nNameId = STR_STYLENAME_RESULT1;   break;
+//UNUSED2008-05                  case HID_SC_SHEET_CELL_UEB:  nNameId = STR_STYLENAME_HEADLINE;  break;
+//UNUSED2008-05                  case HID_SC_SHEET_CELL_UEB1: nNameId = STR_STYLENAME_HEADLINE1; break;
+//UNUSED2008-05                  case HID_SC_SHEET_PAGE_REP:  nNameId = STR_STYLENAME_REPORT;    break;
+//UNUSED2008-05                  default:
+//UNUSED2008-05                      // 0 oder falsche (alte) HelpId
+//UNUSED2008-05                      bHelpKnown = FALSE;
+//UNUSED2008-05              }
+//UNUSED2008-05              if (bHelpKnown)
+//UNUSED2008-05              {
+//UNUSED2008-05                  if ( nNameId )
+//UNUSED2008-05                      aNewName = SCSTR( nNameId );
+//UNUSED2008-05  
+//UNUSED2008-05                  if ( aNewName.Len() && aNewName != aOldName && !Find( aNewName, eFam ) )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      DBG_TRACE( "Renaming style..." );
+//UNUSED2008-05  
+//UNUSED2008-05                      pStyle->SetName( aNewName );    // setzt auch Parents um
+//UNUSED2008-05  
+//UNUSED2008-05                      //  Styles in Patterns sind schon auf Pointer umgesetzt
+//UNUSED2008-05                      if (eFam == SFX_STYLE_FAMILY_PAGE)
+//UNUSED2008-05                      {
+//UNUSED2008-05                          //  Page-Styles umsetzen
+//UNUSED2008-05                          //  TableCount am Doc ist noch nicht initialisiert
+//UNUSED2008-05                          for (SCTAB nTab=0; nTab<=MAXTAB && pDoc->HasTable(nTab); nTab++)
+//UNUSED2008-05                              if (pDoc->GetPageStyle(nTab) == aOldName)
+//UNUSED2008-05                                  pDoc->SetPageStyle(nTab, aNewName);
+//UNUSED2008-05                      }
+//UNUSED2008-05                  }
+//UNUSED2008-05              }
+//UNUSED2008-05              else
+//UNUSED2008-05              {
+//UNUSED2008-05                  //  wrong or no HelpId -> set new HelpId
+//UNUSED2008-05  
+//UNUSED2008-05                  //  no assertion for wrong HelpIds because this happens
+//UNUSED2008-05                  //  with old files (#67218#) or with old files that were
+//UNUSED2008-05                  //  saved again with a new version in a different language
+//UNUSED2008-05                  //  (so SrcVersion doesn't help)
+//UNUSED2008-05  
+//UNUSED2008-05                  USHORT nNewId = 0;
+//UNUSED2008-05                  if ( eFam == SFX_STYLE_FAMILY_PARA )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      if ( aOldName == SCSTR( STR_STYLENAME_STANDARD ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_CELL_STD;
+//UNUSED2008-05                      else if ( aOldName == SCSTR( STR_STYLENAME_RESULT ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_CELL_ERG;
+//UNUSED2008-05                      else if ( aOldName == SCSTR( STR_STYLENAME_RESULT1 ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_CELL_ERG1;
+//UNUSED2008-05                      else if ( aOldName == SCSTR( STR_STYLENAME_HEADLINE ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_CELL_UEB;
+//UNUSED2008-05                      else if ( aOldName == SCSTR( STR_STYLENAME_HEADLINE1 ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_CELL_UEB1;
+//UNUSED2008-05                  }
+//UNUSED2008-05                  else        // PAGE
+//UNUSED2008-05                  {
+//UNUSED2008-05                      if ( aOldName == SCSTR( STR_STYLENAME_STANDARD ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_PAGE_STD;
+//UNUSED2008-05                      else if ( aOldName == SCSTR( STR_STYLENAME_REPORT ) )
+//UNUSED2008-05                          nNewId = HID_SC_SHEET_PAGE_REP;
+//UNUSED2008-05                  }
+//UNUSED2008-05  
+//UNUSED2008-05                  if ( nNewId )               // new ID found from name -> set ID
+//UNUSED2008-05                  {
+//UNUSED2008-05                      pStyle->SetHelpId( aHelpFile, nNewId );
+//UNUSED2008-05                  }
+//UNUSED2008-05                  else if ( nHelpId == 0 )    // no old and no new ID
+//UNUSED2008-05                  {
+//UNUSED2008-05                      //  #71471# probably user defined style without SFXSTYLEBIT_USERDEF set
+//UNUSED2008-05                      //  (from StarCalc 1.0 import), fixed in src563 and above
+//UNUSED2008-05                      //! may also be default style from a different language
+//UNUSED2008-05                      //! test if name was generated from StarCalc 1.0 import?
+//UNUSED2008-05                      DBG_ASSERT(pDoc->GetSrcVersion() <= SC_SUBTOTAL_BUGFIX,
+//UNUSED2008-05                                  "user defined style without SFXSTYLEBIT_USERDEF");
+//UNUSED2008-05                      pStyle->SetMask( pStyle->GetMask() | SFXSTYLEBIT_USERDEF );
+//UNUSED2008-05                  }
+//UNUSED2008-05                  // else: wrong old ID and no new ID found:
+//UNUSED2008-05                  //  probably default style from a different language
+//UNUSED2008-05                  //  -> leave unchanged (HelpId will be set if loaded with matching
+//UNUSED2008-05                  //  language version later)
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
@@ -641,32 +641,3 @@
 	return NULL;
 }
 
-
-void ScStyleSheetPool::ConvertFontsAfterLoad()
-{
-    ScFontToSubsFontConverter_AutoPtr xFontConverter;
-    const ULONG nFlags = FONTTOSUBSFONT_IMPORT | FONTTOSUBSFONT_ONLYOLDSOSYMBOLFONTS;
-    SfxStyleSheetIterator aIter( this, SFX_STYLE_FAMILY_PARA );
-    for ( SfxStyleSheetBase* pStyle = aIter.First(); pStyle; pStyle = aIter.Next() )
-    {
-        const SfxPoolItem* pItem;
-        if( pStyle->GetItemSet().GetItemState( ATTR_FONT, FALSE, &pItem ) == SFX_ITEM_SET )
-        {
-            const SvxFontItem* pFontItem = (const SvxFontItem*) pItem;
-            const String& rOldName = pFontItem->GetFamilyName();
-            xFontConverter = CreateFontToSubsFontConverter( rOldName, nFlags );
-            if ( xFontConverter )
-            {
-                String aNewName( GetFontToSubsFontName( xFontConverter ) );
-                if ( aNewName != rOldName )
-                {
-                    SvxFontItem aNewItem( pFontItem->GetFamily(), aNewName,
-                        pFontItem->GetStyleName(), pFontItem->GetPitch(),
-                        RTL_TEXTENCODING_DONTKNOW, ATTR_FONT );
-                    pStyle->GetItemSet().Put( aNewItem );
-                }
-            }
-        }
-    }
-}
-
Index: sc/source/core/data/table1.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table1.cxx,v
retrieving revision 1.25
retrieving revision 1.25.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.30.2
--- sc/source/core/data/table1.cxx	10 Apr 2008 19:34:43 -0000	1.25
+++ sc/source/core/data/table1.cxx	12 May 2008 15:56:56 -0000	1.25.30.2
@@ -1235,10 +1235,10 @@
 	for (SCCOL i=0; i <= MAXCOL; i++) aCol[i].UpdateInsertTab(nTable);
 }
 
-void ScTable::UpdateInsertTabOnlyCells(SCTAB nTable)
-{
-	for (SCCOL i=0; i <= MAXCOL; i++) aCol[i].UpdateInsertTabOnlyCells(nTable);
-}
+//UNUSED2008-05  void ScTable::UpdateInsertTabOnlyCells(SCTAB nTable)
+//UNUSED2008-05  {
+//UNUSED2008-05      for (SCCOL i=0; i <= MAXCOL; i++) aCol[i].UpdateInsertTabOnlyCells(nTable);
+//UNUSED2008-05  }
 
 void ScTable::UpdateDeleteTab( SCTAB nTable, BOOL bIsMove, ScTable* pRefUndo )
 {
Index: sc/source/core/data/table2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table2.cxx,v
retrieving revision 1.40
retrieving revision 1.40.30.5
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.40 -r1.40.30.5
--- sc/source/core/data/table2.cxx	10 Apr 2008 19:35:09 -0000	1.40
+++ sc/source/core/data/table2.cxx	13 May 2008 14:34:09 -0000	1.40.30.5
@@ -63,10 +63,6 @@
 
 // STATIC DATA -----------------------------------------------------------
 
-void lcl_LoadRange( SvStream& rStream, ScRange** ppRange );
-void lcl_SaveRange( SvStream& rStream, const ScRange* pRange );
-
-
 
 BOOL ScTable::SetOutlineTable( const ScOutlineTable* pNewOutline )
 {
@@ -982,12 +978,12 @@
 }
 
 
-USHORT ScTable::GetErrCode( SCCOL nCol, SCROW nRow ) const
-{
-	if (ValidColRow( nCol, nRow ))
-		return aCol[nCol].GetErrCode( nRow );
-	return 0;
-}
+//UNUSED2008-05  USHORT ScTable::GetErrCode( SCCOL nCol, SCROW nRow ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      if (ValidColRow( nCol, nRow ))
+//UNUSED2008-05          return aCol[nCol].GetErrCode( nRow );
+//UNUSED2008-05      return 0;
+//UNUSED2008-05  }
 
 
 void ScTable::SetDirtyVar()
@@ -2467,20 +2463,6 @@
 }
 
 
-SCCOL ScTable::GetLastFlaggedCol() const
-{
-	if ( !pColFlags )
-		return 0;
-
-	SCCOL nLastFound = 0;
-	for (SCCOL nCol = 1; nCol <= MAXCOL; nCol++)
-        if (pColFlags[nCol] & ~CR_PAGEBREAK)
-			nLastFound = nCol;
-
-	return nLastFound;
-}
-
-
 SCROW ScTable::GetLastFlaggedRow() const
 {
 	if ( !pRowFlags )
@@ -2700,459 +2682,8 @@
 //	Datei-Operationen
 //
 
-//	Laden
-
-BOOL ScTable::Load( SvStream& rStream, USHORT /* nVersion */, ScProgress* /* pProgress */ )
-{
-	ScReadHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	USHORT i;
-
-	while (aHdr.BytesLeft() && rStream.GetError() == SVSTREAM_OK)
-	{
-		USHORT nID;
-		rStream >> nID;
-		switch (nID)
-		{
-			case SCID_COLUMNS:						//	Spalten (Daten)
-				{
-					ScMultipleReadHeader aColHdr( rStream );
-					if( nVersion >= SC_DATABYTES )
-					  while( aColHdr.BytesLeft() )
-					{
-						BYTE nCol;
-						rStream >> nCol;
-						aCol[ nCol ].Load(rStream, aColHdr);
-						if (pProgress)
-							pProgress->SetState( rStream.Tell() );
-					}
-					else
-					  for (i=0; i<=MAXCOL; i++)
-					{
-						aCol[i].Load(rStream, aColHdr);
-						if (pProgress)
-							pProgress->SetState( rStream.Tell() );
-					}
-				}
-				break;
-			case SCID_COLROWFLAGS:					//	Spalten-/Zeilenflags
-				{
-					ScReadHeader aFlagsHdr( rStream );
-
-					BYTE	nFlags;
-					USHORT	nVal;
-					short	nRep;
-
-					i=0;
-					while (i<=MAXCOL)
-					{
-						rStream >> nRep;
-						rStream >> nVal;
-						while (nRep-- && i<=MAXCOL)
-							pColWidth[i++] = nVal;
-					}
-					DBG_ASSERT(nRep==-1, "Fehler bei Spaltenbreiten");
-					i=0;
-					while (i<=MAXCOL)
-					{
-						rStream >> nRep;
-						rStream >> nFlags;
-						while (nRep-- && i<=MAXCOL)
-							pColFlags[i++] = nFlags;
-					}
-					DBG_ASSERT(nRep==-1, "Fehler bei Spaltenflags");
-					if (pProgress)
-						pProgress->SetState( rStream.Tell() );
-
-					//	aus der Datei immer soviele Zeilen laden, wie gespeichert wurden
-					SCROW nSrcMaxRow = pDocument->GetSrcMaxRow();
-
-					i=0;
-					while (i<=nSrcMaxRow)		// nSrcMaxRow und MAXROW evtl. unterschiedlich
-					{
-						rStream >> nRep;
-						rStream >> nVal;
-						while (nRep--)
-						{
-							if (i<=MAXROW)
-								pRowHeight->SetValue( i, nVal);
-							++i;
-						}
-					}
-					DBG_ASSERT(i==nSrcMaxRow+1, "Fehler bei Zeilenhoehen");
-					if (pProgress)
-						pProgress->SetState( rStream.Tell() );
-					i=0;
-					while (i<=nSrcMaxRow)		// nSrcMaxRow und MAXROW evtl. unterschiedlich
-					{
-						rStream >> nRep;
-						rStream >> nFlags;
-						while (nRep--)
-						{
-							if (i<=MAXROW)
-								pRowFlags->SetValue( i, nFlags);
-							++i;
-						}
-					}
-					DBG_ASSERT(i==nSrcMaxRow+1, "Fehler bei Zeilenflags");
-					if (pProgress)
-						pProgress->SetState( rStream.Tell() );
-				}
-				break;
-			case SCID_TABOPTIONS:					//	einzelne Einstellungen
-				{
-					ScReadHeader aFlagsHdr( rStream );
-
-					rStream.ReadByteString( aName, rStream.GetStreamCharSet() );
-
-					rStream >> bScenario;
-					rStream.ReadByteString( aComment, rStream.GetStreamCharSet() );
-
-					rStream >> bProtected;
-					String aPass;
-					rStream.ReadByteString( aPass, rStream.GetStreamCharSet() );
-					if (aPass.Len())
-						SvPasswordHelper::GetHashPassword(aProtectPass, aPass);
-
-					BOOL bOutline;
-					rStream >> bOutline;
-					if (bOutline)
-					{
-						StartOutlineTable();
-						pOutlineTable->Load( rStream );
-					}
-
-					if ( aFlagsHdr.BytesLeft() )
-					{
-						SfxStyleSheetBasePool* pStylePool =
-								pDocument->GetStyleSheetPool();
-
-						rStream.ReadByteString( aPageStyle, rStream.GetStreamCharSet() );
-
-						if ( !pStylePool->Find( aPageStyle, SFX_STYLE_FAMILY_PAGE ) )
-						{
-							DBG_TRACE( "PageStyle not found. Using Standard." );
-							aPageStyle = ScGlobal::GetRscString(STR_STYLENAME_STANDARD);
-						}
-					}
-
-					if ( aFlagsHdr.BytesLeft() )
-					{
-						BOOL bOneRange;						// einzelner Druckbereich ?
-						rStream >> bOneRange;
-						if ( bOneRange )
-						{
-							ScRange aRange;
-							rStream >> aRange;
-                            SetPrintRange( aRange );
-						}
-
-						lcl_LoadRange( rStream, &pRepeatColRange );
-						lcl_LoadRange( rStream, &pRepeatRowRange );
-					}
-
-					if ( aFlagsHdr.BytesLeft() )
-						rStream >> bVisible;
-
-					if ( aFlagsHdr.BytesLeft() )			// Druckbereiche ab Version 314c
-					{
-						USHORT nNewCount;
-						rStream >> nNewCount;
-						if ( nNewCount )
-						{
-							ScRange aTmp;
-                            ClearPrintRanges();
-							for (i=0; i<nNewCount; i++)
-							{
-								rStream >> aTmp;
-                                AddPrintRange( aTmp );
-							}
-						}
-					}
-
-					if ( aFlagsHdr.BytesLeft() )			// erweiterte Szenario-Flags ab 5.0
-					{
-						rStream >> aScenarioColor;
-						rStream >> nScenarioFlags;
-						rStream >> bActiveScenario;
-					}
-					else if ( bScenario )
-					{
-						//	Default fuer Szenarien aus alten Dateien??
-						//	Wenn die alten Szenarien wirklich benutzt wurden,
-						//	wuerde der Rahmen wahrscheinlich stoeren.
-
-						nScenarioFlags = SC_SCENARIO_COPYALL;
-					}
-
-					if (pProgress)
-						pProgress->SetState( rStream.Tell() );
-				}
-				break;
-			case SCID_TABLINK:						//	Verknuepfung
-				{
-					ScReadHeader aLinkHdr( rStream );
-
-					rStream >> nLinkMode;
-					rStream.ReadByteString( aLinkDoc, rStream.GetStreamCharSet() );
-					aLinkDoc = INetURLObject::RelToAbs( aLinkDoc );
-					rStream.ReadByteString( aLinkFlt, rStream.GetStreamCharSet() );
-					rStream.ReadByteString( aLinkTab, rStream.GetStreamCharSet() );
-
-					BOOL bRelURL;
-					if ( aLinkHdr.BytesLeft() )
-						rStream >> bRelURL;
-					else
-						bRelURL = FALSE;
-					// externer Tabellenname relativ zu absolut
-					if ( nLinkMode == SC_LINK_VALUE && bRelURL )
-						aName = ScGlobal::GetDocTabName( aLinkDoc, aLinkTab );
-
-					if ( aLinkHdr.BytesLeft() )		// ab 336 auch Filter-Optionen
-						rStream.ReadByteString( aLinkOpt, rStream.GetStreamCharSet() );
-				}
-				break;
-			default:
-				{
-					DBG_ERROR("unbekannter Sub-Record in ScTable::Load");
-					ScReadHeader aDummyHeader( rStream );
-				}
-		}
-	}
-
-	//	Neuberechnungen
-
-	ScDrawLayer* pDrawLayer = pDocument->GetDrawLayer();
-	if (pDrawLayer)
-		pDrawLayer->ScRenamePage( nTab, aName );
-
-	return TRUE;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
 //	Speichern
 
-
-void lcl_SaveValue( SvStream& rStream, USHORT* pValue, USHORT nEnd )
-{
-	USHORT nPos = 0;
-	while (nPos<=nEnd)
-	{
-		USHORT nVal = pValue[nPos];
-		USHORT nNextPos = nPos+1;
-		while (nNextPos<=nEnd && pValue[nNextPos]==nVal)
-			++nNextPos;
-		rStream << (USHORT)( nNextPos - nPos );
-		rStream << nVal;
-		nPos = nNextPos;
-	}
-}
-
-
-void lcl_SaveFlags( SvStream& rStream, BYTE* pValue, USHORT nEnd )
-{
-	USHORT nPos = 0;
-	while (nPos<=nEnd)
-	{
-		BYTE nVal = pValue[nPos] & CR_SAVEMASK;
-		USHORT nNextPos = nPos+1;
-		while (nNextPos<=nEnd && (pValue[nNextPos] & CR_SAVEMASK)==nVal)
-			++nNextPos;
-		rStream << (USHORT)( nNextPos - nPos );
-		rStream << nVal;
-		nPos = nNextPos;
-	}
-}
-
-
-void lcl_LoadRange( SvStream& /* rStream */, ScRange** ppRange )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	BOOL bIsSet = FALSE;
-
-	rStream >> bIsSet;
-
-	if ( bIsSet )
-	{
-		*ppRange = new ScRange;
-		rStream >> **ppRange;
-	}
-	else
-		*ppRange = NULL;
-#else
-    *ppRange = NULL;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
-void lcl_SaveRange( SvStream& /* rStream */, const ScRange* /* pRange */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	if ( pRange )
-	{
-		rStream << (BOOL)TRUE;
-		rStream << *pRange;
-	}
-	else
-		rStream << (BOOL)FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
-BOOL ScTable::Save( SvStream& rStream, long& /* rSavedDocCells */, ScProgress* /* pProgress */ ) const
-{
-	ScWriteHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	USHORT i;
-
-	//	Spalten (Daten)
-
-	{
-		rStream << (USHORT) SCID_COLUMNS;
-		ScMultipleWriteHeader aColHdr( rStream );
-
-		for (i=0; i<=MAXCOL; i++)
-		{
-			const ScColumn* pCol = &aCol[ i ];
-			if( !pCol->IsEmptyData() || pCol->NoteCount() || !pCol->IsEmptyAttr())
-			{
-				rStream << (BYTE) i;
-				aCol[i].Save(rStream, aColHdr);
-				rSavedDocCells += aCol[i].GetWeightedCount();
-				if (pProgress)
-					pProgress->SetState( rSavedDocCells );
-			}
-		}
-	}
-
-	//	Spalten-/Zeilenflags
-
-	{
-		rStream << (USHORT) SCID_COLROWFLAGS;
-		ScWriteHeader aFlagsHdr( rStream );
-
-		SCROW nSaveMaxRow = pDocument->GetSrcMaxRow();
-
-		lcl_SaveValue( rStream, pColWidth, MAXCOL );
-		lcl_SaveFlags( rStream, pColFlags, MAXCOL );
-		lcl_SaveValue( rStream, pRowHeight,nSaveMaxRow );
-		lcl_SaveFlags( rStream, pRowFlags, nSaveMaxRow );
-
-		//	wenn dabei weniger Zeilenhoehen als vorhanden gespeichert wurden,
-		//	gibt das noch keine Warnung wegen Datenverlust.
-	}
-
-	BOOL bRelURL = FALSE;
-	String aLinkDocSaveName( aLinkDoc );
-	String aSaveName( aName );
-	if ( nLinkMode )
-	{
-		aLinkDocSaveName = INetURLObject::AbsToRel( aLinkDocSaveName );
-		aLinkDocSaveName = INetURLObject::decode( aLinkDocSaveName,
-			INET_HEX_ESCAPE, INetURLObject::DECODE_UNAMBIGUOUS );
-        if ( ScGlobal::pTransliteration->isEqual( aLinkDocSaveName,
-                INetURLObject::decode( aLinkDoc, INET_HEX_ESCAPE,
-                INetURLObject::DECODE_UNAMBIGUOUS ) ) )
-		{
-			aSaveName = INetURLObject::decode( aSaveName,
-				INET_HEX_ESCAPE, INetURLObject::DECODE_UNAMBIGUOUS );
-		}
-		else
-		{
-			bRelURL = TRUE;
-			// Reference to external sheet, only the sheet name is stored
-			// instead of the absolute DocTabName, will be reconcatenated upon
-			// load time.
-			if ( nLinkMode == SC_LINK_VALUE )
-				aSaveName = aLinkTab;
-		}
-	}
-
-	//	einzelne Einstellungen
-
-	{
-		rStream << (USHORT) SCID_TABOPTIONS;
-		ScWriteHeader aFlagsHdr( rStream );
-
-		rStream.WriteByteString( aSaveName, rStream.GetStreamCharSet() );
-
-		rStream << bScenario;
-		rStream.WriteByteString( aComment, rStream.GetStreamCharSet() );
-
-		rStream << bProtected;
-		String aPass;
-		//rStream.WriteByteString( aProtectPass, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( aPass, rStream.GetStreamCharSet() );
-
-		BOOL bOutline = ( pOutlineTable != NULL );
-		rStream << bOutline;
-		if (bOutline)
-			pOutlineTable->Store( rStream );
-
-		rStream.WriteByteString( aPageStyle, rStream.GetStreamCharSet() );
-
-        if ( GetPrintRangeCount() == 1 )                    // kompatibel zu alten Versionen
-            lcl_SaveRange( rStream, &aPrintRanges[0] );     // (nur wenn genau ein Bereich)
-		else
-			lcl_SaveRange( rStream, NULL );
-		lcl_SaveRange( rStream, pRepeatColRange );
-		lcl_SaveRange( rStream, pRepeatRowRange );
-
-		rStream << bVisible;
-
-        if ( GetPrintRangeCount() > 1 )                     // einzelner Bereich schon oben
-		{
-            rStream << GetPrintRangeCount();                // ab Version 314c
-            if ( GetPrintRangeCount() > 1 )
-                for ( i=0; i<GetPrintRangeCount(); i++)
-                    rStream << aPrintRanges[i];
-		}
-		else
-			rStream << (USHORT) 0;
-
-		if( rStream.GetVersion() > SOFFICE_FILEFORMAT_40 )	// erweiterte Szenario-Flags ab 5.0
-		{
-			rStream << aScenarioColor;
-			rStream << nScenarioFlags;
-			rStream << bActiveScenario;
-		}
-	}
-
-	//	Verknuepfung
-
-	if (nLinkMode)
-	{
-		rStream << (USHORT) SCID_TABLINK;
-		ScWriteHeader aLinkHdr( rStream );
-
-		//	Hack, um verknuepfte Tabellen mit der 3.1 laden zu koennen (#35242#)
-		//	bei 3.1 Export Filter von "StarCalc 4.0" auf "StarCalc 3.0" umsetzen
-		//	(4.0 Dateien koennen vom Calc 3.1 gelesen werden)
-		String aSaveFlt = aLinkFlt;
-		if ( rStream.GetVersion() == SOFFICE_FILEFORMAT_31 && aSaveFlt.EqualsAscii("StarCalc 4.0") )
-			aSaveFlt.AssignAscii(RTL_CONSTASCII_STRINGPARAM("StarCalc 3.0"));
-
-		rStream	<< nLinkMode;
-		rStream.WriteByteString( aLinkDocSaveName, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( aSaveFlt, rStream.GetStreamCharSet() );
-		rStream.WriteByteString( aLinkTab, rStream.GetStreamCharSet() );
-		rStream	<< bRelURL;
-		rStream.WriteByteString( aLinkOpt, rStream.GetStreamCharSet() );
-	}
-
-	return TRUE;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
 									//	CopyData - fuer Query in anderen Bereich
 
 void ScTable::CopyData( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
Index: sc/source/core/data/table4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table4.cxx,v
retrieving revision 1.23
retrieving revision 1.23.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.32.1
--- sc/source/core/data/table4.cxx	10 Apr 2008 19:35:56 -0000	1.23
+++ sc/source/core/data/table4.cxx	13 May 2008 14:34:09 -0000	1.23.32.1
@@ -1897,13 +1897,13 @@
 		aCol[i].UpdateInsertTabAbs(nTable);
 }
 
-USHORT ScTable::GetErrorData( SCCOL nCol, SCROW nRow ) const
-{
-	if (ValidColRow(nCol,nRow))
-		return aCol[nCol].GetErrorData( nRow );
-	else
-		return 0;
-}
+//UNUSED2008-05  USHORT ScTable::GetErrorData( SCCOL nCol, SCROW nRow ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      if (ValidColRow(nCol,nRow))
+//UNUSED2008-05          return aCol[nCol].GetErrorData( nRow );
+//UNUSED2008-05      else
+//UNUSED2008-05          return 0;
+//UNUSED2008-05  }
 
 BOOL ScTable::GetNextSpellingCell(SCCOL& rCol, SCROW& rRow, BOOL bInSel,
 									const ScMarkData& rMark) const
Index: sc/source/core/data/validat.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/validat.cxx,v
retrieving revision 1.23
retrieving revision 1.23.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.30.3
--- sc/source/core/data/validat.cxx	10 Apr 2008 19:37:10 -0000	1.23
+++ sc/source/core/data/validat.cxx	13 May 2008 03:45:32 -0000	1.23.30.3
@@ -128,76 +128,10 @@
 	//	Formeln wirklich kopiert
 }
 
-ScValidationData::ScValidationData( SvStream& rStream, ScMultipleReadHeader& rHdr,
-									ScDocument* pDocument ) :
-    ScConditionEntry( rStream, rHdr, pDocument ),
-    mnListType( ValidListType::UNSORTED )   // not imported/exported
-{
-	//	im Datei-Header sind getrennte Eintraege fuer ScConditionEntry und ScValidationData
-
-	rHdr.StartEntry();
-
-	//	1) Key
-	//	2) eDataMode
-	//	3) bShowInput
-	//	4) aInputTitle
-	//	5) aInputMessage
-	//	6) bShowError
-	//	7) aErrorTitle
-	//	8) aErrorMessage
-	//	9) eErrorStyle
-
-	USHORT nDummy;
-	rStream >> nKey;
-	rStream >> nDummy;
-	eDataMode = (ScValidationMode) nDummy;
-	rStream >> bShowInput;
-	rStream.ReadByteString( aInputTitle, rStream.GetStreamCharSet() );
-	rStream.ReadByteString( aInputMessage, rStream.GetStreamCharSet() );
-	rStream >> bShowError;
-	rStream.ReadByteString( aErrorTitle, rStream.GetStreamCharSet() );
-	rStream.ReadByteString( aErrorMessage, rStream.GetStreamCharSet() );
-	rStream >> nDummy;
-	eErrorStyle = (ScValidErrorStyle) nDummy;
-
-	rHdr.EndEntry();
-}
-
 ScValidationData::~ScValidationData()
 {
 }
 
-void ScValidationData::Store(SvStream& rStream, ScMultipleWriteHeader& rHdr) const
-{
-	//	im Datei-Header sind getrennte Eintraege fuer ScConditionEntry und ScValidationData
-
-	StoreCondition( rStream, rHdr );
-
-	rHdr.StartEntry();
-
-	//	1) Key
-	//	2) eDataMode
-	//	3) bShowInput
-	//	4) aInputTitle
-	//	5) aInputMessage
-	//	6) bShowError
-	//	7) aErrorTitle
-	//	8) aErrorMessage
-	//	9) eErrorStyle
-
-	rStream << nKey;
-	rStream << (USHORT) eDataMode;
-	rStream << bShowInput;
-	rStream.WriteByteString( aInputTitle, rStream.GetStreamCharSet() );
-	rStream.WriteByteString( aInputMessage, rStream.GetStreamCharSet() );
-	rStream << bShowError;
-	rStream.WriteByteString( aErrorTitle, rStream.GetStreamCharSet() );
-	rStream.WriteByteString( aErrorMessage, rStream.GetStreamCharSet() );
-	rStream << (USHORT) eErrorStyle;
-
-	rHdr.EndEntry();
-}
-
 BOOL ScValidationData::IsEmpty() const
 {
 	String aEmpty;
@@ -974,41 +908,6 @@
 	return NULL;
 }
 
-void ScValidationDataList::Load( SvStream& rStream, ScDocument* pDocument )
-{
-	ScMultipleReadHeader aHdr( rStream );
-
-	USHORT nNewCount;
-	rStream >> nNewCount;
-
-	for (USHORT i=0; i<nNewCount; i++)
-	{
-		ScValidationData* pNew = new ScValidationData( rStream, aHdr, pDocument );
-		InsertNew( pNew );
-	}
-}
-
-void ScValidationDataList::Store( SvStream& rStream ) const
-{
-	USHORT i;
-	ScMultipleWriteHeader aHdr( rStream );
-
-	USHORT nCount = Count();
-	USHORT nUsed = 0;
-	for (i=0; i<nCount; i++)
-		if ((*this)[i]->IsUsed())
-			++nUsed;
-
-	rStream << nUsed;		// Anzahl der gespeicherten
-
-	for (i=0; i<nCount; i++)
-	{
-		const ScValidationData* pForm = (*this)[i];
-		if (pForm->IsUsed())
-			pForm->Store( rStream, aHdr );
-	}
-}
-
 void ScValidationDataList::ResetUsed()
 {
 	USHORT nCount = Count();
Index: sc/source/core/inc/addinhelpid.hxx
===================================================================
RCS file: /cvs/sc/sc/source/core/inc/addinhelpid.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/core/inc/addinhelpid.hxx	10 Apr 2008 19:37:28 -0000	1.4
+++ sc/source/core/inc/addinhelpid.hxx	9 May 2008 21:22:40 -0000	1.4.32.1
@@ -45,8 +45,8 @@
     const ScUnoAddInHelpId*     pCurrHelpIds;       /// Array of function names and help IDs.
     sal_uInt32                  nArrayCount;        /// Count of array entries.
 
+    ScUnoAddInHelpIdGenerator(); // disabled
 public:
-                                ScUnoAddInHelpIdGenerator();
                                 ScUnoAddInHelpIdGenerator( const ::rtl::OUString& rServiceName );
 
     /** Sets service name of the AddIn. Has to be done before requesting help IDs. */
Index: sc/source/core/inc/ddelink.hxx
===================================================================
RCS file: /cvs/sc/sc/source/core/inc/ddelink.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.1
--- sc/source/core/inc/ddelink.hxx	10 Apr 2008 19:39:21 -0000	1.11
+++ sc/source/core/inc/ddelink.hxx	9 May 2008 16:11:47 -0000	1.11.32.1
@@ -72,7 +72,6 @@
 											// von SvBaseLink ueberladen:
 	virtual void	DataChanged( const String& rMimeType,
 								const ::com::sun::star::uno::Any & rValue );
-	void			NewData(SCSIZE nCols, SCSIZE nRows);
 
 											// von SvtBroadcaster ueberladen:
 	virtual void	ListenersGone();
Index: sc/source/core/inc/interpre.hxx
===================================================================
RCS file: /cvs/sc/sc/source/core/inc/interpre.hxx,v
retrieving revision 1.33
retrieving revision 1.33.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.32.1
--- sc/source/core/inc/interpre.hxx	10 Apr 2008 19:39:43 -0000	1.33
+++ sc/source/core/inc/interpre.hxx	9 May 2008 16:11:47 -0000	1.33.32.1
@@ -329,7 +329,6 @@
 void ScTableOp();                                       // Mehrfachoperationen
 void ScErrCell();                                       // Sonderbehandlung
                                                         // Fehlerzelle
-void ScDefPar();                                        // DefaultParameter
 //-----------------------------allgemeine Hilfsfunktionen
 void SetMaxIterationCount(USHORT n);
 inline void CurFmtToFuncFmt()
@@ -610,8 +609,6 @@
 void ScMatValue();
 void MEMat(ScMatrix* mM, SCSIZE n);
 void MFastMult(ScMatrix* pA, ScMatrix* pB, ScMatrix* pR, SCSIZE n, SCSIZE m, SCSIZE l);
-void MFastSub(ScMatrix* pA, ScMatrix* pB, ScMatrix* pR, SCSIZE n, SCSIZE m);
-void MFastTrans(ScMatrix* pA, ScMatrix* pR, SCSIZE n, SCSIZE m);
 void ScMatDet();
 void ScMatInv();
 void ScMatMult();
Index: sc/source/core/inc/refupdat.hxx
===================================================================
RCS file: /cvs/sc/sc/source/core/inc/refupdat.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/core/inc/refupdat.hxx	10 Apr 2008 19:41:16 -0000	1.5
+++ sc/source/core/inc/refupdat.hxx	13 May 2008 14:34:09 -0000	1.5.32.1
@@ -97,8 +97,10 @@
 								const ScRange& rArea, SCCOL nGrowX, SCROW nGrowY,
 								ComplRefData& rRef );
 
+#if OLD_PIVOT_IMPLEMENTATION
 	static ScRefUpdateRes DoGrow( const ScRange& rArea, SCCOL nGrowX, SCROW nGrowY,
 								ScRange& rRef );
+#endif
 };
 
 
Index: sc/source/core/tool/addinhelpid.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/addinhelpid.cxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/source/core/tool/addinhelpid.cxx	10 Apr 2008 19:45:02 -0000	1.5
+++ sc/source/core/tool/addinhelpid.cxx	12 May 2008 15:56:57 -0000	1.5.32.2
@@ -169,11 +169,11 @@
 
 // ============================================================================
 
-ScUnoAddInHelpIdGenerator::ScUnoAddInHelpIdGenerator() :
-    pCurrHelpIds( NULL ),
-    nArrayCount( 0 )
-{
-}
+//UNUSED2008-05  ScUnoAddInHelpIdGenerator::ScUnoAddInHelpIdGenerator() :
+//UNUSED2008-05  pCurrHelpIds( NULL ),
+//UNUSED2008-05  nArrayCount( 0 )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScUnoAddInHelpIdGenerator::ScUnoAddInHelpIdGenerator( const ::rtl::OUString& rServiceName )
 {
Index: sc/source/core/tool/address.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/address.cxx,v
retrieving revision 1.11
retrieving revision 1.11.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.30.2
--- sc/source/core/tool/address.cxx	10 Apr 2008 19:45:36 -0000	1.11
+++ sc/source/core/tool/address.cxx	9 May 2008 21:22:40 -0000	1.11.30.2
@@ -924,25 +924,6 @@
     }
 }
 
-
-void ScRange::ExtendOne()
-{
-    //  Range fuer Rahmen etc. in X und Y Richtung um 1 erweitern
-
-    SCCOLROW nVal;
-
-    if ((nVal = aStart.Col()) > 0)
-        aStart.SetCol(static_cast<SCCOL>(nVal-1));
-    if ((nVal = aStart.Row()) > 0)
-        aStart.SetRow(nVal-1);
-
-    if ((nVal = aEnd.Col()) < MAXCOL)
-        aEnd.SetCol(static_cast<SCCOL>(nVal+1));
-    if ((nVal = aEnd.Row()) < MAXROW)
-        aEnd.SetRow(nVal+1);
-}
-
-
 void ScRange::ExtendTo( const ScRange& rRange )
 {
     DBG_ASSERT( rRange.IsValid(), "ScRange::ExtendTo - cannot extend to invalid range" );
@@ -1559,21 +1540,6 @@
 }
 
 
-// --- moved from ScTripel -----------------------------------------------
-
-String ScAddress::GetText() const
-{
-    String aString('(');
-    aString += String::CreateFromInt32( nCol );
-    aString += ',';
-    aString += String::CreateFromInt32( nRow );
-    aString += ',';
-    aString += String::CreateFromInt32( nTab );
-    aString += ')';
-    return aString;
-}
-
-
 String ScAddress::GetColRowString( bool bAbsolute,
                                    const Details& rDetails ) const
 {
Index: sc/source/core/tool/appoptio.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/appoptio.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/core/tool/appoptio.cxx	10 Apr 2008 19:46:10 -0000	1.12
+++ sc/source/core/tool/appoptio.cxx	9 May 2008 02:03:26 -0000	1.12.32.2
@@ -143,117 +143,6 @@
 
 //------------------------------------------------------------------------
 
-SvStream& operator>>( SvStream& rStream, ScAppOptions& rOpt )
-{
-	rOpt.SetDefaults();
-
-	ScReadHeader aHdr( rStream );
-
-	BYTE n;
-	rStream >> n; rOpt.eMetric = (FieldUnit)n;
-
-	if ( aHdr.BytesLeft() )
-	{
-		rStream >> n; rOpt.nLRUFuncCount = (USHORT)n;
-
-		delete [] rOpt.pLRUList;
-		rOpt.pLRUList = new USHORT[rOpt.nLRUFuncCount];
-
-		for ( USHORT i=0; i<rOpt.nLRUFuncCount; i++ )
-			rStream >> rOpt.pLRUList[i];
-	}
-
-	// ab 31.10.95: globale benutzerdefinierte Listen einlesen :-/
-	//              (kleiner Hack :-/)
-	if ( aHdr.BytesLeft() )
-	{
-		ScUserList* pUserList = ScGlobal::GetUserList();
-		pUserList->Load( rStream );
-	}
-
-	// ab 11.12.95 (304)
-	// Zoom-Faktor
-	if ( aHdr.BytesLeft() )
-	{
-		USHORT e;
-		rStream >> e; rOpt.eZoomType = (SvxZoomType)e;
-		rStream >> rOpt.nZoom;
-	}
-
-	// ab 23.5.96: Funktion fuer Statusbar-Controller, Flag fuer Auto-Eingabe
-	if ( aHdr.BytesLeft() )
-	{
-		rStream >> rOpt.nStatusFunc;
-		rStream >> rOpt.bAutoComplete;
-	}
-
-	// ab 15.3.98: Farben fuer Change-Tracking
-	if ( aHdr.BytesLeft() )
-	{
-		rStream >> rOpt.nTrackContentColor;
-		rStream >> rOpt.nTrackInsertColor;
-		rStream >> rOpt.nTrackDeleteColor;
-		rStream >> rOpt.nTrackMoveColor;
-	}
-
-	// ab 22.6.98: Automatisches Detektiv-Update
-	if ( aHdr.BytesLeft() )
-		rStream >> rOpt.bDetectiveAuto;
-
-	if ( aHdr.BytesLeft() )
-	{
-		BYTE nLinkMode;
-		rStream >> nLinkMode;
-		rOpt.eLinkMode=(ScLkUpdMode) nLinkMode;
-	}
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-SvStream& operator<<( SvStream& rStream, const ScAppOptions& rOpt )
-{
-	ScWriteHeader aHdr( rStream, 25 );
-
-	rStream << (BYTE)rOpt.eMetric;
-	rStream << (BYTE)rOpt.nLRUFuncCount;
-
-	if ( rOpt.nLRUFuncCount > 0 )
-	{
-		for ( USHORT i=0; i<rOpt.nLRUFuncCount; i++ )
-			rStream << rOpt.pLRUList[i];
-	}
-
-	// ab 31.10.95: globale benutzerdefinierte Listen speichern
-	//              (kleiner Hack :-/)
-	ScUserList* pUserList = ScGlobal::GetUserList();
-	pUserList->Store( rStream );
-
-	// ab 11.12.95 (304)
-	// Zoom-Faktor
-	rStream << (USHORT)rOpt.eZoomType;
-	rStream << rOpt.nZoom;
-
-	// ab 23.5.96: Funktion fuer Statusbar-Controller, Flag fuer Auto-Eingabe
-	rStream << rOpt.nStatusFunc;
-	rStream << rOpt.bAutoComplete;
-
-	// ab 15.3.98: Farben fuer Change-Tracking
-	rStream << rOpt.nTrackContentColor;
-	rStream << rOpt.nTrackInsertColor;
-	rStream << rOpt.nTrackDeleteColor;
-	rStream << rOpt.nTrackMoveColor;
-
-	// ab 22.6.98: Automatisches Detektiv-Update
-	rStream << rOpt.bDetectiveAuto;
-	rStream << (BYTE) rOpt.eLinkMode;
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
 void ScAppOptions::SetLRUFuncList( const USHORT* pList,	const USHORT nCount )
 {
 	delete [] pLRUList;
Index: sc/source/core/tool/autoform.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/autoform.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.3
--- sc/source/core/tool/autoform.cxx	10 Apr 2008 19:46:27 -0000	1.22
+++ sc/source/core/tool/autoform.cxx	14 May 2008 01:52:08 -0000	1.22.32.3
@@ -606,11 +606,6 @@
     return GetField( nIndex ).GetNumFormat();
 }
 
-void ScAutoFormatData::SetNumFormat( USHORT nIndex, const ScNumFormatAbbrev& rNumFormat )
-{
-    GetField( nIndex ).SetNumFormat( rNumFormat );
-}
-
 BOOL ScAutoFormatData::IsEqualData( USHORT nIndex1, USHORT nIndex2 ) const
 {
 	BOOL bEqual = TRUE;
Index: sc/source/core/tool/callform.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/callform.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.1
--- sc/source/core/tool/callform.cxx	10 Apr 2008 19:46:44 -0000	1.12
+++ sc/source/core/tool/callform.cxx	9 May 2008 04:45:56 -0000	1.12.32.1
@@ -419,21 +419,6 @@
 
 //------------------------------------------------------------------------
 
-BOOL FuncData::Advice( AdvData pfCallback )
-{
-	BOOL bRet = FALSE;
-    osl::Module* pLib = pModuleData->GetInstance();
-    FARPROC fProc = (FARPROC)pLib->getFunctionSymbol(LIBFUNCNAME(ADVICE));
-	if (fProc != NULL)
-	{
-		((::Advice)fProc)(nNumber, pfCallback);
-		bRet = TRUE;
-	}
-	return bRet;
-}
-
-//------------------------------------------------------------------------
-
 BOOL FuncData::Unadvice( double nHandle )
 {
 	BOOL bRet = FALSE;
Index: sc/source/core/tool/chartarr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chartarr.cxx,v
retrieving revision 1.24
retrieving revision 1.24.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.24 -r1.24.32.3
--- sc/source/core/tool/chartarr.cxx	10 Apr 2008 19:47:34 -0000	1.24
+++ sc/source/core/tool/chartarr.cxx	13 May 2008 14:34:10 -0000	1.24.32.3
@@ -106,14 +106,6 @@
 {
 }
 
-ScChartArray::ScChartArray( ScDocument* pDoc, SvStream& rStream, ScMultipleReadHeader& rHdr ) :
-		pDocument( pDoc ),
-        aPositioner(pDoc),
-		bValid( TRUE )
-{
-    aName = aPositioner.ReadStream(rStream, rHdr);
-}
-
 ScChartArray::~ScChartArray()
 {
 }
@@ -604,21 +596,3 @@
 	return TRUE;
 }
 
-BOOL ScChartCollection::Load( ScDocument* pDoc, SvStream& rStream )
-{
-	BOOL bSuccess = TRUE;
-	USHORT nNewCount;
-	FreeAll();
-
-	ScMultipleReadHeader aHdr( rStream );
-
-	rStream >> nNewCount;
-
-	for (USHORT i=0; i<nNewCount && bSuccess; i++)
-	{
-		ScChartArray* pObject = new ScChartArray( pDoc, rStream, aHdr );
-		bSuccess = Insert( pObject );
-	}
-	return bSuccess;
-}
-
Index: sc/source/core/tool/chartpos.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chartpos.cxx,v
retrieving revision 1.4
retrieving revision 1.4.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.2
--- sc/source/core/tool/chartpos.cxx	10 Apr 2008 19:48:30 -0000	1.4
+++ sc/source/core/tool/chartpos.cxx	13 May 2008 18:34:58 -0000	1.4.32.2
@@ -40,20 +40,6 @@
 #include "rechead.hxx"
 
 
-ScChartPositioner::ScChartPositioner( ScDocument* pDoc) :
-		pDocument( pDoc ),
-		pPositionMap( NULL ),
-		eGlue( SC_CHARTGLUE_NA ),
-		nStartCol(0),
-		nStartRow(0),
-		bColHeaders( FALSE ),
-		bRowHeaders( FALSE ),
-		bDummyUpperLeft( FALSE )
-{
-	SetRangeList( ScRange( 0, 0, 0, 0, 0, 0 ) );
-	CheckColRowHeaders();
-}
-
 ScChartPositioner::ScChartPositioner( ScDocument* pDoc, SCTAB nTab,
 					SCCOL nStartColP, SCROW nStartRowP, SCCOL nEndColP, SCROW nEndRowP) :
 		pDocument( pDoc ),
@@ -102,31 +88,6 @@
 	delete pPositionMap;
 }
 
-String ScChartPositioner::ReadStream( SvStream& rStream, ScMultipleReadHeader& rHdr )
-{
-    String aName;
-	SCCOL nCol2;
-	SCROW nRow2;
-	SCTAB nTable;
-
-	rHdr.StartEntry();
-
-	rStream >> nTable;
-	rStream >> nStartCol;
-	rStream >> nStartRow;
-	rStream >> nCol2;
-	rStream >> nRow2;
-	rStream.ReadByteString( aName, rStream.GetStreamCharSet() );
-	rStream >> bColHeaders;
-	rStream >> bRowHeaders;
-
-	rHdr.EndEntry();
-
-	SetRangeList( ScRange( nStartCol, nStartRow, nTable, nCol2, nRow2, nTable ) );
-
-    return aName;
-}
-
 BOOL ScChartPositioner::operator==(const ScChartPositioner& rCmp) const
 {
 	return bColHeaders == rCmp.bColHeaders
@@ -134,17 +95,6 @@
 		&& *aRangeListRef == *rCmp.aRangeListRef;
 }
 
-BOOL ScChartPositioner::IsAtCursor(const ScAddress& rPos) const
-{
-	for ( ScRangePtr pR = aRangeListRef->First(); pR;
-					 pR = aRangeListRef->Next() )
-	{
-		if ( pR->In( rPos ) )
-			return TRUE;
-	}
-	return FALSE;
-}
-
 void ScChartPositioner::SetRangeList( const ScRange& rRange )
 {
 	aRangeListRef = new ScRangeList;
@@ -152,28 +102,6 @@
 	InvalidateGlue();
 }
 
-void ScChartPositioner::AddToRangeList( const ScRange& rRange )
-{
-	if ( aRangeListRef.Is() )
-		aRangeListRef->Append( rRange );
-	else
-		SetRangeList( rRange );
-	InvalidateGlue();
-}
-
-void ScChartPositioner::AddToRangeList( const ScRangeListRef& rAdd )
-{
-	if ( aRangeListRef.Is() )
-	{
-		ULONG nCount = rAdd->Count();
-		for (ULONG i=0; i<nCount; i++)
-			aRangeListRef->Join( *rAdd->GetObject(i) );
-	}
-	else
-		SetRangeList( rAdd );
-	InvalidateGlue();
-}
-
 void ScChartPositioner::GlueState()
 {
 	if ( eGlue != SC_CHARTGLUE_NA )
Index: sc/source/core/tool/chgtrack.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chgtrack.cxx,v
retrieving revision 1.31
retrieving revision 1.31.28.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.28.4
--- sc/source/core/tool/chgtrack.cxx	15 Apr 2008 14:12:07 -0000	1.31
+++ sc/source/core/tool/chgtrack.cxx	14 May 2008 01:52:08 -0000	1.31.28.4
@@ -377,19 +377,6 @@
 }
 
 
-void ScChangeAction::RemoveLink( ScChangeAction* p )
-{
-	ScChangeActionLinkEntry* pL = pLinkAny;
-	while ( pL )
-	{
-		ScChangeActionLinkEntry* pNextLink = pL->GetNext();
-		if ( pL->GetAction() == p )
-			delete pL;
-		pL = pNextLink;
-	}
-}
-
-
 void ScChangeAction::RemoveAllAnyLinks()
 {
 	while ( pLinkAny )
@@ -397,19 +384,6 @@
 }
 
 
-BOOL ScChangeAction::DependsOn( ScChangeAction* p ) const
-{
-	ScChangeActionLinkEntry* pL = pLinkAny;
-	while ( pL )
-	{
-		if ( pL->GetAction() == p )
-			return TRUE;
-		pL = pL->GetNext();
-	}
-	return FALSE;
-}
-
-
 BOOL ScChangeAction::RemoveDeletedIn( const ScChangeAction* p )
 {
 	BOOL bRemoved = FALSE;
@@ -495,24 +469,6 @@
 }
 
 
-BOOL ScChangeAction::RemoveDeleted( const ScChangeAction* p )
-{
-	BOOL bRemoved = FALSE;
-	ScChangeActionLinkEntry* pL = pLinkDeleted;
-	while ( pL )
-	{
-		ScChangeActionLinkEntry* pNextLink = pL->GetNext();
-		if ( pL->GetAction() == p )
-		{
-			delete pL;
-			bRemoved = TRUE;
-		}
-		pL = pNextLink;
-	}
-	return bRemoved;
-}
-
-
 void ScChangeAction::RemoveAllDeleted()
 {
 	while ( pLinkDeleted )
@@ -520,19 +476,6 @@
 }
 
 
-void ScChangeAction::RemoveDependent( ScChangeAction* p )
-{
-	ScChangeActionLinkEntry* pL = pLinkDependent;
-	while ( pL )
-	{
-		ScChangeActionLinkEntry* pNextLink = pL->GetNext();
-		if ( pL->GetAction() == p )
-			delete pL;
-		pL = pNextLink;
-	}
-}
-
-
 void ScChangeAction::RemoveAllDependent()
 {
 	while ( pLinkDependent )
@@ -1312,23 +1255,6 @@
 		delete pLinkMove;
 }
 
-
-BOOL ScChangeActionDel::Store( SvStream& /* rStrm */, ScMultipleWriteHeader& /* rHdr */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	BOOL bOk = ScChangeAction::Store( rStrm, rHdr );
-	rStrm << (UINT32) ( pCutOff ? pCutOff->GetActionNumber() : 0 );
-	rStrm << (INT16) nCutOff;
-	rStrm << (INT16) nDx;
-	rStrm << (INT16) nDy;
-	return bOk;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
 BOOL ScChangeActionDel::StoreLinks( SvStream& rStrm ) const
 {
 	BOOL bOk = ScChangeAction::StoreLinks( rStrm );
@@ -3884,21 +3810,6 @@
 }
 
 
-ScChangeActionContent* ScChangeTrack::SearchGeneratedDelContentAt(
-		const ScBigAddress& rPos, ScChangeActionType eNotInDelType ) const
-{
-	for ( ScChangeAction* p = pFirstGeneratedDelContent; p; p = p->GetNext() )
-	{
-		if ( p->GetType() == SC_CAT_CONTENT && p->GetBigRange().aStart == rPos
-				&& !p->IsDeletedInDelType( eNotInDelType ) )
-		{
-			return (ScChangeActionContent*) p;
-		}
-	}
-	return NULL;
-}
-
-
 ScChangeActionContent* ScChangeTrack::SearchContentAt(
 		const ScBigAddress& rPos, ScChangeAction* pButNotThis ) const
 {
Index: sc/source/core/tool/chgviset.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chgviset.cxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/source/core/tool/chgviset.cxx	10 Apr 2008 19:49:04 -0000	1.8
+++ sc/source/core/tool/chgviset.cxx	9 May 2008 02:03:26 -0000	1.8.32.2
@@ -125,77 +125,6 @@
 	}
 }
 
-void ScChangeViewSettings::Load( SvStream& rStream, USHORT nVer )
-{
-	ScReadHeader aHdr( rStream );
-
-	BYTE nByte;
-	UINT32 nDT;
-	rStream >> bShowIt;
-	rStream >> bIsDate;
-	rStream >> nByte; eDateMode = (ScChgsDateMode)nByte;
-	rStream >> nDT; aFirstDateTime.SetDate( nDT );
-	rStream >> nDT; aFirstDateTime.SetTime( nDT );
-	rStream >> nDT; aLastDateTime.SetDate( nDT );
-	rStream >> nDT; aLastDateTime.SetTime( nDT );
-	rStream >> bIsAuthor;
-	rStream >> bEveryoneButMe;
-	rStream.ReadByteString( aAuthorToShow, rStream.GetStreamCharSet() );
-	rStream >> bIsRange;
-	aRangeList.Load( rStream, nVer );
-	if ( aHdr.BytesLeft() )
-	{
-		rStream >> bShowAccepted;
-		rStream >> bShowRejected;
-	}
-	else
-	{
-		bShowAccepted = FALSE;
-		bShowRejected = FALSE;
-	}
-
-	// Zusaetzlich Kommentar-Informationen lesen (src509)
-	if ( aHdr.BytesLeft() )	 //#59103#
-	{
-		rStream >> bIsComment;
-		rStream.ReadByteString( aComment, rStream.GetStreamCharSet() );
-	}
-	else
-	{
-		bIsComment = FALSE;
-		aComment.Erase();
-	}
-	SetTheComment(aComment);
-}
-
-void ScChangeViewSettings::Store( SvStream& rStream ) const
-{
-	ScWriteHeader aHdr( rStream, 42 );		// Groesse, wenn String und RangeList leer sind
-
-	rStream << bShowIt;
-	rStream << bIsDate;
-	rStream << (BYTE) eDateMode;
-	rStream << (UINT32) aFirstDateTime.GetDate();
-	rStream << (UINT32) aFirstDateTime.GetTime();
-	rStream << (UINT32) aLastDateTime.GetDate();
-	rStream << (UINT32) aLastDateTime.GetTime();
-	rStream << bIsAuthor;
-	rStream << bEveryoneButMe;
-	rStream.WriteByteString( aAuthorToShow, rStream.GetStreamCharSet() );
-	rStream << bIsRange;
-	aRangeList.Store( rStream );
-	rStream << bShowAccepted;
-	rStream << bShowRejected;
-
-	// Zusaetzlich Kommentar-Informationen schreiben (src509)
-	if(bIsComment || aComment.Len()>0) //#59103#
-	{
-		rStream << bIsComment;
-		rStream.WriteByteString( aComment, rStream.GetStreamCharSet() );
-	}
-}
-
-
 void ScChangeViewSettings::AdjustDateMode( const ScDocument& rDoc )
 {
     switch ( eDateMode )
Index: sc/source/core/tool/collect.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/collect.cxx,v
retrieving revision 1.14
retrieving revision 1.14.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.3
--- sc/source/core/tool/collect.cxx	10 Apr 2008 19:49:21 -0000	1.14
+++ sc/source/core/tool/collect.cxx	14 May 2008 01:52:08 -0000	1.14.32.3
@@ -369,23 +369,23 @@
 // TypedStrCollection
 //------------------------------------------------------------------------
 
-TypedStrData::TypedStrData( ScDocument* pDoc, SCCOL nCol, SCROW nRow, SCTAB nTab,
-								BOOL bAllStrings )
-{
-	if ( pDoc->HasValueData( nCol, nRow, nTab ) )
-	{
-		pDoc->GetValue( nCol, nRow, nTab, nValue );
-		if (bAllStrings)
-			pDoc->GetString( nCol, nRow, nTab, aStrValue );
-		nStrType = 0;
-	}
-	else
-	{
-		pDoc->GetString( nCol, nRow, nTab, aStrValue );
-		nValue = 0.0;
-		nStrType = 1;		//! Typ uebergeben ?
-	}
-}
+//UNUSED2008-05  TypedStrData::TypedStrData( ScDocument* pDoc, SCCOL nCol, SCROW nRow, SCTAB nTab,
+//UNUSED2008-05                                  BOOL bAllStrings )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( pDoc->HasValueData( nCol, nRow, nTab ) )
+//UNUSED2008-05      {
+//UNUSED2008-05          pDoc->GetValue( nCol, nRow, nTab, nValue );
+//UNUSED2008-05          if (bAllStrings)
+//UNUSED2008-05              pDoc->GetString( nCol, nRow, nTab, aStrValue );
+//UNUSED2008-05          nStrType = 0;
+//UNUSED2008-05      }
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          pDoc->GetString( nCol, nRow, nTab, aStrValue );
+//UNUSED2008-05          nValue = 0.0;
+//UNUSED2008-05          nStrType = 1;       //! Typ uebergeben ?
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 DataObject*	TypedStrData::Clone() const
 {
Index: sc/source/core/tool/compiler.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/compiler.cxx,v
retrieving revision 1.77
retrieving revision 1.77.6.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.77 -r1.77.6.1
--- sc/source/core/tool/compiler.cxx	29 Apr 2008 15:06:08 -0000	1.77
+++ sc/source/core/tool/compiler.cxx	9 May 2008 04:45:56 -0000	1.77.6.1
@@ -986,9 +986,7 @@
 struct Convention_A1 : public ScCompiler::Convention
 {
     Convention_A1( ScAddress::Convention eConv ) : ScCompiler::Convention( eConv ) { }
-    static String MakeColStr( SCCOL nCol );
     static void MakeColStr( rtl::OUStringBuffer& rBuffer, SCCOL nCol );
-    static String MakeRowStr( SCROW nRow );
     static void MakeRowStr( rtl::OUStringBuffer& rBuffer, SCROW nRow );
 
     ParseResult parseAnyToken( const String& rFormula,
@@ -1005,14 +1003,6 @@
     }
 };
 
-String Convention_A1::MakeColStr( SCCOL nCol )
-{
-    if ( !ValidCol( nCol) )
-        return ScGlobal::GetRscString(STR_NO_REF_TABLE);
-    else
-        return ::ColToAlpha( nCol);
-}
-
 void Convention_A1::MakeColStr( rtl::OUStringBuffer& rBuffer, SCCOL nCol )
 {
     if ( !ValidCol( nCol) )
@@ -1021,14 +1011,6 @@
         ::ColToAlpha( rBuffer, nCol);
 }
 
-String Convention_A1::MakeRowStr( SCROW nRow )
-{
-    if ( !ValidRow(nRow) )
-        return ScGlobal::GetRscString(STR_NO_REF_TABLE);
-    else
-        return String::CreateFromInt32( nRow + 1 );
-}
-
 void Convention_A1::MakeRowStr( rtl::OUStringBuffer& rBuffer, SCROW nRow )
 {
     if ( !ValidRow(nRow) )
@@ -4264,16 +4246,6 @@
     return n;
 }
 
-void ScCompiler::AdjustReference( SingleRefData& r )
-{
-    if( r.IsColRel() )
-        r.nCol = lcl_adjval( r.nCol, aPos.Col(), MAXCOL, r.IsColRel() );
-    if( r.IsRowRel() )
-        r.nRow = lcl_adjval( r.nRow, aPos.Row(), MAXROW, r.IsRowRel() );
-    if( r.IsTabRel() )
-        r.nTab = lcl_adjval( r.nTab, aPos.Tab(), static_cast<SCTAB>(nMaxTab), r.IsTabRel() );
-}
-
 // reference of named range with relative references
 
 void ScCompiler::SetRelNameReference()
Index: sc/source/core/tool/dbcolect.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/dbcolect.cxx,v
retrieving revision 1.17
retrieving revision 1.17.32.5
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.5
--- sc/source/core/tool/dbcolect.cxx	10 Apr 2008 19:50:39 -0000	1.17
+++ sc/source/core/tool/dbcolect.cxx	13 May 2008 14:34:10 -0000	1.17.32.5
@@ -89,294 +89,6 @@
 	SetImportParam( aImportParam );
 }
 
-ScDBData::ScDBData( SvStream& /* rStream */, ScMultipleReadHeader& /* rHdr */ ) :
-	bDoSize			(FALSE),
-	bKeepFmt		(FALSE),
-	bStripData		(FALSE),
-	bSortUserDef	(FALSE),
-	nSortUserIndex	(0),
-	bIsAdvanced		(FALSE),
-	nSubUserIndex	(0),
-	bDBSelection	(FALSE),
-	bDBSql			(TRUE),
-	nDBType			(ScDbTable),
-	nIndex 			(0),
-	bAutoFilter		(FALSE),
-	bModified		(FALSE)
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rHdr.StartEntry();
-
-	USHORT i;
-	USHORT j;
-	BYTE nDummy;
-	rtl_TextEncoding eCharSet = rStream.GetStreamCharSet();
-
-	rStream.ReadByteString( aName, eCharSet );
-	rStream >> nTable;
-	rStream >> nStartCol;
-	rStream >> nStartRow;
-	rStream >> nEndCol;
-	rStream >> nEndRow;
-	rStream >> bByRow;
-	rStream >> bHasHeader;
-	rStream >> bSortCaseSens;
-	rStream >> bIncludePattern;
-	rStream	>> bSortInplace;
-	rStream	>> nSortDestTab;
-	rStream	>> nSortDestCol;
-	rStream	>> nSortDestRow;
-	rStream >> bQueryInplace;
-	rStream >> bQueryCaseSens;
-	rStream >> bQueryRegExp;
-	rStream >> bQueryDuplicate;
-	rStream >> nQueryDestTab;
-	rStream >> nQueryDestCol;
-	rStream >> nQueryDestRow;
-	rStream >> bSubRemoveOnly;
-	rStream >> bSubReplace;
-	rStream >> bSubPagebreak;
-	rStream >> bSubCaseSens;
-	rStream >> bSubDoSort;
-	rStream >> bSubAscending;
-	rStream >> bSubIncludePattern;
-	rStream >> bSubUserDef;
-	rStream >> bDBImport;
-
-	rStream.ReadByteString( aDBName, eCharSet );
-	rStream.ReadByteString( aDBStatement, eCharSet );
-	rStream >> bDBNative;
-
-	for (i=0; i<MAXSORT; i++)
-	{
-		rStream >> bDoSort[i];
-        USHORT n16;
-		rStream >> n16; nSortField[i] = n16;
-		rStream >> bAscending[i];
-	}
-	for (i=0; i<MAXQUERY; i++)
-	{
-		rStream >> bDoQuery[i];
-		rStream >> nQueryField[i];
-		rStream >> nDummy; eQueryOp[i] = (ScQueryOp) nDummy;
-		rStream >> bQueryByString[i];
-		pQueryStr[i] = new String;
-		rStream.ReadByteString( *pQueryStr[i], eCharSet );
-		rStream >> nQueryVal[i];
-		rStream >> nDummy; eQueryConnect[i] = (ScQueryConnect) nDummy;
-	}
-	for (i=0; i<MAXSUBTOTAL; i++)
-	{
-		rStream >> bDoSubTotal[i];
-		rStream >> nSubField[i];
-
-		USHORT nCount;
-		rStream >> nCount;
-		nSubTotals[i] = nCount;
-
-		pSubTotals[i] = nCount ? new USHORT			[nCount] : NULL;
-		pFunctions[i] = nCount ? new ScSubTotalFunc	[nCount] : NULL;
-
-		for (j=0; j<nCount; j++)
-		{
-			rStream >> pSubTotals[i][j];
-			rStream >> nDummy; pFunctions[i][j] = (ScSubTotalFunc)nDummy;
-		}
-	}
-
-	if (rHdr.BytesLeft())
-		rStream >> nIndex;
-
-	if (rHdr.BytesLeft())
-		rStream >> bDBSelection;
-
-	if (rHdr.BytesLeft())
-		rStream >> bDBSql;				// Default = TRUE
-
-	if (rHdr.BytesLeft())
-	{
-		rStream >> nSubUserIndex;
-		rStream >> bSortUserDef;
-		rStream >> nSortUserIndex;
-	}
-
-	if (rHdr.BytesLeft())
-	{
-		rStream >> bDoSize;
-		rStream >> bKeepFmt;
-	}
-
-	if (rHdr.BytesLeft())
-		rStream >> bStripData;
-
-	if (rHdr.BytesLeft())
-		rStream >> nDBType;				// Default = ScDbTable
-
-	if (rHdr.BytesLeft())
-	{
-		rStream >> bIsAdvanced;			// Default = FALSE
-		if (bIsAdvanced)
-			rStream >> aAdvSource;
-	}
-
-	// aSortLocale / aSortAlgorithm are not in binary file format
-
-	rHdr.EndEntry();
-
-	// #43070# rottes Dokument?!?
-	// nEndCol war 258
-	// und auch die CellInfo pPattern in ScOutputData FindRotated waren NULL
-	if ( nStartCol > MAXCOL )
-	{
-		DBG_ERRORFILE( "nStartCol > MAXCOL" );
-		nStartCol = MAXCOL;
-	}
-	if ( nStartRow > MAXROW )
-	{
-		DBG_ERRORFILE( "nStartRow > MAXROW" );
-		nStartRow = MAXROW;
-	}
-	if ( nEndCol > MAXCOL )
-	{
-		DBG_ERRORFILE( "nEndCol > MAXCOL" );
-		nEndCol = MAXCOL;
-	}
-	if ( nEndRow > MAXROW )
-	{
-		DBG_ERRORFILE( "nEndRow > MAXROW" );
-		nEndRow = MAXROW;
-	}
-	if ( nQueryDestCol > MAXCOL )
-	{
-		DBG_ERRORFILE( "nQueryDestCol > MAXCOL" );
-		nQueryDestCol = MAXCOL;
-	}
-	if ( nQueryDestRow > MAXROW )
-	{
-		DBG_ERRORFILE( "nQueryDestRow > MAXROW" );
-		nQueryDestRow = MAXROW;
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-BOOL ScDBData::Store( SvStream& /* rStream */, ScMultipleWriteHeader& /* rHdr */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rHdr.StartEntry();
-
-	USHORT i;
-	USHORT j;
-	rtl_TextEncoding eCharSet = rStream.GetStreamCharSet();
-
-	rStream.WriteByteString( aName, eCharSet );
-	rStream << nTable;
-	rStream << nStartCol;
-	rStream << nStartRow;
-	rStream << nEndCol;
-	rStream << nEndRow;
-	rStream << bByRow;
-	rStream << bHasHeader;
-	rStream << bSortCaseSens;
-	rStream << bIncludePattern;
-	rStream	<< bSortInplace;
-	rStream	<< nSortDestTab;
-	rStream	<< nSortDestCol;
-	rStream	<< nSortDestRow;
-	rStream << bQueryInplace;
-	rStream << bQueryCaseSens;
-	rStream << bQueryRegExp;
-	rStream << bQueryDuplicate;
-	rStream << nQueryDestTab;
-	rStream << nQueryDestCol;
-	rStream << nQueryDestRow;
-	rStream << bSubRemoveOnly;
-	rStream << bSubReplace;
-	rStream << bSubPagebreak;
-	rStream << bSubCaseSens;
-	rStream << bSubDoSort;
-	rStream << bSubAscending;
-	rStream << bSubIncludePattern;
-	rStream << bSubUserDef;
-	rStream << bDBImport;
-
-	rStream.WriteByteString( aDBName, eCharSet );
-	rStream.WriteByteString( aDBStatement, eCharSet );
-	rStream << bDBNative;
-
-	for (i=0; i<MAXSORT; i++)
-	{
-		rStream << bDoSort[i];
-        DBG_ASSERT( !SC_ROWLIMIT_MORE_THAN_32K ||
-                (0 <= nSortField[i] && nSortField[i] < SCROWS32K),
-                "rowlimit increased, bad file data");
-        rStream << (USHORT) nSortField[i];
-		rStream << bAscending[i];
-	}
-	for (i=0; i<MAXQUERY; i++)
-	{
-		rStream << bDoQuery[i];
-		rStream << nQueryField[i];
-		rStream << (BYTE) eQueryOp[i];
-		rStream << bQueryByString[i];
-		rStream.WriteByteString( *pQueryStr[i], eCharSet );
-		rStream << nQueryVal[i];
-		rStream << (BYTE) eQueryConnect[i];
-	}
-	for (i=0; i<MAXSUBTOTAL; i++)
-	{
-		rStream << bDoSubTotal[i];
-		rStream << nSubField[i];
-
-		USHORT nCount = nSubTotals[i];
-		rStream << nCount;
-		for (j=0; j<nCount; j++)
-		{
-			rStream << pSubTotals[i][j];
-			rStream << (BYTE)pFunctions[i][j];
-		}
-	}
-	rStream << nIndex;					// seit 24.10.95
-
-	rStream << bDBSelection;
-
-	rStream << bDBSql;					// seit 4.2.97
-
-	rStream << nSubUserIndex;			// seit 5.2.97
-	rStream << bSortUserDef;
-	rStream << nSortUserIndex;
-
-	rStream << bDoSize;					// seit 13.2.97
-	rStream << bKeepFmt;
-
-	rStream << bStripData;				// seit 23.2.97
-
-	if( rStream.GetVersion() > SOFFICE_FILEFORMAT_40 )
-	{
-		//	folgendes gab's in der 4.0 noch nicht
-
-		//	alte Versionen suchen immer nach Tables und Queries
-		rStream << nDBType;					// seit 20.11.97
-
-		//	starting from 591, store advanced filter source range
-		//	only if set, to avoid unneccessary warnings
-		if (bIsAdvanced)
-		{
-			rStream << (BOOL) TRUE;
-			rStream << aAdvSource;
-		}
-	}
-
-	// aSortLocale / aSortAlgorithm are not in binary file format
-
-	rHdr.EndEntry();
-	return TRUE;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
 ScDBData::ScDBData( const ScDBData& rData ) :
     DataObject(),
 	ScRefreshTimer		( rData ),
@@ -619,12 +331,12 @@
 	}
 }
 
-BOOL ScDBData::IsBeyond(SCROW nMaxRow) const
-{
-	return ( nStartRow > nMaxRow ||
-			 nEndRow > nMaxRow ||
-			 nQueryDestRow > nMaxRow );
-}
+//UNUSED2008-05  BOOL ScDBData::IsBeyond(SCROW nMaxRow) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return ( nStartRow > nMaxRow ||
+//UNUSED2008-05               nEndRow > nMaxRow ||
+//UNUSED2008-05               nQueryDestRow > nMaxRow );
+//UNUSED2008-05  }
 
 String ScDBData::GetSourceString() const
 {
@@ -976,14 +688,6 @@
 					&& (nCol2 == nEndCol) && (nRow2 == nEndRow));
 }
 
-String ScDBData::GetTargetName(const String& rDocName) const
-{
-	String aTargetName(rDocName);
-	aTargetName += '.';
-	aTargetName += aName;
-	return aTargetName;
-}
-
 DataObject*	ScDBData::Clone() const
 {
 	return new ScDBData(*this);
@@ -1053,60 +757,6 @@
 	return Search( &aDataObj, rIndex );
 }
 
-BOOL ScDBCollection::Load( SvStream& rStream )
-{
-	BOOL bSuccess = TRUE;
-	USHORT nNewCount;
-
-	while( nCount > 0 )
-		AtFree(0);					// alles loeschen
-
-	ScMultipleReadHeader aHdr( rStream );
-
-	rStream >> nNewCount;
-	for (USHORT i=0; i<nNewCount && bSuccess; i++)
-	{
-		ScDBData* pData = new ScDBData( rStream, aHdr );
-		Insert( pData );
-	}
-	if (aHdr.BytesLeft())	//	... Erweiterungen
-		rStream >> nEntryIndex;
-	return bSuccess;
-}
-
-BOOL ScDBCollection::Store( SvStream& rStream ) const
-{
-	ScMultipleWriteHeader aHdr( rStream );
-
-	USHORT i;
-	USHORT nSaveCount = nCount;
-	SCROW nSaveMaxRow = pDoc->GetSrcMaxRow();
-	if ( nSaveMaxRow < MAXROW )
-	{
-		nSaveCount = 0;
-		for (i=0; i<nCount; i++)
-			if ( !((const ScDBData*)At(i))->IsBeyond(nSaveMaxRow) )
-				++nSaveCount;
-
-		if ( nSaveCount < nCount )
-			pDoc->SetLostData();			// Warnung ausgeben
-	}
-
-	rStream << nSaveCount;
-
-	BOOL bSuccess = TRUE;
-	for (i=0; i<nCount && bSuccess; i++)
-	{
-		const ScDBData* pDBData = (const ScDBData*)At(i);
-		if ( nSaveMaxRow == MAXROW || !pDBData->IsBeyond(nSaveMaxRow) )
-			bSuccess = pDBData->Store( rStream, aHdr );
-	}
-
-	rStream << nEntryIndex;				// seit 24.10.95
-
-	return bSuccess;
-}
-
 void ScDBCollection::DeleteOnTab( SCTAB nTab )
 {
     USHORT nPos = 0;
Index: sc/source/core/tool/ddelink.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/ddelink.cxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/source/core/tool/ddelink.cxx	10 Apr 2008 19:50:55 -0000	1.16
+++ sc/source/core/tool/ddelink.cxx	9 May 2008 16:11:47 -0000	1.16.32.1
@@ -236,11 +236,6 @@
 	}
 }
 
-void ScDdeLink::NewData(SCSIZE nCols, SCSIZE nRows)
-{
-	pResult = new ScMatrix( nCols, nRows );
-}
-
 void ScDdeLink::ResetValue()
 {
     pResult.Clear();
Index: sc/source/core/tool/detdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/detdata.cxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/source/core/tool/detdata.cxx	10 Apr 2008 19:51:12 -0000	1.8
+++ sc/source/core/tool/detdata.cxx	9 May 2008 02:03:26 -0000	1.8.32.2
@@ -117,58 +117,5 @@
 	return bEqual;
 }
 
-void ScDetOpList::Load( SvStream& rStream )
-{
-	ScMultipleReadHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-
-	USHORT nNewCount;
-	rStream >> nNewCount;
-
-	ScAddress aPos;
-	USHORT nOper;
-
-	for (USHORT i=0; i<nNewCount; i++)
-	{
-		//	1) Position (ScAddress)
-		//	2) Operation (USHORT)
-
-		aHdr.StartEntry();
-
-		rStream >> aPos;
-		rStream >> nOper;
-		Append( new ScDetOpData( aPos, (ScDetOpType) nOper ) );
-
-		aHdr.EndEntry();
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-void ScDetOpList::Store( SvStream& rStream ) const
-{
-	ScMultipleWriteHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-
-	USHORT nCount = Count();
-	rStream << nCount;
-
-	for (USHORT i=0; i<nCount; i++)
-	{
-		//	1) Position (ScAddress)
-		//	2) Operation (USHORT)
-
-		aHdr.StartEntry();
-
-		ScDetOpData* pData = (*this)[i];
-		rStream << pData->GetPos();
-		rStream << (USHORT) pData->GetOperation();
-
-		aHdr.EndEntry();
-	}
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
 
 
Index: sc/source/core/tool/docoptio.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/docoptio.cxx,v
retrieving revision 1.9
retrieving revision 1.9.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.4
--- sc/source/core/tool/docoptio.cxx	10 Apr 2008 19:51:55 -0000	1.9
+++ sc/source/core/tool/docoptio.cxx	12 May 2008 15:56:57 -0000	1.9.32.4
@@ -112,84 +112,6 @@
 
 //------------------------------------------------------------------------
 
-void ScDocOptions::Save(SvStream& rStream, BOOL bConfig) const
-{
-	ScWriteHeader aHdr( rStream, 28 );
-
-	rStream << bIsIgnoreCase;
-	rStream << bIsIter;
-	rStream << nIterCount;
-	rStream << fIterEps;
-	rStream << nPrecStandardFormat;
-	rStream << nDay;
-	rStream << nMonth;
-	rStream << nYear;
-	rStream << nTabDistance;
-	rStream << bCalcAsShown;
-	rStream << bMatchWholeCell;
-	rStream << bDoAutoSpell;
-	rStream << bLookUpColRowNames;
-
-	if ( bConfig || rStream.GetVersion() > SOFFICE_FILEFORMAT_40 )		// nicht bei 4.0 Export
-	{
-		if ( !bConfig && 1901 <= nYear2000 && nYear2000 <= 1999 )
-		{	// fuer SO5 auf altes Format zweistellig abbilden
-			rStream << (USHORT) (nYear2000 - 1901);
-		}
-		else
-		{	// neues Format vierstellig, beliebiges Jahrhundert
-			// erzeugt in SO5 vor src513e ein Warning beim Laden
-			rStream << (USHORT) 29;		// Dummy, alter SO5 Default
-			rStream << nYear2000;		// echter Wert
-		}
-	}
-}
-
-void ScDocOptions::Load(SvStream& rStream)
-{
-	ScReadHeader aHdr( rStream );
-
-	rStream >> bIsIgnoreCase;
-	rStream >> bIsIter;
-	rStream >> nIterCount;
-	rStream >> fIterEps;
-	rStream >> nPrecStandardFormat;
-	rStream >> nDay;
-	rStream >> nMonth;
-	rStream >> nYear;
-	if ( aHdr.BytesLeft() )
-		rStream >> nTabDistance;
-	else
-		nTabDistance = lcl_GetDefaultTabDist();
-	if ( aHdr.BytesLeft() )
-		rStream >> bCalcAsShown;
-	else
-		bCalcAsShown = FALSE;
-	if ( aHdr.BytesLeft() )
-		rStream >> bMatchWholeCell;
-	else
-		bMatchWholeCell = FALSE;
-	if ( aHdr.BytesLeft() )
-		rStream >> bDoAutoSpell;
-	else
-		bDoAutoSpell = FALSE;
-	if ( aHdr.BytesLeft() )
-		rStream >> bLookUpColRowNames;
-	else
-		bLookUpColRowNames = TRUE;
-	if ( aHdr.BytesLeft() )
-	{
-		rStream >> nYear2000;		// SO5 ab 24.06.98
-		// SO51 ab src513e
-		if ( aHdr.BytesLeft() )
-			rStream >> nYear2000;	// der echte Wert
-		else
-			nYear2000 += 1901;		// altes zweistelliges auf neues vierstelliges
-	}
-	else
-		nYear2000 = 18 + 1901; 		// alter Wert vor SO5
-}
-
 void ScDocOptions::ResetDocOptions()
 {
 	bIsIgnoreCase		= FALSE;
@@ -213,9 +135,9 @@
 //      ScTpCalcItem - Daten fuer die CalcOptions-TabPage
 //========================================================================
 
-ScTpCalcItem::ScTpCalcItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
-{
-}
+//UNUSED2008-05  ScTpCalcItem::ScTpCalcItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
Index: sc/source/core/tool/hints.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/hints.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.2
--- sc/source/core/tool/hints.cxx	10 Apr 2008 19:52:48 -0000	1.6
+++ sc/source/core/tool/hints.cxx	13 May 2008 14:34:10 -0000	1.6.32.2
@@ -48,13 +48,6 @@
 //      ScPaintHint - Angabe, was neu gezeichnet werden muss
 // -----------------------------------------------------------------------
 
-ScPaintHint::ScPaintHint() :
-	aRange( 0,0,0, MAXCOL,MAXROW,MAXTAB ),
-	nParts( PAINT_ALL ),
-	bPrint( TRUE )
-{
-}
-
 ScPaintHint::ScPaintHint( const ScRange& rRng, USHORT nPaint ) :
 	aRange( rRng ),
 	nParts( nPaint ),
@@ -88,10 +81,10 @@
 //      ScPointerChangedHint - Pointer ist ungueltig geworden
 // -----------------------------------------------------------------------
 
-ScPointerChangedHint::ScPointerChangedHint( USHORT nF ) :
-	nFlags( nF )
-{
-}
+//UNUSED2008-05  ScPointerChangedHint::ScPointerChangedHint( USHORT nF ) :
+//UNUSED2008-05      nFlags( nF )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScPointerChangedHint::~ScPointerChangedHint()
 {
Index: sc/source/core/tool/inputopt.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/inputopt.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/source/core/tool/inputopt.cxx	10 Apr 2008 19:53:24 -0000	1.10
+++ sc/source/core/tool/inputopt.cxx	13 May 2008 18:34:58 -0000	1.10.32.1
@@ -114,55 +114,6 @@
 	return *this;
 }
 
-//------------------------------------------------------------------------
-
-SvStream& operator>>( SvStream& rStream, ScInputOptions& rOpt )
-{
-	rOpt.SetDefaults();
-
-	ScReadHeader aHdr( rStream );
-
-	rStream >> rOpt.nMoveDir;
-	rStream >> rOpt.bMoveSelection;
-	rStream >> rOpt.bEnterEdit;
-	rStream >> rOpt.bExtendFormat;
-
-	if (aHdr.BytesLeft())
-		rStream >> rOpt.bRangeFinder;			// ab 363
-
-	if (aHdr.BytesLeft())
-		rStream >> rOpt.bExpandRefs;			// ab 364v
-
-	if (aHdr.BytesLeft())
-		rStream >> rOpt.bMarkHeader;			// ab 364irgendwas
-
-	if (aHdr.BytesLeft())
-		rStream >> rOpt.bUseTabCol;				// ab 373d
-
-	// newer additions are not in old file format
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-SvStream& operator<<( SvStream& rStream, const ScInputOptions& rOpt )
-{
-	ScWriteHeader aHdr( rStream, 6 );
-
-	rStream << rOpt.nMoveDir;
-	rStream << rOpt.bMoveSelection;
-	rStream << rOpt.bEnterEdit;
-	rStream << rOpt.bExtendFormat;
-	rStream << rOpt.bRangeFinder;
-	rStream << rOpt.bExpandRefs;
-	rStream << rOpt.bMarkHeader;
-	rStream << rOpt.bUseTabCol;
-
-	// newer additions are not in old file format
-
-	return rStream;
-}
 
 //==================================================================
 //	Config Item containing input options
Index: sc/source/core/tool/interpr4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr4.cxx,v
retrieving revision 1.56
retrieving revision 1.56.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.56 -r1.56.32.1
--- sc/source/core/tool/interpr4.cxx	10 Apr 2008 19:55:10 -0000	1.56
+++ sc/source/core/tool/interpr4.cxx	9 May 2008 16:11:47 -0000	1.56.32.1
@@ -2808,13 +2808,6 @@
 }
 */
 
-
-void ScInterpreter::ScDefPar()
-{
-    PushInt(0);
-}
-
-
 void ScInterpreter::ScDBArea()
 {
     ScDBData* pDBData = pDok->GetDBCollection()->FindIndex( pCur->GetIndex());
Index: sc/source/core/tool/interpr5.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr5.cxx,v
retrieving revision 1.31
retrieving revision 1.31.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.1
--- sc/source/core/tool/interpr5.cxx	10 Apr 2008 19:55:30 -0000	1.31
+++ sc/source/core/tool/interpr5.cxx	9 May 2008 16:11:47 -0000	1.31.32.1
@@ -756,26 +756,6 @@
     }
 }
 
-void ScInterpreter::MFastSub(ScMatrix* pA, ScMatrix* pB, ScMatrix* pR,
-                              SCSIZE n, SCSIZE m)
-        // Subtrahiert n x m Mat a - m x l Mat b nach Mat r
-{
-    for (SCSIZE i = 0; i < n; i++)
-    {
-        for (SCSIZE j = 0; j < m; j++)
-            pR->PutDouble(pA->GetDouble(i,j) - pB->GetDouble(i,j), i, j);
-    }
-}
-
-void ScInterpreter::MFastTrans(ScMatrix* pA, ScMatrix* pR,
-                              SCSIZE n, SCSIZE m)
-        // Transponiert n x m Mat a nach Mat r
-{
-    for (SCSIZE i = 0; i < n; i++)
-        for (SCSIZE j = 0; j < m; j++)
-            pR->PutDouble(pA->GetDouble(i, j), j, i);
-}
-
 
 /* Matrix LUP decomposition according to the pseudocode of "Introduction to
  * Algorithms" by Cormen, Leiserson, Rivest, Stein.
Index: sc/source/core/tool/printopt.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/printopt.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/source/core/tool/printopt.cxx	10 Apr 2008 19:57:46 -0000	1.7
+++ sc/source/core/tool/printopt.cxx	12 May 2008 15:56:57 -0000	1.7.32.2
@@ -90,9 +90,9 @@
 
 // -----------------------------------------------------------------------
 
-ScTpPrintItem::ScTpPrintItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
-{
-}
+//UNUSED2008-05  ScTpPrintItem::ScTpPrintItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScTpPrintItem::ScTpPrintItem( USHORT nWhichP, const ScPrintOptions& rOpt ) :
     SfxPoolItem ( nWhichP ),
@@ -210,9 +210,4 @@
 	SetModified();
 }
 
-void ScPrintCfg::OptionsChanged()
-{
-	SetModified();
-}
-
 
Index: sc/source/core/tool/progress.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/progress.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/core/tool/progress.cxx	10 Apr 2008 19:58:23 -0000	1.7
+++ sc/source/core/tool/progress.cxx	9 May 2008 21:22:40 -0000	1.7.32.1
@@ -143,26 +143,6 @@
 	}
 }
 
-
-// static
-
-void ScProgress::SetAllowInterpret( BOOL bAllow )
-{	// Grundzustand: Allow, Dummy gesetzt, pOld==NULL
-	if ( !bAllow && bAllowInterpretProgress )
-	{	// vorherigen/Dummy merken und Dummy setzen
-		pOldInterpretProgress = pInterpretProgress;
-		pInterpretProgress = &theDummyInterpretProgress;
-		bAllowInterpretProgress = FALSE;
-	}
-	else if ( bAllow && !bAllowInterpretProgress )
-	{	// Dummy weg und vorherigen/Dummy setzen
-		pInterpretProgress = pOldInterpretProgress;
-		pOldInterpretProgress = NULL;
-		bAllowInterpretProgress = TRUE;
-	}
-}
-
-
 // static
 
 void ScProgress::CreateInterpretProgress( ScDocument* pDoc, BOOL bWait )
Index: sc/source/core/tool/rangelst.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rangelst.cxx,v
retrieving revision 1.11
retrieving revision 1.11.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.3
--- sc/source/core/tool/rangelst.cxx	10 Apr 2008 19:58:41 -0000	1.11
+++ sc/source/core/tool/rangelst.cxx	9 May 2008 21:22:41 -0000	1.11.32.3
@@ -249,53 +249,6 @@
 	return TRUE;
 }
 
-
-BOOL ScRangeList::Store( SvStream& rStream ) const
-{
-//    BOOL bOk = TRUE;
-	ULONG nListCount = Count();
-	ULONG nBytes = sizeof(UINT32) + nListCount * sizeof(ScRange);
-	ScWriteHeader aHdr( rStream, nBytes );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	rStream << (UINT32) nCount;
-	for ( ULONG j = 0; j < nCount && bOk; j++ )
-	{
-		rStream << *GetObject( j );
-		if( rStream.GetError() != SVSTREAM_OK )
-			bOk = FALSE;
-	}
-	return bOk;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
-BOOL ScRangeList::Load( SvStream& rStream, USHORT /* nVer */ )
-{
-//    BOOL bOk = TRUE;
-	ScReadHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	ScRange aRange;
-	UINT32 n;
-	rStream >> n;
-	ULONG nCount = n;
-	for ( ULONG j = 0; j < nCount && bOk; j++ )
-	{
-		rStream >> aRange;
-		Append( aRange );
-		if( rStream.GetError() != SVSTREAM_OK )
-			bOk = FALSE;
-	}
-	return bOk;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
 BOOL ScRangeList::UpdateReference( UpdateRefMode eUpdateRefMode,
 									ScDocument* pDoc, const ScRange& rWhere,
 									SCsCOL nDx, SCsROW nDy, SCsTAB nDz )
@@ -348,19 +301,6 @@
 }
 
 
-ScRange* ScRangeList::Find( const ScRange& rRange ) const
-{
-	ULONG nListCount = Count();
-	for ( ULONG j = 0; j < nListCount; j++ )
-	{
-		ScRange* pR = GetObject( j );
-		if ( *pR == rRange )
-			return pR;
-	}
-	return NULL;
-}
-
-
 ScRangeList::ScRangeList( const ScRangeList& rList ) :
     ScRangeListBase(),
     SvRefBase()
@@ -371,12 +311,6 @@
 }
 
 
-ScRangeList* ScRangeList::Clone() const
-{
-	return new ScRangeList( *this );
-}
-
-
 ScRangeList& ScRangeList::operator=(const ScRangeList& rList)
 {
 	RemoveAll();
@@ -562,74 +496,6 @@
 }
 
 
-BOOL ScRangePairList::Store( SvStream& /* rStream */ ) const
-{
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	BOOL bOk = TRUE;
-	ULONG nCount = Count();
-	ULONG nBytes = sizeof(UINT32) + nCount * sizeof(ScRangePair);
-	ScWriteHeader aHdr( rStream, nBytes );
-	rStream << (UINT32) nCount;
-	for ( ULONG j = 0; j < nCount && bOk; j++ )
-	{
-		rStream << *GetObject( j );
-		if( rStream.GetError() != SVSTREAM_OK )
-			bOk = FALSE;
-	}
-	return bOk;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
-BOOL ScRangePairList::Load( SvStream& rStream, USHORT /* nVer */ )
-{
-//    BOOL bOk = TRUE;
-	ScReadHeader aHdr( rStream );
-#if SC_ROWLIMIT_STREAM_ACCESS 
-#error address types changed!
-	ScRangePair aRangePair;
-	ScRange aRange;
-	UINT32 n;
-	rStream >> n;
-	ULONG nCount = n;
-	for ( ULONG j = 0; j < nCount && bOk; j++ )
-	{
-		if ( nVer < SC_COLROWNAME_RANGEPAIR )
-		{	// aus technical Beta 4.0 versuchen mit altem Verhalten zu uebernehmen
-			rStream >> aRange;
-			aRangePair.GetRange(0) = aRange;
-			ScRange& r = aRangePair.GetRange(1);
-			r = aRange;
-			SCCOL nCol2 = aRange.aEnd.Col();
-			SCROW nRow2 = aRange.aEnd.Row();
-			if ( static_cast<SCCOLROW>(nCol2 - aRange.aStart.Col()) >=
-                    (nRow2 - aRange.aStart.Row()) )
-			{	// ColNames
-				r.aStart.SetRow( Min( static_cast<SCROW>(nRow2 + 1), MAXROW ) );
-				r.aEnd.SetRow( MAXROW );
-			}
-			else
-			{	// RowNames
-				r.aStart.SetCol( Min( static_cast<SCCOL>(nCol2 + 1), MAXCOL ) );
-				r.aEnd.SetCol( MAXCOL );
-			}
-		}
-		else
-			rStream >> aRangePair;
-		Append( aRangePair );
-		if( rStream.GetError() != SVSTREAM_OK )
-			bOk = FALSE;
-	}
-	return bOk;
-#else
-    return FALSE;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-}
-
-
 BOOL ScRangePairList::UpdateReference( UpdateRefMode eUpdateRefMode,
 									ScDocument* pDoc, const ScRange& rWhere,
 									SCsCOL nDx, SCsROW nDy, SCsTAB nDz )
Index: sc/source/core/tool/rangenam.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rangenam.cxx,v
retrieving revision 1.28
retrieving revision 1.28.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.28 -r1.28.30.1
--- sc/source/core/tool/rangenam.cxx	10 Apr 2008 19:58:56 -0000	1.28
+++ sc/source/core/tool/rangenam.cxx	9 May 2008 21:22:41 -0000	1.28.30.1
@@ -187,22 +187,6 @@
 	return new ScRangeData(*this);
 }
 
-BOOL ScRangeData::IsBeyond( SCROW nMaxRow ) const
-{
-	if ( aPos.Row() > nMaxRow )
-		return TRUE;
-
-	ScToken* t;
-	pCode->Reset();
-    while ( ( t = pCode->GetNextReference() ) != NULL )
-		if ( t->GetSingleRef().nRow > nMaxRow ||
-				(t->GetType() == svDoubleRef &&
-				t->GetDoubleRef().Ref2.nRow > nMaxRow) )
-			return TRUE;
-
-	return FALSE;
-}
-
 void ScRangeData::GuessPosition()
 {
 	//	setzt eine Position, mit der alle relative Referenzen bei CalcAbsIfRel
Index: sc/source/core/tool/rangeutl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rangeutl.cxx,v
retrieving revision 1.12
retrieving revision 1.12.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.30.3
--- sc/source/core/tool/rangeutl.cxx	10 Apr 2008 19:59:29 -0000	1.12
+++ sc/source/core/tool/rangeutl.cxx	13 May 2008 18:34:58 -0000	1.12.30.3
@@ -450,11 +450,6 @@
 	return nCount;
 }
 
-void ScRangeStringConverter::AppendString( OUString& rString, const OUString& rNewStr, sal_Unicode cSeperator )
-{
-	AssignString( rString, rNewStr, sal_True, cSeperator );
-}
-
 //___________________________________________________________________
 
 sal_Bool ScRangeStringConverter::GetAddressFromString(
@@ -766,15 +761,6 @@
 
 //------------------------------------------------------------------------
 
-void ScArea::Clear()
-{
-	nTab = 0;
-    nColStart = nColEnd = 0;
-    nRowStart = nRowEnd = 0;
-}
-
-//------------------------------------------------------------------------
-
 ScArea& ScArea::operator=( const ScArea& r )
 {
 	nTab		= r.nTab;
@@ -798,48 +784,6 @@
 
 //------------------------------------------------------------------------
 
-SvStream& operator>> ( SvStream& rStream, ScArea& /* rArea */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream >> rArea.nTab;
-	rStream >> rArea.nColStart;
-	rStream >> rArea.nRowStart;
-	rStream >> rArea.nColEnd;
-	rStream >> rArea.nRowEnd;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-SvStream& operator<< ( SvStream& rStream, const ScArea& /* rArea */ )
-{
-#if SC_ROWLIMIT_STREAM_ACCESS
-#error address types changed!
-	rStream << rArea.nTab;
-	rStream << rArea.nColStart;
-	rStream << rArea.nRowStart;
-	rStream << rArea.nColEnd;
-	rStream << rArea.nRowEnd;
-#endif // SC_ROWLIMIT_STREAM_ACCESS
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-void ScArea::GetString( String& rStr, BOOL bAbsolute, ScDocument* pDoc,
-						ScAddress::Details const & rDetails ) const
-{
-	ScRange aRange( ScAddress( nColStart, nRowStart, nTab ),
-					ScAddress( nColEnd,   nRowEnd,   nTab ) );
-	USHORT  nFlags = bAbsolute ? SCA_COL_ABSOLUTE | SCA_ROW_ABSOLUTE : 0;
-
-	aRange.Format( rStr, nFlags, pDoc, rDetails );
-}
-
-//------------------------------------------------------------------------
-
 ScAreaNameIterator::ScAreaNameIterator( ScDocument* pDoc ) :
 	aStrNoName( ScGlobal::GetRscString(STR_DB_NONAME) )
 {
Index: sc/source/core/tool/rechead.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rechead.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.2
Index: sc/source/core/tool/refdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/refdata.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/source/core/tool/refdata.cxx	10 Apr 2008 20:00:03 -0000	1.7
+++ sc/source/core/tool/refdata.cxx	12 May 2008 15:56:57 -0000	1.7.32.2
@@ -85,111 +85,110 @@
     }
 }
 
-
-void SingleRefData::OldBoolsToNewFlags( const OldSingleRefBools& rBools )
-{
-    switch ( rBools.bRelCol )
-    {
-        case SR_DELETED :
-            Flags.bColRel = TRUE;           // der war verlorengegangen
-            Flags.bColDeleted = TRUE;
-            break;
-        case SR_ABSOLUTE :
-            Flags.bColRel = FALSE;
-            Flags.bColDeleted = FALSE;
-            break;
-        case SR_RELABS :
-        case SR_RELATIVE :
-        default:
-            Flags.bColRel = TRUE;
-            Flags.bColDeleted = FALSE;
-    }
-    switch ( rBools.bRelRow )
-    {
-        case SR_DELETED :
-            Flags.bRowRel = TRUE;           // der war verlorengegangen
-            Flags.bRowDeleted = TRUE;
-            break;
-        case SR_ABSOLUTE :
-            Flags.bRowRel = FALSE;
-            Flags.bRowDeleted = FALSE;
-            break;
-        case SR_RELABS :
-        case SR_RELATIVE :
-        default:
-            Flags.bRowRel = TRUE;
-            Flags.bRowDeleted = FALSE;
-    }
-    switch ( rBools.bRelTab )
-    {
-        case SR_DELETED :
-            Flags.bTabRel = TRUE;           // der war verlorengegangen
-            Flags.bTabDeleted = TRUE;
-            break;
-        case SR_ABSOLUTE :
-            Flags.bTabRel = FALSE;
-            Flags.bTabDeleted = FALSE;
-            break;
-        case SR_RELABS :
-        case SR_RELATIVE :
-        default:
-            Flags.bTabRel = TRUE;
-            Flags.bTabDeleted = FALSE;
-    }
-    Flags.bFlag3D = (rBools.bOldFlag3D & SRF_3D ? TRUE : FALSE);
-    Flags.bRelName = (rBools.bOldFlag3D & SRF_RELNAME ? TRUE : FALSE);
-    if ( !Flags.bFlag3D )
-        Flags.bTabRel = TRUE;   // ist bei einigen aelteren Dokumenten nicht gesetzt
-}
-
-
-/*
- bis Release 3.1 sah Store so aus
-
-    BYTE n = ( ( r.bOldFlag3D & 0x03 ) << 6 )   // RelName, 3D
-            | ( ( r.bRelTab & 0x03 ) << 4 )     // Relative, RelAbs
-            | ( ( r.bRelRow & 0x03 ) << 2 )
-            |   ( r.bRelCol & 0x03 );
-
- bis Release 3.1 sah Load so aus
-
-    r.bRelCol = ( n & 0x03 );
-    r.bRelRow = ( ( n >> 2 ) & 0x03 );
-    r.bRelTab = ( ( n >> 4 ) & 0x03 );
-    r.bOldFlag3D = ( ( n >> 6 ) & 0x03 );
-
- bRelCol == SR_DELETED war identisch mit bRelCol == (SR_RELATIVE | SR_RELABS)
- leider..
- 3.1 liest Zukunft: Deleted wird nicht unbedingt erkannt, nur wenn auch Relativ.
- Aber immer noch nCol > MAXCOL und gut sollte sein..
- */
-
-BYTE SingleRefData::CreateStoreByteFromFlags() const
-{
-    return (BYTE)(
-          ( (Flags.bRelName     & 0x01) << 7 )
-        | ( (Flags.bFlag3D      & 0x01) << 6 )
-        | ( (Flags.bTabDeleted  & 0x01) << 5 )
-        | ( (Flags.bTabRel      & 0x01) << 4 )
-        | ( (Flags.bRowDeleted  & 0x01) << 3 )
-        | ( (Flags.bRowRel      & 0x01) << 2 )
-        | ( (Flags.bColDeleted  & 0x01) << 1 )
-        |   (Flags.bColRel      & 0x01)
-        );
-}
-
-
-void SingleRefData::CreateFlagsFromLoadByte( BYTE n )
-{
-    Flags.bColRel       = (n & 0x01 );
-    Flags.bColDeleted   = ( (n >> 1) & 0x01 );
-    Flags.bRowRel       = ( (n >> 2) & 0x01 );
-    Flags.bRowDeleted   = ( (n >> 3) & 0x01 );
-    Flags.bTabRel       = ( (n >> 4) & 0x01 );
-    Flags.bTabDeleted   = ( (n >> 5) & 0x01 );
-    Flags.bFlag3D       = ( (n >> 6) & 0x01 );
-    Flags.bRelName      = ( (n >> 7) & 0x01 );
-}
+//UNUSED2008-05  void SingleRefData::OldBoolsToNewFlags( const OldSingleRefBools& rBools )
+//UNUSED2008-05  {
+//UNUSED2008-05      switch ( rBools.bRelCol )
+//UNUSED2008-05      {
+//UNUSED2008-05          case SR_DELETED :
+//UNUSED2008-05              Flags.bColRel = TRUE;           // der war verlorengegangen
+//UNUSED2008-05              Flags.bColDeleted = TRUE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_ABSOLUTE :
+//UNUSED2008-05              Flags.bColRel = FALSE;
+//UNUSED2008-05              Flags.bColDeleted = FALSE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_RELABS :
+//UNUSED2008-05          case SR_RELATIVE :
+//UNUSED2008-05          default:
+//UNUSED2008-05              Flags.bColRel = TRUE;
+//UNUSED2008-05              Flags.bColDeleted = FALSE;
+//UNUSED2008-05      }
+//UNUSED2008-05      switch ( rBools.bRelRow )
+//UNUSED2008-05      {
+//UNUSED2008-05          case SR_DELETED :
+//UNUSED2008-05              Flags.bRowRel = TRUE;           // der war verlorengegangen
+//UNUSED2008-05              Flags.bRowDeleted = TRUE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_ABSOLUTE :
+//UNUSED2008-05              Flags.bRowRel = FALSE;
+//UNUSED2008-05              Flags.bRowDeleted = FALSE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_RELABS :
+//UNUSED2008-05          case SR_RELATIVE :
+//UNUSED2008-05          default:
+//UNUSED2008-05              Flags.bRowRel = TRUE;
+//UNUSED2008-05              Flags.bRowDeleted = FALSE;
+//UNUSED2008-05      }
+//UNUSED2008-05      switch ( rBools.bRelTab )
+//UNUSED2008-05      {
+//UNUSED2008-05          case SR_DELETED :
+//UNUSED2008-05              Flags.bTabRel = TRUE;           // der war verlorengegangen
+//UNUSED2008-05              Flags.bTabDeleted = TRUE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_ABSOLUTE :
+//UNUSED2008-05              Flags.bTabRel = FALSE;
+//UNUSED2008-05              Flags.bTabDeleted = FALSE;
+//UNUSED2008-05              break;
+//UNUSED2008-05          case SR_RELABS :
+//UNUSED2008-05          case SR_RELATIVE :
+//UNUSED2008-05          default:
+//UNUSED2008-05              Flags.bTabRel = TRUE;
+//UNUSED2008-05              Flags.bTabDeleted = FALSE;
+//UNUSED2008-05      }
+//UNUSED2008-05      Flags.bFlag3D = (rBools.bOldFlag3D & SRF_3D ? TRUE : FALSE);
+//UNUSED2008-05      Flags.bRelName = (rBools.bOldFlag3D & SRF_RELNAME ? TRUE : FALSE);
+//UNUSED2008-05      if ( !Flags.bFlag3D )
+//UNUSED2008-05          Flags.bTabRel = TRUE;   // ist bei einigen aelteren Dokumenten nicht gesetzt
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  /*
+//UNUSED2008-05   bis Release 3.1 sah Store so aus
+//UNUSED2008-05  
+//UNUSED2008-05      BYTE n = ( ( r.bOldFlag3D & 0x03 ) << 6 )   // RelName, 3D
+//UNUSED2008-05              | ( ( r.bRelTab & 0x03 ) << 4 )     // Relative, RelAbs
+//UNUSED2008-05              | ( ( r.bRelRow & 0x03 ) << 2 )
+//UNUSED2008-05              |   ( r.bRelCol & 0x03 );
+//UNUSED2008-05  
+//UNUSED2008-05   bis Release 3.1 sah Load so aus
+//UNUSED2008-05  
+//UNUSED2008-05      r.bRelCol = ( n & 0x03 );
+//UNUSED2008-05      r.bRelRow = ( ( n >> 2 ) & 0x03 );
+//UNUSED2008-05      r.bRelTab = ( ( n >> 4 ) & 0x03 );
+//UNUSED2008-05      r.bOldFlag3D = ( ( n >> 6 ) & 0x03 );
+//UNUSED2008-05  
+//UNUSED2008-05   bRelCol == SR_DELETED war identisch mit bRelCol == (SR_RELATIVE | SR_RELABS)
+//UNUSED2008-05   leider..
+//UNUSED2008-05   3.1 liest Zukunft: Deleted wird nicht unbedingt erkannt, nur wenn auch Relativ.
+//UNUSED2008-05   Aber immer noch nCol > MAXCOL und gut sollte sein..
+//UNUSED2008-05   */
+//UNUSED2008-05  
+//UNUSED2008-05  BYTE SingleRefData::CreateStoreByteFromFlags() const
+//UNUSED2008-05  {
+//UNUSED2008-05      return (BYTE)(
+//UNUSED2008-05            ( (Flags.bRelName     & 0x01) << 7 )
+//UNUSED2008-05          | ( (Flags.bFlag3D      & 0x01) << 6 )
+//UNUSED2008-05          | ( (Flags.bTabDeleted  & 0x01) << 5 )
+//UNUSED2008-05          | ( (Flags.bTabRel      & 0x01) << 4 )
+//UNUSED2008-05          | ( (Flags.bRowDeleted  & 0x01) << 3 )
+//UNUSED2008-05          | ( (Flags.bRowRel      & 0x01) << 2 )
+//UNUSED2008-05          | ( (Flags.bColDeleted  & 0x01) << 1 )
+//UNUSED2008-05          |   (Flags.bColRel      & 0x01)
+//UNUSED2008-05          );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  
+//UNUSED2008-05  void SingleRefData::CreateFlagsFromLoadByte( BYTE n )
+//UNUSED2008-05  {
+//UNUSED2008-05      Flags.bColRel       = (n & 0x01 );
+//UNUSED2008-05      Flags.bColDeleted   = ( (n >> 1) & 0x01 );
+//UNUSED2008-05      Flags.bRowRel       = ( (n >> 2) & 0x01 );
+//UNUSED2008-05      Flags.bRowDeleted   = ( (n >> 3) & 0x01 );
+//UNUSED2008-05      Flags.bTabRel       = ( (n >> 4) & 0x01 );
+//UNUSED2008-05      Flags.bTabDeleted   = ( (n >> 5) & 0x01 );
+//UNUSED2008-05      Flags.bFlag3D       = ( (n >> 6) & 0x01 );
+//UNUSED2008-05      Flags.bRelName      = ( (n >> 7) & 0x01 );
+//UNUSED2008-05  }
 
 
 BOOL SingleRefData::operator==( const SingleRefData& r ) const
Index: sc/source/core/tool/refupdat.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/refupdat.cxx,v
retrieving revision 1.8
retrieving revision 1.8.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.1
--- sc/source/core/tool/refupdat.cxx	10 Apr 2008 20:00:56 -0000	1.8
+++ sc/source/core/tool/refupdat.cxx	13 May 2008 14:34:10 -0000	1.8.32.1
@@ -939,6 +939,7 @@
 	return eRet;
 }
 
+#if OLD_PIVOT_IMPLEMENTATION
 ScRefUpdateRes ScRefUpdate::DoGrow( const ScRange& rArea, SCCOL nGrowX, SCROW nGrowY,
 									ScRange& rRef )
 {
@@ -969,6 +970,6 @@
 
 	return eRet;
 }
-
+#endif
 
 
Index: sc/source/core/tool/scmatrix.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/scmatrix.cxx,v
retrieving revision 1.17
retrieving revision 1.17.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.1
--- sc/source/core/tool/scmatrix.cxx	10 Apr 2008 20:01:15 -0000	1.17
+++ sc/source/core/tool/scmatrix.cxx	9 May 2008 21:22:41 -0000	1.17.32.1
@@ -243,27 +243,6 @@
 	}
 }
 
-void ScMatrix::PutDoubleAndResetString( double fVal, SCSIZE nC, SCSIZE nR )
-{
-	if (ValidColRow( nC, nR))
-		PutDoubleAndResetString( fVal, CalcOffset( nC, nR) );
-	else
-	{
-		DBG_ERRORFILE("ScMatrix::PutDoubleAndResetString: dimension error");
-	}
-}
-
-void ScMatrix::PutDoubleAndResetString( double fVal, SCSIZE nIndex )
-{
-	if ( IsString( nIndex ) )
-	{
-		delete pMat[nIndex].pS;
-		mnValType[nIndex] = 0;
-        mnNonValue--;
-	}
-	PutDouble( fVal, nIndex );
-}
-
 void ScMatrix::PutString(const String& rStr, SCSIZE nC, SCSIZE nR)
 {
 	if (ValidColRow( nC, nR))
@@ -585,49 +564,6 @@
 	}
 }
 
-void ScMatrix::MatCopyUpperLeft(ScMatrix& mRes) const
-{
-	if (nColCount < mRes.nColCount || nRowCount < mRes.nRowCount)
-	{
-		DBG_ERRORFILE("ScMatrix::MatCopyUpperLeft: dimension error");
-	}
-	else
-	{
-		if (mnValType)
-		{
-            ScMatValType nType;
-			mRes.ResetIsString();
-			for ( SCSIZE i = 0; i < mRes.nColCount; i++ )
-			{
-				SCSIZE nStart = i * nRowCount;
-				for ( SCSIZE j = 0; j < mRes.nRowCount; j++ )
-				{
-					if ( IsStringType( (nType = mnValType[nStart+j]) ))
-						mRes.PutStringEntry( pMat[nStart+j].pS, nType,
-							i*mRes.nRowCount+j );
-					else
-                    {
-						mRes.pMat[i*mRes.nRowCount+j].fVal = pMat[nStart+j].fVal;
-						mRes.mnValType[i*mRes.nRowCount+j] = nType;
-                    }
-				}
-			}
-		}
-		else
-		{
-			mRes.DeleteIsString();
-			for ( SCSIZE i = 0; i < mRes.nColCount; i++ )
-			{
-				SCSIZE nStart = i * nRowCount;
-				for ( SCSIZE j = 0; j < mRes.nRowCount; j++ )
-				{
-					mRes.pMat[i*mRes.nRowCount+j].fVal = pMat[nStart+j].fVal;
-				}
-			}
-		}
-	}
-}
-
 void ScMatrix::FillDouble( double fVal, SCSIZE nC1, SCSIZE nR1, SCSIZE nC2, SCSIZE nR2 )
 {
 	if (ValidColRow( nC1, nR1) && ValidColRow( nC2, nR2))
@@ -655,24 +591,6 @@
 	}
 }
 
-void ScMatrix::FillDoubleLowerLeft( double fVal, SCSIZE nC2 )
-{
-	if (ValidColRow( nC2, nC2))
-	{
-		for ( SCSIZE i=1; i<=nC2; i++ )
-		{
-			SCSIZE nOff1 = i * nRowCount;
-			SCSIZE nOff2 = nOff1 + i;
-			for ( SCSIZE j=nOff1; j<nOff2; j++ )
-				pMat[j].fVal = fVal;
-		}
-	}
-	else
-	{
-		DBG_ERRORFILE("ScMatrix::FillDoubleLowerLeft: dimension error");
-	}
-}
-
 void ScMatrix::CompareEqual()
 {
 	SCSIZE n = nColCount * nRowCount;
Index: sc/source/core/tool/subtotal.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/subtotal.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/core/tool/subtotal.cxx	10 Apr 2008 20:01:51 -0000	1.7
+++ sc/source/core/tool/subtotal.cxx	13 May 2008 14:34:10 -0000	1.7.32.1
@@ -39,6 +39,7 @@
 
 // -----------------------------------------------------------------------
 
+#if OLD_PIVOT_IMPLEMENTATION
 SubTotal::SubTotal()
 {
 	nIndex = 0;				//! test fuer Pivot
@@ -218,7 +219,7 @@
 	}
 	return nRet;
 }
-
+#endif
 
 BOOL SubTotal::SafePlus(double& fVal1, double fVal2)
 {
Index: sc/source/core/tool/token.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/token.cxx,v
retrieving revision 1.33
retrieving revision 1.33.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.32.2
--- sc/source/core/tool/token.cxx	10 Apr 2008 20:02:17 -0000	1.33
+++ sc/source/core/tool/token.cxx	12 May 2008 15:56:57 -0000	1.33.32.2
@@ -164,14 +164,6 @@
     nRefCnt = 0;
 }
 
-void ScRawToken::SetReference( ComplRefData& rRef )
-{
-    DBG_ASSERT( lcl_IsReference( eOp, GetType() ), "SetReference: no Ref" );
-    aRef = rRef;
-    if( GetType() == svSingleRef )
-        aRef.Ref2 = aRef.Ref1;
-}
-
 void ScRawToken::SetDouble(double rVal)
 {
     eOp   = ocPush;
@@ -180,14 +172,6 @@
     nRefCnt = 0;
 }
 
-void ScRawToken::SetInt(int rVal)
-{
-    eOp   = ocPush;
-    eType = svDouble;
-    nValue = (double)rVal;
-    nRefCnt = 0;
-}
-
 void ScRawToken::SetName( USHORT n )
 {
     eOp    = ocName;
@@ -196,11 +180,35 @@
     nRefCnt = 0;
 }
 
-ComplRefData& ScRawToken::GetReference()
-{
-    DBG_ASSERT( lcl_IsReference( eOp, GetType() ), "GetReference: no Ref" );
-    return aRef;
-}
+//UNUSED2008-05  void ScRawToken::SetInt(int rVal)
+//UNUSED2008-05  {
+//UNUSED2008-05      eOp   = ocPush;
+//UNUSED2008-05      eType = svDouble;
+//UNUSED2008-05      nValue = (double)rVal;
+//UNUSED2008-05      nRefCnt = 0;
+//UNUSED2008-05  
+//UNUSED2008-05  }
+//UNUSED2008-05  void ScRawToken::SetMatrix( ScMatrix* p )
+//UNUSED2008-05  {
+//UNUSED2008-05      eOp   = ocPush;
+//UNUSED2008-05      eType = svMatrix;
+//UNUSED2008-05      pMat  = p;
+//UNUSED2008-05      nRefCnt = 0;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  ComplRefData& ScRawToken::GetReference()
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( lcl_IsReference( eOp, GetType() ), "GetReference: no Ref" );
+//UNUSED2008-05      return aRef;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void ScRawToken::SetReference( ComplRefData& rRef )
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( lcl_IsReference( eOp, GetType() ), "SetReference: no Ref" );
+//UNUSED2008-05      aRef = rRef;
+//UNUSED2008-05      if( GetType() == svSingleRef )
+//UNUSED2008-05          aRef.Ref2 = aRef.Ref1;
+//UNUSED2008-05  }
 
 void ScRawToken::SetExternal( const sal_Unicode* pStr )
 {
@@ -215,14 +223,6 @@
     nRefCnt = 0;
 }
 
-void ScRawToken::SetMatrix( ScMatrix* p )
-{
-    eOp   = ocPush;
-    eType = svMatrix;
-    pMat  = p;
-    nRefCnt = 0;
-}
-
 USHORT lcl_ScRawTokenOffset()
 {
     // offset of sbyte in ScRawToken
@@ -602,28 +602,28 @@
 }
 
 
-BOOL ScToken::IsRPNReferenceAbsName() const
-{
-    if ( GetRef() == 1 && GetOpCode() == ocPush )
-    {   // only in RPN and not ocColRowNameAuto or similar
-        switch ( GetType() )
-        {
-            case svDoubleRef :
-                if ( !GetSingleRef2().IsRelName() )
-                    return TRUE;
-            //! fallthru
-            case svSingleRef :
-                if ( !GetSingleRef().IsRelName() )
-                    return TRUE;
-                break;
-            default:
-            {
-                // added to avoid warnings
-            }
-        }
-    }
-    return FALSE;
-}
+//UNUSED2008-05  BOOL ScToken::IsRPNReferenceAbsName() const
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( GetRef() == 1 && GetOpCode() == ocPush )
+//UNUSED2008-05      {   // only in RPN and not ocColRowNameAuto or similar
+//UNUSED2008-05          switch ( GetType() )
+//UNUSED2008-05          {
+//UNUSED2008-05              case svDoubleRef :
+//UNUSED2008-05                  if ( !GetSingleRef2().IsRelName() )
+//UNUSED2008-05                      return TRUE;
+//UNUSED2008-05                  //! fallthru
+//UNUSED2008-05              case svSingleRef :
+//UNUSED2008-05                  if ( !GetSingleRef().IsRelName() )
+//UNUSED2008-05                      return TRUE;
+//UNUSED2008-05                  break;
+//UNUSED2008-05              default:
+//UNUSED2008-05                  {
+//UNUSED2008-05                      // added to avoid warnings
+//UNUSED2008-05                  }
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05      return FALSE;
+//UNUSED2008-05  }
 
 
 // static
@@ -1381,15 +1381,15 @@
     return FALSE;
 }
 
-BOOL ScTokenArray::HasName() const
-{
-    for ( USHORT j=0; j < nLen; j++ )
-    {
-        if( pCode[j]->GetType() == svIndex )
-            return TRUE;
-    }
-    return FALSE;
-}
+//UNUSED2008-05  BOOL ScTokenArray::HasName() const
+//UNUSED2008-05  {
+//UNUSED2008-05      for ( USHORT j=0; j < nLen; j++ )
+//UNUSED2008-05      {
+//UNUSED2008-05          if ( pCode[j]->GetType() == svIndex )
+//UNUSED2008-05              return TRUE;
+//UNUSED2008-05      }
+//UNUSED2008-05      return FALSE;
+//UNUSED2008-05  }
 
 BOOL ScTokenArray::HasNameOrColRowName() const
 {
Index: sc/source/core/tool/userlist.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/userlist.cxx,v
retrieving revision 1.11
retrieving revision 1.11.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.3
--- sc/source/core/tool/userlist.cxx	10 Apr 2008 20:02:48 -0000	1.11
+++ sc/source/core/tool/userlist.cxx	13 May 2008 14:34:10 -0000	1.11.32.3
@@ -86,18 +86,6 @@
 	delete[] pUpperSub;
 }
 
-ScUserListData::ScUserListData( SvStream& rStream )
-{
-	rStream.ReadByteString( aStr, rStream.GetStreamCharSet() );
-	InitTokens();
-}
-
-BOOL ScUserListData::Store( SvStream& rStream ) const
-{
-	rStream.WriteByteString( aStr, rStream.GetStreamCharSet() );
-	return TRUE;
-}
-
 void ScUserListData::SetString( const String& rStr )
 {
 	delete[] pSubStrings;
@@ -261,34 +249,6 @@
     }
 }
 
-BOOL ScUserList::Load( SvStream& rStream )
-{
-	BOOL	bSuccess = TRUE;
-	USHORT	nNewCount;
-
-	while( nCount > 0 )
-		AtFree(0);					// alles loeschen
-
-	rStream >> nNewCount;
-
-	for ( USHORT i=0; i<nNewCount && bSuccess; i++ )
-		Insert( new ScUserListData( rStream ) );
-
-	return bSuccess;
-}
-
-BOOL ScUserList::Store( SvStream& rStream ) const
-{
-	BOOL bSuccess = TRUE;
-
-	rStream << nCount;
-
-	for ( USHORT i=0; i<nCount && bSuccess; i++ )
-		bSuccess = ((const ScUserListData*)At(i))->Store( rStream );
-
-	return bSuccess;
-}
-
 DataObject* ScUserList::Clone() const
 {
 	return ( new ScUserList( *this ) );
Index: sc/source/core/tool/viewopti.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/viewopti.cxx,v
retrieving revision 1.9
retrieving revision 1.9.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.3
--- sc/source/core/tool/viewopti.cxx	10 Apr 2008 20:03:03 -0000	1.9
+++ sc/source/core/tool/viewopti.cxx	13 May 2008 18:34:58 -0000	1.9.32.3
@@ -125,43 +125,6 @@
 }
 
 
-//------------------------------------------------------------------------
-
-SvStream& operator>>( SvStream& rStream, ScGridOptions& rOpt )
-{
-	BYTE nDummy;
-	rStream >> rOpt.nFldDrawX;
-	rStream >> rOpt.nFldDrawY;
-	rStream >> rOpt.nFldDivisionX;
-	rStream >> rOpt.nFldDivisionY;
-	rStream >> rOpt.nFldSnapX;
-	rStream >> rOpt.nFldSnapY;
-	rStream >> nDummy; rOpt.bUseGridsnap = (BOOL)nDummy;
-	rStream >> nDummy; rOpt.bSynchronize = (BOOL)nDummy;
-	rStream >> nDummy; rOpt.bGridVisible = (BOOL)nDummy;
-	rStream >> nDummy; rOpt.bEqualGrid	 = (BOOL)nDummy;
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-SvStream& operator<<( SvStream& rStream, const ScGridOptions& rOpt )
-{
-	rStream << rOpt.nFldDrawX;
-	rStream << rOpt.nFldDrawY;
-	rStream << rOpt.nFldDivisionX;
-	rStream << rOpt.nFldDivisionY;
-	rStream << rOpt.nFldSnapX;
-	rStream << rOpt.nFldSnapY;
-	rStream << (BOOL)rOpt.bUseGridsnap;
-	rStream << (BOOL)rOpt.bSynchronize;
-	rStream << (BOOL)rOpt.bGridVisible;
-	rStream << (BOOL)rOpt.bEqualGrid;
-
-	return rStream;
-}
-
 //========================================================================
 // class ScViewOptions
 //========================================================================
@@ -264,93 +227,6 @@
 
 //------------------------------------------------------------------------
 
-SvStream& operator>>( SvStream& rStream, ScViewOptions& rOpt )
-{
-	USHORT	i;
-	BYTE	n;
-
-	ScReadHeader aHdr( rStream );
-
-	for ( i=0; i<=VOPT_GRID; i++ )			// kompatibel bleiben -> nur bis VOPT_GRID
-		rStream >> rOpt.aOptArr[i];
-
-	for ( i=0; i<MAX_TYPE; i++ )
-    {
-		rStream >> n;
-
-		//#i80528# adapt to new range eventually
-		if((BYTE)VOBJ_MODE_HIDE < n) n = (BYTE)VOBJ_MODE_SHOW;
-
-		rOpt.aModeArr[i] = (ScVObjMode)n;
-    }
-
-	rStream >> rOpt.aGridCol;
-	rStream.ReadByteString( rOpt.aGridColName, rStream.GetStreamCharSet() );
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_HELPLINES];
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aGridOpt;
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.bHideAutoSpell;
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_ANCHOR];
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_PAGEBREAKS];
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_SOLIDHANDLES];
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_CLIPMARKS];
-
-	if( aHdr.BytesLeft() )
-		rStream >> rOpt.aOptArr[VOPT_BIGHANDLES];
-
-	return rStream;
-}
-
-//------------------------------------------------------------------------
-
-void ScViewOptions::Save(SvStream& rStream, BOOL bConfig) const
-{
-	USHORT i;
-
-	ScWriteHeader aHdr( rStream, 68 );
-
-	for ( i=0; i<=VOPT_GRID; i++ )			// kompatibel bleiben -> nur bis VOPT_GRID
-		rStream << aOptArr[i];
-
-	for ( i=0; i<MAX_TYPE; i++ )
-		rStream << (BYTE)aModeArr[i];
-
-	rStream << aGridCol;
-	rStream.WriteByteString( aGridColName, rStream.GetStreamCharSet() );
-	rStream << aOptArr[VOPT_HELPLINES];
-	rStream << aGridOpt;
-	rStream << bHideAutoSpell;
-	rStream << aOptArr[VOPT_ANCHOR];
-	rStream << aOptArr[VOPT_PAGEBREAKS];
-	rStream << aOptArr[VOPT_SOLIDHANDLES];
-
-	if ( bConfig || rStream.GetVersion() > SOFFICE_FILEFORMAT_40 )		// nicht bei 4.0 Export
-	{
-		rStream << aOptArr[VOPT_CLIPMARKS];
-
-		//	big handles are not saved in 5.0-documents to avoid warning messages
-		//!	save to files after 5.0 !!!
-
-		if ( bConfig )
-			rStream << aOptArr[VOPT_BIGHANDLES];
-	}
-}
-
-//------------------------------------------------------------------------
-
 SvxGridItem* ScViewOptions::CreateGridItem( USHORT nId /* = SID_ATTR_GRID_OPTIONS */ ) const
 {
 	SvxGridItem* pItem = new SvxGridItem( nId );
@@ -373,9 +249,9 @@
 //      ScTpViewItem - Daten fuer die ViewOptions-TabPage
 //========================================================================
 
-ScTpViewItem::ScTpViewItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
-{
-}
+//UNUSED2008-05  ScTpViewItem::ScTpViewItem( USHORT nWhichP ) : SfxPoolItem( nWhichP )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
Index: sc/source/filter/excel/colrowst.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/colrowst.cxx,v
retrieving revision 1.34
retrieving revision 1.34.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.32.1
--- sc/source/filter/excel/colrowst.cxx	10 Apr 2008 20:04:49 -0000	1.34
+++ sc/source/filter/excel/colrowst.cxx	10 May 2008 00:58:43 -0000	1.34.32.1
@@ -145,16 +145,6 @@
     }
 }
 
-void XclImpColRowSettings::HideRow( SCROW nScRow )
-{
-    if( ValidRow( nScRow ) )
-    {
-        ::set_flag( maRowFlags[ nScRow ], static_cast< sal_uInt8 >( EXC_COLROW_USED | EXC_COLROW_HIDDEN ) );
-        if( nScRow > mnLastScRow )
-            mnLastScRow = nScRow;
-    }
-}
-
 void XclImpColRowSettings::SetRowSettings( SCROW nScRow, sal_uInt16 nHeight, sal_uInt16 nFlags )
 {
     if( ValidRow( nScRow ) )
Index: sc/source/filter/excel/excel.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/excel.cxx,v
retrieving revision 1.26
retrieving revision 1.26.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.26 -r1.26.32.1
--- sc/source/filter/excel/excel.cxx	10 Apr 2008 20:05:23 -0000	1.26
+++ sc/source/filter/excel/excel.cxx	9 May 2008 16:11:48 -0000	1.26.32.1
@@ -54,12 +54,6 @@
 #include "exp_op.hxx"
 
 
-FltError ScImportExcel( SfxMedium& r, ScDocument* p )
-{
-	return ScImportExcel( r, p, EIF_AUTO );
-}
-
-
 FltError ScImportExcel( SfxMedium& rMedium, ScDocument* pDocument, const EXCIMPFORMAT eFormat )
 {
     // check the passed Calc document
@@ -168,16 +162,6 @@
 }
 
 
-
-
-FltError ScExportExcel234( SvStream& /*aStream*/, ScDocument* /*pDoc*/,
-    ExportFormatExcel /*eFormat*/, CharSet /*eNach*/ )
-{
-	FltError				eRet = eERR_NI;
-	return eRet;
-}
-
-
 FltError ScExportExcel5( SfxMedium& rMedium, ScDocument *pDocument,
 	const BOOL bBiff8, CharSet eNach )
 {
Index: sc/source/filter/excel/exctools.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/exctools.cxx,v
retrieving revision 1.61
retrieving revision 1.61.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.61 -r1.61.32.1
--- sc/source/filter/excel/exctools.cxx	10 Apr 2008 20:07:07 -0000	1.61
+++ sc/source/filter/excel/exctools.cxx	10 May 2008 00:58:43 -0000	1.61.32.1
@@ -285,19 +285,6 @@
 }
 
 
-void XclImpOutlineBuffer::Reset( ScOutlineArray *pOArray )
-{
-	for( SCSIZE nC = 0 ; nC < nSize ; nC++  )
-	{
-		pLevel[ nC ] = 0;
-		pOuted[ nC ] = pHidden[ nC ] = FALSE;
-	}
-	pOutlineArray = pOArray;
-}
-
-
-
-
 //___________________________________________________________________
 
 
Index: sc/source/filter/excel/frmbase.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/frmbase.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.3
--- sc/source/filter/excel/frmbase.cxx	10 Apr 2008 20:07:57 -0000	1.10
+++ sc/source/filter/excel/frmbase.cxx	12 May 2008 16:41:58 -0000	1.10.32.3
@@ -262,19 +262,19 @@
 {
 }
 
-void LotusConverterBase::Reset( INT32 nLen, const ScAddress& rEingPos )
-{
-	ConverterBase::Reset();
-	nBytesLeft = nLen;
-    aEingPos = rEingPos;
-}
-
-void LotusConverterBase::Reset( INT32 nLen )
-{
-	ConverterBase::Reset();
-	nBytesLeft = nLen;
-	aEingPos.Set( 0, 0, 0 );
-}
+//UNUSED2008-05  void LotusConverterBase::Reset( INT32 nLen, const ScAddress& rEingPos )
+//UNUSED2008-05  {
+//UNUSED2008-05      ConverterBase::Reset();
+//UNUSED2008-05      nBytesLeft = nLen;
+//UNUSED2008-05      aEingPos = rEingPos;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void LotusConverterBase::Reset( INT32 nLen )
+//UNUSED2008-05  {
+//UNUSED2008-05      ConverterBase::Reset();
+//UNUSED2008-05      nBytesLeft = nLen;
+//UNUSED2008-05      aEingPos.Set( 0, 0, 0 );
+//UNUSED2008-05  }
 
 void LotusConverterBase::Reset( const ScAddress& rEingPos )
 {
Index: sc/source/filter/excel/namebuff.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/namebuff.cxx,v
retrieving revision 1.26
retrieving revision 1.26.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.26 -r1.26.32.1
--- sc/source/filter/excel/namebuff.cxx	10 Apr 2008 20:08:59 -0000	1.26
+++ sc/source/filter/excel/namebuff.cxx	9 May 2008 04:45:57 -0000	1.26.32.1
@@ -88,41 +88,6 @@
 }
 
 
-void NameBuffer::Reset()
-{
-	register StringHashEntry*	pDel = ( StringHashEntry* ) List::First();
-	while( pDel )
-	{
-		delete pDel;
-		pDel = ( StringHashEntry* ) List::Next();
-	}
-	Clear();
-}
-
-
-BOOL NameBuffer::Find( const sal_Char* pRefName, UINT16& rIndex )
-{
-	StringHashEntry				aRefEntry( String::CreateFromAscii( pRefName ) );
-
-	register StringHashEntry*	pFind = ( StringHashEntry* ) List::First();
-	register UINT16				nCnt = nBase;
-	while( pFind )
-	{
-		if( *pFind == aRefEntry )
-		{
-			rIndex = nCnt;
-			return TRUE;
-		}
-		pFind = ( StringHashEntry* ) List::Next();
-		nCnt++;
-	}
-
-	return FALSE;
-}
-
-
-
-
 #ifdef DBG_UTIL
 UINT16	nShrCnt;
 #endif
@@ -306,18 +271,6 @@
 }
 
 
-BOOL ExtSheetBuffer::IsExternal( UINT16 nExcIndex ) const
-{
-	DBG_ASSERT( nExcIndex > 0, "*ExtSheetBuffer::IsExternal(): Index muss >0 sein!" );
-	Cont*	pRet = ( Cont * ) List::GetObject( nExcIndex - 1 );
-
-	if( pRet )
-		return !pRet->bSWB;
-	else
-		return FALSE;
-}
-
-
 void ExtSheetBuffer::Reset( void )
 {
 	Cont	*pAkt = ( Cont * ) List::First();
@@ -339,20 +292,6 @@
 }
 
 
-BOOL ExtName::IsOLE( void ) const
-{
-	return ( nFlags & 0x0002 ) != 0;
-}
-
-
-BOOL ExtName::IsName( void ) const
-{
-	return ( nFlags & 0x0004 ) != 0;
-}
-
-
-
-
 const sal_Char* ExtNameBuff::pJoostTest = "Joost ist immer noch doof!";
 
 
Index: sc/source/filter/excel/tokstack.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/tokstack.cxx,v
retrieving revision 1.14
retrieving revision 1.14.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.2
--- sc/source/filter/excel/tokstack.cxx	10 Apr 2008 20:09:39 -0000	1.14
+++ sc/source/filter/excel/tokstack.cxx	12 May 2008 15:56:57 -0000	1.14.32.2
@@ -529,26 +529,26 @@
 }
 
 
-const TokenId TokenPool::StoreError( USHORT nError )
-{
-    if( nElementAkt >= nElement )
-        GrowElement();
-
-    if( nP_ErrAkt >= nP_Err )
-        GrowError();
-
-    pElement[ nElementAkt ] = nP_ErrAkt;    // Index in Error-Array
-    pType[ nElementAkt ] = T_Err;           // Typinfo Error eintragen
-
-    pP_Err[ nP_ErrAkt ] = nError;
-
-    pSize[ nElementAkt ] = 1;           // eigentlich Banane
-
-    nElementAkt++;
-    nP_ErrAkt++;
-
-    return ( const TokenId ) nElementAkt; // Ausgabe von altem Wert + 1!
-}
+//UNUSED2008-05  const TokenId TokenPool::StoreError( USHORT nError )
+//UNUSED2008-05  {
+//UNUSED2008-05      if( nElementAkt >= nElement )
+//UNUSED2008-05          GrowElement();
+//UNUSED2008-05  
+//UNUSED2008-05      if( nP_ErrAkt >= nP_Err )
+//UNUSED2008-05          GrowError();
+//UNUSED2008-05  
+//UNUSED2008-05      pElement[ nElementAkt ] = nP_ErrAkt;    // Index in Error-Array
+//UNUSED2008-05      pType[ nElementAkt ] = T_Err;           // Typinfo Error eintragen
+//UNUSED2008-05  
+//UNUSED2008-05      pP_Err[ nP_ErrAkt ] = nError;
+//UNUSED2008-05  
+//UNUSED2008-05      pSize[ nElementAkt ] = 1;           // eigentlich Banane
+//UNUSED2008-05  
+//UNUSED2008-05      nElementAkt++;
+//UNUSED2008-05      nP_ErrAkt++;
+//UNUSED2008-05  
+//UNUSED2008-05      return ( const TokenId ) nElementAkt; // Ausgabe von altem Wert + 1!
+//UNUSED2008-05  }
 
 
 const TokenId TokenPool::Store( const UINT16 nIndex )
@@ -766,19 +766,19 @@
 }
 
 
-const String* TokenPool::GetString( const TokenId& r ) const
-{
-	const String*	p = NULL;
-    UINT16 n = (UINT16) r;
-	if( n && n <= nElementAkt )
-	{
-		n--;
-		if( pType[ n ] == T_Str )
-			p = ppP_Str[ pElement[ n ] ];
-	}
-
-	return p;
-}
+//UNUSED2008-05  const String* TokenPool::GetString( const TokenId& r ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      const String*   p = NULL;
+//UNUSED2008-05      UINT16 n = (UINT16) r;
+//UNUSED2008-05      if( n && n <= nElementAkt )
+//UNUSED2008-05      {
+//UNUSED2008-05          n--;
+//UNUSED2008-05          if( pType[ n ] == T_Str )
+//UNUSED2008-05              p = ppP_Str[ pElement[ n ] ];
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return p;
+//UNUSED2008-05  }
 
 ScMatrix* TokenPool::GetMatrix( unsigned int n ) const
 {
Index: sc/source/filter/excel/xeformula.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xeformula.cxx,v
retrieving revision 1.25
retrieving revision 1.25.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.30.1
--- sc/source/filter/excel/xeformula.cxx	10 Apr 2008 20:11:16 -0000	1.25
+++ sc/source/filter/excel/xeformula.cxx	13 May 2008 16:07:00 -0000	1.25.30.1
@@ -342,7 +342,7 @@
     void                AdjustLastTokenClassForEastereggOp();
 
     void                AppendOpTokenId( sal_uInt8 nTokenId, sal_uInt8 nExpClass, sal_uInt8 nSpaces = 0 );
-    void                AppendFuncTokenId( sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass, sal_uInt8 nSpaces = 0 );
+//UNUSED2008-05  void                AppendFuncTokenId( sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass, sal_uInt8 nSpaces = 0 );
     void                AppendVarFuncTokenId( sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass, sal_uInt8 nParamCount, sal_uInt8 nSpaces = 0 );
 
     // token vector -----------------------------------------------------------
@@ -2019,12 +2019,12 @@
     AdjustLastTokenClass( nExpClass );
 }
 
-void XclExpFmlaCompImpl::AppendFuncTokenId(
-        sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass, sal_uInt8 nSpaces )
-{
-    AppendOpTokenId( GetTokenId( EXC_TOKID_FUNC, nRetClass ), nExpRetClass, nSpaces );
-    Append( nXclFuncIdx );
-}
+//UNUSED2008-05  void XclExpFmlaCompImpl::AppendFuncTokenId(
+//UNUSED2008-05          sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass, sal_uInt8 nSpaces )
+//UNUSED2008-05  {
+//UNUSED2008-05      AppendOpTokenId( GetTokenId( EXC_TOKID_FUNC, nRetClass ), nExpRetClass, nSpaces );
+//UNUSED2008-05      Append( nXclFuncIdx );
+//UNUSED2008-05  }
 
 void XclExpFmlaCompImpl::AppendVarFuncTokenId(
         sal_uInt16 nXclFuncIdx, sal_uInt8 nRetClass, sal_uInt8 nExpRetClass,
Index: sc/source/filter/excel/xehelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xehelper.cxx,v
retrieving revision 1.31
retrieving revision 1.31.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.2
--- sc/source/filter/excel/xehelper.cxx	10 Apr 2008 20:11:36 -0000	1.31
+++ sc/source/filter/excel/xehelper.cxx	12 May 2008 16:41:58 -0000	1.31.32.2
@@ -258,23 +258,23 @@
     return bValidStart;
 }
 
-XclRange XclExpAddressConverter::CreateValidRange( const ScRange& rScRange, bool bWarn )
-{
-    return XclRange(
-        CreateValidAddress( rScRange.aStart, bWarn ),
-        CreateValidAddress( rScRange.aEnd, bWarn ) );
-}
+//UNUSED2008-05  XclRange XclExpAddressConverter::CreateValidRange( const ScRange& rScRange, bool bWarn )
+//UNUSED2008-05  {
+//UNUSED2008-05      return XclRange(
+//UNUSED2008-05          CreateValidAddress( rScRange.aStart, bWarn ),
+//UNUSED2008-05          CreateValidAddress( rScRange.aEnd, bWarn ) );
+//UNUSED2008-05  }
 
 // cell range list ------------------------------------------------------------
 
-bool XclExpAddressConverter::CheckRangeList( const ScRangeList& rScRanges, bool bWarn )
-{
-    for( ULONG nIdx = 0, nSize = rScRanges.Count(); nIdx < nSize; ++nIdx )
-        if( const ScRange* pScRange = rScRanges.GetObject( nIdx ) )
-            if( !CheckRange( *pScRange, bWarn ) )
-                return false;
-    return true;
-}
+//UNUSED2008-05  bool XclExpAddressConverter::CheckRangeList( const ScRangeList& rScRanges, bool bWarn )
+//UNUSED2008-05  {
+//UNUSED2008-05      for( ULONG nIdx = 0, nSize = rScRanges.Count(); nIdx < nSize; ++nIdx )
+//UNUSED2008-05          if( const ScRange* pScRange = rScRanges.GetObject( nIdx ) )
+//UNUSED2008-05              if( !CheckRange( *pScRange, bWarn ) )
+//UNUSED2008-05                  return false;
+//UNUSED2008-05      return true;
+//UNUSED2008-05  }
 
 void XclExpAddressConverter::ValidateRangeList( ScRangeList& rScRanges, bool bWarn )
 {
Index: sc/source/filter/excel/xerecord.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xerecord.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.2
--- sc/source/filter/excel/xerecord.cxx	10 Apr 2008 20:13:21 -0000	1.10
+++ sc/source/filter/excel/xerecord.cxx	12 May 2008 15:56:57 -0000	1.10.32.2
@@ -43,11 +43,11 @@
 {
 }
 
-void XclExpRecordBase::SaveRepeated( XclExpStream& rStrm, size_t nCount )
-{
-    for( size_t nIndex = 0; nIndex < nCount; ++nIndex )
-        Save( rStrm );
-}
+//UNUSED2008-05  void XclExpRecordBase::SaveRepeated( XclExpStream& rStrm, size_t nCount )
+//UNUSED2008-05  {
+//UNUSED2008-05      for( size_t nIndex = 0; nIndex < nCount; ++nIndex )
+//UNUSED2008-05          Save( rStrm );
+//UNUSED2008-05  }
 
 // ----------------------------------------------------------------------------
 
Index: sc/source/filter/excel/xestream.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xestream.cxx,v
retrieving revision 1.11
retrieving revision 1.11.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.30.2
--- sc/source/filter/excel/xestream.cxx	10 Apr 2008 20:13:53 -0000	1.11
+++ sc/source/filter/excel/xestream.cxx	12 May 2008 16:41:58 -0000	1.11.30.2
@@ -159,27 +159,27 @@
     return nRet;
 }
 
-void XclExpStream::WriteUnicodeBuffer( const sal_uInt16* pBuffer, sal_Size nChars, sal_uInt8 nFlags )
-{
-    SetSliceSize( 0 );
-    if( pBuffer && (nChars > 0) )
-    {
-        sal_uInt16 nCharLen = (nFlags & EXC_STRF_16BIT) ? 2 : 1;
-        for( sal_Size nIndex = 0; nIndex < nChars; ++nIndex )
-        {
-            if( mbInRec && (mnCurrSize + nCharLen > mnCurrMaxSize) )
-            {
-                StartContinue();
-                // repeat only 16bit flag
-                operator<<( static_cast< sal_uInt8 >( nFlags & EXC_STRF_16BIT ) );
-            }
-            if( nCharLen == 2 )
-                operator<<( pBuffer[ nIndex ] );
-            else
-                operator<<( static_cast< sal_uInt8 >( pBuffer[ nIndex ] ) );
-        }
-    }
-}
+//UNUSED2008-05  void XclExpStream::WriteUnicodeBuffer( const sal_uInt16* pBuffer, sal_Size nChars, sal_uInt8 nFlags )
+//UNUSED2008-05  {
+//UNUSED2008-05      SetSliceSize( 0 );
+//UNUSED2008-05      if( pBuffer && (nChars > 0) )
+//UNUSED2008-05      {
+//UNUSED2008-05          sal_uInt16 nCharLen = (nFlags & EXC_STRF_16BIT) ? 2 : 1;
+//UNUSED2008-05          for( sal_Size nIndex = 0; nIndex < nChars; ++nIndex )
+//UNUSED2008-05          {
+//UNUSED2008-05              if( mbInRec && (mnCurrSize + nCharLen > mnCurrMaxSize) )
+//UNUSED2008-05              {
+//UNUSED2008-05                  StartContinue();
+//UNUSED2008-05                  // repeat only 16bit flag
+//UNUSED2008-05                  operator<<( static_cast< sal_uInt8 >( nFlags & EXC_STRF_16BIT ) );
+//UNUSED2008-05              }
+//UNUSED2008-05              if( nCharLen == 2 )
+//UNUSED2008-05                  operator<<( pBuffer[ nIndex ] );
+//UNUSED2008-05              else
+//UNUSED2008-05                  operator<<( static_cast< sal_uInt8 >( pBuffer[ nIndex ] ) );
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 void XclExpStream::WriteUnicodeBuffer( const ScfUInt16Vec& rBuffer, sal_uInt8 nFlags )
 {
@@ -202,11 +202,11 @@
     }
 }
 
-void XclExpStream::WriteByteStringBuffer( const ByteString& rString, sal_uInt16 nMaxLen )
-{
-    SetSliceSize( 0 );
-    Write( rString.GetBuffer(), ::std::min< sal_Size >( rString.Len(), nMaxLen ) );
-}
+//UNUSED2008-05  void XclExpStream::WriteByteStringBuffer( const ByteString& rString, sal_uInt16 nMaxLen )
+//UNUSED2008-05  {
+//UNUSED2008-05      SetSliceSize( 0 );
+//UNUSED2008-05      Write( rString.GetBuffer(), ::std::min< sal_Size >( rString.Len(), nMaxLen ) );
+//UNUSED2008-05  }
 
 // ER: #71367# Xcl has an obscure sense of whether starting a new record or not,
 // and crashes if it encounters the string header at the very end of a record.
Index: sc/source/filter/excel/xestring.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xestring.cxx,v
retrieving revision 1.13
retrieving revision 1.13.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.2
--- sc/source/filter/excel/xestring.cxx	10 Apr 2008 20:14:12 -0000	1.13
+++ sc/source/filter/excel/xestring.cxx	12 May 2008 16:41:59 -0000	1.13.32.2
@@ -118,24 +118,24 @@
     Assign( rString, nFlags, nMaxLen );
 }
 
-XclExpString::XclExpString(
-    const String& rString, const XclFormatRunVec& rFormats,
-    XclStrFlags nFlags, sal_uInt16 nMaxLen )
-{
-    Assign( rString, rFormats, nFlags, nMaxLen );
-}
-
 XclExpString::XclExpString( const OUString& rString, XclStrFlags nFlags, sal_uInt16 nMaxLen )
 {
     Assign( rString, nFlags, nMaxLen );
 }
 
-XclExpString::XclExpString(
-        const OUString& rString, const XclFormatRunVec& rFormats,
-        XclStrFlags nFlags, sal_uInt16 nMaxLen )
-{
-    Assign( rString, rFormats, nFlags, nMaxLen );
-}
+//UNUSED2008-05  XclExpString::XclExpString(
+//UNUSED2008-05      const String& rString, const XclFormatRunVec& rFormats,
+//UNUSED2008-05      XclStrFlags nFlags, sal_uInt16 nMaxLen )
+//UNUSED2008-05  {
+//UNUSED2008-05      Assign( rString, rFormats, nFlags, nMaxLen );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  XclExpString::XclExpString(
+//UNUSED2008-05          const OUString& rString, const XclFormatRunVec& rFormats,
+//UNUSED2008-05          XclStrFlags nFlags, sal_uInt16 nMaxLen )
+//UNUSED2008-05  {
+//UNUSED2008-05      Assign( rString, rFormats, nFlags, nMaxLen );
+//UNUSED2008-05  }
 
 // assign ---------------------------------------------------------------------
 
@@ -177,19 +177,19 @@
     Build( aByteStr.GetBuffer(), aByteStr.Len(), nFlags, nMaxLen );
 }
 
-void XclExpString::AssignByte( sal_Unicode cChar, rtl_TextEncoding eTextEnc, XclStrFlags nFlags, sal_uInt16 nMaxLen )
-{
-    if( !cChar )
-    {
-        sal_Char cByteChar = 0;
-        Build( &cByteChar, 1, nFlags, nMaxLen );
-    }
-    else
-    {
-        ByteString aByteStr( &cChar, 1, eTextEnc );     // length may be >1
-        Build( aByteStr.GetBuffer(), aByteStr.Len(), nFlags, nMaxLen );
-    }
-}
+//UNUSED2008-05  void XclExpString::AssignByte( sal_Unicode cChar, rtl_TextEncoding eTextEnc, XclStrFlags nFlags, sal_uInt16 nMaxLen )
+//UNUSED2008-05  {
+//UNUSED2008-05      if( !cChar )
+//UNUSED2008-05      {
+//UNUSED2008-05          sal_Char cByteChar = 0;
+//UNUSED2008-05          Build( &cByteChar, 1, nFlags, nMaxLen );
+//UNUSED2008-05      }
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          ByteString aByteStr( &cChar, 1, eTextEnc );     // length may be >1
+//UNUSED2008-05          Build( aByteStr.GetBuffer(), aByteStr.Len(), nFlags, nMaxLen );
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 // append ---------------------------------------------------------------------
 
@@ -198,15 +198,15 @@
     BuildAppend( rString.GetBuffer(), rString.Len() );
 }
 
-void XclExpString::Append( const ::rtl::OUString& rString )
-{
-    BuildAppend( rString.getStr(), rString.getLength() );
-}
-
-void XclExpString::Append( sal_Unicode cChar )
-{
-    BuildAppend( &cChar, 1 );
-}
+//UNUSED2008-05  void XclExpString::Append( const ::rtl::OUString& rString )
+//UNUSED2008-05  {
+//UNUSED2008-05      BuildAppend( rString.getStr(), rString.getLength() );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpString::Append( sal_Unicode cChar )
+//UNUSED2008-05  {
+//UNUSED2008-05      BuildAppend( &cChar, 1 );
+//UNUSED2008-05  }
 
 void XclExpString::AppendByte( const String& rString, rtl_TextEncoding eTextEnc )
 {
Index: sc/source/filter/excel/xestyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xestyle.cxx,v
retrieving revision 1.33
retrieving revision 1.33.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.32.2
--- sc/source/filter/excel/xestyle.cxx	10 Apr 2008 20:14:39 -0000	1.33
+++ sc/source/filter/excel/xestyle.cxx	12 May 2008 15:56:57 -0000	1.33.32.2
@@ -1813,30 +1813,48 @@
 {
 }
 
-void XclExpDefaultXF::SetParent( sal_uInt32 nParentXFId )
-{
-    DBG_ASSERT( IsCellXF(), "XclExpDefaultXF::SetParent - not allowed in style XFs" );
-    if( IsCellXF() )
-        mnParentXFId = nParentXFId;
-}
-
-void XclExpDefaultXF::SetUsedFlags(
-        bool bProtUsed, bool bFontUsed, bool bFmtUsed,
-        bool bAlignUsed, bool bBorderUsed, bool bAreaUsed )
-{
-    mbProtUsed    = bProtUsed;
-    mbFontUsed    = bFontUsed;
-    mbFmtUsed     = bFmtUsed;
-    mbAlignUsed   = bAlignUsed;
-    mbBorderUsed  = bBorderUsed;
-    mbAreaUsed    = bAreaUsed;
-}
-
-void XclExpDefaultXF::SetProtection( const XclExpCellProt& rProtection )
-{
-    maProtection = rProtection;
-    mbProtUsed = true;
-}
+//UNUSED2008-05  void XclExpDefaultXF::SetParent( sal_uInt32 nParentXFId )
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( IsCellXF(), "XclExpDefaultXF::SetParent - not allowed in style XFs" );
+//UNUSED2008-05      if( IsCellXF() )
+//UNUSED2008-05          mnParentXFId = nParentXFId;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpDefaultXF::SetUsedFlags(
+//UNUSED2008-05          bool bProtUsed, bool bFontUsed, bool bFmtUsed,
+//UNUSED2008-05          bool bAlignUsed, bool bBorderUsed, bool bAreaUsed )
+//UNUSED2008-05  {
+//UNUSED2008-05      mbProtUsed    = bProtUsed;
+//UNUSED2008-05      mbFontUsed    = bFontUsed;
+//UNUSED2008-05      mbFmtUsed     = bFmtUsed;
+//UNUSED2008-05      mbAlignUsed   = bAlignUsed;
+//UNUSED2008-05      mbBorderUsed  = bBorderUsed;
+//UNUSED2008-05      mbAreaUsed    = bAreaUsed;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpDefaultXF::SetProtection( const XclExpCellProt& rProtection )
+//UNUSED2008-05  {
+//UNUSED2008-05      maProtection = rProtection;
+//UNUSED2008-05      mbProtUsed = true;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpDefaultXF::SetAlignment( const XclExpCellAlign& rAlignment )
+//UNUSED2008-05  {
+//UNUSED2008-05      maAlignment = rAlignment;
+//UNUSED2008-05      mbAlignUsed = true;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpDefaultXF::SetBorder( const XclExpCellBorder& rBorder )
+//UNUSED2008-05  {
+//UNUSED2008-05      maBorder = rBorder;
+//UNUSED2008-05      mbBorderUsed = true;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void XclExpDefaultXF::SetArea( const XclExpCellArea& rArea )
+//UNUSED2008-05  {
+//UNUSED2008-05      maArea = rArea;
+//UNUSED2008-05      mbAreaUsed = true;
+//UNUSED2008-05  }
 
 void XclExpDefaultXF::SetFont( sal_uInt16 nXclFont )
 {
@@ -1850,24 +1868,6 @@
     mbFmtUsed = true;
 }
 
-void XclExpDefaultXF::SetAlignment( const XclExpCellAlign& rAlignment )
-{
-    maAlignment = rAlignment;
-    mbAlignUsed = true;
-}
-
-void XclExpDefaultXF::SetBorder( const XclExpCellBorder& rBorder )
-{
-    maBorder = rBorder;
-    mbBorderUsed = true;
-}
-
-void XclExpDefaultXF::SetArea( const XclExpCellArea& rArea )
-{
-    maArea = rArea;
-    mbAreaUsed = true;
-}
-
 // ----------------------------------------------------------------------------
 
 XclExpStyle::XclExpStyle( sal_uInt32 nXFId, const String& rStyleName ) :
Index: sc/source/filter/excel/xistream.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xistream.cxx,v
retrieving revision 1.22
retrieving revision 1.22.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.30.3
--- sc/source/filter/excel/xistream.cxx	10 Apr 2008 20:18:15 -0000	1.22
+++ sc/source/filter/excel/xistream.cxx	13 May 2008 14:34:11 -0000	1.22.30.3
@@ -468,12 +468,12 @@
     }
 }
 
-void XclImpStream::RejectPosition()
-{
-    DBG_ASSERT( !maPosStack.empty(), "XclImpStream::RejectPosition - stack empty" );
-    if( !maPosStack.empty() )
-        maPosStack.pop_back();
-}
+//UNUSED2008-05  void XclImpStream::RejectPosition()
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ASSERT( !maPosStack.empty(), "XclImpStream::RejectPosition - stack empty" );
+//UNUSED2008-05      if( !maPosStack.empty() )
+//UNUSED2008-05          maPosStack.pop_back();
+//UNUSED2008-05  }
 
 void XclImpStream::StoreGlobalPosition()
 {
@@ -770,18 +770,18 @@
     return nRet;
 }
 
-sal_Size XclImpStream::CopyRecordToStream( SvStream& rOutStrm )
-{
-    sal_Size nRet = 0;
-    if( mbValidRec )
-    {
-        PushPosition();
-        RestorePosition( maFirstRec );
-        nRet = CopyToStream( rOutStrm, GetRecSize() );
-        PopPosition();
-    }
-    return nRet;
-}
+//UNUSED2008-05  sal_Size XclImpStream::CopyRecordToStream( SvStream& rOutStrm )
+//UNUSED2008-05  {
+//UNUSED2008-05      sal_Size nRet = 0;
+//UNUSED2008-05      if( mbValidRec )
+//UNUSED2008-05      {
+//UNUSED2008-05          PushPosition();
+//UNUSED2008-05          RestorePosition( maFirstRec );
+//UNUSED2008-05          nRet = CopyToStream( rOutStrm, GetRecSize() );
+//UNUSED2008-05          PopPosition();
+//UNUSED2008-05      }
+//UNUSED2008-05      return nRet;
+//UNUSED2008-05  }
 
 void XclImpStream::Seek( sal_Size nPos )
 {
@@ -974,11 +974,6 @@
     return ReadRawByteString( ReadByteStrLen( b16BitLen ) );
 }
 
-void XclImpStream::IgnoreByteString( bool b16BitLen )
-{
-    Ignore( ReadByteStrLen( b16BitLen ) );
-}
-
 // private --------------------------------------------------------------------
 
 void XclImpStream::StorePosition( XclImpStreamPos& rPos )
Index: sc/source/filter/excel/xlpivot.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xlpivot.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/filter/excel/xlpivot.cxx	10 Apr 2008 20:21:51 -0000	1.12
+++ sc/source/filter/excel/xlpivot.cxx	12 May 2008 15:56:57 -0000	1.12.32.2
@@ -214,11 +214,6 @@
     SetNumType();
 }
 
-bool XclPCNumGroupInfo::IsNumType() const
-{
-    return GetXclDataType() == EXC_SXNUMGROUP_TYPE_NUM;
-}
-
 void XclPCNumGroupInfo::SetNumType()
 {
     SetXclDataType( EXC_SXNUMGROUP_TYPE_NUM );
@@ -302,10 +297,10 @@
     return meFieldType == EXC_PCFIELD_STANDARD;
 }
 
-bool XclPCField::IsCalculatedField() const
-{
-    return meFieldType == EXC_PCFIELD_CALCED;
-}
+//UNUSED2008-05  bool XclPCField::IsCalculatedField() const
+//UNUSED2008-05  {
+//UNUSED2008-05      return meFieldType == EXC_PCFIELD_CALCED;
+//UNUSED2008-05  }
 
 bool XclPCField::IsStdGroupField() const
 {
Index: sc/source/filter/excel/xlstyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xlstyle.cxx,v
retrieving revision 1.27
retrieving revision 1.27.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.27 -r1.27.32.2
--- sc/source/filter/excel/xlstyle.cxx	10 Apr 2008 20:22:50 -0000	1.27
+++ sc/source/filter/excel/xlstyle.cxx	12 May 2008 15:56:58 -0000	1.27.32.2
@@ -1470,11 +1470,11 @@
         InsertBuiltinFormats();
 }
 
-const XclNumFmt* XclNumFmtBuffer::GetFormat( sal_uInt16 nXclNumFmt ) const
-{
-    XclNumFmtMap::const_iterator aIt = maFmtMap.find( nXclNumFmt );
-    return (aIt != maFmtMap.end()) ? &aIt->second : 0;
-}
+//UNUSED2008-05  const XclNumFmt* XclNumFmtBuffer::GetFormat( sal_uInt16 nXclNumFmt ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      XclNumFmtMap::const_iterator aIt = maFmtMap.find( nXclNumFmt );
+//UNUSED2008-05      return (aIt != maFmtMap.end()) ? &aIt->second : 0;
+//UNUSED2008-05  }
 
 void XclNumFmtBuffer::InsertFormat( sal_uInt16 nXclNumFmt, const String& rFormat )
 {
Index: sc/source/filter/excel/xltools.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xltools.cxx,v
retrieving revision 1.31
retrieving revision 1.31.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.2
--- sc/source/filter/excel/xltools.cxx	10 Apr 2008 20:23:14 -0000	1.31
+++ sc/source/filter/excel/xltools.cxx	12 May 2008 16:41:59 -0000	1.31.32.2
@@ -428,16 +428,16 @@
     return pEntry->meTextEnc;
 }
 
-sal_uInt16 XclTools::GetXclCodePage( rtl_TextEncoding eTextEnc )
-{
-    const XclCodePageEntry* pEntry = ::std::find_if( pCodePageTable, pCodePageTableEnd, XclCodePageEntry_TEPred( eTextEnc ) );
-    if( pEntry == pCodePageTableEnd )
-    {
-        DBG_ERROR1( "XclTools::GetXclCodePage - unsupported text encoding: %d", eTextEnc );
-        return 1252;
-    }
-    return pEntry->mnCodePage;
-}
+//UNUSED2008-05  sal_uInt16 XclTools::GetXclCodePage( rtl_TextEncoding eTextEnc )
+//UNUSED2008-05  {
+//UNUSED2008-05      const XclCodePageEntry* pEntry = ::std::find_if( pCodePageTable, pCodePageTableEnd, XclCodePageEntry_TEPred( eTextEnc ) );
+//UNUSED2008-05      if( pEntry == pCodePageTableEnd )
+//UNUSED2008-05      {
+//UNUSED2008-05          DBG_ERROR1( "XclTools::GetXclCodePage - unsupported text encoding: %d", eTextEnc );
+//UNUSED2008-05          return 1252;
+//UNUSED2008-05      }
+//UNUSED2008-05      return pEntry->mnCodePage;
+//UNUSED2008-05  }
 
 // font names -----------------------------------------------------------------
 
Index: sc/source/filter/excel/xltracer.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xltracer.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/source/filter/excel/xltracer.cxx	10 Apr 2008 20:23:32 -0000	1.10
+++ sc/source/filter/excel/xltracer.cxx	9 May 2008 04:45:57 -0000	1.10.32.1
@@ -103,12 +103,6 @@
         mpTracer->AddAttribute( rName, rValue );
 }
 
-void XclTracer::AddAttribute( const OUString& rName, sal_Int32 nValue )
-{
-    if( mbEnabled )
-        mpTracer->AddAttribute( rName, OUString::valueOf( nValue ) );
-}
-
 void XclTracer::Trace( const OUString& rElementID, const OUString& rMessage )
 {
     if( mbEnabled )
@@ -118,15 +112,6 @@
     }
 }
 
-void XclTracer::Trace( const OUString& rElementID, sal_Int32 nMessage )
-{
-    if( mbEnabled )
-    {
-        mpTracer->Trace( rElementID, OUString::valueOf( nMessage ) );
-        mpTracer->ClearAttributes();
-    }
-}
-
 void XclTracer::TraceLog( XclTracerId eProblem, sal_Int32 nValue )
 {
     if( mbEnabled )
@@ -219,17 +204,6 @@
         ProcessTraceOnce(eFillPattern);
 }
 
-void XclTracer::TraceInvisibleGrid( bool bVisibleGrid)
-{
-    // Excel supports Grid lines on a per sheet basis while
-    // Calc displays grid lines on a per doc basis based on the
-    // first visible sheet. If the first visible sheet has the
-    // grid turned off then potentially we may have a problem.
-
-    if(!bVisibleGrid)
-        ProcessTraceOnce(eInvisibleGrid);
-}
-
 void XclTracer::TraceFormulaExtName( )
 {
     // import cannot access Excel External name ranges in
@@ -260,37 +234,11 @@
     ProcessTraceOnce(eChartUnKnownType);
 }
 
-void XclTracer::TraceChartTrendLines()
-{
-    ProcessTraceOnce(eChartTrendLines);
-}
-
-void XclTracer::TraceChartErrorBars()
-{
-    ProcessTraceOnce( eChartErrorBars );
-}
-
 void XclTracer::TraceChartOnlySheet()
 {
     ProcessTraceOnce(eChartOnlySheet);
 }
 
-void XclTracer::TraceChartRange()
-{
-    // Chart range symmetry is essential to display a chart. If the count
-    // of category values is not equal to the count of values or the start row/column
-    // depending on type, is not the same, then the chart range is said to be not
-    // symmetrical and will not display correctly.
-    ProcessTraceOnce(eChartRange);
-}
-
-void XclTracer::TraceChartDSName()
-{
-    // Data series names must be linked to a cell to appear. Hard
-    // coded strings contained in the ChartSeriestext() do not appear.
-    ProcessTraceOnce(eChartDSName);
-}
-
 void XclTracer::TraceChartDataTable()
 {
     // Data table is not supported.
@@ -304,37 +252,12 @@
     ProcessTraceOnce(eChartLegendPosition);
 }
 
-void XclTracer::TraceChartTextFormatting()
-{
-    // text formatting in titles or data labels not supported.
-    ProcessTraceOnce(eChartTextFormatting);
-}
-
 void XclTracer::TraceChartEmbeddedObj()
 {
     // drawing objects e.g. text boxes etc not supported inside charts
     ProcessTraceOnce(eChartEmbeddedObj);
 }
 
-void XclTracer::TraceChartAxisAutoCross()
-{
-    // Axis intervals generated automatically may not be the same.
-    ProcessTraceOnce(eChartAxisAuto);
-}
-
-void XclTracer::TraceChartAxisManualCross()
-{
-    // Manual axis crossing point changed
-    ProcessTraceOnce(eChartAxisManual);
-}
-
-void XclTracer::TraceChartInvalidXY()
-{
-    // Scatter charts will ony appear if the category(X) data range is
-    // located in the left most column in relation to the value range.
-    ProcessTraceOnce(eChartInvalidXY);
-}
-
 void XclTracer::TraceUnsupportedObjects()
 {
     // Called from Excel 5.0 - limited Graphical object support.
Index: sc/source/filter/ftools/fapihelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/ftools/fapihelper.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.2
--- sc/source/filter/ftools/fapihelper.cxx	10 Apr 2008 20:24:02 -0000	1.10
+++ sc/source/filter/ftools/fapihelper.cxx	12 May 2008 15:56:58 -0000	1.10.32.2
@@ -109,35 +109,35 @@
     return CreateInstance( ::comphelper::getProcessServiceFactory(), rServiceName );
 }
 
-Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
-        Reference< XMultiServiceFactory > xFactory, const OUString& rServiceName, const Sequence< Any >& rArgs )
-{
-    Reference< XInterface > xInt;
-    if( xFactory.is() )
-    {
-        try
-        {
-            xInt = xFactory->createInstanceWithArguments( rServiceName, rArgs );
-        }
-        catch( Exception& )
-        {
-            DBG_ERRORFILE( "ScfApiHelper::CreateInstanceWithArgs - cannot create instance" );
-        }
-    }
-    return xInt;
-}
-
-Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
-        SfxObjectShell* pShell, const OUString& rServiceName, const Sequence< Any >& rArgs )
-{
-    return CreateInstanceWithArgs( GetServiceFactory( pShell ), rServiceName, rArgs );
-}
-
-Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
-        const OUString& rServiceName, const Sequence< Any >& rArgs )
-{
-    return CreateInstanceWithArgs( ::comphelper::getProcessServiceFactory(), rServiceName, rArgs );
-}
+//UNUSED2008-05  Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
+//UNUSED2008-05          Reference< XMultiServiceFactory > xFactory, const OUString& rServiceName, const Sequence< Any >& rArgs )
+//UNUSED2008-05  {
+//UNUSED2008-05      Reference< XInterface > xInt;
+//UNUSED2008-05      if( xFactory.is() )
+//UNUSED2008-05      {
+//UNUSED2008-05          try
+//UNUSED2008-05          {
+//UNUSED2008-05              xInt = xFactory->createInstanceWithArguments( rServiceName, rArgs );
+//UNUSED2008-05          }
+//UNUSED2008-05          catch( Exception& )
+//UNUSED2008-05          {
+//UNUSED2008-05              DBG_ERRORFILE( "ScfApiHelper::CreateInstanceWithArgs - cannot create instance" );
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05      return xInt;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
+//UNUSED2008-05          SfxObjectShell* pShell, const OUString& rServiceName, const Sequence< Any >& rArgs )
+//UNUSED2008-05  {
+//UNUSED2008-05      return CreateInstanceWithArgs( GetServiceFactory( pShell ), rServiceName, rArgs );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  Reference< XInterface > ScfApiHelper::CreateInstanceWithArgs(
+//UNUSED2008-05          const OUString& rServiceName, const Sequence< Any >& rArgs )
+//UNUSED2008-05  {
+//UNUSED2008-05      return CreateInstanceWithArgs( ::comphelper::getProcessServiceFactory(), rServiceName, rArgs );
+//UNUSED2008-05  }
 
 String ScfApiHelper::QueryPasswordForMedium( SfxMedium& rMedium )
 {
Index: sc/source/filter/ftools/fprogressbar.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/ftools/fprogressbar.cxx,v
retrieving revision 1.10
retrieving revision 1.10.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.2
--- sc/source/filter/ftools/fprogressbar.cxx	10 Apr 2008 20:25:18 -0000	1.10
+++ sc/source/filter/ftools/fprogressbar.cxx	12 May 2008 15:56:58 -0000	1.10.32.2
@@ -231,11 +231,11 @@
 
 // ============================================================================
 
-ScfStreamProgressBar::ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, const String& rText ) :
-    mrStrm( rStrm )
-{
-    Init( pDocShell, rText );
-}
+//UNUSED2008-05  ScfStreamProgressBar::ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, const String& rText ) :
+//UNUSED2008-05      mrStrm( rStrm )
+//UNUSED2008-05  {
+//UNUSED2008-05      Init( pDocShell, rText );
+//UNUSED2008-05  }
 
 ScfStreamProgressBar::ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, USHORT nResId ) :
     mrStrm( rStrm )
Index: sc/source/filter/html/htmlpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/html/htmlpars.cxx,v
retrieving revision 1.34
retrieving revision 1.34.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.32.1
--- sc/source/filter/html/htmlpars.cxx	10 Apr 2008 20:27:15 -0000	1.34
+++ sc/source/filter/html/htmlpars.cxx	9 May 2008 16:11:48 -0000	1.34.32.1
@@ -2829,20 +2829,6 @@
     return mpGlobTable.get();
 }
 
-
-// ----------------------------------------------------------------------------
-
-ScHTMLTable* ScHTMLQueryParser::GetTable( ScHTMLTableId nTableId ) const
-{
-    if( nTableId == SC_HTML_GLOBAL_TABLE )
-        return mpGlobTable.get();
-    ScHTMLTable* pTable = mpGlobTable->FindNestedTable( nTableId );
-    DBG_ASSERT( pTable, "ScHTMLQueryParser::GetTable - table not found" );
-    if( !pTable )
-        return mpGlobTable.get();
-    return pTable;
-}
-
 void ScHTMLQueryParser::ProcessToken( const ImportInfo& rInfo )
 {
     switch( rInfo.nToken )
Index: sc/source/filter/inc/colrowst.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/colrowst.hxx,v
retrieving revision 1.23
retrieving revision 1.23.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.32.1
--- sc/source/filter/inc/colrowst.hxx	10 Apr 2008 20:29:05 -0000	1.23
+++ sc/source/filter/inc/colrowst.hxx	10 May 2008 00:58:44 -0000	1.23.32.1
@@ -52,7 +52,6 @@
 
     void                SetDefHeight( sal_uInt16 nDefHeight, sal_uInt16 nFlags );
     void                SetHeight( SCROW nRow, sal_uInt16 nHeight );
-    void                HideRow( SCROW nRow );
     void                SetRowSettings( SCROW nRow, sal_uInt16 nHeight, sal_uInt16 nFlags );
 
     void                SetDefaultXF( SCCOL nScCol1, SCCOL nScCol2, sal_uInt16 nXFIndex );
Index: sc/source/filter/inc/exp_op.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/exp_op.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.2
--- sc/source/filter/inc/exp_op.hxx	10 Apr 2008 20:31:47 -0000	1.13
+++ sc/source/filter/inc/exp_op.hxx	12 May 2008 16:11:56 -0000	1.13.32.2
@@ -62,7 +62,7 @@
 
 
 
-
+#if ENABLE_LOTUS123_EXPORT
 class ExportWK1 : public ExportTyp
 {
 private:
@@ -101,7 +101,7 @@
 
 	FltError			Write();
 };
-
+#endif
 
 
 
Index: sc/source/filter/inc/fapihelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/fapihelper.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.2
--- sc/source/filter/inc/fapihelper.hxx	10 Apr 2008 20:32:18 -0000	1.11
+++ sc/source/filter/inc/fapihelper.hxx	12 May 2008 15:56:58 -0000	1.11.32.2
@@ -89,22 +89,22 @@
     /** Creates an instance from the passed service name, using the process service factory. */
     static XInterfaceRef CreateInstance( const ::rtl::OUString& rServiceName );
 
-    /** Creates an instance from the passed service name, using the passed service factory. */
-    static XInterfaceRef CreateInstanceWithArgs(
-                            XServiceFactoryRef xFactory,
-                            const ::rtl::OUString& rServiceName,
-                            const UnoAnySequence& rArgs );
-
-    /** Creates an instance from the passed service name, using the service factory of the passed object. */
-    static XInterfaceRef CreateInstanceWithArgs(
-                            SfxObjectShell* pShell,
-                            const ::rtl::OUString& rServiceName,
-                            const UnoAnySequence& rArgs );
-
-    /** Creates an instance from the passed service name, using the process service factory. */
-    static XInterfaceRef CreateInstanceWithArgs(
-                            const ::rtl::OUString& rServiceName,
-                            const UnoAnySequence& rArgs );
+//UNUSED2008-05  /** Creates an instance from the passed service name, using the passed service factory. */
+//UNUSED2008-05  static XInterfaceRef CreateInstanceWithArgs(
+//UNUSED2008-05                          XServiceFactoryRef xFactory,
+//UNUSED2008-05                          const ::rtl::OUString& rServiceName,
+//UNUSED2008-05                          const UnoAnySequence& rArgs );
+//UNUSED2008-05  
+//UNUSED2008-05  /** Creates an instance from the passed service name, using the service factory of the passed object. */
+//UNUSED2008-05  static XInterfaceRef CreateInstanceWithArgs(
+//UNUSED2008-05                          SfxObjectShell* pShell,
+//UNUSED2008-05                          const ::rtl::OUString& rServiceName,
+//UNUSED2008-05                          const UnoAnySequence& rArgs );
+//UNUSED2008-05  
+//UNUSED2008-05  /** Creates an instance from the passed service name, using the process service factory. */
+//UNUSED2008-05  static XInterfaceRef CreateInstanceWithArgs(
+//UNUSED2008-05                          const ::rtl::OUString& rServiceName,
+//UNUSED2008-05                          const UnoAnySequence& rArgs );
 
     /** Opens a password dialog and returns the entered password.
         @return  The entered password or an empty string on 'Cancel' or any error. */
Index: sc/source/filter/inc/fdumper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/fdumper.hxx,v
retrieving revision 1.8
retrieving revision 1.8.28.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.28.1
--- sc/source/filter/inc/fdumper.hxx	10 Apr 2008 20:32:35 -0000	1.8
+++ sc/source/filter/inc/fdumper.hxx	9 May 2008 21:22:41 -0000	1.8.28.1
@@ -31,7 +31,7 @@
 #ifndef SC_FDUMPER_HXX
 #define SC_FDUMPER_HXX
 
-#define SCF_INCL_DUMPER (OSL_DEBUG_LEVEL > 0)
+#define SCF_INCL_DUMPER (OSL_DEBUG_LEVEL > 0) && 0
 
 #if SCF_INCL_DUMPER
 
Index: sc/source/filter/inc/formel.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/formel.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.3
--- sc/source/filter/inc/formel.hxx	10 Apr 2008 20:34:11 -0000	1.11
+++ sc/source/filter/inc/formel.hxx	12 May 2008 16:41:59 -0000	1.11.32.3
@@ -242,8 +242,8 @@
 	virtual				~LotusConverterBase();
 
 public:
-	void	 			Reset( INT32 nLen );
-    void                Reset( INT32 nLen, const ScAddress& rEingPos );
+//UNUSED2008-05  void                Reset( INT32 nLen );
+//UNUSED2008-05  void                Reset( INT32 nLen, const ScAddress& rEingPos );
     void                Reset( const ScAddress& rEingPos );
 
 	virtual ConvErr		Convert( const ScTokenArray*& rpErg, INT32& nRest,
Index: sc/source/filter/inc/fprogressbar.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/fprogressbar.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/source/filter/inc/fprogressbar.hxx	10 Apr 2008 20:34:25 -0000	1.8
+++ sc/source/filter/inc/fprogressbar.hxx	12 May 2008 15:56:58 -0000	1.8.32.2
@@ -222,7 +222,7 @@
 class ScfStreamProgressBar
 {
 public:
-    explicit            ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, const String& rText );
+//UNUSED2008-05  explicit            ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, const String& rText );
     explicit            ScfStreamProgressBar( SvStream& rStrm, SfxObjectShell* pDocShell, USHORT nResId = STR_LOAD_DOC );
 
     /** Sets the progress bar to the current stream position. */
Index: sc/source/filter/inc/htmlpars.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/htmlpars.hxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/source/filter/inc/htmlpars.hxx	10 Apr 2008 20:35:33 -0000	1.16
+++ sc/source/filter/inc/htmlpars.hxx	9 May 2008 16:11:48 -0000	1.16.32.1
@@ -597,9 +597,6 @@
     virtual const ScHTMLTable*  GetGlobalTable() const;
 
 private:
-    /** Returns the specified table (may be maGlobTable, if no real table can be found). */
-    ScHTMLTable*                GetTable( ScHTMLTableId nTableId ) const;
-
     /** Handles all possible tags in the HTML document. */
     void                        ProcessToken( const ImportInfo& rInfo );
     /** Inserts a text portion into current entry. */
Index: sc/source/filter/inc/namebuff.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/namebuff.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.1
--- sc/source/filter/inc/namebuff.hxx	10 Apr 2008 20:37:45 -0000	1.15
+++ sc/source/filter/inc/namebuff.hxx	9 May 2008 04:45:57 -0000	1.15.32.1
@@ -118,8 +118,6 @@
 	inline UINT16			GetLastIndex( void );
 	inline void				SetBase( UINT16 nNewBase = 0 );
 	void					operator <<( const String& rNewString );
-	void					Reset( void );
-	BOOL					Find( const sal_Char* pRefName, UINT16& rIndex );
 };
 
 //#94039# prevent empty rootdata
@@ -307,7 +305,6 @@
 	BOOL			GetScTabIndex( UINT16 nExcSheetIndex, UINT16& rIn_LastTab_Out_ScIndex );
 	BOOL			IsLink( const UINT16 nExcSheetIndex ) const;
 	BOOL			GetLink( const UINT16 nExcSheetIndex, String &rAppl, String &rDoc ) const;
-	BOOL			IsExternal( UINT16 nExcSheetIndex ) const;
 
 	void			Reset( void );
 };
@@ -329,8 +326,6 @@
 	inline			ExtName( const String& r ) : aName( r ), nStorageId( 0 ) {}
 
 	BOOL			IsDDE( void ) const;
-	BOOL			IsOLE( void ) const;
-	BOOL			IsName( void ) const;
 };
 
 
Index: sc/source/filter/inc/otlnbuff.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/otlnbuff.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/filter/inc/otlnbuff.hxx	10 Apr 2008 20:38:39 -0000	1.5
+++ sc/source/filter/inc/otlnbuff.hxx	10 May 2008 00:58:44 -0000	1.5.32.1
@@ -53,7 +53,6 @@
 		void			SetLevel( SCSIZE nIndex, BYTE nVal, BOOL bOuted, BOOL bHidden );
 		void			SetOutlineArray( ScOutlineArray* pOArray );
 		void			Reset( void );
-		void			Reset( ScOutlineArray* pOArray );
 		void			MakeScOutline( void );
 		void			SetLevelRange( SCSIZE nF, SCSIZE nL, BYTE nVal,
 							BOOL bOuted, BOOL bHidden );
Index: sc/source/filter/inc/qproform.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/qproform.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/source/filter/inc/qproform.hxx	10 Apr 2008 20:39:10 -0000	1.3
+++ sc/source/filter/inc/qproform.hxx	8 May 2008 21:46:15 -0000	1.3.32.1
@@ -81,8 +81,6 @@
     void DoFunc( DefTokenId eOc, sal_uInt16 nArgs, const sal_Char* pExtString );
     void ReadSRD( SingleRefData& rR, sal_Int8 nPage, sal_Int8 nCol, sal_uInt16 rRel ); 
     void IncToken( TokenId &aParam );
-    void DecToken( TokenId& aParam );
-    void NegToken( TokenId& aParam );
     DefTokenId IndexToToken( sal_uInt16 nToken );
     FUNC_TYPE IndexToType( sal_uInt8 nToken );
     DefTokenId IndexToDLLId( sal_uInt16 nIndex );
Index: sc/source/filter/inc/tokstack.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/tokstack.hxx,v
retrieving revision 1.14
retrieving revision 1.14.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.2
--- sc/source/filter/inc/tokstack.hxx	10 Apr 2008 20:41:24 -0000	1.14
+++ sc/source/filter/inc/tokstack.hxx	12 May 2008 15:56:58 -0000	1.14.32.2
@@ -169,7 +169,7 @@
 		inline void					operator >>( TokenStack& rStack );
 		inline const TokenId		Store( void );
 		const TokenId				Store( const double& rDouble );
-        const TokenId               StoreError( USHORT nError );
+//UNUSED2008-05  const TokenId               StoreError( USHORT nError );
 
 									// nur fuer Range-Names
 		const TokenId				Store( const UINT16 nIndex );
@@ -190,7 +190,7 @@
 		inline const SingleRefData*	GetSRD( const TokenId& nId ) const;
 		BOOL						IsSingleOp( const TokenId& nId, const DefTokenId eId ) const;
         const String*               GetExternal( const TokenId& nId ) const;
-        const String*               GetString( const TokenId& nId ) const;
+//UNUSED2008-05  const String*               GetString( const TokenId& nId ) const;
 		ScMatrix*					GetMatrix( unsigned int n ) const;
 };
 
Index: sc/source/filter/inc/tool.h
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/tool.h,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/filter/inc/tool.h	10 Apr 2008 20:41:39 -0000	1.5
+++ sc/source/filter/inc/tool.h	9 May 2008 04:45:57 -0000	1.5.32.1
@@ -42,8 +42,6 @@
 
 void		SetFormat( SCCOL nCol, SCROW nRow, SCTAB nTab, BYTE nFormat, BYTE nSt );
 
-sal_Char*	ReplaceWith( sal_Char* pString, sal_Char cVon, sal_Char cNach );
-
 void		InitPage( void );
 
 String		DosToSystem( sal_Char *pSource );
Index: sc/source/filter/inc/xcl97rec.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xcl97rec.hxx,v
retrieving revision 1.48
retrieving revision 1.48.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.48 -r1.48.30.2
--- sc/source/filter/inc/xcl97rec.hxx	10 Apr 2008 20:42:30 -0000	1.48
+++ sc/source/filter/inc/xcl97rec.hxx	10 May 2008 00:58:44 -0000	1.48.30.2
@@ -338,15 +338,6 @@
 };
 
 
-// --- class ExcBofC8 ------------------------------------------------
-// Header Record fuer CHARTs
-
-class ExcBofC8 : public ExcBof8_Base
-{
-public:
-								ExcBofC8();
-};
-
 // --- class ExcBundlesheet8 -----------------------------------------
 
 class ExcBundlesheet8 : public ExcBundlesheetBase
@@ -374,25 +365,6 @@
 };
 
 
-// --- class XclDConRef ----------------------------------------------
-
-class XclDConRef : public ExcRecord
-{
-private:
-	ScRange					aSourceRange;
-    XclExpString*           pWorkbook;
-
-	virtual void			SaveCont( XclExpStream& rStrm );
-
-public:
-							XclDConRef( const ScRange& rSrcR, const String& rWB );
-	virtual					~XclDConRef();
-
-	virtual UINT16			GetNum() const;
-    virtual sal_Size        GetLen() const;
-};
-
-
 // ---- class XclCodename --------------------------------------------
 
 class XclCodename : public ExcRecord
Index: sc/source/filter/inc/xehelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xehelper.hxx,v
retrieving revision 1.20
retrieving revision 1.20.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.20 -r1.20.32.2
--- sc/source/filter/inc/xehelper.hxx	10 Apr 2008 20:43:56 -0000	1.20
+++ sc/source/filter/inc/xehelper.hxx	12 May 2008 16:41:59 -0000	1.20.32.2
@@ -142,23 +142,23 @@
         @return  true = Cell range returned in rXclRange is valid (original or cropped). */
     bool                ConvertRange( XclRange& rXclRange, const ScRange& rScRange, bool bWarn );
 
-    /** Returns a valid cell range by moving it into allowed dimensions.
-        @descr  The start and/or end position of the range may be modified.
-        @param rScRange  The Calc cell range to convert.
-        @param bWarn  true = Sets the internal flag that produces a warning box
-            after loading/saving the file, if the cell range contains invalid cells.
-        @return  The converted Excel cell range. */
-    XclRange            CreateValidRange( const ScRange& rScRange, bool bWarn );
+//UNUSED2008-05  /** Returns a valid cell range by moving it into allowed dimensions.
+//UNUSED2008-05      @descr  The start and/or end position of the range may be modified.
+//UNUSED2008-05      @param rScRange  The Calc cell range to convert.
+//UNUSED2008-05      @param bWarn  true = Sets the internal flag that produces a warning box
+//UNUSED2008-05          after loading/saving the file, if the cell range contains invalid cells.
+//UNUSED2008-05      @return  The converted Excel cell range. */
+//UNUSED2008-05  XclRange            CreateValidRange( const ScRange& rScRange, bool bWarn );
 
     // cell range list --------------------------------------------------------
 
-    /** Checks if the passed cell range list is valid.
-        @param rScRanges  The Calc cell range list to check.
-        @param bWarn  true = Sets the internal flag that produces a warning box
-            after loading/saving the file, if the cell range list contains at
-            least one invalid range.
-        @return  true = Cell range list in rScRanges is completly valid. */
-    bool                CheckRangeList( const ScRangeList& rScRanges, bool bWarn );
+//UNUSED2008-05  /** Checks if the passed cell range list is valid.
+//UNUSED2008-05      @param rScRanges  The Calc cell range list to check.
+//UNUSED2008-05      @param bWarn  true = Sets the internal flag that produces a warning box
+//UNUSED2008-05          after loading/saving the file, if the cell range list contains at
+//UNUSED2008-05          least one invalid range.
+//UNUSED2008-05      @return  true = Cell range list in rScRanges is completly valid. */
+//UNUSED2008-05  bool                CheckRangeList( const ScRangeList& rScRanges, bool bWarn );
 
     /** Checks and eventually crops the cell ranges to valid dimensions.
         @descr  The start position of the ranges will not be modified. Cell
Index: sc/source/filter/inc/xerecord.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xerecord.hxx,v
retrieving revision 1.14
retrieving revision 1.14.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.2
--- sc/source/filter/inc/xerecord.hxx	10 Apr 2008 20:45:13 -0000	1.14
+++ sc/source/filter/inc/xerecord.hxx	12 May 2008 15:56:58 -0000	1.14.32.2
@@ -51,8 +51,8 @@
     /** Overwrite this method to do any operation while saving the record. */
     virtual void        Save( XclExpStream& rStrm );
 
-    /** Calls Save(XclExpStream&) nCount times. */
-    void                SaveRepeated( XclExpStream& rStrm, size_t nCount );
+//UNUSED2008-05  /** Calls Save(XclExpStream&) nCount times. */
+//UNUSED2008-05  void                SaveRepeated( XclExpStream& rStrm, size_t nCount );
 };
 
 // ----------------------------------------------------------------------------
Index: sc/source/filter/inc/xestream.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xestream.hxx,v
retrieving revision 1.8
retrieving revision 1.8.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.30.2
--- sc/source/filter/inc/xestream.hxx	10 Apr 2008 20:45:44 -0000	1.8
+++ sc/source/filter/inc/xestream.hxx	12 May 2008 16:41:59 -0000	1.8.30.2
@@ -120,18 +120,20 @@
     // *** unicode string export is realized with helper class XclExpString ***
     // (slice length setting has no effect here -> disabled automatically)
 
-    /** Writes Unicode buffer as 8/16 bit, repeats nFlags at start of a CONTINUE record. */
-    void                WriteUnicodeBuffer( const sal_uInt16* pBuffer, sal_Size nChars, sal_uInt8 nFlags );
+//UNUSED2008-05  /** Writes Unicode buffer as 8/16 bit, repeats nFlags at start of a CONTINUE record. */
+//UNUSED2008-05  void                WriteUnicodeBuffer( const sal_uInt16* pBuffer, sal_Size nChars, sal_uInt8 nFlags );
+
     /** Writes Unicode buffer as 8/16 bit, repeats nFlags at start of a CONTINUE record. */
     void                WriteUnicodeBuffer( const ScfUInt16Vec& rBuffer, sal_uInt8 nFlags );
 
     // *** write 8-bit-strings ***
     // (slice length setting has no effect here -> disabled automatically)
 
-    /** Writes ByteString buffer (without string length field). */
-    void                WriteByteStringBuffer(
-                            const ByteString& rString,
-                            sal_uInt16 nMaxLen = 0x00FF );
+//UNUSED2008-05  /** Writes ByteString buffer (without string length field). */
+//UNUSED2008-05  void                WriteByteStringBuffer(
+//UNUSED2008-05                          const ByteString& rString,
+//UNUSED2008-05                          sal_uInt16 nMaxLen = 0x00FF );
+
     /** Writes string length field and ByteString buffer. */
     void                WriteByteString(
                             const ByteString& rString,
Index: sc/source/filter/inc/xestring.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xestring.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.2
--- sc/source/filter/inc/xestring.hxx	10 Apr 2008 20:46:00 -0000	1.11
+++ sc/source/filter/inc/xestring.hxx	12 May 2008 16:41:59 -0000	1.11.32.2
@@ -74,15 +74,6 @@
                             const String& rString,
                             XclStrFlags nFlags = EXC_STR_DEFAULT,
                             sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
-    /** Constructs a formatted BIFF8 Unicode string.
-        @param rFormats  The formatting runs.
-        @param nFlags  Modifiers for string export.
-        @param nMaxLen  The maximum number of characters to store in this string. */
-    explicit            XclExpString(
-                            const String& rString,
-                            const XclFormatRunVec& rFormats,
-                            XclStrFlags nFlags = EXC_STR_DEFAULT,
-                            sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
     /** Constructs an unformatted BIFF8 Unicode string.
         @param nFlags  Modifiers for string export.
         @param nMaxLen  The maximum number of characters to store in this string. */
@@ -90,15 +81,25 @@
                             const ::rtl::OUString& rString,
                             XclStrFlags nFlags = EXC_STR_DEFAULT,
                             sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
-    /** Constructs a formatted BIFF8 Unicode string.
-        @param rFormats  The formatting runs.
-        @param nFlags  Modifiers for string export.
-        @param nMaxLen  The maximum number of characters to store in this string. */
-    explicit            XclExpString(
-                            const ::rtl::OUString& rString,
-                            const XclFormatRunVec& rFormats,
-                            XclStrFlags nFlags = EXC_STR_DEFAULT,
-                            sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
+//UNUSED2008-05  /** Constructs a formatted BIFF8 Unicode string.
+//UNUSED2008-05      @param rFormats  The formatting runs.
+//UNUSED2008-05      @param nFlags  Modifiers for string export.
+//UNUSED2008-05      @param nMaxLen  The maximum number of characters to store in this string. */
+//UNUSED2008-05  explicit            XclExpString(
+//UNUSED2008-05                          const String& rString,
+//UNUSED2008-05                          const XclFormatRunVec& rFormats,
+//UNUSED2008-05                          XclStrFlags nFlags = EXC_STR_DEFAULT,
+//UNUSED2008-05                          sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
+//UNUSED2008-05  
+//UNUSED2008-05  /** Constructs a formatted BIFF8 Unicode string.
+//UNUSED2008-05      @param rFormats  The formatting runs.
+//UNUSED2008-05      @param nFlags  Modifiers for string export.
+//UNUSED2008-05      @param nMaxLen  The maximum number of characters to store in this string. */
+//UNUSED2008-05  explicit            XclExpString(
+//UNUSED2008-05                          const ::rtl::OUString& rString,
+//UNUSED2008-05                          const XclFormatRunVec& rFormats,
+//UNUSED2008-05                          XclStrFlags nFlags = EXC_STR_DEFAULT,
+//UNUSED2008-05                          sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
 
     // assign -----------------------------------------------------------------
 
@@ -150,26 +151,28 @@
                             rtl_TextEncoding eTextEnc,
                             XclStrFlags nFlags = EXC_STR_DEFAULT,
                             sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
-    /** Assigns a character, converts this object to a BIFF2-BIFF7 byte string.
-        @param nFlags  Modifiers for string export.
-        @param nMaxLen  The maximum number of characters to store in this string (for appending). */
-    void                AssignByte(
-                            sal_Unicode cChar,
-                            rtl_TextEncoding eTextEnc,
-                            XclStrFlags nFlags = EXC_STR_DEFAULT,
-                            sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
+
+//UNUSED2008-05  /** Assigns a character, converts this object to a BIFF2-BIFF7 byte string.
+//UNUSED2008-05      @param nFlags  Modifiers for string export.
+//UNUSED2008-05      @param nMaxLen  The maximum number of characters to store in this string (for appending). */
+//UNUSED2008-05  void                AssignByte(
+//UNUSED2008-05                          sal_Unicode cChar,
+//UNUSED2008-05                          rtl_TextEncoding eTextEnc,
+//UNUSED2008-05                          XclStrFlags nFlags = EXC_STR_DEFAULT,
+//UNUSED2008-05                          sal_uInt16 nMaxLen = EXC_STR_MAXLEN );
 
     // append -----------------------------------------------------------------
 
     /** Appends a string. Uses the string flags used in constructor or last Assign().
         @descr  This object must be a BIFF8 Unicode string. */
     void                Append( const String& rString );
-    /** Appends a string. Uses the string flags used in constructor or last Assign().
-        @descr  This object must be a BIFF8 Unicode string. */
-    void                Append( const ::rtl::OUString& rString );
-    /** Appends a character. Uses the string flags used in constructor or last Assign().
-        @descr  This object must be a BIFF8 Unicode string. */
-    void                Append( sal_Unicode cChar );
+
+//UNUSED2008-05  /** Appends a string. Uses the string flags used in constructor or last Assign().
+//UNUSED2008-05      @descr  This object must be a BIFF8 Unicode string. */
+//UNUSED2008-05  void                Append( const ::rtl::OUString& rString );
+//UNUSED2008-05  /** Appends a character. Uses the string flags used in constructor or last Assign().
+//UNUSED2008-05      @descr  This object must be a BIFF8 Unicode string. */
+//UNUSED2008-05  void                Append( sal_Unicode cChar );
 
     /** Appends a string. Uses the string flags used in constructor or last Assign().
         @descr  This object must be a BIFF2-BIFF7 byte string. */
Index: sc/source/filter/inc/xestyle.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xestyle.hxx,v
retrieving revision 1.20
retrieving revision 1.20.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.20 -r1.20.32.2
--- sc/source/filter/inc/xestyle.hxx	10 Apr 2008 20:46:20 -0000	1.20
+++ sc/source/filter/inc/xestyle.hxx	12 May 2008 16:41:59 -0000	1.20.32.2
@@ -529,26 +529,27 @@
 public:
     explicit            XclExpDefaultXF( const XclExpRoot& rRoot, bool bCellXF );
 
-    /** Sets the parent XF ID. Only allowed for cell XFs. */
-    void                SetParent( sal_uInt32 nParentXFId );
+//UNUSED2008-05  /** Sets the parent XF ID. Only allowed for cell XFs. */
+//UNUSED2008-05  void                SetParent( sal_uInt32 nParentXFId );
+//UNUSED2008-05  
+//UNUSED2008-05  /** Sets all "attribute used" flags explicitely.
+//UNUSED2008-05      @descr  The following Set***() functions set the appropriate flag too. */
+//UNUSED2008-05  void                SetUsedFlags(
+//UNUSED2008-05                          bool bProtUsed, bool bFontUsed, bool bFmtUsed,
+//UNUSED2008-05                          bool bAlignUsed, bool bBorderUsed, bool bAreaUsed );
+//UNUSED2008-05  /** Sets the cell protection flags. */
+//UNUSED2008-05  void                SetProtection( const XclExpCellProt& rProtection );
+//UNUSED2008-05  /** Sets cell alignment attributes. */
+//UNUSED2008-05  void                SetAlignment( const XclExpCellAlign& rAlignment );
+//UNUSED2008-05  /** Sets a cell border style. */
+//UNUSED2008-05  void                SetBorder( const XclExpCellBorder& rBorder );
+//UNUSED2008-05  /** Sets a cell area style. */
+//UNUSED2008-05  void                SetArea( const XclExpCellArea& rArea );
 
-    /** Sets all "attribute used" flags explicitely.
-        @descr  The following Set***() functions set the appropriate flag too. */
-    void                SetUsedFlags(
-                            bool bProtUsed, bool bFontUsed, bool bFmtUsed,
-                            bool bAlignUsed, bool bBorderUsed, bool bAreaUsed );
-    /** Sets the cell protection flags. */
-    void                SetProtection( const XclExpCellProt& rProtection );
     /** Sets the Excel font index. */
     void                SetFont( sal_uInt16 nXclFont );
     /** Sets the Excel number format index. */
     void                SetNumFmt( sal_uInt16 nXclNumFmt );
-    /** Sets cell alignment attributes. */
-    void                SetAlignment( const XclExpCellAlign& rAlignment );
-    /** Sets a cell border style. */
-    void                SetBorder( const XclExpCellBorder& rBorder );
-    /** Sets a cell area style. */
-    void                SetArea( const XclExpCellArea& rArea );
 };
 
 // ----------------------------------------------------------------------------
Index: sc/source/filter/inc/xistream.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xistream.hxx,v
retrieving revision 1.13
retrieving revision 1.13.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.30.3
--- sc/source/filter/inc/xistream.hxx	10 Apr 2008 20:50:03 -0000	1.13
+++ sc/source/filter/inc/xistream.hxx	13 May 2008 14:34:11 -0000	1.13.30.3
@@ -310,8 +310,8 @@
     /** Seeks to last position from user position stack.
         @descr  This position will be removed from the stack. */
     void                PopPosition();
-    /** Removes last position from user position stack, but does not seek to it. */
-    void                RejectPosition();
+//UNUSED2008-05  /** Removes last position from user position stack, but does not seek to it. */
+//UNUSED2008-05  void                RejectPosition();
 
     /** Stores current position. This position keeps valid in all records. */
     void                StoreGlobalPosition();
@@ -357,9 +357,10 @@
     /** Copies nBytes bytes to rOutStrm.
         @return  Count of bytes really written. */
     sal_Size            CopyToStream( SvStream& rOutStrm, sal_Size nBytes );
-    /** Copies the entire record to rOutStrm. The current record position keeps unchanged.
-        @return  Count of bytes really written. */
-    sal_Size            CopyRecordToStream( SvStream& rOutStrm );
+  
+//UNUSED2008-05  /** Copies the entire record to rOutStrm. The current record position keeps unchanged.
+//UNUSED2008-05      @return  Count of bytes really written. */
+//UNUSED2008-05  sal_Size            CopyRecordToStream( SvStream& rOutStrm );
 
     /** Seeks absolute in record content to the specified position.
         @descr  The value 0 means start of record, independent from physical stream position. */
@@ -430,8 +431,6 @@
     String              ReadRawByteString( sal_uInt16 nChars );
     /** Reads 8/16 bit string length, character array and returns the string. */
     String              ReadByteString( bool b16BitLen );
-    /** Ignores 8/16 bit string length, character array. */
-    void                IgnoreByteString( bool b16BitLen );
 
     // *** SvStream functions *** ---------------------------------------------
 
Index: sc/source/filter/inc/xlpivot.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xlpivot.hxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/filter/inc/xlpivot.hxx	10 Apr 2008 20:54:09 -0000	1.12
+++ sc/source/filter/inc/xlpivot.hxx	12 May 2008 15:56:58 -0000	1.12.32.2
@@ -490,7 +490,6 @@
 
     explicit            XclPCNumGroupInfo();
 
-    bool                IsNumType() const;
     void                SetNumType();
 
     sal_Int32           GetScDateType() const;
@@ -520,8 +519,9 @@
 
     /** Returns true, if this is a standard field build directly from source data. */
     bool                IsStandardField() const;
-    /** Returns true, if the items of the field are calculated from a formula. */
-    bool                IsCalculatedField() const;
+  
+//UNUSED2008-05  /** Returns true, if the items of the field are calculated from a formula. */
+//UNUSED2008-05  bool                IsCalculatedField() const;
 
     /** Returns true, if this field is a grouping field. */
     bool                IsStdGroupField() const;
Index: sc/source/filter/inc/xlstyle.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xlstyle.hxx,v
retrieving revision 1.23
retrieving revision 1.23.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.32.2
--- sc/source/filter/inc/xlstyle.hxx	10 Apr 2008 20:55:19 -0000	1.23
+++ sc/source/filter/inc/xlstyle.hxx	12 May 2008 15:56:58 -0000	1.23.32.2
@@ -465,8 +465,9 @@
 
     /** Returns the current number format map. */
     inline const XclNumFmtMap& GetFormatMap() const { return maFmtMap; }
-    /** Returns the number format with the specified Excel format index. */
-    const XclNumFmt*    GetFormat( sal_uInt16 nXclNumFmt ) const;
+  
+//UNUSED2008-05  /** Returns the number format with the specified Excel format index. */
+//UNUSED2008-05  const XclNumFmt*    GetFormat( sal_uInt16 nXclNumFmt ) const;
 
     /** Inserts a new number format for the specified Excel format index. */
     void                InsertFormat( sal_uInt16 nXclNumFmt, const String& rFormat );
Index: sc/source/filter/inc/xltools.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xltools.hxx,v
retrieving revision 1.27
retrieving revision 1.27.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.27 -r1.27.32.2
--- sc/source/filter/inc/xltools.hxx	10 Apr 2008 20:55:49 -0000	1.27
+++ sc/source/filter/inc/xltools.hxx	12 May 2008 16:41:59 -0000	1.27.32.2
@@ -166,8 +166,9 @@
     /** Returns a text encoding from an Excel code page.
         @return  The corresponding text encoding or RTL_TEXTENCODING_DONTKNOW. */
     static rtl_TextEncoding GetTextEncoding( sal_uInt16 nCodePage );
-    /** Returns an Excel code page from a text encoding. */
-    static sal_uInt16   GetXclCodePage( rtl_TextEncoding eTextEnc );
+
+//UNUSED2008-05  /** Returns an Excel code page from a text encoding. */
+//UNUSED2008-05  static sal_uInt16   GetXclCodePage( rtl_TextEncoding eTextEnc );
 
     // font names -------------------------------------------------------------
 
Index: sc/source/filter/inc/xltracer.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/xltracer.hxx,v
retrieving revision 1.9
retrieving revision 1.9.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.1
--- sc/source/filter/inc/xltracer.hxx	10 Apr 2008 20:56:06 -0000	1.9
+++ sc/source/filter/inc/xltracer.hxx	9 May 2008 04:45:57 -0000	1.9.32.1
@@ -99,15 +99,10 @@
 
     /** Adds an attribute to be traced with the next Trace() call. */
     void                        AddAttribute( const ::rtl::OUString& rName, const ::rtl::OUString& rValue );
-    /** Adds an attribute to be traced with the next Trace() call. */
-    void                        AddAttribute( const ::rtl::OUString& rName, sal_Int32 nValue );
 
     /** Creates an element including all attributes set up to this call.
         @descr  Removes all attributes after the element is traced. */
     void                        Trace( const ::rtl::OUString& rElementID, const ::rtl::OUString& rMessage );
-    /** Creates an element including all attributes set up to this call.
-        @descr  Removes all attributes after the element is traced. */
-    void                        Trace( const ::rtl::OUString& rElementID, sal_Int32 nMessage );
 
     /** Calls Trace() with a known document properties problem. */
     void                        TraceLog( XclTracerId eProblem, sal_Int32 nValue = 0 );
@@ -125,24 +120,15 @@
     void                        TraceDates(sal_uInt16 nNumFmt);
     void                        TraceBorderLineStyle(bool bBorderLineStyle);
     void                        TraceFillPattern(bool bFillPattern);
-    void                        TraceInvisibleGrid(bool bVisibleGrid);
     void                        TraceFormulaExtName();
     void                        TraceFormulaMissingArg();
     void                        TracePivotDataSource(bool bExternal);
     void                        TracePivotChartExists();
     void                        TraceChartUnKnownType();
-    void                        TraceChartTrendLines();
-    void                        TraceChartErrorBars();
     void                        TraceChartOnlySheet();
-    void                        TraceChartRange();
-    void                        TraceChartDSName();
     void                        TraceChartDataTable();
     void                        TraceChartLegendPosition();
-    void                        TraceChartTextFormatting();
     void                        TraceChartEmbeddedObj();
-    void                        TraceChartAxisAutoCross();
-    void                        TraceChartAxisManualCross();
-    void                        TraceChartInvalidXY();
     void                        TraceUnsupportedObjects();
     void                        TraceObjectNotPrintable();
     void                        TraceDVType(bool bType);
Index: sc/source/filter/lotus/expop.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/lotus/expop.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/source/filter/lotus/expop.cxx	10 Apr 2008 20:56:37 -0000	1.7
+++ sc/source/filter/lotus/expop.cxx	12 May 2008 16:10:51 -0000	1.7.32.2
@@ -43,7 +43,7 @@
 
 #include "exp_op.hxx"
 
-
+#if ENABLE_LOTUS123_EXPORT
 const USHORT ExportWK1::WK1MAXCOL = 255;
 const USHORT ExportWK1::WK1MAXROW = 8191;
 
@@ -411,6 +411,6 @@
 
 	return eERR_OK;
 }
-
+#endif
 
 
Index: sc/source/filter/lotus/export.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/lotus/export.cxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/source/filter/lotus/export.cxx	10 Apr 2008 20:56:54 -0000	1.5
+++ sc/source/filter/lotus/export.cxx	12 May 2008 16:10:51 -0000	1.5.32.2
@@ -37,7 +37,7 @@
 #include "scerrors.hxx"
 #include "exp_op.hxx"
 
-
+#if ENABLE_LOTUS123_EXPORT
 FltError ScExportLotus123( SvStream& aStream, ScDocument* pDoc, ExportFormatLotus eFormat, CharSet eDest )
 {
 	switch( eFormat )
@@ -56,6 +56,6 @@
 
 	return eERR_OK;
 }
-
+#endif
 
 
Index: sc/source/filter/lotus/tool.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/lotus/tool.cxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/source/filter/lotus/tool.cxx	10 Apr 2008 21:00:01 -0000	1.16
+++ sc/source/filter/lotus/tool.cxx	9 May 2008 04:45:57 -0000	1.16.32.1
@@ -142,45 +142,6 @@
 	pDoc->ApplyAttr( nCol, nRow, nTab, aAttr );
 }
 
-
-
-
-sal_Char* ReplaceWith( sal_Char* pString, sal_Char cVon, sal_Char cNach )
-{	// Ersetzt alle Vorkommen von cVon durch cNach
-	//  cNach = 0 -> cVon wird aus String herausgeloescht!
-	// PREC:    pString:    Nullterminierter String
-	// POST:    cNach = 0:  aus String werden alle Vorkommen von cVon
-	//                      herausgeloescht (String wird kuerzer)
-	//          cNach !=0:  alle Vorkommen von cVon im String werden durch
-	//                      cNach ersetzt
-	DBG_ASSERT( pString != NULL, "ReplaceWith(): pString == NULL" );
-
-	sal_Char *pAkt, *pCpy;
-	if( cNach != 0 )
-	{	// Zeichen erstzen
-		for(  pAkt = pString ; *pAkt != 0 ; pAkt++ )
-		{
-			if( *pAkt == cVon )
-				*pAkt = cNach;
-		}
-	}
-	else
-	{	// Zeichen loeschen
-		for( pAkt = pCpy =pString ; *pAkt != 0 ; pAkt++ )
-		if( *pAkt != cVon )
-		{
-			*pCpy = *pAkt;
-			pCpy++;
-		}
-		*pCpy = 0;  // Nullterminator anhaengen
-	}
-
-	return pString;
-}
-
-
-
-
 void InitPage( void )
 {	// Seitenformat initialisieren, d.h. Default-Werte von SC holen
 	//scGetPageFormat( 0, &aPage );
Index: sc/source/filter/qpro/qproform.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/qpro/qproform.cxx,v
retrieving revision 1.9
retrieving revision 1.9.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.1
--- sc/source/filter/qpro/qproform.cxx	10 Apr 2008 21:01:16 -0000	1.9
+++ sc/source/filter/qpro/qproform.cxx	8 May 2008 21:46:15 -0000	1.9.32.1
@@ -192,18 +192,6 @@
     rParam = aPool.Store();
 }
 
-void QProToSc::DecToken( TokenId &rParam )
-{
-    aPool << ocOpen << rParam << mnSubToken;
-    rParam = aPool.Store();
-}
-
-void QProToSc::NegToken( TokenId &rParam )
-{
-    aPool << ocNegSub << ocOpen << rParam << ocClose;
-    rParam = aPool.Store();
-}
-
 #define SAFEDEC_OR_RET(nRef, amt, ret) \
 do { \
     if (nRef < amt)\
Index: sc/source/filter/starcalc/scflt.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/starcalc/scflt.cxx,v
retrieving revision 1.25
retrieving revision 1.25.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.30.2
--- sc/source/filter/starcalc/scflt.cxx	10 Apr 2008 21:04:01 -0000	1.25
+++ sc/source/filter/starcalc/scflt.cxx	13 May 2008 14:34:11 -0000	1.25.30.2
@@ -92,16 +92,6 @@
 
 const SCCOL SC10MAXCOL = 255;   // #i85906# don't try to load more columns than there are in the file
 
-void lcl_ReadDateTime(SvStream& rStream, Sc10DateTime& rDateTime)
-{
-	rStream >> rDateTime.Year;
-	rStream >> rDateTime.Month;
-	rStream >> rDateTime.Day;
-	rStream >> rDateTime.Hour;
-	rStream >> rDateTime.Min;
-	rStream >> rDateTime.Sec;
-}
-
 
 void lcl_ReadFileHeader(SvStream& rStream, Sc10FileHeader& rFileHeader)
 {
@@ -111,55 +101,6 @@
 }
 
 
-void lcl_ReadFileInfo(SvStream& rStream, Sc10FileInfo& rFileInfo)
-{
-	rStream.Read(&rFileInfo.Title, sizeof(rFileInfo.Title));
-	rStream.Read(&rFileInfo.Thema, sizeof(rFileInfo.Thema));
-	rStream.Read(&rFileInfo.Keys, sizeof(rFileInfo.Keys));
-	rStream.Read(&rFileInfo.Note, sizeof(rFileInfo.Note));
-	rStream.Read(&rFileInfo.InfoLabel0, sizeof(rFileInfo.InfoLabel0));
-	rStream.Read(&rFileInfo.InfoLabel1, sizeof(rFileInfo.InfoLabel1));
-	rStream.Read(&rFileInfo.InfoLabel2, sizeof(rFileInfo.InfoLabel2));
-	rStream.Read(&rFileInfo.InfoLabel3, sizeof(rFileInfo.InfoLabel3));
-	rStream.Read(&rFileInfo.Info0, sizeof(rFileInfo.Info0));
-	rStream.Read(&rFileInfo.Info1, sizeof(rFileInfo.Info1));
-	rStream.Read(&rFileInfo.Info2, sizeof(rFileInfo.Info2));
-	rStream.Read(&rFileInfo.Info3, sizeof(rFileInfo.Info3));
-	rStream.Read(&rFileInfo.CreateAuthor, sizeof(rFileInfo.CreateAuthor));
-	rStream.Read(&rFileInfo.ChangeAuthor, sizeof(rFileInfo.ChangeAuthor));
-	rStream.Read(&rFileInfo.PrintAuthor, sizeof(rFileInfo.PrintAuthor));
-	lcl_ReadDateTime(rStream, rFileInfo.CreateDate);
-	lcl_ReadDateTime(rStream, rFileInfo.ChangeDate);
-	lcl_ReadDateTime(rStream, rFileInfo.PrintDate);
-	rStream >> rFileInfo.PageCount;
-	rStream >> rFileInfo.ChartCount;
-	rStream >> rFileInfo.PictureCount;
-	rStream >> rFileInfo.GraphCount;
-	rStream >> rFileInfo.OleCount;
-	rStream >> rFileInfo.NoteCount;
-	rStream >> rFileInfo.TextCellCount;
-	rStream >> rFileInfo.ValueCellCount;
-	rStream >> rFileInfo.FormulaCellCount;
-	rStream >> rFileInfo.CellCount;
-	rStream.Read(rFileInfo.Reserved, sizeof(rFileInfo.Reserved));
-}
-
-
-void lcl_ReadEditStateInfo(SvStream& rStream, Sc10EditStateInfo& rInfo)
-{
-	rStream >> rInfo.CarretX;
-	rStream >> rInfo.CarretY;
-	rStream >> rInfo.CarretZ;
-
-	rStream >> rInfo.DeltaX;
-	rStream >> rInfo.DeltaY;
-	rStream >> rInfo.DeltaZ;
-
-	rStream >> rInfo.DataBaseMode;
-	rStream.Read(rInfo.Reserved, sizeof(rInfo.Reserved));
-}
-
-
 void lcl_ReadTabProtect(SvStream& rStream, Sc10TableProtect& rProtect)
 {
 	rStream.Read(&rProtect.PassWord, sizeof(rProtect.PassWord));
@@ -1123,7 +1064,6 @@
 {
 	Sc10FileInfo FileInfo;
 	rStream.Read(&FileInfo, sizeof(FileInfo));
-	//lcl_ReadFileInfo(rStream, FileInfo);
 
 	nError = rStream.GetError();
 	// Achtung Info Uebertragen
@@ -1135,7 +1075,6 @@
 {
 	Sc10EditStateInfo EditStateInfo;
 	rStream.Read(&EditStateInfo, sizeof(EditStateInfo));
-	//lcl_ReadEditStateInfo(rStream, EditStateInfo);
 
 	nError = rStream.GetError();
 	nShowTab = static_cast<SCTAB>(EditStateInfo.DeltaZ);
Index: sc/source/filter/xcl97/xcl97rec.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/xcl97rec.cxx,v
retrieving revision 1.87
retrieving revision 1.87.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.87 -r1.87.30.2
--- sc/source/filter/xcl97/xcl97rec.cxx	10 Apr 2008 21:06:48 -0000	1.87
+++ sc/source/filter/xcl97/xcl97rec.cxx	10 May 2008 00:58:45 -0000	1.87.30.2
@@ -921,13 +921,6 @@
 }
 
 
-// --- class ExcBofC8 ------------------------------------------------
-
-ExcBofC8::ExcBofC8()
-{
-	nDocType = 0x0020;
-}
-
 // --- class ExcBundlesheet8 -----------------------------------------
 
 ExcBundlesheet8::ExcBundlesheet8( RootData& rRootData, SCTAB nTab ) :
@@ -973,45 +966,6 @@
 }
 
 
-
-// --- class XclDConRef ----------------------------------------------
-
-XclDConRef::XclDConRef( const ScRange& rSrcR, const String& rWB ) :
-		aSourceRange( rSrcR )
-{
-	String	sTemp( ( sal_Unicode ) 0x02 );
-
-	sTemp += rWB;
-    pWorkbook = new XclExpString( sTemp );
-}
-
-XclDConRef::~XclDConRef()
-{
-	delete pWorkbook;
-}
-
-void XclDConRef::SaveCont( XclExpStream& rStrm )
-{
-	rStrm	<< (UINT16) aSourceRange.aStart.Row()
-			<< (UINT16) aSourceRange.aEnd.Row()
-			<< (UINT8)  aSourceRange.aStart.Col()
-            << (UINT8)  aSourceRange.aEnd.Col()
-            << *pWorkbook
-            << (UINT8)  0x00;
-}
-
-UINT16 XclDConRef::GetNum() const
-{
-	return 0x0051;
-}
-
-sal_Size XclDConRef::GetLen() const
-{
-    return 7 + pWorkbook->GetSize();
-}
-
-
-
 // ---- class XclCodename --------------------------------------------
 
 XclCodename::XclCodename( const String& r ) : aName( r )
Index: sc/source/filter/xml/XMLChangeTrackingExportHelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLChangeTrackingExportHelper.cxx,v
retrieving revision 1.33
retrieving revision 1.33.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.30.1
--- sc/source/filter/xml/XMLChangeTrackingExportHelper.cxx	10 Apr 2008 21:08:50 -0000	1.33
+++ sc/source/filter/xml/XMLChangeTrackingExportHelper.cxx	9 May 2008 04:45:58 -0000	1.33.30.1
@@ -793,113 +793,6 @@
 	}
 }
 
-void ScChangeTrackingExportHelper::WriteChangeViewSettings()
-{
-	ScChangeViewSettings* pViewSettings = rExport.GetDocument() ? rExport.GetDocument()->GetChangeViewSettings() : NULL;
-	if (pViewSettings && pChangeTrack)
-	{
-		if (!pViewSettings->ShowChanges())
-			rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_SHOW_CHANGES, XML_FALSE);
-		if (pViewSettings->IsShowAccepted())
-			rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_SHOW_ACCEPTED_CHANGES, XML_TRUE);
-		if (pViewSettings->IsShowRejected())
-			rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_SHOW_REJECTED_CHANGES, XML_TRUE);
-		SvXMLElementExport aChangeViewSettingsElem(rExport, XML_NAMESPACE_TABLE, XML_CHANGE_VIEW_SETTINGS, sal_True, sal_True);
-		{
-			SvXMLElementExport aChangeViewConditionsElem(rExport, XML_NAMESPACE_TABLE, XML_CHANGE_VIEW_CONDITIONS, sal_True, sal_True);
-			{
-				{
-					if (pViewSettings->HasDate())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_USE_CONDITION, XML_TRUE);
-					switch (pViewSettings->GetTheDateMode())
-					{
-						case SCDM_DATE_BEFORE:
-						{
-							rtl::OUStringBuffer sDate;
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_DATE_TIME, sDate.makeStringAndClear());
-							SvXMLElementExport aDateBeforeElem(rExport, XML_NAMESPACE_TABLE, XML_BEFORE_DATE_TIME, sal_True, sal_True);
-						}
-						break;
-						case SCDM_DATE_SINCE:
-						{
-							rtl::OUStringBuffer sDate;
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_DATE_TIME, sDate.makeStringAndClear());
-							SvXMLElementExport aDateSinceElem(rExport, XML_NAMESPACE_TABLE, XML_SINCE_DATE_TIME, sal_True, sal_True);
-						}
-						break;
-						case SCDM_DATE_EQUAL:
-						{
-							rtl::OUStringBuffer sDate;
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_DATE, sDate.makeStringAndClear());
-							SvXMLElementExport aDateEqualElem(rExport, XML_NAMESPACE_TABLE, XML_EQUAL_DATE, sal_True, sal_True);
-						}
-						break;
-						case SCDM_DATE_NOTEQUAL:
-						{
-							rtl::OUStringBuffer sDate;
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_DATE, sDate.makeStringAndClear());
-							SvXMLElementExport aDateNotEqualElem(rExport, XML_NAMESPACE_TABLE, XML_NOT_EQUAL_DATE, sal_True, sal_True);
-						}
-						break;
-						case SCDM_DATE_BETWEEN:
-						{
-							rtl::OUStringBuffer sDate;
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_FIRST_DATE_TIME, sDate.makeStringAndClear());
-							ScXMLConverter::ConvertDateTimeToString(pViewSettings->GetTheFirstDateTime(), sDate);
-							rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_SECOND_DATE_TIME, sDate.makeStringAndClear());
-							SvXMLElementExport aDateBetweenElem(rExport, XML_NAMESPACE_TABLE, XML_BETWEEN_DATE_TIMES, sal_True, sal_True);
-						}
-						break;
-						case SCDM_DATE_SAVE:
-						{
-							SvXMLElementExport aDateSaveElem(rExport, XML_NAMESPACE_TABLE, XML_SINCE_SAVE, sal_True, sal_True);
-						}
-						break;
-						case SCDM_NO_DATEMODE:
-						{
-							DBG_ERROR("wrong date mode");
-						}
-						break;
-					}
-				}
-				rtl::OUString sAuthor (pViewSettings->GetTheAuthorToShow());
-				if (sAuthor.getLength() && !pViewSettings->HasAuthor())
-				{
-					if (pViewSettings->HasAuthor())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_USE_CONDITION, XML_TRUE);
-					if (sAuthor.getLength())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_AUTHOR, sAuthor);
-					SvXMLElementExport aEqualAuthorElem(rExport, XML_NAMESPACE_TABLE, XML_EQUAL_AUTHOR, sal_True, sal_True);
-				}
-				rtl::OUString sComment (pViewSettings->GetTheComment());
-				if (sComment.getLength() && !pViewSettings->HasComment())
-				{
-					if (pViewSettings->HasComment())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_USE_CONDITION, XML_TRUE);
-					if (sComment.getLength())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_COMMENT, sComment);
-					SvXMLElementExport aEqualCommentElem(rExport, XML_NAMESPACE_TABLE, XML_EQUAL_COMMENT, sal_True, sal_True);
-				}
-				rtl::OUString sRangeList;
-				ScRangeStringConverter::GetStringFromRangeList(sRangeList, &(pViewSettings->GetTheRangeList()), rExport.GetDocument());
-				if (sRangeList.getLength() && !pViewSettings->HasRange())
-				{
-					if (pViewSettings->HasRange())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_USE_CONDITION, XML_TRUE);
-					if (sRangeList.getLength())
-						rExport.AddAttribute(XML_NAMESPACE_TABLE, XML_CELL_RANGE_ADDRESS_LIST, sRangeList);
-					SvXMLElementExport aInRangeElem(rExport, XML_NAMESPACE_TABLE, XML_IN_RANGE, sal_True, sal_True);
-				}
-			}
-		}
-	}
-}
-
 void ScChangeTrackingExportHelper::CollectAndWriteChanges()
 {
 	if (pChangeTrack)
Index: sc/source/filter/xml/XMLChangeTrackingExportHelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLChangeTrackingExportHelper.hxx,v
retrieving revision 1.17
retrieving revision 1.17.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.1
--- sc/source/filter/xml/XMLChangeTrackingExportHelper.hxx	10 Apr 2008 21:09:07 -0000	1.17
+++ sc/source/filter/xml/XMLChangeTrackingExportHelper.hxx	9 May 2008 04:45:58 -0000	1.17.32.1
@@ -94,7 +94,6 @@
 	ScChangeTrackingExportHelper(ScXMLExport& rExport);
 	~ScChangeTrackingExportHelper();
 
-	void WriteChangeViewSettings();
 	void CollectAutoStyles();
 	void CollectAndWriteChanges();
 };
Index: sc/source/filter/xml/XMLChangeTrackingImportHelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLChangeTrackingImportHelper.cxx,v
retrieving revision 1.29
retrieving revision 1.29.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.29 -r1.29.32.1
--- sc/source/filter/xml/XMLChangeTrackingImportHelper.cxx	10 Apr 2008 21:09:25 -0000	1.29
+++ sc/source/filter/xml/XMLChangeTrackingImportHelper.cxx	9 May 2008 21:22:42 -0000	1.29.32.1
@@ -43,20 +43,6 @@
 
 #define SC_CHANGE_ID_PREFIX "ct"
 
-ScMyCellInfo::ScMyCellInfo()
-	: pCell(NULL),
-	sFormulaAddress(),
-	sFormula(),
-	sInputString(),
-	fValue(0.0),
-	nMatrixCols(0),
-	nMatrixRows(0),
-    eGrammar( ScGrammar::GRAM_STORAGE_DEFAULT),
-	nType(NUMBERFORMAT_ALL),
-	nMatrixFlag(MM_NONE)
-{
-}
-
 ScMyCellInfo::ScMyCellInfo(ScBaseCell* pTempCell, const rtl::OUString& rFormulaAddress, const rtl::OUString& rFormula,
             const ScGrammar::Grammar eTempGrammar, const rtl::OUString& rInputString,
 			const double& rValue, const sal_uInt16 nTempType, const sal_uInt8 nTempMatrixFlag, const sal_Int32 nTempMatrixCols,
Index: sc/source/filter/xml/XMLChangeTrackingImportHelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLChangeTrackingImportHelper.hxx,v
retrieving revision 1.18
retrieving revision 1.18.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.32.1
--- sc/source/filter/xml/XMLChangeTrackingImportHelper.hxx	10 Apr 2008 21:09:43 -0000	1.18
+++ sc/source/filter/xml/XMLChangeTrackingImportHelper.hxx	9 May 2008 21:22:42 -0000	1.18.32.1
@@ -59,7 +59,6 @@
     sal_uInt16         nType;
     sal_uInt8          nMatrixFlag;
 
-	ScMyCellInfo();
     ScMyCellInfo(ScBaseCell* pCell, const rtl::OUString& sFormulaAddress, const rtl::OUString& sFormula,
                 const ScGrammar::Grammar eGrammar, const rtl::OUString& sInputString,
 				const double& fValue, const sal_uInt16 nType, const sal_uInt8 nMatrixFlag, const sal_Int32 nMatrixCols,
@@ -67,6 +66,9 @@
 	~ScMyCellInfo();
 
 	ScBaseCell* CreateCell(ScDocument* pDoc);
+
+private:
+	ScMyCellInfo(); // disabled
 };
 
 struct ScMyDeleted
Index: sc/source/filter/xml/XMLConverter.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLConverter.cxx,v
retrieving revision 1.29
retrieving revision 1.29.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.29 -r1.29.32.2
--- sc/source/filter/xml/XMLConverter.cxx	10 Apr 2008 21:11:27 -0000	1.29
+++ sc/source/filter/xml/XMLConverter.cxx	12 May 2008 15:56:59 -0000	1.29.32.2
@@ -359,12 +359,12 @@
 	SvXMLUnitConverter::convertDateTime(sDate, aAPIDateTime);
 }
 
-void ScXMLConverter::ConvertStringToDateTime(const rtl::OUString& sDate, DateTime& aDateTime, SvXMLUnitConverter* /* pUnitConverter */)
-{
-	com::sun::star::util::DateTime aAPIDateTime;
-    SvXMLUnitConverter::convertDateTime(aAPIDateTime, sDate);
-	ConvertAPIToCoreDateTime(aAPIDateTime, aDateTime);
-}
+//UNUSED2008-05  void ScXMLConverter::ConvertStringToDateTime(const rtl::OUString& sDate, DateTime& aDateTime, SvXMLUnitConverter* /* pUnitConverter */)
+//UNUSED2008-05  {
+//UNUSED2008-05      com::sun::star::util::DateTime aAPIDateTime;
+//UNUSED2008-05      SvXMLUnitConverter::convertDateTime(aAPIDateTime, sDate);
+//UNUSED2008-05      ConvertAPIToCoreDateTime(aAPIDateTime, aDateTime);
+//UNUSED2008-05  }
 
 void ScXMLConverter::ConvertCoreToAPIDateTime(const DateTime& aDateTime, util::DateTime& rDateTime)
 {
Index: sc/source/filter/xml/XMLConverter.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLConverter.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.2
--- sc/source/filter/xml/XMLConverter.hxx	10 Apr 2008 21:11:48 -0000	1.15
+++ sc/source/filter/xml/XMLConverter.hxx	12 May 2008 15:56:59 -0000	1.15.32.2
@@ -109,8 +109,8 @@
 							const sal_Bool bIsFormula = sal_True);
 // EXPORT: Core Date Time
 	static void			ConvertDateTimeToString(const DateTime& aDateTime, rtl::OUStringBuffer& sDate);
-// IMPORT: Core Date Time
-	static void			ConvertStringToDateTime(const rtl::OUString& sDate, DateTime& aDateTime, SvXMLUnitConverter* pUnitConverter);
+//UNUSED2008-05  // IMPORT: Core Date Time
+//UNUSED2008-05      static void         ConvertStringToDateTime(const rtl::OUString& sDate, DateTime& aDateTime, SvXMLUnitConverter* pUnitConverter);
 
 	static void			ConvertCoreToAPIDateTime(const DateTime& aDateTime, com::sun::star::util::DateTime& rDateTime);
 
Index: sc/source/filter/xml/XMLStylesImportHelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLStylesImportHelper.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.1
--- sc/source/filter/xml/XMLStylesImportHelper.cxx	10 Apr 2008 21:18:10 -0000	1.22
+++ sc/source/filter/xml/XMLStylesImportHelper.cxx	9 May 2008 21:22:42 -0000	1.22.32.1
@@ -531,19 +531,6 @@
 	}
 }
 
-void ScMyStylesImportHelper::AddRange(const com::sun::star::table::CellRangeAddress& rRange)
-{
-	ScRange aScRange( static_cast<SCCOL>(rRange.StartColumn), static_cast<SCROW>(rRange.StartRow), rRange.Sheet,
-		static_cast<SCCOL>(rRange.EndColumn), static_cast<SCROW>(rRange.EndRow), rRange.Sheet );
-	AddRange(aScRange);
-}
-
-void ScMyStylesImportHelper::AddCell(const ScAddress& rAddress)
-{
-	ScRange aScRange( rAddress, rAddress );
-	AddRange(aScRange);
-}
-
 void ScMyStylesImportHelper::AddCell(const com::sun::star::table::CellAddress& rAddress)
 {
 	ScAddress aScAddress( static_cast<SCCOL>(rAddress.Column), static_cast<SCROW>(rAddress.Row), rAddress.Sheet );
Index: sc/source/filter/xml/XMLStylesImportHelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/XMLStylesImportHelper.hxx,v
retrieving revision 1.10
retrieving revision 1.10.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.32.1
--- sc/source/filter/xml/XMLStylesImportHelper.hxx	10 Apr 2008 21:18:25 -0000	1.10
+++ sc/source/filter/xml/XMLStylesImportHelper.hxx	9 May 2008 21:22:42 -0000	1.10.32.1
@@ -187,8 +187,6 @@
 	void SetAttributes(rtl::OUString* pStyleName,
 		rtl::OUString* pCurrency, const sal_Int16 nCellType);
 	void AddRange(const ScRange& rRange);
-	void AddRange(const com::sun::star::table::CellRangeAddress& rRange);
-	void AddCell(const ScAddress& rAddress);
 	void AddCell(const com::sun::star::table::CellAddress& rAddress);
 	void InsertRow(const sal_Int32 nRow, const sal_Int32 nTab, ScDocument* pDoc); // a row is inserted before nRow
 	void InsertCol(const sal_Int32 nCol, const sal_Int32 nTab, ScDocument* pDoc); // a col is inserted before nCol
Index: sc/source/filter/xml/xmlexprt.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlexprt.cxx,v
retrieving revision 1.212
retrieving revision 1.212.28.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.212 -r1.212.28.2
--- sc/source/filter/xml/xmlexprt.cxx	10 Apr 2008 21:29:11 -0000	1.212
+++ sc/source/filter/xml/xmlexprt.cxx	12 May 2008 15:56:59 -0000	1.212.28.2
@@ -2049,24 +2049,24 @@
 	}
 }
 
-sal_Bool ScXMLExport::GetMerge (const uno::Reference <sheet::XSpreadsheet>& xTable,
-							const sal_Int32 nCol, const sal_Int32 nRow,
-							table::CellRangeAddress& aCellAddress)
-{
-	uno::Reference<sheet::XSheetCellRange> xSheetCellRange(xTable->getCellRangeByPosition(nCol, nRow, nCol, nRow), uno::UNO_QUERY);
-	if (xSheetCellRange.is())
-	{
-		uno::Reference<sheet::XSheetCellCursor> xCursor(xTable->createCursorByRange(xSheetCellRange));
-		if(xCursor.is())
-		{
-			uno::Reference<sheet::XCellRangeAddressable> xCellAddress (xCursor, uno::UNO_QUERY);
-			xCursor->collapseToMergedArea();
-			aCellAddress = xCellAddress->getRangeAddress();
-			return sal_True;
-		}
-	}
-	return sal_False;
-}
+//UNUSED2008-05  sal_Bool ScXMLExport::GetMerge (const uno::Reference <sheet::XSpreadsheet>& xTable,
+//UNUSED2008-05                                  const sal_Int32 nCol, const sal_Int32 nRow,
+//UNUSED2008-05                                  table::CellRangeAddress& aCellAddress)
+//UNUSED2008-05  {
+//UNUSED2008-05      uno::Reference<sheet::XSheetCellRange> xSheetCellRange(xTable->getCellRangeByPosition(nCol, nRow, nCol, nRow), uno::UNO_QUERY);
+//UNUSED2008-05      if (xSheetCellRange.is())
+//UNUSED2008-05      {
+//UNUSED2008-05          uno::Reference<sheet::XSheetCellCursor> xCursor(xTable->createCursorByRange(xSheetCellRange));
+//UNUSED2008-05          if (xCursor.is())
+//UNUSED2008-05          {
+//UNUSED2008-05              uno::Reference<sheet::XCellRangeAddressable> xCellAddress (xCursor, uno::UNO_QUERY);
+//UNUSED2008-05              xCursor->collapseToMergedArea();
+//UNUSED2008-05              aCellAddress = xCellAddress->getRangeAddress();
+//UNUSED2008-05              return sal_True;
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05      return sal_False;
+//UNUSED2008-05  }
 
 sal_Bool ScXMLExport::GetMerged (const table::CellRangeAddress* pCellAddress,
 							const uno::Reference <sheet::XSpreadsheet>& xTable)
@@ -2113,50 +2113,50 @@
 	return !bReady;
 }
 
-sal_Bool ScXMLExport::IsMatrix (const uno::Reference <table::XCellRange>& xCellRange,
-							const uno::Reference <sheet::XSpreadsheet>& xTable,
-							const sal_Int32 nCol, const sal_Int32 nRow,
-							table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const
-{
-	bIsFirst = sal_False;
-	uno::Reference <sheet::XArrayFormulaRange> xArrayFormulaRange (xCellRange->getCellRangeByPosition(nCol,nRow,nCol,nRow), uno::UNO_QUERY);
-	if (xArrayFormulaRange.is())
-	{
-		rtl::OUString sArrayFormula(xArrayFormulaRange->getArrayFormula());
-		if (sArrayFormula.getLength())
-		{
-			uno::Reference<sheet::XSheetCellRange> xMatrixSheetCellRange (xArrayFormulaRange, uno::UNO_QUERY);
-			if (xMatrixSheetCellRange.is())
-			{
-				uno::Reference<sheet::XSheetCellCursor> xMatrixSheetCursor(xTable->createCursorByRange(xMatrixSheetCellRange));
-				if (xMatrixSheetCursor.is())
-				{
-					xMatrixSheetCursor->collapseToCurrentArray();
-					uno::Reference<sheet::XCellRangeAddressable> xMatrixCellAddress (xMatrixSheetCursor, uno::UNO_QUERY);
-					if (xMatrixCellAddress.is())
-					{
-						aCellAddress = xMatrixCellAddress->getRangeAddress();
-						if ((aCellAddress.StartColumn == nCol && aCellAddress.StartRow == nRow) &&
-							(aCellAddress.EndColumn > nCol || aCellAddress.EndRow > nRow))
-						{
-							bIsFirst = sal_True;
-							return sal_True;
-						}
-						else if (aCellAddress.StartColumn != nCol || aCellAddress.StartRow != nRow ||
-							aCellAddress.EndColumn != nCol || aCellAddress.EndRow != nRow)
-							return sal_True;
-						else
-						{
-							bIsFirst = sal_True;
-							return sal_True;
-						}
-					}
-				}
-			}
-		}
-	}
-	return sal_False;
-}
+//UNUSED2008-05  sal_Bool ScXMLExport::IsMatrix (const uno::Reference <table::XCellRange>& xCellRange,
+//UNUSED2008-05                                  const uno::Reference <sheet::XSpreadsheet>& xTable,
+//UNUSED2008-05                                  const sal_Int32 nCol, const sal_Int32 nRow,
+//UNUSED2008-05                                  table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const
+//UNUSED2008-05  {
+//UNUSED2008-05      bIsFirst = sal_False;
+//UNUSED2008-05      uno::Reference <sheet::XArrayFormulaRange> xArrayFormulaRange (xCellRange->getCellRangeByPosition(nCol,nRow,nCol,nRow), uno::UNO_QUERY);
+//UNUSED2008-05      if (xArrayFormulaRange.is())
+//UNUSED2008-05      {
+//UNUSED2008-05          rtl::OUString sArrayFormula(xArrayFormulaRange->getArrayFormula());
+//UNUSED2008-05          if (sArrayFormula.getLength())
+//UNUSED2008-05          {
+//UNUSED2008-05              uno::Reference<sheet::XSheetCellRange> xMatrixSheetCellRange (xArrayFormulaRange, uno::UNO_QUERY);
+//UNUSED2008-05              if (xMatrixSheetCellRange.is())
+//UNUSED2008-05              {
+//UNUSED2008-05                  uno::Reference<sheet::XSheetCellCursor> xMatrixSheetCursor(xTable->createCursorByRange(xMatrixSheetCellRange));
+//UNUSED2008-05                  if (xMatrixSheetCursor.is())
+//UNUSED2008-05                  {
+//UNUSED2008-05                      xMatrixSheetCursor->collapseToCurrentArray();
+//UNUSED2008-05                      uno::Reference<sheet::XCellRangeAddressable> xMatrixCellAddress (xMatrixSheetCursor, uno::UNO_QUERY);
+//UNUSED2008-05                      if (xMatrixCellAddress.is())
+//UNUSED2008-05                      {
+//UNUSED2008-05                          aCellAddress = xMatrixCellAddress->getRangeAddress();
+//UNUSED2008-05                          if ((aCellAddress.StartColumn == nCol && aCellAddress.StartRow == nRow) &&
+//UNUSED2008-05                              (aCellAddress.EndColumn > nCol || aCellAddress.EndRow > nRow))
+//UNUSED2008-05                          {
+//UNUSED2008-05                              bIsFirst = sal_True;
+//UNUSED2008-05                              return sal_True;
+//UNUSED2008-05                          }
+//UNUSED2008-05                          else if (aCellAddress.StartColumn != nCol || aCellAddress.StartRow != nRow ||
+//UNUSED2008-05                                   aCellAddress.EndColumn != nCol || aCellAddress.EndRow != nRow)
+//UNUSED2008-05                              return sal_True;
+//UNUSED2008-05                          else
+//UNUSED2008-05                          {
+//UNUSED2008-05                              bIsFirst = sal_True;
+//UNUSED2008-05                              return sal_True;
+//UNUSED2008-05                          }
+//UNUSED2008-05                      }
+//UNUSED2008-05                  }
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05      return sal_False;
+//UNUSED2008-05  }
 
 sal_Bool ScXMLExport::IsMatrix (const ScAddress& aCell,
 							table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const
@@ -2834,13 +2834,13 @@
 	return sal_False;
 }
 
-sal_Bool ScXMLExport::IsEditCell(const com::sun::star::uno::Reference <com::sun::star::table::XCell>& xCell) const
-{
-	uno::Reference<sheet::XCellAddressable> xAddressable (xCell, uno::UNO_QUERY);
-	if ( xAddressable.is() )
-		return IsEditCell(xAddressable->getCellAddress());
-	return sal_False;
-}
+//UNUSED2008-05  sal_Bool ScXMLExport::IsEditCell(const com::sun::star::uno::Reference <com::sun::star::table::XCell>& xCell) const
+//UNUSED2008-05  {
+//UNUSED2008-05      uno::Reference<sheet::XCellAddressable> xAddressable (xCell, uno::UNO_QUERY);
+//UNUSED2008-05      if ( xAddressable.is() )
+//UNUSED2008-05          return IsEditCell(xAddressable->getCellAddress());
+//UNUSED2008-05      return sal_False;
+//UNUSED2008-05  }
 
 sal_Bool ScXMLExport::IsEditCell(ScMyCell& rCell) const
 {
@@ -2854,43 +2854,43 @@
 	}
 }
 
-sal_Bool ScXMLExport::IsAnnotationEqual(const uno::Reference<table::XCell>& /* xCell1 */,
-                                        const uno::Reference<table::XCell>& /* xCell2 */)
-{
-    // no longer compareable, because the position and size and other attributes can also differ
-
-/*	uno::Reference<sheet::XSheetAnnotationAnchor> xSheetAnnotationAnchor1(xCell1, uno::UNO_QUERY);
-	uno::Reference<sheet::XSheetAnnotationAnchor> xSheetAnnotationAnchor2(xCell2, uno::UNO_QUERY);
-	if (xSheetAnnotationAnchor1.is() && xSheetAnnotationAnchor2.is())
-	{
-		uno::Reference <sheet::XSheetAnnotation> xSheetAnnotation1(xSheetAnnotationAnchor1->getAnnotation());
-		uno::Reference <sheet::XSheetAnnotation> xSheetAnnotation2(xSheetAnnotationAnchor2->getAnnotation());
-		uno::Reference<text::XSimpleText> xSimpleText1(xSheetAnnotation1, uno::UNO_QUERY);
-		uno::Reference<text::XSimpleText> xSimpleText2(xSheetAnnotation2, uno::UNO_QUERY);
-		if (xSheetAnnotation1.is() && xSimpleText1.is() &&
-			xSheetAnnotation2.is() && xSimpleText2.is())
-		{
-			rtl::OUString sText1(xSimpleText1->getString());
-			rtl::OUString sText2(xSimpleText2->getString());
-			sal_Int32 nLength1(sText1.getLength());
-			sal_Int32 nLength2(sText2.getLength());
-			if (nLength1 && nLength2)
-				if (sText1 == sText2 &&
-					xSheetAnnotation1->getAuthor() == xSheetAnnotation2->getAuthor() &&
-					xSheetAnnotation1->getDate() == xSheetAnnotation2->getDate() &&
-					xSheetAnnotation1->getIsVisible() == xSheetAnnotation2->getIsVisible())
-					return sal_True;
-				else
-					return sal_False;
-			else
-				if (nLength1 || nLength2)
-					return sal_False;
-				else
-					return sal_True;
-		}
-	}*/
-	return sal_False;
-}
+//UNUSED2008-05  sal_Bool ScXMLExport::IsAnnotationEqual(const uno::Reference<table::XCell>& /* xCell1 */,
+//UNUSED2008-05                                          const uno::Reference<table::XCell>& /* xCell2 */)
+//UNUSED2008-05  {
+//UNUSED2008-05      // no longer compareable, because the position and size and other attributes can also differ
+//UNUSED2008-05  
+//UNUSED2008-05  /*	uno::Reference<sheet::XSheetAnnotationAnchor> xSheetAnnotationAnchor1(xCell1, uno::UNO_QUERY);
+//UNUSED2008-05      uno::Reference<sheet::XSheetAnnotationAnchor> xSheetAnnotationAnchor2(xCell2, uno::UNO_QUERY);
+//UNUSED2008-05      if (xSheetAnnotationAnchor1.is() && xSheetAnnotationAnchor2.is())
+//UNUSED2008-05      {
+//UNUSED2008-05          uno::Reference <sheet::XSheetAnnotation> xSheetAnnotation1(xSheetAnnotationAnchor1->getAnnotation());
+//UNUSED2008-05          uno::Reference <sheet::XSheetAnnotation> xSheetAnnotation2(xSheetAnnotationAnchor2->getAnnotation());
+//UNUSED2008-05          uno::Reference<text::XSimpleText> xSimpleText1(xSheetAnnotation1, uno::UNO_QUERY);
+//UNUSED2008-05          uno::Reference<text::XSimpleText> xSimpleText2(xSheetAnnotation2, uno::UNO_QUERY);
+//UNUSED2008-05          if (xSheetAnnotation1.is() && xSimpleText1.is() &&
+//UNUSED2008-05              xSheetAnnotation2.is() && xSimpleText2.is())
+//UNUSED2008-05          {
+//UNUSED2008-05              rtl::OUString sText1(xSimpleText1->getString());
+//UNUSED2008-05              rtl::OUString sText2(xSimpleText2->getString());
+//UNUSED2008-05              sal_Int32 nLength1(sText1.getLength());
+//UNUSED2008-05              sal_Int32 nLength2(sText2.getLength());
+//UNUSED2008-05              if (nLength1 && nLength2)
+//UNUSED2008-05                  if (sText1 == sText2 &&
+//UNUSED2008-05                      xSheetAnnotation1->getAuthor() == xSheetAnnotation2->getAuthor() &&
+//UNUSED2008-05                      xSheetAnnotation1->getDate() == xSheetAnnotation2->getDate() &&
+//UNUSED2008-05                      xSheetAnnotation1->getIsVisible() == xSheetAnnotation2->getIsVisible())
+//UNUSED2008-05                      return sal_True;
+//UNUSED2008-05                  else
+//UNUSED2008-05                      return sal_False;
+//UNUSED2008-05              else
+//UNUSED2008-05                  if (nLength1 || nLength2)
+//UNUSED2008-05                      return sal_False;
+//UNUSED2008-05                  else
+//UNUSED2008-05                      return sal_True;
+//UNUSED2008-05          }
+//UNUSED2008-05      }*/
+//UNUSED2008-05      return sal_False;
+//UNUSED2008-05  }
 
 sal_Bool ScXMLExport::IsCellEqual (ScMyCell& aCell1, ScMyCell& aCell2)
 {
Index: sc/source/filter/xml/xmlexprt.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlexprt.hxx,v
retrieving revision 1.83
retrieving revision 1.83.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.83 -r1.83.32.2
--- sc/source/filter/xml/xmlexprt.hxx	10 Apr 2008 21:29:27 -0000	1.83
+++ sc/source/filter/xml/xmlexprt.hxx	12 May 2008 15:56:59 -0000	1.83.32.2
@@ -164,9 +164,10 @@
 	void FillFieldGroup(ScOutlineArray* pFields, ScMyOpenCloseColumnRowGroup* pGroups);
 	void FillColumnRowGroups();
 
-	sal_Bool GetMerge (const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheet>& xTable,
-		sal_Int32 nCol, sal_Int32 nRow,
-		com::sun::star::table::CellRangeAddress& aCellAddress);
+//UNUSED2008-05  sal_Bool GetMerge (const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheet>& xTable,
+//UNUSED2008-05                     sal_Int32 nCol, sal_Int32 nRow,
+//UNUSED2008-05                     com::sun::star::table::CellRangeAddress& aCellAddress);
+
 	sal_Bool GetMerged (const com::sun::star::table::CellRangeAddress* pCellRange,
 		const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheet>& xTable);
 
@@ -184,10 +185,10 @@
 
 	sal_Bool IsCellTypeEqual (const ScMyCell& aCell1, const ScMyCell& aCell2) const;
 	sal_Bool IsEditCell(const com::sun::star::table::CellAddress& aAddress) const;
-	sal_Bool IsEditCell(const com::sun::star::uno::Reference <com::sun::star::table::XCell>& xCell) const;
+//UNUSED2008-05  sal_Bool IsEditCell(const com::sun::star::uno::Reference <com::sun::star::table::XCell>& xCell) const;
 	sal_Bool IsEditCell(ScMyCell& rCell) const;
-	sal_Bool IsAnnotationEqual(const com::sun::star::uno::Reference<com::sun::star::table::XCell>& xCell1,
-								const com::sun::star::uno::Reference<com::sun::star::table::XCell>& xCell2);
+//UNUSED2008-05  sal_Bool IsAnnotationEqual(const com::sun::star::uno::Reference<com::sun::star::table::XCell>& xCell1,
+//UNUSED2008-05                             const com::sun::star::uno::Reference<com::sun::star::table::XCell>& xCell2);
 	sal_Bool IsCellEqual (ScMyCell& aCell1, ScMyCell& aCell2);
 
 	void WriteCalculationSettings(const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheetDocument>& xSpreadDoc);
@@ -217,10 +218,10 @@
 	static sal_Int16 GetFieldUnit();
 	inline ScDocument*			GetDocument()			{ return pDoc; }
 	inline const ScDocument*	GetDocument() const		{ return pDoc; }
-	sal_Bool IsMatrix (const com::sun::star::uno::Reference <com::sun::star::table::XCellRange>& xCellRange,
-		const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheet>& xTable,
-		const sal_Int32 nCol, const sal_Int32 nRow,
-		com::sun::star::table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const;
+//UNUSED2008-05  sal_Bool IsMatrix (const com::sun::star::uno::Reference <com::sun::star::table::XCellRange>& xCellRange,
+//UNUSED2008-05                     const com::sun::star::uno::Reference <com::sun::star::sheet::XSpreadsheet>& xTable,
+//UNUSED2008-05                     const sal_Int32 nCol, const sal_Int32 nRow,
+//UNUSED2008-05                     com::sun::star::table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const;
 	sal_Bool IsMatrix (const ScAddress& aCell,
 		com::sun::star::table::CellRangeAddress& aCellAddress, sal_Bool& bIsFirst) const;
 
Index: sc/source/filter/xml/xmlimprt.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlimprt.cxx,v
retrieving revision 1.132
retrieving revision 1.132.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.132 -r1.132.30.2
--- sc/source/filter/xml/xmlimprt.cxx	10 Apr 2008 21:30:38 -0000	1.132
+++ sc/source/filter/xml/xmlimprt.cxx	12 May 2008 15:56:59 -0000	1.132.30.2
@@ -959,29 +959,29 @@
 	return *pDocElemTokenMap;
 }
 
-const SvXMLTokenMap& ScXMLImport::GetStylesElemTokenMap()
-{
-	if( !pStylesElemTokenMap )
-		pStylesElemTokenMap = new SvXMLTokenMap( aStylesTokenMap );
-
-	return *pStylesElemTokenMap;
-}
-
-const SvXMLTokenMap& ScXMLImport::GetStylesAttrTokenMap()
-{
-	if( !pStylesAttrTokenMap )
-		pStylesAttrTokenMap = new SvXMLTokenMap( aStylesAttrTokenMap );
-
-	return *pStylesAttrTokenMap;
-}
-
-const SvXMLTokenMap& ScXMLImport::GetStyleElemTokenMap()
-{
-	if( !pStyleElemTokenMap )
-		pStyleElemTokenMap = new SvXMLTokenMap( aStyleTokenMap );
-
-	return *pStyleElemTokenMap;
-}
+//UNUSED2008-05  const SvXMLTokenMap& ScXMLImport::GetStylesElemTokenMap()
+//UNUSED2008-05  {
+//UNUSED2008-05      if( !pStylesElemTokenMap )
+//UNUSED2008-05          pStylesElemTokenMap = new SvXMLTokenMap( aStylesTokenMap );
+//UNUSED2008-05  
+//UNUSED2008-05      return *pStylesElemTokenMap;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  const SvXMLTokenMap& ScXMLImport::GetStylesAttrTokenMap()
+//UNUSED2008-05  {
+//UNUSED2008-05      if( !pStylesAttrTokenMap )
+//UNUSED2008-05          pStylesAttrTokenMap = new SvXMLTokenMap( aStylesAttrTokenMap );
+//UNUSED2008-05  
+//UNUSED2008-05      return *pStylesAttrTokenMap;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  const SvXMLTokenMap& ScXMLImport::GetStyleElemTokenMap()
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( !pStyleElemTokenMap )
+//UNUSED2008-05          pStyleElemTokenMap = new SvXMLTokenMap( aStyleTokenMap );
+//UNUSED2008-05  
+//UNUSED2008-05      return *pStyleElemTokenMap;
+//UNUSED2008-05  }
 
 const SvXMLTokenMap& ScXMLImport::GetBodyElemTokenMap()
 {
@@ -1116,12 +1116,12 @@
 	return *pTableRowCellElemTokenMap;
 }
 
-const SvXMLTokenMap& ScXMLImport::GetTableRowCellAttrTokenMap()
-{
-	if( !pTableRowCellAttrTokenMap )
-		pTableRowCellAttrTokenMap = new SvXMLTokenMap( aTableRowCellAttrTokenMap );
-	return *pTableRowCellAttrTokenMap;
-}
+//UNUSED2008-05  const SvXMLTokenMap& ScXMLImport::GetTableRowCellAttrTokenMap()
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( !pTableRowCellAttrTokenMap )
+//UNUSED2008-05          pTableRowCellAttrTokenMap = new SvXMLTokenMap( aTableRowCellAttrTokenMap );
+//UNUSED2008-05      return *pTableRowCellAttrTokenMap;
+//UNUSED2008-05  }
 
 const SvXMLTokenMap& ScXMLImport::GetTableAnnotationAttrTokenMap()
 {
Index: sc/source/filter/xml/xmlimprt.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlimprt.hxx,v
retrieving revision 1.96
retrieving revision 1.96.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.96 -r1.96.32.2
--- sc/source/filter/xml/xmlimprt.hxx	10 Apr 2008 21:30:55 -0000	1.96
+++ sc/source/filter/xml/xmlimprt.hxx	12 May 2008 15:56:59 -0000	1.96.32.2
@@ -826,9 +826,9 @@
 //	SvXMLImportContextRef			GetStyles() const { return xStyles; }
 
 	const SvXMLTokenMap& GetDocElemTokenMap();
-	const SvXMLTokenMap& GetStylesElemTokenMap();
-	const SvXMLTokenMap& GetStylesAttrTokenMap();
-	const SvXMLTokenMap& GetStyleElemTokenMap();
+//UNUSED2008-05  const SvXMLTokenMap& GetStylesElemTokenMap();
+//UNUSED2008-05  const SvXMLTokenMap& GetStylesAttrTokenMap();
+//UNUSED2008-05  const SvXMLTokenMap& GetStyleElemTokenMap();
 	const SvXMLTokenMap& GetBodyElemTokenMap();
 	const SvXMLTokenMap& GetContentValidationsElemTokenMap();
 	const SvXMLTokenMap& GetContentValidationElemTokenMap();
@@ -848,7 +848,7 @@
 	const SvXMLTokenMap& GetTableRowElemTokenMap();
 	const SvXMLTokenMap& GetTableRowAttrTokenMap();
 	const SvXMLTokenMap& GetTableRowCellElemTokenMap();
-	const SvXMLTokenMap& GetTableRowCellAttrTokenMap();
+//UNUSED2008-05  const SvXMLTokenMap& GetTableRowCellAttrTokenMap();
 	const SvXMLTokenMap& GetTableAnnotationAttrTokenMap();
 	const SvXMLTokenMap& GetDetectiveElemTokenMap();
 	const SvXMLTokenMap& GetDetectiveHighlightedAttrTokenMap();
Index: sc/source/filter/xml/xmlsubti.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlsubti.cxx,v
retrieving revision 1.50
retrieving revision 1.50.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.50 -r1.50.30.1
--- sc/source/filter/xml/xmlsubti.cxx	10 Apr 2008 21:36:36 -0000	1.50
+++ sc/source/filter/xml/xmlsubti.cxx	9 May 2008 21:22:42 -0000	1.50.30.1
@@ -109,14 +109,6 @@
 	nRealCols[aTableCellPos.Column + 1] = nRealCols[aTableCellPos.Column] + nColsPerCol[aTableCellPos.Column];
 }
 
-sal_Int32 ScMyTableData::FindNextCol(const sal_Int32 nIndex) const
-{
-	sal_Int32 i = nIndex;
-	while(nRealCols[i] < 0)
-		++i;
-	return nRealCols[i];
-}
-
 sal_Int32 ScMyTableData::GetRealCols(const sal_Int32 nIndex, const sal_Bool /* bIsNormal */) const
 {
 	return (nIndex < 0) ? 0 : nRealCols[nIndex];
@@ -425,22 +417,6 @@
 	rImport.GetStylesImportHelper()->SetRowStyle(rCellStyleName);
 }
 
-void ScMyTables::CloseRow()
-{
-	sal_Int32 nToMerge;
-	sal_Int32 nSpannedCols(aTableVec[nTableCount - 1]->GetSpannedCols());
-	sal_Int32 nColCount(aTableVec[nTableCount - 1]->GetColCount());
-	sal_Int32 nCol(aTableVec[nTableCount - 1]->GetColumn());
-	sal_Int32 nColsPerCol(aTableVec[nTableCount - 1]->GetColsPerCol(nCol));
-	if (nSpannedCols > nColCount)
-		nToMerge = aTableVec[nTableCount - 1]->GetChangedCols(nCol, nCol + nColsPerCol + nSpannedCols - nColCount);
-	else
-		nToMerge = aTableVec[nTableCount - 1]->GetChangedCols(nCol, nCol + nColsPerCol);
-	if ((nToMerge > nCol) && (aTableVec[nTableCount - 1]->GetSubTableSpanned() == 1))
-		DoMerge(nColsPerCol + aTableVec[nTableCount - 1]->GetColsPerCol(nToMerge) - 1);
-}
-
-
 void ScMyTables::InsertColumn()
 {
 	if ( xCurrentCellRange.is() )
Index: sc/source/filter/xml/xmlsubti.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlsubti.hxx,v
retrieving revision 1.32
retrieving revision 1.32.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.32 -r1.32.32.1
--- sc/source/filter/xml/xmlsubti.hxx	10 Apr 2008 21:36:56 -0000	1.32
+++ sc/source/filter/xml/xmlsubti.hxx	9 May 2008 21:22:42 -0000	1.32.32.1
@@ -74,7 +74,6 @@
 	void								AddRow();
 	void								AddColumn();
 	void								SetFirstColumn() { aTableCellPos.Column = -1; }
-	sal_Int32							FindNextCol(const sal_Int32 nIndex) const;
 	sal_Int32                           GetColsPerCol(const sal_Int32 nIndex) const { return nColsPerCol[nIndex]; }
 	void								SetColsPerCol(const sal_Int32 nIndex, sal_Int32 nValue = 1) { nColsPerCol[nIndex] = nValue; }
 	sal_Int32							GetRealCols(const sal_Int32 nIndex, const sal_Bool bIsNormal = sal_True) const;
@@ -149,7 +148,6 @@
 												const sal_Bool bProtection, const rtl::OUString& sPassword);
 	void								AddRow();
 	void								SetRowStyle(const rtl::OUString& rCellStyleName);
-	void								CloseRow();
 	void								AddColumn(sal_Bool bIsCovered);
 	void								NewTable(sal_Int32 nTempSpannedCols);
 	void								UpdateRowHeights();
Index: sc/source/filter/xml/xmlwrap.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xml/xmlwrap.cxx,v
retrieving revision 1.69
retrieving revision 1.69.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.69 -r1.69.32.2
--- sc/source/filter/xml/xmlwrap.cxx	10 Apr 2008 21:38:41 -0000	1.69
+++ sc/source/filter/xml/xmlwrap.cxx	12 May 2008 15:56:59 -0000	1.69.32.2
@@ -111,34 +111,34 @@
     DBG_ASSERT( pMedium || xStorage.is(), "ScXMLImportWrapper: Medium or Storage must be set" );
 }
 
-uno::Reference <task::XStatusIndicator> ScXMLImportWrapper::GetStatusIndicator(
-	uno::Reference < frame::XModel> & rModel)
-{
-	DBG_ERROR( "The status indicator from medium must be used!" );
-
-	uno::Reference<task::XStatusIndicator> xStatusIndicator;
-
-	if (rModel.is())
-	{
-		uno::Reference<frame::XController> xController( rModel->getCurrentController());
-		if( xController.is())
-		{
-			uno::Reference<task::XStatusIndicatorFactory> xFactory( xController->getFrame(), uno::UNO_QUERY );
-			if( xFactory.is())
-			{
-				try
-				{
-					xStatusIndicator.set(xFactory->createStatusIndicator());
-				}
-				catch( lang::DisposedException e )
-				{
-					DBG_ERROR("Exception while trying to get a Status Indicator");
-				}
-			}
-		}
-	}
-	return xStatusIndicator;
-}
+//UNUSED2008-05  uno::Reference <task::XStatusIndicator> ScXMLImportWrapper::GetStatusIndicator(
+//UNUSED2008-05          uno::Reference < frame::XModel> & rModel)
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ERROR( "The status indicator from medium must be used!" );
+//UNUSED2008-05  
+//UNUSED2008-05      uno::Reference<task::XStatusIndicator> xStatusIndicator;
+//UNUSED2008-05  
+//UNUSED2008-05      if (rModel.is())
+//UNUSED2008-05      {
+//UNUSED2008-05          uno::Reference<frame::XController> xController( rModel->getCurrentController());
+//UNUSED2008-05          if ( xController.is())
+//UNUSED2008-05          {
+//UNUSED2008-05              uno::Reference<task::XStatusIndicatorFactory> xFactory( xController->getFrame(), uno::UNO_QUERY );
+//UNUSED2008-05              if ( xFactory.is())
+//UNUSED2008-05              {
+//UNUSED2008-05                  try
+//UNUSED2008-05                  {
+//UNUSED2008-05                      xStatusIndicator.set(xFactory->createStatusIndicator());
+//UNUSED2008-05                  }
+//UNUSED2008-05                  catch ( lang::DisposedException e )
+//UNUSED2008-05                  {
+//UNUSED2008-05                      DBG_ERROR("Exception while trying to get a Status Indicator");
+//UNUSED2008-05                  }
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05      return xStatusIndicator;
+//UNUSED2008-05  }
 
 uno::Reference <task::XStatusIndicator> ScXMLImportWrapper::GetStatusIndicator()
 {
Index: sc/source/ui/Accessibility/AccessibleContextBase.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleContextBase.cxx,v
retrieving revision 1.33
retrieving revision 1.33.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.33 -r1.33.32.1
--- sc/source/ui/Accessibility/AccessibleContextBase.cxx	10 Apr 2008 21:40:25 -0000	1.33
+++ sc/source/ui/Accessibility/AccessibleContextBase.cxx	9 May 2008 04:45:58 -0000	1.33.32.1
@@ -584,16 +584,6 @@
 	CommitChange(aEvent);
 }
 
-void ScAccessibleContextBase::CommitDefunc() const
-{
-	AccessibleEventObject aEvent;
-	aEvent.EventId = AccessibleEventId::STATE_CHANGED;
-	aEvent.Source = uno::Reference< XAccessibleContext >(const_cast<ScAccessibleContextBase*>(this));
-	aEvent.NewValue <<= AccessibleStateType::DEFUNC;
-
-	CommitChange(aEvent);
-}
-
 void ScAccessibleContextBase::CommitFocusGained() const
 {
 	AccessibleEventObject aEvent;
Index: sc/source/ui/Accessibility/AccessibleCsvControl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleCsvControl.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.1
--- sc/source/ui/Accessibility/AccessibleCsvControl.cxx	10 Apr 2008 21:40:43 -0000	1.22
+++ sc/source/ui/Accessibility/AccessibleCsvControl.cxx	9 May 2008 04:45:58 -0000	1.22.32.1
@@ -300,11 +300,6 @@
     }
 }
 
-Point ScAccessibleCsvControl::implGetRelPos( const Point& rPos ) const
-{
-    return rPos - implGetControl().GetWindowExtentsRelative( NULL ).TopLeft();
-}
-
 Point ScAccessibleCsvControl::implGetAbsPos( const Point& rPos ) const
 {
     return rPos + implGetControl().GetWindowExtentsRelative( NULL ).TopLeft();
Index: sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx,v
retrieving revision 1.38
retrieving revision 1.38.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.38 -r1.38.32.2
--- sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	10 Apr 2008 21:41:46 -0000	1.38
+++ sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	12 May 2008 15:56:59 -0000	1.38.32.2
@@ -740,7 +740,8 @@
     ::accessibility::AccessibleShape* GetAccShape(const ScShapeChild& rShape) const;
     ::accessibility::AccessibleShape* GetAccShape(const ScShapeChildVec& rShapes, sal_Int32 nIndex) const;
     void FillShapes(const Rectangle& aPixelPaintRect, const MapMode& aMapMode, sal_uInt8 nRangeId);
-    sal_Bool FindShape(ScShapeChildVec& rShapes, const uno::Reference <drawing::XShape>& xShape, ScShapeChildVec::iterator& rItr) const;
+//UNUSED2008-05  sal_Bool FindShape(ScShapeChildVec& rShapes, const uno::Reference <drawing::XShape>& xShape, ScShapeChildVec::iterator& rItr) const;
+
 //    void AddShape(const uno::Reference<drawing::XShape>& xShape, SdrLayerID aLayerID);
 //    void RemoveShape(const uno::Reference<drawing::XShape>& xShape, SdrLayerID aLayerID);
     SdrPage* GetDrawPage() const;
@@ -1205,21 +1206,21 @@
     }
 }
 
-sal_Bool ScShapeChilds::FindShape(ScShapeChildVec& rShapes, const uno::Reference <drawing::XShape>& xShape, ScShapeChildVec::iterator& rItr) const
-{
-    sal_Bool bResult(sal_False);
-    ScShapeChild aShape;
-    aShape.mxShape = xShape;
-    rItr = std::lower_bound(rShapes.begin(), rShapes.end(), aShape, ScShapeChildLess());
-    if (rItr->mxShape.get() == xShape.get())
-        bResult = sal_True; // if the shape is found
-
-/*#ifndef PRODUCT // test whether it finds truly the correct shape (perhaps it is not really sorted)
-    ScShapeChildVec::iterator aDebugItr = std::find(rShapes.begin(), rShapes.end(), aShape);
-    DBG_ASSERT(rItr == aDebugItr, "wrong Shape found");
-#endif*/
-    return bResult;
-}
+//UNUSED2008-05  sal_Bool ScShapeChilds::FindShape(ScShapeChildVec& rShapes, const uno::Reference <drawing::XShape>& xShape, ScShapeChildVec::iterator& rItr) const
+//UNUSED2008-05  {
+//UNUSED2008-05      sal_Bool bResult(sal_False);
+//UNUSED2008-05      ScShapeChild aShape;
+//UNUSED2008-05      aShape.mxShape = xShape;
+//UNUSED2008-05      rItr = std::lower_bound(rShapes.begin(), rShapes.end(), aShape, ScShapeChildLess());
+//UNUSED2008-05      if (rItr->mxShape.get() == xShape.get())
+//UNUSED2008-05          bResult = sal_True; // if the shape is found
+//UNUSED2008-05  
+//UNUSED2008-05  /*#ifndef PRODUCT // test whether it finds truly the correct shape (perhaps it is not really sorted)
+//UNUSED2008-05      ScShapeChildVec::iterator aDebugItr = std::find(rShapes.begin(), rShapes.end(), aShape);
+//UNUSED2008-05      DBG_ASSERT(rItr == aDebugItr, "wrong Shape found");
+//UNUSED2008-05  #endif*/
+//UNUSED2008-05      return bResult;
+//UNUSED2008-05  }
 
 /*void ScShapeChilds::AddShape(const uno::Reference<drawing::XShape>& xShape, SdrLayerID aLayerID)
 {
Index: sc/source/ui/Accessibility/AccessiblePreviewCell.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessiblePreviewCell.cxx,v
retrieving revision 1.21
retrieving revision 1.21.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.32.1
--- sc/source/ui/Accessibility/AccessiblePreviewCell.cxx	10 Apr 2008 21:42:51 -0000	1.21
+++ sc/source/ui/Accessibility/AccessiblePreviewCell.cxx	9 May 2008 04:45:58 -0000	1.21.32.1
@@ -299,11 +299,6 @@
 	return bOpaque;
 }
 
-sal_Bool ScAccessiblePreviewCell::IsSelected(const uno::Reference<XAccessibleStateSet>& /* rxParentStates */)
-{
-	return sal_False;
-}
-
 void ScAccessiblePreviewCell::CreateTextHelper()
 {
 	if (!mpTextHelper)
Index: sc/source/ui/Accessibility/AccessibleText.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleText.cxx,v
retrieving revision 1.42
retrieving revision 1.42.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.42 -r1.42.32.2
--- sc/source/ui/Accessibility/AccessibleText.cxx	10 Apr 2008 21:44:09 -0000	1.42
+++ sc/source/ui/Accessibility/AccessibleText.cxx	13 May 2008 14:34:12 -0000	1.42.32.2
@@ -284,7 +284,6 @@
     void                SetInvalid();
 
     Rectangle GetVisRect() const;
-	void FillTableInfo() const;
 
     // clips the VisArea and calculates with the negativ coordinates
     Rectangle CorrectVisArea(const Rectangle& rVisArea) const;
@@ -376,15 +375,6 @@
     return Rectangle();
 }
 
-void ScPreviewViewForwarder::FillTableInfo() const
-{
-	if ( mpViewShell && !mpTableInfo )
-	{
-		mpTableInfo = new ScPreviewTableInfo;
-		mpViewShell->GetLocationData().GetTableInfo( GetVisRect(), *mpTableInfo );
-	}
-}
-
 Rectangle ScPreviewViewForwarder::CorrectVisArea(const Rectangle& rVisArea) const
 {
     Rectangle aVisArea(rVisArea);
@@ -1312,18 +1302,18 @@
 	return mpViewForwarder;
 }
 
-IMPL_LINK(ScAccessiblePreviewCellTextData, NotifyHdl, EENotify*, aNotify)
-{
-    if( aNotify )
-    {
-        ::std::auto_ptr< SfxHint > aHint = SvxEditSourceHelper::EENotification2Hint( aNotify);
-
-        if( aHint.get() )
-            GetBroadcaster().Broadcast( *aHint.get() );
-    }
-
-    return 0;
-}
+//UNUSED2008-05  IMPL_LINK(ScAccessiblePreviewCellTextData, NotifyHdl, EENotify*, aNotify)
+//UNUSED2008-05  {
+//UNUSED2008-05      if( aNotify )
+//UNUSED2008-05      {
+//UNUSED2008-05          ::std::auto_ptr< SfxHint > aHint = SvxEditSourceHelper::EENotification2Hint( aNotify);
+//UNUSED2008-05  
+//UNUSED2008-05          if( aHint.get() )
+//UNUSED2008-05              GetBroadcaster().Broadcast( *aHint.get() );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return 0;
+//UNUSED2008-05  }
 
 ScDocShell* ScAccessiblePreviewCellTextData::GetDocShell(ScPreviewShell* pViewShell)
 {
@@ -1440,18 +1430,18 @@
 	return mpViewForwarder;
 }
 
-IMPL_LINK(ScAccessiblePreviewHeaderCellTextData, NotifyHdl, EENotify*, aNotify)
-{
-    if( aNotify )
-    {
-        ::std::auto_ptr< SfxHint > aHint = SvxEditSourceHelper::EENotification2Hint( aNotify);
-
-        if( aHint.get() )
-            GetBroadcaster().Broadcast( *aHint.get() );
-    }
-
-    return 0;
-}
+//UNUSED2008-05  IMPL_LINK(ScAccessiblePreviewHeaderCellTextData, NotifyHdl, EENotify*, aNotify)
+//UNUSED2008-05  {
+//UNUSED2008-05      if( aNotify )
+//UNUSED2008-05      {
+//UNUSED2008-05          ::std::auto_ptr< SfxHint > aHint = SvxEditSourceHelper::EENotification2Hint( aNotify);
+//UNUSED2008-05  
+//UNUSED2008-05          if( aHint.get() )
+//UNUSED2008-05              GetBroadcaster().Broadcast( *aHint.get() );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return 0;
+//UNUSED2008-05  }
 
 ScDocShell* ScAccessiblePreviewHeaderCellTextData::GetDocShell(ScPreviewShell* pViewShell)
 {
Index: sc/source/ui/app/inputhdl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/inputhdl.cxx,v
retrieving revision 1.77
retrieving revision 1.77.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.77 -r1.77.32.1
--- sc/source/ui/app/inputhdl.cxx	10 Apr 2008 21:45:27 -0000	1.77
+++ sc/source/ui/app/inputhdl.cxx	9 May 2008 16:11:49 -0000	1.77.32.1
@@ -1333,14 +1333,6 @@
 	pTopView = NULL;		// invalid now
 }
 
-void ScInputHandler::ActivateInputWindow( const String&     rText,
-										  const ESelection& rSel )
-{
-	if ( pInputWin )
-		if ( !pInputWin->IsInputActive() )
-			pTopView = pInputWin->ActivateEdit( rText, rSel );
-}
-
 EditView* ScInputHandler::GetActiveView()
 {
 	UpdateActiveView();
@@ -1676,12 +1668,6 @@
 	}
 }
 
-void ScInputHandler::SetAllUpdateMode( BOOL bUpdate )
-{
-	ImplCreateEditEngine();
-	pEngine->SetUpdateMode( bUpdate );
-}
-
 IMPL_LINK( ScInputHandler, ModifyHdl, void *, EMPTYARG )
 {
 	if ( !bInOwnChange && ( eMode==SC_INPUT_TYPE || eMode==SC_INPUT_TABLE ) &&
Index: sc/source/ui/app/inputwin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/inputwin.cxx,v
retrieving revision 1.57
retrieving revision 1.57.22.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.57 -r1.57.22.2
--- sc/source/ui/app/inputwin.cxx	18 Apr 2008 11:33:17 -0000	1.57
+++ sc/source/ui/app/inputwin.cxx	13 May 2008 18:35:05 -0000	1.57.22.2
@@ -548,11 +548,6 @@
 	}
 }
 
-const String& ScInputWindow::GetTextString()
-{
-	return aTextWindow.GetTextString();
-}
-
 void ScInputWindow::SetOkCancelMode()
 {
 	//!	new method at ScModule to query if function autopilot is open
@@ -621,19 +616,19 @@
 }
 
 
-EditView* ScInputWindow::ActivateEdit( const String&     rText,
-									   const ESelection& rSel )
-{
-	if ( !aTextWindow.IsInputActive() )
-	{
-		aTextWindow.StartEditEngine();
-		aTextWindow.GrabFocus();
-		aTextWindow.SetTextString( rText );
-		aTextWindow.GetEditView()->SetSelection( rSel );
-	}
-
-	return aTextWindow.GetEditView();
-}
+//UNUSED2008-05  EditView* ScInputWindow::ActivateEdit( const String&     rText,
+//UNUSED2008-05                                         const ESelection& rSel )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( !aTextWindow.IsInputActive() )
+//UNUSED2008-05      {
+//UNUSED2008-05          aTextWindow.StartEditEngine();
+//UNUSED2008-05          aTextWindow.GrabFocus();
+//UNUSED2008-05          aTextWindow.SetTextString( rText );
+//UNUSED2008-05          aTextWindow.GetEditView()->SetSelection( rSel );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return aTextWindow.GetEditView();
+//UNUSED2008-05  }
 
 BOOL ScInputWindow::IsInputActive()
 {
Index: sc/source/ui/app/scdll.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/scdll.cxx,v
retrieving revision 1.44
retrieving revision 1.44.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.44 -r1.44.32.2
--- sc/source/ui/app/scdll.cxx	10 Apr 2008 21:46:59 -0000	1.44
+++ sc/source/ui/app/scdll.cxx	12 May 2008 16:41:59 -0000	1.44.32.2
@@ -130,32 +130,31 @@
 
 //------------------------------------------------------------------
 
-//	filter detection can't use ScFilterOptions (in sc-dll),
-//	so access to wk3 flag must be implemented here again
-
-class ScLibOptions : public utl::ConfigItem
-{
-	BOOL		bWK3Flag;
-
-public:
-				ScLibOptions();
-	BOOL		GetWK3Flag() const			{ return bWK3Flag; }
-};
-
-#define CFGPATH_LIBFILTER		"Office.Calc/Filter/Import/Lotus123"
-#define ENTRYSTR_WK3			"WK3"
-
-ScLibOptions::ScLibOptions() :
-	ConfigItem( rtl::OUString::createFromAscii( CFGPATH_LIBFILTER ) ),
-	bWK3Flag( FALSE )
-{
-	com::sun::star::uno::Sequence<rtl::OUString> aNames(1);
-	aNames[0] = rtl::OUString::createFromAscii( ENTRYSTR_WK3 );
-	com::sun::star::uno::Sequence<com::sun::star::uno::Any> aValues = GetProperties(aNames);
-	if ( aValues.getLength() == 1 && aValues[0].hasValue() )
-		bWK3Flag = comphelper::getBOOL( aValues[0] );
-}
-
+//UNUSED2008-05  //	filter detection can't use ScFilterOptions (in sc-dll),
+//UNUSED2008-05  //	so access to wk3 flag must be implemented here again
+//UNUSED2008-05  
+//UNUSED2008-05  class ScLibOptions : public utl::ConfigItem
+//UNUSED2008-05  {
+//UNUSED2008-05      BOOL        bWK3Flag;
+//UNUSED2008-05  
+//UNUSED2008-05  public:
+//UNUSED2008-05                  ScLibOptions();
+//UNUSED2008-05      BOOL        GetWK3Flag() const          { return bWK3Flag; }
+//UNUSED2008-05  };
+//UNUSED2008-05  
+//UNUSED2008-05  #define CFGPATH_LIBFILTER		"Office.Calc/Filter/Import/Lotus123"
+//UNUSED2008-05  #define ENTRYSTR_WK3			"WK3"
+//UNUSED2008-05  
+//UNUSED2008-05  ScLibOptions::ScLibOptions() :
+//UNUSED2008-05      ConfigItem( rtl::OUString::createFromAscii( CFGPATH_LIBFILTER ) ),
+//UNUSED2008-05      bWK3Flag( FALSE )
+//UNUSED2008-05  {
+//UNUSED2008-05      com::sun::star::uno::Sequence<rtl::OUString> aNames(1);
+//UNUSED2008-05      aNames[0] = rtl::OUString::createFromAscii( ENTRYSTR_WK3 );
+//UNUSED2008-05      com::sun::star::uno::Sequence<com::sun::star::uno::Any> aValues = GetProperties(aNames);
+//UNUSED2008-05      if ( aValues.getLength() == 1 && aValues[0].hasValue() )
+//UNUSED2008-05          bWK3Flag = comphelper::getBOOL( aValues[0] );
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------
 
@@ -366,51 +365,51 @@
 
 #define TEXT_WIDTH(s)	rStatusBar.GetTextWidth((s))
 
-void ScDLL::FillStatusBar(StatusBar &rStatusBar)
-{
-	// Dokumentposition (Tabelle x / y)
-	rStatusBar.InsertItem( SID_STATUS_DOCPOS,
-							TEXT_WIDTH( String().Fill( 10, 'X' ) ),
-							SIB_LEFT|SIB_AUTOSIZE );
-
-	// Seitenvorlage
-	rStatusBar.InsertItem( SID_STATUS_PAGESTYLE,
-							TEXT_WIDTH( String().Fill( 15, 'X' ) ),
-							SIB_LEFT|SIB_AUTOSIZE );
-
-	// Ma"sstab
-	rStatusBar.InsertItem(	SID_ATTR_ZOOM,
-							SvxZoomStatusBarControl::GetDefItemWidth(rStatusBar),
-							SIB_CENTER );
-
-	// Einfuege-/Ueberschreibmodus
-	rStatusBar.InsertItem( SID_ATTR_INSERT,
-							SvxInsertStatusBarControl::GetDefItemWidth(rStatusBar),
-							SIB_CENTER );
-
-	// Selektionsmodus
-	rStatusBar.InsertItem( SID_STATUS_SELMODE,
-							SvxSelectionModeControl::GetDefItemWidth(rStatusBar),
-							SIB_CENTER );
-
-	// Dokument geaendert
-	rStatusBar.InsertItem( SID_DOC_MODIFIED,
-							SvxModifyControl::GetDefItemWidth(rStatusBar));
-
-	// signatures
-	rStatusBar.InsertItem( SID_SIGNATURE, XmlSecStatusBarControl::GetDefItemWidth( rStatusBar ), SIB_USERDRAW );
-	rStatusBar.SetHelpId(SID_SIGNATURE, SID_SIGNATURE);
-
-	// Mail
-	rStatusBar.InsertItem( SID_MAIL_NOTIFY,
-							TEXT_WIDTH( String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("Mail")) ),
-							SIB_CENTER );
-
-	// den aktuellen Kontext anzeigen Uhrzeit / FramePos / TabellenInfo / Errors
-	rStatusBar.InsertItem( SID_ATTR_SIZE,
-							SvxPosSizeStatusBarControl::GetDefItemWidth(rStatusBar),
-							SIB_AUTOSIZE|SIB_LEFT|SIB_USERDRAW);
-}
+//UNUSED2008-05  void ScDLL::FillStatusBar(StatusBar &rStatusBar)
+//UNUSED2008-05  {
+//UNUSED2008-05      // Dokumentposition (Tabelle x / y)
+//UNUSED2008-05      rStatusBar.InsertItem( SID_STATUS_DOCPOS,
+//UNUSED2008-05                              TEXT_WIDTH( String().Fill( 10, 'X' ) ),
+//UNUSED2008-05                              SIB_LEFT|SIB_AUTOSIZE );
+//UNUSED2008-05  
+//UNUSED2008-05      // Seitenvorlage
+//UNUSED2008-05      rStatusBar.InsertItem( SID_STATUS_PAGESTYLE,
+//UNUSED2008-05                              TEXT_WIDTH( String().Fill( 15, 'X' ) ),
+//UNUSED2008-05                              SIB_LEFT|SIB_AUTOSIZE );
+//UNUSED2008-05  
+//UNUSED2008-05      // Ma"sstab
+//UNUSED2008-05      rStatusBar.InsertItem(  SID_ATTR_ZOOM,
+//UNUSED2008-05                              SvxZoomStatusBarControl::GetDefItemWidth(rStatusBar),
+//UNUSED2008-05                              SIB_CENTER );
+//UNUSED2008-05  
+//UNUSED2008-05      // Einfuege-/Ueberschreibmodus
+//UNUSED2008-05      rStatusBar.InsertItem( SID_ATTR_INSERT,
+//UNUSED2008-05                              SvxInsertStatusBarControl::GetDefItemWidth(rStatusBar),
+//UNUSED2008-05                              SIB_CENTER );
+//UNUSED2008-05  
+//UNUSED2008-05      // Selektionsmodus
+//UNUSED2008-05      rStatusBar.InsertItem( SID_STATUS_SELMODE,
+//UNUSED2008-05                              SvxSelectionModeControl::GetDefItemWidth(rStatusBar),
+//UNUSED2008-05                              SIB_CENTER );
+//UNUSED2008-05  
+//UNUSED2008-05      // Dokument geaendert
+//UNUSED2008-05      rStatusBar.InsertItem( SID_DOC_MODIFIED,
+//UNUSED2008-05                              SvxModifyControl::GetDefItemWidth(rStatusBar));
+//UNUSED2008-05  
+//UNUSED2008-05      // signatures
+//UNUSED2008-05      rStatusBar.InsertItem( SID_SIGNATURE, XmlSecStatusBarControl::GetDefItemWidth( rStatusBar ), SIB_USERDRAW );
+//UNUSED2008-05      rStatusBar.SetHelpId(SID_SIGNATURE, SID_SIGNATURE);
+//UNUSED2008-05  
+//UNUSED2008-05      // Mail
+//UNUSED2008-05      rStatusBar.InsertItem( SID_MAIL_NOTIFY,
+//UNUSED2008-05                              TEXT_WIDTH( String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("Mail")) ),
+//UNUSED2008-05                              SIB_CENTER );
+//UNUSED2008-05  
+//UNUSED2008-05      // den aktuellen Kontext anzeigen Uhrzeit / FramePos / TabellenInfo / Errors
+//UNUSED2008-05      rStatusBar.InsertItem( SID_ATTR_SIZE,
+//UNUSED2008-05                              SvxPosSizeStatusBarControl::GetDefItemWidth(rStatusBar),
+//UNUSED2008-05                              SIB_AUTOSIZE|SIB_LEFT|SIB_USERDRAW);
+//UNUSED2008-05  }
 
 #undef TEXT_WIDTH
 
Index: sc/source/ui/app/scmod.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/scmod.cxx,v
retrieving revision 1.58
retrieving revision 1.58.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.58 -r1.58.32.1
--- sc/source/ui/app/scmod.cxx	10 Apr 2008 21:47:15 -0000	1.58
+++ sc/source/ui/app/scmod.cxx	9 May 2008 21:22:43 -0000	1.58.32.1
@@ -1576,13 +1576,6 @@
 		pHdl->InputChanged( pView );
 }
 
-void ScModule::SetInputWindow( ScInputWindow* pWin )
-{
-	ScInputHandler* pHdl = GetInputHdl();
-	if ( pHdl )
-		pHdl->SetInputWindow( pWin );
-}
-
 void ScModule::ViewShellGone( ScTabViewShell* pViewSh )
 {
 	ScInputHandler* pHdl = GetInputHdl();
@@ -1678,12 +1671,6 @@
 //
 //------------------------------------------------------------------
 
-void ScModule::CloseDialogs()
-{
-	if( nCurRefDlgId )
-		SetRefDialog( nCurRefDlgId, FALSE );
-}
-
 void ScModule::SetRefDialog( USHORT nId, BOOL bVis, SfxViewFrame* pViewFrm )
 {
 	//!	move reference dialog handling to view
Index: sc/source/ui/app/uiitems.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/uiitems.cxx,v
retrieving revision 1.9
retrieving revision 1.9.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.2
--- sc/source/ui/app/uiitems.cxx	10 Apr 2008 21:48:46 -0000	1.9
+++ sc/source/ui/app/uiitems.cxx	12 May 2008 16:41:59 -0000	1.9.32.2
@@ -60,21 +60,21 @@
 //      ScInputStatusItem - Status-Update fuer Eingabezeile
 // -----------------------------------------------------------------------
 
-ScInputStatusItem::ScInputStatusItem( USHORT nWhichP,
-									  SCTAB nTab,
-									  SCCOL nCol, SCROW nRow,
-									  SCCOL nStartCol, SCROW nStartRow,
-									  SCCOL nEndCol,   SCROW nEndRow,
-									  const String& rString, const EditTextObject* pData )
-
-    :   SfxPoolItem ( nWhichP ),
-		aCursorPos	( nCol, nRow, nTab ),
-		aStartPos	( nStartCol, nStartRow, nTab ),
-		aEndPos		( nEndCol,   nEndRow,   nTab ),
-		aString		( rString ),
-		pEditData	( pData ? pData->Clone() : NULL )
-{
-}
+//UNUSED2008-05  ScInputStatusItem::ScInputStatusItem( USHORT nWhichP,
+//UNUSED2008-05                                        SCTAB nTab,
+//UNUSED2008-05                                        SCCOL nCol, SCROW nRow,
+//UNUSED2008-05                                        SCCOL nStartCol, SCROW nStartRow,
+//UNUSED2008-05                                        SCCOL nEndCol,   SCROW nEndRow,
+//UNUSED2008-05                                        const String& rString, const EditTextObject* pData )
+//UNUSED2008-05  
+//UNUSED2008-05      :   SfxPoolItem ( nWhichP ),
+//UNUSED2008-05          aCursorPos  ( nCol, nRow, nTab ),
+//UNUSED2008-05          aStartPos   ( nStartCol, nStartRow, nTab ),
+//UNUSED2008-05          aEndPos     ( nEndCol,   nEndRow,   nTab ),
+//UNUSED2008-05          aString     ( rString ),
+//UNUSED2008-05          pEditData   ( pData ? pData->Clone() : NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScInputStatusItem::ScInputStatusItem( USHORT nWhichP,
 									  const ScAddress& rCurPos,
@@ -166,12 +166,6 @@
 //      ScEditViewHint - neue EditView fuer Cursorposition anlegen
 // -----------------------------------------------------------------------
 
-ScEditViewHint::ScEditViewHint() :
-    pEditEngine( NULL ),
-    aCursorPos( 0,0,0 )
-{
-}
-
 ScEditViewHint::ScEditViewHint( ScEditEngineDefaulter* pEngine, const ScAddress& rCurPos ) :
     pEditEngine( pEngine ),
     aCursorPos( rCurPos )
Index: sc/source/ui/cctrl/editfield.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/cctrl/editfield.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/source/ui/cctrl/editfield.cxx	10 Apr 2008 21:51:54 -0000	1.6
+++ sc/source/ui/cctrl/editfield.cxx	9 May 2008 16:11:49 -0000	1.6.32.1
@@ -57,11 +57,6 @@
 
 // ============================================================================
 
-ScDoubleField::ScDoubleField( Window* pParent, WinBits nStyle ) :
-    Edit( pParent, nStyle )
-{
-}
-
 ScDoubleField::ScDoubleField( Window* pParent, const ResId& rResId ) :
     Edit( pParent, rResId )
 {
Index: sc/source/ui/dbgui/dapitype.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/dapitype.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/ui/dbgui/dapitype.cxx	10 Apr 2008 21:56:59 -0000	1.7
+++ sc/source/ui/dbgui/dapitype.cxx	9 May 2008 16:11:50 -0000	1.7.32.1
@@ -69,11 +69,6 @@
 {
 }
 
-BOOL ScDataPilotSourceTypeDlg::IsSelection() const
-{
-	return aBtnSelection.IsChecked();
-}
-
 BOOL ScDataPilotSourceTypeDlg::IsDatabase() const
 {
 	return aBtnDatabase.IsChecked();
Index: sc/source/ui/dbgui/dbnamdlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/dbnamdlg.cxx,v
retrieving revision 1.9
retrieving revision 1.9.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.30.1
--- sc/source/ui/dbgui/dbnamdlg.cxx	10 Apr 2008 21:57:44 -0000	1.9
+++ sc/source/ui/dbgui/dbnamdlg.cxx	9 May 2008 04:45:59 -0000	1.9.30.1
@@ -81,7 +81,6 @@
           rBtnHeader(rHdr), rBtnSize(rSize), rBtnFormat(rFmt), rBtnStrip(rStrip),
           rCurArea(rArea),
           bHeader(FALSE), bSize(FALSE), bFormat(FALSE), bDirty(FALSE) {}
-	void Clear();
 	void Save();
 	void Restore();
 
@@ -105,16 +104,6 @@
 
 //----------------------------------------------------------------------------
 
-void DBSaveData::Clear()
-{
-	aStr.Erase();
-	aArea = ScRange();
-	bHeader = bSize = bFormat = bStrip = bDirty = FALSE;
-}
-
-
-//----------------------------------------------------------------------------
-
 void DBSaveData::Save()
 {
 	aArea   = rCurArea;
Index: sc/source/ui/dbgui/expftext.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/expftext.cxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/dbgui/expftext.cxx	10 Apr 2008 21:58:46 -0000	1.4
+++ sc/source/ui/dbgui/expftext.cxx	9 May 2008 16:11:50 -0000	1.4.32.1
@@ -40,28 +40,6 @@
 #*	Member:		ScExpandedFixedText							Datum:18.09.97
 #*------------------------------------------------------------------------
 #*
-#*  Klasse:		ScExpandedFixedText
-#*
-#*  Funktion:	Konstruktor der Klasse ScExpandedFixedText
-#*
-#*  Input:		Parent- Window, Fenster-Attribute
-#*
-#*	Output:		---
-#*
-#************************************************************************/
-
-ScExpandedFixedText::ScExpandedFixedText( Window* pParent,
-										 WinBits nWinStyle) :
-
-	FixedText( pParent, nWinStyle )
-{
-
-}
-
-/*************************************************************************
-#*	Member:		ScExpandedFixedText							Datum:18.09.97
-#*------------------------------------------------------------------------
-#*
 #*  Klasse:		MD_Test
 #*
 #*  Funktion:	Konstruktor der Klasse SvxCtrDial
Index: sc/source/ui/dbgui/pvfundlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/pvfundlg.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.1
--- sc/source/ui/dbgui/pvfundlg.cxx	10 Apr 2008 22:04:41 -0000	1.12
+++ sc/source/ui/dbgui/pvfundlg.cxx	9 May 2008 16:11:50 -0000	1.12.32.1
@@ -162,12 +162,6 @@
     FillFunctionNames();
 }
 
-ScDPFunctionListBox::ScDPFunctionListBox( Window* pParent, WinBits nStyle ) :
-    MultiListBox( pParent, nStyle )
-{
-    FillFunctionNames();
-}
-
 void ScDPFunctionListBox::SetSelection( USHORT nFuncMask )
 {
     if( (nFuncMask == PIVOT_FUNC_NONE) || (nFuncMask == PIVOT_FUNC_AUTO) )
Index: sc/source/ui/docshell/docfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docfunc.cxx,v
retrieving revision 1.69
retrieving revision 1.69.28.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.69 -r1.69.28.1
--- sc/source/ui/docshell/docfunc.cxx	10 Apr 2008 22:11:00 -0000	1.69
+++ sc/source/ui/docshell/docfunc.cxx	9 May 2008 16:11:50 -0000	1.69.28.1
@@ -2222,43 +2222,6 @@
 	return TRUE;
 }
 
-BOOL ScDocFunc::SetAddressConvention( ScAddress::Convention eConv )
-{
-	ScDocument* pDoc = rDocShell.GetDocument();
-
-	if ( pDoc->GetAddressConvention() == eConv )
-		return TRUE;
-
-	BOOL bUndo(pDoc->IsUndoEnabled());
-	ScDocShellModificator aModificator( rDocShell );
-
-	pDoc->SetAddressConvention( eConv );
-
-	if (bUndo)
-	{
-		rDocShell.GetUndoManager()->AddUndoAction( new ScUndoSetAddressConvention( &rDocShell, eConv ) );
-	}
-
-	rDocShell.PostPaint( 0,0,0,MAXCOL,MAXROW,MAXTAB, PAINT_ALL );
-
-	ScTabViewShell* pViewSh = ScTabViewShell::GetActiveViewShell();
-	if (NULL != pViewSh)
-	{
-	    pViewSh->UpdateInputHandler( FALSE, FALSE );
-	}
-
-	aModificator.SetDocumentModified();
-
-	SfxBindings* pBindings = rDocShell.GetViewBindings();
-	if (pBindings)
-	{
-        // erAck: 2006-09-07T22:19+0200  commented out in CWS scr1c1
-		//pBindings->Invalidate( FID_TAB_USE_R1C1 );
-	}
-
-	return TRUE;
-}
-
 BOOL ScDocFunc::RenameTable( SCTAB nTab, const String& rName, BOOL bRecord, BOOL bApi )
 {
 	ScDocument* pDoc = rDocShell.GetDocument();
Index: sc/source/ui/docshell/docsh.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh.cxx,v
retrieving revision 1.100
retrieving revision 1.100.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.100 -r1.100.30.1
--- sc/source/ui/docshell/docsh.cxx	15 Apr 2008 14:12:23 -0000	1.100
+++ sc/source/ui/docshell/docsh.cxx	8 May 2008 21:46:16 -0000	1.100.30.1
@@ -240,242 +240,6 @@
 	return nTab;
 }
 
-//------------------------------------------------------------------
-/*
-BOOL ScDocShell::LoadCalc( SotStorage* pStor )		// StarCalc 3, 4 or 5 file
-{
-	//	MacroCallMode is no longer needed, state is kept in SfxObjectShell now
-
-	BOOL bRet = TRUE;
-
-	SotStorageStreamRef aPoolStm = pStor->OpenStream( String::CreateFromAscii(pStyleName), STREAM_STD_READ );
-	SotStorageStreamRef aDocStm  = pStor->OpenStream( String::CreateFromAscii(pStarCalcDoc), STREAM_STD_READ );
-	ULONG nPoolErr = aPoolStm->GetError();
-	ULONG nDocErr  = aDocStm->GetError();
-
-	ScProgress* pProgress = NULL;
-	SfxObjectCreateMode eShellMode = GetCreateMode();
-	if ( eShellMode == SFX_CREATE_MODE_STANDARD && !nDocErr )
-	{
-		ULONG nCurPos = aDocStm->Tell();
-		ULONG nEndPos = aDocStm->Seek( STREAM_SEEK_TO_END );
-		aDocStm->Seek( nCurPos );
-		ULONG nRange = nEndPos - nCurPos;
-		pProgress = new ScProgress( this, ScGlobal::GetRscString(STR_LOAD_DOC), nRange );
-	}
-
-	if ( nPoolErr == ERRCODE_IO_NOTEXISTS && nDocErr == ERRCODE_IO_NOTEXISTS )
-	{
-		//	leerer Storage = leeres Dokument -> wie InitNew
-
-		aDocument.MakeTable(0);
-		Size aSize( (long) ( STD_COL_WIDTH			 * HMM_PER_TWIPS * OLE_STD_CELLS_X ),
-					(long) ( ScGlobal::nStdRowHeight * HMM_PER_TWIPS * OLE_STD_CELLS_Y ) );
-		// hier muss auch der Start angepasst werden
-		SetVisAreaOrSize( Rectangle( Point(), aSize ), TRUE );
-		aDocument.GetStyleSheetPool()->CreateStandardStyles();
-		aDocument.UpdStlShtPtrsFrmNms();
-	}
-	else if ( !nPoolErr && !nDocErr )
-	{
-		aPoolStm->SetVersion(pStor->GetVersion());
-		aDocStm->SetVersion(pStor->GetVersion());
-
-		aDocument.Clear();			// keine Referenzen auf Pool behalten!
-
-		RemoveItem( SID_ATTR_CHAR_FONTLIST );
-		RemoveItem( ITEMID_COLOR_TABLE );
-		RemoveItem( ITEMID_GRADIENT_LIST );
-		RemoveItem( ITEMID_HATCH_LIST );
-		RemoveItem( ITEMID_BITMAP_LIST );
-		RemoveItem( ITEMID_DASH_LIST );
-		RemoveItem( ITEMID_LINEEND_LIST );
-
-		aDocument.LoadPool( *aPoolStm, FALSE );		// FALSE: RefCounts nicht laden
-		bRet = (aPoolStm->GetError() == 0);
-
-		if ( !bRet )
-		{
-			pStor->SetError( aPoolStm->GetError() );
-			DBG_ERROR( "Fehler im Pool-Stream" );
-		}
-		else if (eShellMode != SFX_CREATE_MODE_ORGANIZER)
-		{
-			//	ViewOptions are not completely stored (to avoid warnings),
-			//	so must be initialized from global settings.
-			//!	This can be removed if a new file format loads all ViewOptions !!!
-
-			aDocument.SetViewOptions( SC_MOD()->GetViewOptions() );
-
-			ULONG nErrCode = aPoolStm->GetErrorCode();
-			const ByteString aStrKey = pStor->GetKey();
-			const BOOL	 bKeySet = (aStrKey.Len() > 0);
-
-			if ( bKeySet )
-				aDocStm->SetKey( aStrKey );			// Passwort setzen
-
-			bRet = aDocument.Load( *aDocStm, pProgress );
-
-			if ( !bRet && bKeySet ) // Passwort falsch
-			{
-				SetError( ERRCODE_SFX_WRONGPASSWORD );
-				pStor->SetError( ERRCODE_SFX_WRONGPASSWORD );
-			}
-
-			if ( aDocStm->GetError() )
-			{
-				//	Zeile-8192-Meldung braucht nur zu kommen, wenn die Zeilen
-				//	beschraenkt sind, sonst ist "falsches Format" besser
-#ifdef SC_LIMIT_ROWS
-				if ( aDocument.HasLostData() )					// zuviele Zeilen?
-					pStor->SetError( SCERR_IMPORT_8K_LIMIT );
-				else
-#endif
-					pStor->SetError( aDocStm->GetError() );
-				bRet = FALSE;
-				DBG_ERROR( "Fehler im Document-Stream" );
-			}
-			else
-			{
-				if ( !(nErrCode & ERRCODE_WARNING_MASK) )
-					nErrCode = aDocStm->GetErrorCode();
-				if ( nErrCode & ERRCODE_WARNING_MASK )
-					SetError( nErrCode );
-			}
-
-			if (bRet)
-			{
-				aDocument.UpdateFontCharSet();
-
-				UpdateLinks();				// verknuepfte Tabellen in Link-Manager
-				RemoveUnknownObjects();		// unbekannte Ole-Objekte loeschen
-			}
-		}
-		else			// SFX_CREATE_MODE_ORGANIZER
-		{
-			//	UpdateStdNames is called from ScDocument::Load, but is also needed
-			//	if only the styles are loaded!
-			ScStyleSheetPool* pStylePool = aDocument.GetStyleSheetPool();
-			if (pStylePool)
-				pStylePool->UpdateStdNames();	// correct style names for different languages
-		}
-
-		if (bRet)
-			aDocument.GetPool()->MyLoadCompleted();
-	}
-	else
-	{
-		DBG_ERROR( "Stream-Fehler");
-		bRet = FALSE;
-	}
-
-	if (!aDocument.HasTable(0))
-		aDocument.MakeTable(0);
-
-	if (eShellMode == SFX_CREATE_MODE_EMBEDDED)
-	{
-		SCTAB nVisTab = aDocument.GetVisibleTab();
-		BOOL bHasVis = aDocument.HasTable(nVisTab);
-		if ( SfxInPlaceObject::GetVisArea().IsEmpty() || !bHasVis )
-		{
-			if (!bHasVis)
-			{
-				nVisTab = 0;
-				aDocument.SetVisibleTab(nVisTab);
-			}
-			SCCOL nStartCol;
-            SCROW nStartRow;
-			aDocument.GetDataStart( nVisTab, nStartCol, nStartRow );
-			SCCOL nEndCol;
-            SCROW nEndRow;
-			aDocument.GetPrintArea( nVisTab, nEndCol, nEndRow );
-			if (nStartCol>nEndCol)
-				nStartCol = nEndCol;
-			if (nStartRow>nEndRow)
-				nStartRow = nEndRow;
-			// hier muss auch der Start angepasst werden
-			SetVisAreaOrSize( aDocument.GetMMRect( nStartCol,nStartRow, nEndCol,nEndRow, nVisTab ),
-								TRUE );
-		}
-	}
-
-	delete pProgress;
-
-	return bRet;
-}
-
-
-BOOL ScDocShell::SaveCalc( SotStorage* pStor )			// Calc 3, 4 or 5 file
-{
-	BOOL bRet = TRUE;
-
-	ScProgress* pProgress = NULL;
-	SfxObjectCreateMode eShellMode = GetCreateMode();
-	if ( eShellMode == SFX_CREATE_MODE_STANDARD )
-	{
-		ULONG nRange = aDocument.GetWeightedCount() + 1;
-		pProgress = new ScProgress( this, ScGlobal::GetRscString(STR_SAVE_DOC), nRange );
-	}
-
-	SotStorageStreamRef aPoolStm = pStor->OpenStream( String::CreateFromAscii(pStyleName) );
-	if( !aPoolStm->GetError() )
-	{
-		aPoolStm->SetVersion(pStor->GetVersion());
-		aPoolStm->SetSize(0);
-		bRet = aDocument.SavePool( *aPoolStm );
-		if ( aPoolStm->GetErrorCode() && !pStor->GetErrorCode() )
-			pStor->SetError(aPoolStm->GetErrorCode());
-	}
-	else
-	{
-		DBG_ERROR( "Stream Error" );
-		bRet = FALSE;
-	}
-
-	if ( bRet && eShellMode != SFX_CREATE_MODE_ORGANIZER )
-	{
-		SotStorageStreamRef aDocStm  = pStor->OpenStream( String::CreateFromAscii(pStarCalcDoc) );
-		if( !aDocStm->GetError() )
-		{
-			aDocStm->SetVersion(pStor->GetVersion());
-			aDocStm->SetKey(pStor->GetKey());				// Passwort setzen
-			aDocStm->SetSize(0);
-			bRet = aDocument.Save( *aDocStm, pProgress );
-			DBG_ASSERT( bRet, "Error while saving" );
-
-			if ( aDocument.HasLostData() )
-			{
-				//	Warnung, dass nicht alles gespeichert wurde
-
-				if (!pStor->GetError())
-					pStor->SetError(SCWARN_EXPORT_MAXROW);
-			}
-			else if ( aDocStm->GetErrorCode() && !pStor->GetErrorCode() )
-				pStor->SetError(aDocStm->GetErrorCode());
-			else if ( SvtFilterOptions::Get()->IsLoadExcelBasicStorage() )
-			{
-				//	#75497# warning if MS VBA macros are lost
-				//	GetSaveWarningOfMSVBAStorage checks if sub-storage with VBA macros is present
-				//	(only possible when editing Excel documents -- storage is not copied to
-				//	StarCalc files)
-				ULONG nVBAWarn = SvxImportMSVBasic::GetSaveWarningOfMSVBAStorage( *this );
-				if ( nVBAWarn && !pStor->GetErrorCode() )
-					pStor->SetError( nVBAWarn );
-			}
-		}
-		else
-		{
-			DBG_ERROR( "Stream Error" );
-			bRet = FALSE;
-		}
-	}
-
-	delete pProgress;
-
-	return bRet;
-}
-*/
-
 sal_uInt16 ScDocShell::GetHiddenInformationState( sal_uInt16 nStates )
 {
 	// get global state like HIDDENINFORMATION_DOCUMENTVERSIONS
Index: sc/source/ui/docshell/docsh2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh2.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.1
--- sc/source/ui/docshell/docsh2.cxx	10 Apr 2008 22:11:39 -0000	1.25
+++ sc/source/ui/docshell/docsh2.cxx	8 May 2008 21:46:16 -0000	1.25.32.1
@@ -240,54 +240,3 @@
 	}
 	return pDrawLayer;
 }
-
-//------------------------------------------------------------------
-
-
-void ScDocShell::RemoveUnknownObjects()
-{
-	//	OLE-Objekte loeschen, wenn kein Drawing-Objekt dazu existiert
-	//	Loeschen wie in SvPersist::CleanUp
-
-	ScDrawLayer* pDrawLayer = aDocument.GetDrawLayer();
-    uno::Sequence < rtl::OUString > aNames = GetEmbeddedObjectContainer().GetObjectNames();
-
-        for( sal_Int32 i=0; i<aNames.getLength(); i++ )
-		{
-            String aObjName = aNames[i];
-			BOOL bFound = FALSE;
-			if ( pDrawLayer )
-			{
-				SCTAB nTabCount = static_cast<sal_Int16>(pDrawLayer->GetPageCount());
-				for (SCTAB nTab=0; nTab<nTabCount && !bFound; nTab++)
-				{
-					SdrPage* pPage = pDrawLayer->GetPage(static_cast<sal_uInt16>(nTab));
-					DBG_ASSERT(pPage,"Page ?");
-					if (pPage)
-					{
-						SdrObjListIter aIter( *pPage, IM_DEEPNOGROUPS );
-						SdrObject* pObject = aIter.Next();
-						while (pObject && !bFound)
-						{
-							// name from InfoObject is PersistName
-							if ( pObject->ISA(SdrOle2Obj) &&
-									static_cast<SdrOle2Obj*>(pObject)->GetPersistName() == aObjName )
-								bFound = TRUE;
-							pObject = aIter.Next();
-						}
-					}
-				}
-			}
-
-			if (!bFound)
-			{
-                //TODO/LATER: hacks not supported anymore
-                //DBG_ASSERT(pEle->GetRefCount()==2, "Loeschen von referenziertem Storage");
-                GetEmbeddedObjectContainer().RemoveEmbeddedObject( aObjName );
-			}
-			else
-				i++;
-		}
-}
-
-
Index: sc/source/ui/docshell/docsh3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh3.cxx,v
retrieving revision 1.37
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.37 docsh3.cxx
--- sc/source/ui/docshell/docsh3.cxx	15 Apr 2008 14:12:39 -0000	1.37
+++ sc/source/ui/docshell/docsh3.cxx	14 Jul 2008 16:27:44 -0000
@@ -31,7 +31,7 @@
 // MARKER(update_precomp.py): autogen include statement, do not remove
 #include "precompiled_sc.hxx"
 
-
+#include <stdio.h>
 
 // INCLUDE ---------------------------------------------------------------
 
@@ -475,6 +475,7 @@
 
 USHORT ScDocShell::SetPrinter( SfxPrinter* pNewPrinter, USHORT nDiffFlags )
 {
+    { char tmp[256]; sprintf(tmp, "ScDocShell::SetPrinter: --begin\n"); OutputDebugStringA(tmp); }
 	if (nDiffFlags & SFX_PRINTER_PRINTER)
 	{
 		if ( aDocument.GetPrinter() != pNewPrinter )
@@ -541,6 +542,7 @@
 
 			if (nDiffFlags & SFX_PRINTER_CHG_ORIENTATION)
 			{
+                { char tmp[256]; sprintf(tmp, "ScDocShell::SetPrinter:   change orientation\n"); OutputDebugStringA(tmp); }
 				const SvxPageItem& rOldItem = (const SvxPageItem&)rSet.Get(ATTR_PAGE);
 				BOOL bWasLand = rOldItem.IsLandscape();
 				BOOL bNewLand = ( pNewPrinter->GetOrientation() == ORIENTATION_LANDSCAPE );
@@ -567,6 +569,7 @@
 
 	PostPaint(0,0,0,MAXCOL,MAXROW,MAXTAB,PAINT_ALL);
 
+    { char tmp[256]; sprintf(tmp, "ScDocShell::SetPrinter: --end\n"); OutputDebugStringA(tmp); }
 	return 0;
 }
 
@@ -1161,19 +1164,6 @@
     UnlockPaint();
 }
 
-void lcl_MergeActionStates( ScChangeTrack* pOwnTrack, ScChangeTrack* pSharedTrack )
-{
-    BOOL bIgnore100Sec = !pOwnTrack->IsTime100thSeconds() || !pSharedTrack->IsTime100thSeconds();
-    ScChangeAction* pOwnAction = pOwnTrack->GetFirst();
-    ScChangeAction* pSharedAction = pSharedTrack->GetFirst();
-    while ( lcl_Equal( pOwnAction, pSharedAction, bIgnore100Sec ) )
-    {
-        pOwnTrack->MergeActionState( pOwnAction, pSharedAction );
-        pOwnAction = pOwnAction->GetNext();
-        pSharedAction = pSharedAction->GetNext();
-    }
-}
-
 bool ScDocShell::MergeSharedDocument( ScDocShell* pSharedDocShell )
 {
     if ( !pSharedDocShell )
Index: sc/source/ui/docshell/docsh4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh4.cxx,v
retrieving revision 1.61
retrieving revision 1.61.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.61 -r1.61.30.1
--- sc/source/ui/docshell/docsh4.cxx	15 Apr 2008 14:33:07 -0000	1.61
+++ sc/source/ui/docshell/docsh4.cxx	8 May 2008 21:46:16 -0000	1.61.30.1
@@ -146,36 +146,6 @@
 
 //------------------------------------------------------------------
 
-BOOL ScDocShell::GetTabParam( const SfxItemSet* pArgs, USHORT nId, SCTAB& rTab )
-{
-	BOOL bOk = TRUE;
-	rTab = 0;					// zur Sicherheit...
-
-	const SfxPoolItem* pTabItem;
-	if ( pArgs && pArgs->GetItemState( nId, TRUE, &pTabItem ) == SFX_ITEM_SET )
-	{
-		//	Parameter sind 1-based !!!
-		SCTAB nItemTab = ((const SfxUInt16Item*)pTabItem)->GetValue();
-		SCTAB nTabCount = aDocument.GetTableCount();
-		if (nItemTab>0 && nItemTab<=nTabCount)
-			rTab = nItemTab-1;
-		else
-			bOk = FALSE;
-	}
-	else						// nichts angegeben -> sichtbare
-	{
-		ScTabViewShell* pVisibleSh = GetBestViewShell();
-		if ( pVisibleSh )
-			rTab = pVisibleSh->GetViewData()->GetTabNo();
-		else
-			bOk = FALSE;
-	}
-
-	return bOk;
-}
-
-//------------------------------------------------------------------
-
 void ScDocShell::Execute( SfxRequest& rReq )
 {
 	//	SID_SC_RANGE (Range),
Index: sc/source/ui/docshell/docsh5.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh5.cxx,v
retrieving revision 1.20
retrieving revision 1.20.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.20 -r1.20.30.1
--- sc/source/ui/docshell/docsh5.cxx	10 Apr 2008 22:12:43 -0000	1.20
+++ sc/source/ui/docshell/docsh5.cxx	13 May 2008 00:33:45 -0000	1.20.30.1
@@ -402,10 +402,12 @@
     aDocument.UpdateAllRowHeights( aProv.GetDevice(), aProv.GetPPTX(), aProv.GetPPTY(), aZoom, aZoom );
 }
 
+#if OLD_PIVOT_IMPLEMENTATION
 void ScDocShell::PivotUpdate( ScPivot*, ScPivot*, BOOL, BOOL )
 {
 	DBG_ERRORFILE("PivotUpdate is obsolete!");
 }
+#endif
 
 void ScDocShell::RefreshPivotTables( const ScRange& rSource )
 {
Index: sc/source/ui/docshell/docsh8.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh8.cxx,v
retrieving revision 1.27
retrieving revision 1.27.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.27 -r1.27.32.1
--- sc/source/ui/docshell/docsh8.cxx	10 Apr 2008 22:13:37 -0000	1.27
+++ sc/source/ui/docshell/docsh8.cxx	8 May 2008 21:46:16 -0000	1.27.32.1
@@ -192,44 +192,6 @@
 
 // -----------------------------------------------------------------------
 
-long lcl_GetRowCount( const uno::Reference<sdbc::XConnection>& xConnection,
-						const String& rTabName )
-{
-	try
-	{
-		uno::Reference<sdbc::XStatement> xStatement = xConnection->createStatement();
-		DBG_ASSERT( xStatement.is(), "can't get Statement" );
-		if (!xStatement.is()) return SC_ROWCOUNT_ERROR;
-
-		String aQuoteStr;
-		uno::Reference<sdbc::XDatabaseMetaData> xDBMeta = xConnection->getMetaData();
-		if (xDBMeta.is())
-			aQuoteStr = xDBMeta->getIdentifierQuoteString();
-
-		String aSql = String::CreateFromAscii("SELECT COUNT ( * ) FROM ");
-		aSql += aQuoteStr;
-		aSql += rTabName;
-		aSql += aQuoteStr;
-
-		uno::Reference<sdbc::XResultSet> xResSet = xStatement->executeQuery( aSql );
-		uno::Reference<sdbc::XRow> xRow( xResSet, uno::UNO_QUERY );
-		DBG_ASSERT( xRow.is(), "can't get Row" );
-		if (!xRow.is()) return SC_ROWCOUNT_ERROR;
-
-		if ( xResSet->next() )
-			return xRow->getInt( 1 );
-	}
-	catch ( sdbc::SQLException& )
-	{
-	}
-	catch ( uno::Exception& )
-	{
-		DBG_ERROR("Unexpected exception in database");
-	}
-
-	return SC_ROWCOUNT_ERROR;
-}
-
 ULONG ScDocShell::DBaseImport( const String& rFullFileName, CharSet eCharSet,
 								BOOL bSimpleColWidth[MAXCOLCOUNT] )
 {
@@ -281,7 +243,6 @@
 		DBG_ASSERT( xConnection.is(), "can't get Connection" );
 		if (!xConnection.is()) return SCERR_IMPORT_CONNECT;
 
-//!		long nRowCount = lcl_GetRowCount( xConnection, aTabName );
 		long nRowCount = 0;
 		if ( nRowCount < 0 )
 		{
Index: sc/source/ui/docshell/editable.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/editable.cxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/ui/docshell/editable.cxx	10 Apr 2008 22:14:10 -0000	1.5
+++ sc/source/ui/docshell/editable.cxx	9 May 2008 16:11:50 -0000	1.5.32.1
@@ -46,11 +46,6 @@
 {
 }
 
-void ScEditableTester::Reset()
-{
-	bIsEditable = bOnlyMatrix = TRUE;
-}
-
 ScEditableTester::ScEditableTester( ScDocument* pDoc, SCTAB nTab,
 						SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow ) :
 	bIsEditable( TRUE ),
Index: sc/source/ui/docshell/tablink.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/tablink.cxx,v
retrieving revision 1.31
retrieving revision 1.31.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.31 -r1.31.32.1
--- sc/source/ui/docshell/tablink.cxx	10 Apr 2008 22:17:08 -0000	1.31
+++ sc/source/ui/docshell/tablink.cxx	8 May 2008 21:46:16 -0000	1.31.32.1
@@ -311,7 +311,6 @@
 			else
 			{
 				pDoc->DeleteAreaTab( 0,0,MAXCOL,MAXROW, nTab, IDF_ALL );
-//				pDoc->ClearDrawPage(nTab);
 
                 bool bShowError = true;
                 if ( nMode == SC_LINK_VALUE )
Index: sc/source/ui/formdlg/formdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/formdlg/formdata.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/source/ui/formdlg/formdata.cxx	10 Apr 2008 22:29:05 -0000	1.6
+++ sc/source/ui/formdlg/formdata.cxx	9 May 2008 16:11:50 -0000	1.6.32.1
@@ -93,17 +93,5 @@
 	pParent = pTemp;
 }
 
-void ScFormEditData::RestoreValues()
-{
-	ScFormEditData* pTemp = pParent;
-	DBG_ASSERT(pTemp,"RestoreValues ohne Parent");
-	if (pTemp)
-	{
-		*this = *pTemp;
-		pTemp->pParent = NULL;		// sonst wird der auch geloescht!
-		delete pTemp;
-	}
-}
-
 
 
Index: sc/source/ui/formdlg/formula.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/formdlg/formula.cxx,v
retrieving revision 1.18
retrieving revision 1.18.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.30.2
--- sc/source/ui/formdlg/formula.cxx	10 Apr 2008 22:29:56 -0000	1.18
+++ sc/source/ui/formdlg/formula.cxx	13 May 2008 14:34:12 -0000	1.18.30.2
@@ -763,72 +763,26 @@
 //							Funktionen fuer 1. Seite
 //	--------------------------------------------------------------------------
 
-void ScFormulaDlg::ResizeArgArr( const ScFuncDesc* pNewFunc )
-{
-	if ( pFuncDesc != pNewFunc )
-	{
-		DeleteArgs();
-
-		if ( pNewFunc )
-		{
-			nArgs = pNewFunc->GetSuppressedArgCount();
-			if ( nArgs > 0 )
-			{
-				pArgArr = new String*[nArgs];
-				for ( USHORT i=0; i<nArgs; i++ )
-					pArgArr[i] = new String;
-			}
-		}
-
-		pFuncDesc = pNewFunc;
-	}
-}
-
-void ScFormulaDlg::UpdateFunctionDesc()
-{
-	ScModule* pScMod = SC_MOD();
-
-	ScFormEditData* pData = pScMod->GetFormEditData();
-	if (!pData) return;
-	USHORT nCat = pScFuncPage->GetCategory();
-	if ( nCat == LISTBOX_ENTRY_NOTFOUND ) nCat = 0;
-	pData->SetCatSel( nCat );
-	USHORT nFunc = pScFuncPage->GetFunction();
-	if ( nFunc == LISTBOX_ENTRY_NOTFOUND ) nFunc = 0;
-	pData->SetFuncSel( nFunc );
-
-	if (   (pScFuncPage->GetFunctionEntryCount() > 0)
-		&& (pScFuncPage->GetFunction() != LISTBOX_ENTRY_NOTFOUND) )
-	{
-		const ScFuncDesc* pDesc =pScFuncPage->GetFuncDesc(
-								pScFuncPage->GetFunction() );
-		if (pDesc)
-		{
-            pDesc->InitArgumentInfo();      // full argument info is needed
-
-			String aSig = pDesc->GetSignature();
-
-			aFtFuncName.SetText( aSig );
-			if(pDesc->pFuncDesc)
-				aFtFuncDesc.SetText( *(pDesc->pFuncDesc) );
-			else
-				aFtFuncDesc.SetText(EMPTY_STRING );
-			ResizeArgArr( pDesc );
-
-			if ( pArgArr && pArgArr[0] && pArgArr[0]->Len() )		// noch Argumente da?
-				aSig = pDesc->GetFormulaString( pArgArr );			// fuer Eingabezeile
-			//@ pScMod->InputReplaceSelection( aSig );
-		}
-	}
-	else
-	{
-		aFtFuncName.SetText( EMPTY_STRING );
-		aFtFuncDesc.SetText( EMPTY_STRING );
-
-		//ResizeArgArr( NULL );
-		pScMod->InputReplaceSelection( EMPTY_STRING );
-	}
-}
+//UNUSED2008-05  void ScFormulaDlg::ResizeArgArr( const ScFuncDesc* pNewFunc )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( pFuncDesc != pNewFunc )
+//UNUSED2008-05      {
+//UNUSED2008-05          DeleteArgs();
+//UNUSED2008-05  
+//UNUSED2008-05          if ( pNewFunc )
+//UNUSED2008-05          {
+//UNUSED2008-05              nArgs = pNewFunc->GetSuppressedArgCount();
+//UNUSED2008-05              if ( nArgs > 0 )
+//UNUSED2008-05              {
+//UNUSED2008-05                  pArgArr = new String*[nArgs];
+//UNUSED2008-05                  for ( USHORT i=0; i<nArgs; i++ )
+//UNUSED2008-05                      pArgArr[i] = new String;
+//UNUSED2008-05              }
+//UNUSED2008-05          }
+//UNUSED2008-05  
+//UNUSED2008-05          pFuncDesc = pNewFunc;
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 // Handler fuer Listboxen
 
@@ -993,65 +947,20 @@
 	}
 }
 
-void ScFormulaDlg::EditFuncParas(xub_StrLen nEditPos)
-{
-	if(pFuncDesc!=NULL)
-	{
-		ScModule* pScMod = SC_MOD();
-		ScFormEditData* pData = pScMod->GetFormEditData();
-		if (!pData) return;
-
-		String aFormula = pScMod->InputGetFormulaStr();
-		aFormula +=')';
-		xub_StrLen nFStart = pData->GetFStart();
-
-		DeleteArgs();
-
-		nArgs = pFuncDesc->GetSuppressedArgCount();
-
-		xub_StrLen nArgPos=ScFormulaUtil::GetArgStart( aFormula, nFStart, 0 );
-		pArgArr = ScFormulaUtil::GetArgStrings( aFormula, nFStart, nArgs );
-
-		USHORT nActiv=aScParaWin.GetSliderPos();
-		BOOL	bFlag=FALSE;
-		for(USHORT i=0;i<nArgs;i++)
-		{
-			xub_StrLen nLength=(pArgArr[i])->Len();
-			aScParaWin.SetArgument(i,*(pArgArr[i]));
-			if(nArgPos<=nEditPos && nEditPos<nArgPos+nLength)
-			{
-				nActiv=i;
-				bFlag=TRUE;
-			}
-			nArgPos+=nLength+1;
-		}
-
-		if(bFlag)
-		{
-			aScParaWin.SetSliderPos(nActiv);
-		}
-
-		aScParaWin.UpdateParas();
-		UpdateValues();
-	}
-
-}
-
-
-IMPL_LINK( ScFormulaDlg, ScrollHdl, ScParaWin*, EMPTYARG )
-{
-	ScModule* pScMod = SC_MOD();
-	ScFormEditData* pData = pScMod->GetFormEditData();
-	if (!pData) return 0;
-	USHORT nOffset = aScParaWin.GetSliderPos();
-	pData->SetOffset( nOffset );
-
-	aScParaWin.UpdateParas();
-
-	UpdateValues();
-
-	return 0;
-}
+//UNUSED2008-05  IMPL_LINK( ScFormulaDlg, ScrollHdl, ScParaWin*, EMPTYARG )
+//UNUSED2008-05  {
+//UNUSED2008-05      ScModule* pScMod = SC_MOD();
+//UNUSED2008-05      ScFormEditData* pData = pScMod->GetFormEditData();
+//UNUSED2008-05      if (!pData) return 0;
+//UNUSED2008-05      USHORT nOffset = aScParaWin.GetSliderPos();
+//UNUSED2008-05      pData->SetOffset( nOffset );
+//UNUSED2008-05  
+//UNUSED2008-05      aScParaWin.UpdateParas();
+//UNUSED2008-05  
+//UNUSED2008-05      UpdateValues();
+//UNUSED2008-05  
+//UNUSED2008-05      return 0;
+//UNUSED2008-05  }
 
 BOOL ScFormulaDlg::CalcValue( const String& rStrExp, String& rStrResult )
 {
Index: sc/source/ui/formdlg/funcpage.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/formdlg/funcpage.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/ui/formdlg/funcpage.cxx	10 Apr 2008 22:30:12 -0000	1.7
+++ sc/source/ui/formdlg/funcpage.cxx	9 May 2008 21:22:43 -0000	1.7.32.1
@@ -58,10 +58,6 @@
 
 //============================================================================
 
-ScListBox::ScListBox( Window* pParent, WinBits nWinStyle):
-	ListBox(pParent,nWinStyle)
-{}
-
 ScListBox::ScListBox( Window* pParent, const ResId& rResId ):
 	ListBox(pParent,rResId)
 {}
Index: sc/source/ui/formdlg/funcutl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/formdlg/funcutl.cxx,v
retrieving revision 1.9
retrieving revision 1.9.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.32.2
--- sc/source/ui/formdlg/funcutl.cxx	10 Apr 2008 22:30:31 -0000	1.9
+++ sc/source/ui/formdlg/funcutl.cxx	9 May 2008 16:11:50 -0000	1.9.32.2
@@ -345,46 +345,6 @@
 }
 
 /*************************************************************************
-#*	Member:		SetArgSelection								Datum:13.01.97
-#*------------------------------------------------------------------------
-#*
-#*  Klasse:		ArgInput
-#*
-#*  Funktion:	Liefert die Selection fuer die EditBox zurueck.
-#*
-#*  Input:		String
-#*
-#*	Output:		---
-#*
-#************************************************************************/
-Selection ArgInput::GetArgSelection	()
-{
-	Selection	aSel;
-	if(pEdArg !=NULL) aSel=pEdArg ->GetSelection();
-	return aSel;
-}
-
-/*************************************************************************
-#*	Member:		SetArgSelection								Datum:13.01.97
-#*------------------------------------------------------------------------
-#*
-#*  Klasse:		ArgInput
-#*
-#*  Funktion:	Ersetzt die Selection in der EditBox.
-#*
-#*  Input:		String
-#*
-#*	Output:		---
-#*
-#************************************************************************/
-void ArgInput::ReplaceSelOfArg(const String& rStr )
-{
-	if(pEdArg !=NULL) pEdArg ->ReplaceSelected(rStr );
-}
-
-
-
-/*************************************************************************
 #*	Member:		SetArgVal									Datum:13.01.97
 #*------------------------------------------------------------------------
 #*
@@ -712,29 +672,6 @@
 #*
 #*  Funktion:	Konstruktor der Klasse ArgInput
 #*
-#*  Input:		Parent, Window-Style
-#*
-#*	Output:		---
-#*
-#************************************************************************/
-ScEditBox::ScEditBox(	Window* pParent,WinBits nWinStyle)
-		:Control(pParent,nWinStyle|WB_DIALOGCONTROL)
-{
-	pMEdit=new MultiLineEdit(this,WB_LEFT | WB_VSCROLL | nWinStyle & WB_TABSTOP|
-					WB_NOBORDER | WB_NOHIDESELECTION |WB_IGNORETAB);
-
-	pMEdit->Show();
-	aOldSel=pMEdit->GetSelection();
-}
-
-/*************************************************************************
-#*	Member:		ScEditBox									Datum:20.01.97
-#*------------------------------------------------------------------------
-#*
-#*  Klasse:		ScEditBox
-#*
-#*  Funktion:	Konstruktor der Klasse ArgInput
-#*
 #*  Input:		Parent, Resource
 #*
 #*	Output:		---
Index: sc/source/ui/inc/AccessibleContextBase.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleContextBase.hxx,v
retrieving revision 1.23
retrieving revision 1.23.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.23 -r1.23.32.1
--- sc/source/ui/inc/AccessibleContextBase.hxx	10 Apr 2008 22:33:30 -0000	1.23
+++ sc/source/ui/inc/AccessibleContextBase.hxx	9 May 2008 04:45:59 -0000	1.23.32.1
@@ -303,9 +303,6 @@
         ChangeName();
 
 protected:
-	/// Calls all Listener to tell they that the object is now DEFUNC
-	void CommitDefunc() const;
-
 	/// Calls all FocusListener to tell they that the focus is gained.
 	void CommitFocusGained() const;
 
Index: sc/source/ui/inc/AccessibleCsvControl.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleCsvControl.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.1
--- sc/source/ui/inc/AccessibleCsvControl.hxx	10 Apr 2008 22:33:45 -0000	1.15
+++ sc/source/ui/inc/AccessibleCsvControl.hxx	9 May 2008 04:45:59 -0000	1.15.32.1
@@ -135,8 +135,6 @@
     /** Disposes the object. This is a helper called from destructors only. */
     void implDispose();
 
-    /** Converts the screen position rPos to a position relative to this control. */
-    Point implGetRelPos( const Point& rPos ) const;
     /** Converts the control-relative position to an absolute screen position. */
     Point implGetAbsPos( const Point& rPos ) const;
 };
Index: sc/source/ui/inc/AccessiblePreviewCell.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessiblePreviewCell.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.1
--- sc/source/ui/inc/AccessiblePreviewCell.hxx	10 Apr 2008 22:36:27 -0000	1.11
+++ sc/source/ui/inc/AccessiblePreviewCell.hxx	9 May 2008 04:45:59 -0000	1.11.32.1
@@ -115,9 +115,6 @@
 	sal_Bool IsOpaque(
 		const com::sun::star::uno::Reference<
 		::com::sun::star::accessibility::XAccessibleStateSet>& rxParentStates);
-	sal_Bool IsSelected(
-		const com::sun::star::uno::Reference<
-		::com::sun::star::accessibility::XAccessibleStateSet>& rxParentStates);
 
 	void CreateTextHelper();
 
Index: sc/source/ui/inc/AccessibleText.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleText.hxx,v
retrieving revision 1.19
retrieving revision 1.19.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.19 -r1.19.32.1
--- sc/source/ui/inc/AccessibleText.hxx	10 Apr 2008 22:38:40 -0000	1.19
+++ sc/source/ui/inc/AccessibleText.hxx	13 May 2008 14:34:12 -0000	1.19.32.1
@@ -204,7 +204,7 @@
 	virtual SvxViewForwarder* GetViewForwarder();
 	virtual SvxEditViewForwarder* GetEditViewForwarder( sal_Bool /* bCreate */ ) { return NULL; }
 
-	DECL_LINK( NotifyHdl, EENotify* );
+//UNUSED2008-05  DECL_LINK( NotifyHdl, EENotify* );
 private:
 	ScPreviewViewForwarder* mpViewForwarder;
 	ScPreviewShell*	mpViewShell;
@@ -234,7 +234,7 @@
 	virtual SvxViewForwarder* GetViewForwarder();
 	virtual SvxEditViewForwarder* GetEditViewForwarder( sal_Bool /* bCreate */ ) { return NULL; }
 
-	DECL_LINK( NotifyHdl, EENotify* );
+//UNUSED2008-05  DECL_LINK( NotifyHdl, EENotify* );
 private:
 	ScPreviewViewForwarder* mpViewForwarder;
 	ScPreviewShell*	mpViewShell;
Index: sc/source/ui/inc/acredlin.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/acredlin.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.1
--- sc/source/ui/inc/acredlin.hxx	10 Apr 2008 22:40:16 -0000	1.8
+++ sc/source/ui/inc/acredlin.hxx	13 May 2008 14:34:12 -0000	1.8.32.1
@@ -176,7 +176,7 @@
 
 	void			Init();
 	void			InitFilter();
-	void			SetMyStaticData();
+//UNUSED2008-05  void			SetMyStaticData();
 
 	DECL_LINK( FilterHandle, SvxTPFilter* );
 	DECL_LINK( RefHandle, SvxTPFilter* );
Index: sc/source/ui/inc/anyrefdg.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/anyrefdg.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.2
--- sc/source/ui/inc/anyrefdg.hxx	10 Apr 2008 22:40:33 -0000	1.11
+++ sc/source/ui/inc/anyrefdg.hxx	12 May 2008 15:57:00 -0000	1.11.32.2
@@ -81,7 +81,7 @@
 
     void                StartUpdateData();
 
-    void                SilentGrabFocus();  // does not update any references
+//UNUSED2008-05  void                SilentGrabFocus();  // does not update any references
 
     void                SetRefDialog( ScAnyRefDlg* pDlg );
     inline ScAnyRefDlg* GetRefDialog() { return pAnyRefDlg; }
Index: sc/source/ui/inc/conflictsdlg.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/conflictsdlg.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/conflictsdlg.hxx	15 Apr 2008 14:13:06 -0000	1.4
+++ sc/source/ui/inc/conflictsdlg.hxx	13 May 2008 14:34:12 -0000	1.4.32.1
@@ -85,7 +85,7 @@
     static void                     Transform_Impl( ScChangeActionList& rActionList, ScChangeActionMergeMap* pMergeMap );
 
 public:
-    static bool                     HasSharedAction( ScConflictsList& rConflictsList, ULONG nSharedAction );
+//UNUSED2008-05  static bool                     HasSharedAction( ScConflictsList& rConflictsList, ULONG nSharedAction );
     static bool                     HasOwnAction( ScConflictsList& rConflictsList, ULONG nOwnAction );
 
     static ScConflictsListEntry*    GetSharedActionEntry( ScConflictsList& rConflictsList, ULONG nSharedAction );
@@ -151,11 +151,11 @@
 private:
 
 public:
-                        ScConflictsListBox( Window* pParent, WinBits nBits = WB_BORDER );
+//UNUSED2008-05         ScConflictsListBox( Window* pParent, WinBits nBits = WB_BORDER );
                         ScConflictsListBox( Window* pParent, const ResId& rResId );
                         ~ScConflictsListBox();
 
-    ULONG               GetRootEntryPos( const SvLBoxEntry* pRootEntry ) const;
+//UNUSED2008-05  ULONG               GetRootEntryPos( const SvLBoxEntry* pRootEntry ) const;
 };
 
 //=============================================================================
Index: sc/source/ui/inc/content.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/content.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.1
--- sc/source/ui/inc/content.hxx	10 Apr 2008 22:45:32 -0000	1.13
+++ sc/source/ui/inc/content.hxx	13 May 2008 14:34:13 -0000	1.13.32.1
@@ -113,7 +113,7 @@
     ULONG   GetChildIndex( SvLBoxEntry* pEntry ) const;
 
 	void	DoDrag();
-	void	AdjustTitle();
+//UNUSED2008-05  void	AdjustTitle();
 
 	ScDocument* GetSourceDocument();
 
Index: sc/source/ui/inc/dapitype.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/dapitype.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/dapitype.hxx	10 Apr 2008 22:48:24 -0000	1.4
+++ sc/source/ui/inc/dapitype.hxx	9 May 2008 16:11:51 -0000	1.4.32.1
@@ -57,7 +57,6 @@
 			ScDataPilotSourceTypeDlg( Window* pParent, BOOL bEnableExternal );
 			~ScDataPilotSourceTypeDlg();
 
-	BOOL	IsSelection() const;
 	BOOL	IsDatabase() const;
 	BOOL	IsExternal() const;
 };
Index: sc/source/ui/inc/dbfunc.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/dbfunc.hxx,v
retrieving revision 1.11
retrieving revision 1.11.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.30.1
--- sc/source/ui/inc/dbfunc.hxx	10 Apr 2008 22:48:57 -0000	1.11
+++ sc/source/ui/inc/dbfunc.hxx	13 May 2008 14:34:13 -0000	1.11.30.1
@@ -55,7 +55,7 @@
 
 public:
 					ScDBFunc( Window* pParent, ScDocShell& rDocSh, ScTabViewShell* pViewShell );
-					ScDBFunc( Window* pParent, const ScDBFunc& rDBFunc, ScTabViewShell* pViewShell );
+//UNUSED2008-05     ScDBFunc( Window* pParent, const ScDBFunc& rDBFunc, ScTabViewShell* pViewShell );
 					~ScDBFunc();
 
 					//	nur UISort wiederholt bei Bedarf die Teilergebnisse
Index: sc/source/ui/inc/docfunc.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/docfunc.hxx,v
retrieving revision 1.18
retrieving revision 1.18.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.30.1
--- sc/source/ui/inc/docfunc.hxx	10 Apr 2008 22:50:24 -0000	1.18
+++ sc/source/ui/inc/docfunc.hxx	9 May 2008 16:11:51 -0000	1.18.30.1
@@ -118,8 +118,6 @@
 
 	BOOL			SetLayoutRTL( SCTAB nTab, BOOL bRTL, BOOL bApi );
 
-	BOOL	 	    SetAddressConvention( ScAddress::Convention eConv );
-
 	SC_DLLPUBLIC BOOL			SetWidthOrHeight( BOOL bWidth, SCCOLROW nRangeCnt, SCCOLROW* pRanges,
 									SCTAB nTab, ScSizeMode eMode, USHORT nSizeTwips,
 									BOOL bRecord, BOOL bApi );
Index: sc/source/ui/inc/docsh.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/docsh.hxx,v
retrieving revision 1.50
retrieving revision 1.50.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.50 -r1.50.32.2
--- sc/source/ui/inc/docsh.hxx	15 Apr 2008 14:34:04 -0000	1.50
+++ sc/source/ui/inc/docsh.hxx	13 May 2008 00:33:46 -0000	1.50.32.2
@@ -59,7 +59,9 @@
 class ScPaintItem;
 class ScViewData;
 class ScDocFunc;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivot;
+#endif
 class ScDrawLayer;
 class ScTabViewShell;
 class ScSbxDocHelper;
@@ -133,15 +135,10 @@
 	SC_DLLPRIVATE void			InitOptions();
 	SC_DLLPRIVATE void			ResetDrawObjectShell();
 
-	SC_DLLPRIVATE BOOL			GetTabParam( const SfxItemSet* pArgs, USHORT nId, SCTAB& rTab );
-    //BOOL            LoadCalc( SotStorage* pStor );
-    //BOOL            SaveCalc( SotStorage* pStor );
     SC_DLLPRIVATE BOOL            LoadXML( SfxMedium* pMedium, const ::com::sun::star::uno::Reference< ::com::sun::star::embed::XStorage >& );
     SC_DLLPRIVATE BOOL            SaveXML( SfxMedium* pMedium, const ::com::sun::star::uno::Reference< ::com::sun::star::embed::XStorage >& );
 	SC_DLLPRIVATE SCTAB			GetSaveTab();
 
-	SC_DLLPRIVATE void			RemoveUnknownObjects();
-
 	SC_DLLPRIVATE ULONG			DBaseImport( const String& rFullFileName, CharSet eCharSet,
 								 BOOL bSimpleColWidth[MAXCOLCOUNT] );
 	SC_DLLPRIVATE ULONG			DBaseExport( const String& rFullFileName, CharSet eCharSet,
@@ -281,8 +278,10 @@
 	BOOL			AdjustRowHeight( SCROW nStartRow, SCROW nEndRow, SCTAB nTab );
     void            UpdateAllRowHeights();
 
+#if OLD_PIVOT_IMPLEMENTATION
 	void			PivotUpdate( ScPivot* pOldPivot, ScPivot* pNewPivot,
 									BOOL bRecord = TRUE, BOOL bApi = FALSE );
+#endif
 	void			RefreshPivotTables( const ScRange& rSource );
 	void			DoConsolidate( const ScConsolidateParam& rParam, BOOL bRecord = TRUE );
 	void			UseScenario( SCTAB nTab, const String& rName, BOOL bRecord = TRUE );
Index: sc/source/ui/inc/drawview.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/drawview.hxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/ui/inc/drawview.hxx	10 Apr 2008 22:51:57 -0000	1.12
+++ sc/source/ui/inc/drawview.hxx	13 May 2008 14:34:13 -0000	1.12.32.2
@@ -67,7 +67,6 @@
 
 public:
 					ScDrawView( OutputDevice* pOut, ScViewData* pData );
-					ScDrawView( OutputDevice* pOut, ScDocument* pDocument, SCTAB nTable );
 	virtual			~ScDrawView();
 
 	virtual void	MarkListHasChanged();
@@ -115,7 +114,7 @@
 	void			SetMarkedOriginalSize();
 
 	BOOL			SelectObject( const String& rName );
-	String			GetSelectedChartName() const;
+//UNUSED2008-05  String			GetSelectedChartName() const;
 	BOOL			HasMarkedControl() const;
 
 	FASTBOOL		InsertObjectSafe(SdrObject* pObj, SdrPageView& rPV, ULONG nOptions=0);
Index: sc/source/ui/inc/editable.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/editable.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/editable.hxx	10 Apr 2008 22:53:18 -0000	1.4
+++ sc/source/ui/inc/editable.hxx	9 May 2008 16:11:51 -0000	1.4.32.1
@@ -80,8 +80,6 @@
 	void	TestSelection( ScDocument* pDoc, const ScMarkData& rMark );
 	void	TestView( ScViewFunc* pView );
 
-	void	Reset();
-
 	BOOL	IsEditable() const			{ return bIsEditable; }
 	BOOL	IsFormatEditable() const	{ return bIsEditable || bOnlyMatrix; }
 	USHORT	GetMessageId() const;
Index: sc/source/ui/inc/editfield.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/editfield.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/editfield.hxx	10 Apr 2008 22:53:33 -0000	1.4
+++ sc/source/ui/inc/editfield.hxx	9 May 2008 16:11:51 -0000	1.4.32.1
@@ -39,7 +39,6 @@
 class ScDoubleField : public Edit
 {
 public:
-    explicit            ScDoubleField( Window* pParent, WinBits nStyle = WB_BORDER );
     explicit            ScDoubleField( Window* pParent, const ResId& rResId );
 
     bool                GetValue( double& rfValue ) const;
Index: sc/source/ui/inc/expftext.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/expftext.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/expftext.hxx	10 Apr 2008 22:54:05 -0000	1.4
+++ sc/source/ui/inc/expftext.hxx	9 May 2008 16:11:51 -0000	1.4.32.1
@@ -41,8 +41,6 @@
 		void RequestHelp( const HelpEvent& rHEvt );
 
 	public:
-
-		ScExpandedFixedText( Window* pParent,WinBits nWinStyle = 0);
 		ScExpandedFixedText( Window* pWindow, const ResId& rResId);
 };
 
Index: sc/source/ui/inc/formatsh.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/formatsh.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/source/ui/inc/formatsh.hxx	10 Apr 2008 22:56:04 -0000	1.6
+++ sc/source/ui/inc/formatsh.hxx	9 May 2008 16:11:51 -0000	1.6.32.1
@@ -71,9 +71,6 @@
 	void		ExecuteStyle( SfxRequest& rReq );
 	void		GetStyleState( SfxItemSet& rSet );
 
-	void		ExecBckCol( SfxRequest& rReq );
-	void		GetBckColState( SfxItemSet& rSet );
-
     void        ExecuteTextDirection( SfxRequest& rReq );
     void        GetTextDirectionState( SfxItemSet& rSet );
 
Index: sc/source/ui/inc/formdata.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/formdata.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/source/ui/inc/formdata.hxx	10 Apr 2008 22:56:22 -0000	1.3
+++ sc/source/ui/inc/formdata.hxx	9 May 2008 16:11:51 -0000	1.3.32.1
@@ -46,7 +46,6 @@
 						~ScFormEditData();
 
 	void				SaveValues();
-	void				RestoreValues();
 	BOOL				HasParent() const	{ return pParent != NULL; }
 
 	USHORT				GetMode() const		{ return nMode; }
Index: sc/source/ui/inc/formula.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/formula.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/source/ui/inc/formula.hxx	10 Apr 2008 22:56:36 -0000	1.5
+++ sc/source/ui/inc/formula.hxx	13 May 2008 14:34:13 -0000	1.5.32.2
@@ -181,8 +181,6 @@
 	void			FillDialog(BOOL nFlag=TRUE);
 	void			EditNextFunc( BOOL bForward, xub_StrLen nFStart=NOT_FOUND );
 	void			EditThisFunc(xub_StrLen nFStart);
-	void			EditFuncParas(xub_StrLen nEditPos);
-
 
 	void			UpdateArgInput( USHORT nOffset, USHORT nInput );
 	BOOL			CalcValue( const String& rStrExp, String& rStrResult );
@@ -192,8 +190,7 @@
 	void			SaveArg( USHORT nEd );
 	void			UpdateSelection();
 	void			DoEnter( BOOL bOk );
-	void			UpdateFunctionDesc();
-	void			ResizeArgArr( const ScFuncDesc* pNewFunc );
+//UNUSED2008-05  void			ResizeArgArr( const ScFuncDesc* pNewFunc );
 	void			FillListboxes();
 	void			FillControls();
 
@@ -202,7 +199,7 @@
 
     ScRefEdit*      GetCurrRefEdit();
 
-	DECL_LINK( ScrollHdl, ScParaWin* );
+//UNUSED2008-05  DECL_LINK( ScrollHdl, ScParaWin* );
 	DECL_LINK( ModifyHdl, ScParaWin* );
 	DECL_LINK( FxHdl, ScParaWin* );
 
Index: sc/source/ui/inc/funcpage.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/funcpage.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/funcpage.hxx	10 Apr 2008 22:59:17 -0000	1.4
+++ sc/source/ui/inc/funcpage.hxx	9 May 2008 21:22:44 -0000	1.4.32.1
@@ -72,10 +72,7 @@
 	virtual long	PreNotify( NotifyEvent& rNEvt );
 
 public:
-					ScListBox( Window* pParent, WinBits nWinStyle = WB_BORDER );
-
 					ScListBox( Window* pParent, const ResId& rResId );
-
 };
 
 
Index: sc/source/ui/inc/funcutl.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/funcutl.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.2
--- sc/source/ui/inc/funcutl.hxx	10 Apr 2008 22:59:31 -0000	1.5
+++ sc/source/ui/inc/funcutl.hxx	9 May 2008 16:11:51 -0000	1.5.32.2
@@ -82,8 +82,6 @@
 
 
 public:
-					ScEditBox( Window* pParent,
-								WinBits nWinStyle = WB_LEFT | WB_BORDER );
 					ScEditBox( Window* pParent, const ResId& rResId );
 
 					~ScEditBox();
@@ -172,10 +170,6 @@
 	String		GetArgVal();
 
 	void		SetArgSelection	(const Selection& rSel );
-	void		ReplaceSelOfArg	(const String& rStr );
-
-	Selection	GetArgSelection();
-
 
 	ArgEdit*	GetArgEdPtr() {return pEdArg;}
 
Index: sc/source/ui/inc/gridwin.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/gridwin.hxx,v
retrieving revision 1.29
retrieving revision 1.29.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.29 -r1.29.32.3
--- sc/source/ui/inc/gridwin.hxx	10 Apr 2008 23:01:07 -0000	1.29
+++ sc/source/ui/inc/gridwin.hxx	13 May 2008 14:34:13 -0000	1.29.32.3
@@ -44,7 +44,9 @@
 
 struct ScTableInfo;
 class ScViewSelectionEngine;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivot;
+#endif
 class ScDPObject;
 class ScOutputData;
 class ScFilterListBox;
@@ -168,11 +170,13 @@
 	BYTE					nMouseStatus;
     BYTE                    nNestedButtonState;     // track nested button up/down calls
 
+#if OLD_PIVOT_IMPLEMENTATION
 	BOOL					bPivotMouse;			// Pivot-D&D (alte Pivottabellen)
 	ScPivot*				pDragPivot;
 	BOOL					bPivotColField;
 	SCCOL					nPivotCol;
 	SCCOL					nPivotField;
+#endif
 
 	BOOL					bDPMouse;				// DataPilot-D&D (neue Pivottabellen)
 	long					nDPField;
@@ -231,10 +235,12 @@
 
 	BOOL			DoPageFieldSelection( SCCOL nCol, SCROW nRow );
 	void			DoPushButton( SCCOL nCol, SCROW nRow, const MouseEvent& rMEvt );
+#if OLD_PIVOT_IMPLEMENTATION
 	void			PivotMouseMove( const MouseEvent& rMEvt );
 	void			PivotMouseButtonUp( const MouseEvent& rMEvt );
 	BOOL			PivotTestMouse( const MouseEvent& rMEvt, BOOL bMove );
 	void			DoPivotDrop( BOOL bDelete, BOOL bToCols, SCSIZE nDestPos );
+#endif
 
 	void			DPMouseMove( const MouseEvent& rMEvt );
 	void			DPMouseButtonUp( const MouseEvent& rMEvt );
@@ -282,7 +288,6 @@
     void            DrawSdrGrid( const Rectangle& rDrawingRect, OutputDevice* pContentDev );
 	//BOOL			DrawBeforeScroll();
 	void			DrawAfterScroll(/*BOOL bVal*/);
-	void			OutlinerViewPaint( const Rectangle& rRect );
 	//void			DrawMarks();
 	//BOOL			NeedDrawMarks();
 	void 			DrawComboButton( const Point&	rCellPos,
@@ -376,11 +381,7 @@
 	void			InvertSimple( SCCOL nX1, SCROW nY1, SCCOL nX2, SCROW nY2,
 									BOOL bTestMerge = FALSE, BOOL bRepeat = FALSE );
 
-	void			DrawDragRect( SCCOL nX1, SCROW nY1, SCCOL nX2, SCROW nY2 );
-
-	void			DrawRefMark( SCCOL nRefStartX, SCROW nRefStartY,
-									SCCOL nRefEndX, SCROW nRefEndY,
-									const Color& rColor, BOOL bHandle );
+//UNUSED2008-05  void			DrawDragRect( SCCOL nX1, SCROW nY1, SCCOL nX2, SCROW nY2 );
 
 	void			CreateAnchorHandle(SdrHdlList& rHdl, const ScAddress& rAddress);
 
Index: sc/source/ui/inc/groupdlg.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/groupdlg.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/inc/groupdlg.hxx	10 Apr 2008 23:01:22 -0000	1.4
+++ sc/source/ui/inc/groupdlg.hxx	9 May 2008 16:11:51 -0000	1.4.32.1
@@ -47,7 +47,6 @@
 						BOOL	bRows    = TRUE  );
 			~ScGroupDlg();
 
-	BOOL GetRowsChecked() const;
 	BOOL GetColsChecked() const;
 
 private:
Index: sc/source/ui/inc/inputhdl.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/inputhdl.hxx,v
retrieving revision 1.15
retrieving revision 1.15.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.1
--- sc/source/ui/inc/inputhdl.hxx	10 Apr 2008 23:03:55 -0000	1.15
+++ sc/source/ui/inc/inputhdl.hxx	9 May 2008 16:11:51 -0000	1.15.32.1
@@ -122,7 +122,6 @@
 #ifdef _INPUTHDL_CXX
 private:
 	void			UpdateActiveView();
-	void			SetAllUpdateMode( BOOL bUpdate );
 	void			SyncViews( EditView* pSourceView = NULL );
 	BOOL			StartTable( sal_Unicode cTyped, BOOL bFromCommand );
 	void			RemoveSelection();
@@ -233,9 +232,6 @@
 
 	BOOL			IsModalMode( SfxObjectShell* pDocSh );
 
-	void			ActivateInputWindow( const String&     rText,
-										 const ESelection& rSel );
-
 	void			ForgetLastPattern();
 
 	void			UpdateSpellSettings( BOOL bFromStartTab = FALSE );
Index: sc/source/ui/inc/inputwin.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/inputwin.hxx,v
retrieving revision 1.17
retrieving revision 1.17.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.2
--- sc/source/ui/inc/inputwin.hxx	10 Apr 2008 23:04:16 -0000	1.17
+++ sc/source/ui/inc/inputwin.hxx	13 May 2008 18:35:11 -0000	1.17.32.2
@@ -166,7 +166,6 @@
 	void			SetFuncString( const String& rString, BOOL bDoEdit = TRUE );
 	void			SetPosString( const String& rStr );
 	void			SetTextString( const String& rString );
-	const String&	GetTextString();
 
 	void 			SetOkCancelMode();
 	void 			SetSumAssignMode();
@@ -176,8 +175,8 @@
 
 	BOOL			IsInputActive();
 	EditView*		GetEditView();
-	EditView*		ActivateEdit( const String&     rText,
-								  const ESelection& rSel );
+//UNUSED2008-05  EditView*		ActivateEdit( const String&     rText,
+//UNUSED2008-05                                const ESelection& rSel );
 
 	void			TextGrabFocus();
 	void			TextInvalidate();
Index: sc/source/ui/inc/lbseldlg.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/lbseldlg.hxx,v
retrieving revision 1.4
retrieving revision 1.4.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.2
--- sc/source/ui/inc/lbseldlg.hxx	10 Apr 2008 23:05:50 -0000	1.4
+++ sc/source/ui/inc/lbseldlg.hxx	12 May 2008 15:57:00 -0000	1.4.32.2
@@ -64,7 +64,7 @@
 			~ScSelEntryDlg();
 
 	String GetSelectEntry() const;
-	USHORT GetSelectEntryPos() const;
+//UNUSED2008-05  USHORT GetSelectEntryPos() const;
 };
 
 
Index: sc/source/ui/inc/navipi.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/navipi.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.1
--- sc/source/ui/inc/navipi.hxx	10 Apr 2008 23:10:04 -0000	1.13
+++ sc/source/ui/inc/navipi.hxx	9 May 2008 21:22:44 -0000	1.13.32.1
@@ -281,8 +281,6 @@
 
     SfxBindings&    GetBindings()
                     { return rBindings; }
-    BOOL    GetDBAtCursor( String& rStrName );
-	BOOL	GetAreaAtCursor( String& rStrName );
 
 	void	SetCurrentCell( SCCOL nCol, SCROW Row );
 	void	SetCurrentCellStr( const String rName );
Index: sc/source/ui/inc/olinewin.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/olinewin.hxx,v
retrieving revision 1.11
retrieving revision 1.11.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.1
--- sc/source/ui/inc/olinewin.hxx	10 Apr 2008 23:11:35 -0000	1.11
+++ sc/source/ui/inc/olinewin.hxx	9 May 2008 21:22:44 -0000	1.11.32.1
@@ -220,8 +220,6 @@
     /** Erases the focus rectangle from the focused button. */
     void                        HideFocus();
 
-    /** Scrolls the window in entry-relative direction. */
-    void                        ScrollRel( long nEntryDiff );
     /** Scrolls the specified range of the window in entry-relative direction. */
     void                        ScrollRel( long nEntryDiff, long nEntryStart, long nEntryEnd );
 
Index: sc/source/ui/inc/output.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/output.hxx,v
retrieving revision 1.20
retrieving revision 1.20.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.20 -r1.20.32.1
--- sc/source/ui/inc/output.hxx	10 Apr 2008 23:13:45 -0000	1.20
+++ sc/source/ui/inc/output.hxx	9 May 2008 21:22:44 -0000	1.20.32.1
@@ -155,7 +155,6 @@
 	void			GetVisibleCell( SCCOL nCol, SCROW nRow, SCTAB nTab, ScBaseCell*& rpCell );
 
 	BOOL			IsAvailable( SCCOL nX, SCROW nY );
-	long			GetAvailableWidth( SCCOL nX, SCROW nY, long nNeeded );
 	void			GetOutputArea( SCCOL nX, SCSIZE nArrY, long nPosX, long nPosY,
 									SCCOL nCellX, SCROW nCellY, long nNeeded,
 									const ScPatternAttr& rPattern,
@@ -173,8 +172,6 @@
 	void			SetSyntaxColor( Font* pFont, ScBaseCell* pCell );
 	void			SetEditSyntaxColor( EditEngine& rEngine, ScBaseCell* pCell );
 
-    void            ConnectObject( const com::sun::star::uno::Reference < com::sun::star::embed::XEmbeddedObject >& rRef, SdrOle2Obj* pOleObj );
-
 	double			GetStretch();
 
 	void			DrawRotatedFrame( const Color* pForceColor );		// pixel
@@ -232,7 +229,6 @@
 	void	DrawRotated(BOOL bPixelToLogic);		// logisch
 
 	void	DrawClear();
-	void	DrawPageBorder( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY );
 
 	// #i72502# printer only command set
 	Point PrePrintDrawingLayer(long nLogStX, long nLogStY );
@@ -265,7 +261,6 @@
 
 	void	DrawNoteMarks();
     void    AddPDFNotes();
-	void	PrintNoteMarks( const List& rPosList );		// List of ScAddress
 };
 
 
Index: sc/source/ui/inc/prevloc.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/prevloc.hxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/ui/inc/prevloc.hxx	10 Apr 2008 23:16:22 -0000	1.12
+++ sc/source/ui/inc/prevloc.hxx	13 May 2008 14:34:13 -0000	1.12.32.2
@@ -104,7 +104,7 @@
 	SCTAB		nPrintTab;
 	List		aEntries;
 
-	ScAddress	GetCellFromRange( const Size& rOffsetPixel, const ScRange& rRange ) const;
+//UNUSED2008-05  ScAddress	GetCellFromRange( const Size& rOffsetPixel, const ScRange& rRange ) const;
 	Rectangle	GetOffsetPixel( const ScAddress& rCellPos, const ScRange& rRange ) const;
 
 public:
@@ -144,7 +144,6 @@
 	//	Check if any cells (including column/row headers) are in the visible area
 	BOOL	HasCellsInRange( const Rectangle& rVisiblePixel ) const;
 
-	BOOL	GetCell( const Point& rPos, ScAddress& rCellPos, Rectangle& rCellRect ) const;
 	BOOL	GetCellPosition( const ScAddress& rCellPos, Rectangle& rCellRect ) const;
 
 	// returns the rectangle where the EditEngine draws the text of a Header Cell
Index: sc/source/ui/inc/prevwsh.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/prevwsh.hxx,v
retrieving revision 1.13
retrieving revision 1.13.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.1
--- sc/source/ui/inc/prevwsh.hxx	10 Apr 2008 23:16:41 -0000	1.13
+++ sc/source/ui/inc/prevwsh.hxx	9 May 2008 21:22:44 -0000	1.13.32.1
@@ -96,10 +96,6 @@
 					SFX_DECL_VIEWFACTORY(ScPreviewShell);
 
 					ScPreviewShell( SfxViewFrame*			pViewFrame,
-									const ScPreviewShell&	rWin );
-					ScPreviewShell( SfxViewFrame*			pViewFrame,
-									Window*					pParent);
-					ScPreviewShell( SfxViewFrame*			pViewFrame,
 									SfxViewShell*			pOldSh );
 
 	virtual			~ScPreviewShell();
Index: sc/source/ui/inc/pvfundlg.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/pvfundlg.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/ui/inc/pvfundlg.hxx	10 Apr 2008 23:17:39 -0000	1.7
+++ sc/source/ui/inc/pvfundlg.hxx	9 May 2008 16:11:51 -0000	1.7.32.1
@@ -67,7 +67,6 @@
 {
 public:
     explicit            ScDPFunctionListBox( Window* pParent, const ResId& rResId );
-    explicit            ScDPFunctionListBox( Window* pParent, WinBits nStyle = 0 );
 
     void                SetSelection( USHORT nFuncMask );
     USHORT              GetSelection() const;
Index: sc/source/ui/inc/refundo.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/refundo.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/ui/inc/refundo.hxx	10 Apr 2008 23:18:31 -0000	1.5
+++ sc/source/ui/inc/refundo.hxx	13 May 2008 00:33:46 -0000	1.5.32.1
@@ -37,7 +37,9 @@
 class ScDBCollection;
 class ScRangeName;
 class ScPrintRangeSaver;
+#if OLD_PIVOT_IMPLEMENTATION
 class ScPivotCollection;
+#endif
 class ScDPCollection;
 class ScChartCollection;
 class ScConditionalFormatList;
@@ -52,7 +54,9 @@
 	ScDBCollection*				pDBCollection;
 	ScRangeName*				pRangeName;
 	ScPrintRangeSaver*			pPrintRanges;
+#if OLD_PIVOT_IMPLEMENTATION
 	ScPivotCollection*			pPivotCollection;
+#endif
 	ScDPCollection*				pDPCollection;
 	ScConditionalFormatList*	pCondFormList;
 	ScDetOpList*				pDetOpList;
Index: sc/source/ui/inc/simpref.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/simpref.hxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/source/ui/inc/simpref.hxx	10 Apr 2008 23:22:37 -0000	1.6
+++ sc/source/ui/inc/simpref.hxx	9 May 2008 21:22:44 -0000	1.6.32.1
@@ -117,8 +117,6 @@
     void            SetFlags( BOOL bSetCloseOnButtonUp, BOOL bSetSingleCell, BOOL bSetMultiSelection );
 
 	void			SetAutoReOpen(BOOL bFlag) {bAutoReOpen=bFlag;}
-
-	static	String	GetLastRefString();
 };
 
 
Index: sc/source/ui/inc/tabview.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/tabview.hxx,v
retrieving revision 1.28
retrieving revision 1.28.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.28 -r1.28.32.2
--- sc/source/ui/inc/tabview.hxx	10 Apr 2008 23:29:04 -0000	1.28
+++ sc/source/ui/inc/tabview.hxx	12 May 2008 15:57:00 -0000	1.28.32.2
@@ -271,7 +271,7 @@
 	void			DrawDeselectAll();
 	void			DrawMarkListHasChanged();
 	void			UpdateAnchorHandles();
-	String			GetSelectedChartName() const;
+//UNUSED2008-05  String          GetSelectedChartName() const;
 
 	ScPageBreakData* GetPageBreakData()		{ return pPageBreakData; }
 	ScHighlightRanges* GetHighlightRanges()	{ return pHighlightRanges; }
@@ -311,7 +311,7 @@
 	void			UpdateRef( SCCOL nCurX, SCROW nCurY, SCTAB nCurZ );
 	void			StopRefMode();
 
-	void			EndSelection();
+//UNUSED2008-05  void            EndSelection();
 	void			StopMarking();
 	void			FakeButtonUp( ScSplitPos eWhich );
 
@@ -321,12 +321,12 @@
 	ScSplitPos		FindWindow( Window* pWindow ) const;
 
 	void			SetActivePointer( const Pointer& rPointer );
-	void			SetActivePointer( const ResId& rId );
+//UNUSED2008-05  void            SetActivePointer( const ResId& rId );
 
 	void			ActiveGrabFocus();
-	void			ActiveCaptureMouse();
-	void			ActiveReleaseMouse();
-	Point			ActivePixelToLogic( const Point& rDevicePoint );
+//UNUSED2008-05  void            ActiveCaptureMouse();
+//UNUSED2008-05  void			ActiveReleaseMouse();
+//UNUSED2008-05  Point           ActivePixelToLogic( const Point& rDevicePoint );
 
 	void			ClickCursor( SCCOL nPosX, SCROW nPosY, BOOL bControl );
 
@@ -417,20 +417,20 @@
 	void			InvertBlockMark(SCCOL nBlockStartX, SCROW nBlockStartY,
 								SCCOL nBlockEndX, SCROW nBlockEndY);
 
-	void			DrawDragRect( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY,
-									ScSplitPos ePos );
+//UNUSED2008-05  void            DrawDragRect( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY,
+//UNUSED2008-05                                ScSplitPos ePos );
+//UNUSED2008-05  void			PaintCell( SCCOL nCol, SCROW nRow, SCTAB nTab );
+//UNUSED2008-05  void			PaintLeftRow( SCROW nRow );
+//UNUSED2008-05  void			PaintTopCol( SCCOL nCol );
 
-	void			PaintCell( SCCOL nCol, SCROW nRow, SCTAB nTab );
 	void			PaintArea( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
 										ScUpdateMode eMode = SC_UPDATE_ALL );
 
 	void			PaintGrid();
 
-	void			PaintTopCol( SCCOL nCol );
 	void			PaintTopArea( SCCOL nStartCol, SCCOL nEndCol );
 	void			PaintTop();
 
-	void			PaintLeftRow( SCROW nRow );
 	void			PaintLeftArea( SCROW nStartRow, SCROW nEndRow );
 	void			PaintLeft();
 
Index: sc/source/ui/inc/tabvwsh.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/tabvwsh.hxx,v
retrieving revision 1.30
retrieving revision 1.30.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.30 -r1.30.32.2
--- sc/source/ui/inc/tabvwsh.hxx	10 Apr 2008 23:29:18 -0000	1.30
+++ sc/source/ui/inc/tabvwsh.hxx	12 May 2008 15:57:00 -0000	1.30.32.2
@@ -168,7 +168,7 @@
 
 	SbxObject*				pScSbxObject;
 
-	BOOL					bChartDlgIsEdit;			// Datenbereich aendern
+//UNUSED2008-05  BOOL                    bChartDlgIsEdit;            // Datenbereich aendern
 	BOOL					bChartAreaValid;			// wenn Chart aufgezogen wird
 	String					aEditChartName;
 	ScRangeListRef			aChartSource;
@@ -184,7 +184,7 @@
 private:
 	SC_DLLPRIVATE void	Construct( BYTE nForceDesignMode = SC_FORCEMODE_NONE );
 
-	SC_DLLPRIVATE void			SetMySubShell( SfxShell* pShell );
+//UNUSED2008-05  SC_DLLPRIVATE void          SetMySubShell( SfxShell* pShell );
 	SC_DLLPRIVATE SfxShell*		GetMySubShell() const;
 
 	SC_DLLPRIVATE void			DoReadUserData( const String& rData );
@@ -239,8 +239,8 @@
 
 					// -> Clone-Methode fuer Factory
 
-					ScTabViewShell( SfxViewFrame*			pViewFrame,
-									const ScTabViewShell&	rWin );
+//UNUSED2008-05  ScTabViewShell( SfxViewFrame*           pViewFrame,
+//UNUSED2008-05                  const ScTabViewShell&   rWin );
 
 					// aus einer allgemeinen Shell konstruieren und
 					// soviel wie moeglich uebernehmen (SliderPos etc.):
@@ -264,8 +264,8 @@
 	SvxBorderLine*	GetDefaultFrameLine() const { return pCurFrameLine; }
 	void 			SetDefaultFrameLine(const SvxBorderLine* pLine );
 
-	void			ExecuteShowNIY( SfxRequest& rReq );
-	void			StateDisabled( SfxItemSet& rSet );
+//UNUSED2008-05  void            ExecuteShowNIY( SfxRequest& rReq );
+//UNUSED2008-05  void			StateDisabled( SfxItemSet& rSet );
 
 	void			Execute( SfxRequest& rReq );
 	void			GetState( SfxItemSet& rSet );
@@ -347,15 +347,15 @@
 
 	void			FillFieldData( ScHeaderFieldData& rData );
 
-	void			ResetChartArea();
+//UNUSED2008-05  void            ResetChartArea();
 	void			SetChartArea( const ScRangeListRef& rSource, const Rectangle& rDest );
 	BOOL			GetChartArea( ScRangeListRef& rSource, Rectangle& rDest, SCTAB& rTab ) const;
 
-	BOOL			IsChartDlgEdit() const;
-	void			SetChartDlgEdit(BOOL bFlag){bChartDlgIsEdit=bFlag;}
+//UNUSED2008-05  BOOL            IsChartDlgEdit() const;
+//UNUSED2008-05  void            SetChartDlgEdit(BOOL bFlag){bChartDlgIsEdit=bFlag;}
 
 	void			SetEditChartName(const String& aStr){aEditChartName=aStr;}
-	const String&	GetEditChartName() const;
+//UNUSED2008-05  const String&   GetEditChartName() const;
 
 	virtual void SFX_NOTIFY( SfxBroadcaster& rBC, const TypeId& rBCType,
 						 const SfxHint& rHint, const TypeId& rHintType );
@@ -375,8 +375,6 @@
                                          BOOL bSilent, BOOL bIsAPI );
     virtual USHORT          Print( SfxProgress& rProgress, BOOL bIsAPI, PrintDialog* pPrintDialog = NULL );
 
-	void			TestFunction( USHORT nPar );
-
 	void			ConnectObject( SdrOle2Obj* pObj );
 	BOOL			ActivateObject( SdrOle2Obj* pObj, long nVerb );
 
Index: sc/source/ui/inc/uiitems.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/uiitems.hxx,v
retrieving revision 1.7
retrieving revision 1.7.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.2
--- sc/source/ui/inc/uiitems.hxx	10 Apr 2008 23:33:51 -0000	1.7
+++ sc/source/ui/inc/uiitems.hxx	12 May 2008 16:42:00 -0000	1.7.32.2
@@ -56,13 +56,14 @@
 
 public:
 							TYPEINFO();
-							ScInputStatusItem( USHORT nWhich,
-											   SCTAB nTab,
-											   SCCOL nCol, SCROW nRow,
-											   SCCOL nStartCol, SCROW nStartRow,
-											   SCCOL nEndCol,   SCROW nSEndRow,
-											   const String& rString,
-											   const EditTextObject* pData );
+//UNUSED2008-05     		ScInputStatusItem( USHORT nWhich,
+//UNUSED2008-05     						   SCTAB nTab,
+//UNUSED2008-05     						   SCCOL nCol, SCROW nRow,
+//UNUSED2008-05     						   SCCOL nStartCol, SCROW nStartRow,
+//UNUSED2008-05     						   SCCOL nEndCol,   SCROW nSEndRow,
+//UNUSED2008-05     						   const String& rString,
+//UNUSED2008-05     						   const EditTextObject* pData );
+
 							ScInputStatusItem( USHORT nWhich,
 											   const ScAddress& rCurPos,
 											   const ScAddress& rStartPos,
@@ -122,7 +123,6 @@
 
 public:
 					TYPEINFO();
-					ScEditViewHint();
 					ScEditViewHint( ScEditEngineDefaulter* pEngine, const ScAddress& rCurPos );
 					~ScEditViewHint();
 
@@ -130,6 +130,9 @@
 	SCROW           GetRow() const      { return aCursorPos.Row(); }
 	SCTAB           GetTab() const      { return aCursorPos.Tab(); }
 	ScEditEngineDefaulter*	GetEngine() const   { return pEditEngine; }
+
+private:
+	ScEditViewHint(); // disabled
 };
 
 class ScIndexHint : public SfxHint
Index: sc/source/ui/inc/undodat.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/undodat.hxx,v
retrieving revision 1.8
retrieving revision 1.8.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.32.2
--- sc/source/ui/inc/undodat.hxx	10 Apr 2008 23:34:51 -0000	1.8
+++ sc/source/ui/inc/undodat.hxx	12 May 2008 15:57:00 -0000	1.8.32.2
@@ -408,41 +408,39 @@
 	BOOL			bQuerySize;
 };
 
-
-class ScUndoPivot: public ScSimpleUndo
-{
-public:
-					TYPEINFO();
-					ScUndoPivot( ScDocShell* pNewDocShell,
-							const ScArea& rOld, const ScArea& rNew,
-							ScDocument* pOldDoc, ScDocument* pNewDoc,
-							const ScPivot* pOldPivot, const ScPivot* pNewPivot );
-	virtual 		~ScUndoPivot();
-
-	virtual void	Undo();
-	virtual void	Redo();
-	virtual void	Repeat(SfxRepeatTarget& rTarget);
-	virtual BOOL	CanRepeat(SfxRepeatTarget& rTarget) const;
-
-	virtual String	GetComment() const;
-
-private:
-	ScArea			aOldArea;
-	ScArea			aNewArea;
-	ScDocument*		pOldUndoDoc;
-	ScDocument*		pNewUndoDoc;
-	ScPivotParam	aOldParam;				// fuer Redo
-	ScQueryParam	aOldQuery;
-	ScArea			aOldSrc;
-	ScPivotParam	aNewParam;				// fuer Undo in Collection
-	ScQueryParam	aNewQuery;
-	ScArea			aNewSrc;
-	String			aOldName;
-	String			aOldTag;
-	String			aNewName;
-	String			aNewTag;
-};
-
+//UNUSED2008-05  class ScUndoPivot: public ScSimpleUndo
+//UNUSED2008-05  {
+//UNUSED2008-05  public:
+//UNUSED2008-05                      TYPEINFO();
+//UNUSED2008-05                      ScUndoPivot( ScDocShell* pNewDocShell,
+//UNUSED2008-05                              const ScArea& rOld, const ScArea& rNew,
+//UNUSED2008-05                              ScDocument* pOldDoc, ScDocument* pNewDoc,
+//UNUSED2008-05                              const ScPivot* pOldPivot, const ScPivot* pNewPivot );
+//UNUSED2008-05      virtual         ~ScUndoPivot();
+//UNUSED2008-05  
+//UNUSED2008-05      virtual void    Undo();
+//UNUSED2008-05      virtual void    Redo();
+//UNUSED2008-05      virtual void    Repeat(SfxRepeatTarget& rTarget);
+//UNUSED2008-05      virtual BOOL    CanRepeat(SfxRepeatTarget& rTarget) const;
+//UNUSED2008-05  
+//UNUSED2008-05      virtual String  GetComment() const;
+//UNUSED2008-05  
+//UNUSED2008-05  private:
+//UNUSED2008-05      ScArea          aOldArea;
+//UNUSED2008-05      ScArea          aNewArea;
+//UNUSED2008-05      ScDocument*     pOldUndoDoc;
+//UNUSED2008-05      ScDocument*     pNewUndoDoc;
+//UNUSED2008-05      ScPivotParam    aOldParam;              // fuer Redo
+//UNUSED2008-05      ScQueryParam    aOldQuery;
+//UNUSED2008-05      ScArea          aOldSrc;
+//UNUSED2008-05      ScPivotParam    aNewParam;              // fuer Undo in Collection
+//UNUSED2008-05      ScQueryParam    aNewQuery;
+//UNUSED2008-05      ScArea          aNewSrc;
+//UNUSED2008-05      String          aOldName;
+//UNUSED2008-05      String          aOldTag;
+//UNUSED2008-05      String          aNewName;
+//UNUSED2008-05      String          aNewTag;
+//UNUSED2008-05  };
 
 class ScUndoDataPilot: public ScSimpleUndo
 {
Index: sc/source/ui/inc/undotab.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/undotab.hxx,v
retrieving revision 1.10
retrieving revision 1.10.28.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.28.1
--- sc/source/ui/inc/undotab.hxx	10 Apr 2008 23:35:54 -0000	1.10
+++ sc/source/ui/inc/undotab.hxx	13 May 2008 19:05:08 -0000	1.10.28.1
@@ -468,8 +468,8 @@
 {
 public:
 					TYPEINFO();
-					ScUndoSetAddressConvention( ScDocShell* pShell,
-												ScAddress::Convention eConv );
+//UNUSED2008-05     ScUndoSetAddressConvention( ScDocShell* pShell,
+//UNUSED2008-05     							ScAddress::Convention eConv );
 	virtual			~ScUndoSetAddressConvention();
 
 	virtual void	Undo();
Index: sc/source/ui/inc/viewdata.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/viewdata.hxx,v
retrieving revision 1.24
retrieving revision 1.24.24.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.24 -r1.24.24.2
--- sc/source/ui/inc/viewdata.hxx	18 Apr 2008 11:36:48 -0000	1.24
+++ sc/source/ui/inc/viewdata.hxx	12 May 2008 15:57:00 -0000	1.24.24.2
@@ -233,9 +233,9 @@
 					~ScViewData();
 
 	void			InitData( ScDocument* pDocument );
-	void			InitFrom( const ScViewData* pRef );
+//UNUSED2008-05  void            InitFrom( const ScViewData* pRef );
+//UNUSED2008-05  void			SetDocShell( ScDocShell* pShell );
 
-	void			SetDocShell( ScDocShell* pShell );
 
 	ScDocShell*		GetDocShell() const		{ return pDocShell; }
 	ScDBFunc*		GetView() const			{ return pView; }
@@ -444,11 +444,11 @@
 	SCROW			VisibleCellsY( ScVSplitPos eWhichY ) const;
 	SCCOL			PrevCellsX( ScHSplitPos eWhichX ) const;		// Zellen auf der vorgehenden Seite
 	SCROW			PrevCellsY( ScVSplitPos eWhichY ) const;
-	SCCOL			LastCellsX( ScHSplitPos eWhichX ) const;		// Zellen auf der letzten Seite
-	SCROW			LastCellsY( ScVSplitPos eWhichY ) const;
+//UNUSED2008-05  SCCOL           LastCellsX( ScHSplitPos eWhichX ) const;        // Zellen auf der letzten Seite
+//UNUSED2008-05  SCROW           LastCellsY( ScVSplitPos eWhichY ) const;
 
 	BOOL			IsOle();
-	void			UpdateOle( ScSplitPos eWhich );
+//UNUSED2008-05  void            UpdateOle( ScSplitPos eWhich );
 	void			SetScreen( SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2 );
 	void			SetScreen( const Rectangle& rVisArea );
 	void			SetScreenPos( const Point& rVisAreaStart );
Index: sc/source/ui/inc/viewfunc.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/viewfunc.hxx,v
retrieving revision 1.34
retrieving revision 1.34.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.32.3
--- sc/source/ui/inc/viewfunc.hxx	10 Apr 2008 23:37:14 -0000	1.34
+++ sc/source/ui/inc/viewfunc.hxx	13 May 2008 18:35:11 -0000	1.34.32.3
@@ -83,7 +83,7 @@
 
 public:
 					ScViewFunc( Window* pParent, ScDocShell& rDocSh, ScTabViewShell* pViewShell );
-					ScViewFunc( Window* pParent, const ScViewFunc& rViewFunc, ScTabViewShell* pViewShell );
+//UNUSED2008-05     ScViewFunc( Window* pParent, const ScViewFunc& rViewFunc, ScTabViewShell* pViewShell );
 					~ScViewFunc();
 
 	const ScPatternAttr*    GetSelectionPattern	();
@@ -299,10 +299,10 @@
 											BOOL bColorOnly );
 
 	void			SetNote( SCCOL nCol, SCROW nRow, SCTAB nTab, const ScPostIt& rNote );
-	void			DoSpellingChecker( BOOL bRecord = TRUE );
+//UNUSED2008-05  void            DoSpellingChecker( BOOL bRecord = TRUE );
     void            DoHangulHanjaConversion( BOOL bRecord = TRUE );
 	void			DoThesaurus( BOOL bRecord = TRUE );
-	DECL_LINK( SpellError, void * );
+//UNUSED2008-05  DECL_LINK( SpellError, void * );
 
     /** Generic implementation of sheet conversion functions. */
     void            DoSheetConversion( const ScConversionParam& rParam, BOOL bRecord = TRUE );
@@ -335,7 +335,7 @@
 									 const SvxBorderLine* pSrcLine,
 									 BOOL 				  bColor );
 
-	void			PaintWidthHeight( BOOL bColumns, SCCOLROW nStart, SCCOLROW nEnd );
+//UNUSED2008-05  void            PaintWidthHeight( BOOL bColumns, SCCOLROW nStart, SCCOLROW nEnd );
 
 
 private:
Index: sc/source/ui/miscdlgs/acredlin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/acredlin.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.1
--- sc/source/ui/miscdlgs/acredlin.cxx	10 Apr 2008 23:38:03 -0000	1.25
+++ sc/source/ui/miscdlgs/acredlin.cxx	13 May 2008 14:34:13 -0000	1.25.32.1
@@ -2040,9 +2040,9 @@
 	}
 }
 
-void ScAcceptChgDlg::SetMyStaticData()
-{
-}
+//UNUSED2008-05  void ScAcceptChgDlg::SetMyStaticData()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 IMPL_LINK( ScAcceptChgDlg, FilterModified, SvxTPFilter*, EMPTYARG )
 {
Index: sc/source/ui/miscdlgs/anyrefdg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/anyrefdg.cxx,v
retrieving revision 1.21
retrieving revision 1.21.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.30.2
--- sc/source/ui/miscdlgs/anyrefdg.cxx	10 Apr 2008 23:38:40 -0000	1.21
+++ sc/source/ui/miscdlgs/anyrefdg.cxx	12 May 2008 15:57:00 -0000	1.21.30.2
@@ -179,12 +179,12 @@
 	aTimer.Start();
 }
 
-void ScRefEdit::SilentGrabFocus()
-{
-    bSilentFocus = TRUE;
-    GrabFocus();
-    bSilentFocus = FALSE;
-}
+//UNUSED2008-05  void ScRefEdit::SilentGrabFocus()
+//UNUSED2008-05  {
+//UNUSED2008-05      bSilentFocus = TRUE;
+//UNUSED2008-05      GrabFocus();
+//UNUSED2008-05      bSilentFocus = FALSE;
+//UNUSED2008-05  }
 
 void ScRefEdit::SetRefDialog( ScAnyRefDlg* pDlg )
 {
Index: sc/source/ui/miscdlgs/conflictsdlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/conflictsdlg.cxx,v
retrieving revision 1.4
retrieving revision 1.4.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.4 -r1.4.32.1
--- sc/source/ui/miscdlgs/conflictsdlg.cxx	15 Apr 2008 14:13:28 -0000	1.4
+++ sc/source/ui/miscdlgs/conflictsdlg.cxx	13 May 2008 14:34:13 -0000	1.4.32.1
@@ -79,19 +79,19 @@
 // class ScConflictsListHelper
 //=============================================================================
 
-bool ScConflictsListHelper::HasSharedAction( ScConflictsList& rConflictsList, ULONG nSharedAction )
-{
-    ScConflictsList::const_iterator aEnd = rConflictsList.end();
-    for ( ScConflictsList::const_iterator aItr = rConflictsList.begin(); aItr != aEnd; ++aItr )
-    {
-        if ( aItr->HasSharedAction( nSharedAction ) )
-        {
-            return true;
-        }
-    }
-
-    return false;
-}
+//UNUSED2008-05  bool ScConflictsListHelper::HasSharedAction( ScConflictsList& rConflictsList, ULONG nSharedAction )
+//UNUSED2008-05  {
+//UNUSED2008-05      ScConflictsList::const_iterator aEnd = rConflictsList.end();
+//UNUSED2008-05      for ( ScConflictsList::const_iterator aItr = rConflictsList.begin(); aItr != aEnd; ++aItr )
+//UNUSED2008-05      {
+//UNUSED2008-05          if ( aItr->HasSharedAction( nSharedAction ) )
+//UNUSED2008-05          {
+//UNUSED2008-05              return true;
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return false;
+//UNUSED2008-05  }
 
 bool ScConflictsListHelper::HasOwnAction( ScConflictsList& rConflictsList, ULONG nOwnAction )
 {
@@ -433,10 +433,10 @@
 // class ScConflictsListBox
 //=============================================================================
 
-ScConflictsListBox::ScConflictsListBox( Window* pParent, WinBits nBits )
-    :SvxRedlinTable( pParent, nBits )
-{
-}
+//UNUSED2008-05  ScConflictsListBox::ScConflictsListBox( Window* pParent, WinBits nBits )
+//UNUSED2008-05      :SvxRedlinTable( pParent, nBits )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScConflictsListBox::ScConflictsListBox( Window* pParent, const ResId& rResId )
     :SvxRedlinTable( pParent, rResId )
@@ -447,21 +447,21 @@
 {
 }
 
-ULONG ScConflictsListBox::GetRootEntryPos( const SvLBoxEntry* pRootEntry ) const
-{
-    ULONG nPos = 0;
-    SvLBoxEntry* pEntry = GetRootLevelParent( First() );
-    while ( pEntry )
-    {
-        if ( pEntry == pRootEntry )
-        {
-            return nPos;
-        }
-        pEntry = NextSibling( pEntry );
-        ++nPos;
-    }
-    return 0xffffffff;
-}
+//UNUSED2008-05  ULONG ScConflictsListBox::GetRootEntryPos( const SvLBoxEntry* pRootEntry ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      ULONG nPos = 0;
+//UNUSED2008-05      SvLBoxEntry* pEntry = GetRootLevelParent( First() );
+//UNUSED2008-05      while ( pEntry )
+//UNUSED2008-05      {
+//UNUSED2008-05          if ( pEntry == pRootEntry )
+//UNUSED2008-05          {
+//UNUSED2008-05              return nPos;
+//UNUSED2008-05          }
+//UNUSED2008-05          pEntry = NextSibling( pEntry );
+//UNUSED2008-05          ++nPos;
+//UNUSED2008-05      }
+//UNUSED2008-05      return 0xffffffff;
+//UNUSED2008-05  }
 
 
 //=============================================================================
Index: sc/source/ui/miscdlgs/groupdlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/groupdlg.cxx,v
retrieving revision 1.7
retrieving revision 1.7.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.7 -r1.7.32.1
--- sc/source/ui/miscdlgs/groupdlg.cxx	10 Apr 2008 23:41:15 -0000	1.7
+++ sc/source/ui/miscdlgs/groupdlg.cxx	9 May 2008 16:11:52 -0000	1.7.32.1
@@ -71,13 +71,6 @@
 
 //------------------------------------------------------------------------
 
-BOOL ScGroupDlg::GetRowsChecked() const
-{
-	return aBtnRows.IsChecked();
-}
-
-//------------------------------------------------------------------------
-
 BOOL ScGroupDlg::GetColsChecked() const
 {
 	return aBtnCols.IsChecked();
Index: sc/source/ui/miscdlgs/lbseldlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/lbseldlg.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.2
--- sc/source/ui/miscdlgs/lbseldlg.cxx	10 Apr 2008 23:43:08 -0000	1.6
+++ sc/source/ui/miscdlgs/lbseldlg.cxx	12 May 2008 15:57:00 -0000	1.6.32.2
@@ -87,10 +87,10 @@
 
 //------------------------------------------------------------------------
 
-USHORT ScSelEntryDlg::GetSelectEntryPos() const
-{
-	return aLb.GetSelectEntryPos();
-}
+//UNUSED2008-05  USHORT ScSelEntryDlg::GetSelectEntryPos() const
+//UNUSED2008-05  {
+//UNUSED2008-05      return aLb.GetSelectEntryPos();
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
Index: sc/source/ui/miscdlgs/simpref.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/simpref.cxx,v
retrieving revision 1.11
retrieving revision 1.11.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.30.1
--- sc/source/ui/miscdlgs/simpref.cxx	10 Apr 2008 23:48:09 -0000	1.11
+++ sc/source/ui/miscdlgs/simpref.cxx	9 May 2008 21:22:45 -0000	1.11.30.1
@@ -63,8 +63,6 @@
 #define ERRORBOX(s) ErrorBox(this,WinBits(WB_OK|WB_DEF_OK),s).Execute()
 #define QUERYBOX(m) QueryBox(this,WinBits(WB_YES_NO|WB_DEF_YES),m).Execute()
 
-static String aPrivLastRefString;
-
 //============================================================================
 //	class ScSimpleRefDlg
 
@@ -95,15 +93,11 @@
 	Init();
 	FreeResource();
 	SetDispatcherLock( TRUE ); // Modal-Modus einschalten
-
-	aPrivLastRefString=String();
 }
 
 //----------------------------------------------------------------------------
 __EXPORT ScSimpleRefDlg::~ScSimpleRefDlg()
 {
-	aPrivLastRefString=aEdAssign.GetText();
-
 	SetDispatcherLock( FALSE ); // Modal-Modus einschalten
 }
 
@@ -196,11 +190,6 @@
 	return aEdAssign.GetText();
 }
 
-String ScSimpleRefDlg::GetLastRefString()
-{
-	return aPrivLastRefString;
-}
-
 void ScSimpleRefDlg::SetCloseHdl( const Link& rLink )
 {
 	aCloseHdl=rLink;
Index: sc/source/ui/navipi/content.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/navipi/content.cxx,v
retrieving revision 1.25
retrieving revision 1.25.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.30.1
--- sc/source/ui/navipi/content.cxx	10 Apr 2008 23:51:06 -0000	1.25
+++ sc/source/ui/navipi/content.cxx	13 May 2008 14:34:14 -0000	1.25.30.1
@@ -1293,16 +1293,16 @@
 	return 0;
 }
 
-void ScContentTree::AdjustTitle()
-{
-	String aTitle = pParentWindow->aTitleBase;
-	if (bHiddenDoc)
-	{
-		aTitle.AppendAscii(RTL_CONSTASCII_STRINGPARAM( " - " ));
-		aTitle += aHiddenTitle;
-	}
-	pParentWindow->SetText(aTitle);
-}
+//UNUSED2008-05  void ScContentTree::AdjustTitle()
+//UNUSED2008-05  {
+//UNUSED2008-05      String aTitle = pParentWindow->aTitleBase;
+//UNUSED2008-05      if (bHiddenDoc)
+//UNUSED2008-05      {
+//UNUSED2008-05          aTitle.AppendAscii(RTL_CONSTASCII_STRINGPARAM( " - " ));
+//UNUSED2008-05          aTitle += aHiddenTitle;
+//UNUSED2008-05      }
+//UNUSED2008-05      pParentWindow->SetText(aTitle);
+//UNUSED2008-05  }
 
 BOOL ScContentTree::LoadFile( const String& rUrl )
 {
Index: sc/source/ui/navipi/navipi.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/navipi/navipi.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.1
--- sc/source/ui/navipi/navipi.cxx	10 Apr 2008 23:52:12 -0000	1.22
+++ sc/source/ui/navipi/navipi.cxx	9 May 2008 21:22:45 -0000	1.22.32.1
@@ -1011,56 +1011,6 @@
 
 //------------------------------------------------------------------------
 
-BOOL ScNavigatorDlg::GetDBAtCursor( String& rStrName )
-{
-	BOOL bFound = FALSE;
-
-	if ( GetViewData() )
-	{
-		SCCOL nCol = aEdCol.GetCol();
-		SCROW nRow = aEdRow.GetRow();
-
-		if ( nCol > 0 && nRow > 0 )
-		{
-			ScDocument* pDoc  = pViewData->GetDocument();
-			ScDBData* 	pData = pDoc->GetDBAtCursor( nCol-1, nRow-1, pViewData->GetTabNo() );
-
-			bFound = ( pData != NULL );
-			if ( bFound )
-				pData->GetName( rStrName );
-		}
-	}
-
-	return bFound;
-}
-
-//------------------------------------------------------------------------
-
-BOOL ScNavigatorDlg::GetAreaAtCursor( String& rStrName )
-{
-	BOOL bFound = FALSE;
-
-	if ( GetViewData() )
-	{
-		SCCOL nCol = aEdCol.GetCol();
-		SCROW nRow = aEdRow.GetRow();
-
-		if ( nCol > 0 && nRow > 0 )
-		{
-			ScDocument*	 pDoc  = pViewData->GetDocument();
-			ScRangeData* pData = pDoc->GetRangeAtCursor( nCol-1, nRow-1, pViewData->GetTabNo() );
-
-			bFound = ( pData != NULL );
-			if ( bFound )
-				pData->GetName( rStrName );
-		}
-	}
-
-	return bFound;
-}
-
-//------------------------------------------------------------------------
-
 void ScNavigatorDlg::SetCurrentCell( SCCOL nColNo, SCROW nRowNo )
 {
 	if ( (nColNo+1 != nCurCol) || (nRowNo+1 != nCurRow) )
Index: sc/source/ui/undo/refundo.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/undo/refundo.cxx,v
retrieving revision 1.6
retrieving revision 1.6.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.32.1
--- sc/source/ui/undo/refundo.cxx	11 Apr 2008 00:23:37 -0000	1.6
+++ sc/source/ui/undo/refundo.cxx	13 May 2008 00:33:46 -0000	1.6.32.1
@@ -66,8 +66,10 @@
 
 	pPrintRanges = pDoc->CreatePrintRangeSaver();		// neu erzeugt
 
+#if OLD_PIVOT_IMPLEMENTATION
 	ScPivotCollection* pOldPivot = pDoc->GetPivotCollection();
 	pPivotCollection = pOldPivot ? new ScPivotCollection(*pOldPivot) : NULL;
+#endif
 	//!	bei Pivot nur Bereiche merken ???
 
 	ScDPCollection* pOldDP = ((ScDocument*)pDoc)->GetDPCollection();		//! const
@@ -94,7 +96,9 @@
 	delete pDBCollection;
 	delete pRangeName;
 	delete pPrintRanges;
+#if OLD_PIVOT_IMPLEMENTATION
 	delete pPivotCollection;
+#endif
 	delete pDPCollection;
 	delete pCondFormList;
 	delete pDetOpList;
@@ -126,12 +130,14 @@
 		delete pNewRanges;
 	}
 
+#if OLD_PIVOT_IMPLEMENTATION
 	if (pPivotCollection)
 	{
 		ScPivotCollection* pNewPivot = pDoc->GetPivotCollection();
 		if ( pNewPivot && *pPivotCollection == *pNewPivot )
 			DELETEZ(pPivotCollection);
 	}
+#endif
 
 	if (pDPCollection)
 	{
@@ -189,8 +195,10 @@
 	if (pPrintRanges)
 		pDoc->RestorePrintRanges(*pPrintRanges);
 
+#if OLD_PIVOT_IMPLEMENTATION
 	if (pPivotCollection)
 		pDoc->SetPivotCollection( new ScPivotCollection(*pPivotCollection) );
+#endif
 
 	if (pDPCollection)
 	{
Index: sc/source/ui/undo/undoblk3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/undo/undoblk3.cxx,v
retrieving revision 1.22
retrieving revision 1.22.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.22 -r1.22.32.1
--- sc/source/ui/undo/undoblk3.cxx	11 Apr 2008 00:24:52 -0000	1.22
+++ sc/source/ui/undo/undoblk3.cxx	8 May 2008 21:46:17 -0000	1.22.32.1
@@ -1580,7 +1580,6 @@
 			}
 
 			pDoc->DeleteAreaTab( aRange,IDF_ALL );
-//			pDoc->ClearDrawPage(nTab);
 			pUndoDoc->CopyToDocument( aRange, IDF_ALL, FALSE, pDoc );
 //			pDoc->TransferDrawPage( pUndoDoc, nTab, nTab );
 			pDoc->SetLink( nTab, pUndoDoc->GetLinkMode(nTab), pUndoDoc->GetLinkDoc(nTab),
@@ -1611,7 +1610,6 @@
 			ScRange aRange(0,0,nTab,MAXCOL,MAXROW,nTab);
 
 			pDoc->DeleteAreaTab( aRange, IDF_ALL );
-//			pDoc->ClearDrawPage(nTab);
 			pRedoDoc->CopyToDocument( aRange, IDF_ALL, FALSE, pDoc );
 //			pDoc->TransferDrawPage( pRedoDoc, nTab, nTab );
 			pDoc->SetLink( nTab,
Index: sc/source/ui/undo/undodat.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/undo/undodat.cxx,v
retrieving revision 1.12
retrieving revision 1.12.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.12.32.2
--- sc/source/ui/undo/undodat.cxx	11 Apr 2008 00:25:25 -0000	1.12
+++ sc/source/ui/undo/undodat.cxx	12 May 2008 15:57:00 -0000	1.12.32.2
@@ -74,7 +74,7 @@
 TYPEINIT1(ScUndoDBData, 			SfxUndoAction);
 TYPEINIT1(ScUndoImportData, 		SfxUndoAction);
 TYPEINIT1(ScUndoRepeatDB,			SfxUndoAction);
-TYPEINIT1(ScUndoPivot,				SfxUndoAction);
+//UNUSED2008-05  TYPEINIT1(ScUndoPivot,              SfxUndoAction);
 TYPEINIT1(ScUndoDataPilot,			SfxUndoAction);
 TYPEINIT1(ScUndoConsolidate,		SfxUndoAction);
 TYPEINIT1(ScUndoChartData,			SfxUndoAction);
@@ -1629,164 +1629,163 @@
 	return (rTarget.ISA(ScTabViewTarget));
 }
 
-//
-//		Pivot-Tabellen
-//
-
-ScUndoPivot::ScUndoPivot( ScDocShell* pNewDocShell,
-							const ScArea& rOld, const ScArea& rNew,
-							ScDocument* pOldDoc, ScDocument* pNewDoc,
-							const ScPivot* pOldPivot, const ScPivot* pNewPivot ) :
-	ScSimpleUndo( pNewDocShell ),
-	aOldArea( rOld ),
-	aNewArea( rNew ),
-	pOldUndoDoc( pOldDoc ),
-	pNewUndoDoc( pNewDoc )
-{
-	if (pNewPivot)
-	{
-		pNewPivot->GetParam( aNewParam, aNewQuery, aNewSrc );
-		aNewName = pNewPivot->GetName();
-		aNewTag = pNewPivot->GetTag();
-	}
-	if (pOldPivot)
-	{
-		pOldPivot->GetParam( aOldParam, aOldQuery, aOldSrc );
-		aOldName = pOldPivot->GetName();
-		aOldTag = pOldPivot->GetTag();
-	}
-}
-
-__EXPORT ScUndoPivot::~ScUndoPivot()
-{
-	delete pOldUndoDoc;
-	delete pNewUndoDoc;
-}
-
-String __EXPORT ScUndoPivot::GetComment() const
-{
-	USHORT nIndex;
-	if ( pOldUndoDoc && pNewUndoDoc )
-		nIndex = STR_UNDO_PIVOT_MODIFY;
-	else if ( pNewUndoDoc )
-		nIndex = STR_UNDO_PIVOT_NEW;
-	else
-		nIndex = STR_UNDO_PIVOT_DELETE;
-
-	return ScGlobal::GetRscString( nIndex );
-}
-
-void __EXPORT ScUndoPivot::Undo()
-{
-	BeginUndo();
-
-	ScDocument* pDoc = pDocShell->GetDocument();
-
-	if (pNewUndoDoc)
-	{
-		pDoc->DeleteAreaTab( aNewArea.nColStart,aNewArea.nRowStart,
-							aNewArea.nColEnd,aNewArea.nRowEnd, aNewArea.nTab, IDF_ALL );
-		pNewUndoDoc->CopyToDocument( aNewArea.nColStart, aNewArea.nRowStart, aNewArea.nTab,
-								aNewArea.nColEnd, aNewArea.nRowEnd, aNewArea.nTab,
-								IDF_ALL, FALSE, pDoc );
-	}
-	if (pOldUndoDoc)
-	{
-		pDoc->DeleteAreaTab( aOldArea.nColStart,aOldArea.nRowStart,
-							aOldArea.nColEnd,aOldArea.nRowEnd, aOldArea.nTab, IDF_ALL );
-		pOldUndoDoc->CopyToDocument( aOldArea.nColStart, aOldArea.nRowStart, aOldArea.nTab,
-								aOldArea.nColEnd, aOldArea.nRowEnd, aOldArea.nTab,
-								IDF_ALL, FALSE, pDoc );
-	}
-
-	ScPivotCollection* pPivotCollection = pDoc->GetPivotCollection();
-	if ( pNewUndoDoc )
-	{
-		ScPivot* pNewPivot = pPivotCollection->GetPivotAtCursor(
-								aNewParam.nCol, aNewParam.nRow, aNewParam.nTab );
-		if (pNewPivot)
-			pPivotCollection->Free( pNewPivot );
-	}
-	if ( pOldUndoDoc )
-	{
-		ScPivot* pOldPivot = new ScPivot( pDoc );
-		pOldPivot->SetParam( aOldParam, aOldQuery, aOldSrc );
-		pOldPivot->SetName( aOldName );
-		pOldPivot->SetTag( aOldTag );
-		if (pOldPivot->CreateData())							// Felder berechnen
-			pOldPivot->ReleaseData();
-		pPivotCollection->Insert( pOldPivot );
-	}
-
-// erack! it's broadcasted
-//	pDoc->SetDirty();
-	if (pNewUndoDoc)
-		pDocShell->PostPaint( aNewArea.nColStart, aNewArea.nRowStart, aNewArea.nTab,
-								aNewArea.nColEnd, aNewArea.nRowEnd, aNewArea.nTab,
-								PAINT_GRID, SC_PF_LINES );
-	if (pOldUndoDoc)
-		pDocShell->PostPaint( aOldArea.nColStart, aOldArea.nRowStart, aOldArea.nTab,
-								aOldArea.nColEnd, aOldArea.nRowEnd, aOldArea.nTab,
-								PAINT_GRID, SC_PF_LINES );
-	pDocShell->PostDataChanged();
-
-	ScTabViewShell* pViewShell = ScTabViewShell::GetActiveViewShell();
-	if (pViewShell)
-	{
-		SCTAB nTab = pViewShell->GetViewData()->GetTabNo();
-		if ( pOldUndoDoc )
-		{
-			if ( nTab != aOldArea.nTab )
-				pViewShell->SetTabNo( aOldArea.nTab );
-		}
-		else if ( pNewUndoDoc )
-		{
-			if ( nTab != aNewArea.nTab )
-				pViewShell->SetTabNo( aNewArea.nTab );
-		}
-	}
-
-	EndUndo();
-}
-
-void __EXPORT ScUndoPivot::Redo()
-{
-	BeginRedo();
-
-	ScDocument* pDoc = pDocShell->GetDocument();
-	ScPivotCollection* pPivotCollection = pDoc->GetPivotCollection();
-	ScPivot* pOldPivot = pPivotCollection->GetPivotAtCursor(
-											aOldParam.nCol, aOldParam.nRow, aOldParam.nTab );
-
-	ScPivot* pNewPivot = NULL;
-	if (pNewUndoDoc)
-	{
-		pNewPivot = new ScPivot( pDoc );
-		pNewPivot->SetParam( aNewParam, aNewQuery, aNewSrc );
-		pNewPivot->SetName( aNewName );
-		pNewPivot->SetTag( aNewTag );
-	}
-
-	pDocShell->PivotUpdate( pOldPivot, pNewPivot, FALSE );
-
-	EndRedo();
-}
-
-void __EXPORT ScUndoPivot::Repeat(SfxRepeatTarget& rTarget)
-{
-	//	Wiederholen: nur loeschen
-
-	if ( pOldUndoDoc && !pNewUndoDoc && rTarget.ISA(ScTabViewTarget) )
-		((ScTabViewTarget&)rTarget).GetViewShell()->DeletePivotTable();
-}
-
-BOOL __EXPORT ScUndoPivot::CanRepeat(SfxRepeatTarget& rTarget) const
-{
-	//	Wiederholen: nur loeschen
-
-	return ( pOldUndoDoc && !pNewUndoDoc && rTarget.ISA(ScTabViewTarget) );
-}
-
+//UNUSED2008-05  //
+//UNUSED2008-05  //		Pivot-Tabellen
+//UNUSED2008-05  //
+//UNUSED2008-05  
+//UNUSED2008-05  ScUndoPivot::ScUndoPivot( ScDocShell* pNewDocShell,
+//UNUSED2008-05                              const ScArea& rOld, const ScArea& rNew,
+//UNUSED2008-05                              ScDocument* pOldDoc, ScDocument* pNewDoc,
+//UNUSED2008-05                              const ScPivot* pOldPivot, const ScPivot* pNewPivot ) :
+//UNUSED2008-05      ScSimpleUndo( pNewDocShell ),
+//UNUSED2008-05      aOldArea( rOld ),
+//UNUSED2008-05      aNewArea( rNew ),
+//UNUSED2008-05      pOldUndoDoc( pOldDoc ),
+//UNUSED2008-05      pNewUndoDoc( pNewDoc )
+//UNUSED2008-05  {
+//UNUSED2008-05      if (pNewPivot)
+//UNUSED2008-05      {
+//UNUSED2008-05          pNewPivot->GetParam( aNewParam, aNewQuery, aNewSrc );
+//UNUSED2008-05          aNewName = pNewPivot->GetName();
+//UNUSED2008-05          aNewTag = pNewPivot->GetTag();
+//UNUSED2008-05      }
+//UNUSED2008-05      if (pOldPivot)
+//UNUSED2008-05      {
+//UNUSED2008-05          pOldPivot->GetParam( aOldParam, aOldQuery, aOldSrc );
+//UNUSED2008-05          aOldName = pOldPivot->GetName();
+//UNUSED2008-05          aOldTag = pOldPivot->GetTag();
+//UNUSED2008-05      }
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  __EXPORT ScUndoPivot::~ScUndoPivot()
+//UNUSED2008-05  {
+//UNUSED2008-05      delete pOldUndoDoc;
+//UNUSED2008-05      delete pNewUndoDoc;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  String __EXPORT ScUndoPivot::GetComment() const
+//UNUSED2008-05  {
+//UNUSED2008-05      USHORT nIndex;
+//UNUSED2008-05      if ( pOldUndoDoc && pNewUndoDoc )
+//UNUSED2008-05          nIndex = STR_UNDO_PIVOT_MODIFY;
+//UNUSED2008-05      else if ( pNewUndoDoc )
+//UNUSED2008-05          nIndex = STR_UNDO_PIVOT_NEW;
+//UNUSED2008-05      else
+//UNUSED2008-05          nIndex = STR_UNDO_PIVOT_DELETE;
+//UNUSED2008-05  
+//UNUSED2008-05      return ScGlobal::GetRscString( nIndex );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void __EXPORT ScUndoPivot::Undo()
+//UNUSED2008-05  {
+//UNUSED2008-05      BeginUndo();
+//UNUSED2008-05  
+//UNUSED2008-05      ScDocument* pDoc = pDocShell->GetDocument();
+//UNUSED2008-05  
+//UNUSED2008-05      if (pNewUndoDoc)
+//UNUSED2008-05      {
+//UNUSED2008-05          pDoc->DeleteAreaTab( aNewArea.nColStart,aNewArea.nRowStart,
+//UNUSED2008-05                              aNewArea.nColEnd,aNewArea.nRowEnd, aNewArea.nTab, IDF_ALL );
+//UNUSED2008-05          pNewUndoDoc->CopyToDocument( aNewArea.nColStart, aNewArea.nRowStart, aNewArea.nTab,
+//UNUSED2008-05                                  aNewArea.nColEnd, aNewArea.nRowEnd, aNewArea.nTab,
+//UNUSED2008-05                                  IDF_ALL, FALSE, pDoc );
+//UNUSED2008-05      }
+//UNUSED2008-05      if (pOldUndoDoc)
+//UNUSED2008-05      {
+//UNUSED2008-05          pDoc->DeleteAreaTab( aOldArea.nColStart,aOldArea.nRowStart,
+//UNUSED2008-05                              aOldArea.nColEnd,aOldArea.nRowEnd, aOldArea.nTab, IDF_ALL );
+//UNUSED2008-05          pOldUndoDoc->CopyToDocument( aOldArea.nColStart, aOldArea.nRowStart, aOldArea.nTab,
+//UNUSED2008-05                                  aOldArea.nColEnd, aOldArea.nRowEnd, aOldArea.nTab,
+//UNUSED2008-05                                  IDF_ALL, FALSE, pDoc );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      ScPivotCollection* pPivotCollection = pDoc->GetPivotCollection();
+//UNUSED2008-05      if ( pNewUndoDoc )
+//UNUSED2008-05      {
+//UNUSED2008-05          ScPivot* pNewPivot = pPivotCollection->GetPivotAtCursor(
+//UNUSED2008-05                                  aNewParam.nCol, aNewParam.nRow, aNewParam.nTab );
+//UNUSED2008-05          if (pNewPivot)
+//UNUSED2008-05              pPivotCollection->Free( pNewPivot );
+//UNUSED2008-05      }
+//UNUSED2008-05      if ( pOldUndoDoc )
+//UNUSED2008-05      {
+//UNUSED2008-05          ScPivot* pOldPivot = new ScPivot( pDoc );
+//UNUSED2008-05          pOldPivot->SetParam( aOldParam, aOldQuery, aOldSrc );
+//UNUSED2008-05          pOldPivot->SetName( aOldName );
+//UNUSED2008-05          pOldPivot->SetTag( aOldTag );
+//UNUSED2008-05          if (pOldPivot->CreateData())                            // Felder berechnen
+//UNUSED2008-05              pOldPivot->ReleaseData();
+//UNUSED2008-05          pPivotCollection->Insert( pOldPivot );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05  // erack! it's broadcasted
+//UNUSED2008-05  //	pDoc->SetDirty();
+//UNUSED2008-05      if (pNewUndoDoc)
+//UNUSED2008-05          pDocShell->PostPaint( aNewArea.nColStart, aNewArea.nRowStart, aNewArea.nTab,
+//UNUSED2008-05                                  aNewArea.nColEnd, aNewArea.nRowEnd, aNewArea.nTab,
+//UNUSED2008-05                                  PAINT_GRID, SC_PF_LINES );
+//UNUSED2008-05      if (pOldUndoDoc)
+//UNUSED2008-05          pDocShell->PostPaint( aOldArea.nColStart, aOldArea.nRowStart, aOldArea.nTab,
+//UNUSED2008-05                                  aOldArea.nColEnd, aOldArea.nRowEnd, aOldArea.nTab,
+//UNUSED2008-05                                  PAINT_GRID, SC_PF_LINES );
+//UNUSED2008-05      pDocShell->PostDataChanged();
+//UNUSED2008-05  
+//UNUSED2008-05      ScTabViewShell* pViewShell = ScTabViewShell::GetActiveViewShell();
+//UNUSED2008-05      if (pViewShell)
+//UNUSED2008-05      {
+//UNUSED2008-05          SCTAB nTab = pViewShell->GetViewData()->GetTabNo();
+//UNUSED2008-05          if ( pOldUndoDoc )
+//UNUSED2008-05          {
+//UNUSED2008-05              if ( nTab != aOldArea.nTab )
+//UNUSED2008-05                  pViewShell->SetTabNo( aOldArea.nTab );
+//UNUSED2008-05          }
+//UNUSED2008-05          else if ( pNewUndoDoc )
+//UNUSED2008-05          {
+//UNUSED2008-05              if ( nTab != aNewArea.nTab )
+//UNUSED2008-05                  pViewShell->SetTabNo( aNewArea.nTab );
+//UNUSED2008-05          }
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      EndUndo();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void __EXPORT ScUndoPivot::Redo()
+//UNUSED2008-05  {
+//UNUSED2008-05      BeginRedo();
+//UNUSED2008-05  
+//UNUSED2008-05      ScDocument* pDoc = pDocShell->GetDocument();
+//UNUSED2008-05      ScPivotCollection* pPivotCollection = pDoc->GetPivotCollection();
+//UNUSED2008-05      ScPivot* pOldPivot = pPivotCollection->GetPivotAtCursor(
+//UNUSED2008-05                                              aOldParam.nCol, aOldParam.nRow, aOldParam.nTab );
+//UNUSED2008-05  
+//UNUSED2008-05      ScPivot* pNewPivot = NULL;
+//UNUSED2008-05      if (pNewUndoDoc)
+//UNUSED2008-05      {
+//UNUSED2008-05          pNewPivot = new ScPivot( pDoc );
+//UNUSED2008-05          pNewPivot->SetParam( aNewParam, aNewQuery, aNewSrc );
+//UNUSED2008-05          pNewPivot->SetName( aNewName );
+//UNUSED2008-05          pNewPivot->SetTag( aNewTag );
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      pDocShell->PivotUpdate( pOldPivot, pNewPivot, FALSE );
+//UNUSED2008-05  
+//UNUSED2008-05      EndRedo();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void __EXPORT ScUndoPivot::Repeat(SfxRepeatTarget& rTarget)
+//UNUSED2008-05  {
+//UNUSED2008-05      //  Wiederholen: nur loeschen
+//UNUSED2008-05  
+//UNUSED2008-05      if ( pOldUndoDoc && !pNewUndoDoc && rTarget.ISA(ScTabViewTarget) )
+//UNUSED2008-05          ((ScTabViewTarget&)rTarget).GetViewShell()->DeletePivotTable();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  BOOL __EXPORT ScUndoPivot::CanRepeat(SfxRepeatTarget& rTarget) const
+//UNUSED2008-05  {
+//UNUSED2008-05      //  Wiederholen: nur loeschen
+//UNUSED2008-05  
+//UNUSED2008-05      return ( pOldUndoDoc && !pNewUndoDoc && rTarget.ISA(ScTabViewTarget) );
+//UNUSED2008-05  }
 
 //
 //		data pilot
Index: sc/source/ui/undo/undotab.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/undo/undotab.cxx,v
retrieving revision 1.19
retrieving revision 1.19.28.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.19 -r1.19.28.1
--- sc/source/ui/undo/undotab.cxx	11 Apr 2008 00:26:31 -0000	1.19
+++ sc/source/ui/undo/undotab.cxx	13 May 2008 19:05:14 -0000	1.19.28.1
@@ -1532,13 +1532,13 @@
 //		Set the address convention used for the sheet
 //
 
-ScUndoSetAddressConvention::ScUndoSetAddressConvention( ScDocShell* pShell,
-														ScAddress::Convention eConv ) :
-	ScSimpleUndo( pShell ),
-	eNewConv( eConv )
-{
-	eOldConv = pDocShell->GetDocument()->GetAddressConvention();
-}
+//UNUSED2008-05  ScUndoSetAddressConvention::ScUndoSetAddressConvention( ScDocShell* pShell,
+//UNUSED2008-05                                                          ScAddress::Convention eConv ) :
+//UNUSED2008-05      ScSimpleUndo( pShell ),
+//UNUSED2008-05      eNewConv( eConv )
+//UNUSED2008-05  {
+//UNUSED2008-05      eOldConv = pDocShell->GetDocument()->GetAddressConvention();
+//UNUSED2008-05  }
 
 __EXPORT ScUndoSetAddressConvention::~ScUndoSetAddressConvention()
 {
Index: sc/source/ui/unoobj/dapiuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/dapiuno.cxx,v
retrieving revision 1.21
retrieving revision 1.21.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.30.1
--- sc/source/ui/unoobj/dapiuno.cxx	11 Apr 2008 00:35:53 -0000	1.21
+++ sc/source/ui/unoobj/dapiuno.cxx	8 May 2008 21:46:17 -0000	1.21.30.1
@@ -211,16 +211,6 @@
 	return NULL;	// nicht gefunden
 }
 
-String lcl_ColumnTitle( ScDocument* pDoc, USHORT nCol, USHORT nRow, USHORT nTab )
-{
-	//	Spaltennamen, wie sie in der Pivottabelle angezeigt werden
-	String aStr;
-	pDoc->GetString(nCol, nRow, nTab, aStr);
-	if (aStr.Len() == 0)
-		aStr = ColToAlpha( nCol );
-	return aStr;
-}
-
 String lcl_CreatePivotName( ScDocShell* pDocShell )
 {
 	if (pDocShell)
@@ -377,38 +367,6 @@
     return xOriginal->getName();
 }
 
-void lcl_SetSaveData(const uno::Reference<container::XIndexAccess>& xFields, ScDPSaveData* pSaveData)
-{
-    if (xFields.is() && pSaveData)
-    {
-        sal_Int32 nFieldsCount(xFields->getCount());
-        for (sal_Int32 i = 0; i < nFieldsCount; ++i)
-        {
-            uno::Any aDim = xFields->getByIndex(i);
-            uno::Reference<container::XNamed> xDim;
-            uno::Reference<beans::XPropertySet> xDimProps;
-            if ((aDim >>= xDim) && (aDim >>= xDimProps))
-            {
-                //rtl::OUString sName(xDim->getName());
-                rtl::OUString sName( lcl_GetOriginalName(xDim) );
-                ScDPSaveDimension* pDim = sName.getLength() ? pSaveData->GetDimensionByName(sName) : 0;
-                if (pDim)
-                {
-                    uno::Any aAny = xDimProps->getPropertyValue(rtl::OUString(RTL_CONSTASCII_USTRINGPARAM(SC_UNONAME_ORIENT)));
-                    sheet::DataPilotFieldOrientation eOrient;
-                    if (aAny >>= eOrient)
-                        pDim->SetOrientation( sal::static_int_cast<USHORT>( eOrient ) );
-
-                    aAny = xDimProps->getPropertyValue(rtl::OUString(RTL_CONSTASCII_USTRINGPARAM(SC_UNONAME_FUNCTION)));
-                    sheet::GeneralFunction eFunc;
-                    if (aAny >>= eFunc)
-                        pDim->SetFunction( sal::static_int_cast<USHORT>( eFunc ) );
-                }
-            }
-        }
-    }
-}
-
 void SAL_CALL ScDataPilotTablesObj::insertNewByName( const rtl::OUString& aNewName,
 									const table::CellAddress& aOutputAddress,
 									const uno::Reference<sheet::XDataPilotDescriptor>& xDescriptor )
Index: sc/source/ui/unoobj/datauno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/datauno.cxx,v
retrieving revision 1.30
retrieving revision 1.30.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.30 -r1.30.32.1
--- sc/source/ui/unoobj/datauno.cxx	11 Apr 2008 00:37:26 -0000	1.30
+++ sc/source/ui/unoobj/datauno.cxx	9 May 2008 16:11:52 -0000	1.30.32.1
@@ -1567,45 +1567,6 @@
 	}
 }
 
-void ScDatabaseRangeObj::GetSortParam(ScSortParam& rSortParam) const
-{
-	const ScDBData* pData = GetDBData_Impl();
-	if (pData)
-	{
-		pData->GetSortParam(rSortParam);
-
-		//	im SortDescriptor sind die Fields innerhalb des Bereichs gezaehlt
-		ScRange aDBRange;
-		pData->GetArea(aDBRange);
-		SCCOLROW nFieldStart = rSortParam.bByRow ? static_cast<SCCOLROW>(aDBRange.aStart.Col()) : static_cast<SCCOLROW>(aDBRange.aStart.Row());
-		for (USHORT i=0; i<MAXSORT; i++)
-			if (rSortParam.bDoSort[i] && rSortParam.nField[i] >= nFieldStart)
-				rSortParam.nField[i] -= nFieldStart;
-	}
-}
-
-void ScDatabaseRangeObj::SetSortParam(const ScSortParam& rSortParam)
-{
-	const ScDBData* pData = GetDBData_Impl();
-	if (pData)
-	{
-		//	im SortDescriptor sind die Fields innerhalb des Bereichs gezaehlt
-		ScSortParam aParam(rSortParam);
-		ScRange aDBRange;
-		pData->GetArea(aDBRange);
-		SCCOLROW nFieldStart = aParam.bByRow ? static_cast<SCCOLROW>(aDBRange.aStart.Col()) : static_cast<SCCOLROW>(aDBRange.aStart.Row());
-		for (USHORT i=0; i<MAXSORT; i++)
-			if (aParam.bDoSort[i])
-				aParam.nField[i] += nFieldStart;
-
-		ScDBData aNewData( *pData );
-		aNewData.SetSortParam(aParam);
-		aNewData.SetHeader(aParam.bHasHeader);		// not in ScDBData::SetSortParam
-		ScDBDocFunc aFunc(*pDocShell);
-		aFunc.ModifyDBData(aNewData, TRUE);
-	}
-}
-
 uno::Sequence<beans::PropertyValue> SAL_CALL ScDatabaseRangeObj::getSortDescriptor()
 													throw(uno::RuntimeException)
 {
@@ -1745,30 +1706,6 @@
 	return new ScRangeSubTotalDescriptor(this);
 }
 
-void ScDatabaseRangeObj::GetImportParam(ScImportParam& rImportParam) const
-{
-	const ScDBData* pData = GetDBData_Impl();
-	if (pData)
-	{
-		pData->GetImportParam(rImportParam);
-		//	Fields gibt's hier nicht anzupassen
-	}
-}
-
-void ScDatabaseRangeObj::SetImportParam(const ScImportParam& rImportParam)
-{
-	const ScDBData* pData = GetDBData_Impl();
-	if (pData)
-	{
-		//	Fields gibt's hier nicht anzupassen
-
-		ScDBData aNewData( *pData );
-		aNewData.SetImportParam(rImportParam);
-		ScDBDocFunc aFunc(*pDocShell);
-		aFunc.ModifyDBData(aNewData, TRUE);
-	}
-}
-
 uno::Sequence<beans::PropertyValue> SAL_CALL ScDatabaseRangeObj::getImportDescriptor()
 												throw(uno::RuntimeException)
 {
Index: sc/source/ui/unoobj/docuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/docuno.cxx,v
retrieving revision 1.67
retrieving revision 1.67.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.67 -r1.67.30.2
--- sc/source/ui/unoobj/docuno.cxx	11 Apr 2008 00:38:41 -0000	1.67
+++ sc/source/ui/unoobj/docuno.cxx	12 May 2008 15:57:01 -0000	1.67.30.2
@@ -264,29 +264,6 @@
 	return pDocShell;
 }
 
-BOOL ScModelObj::IsEmbedded() const
-{
-	if (pDocShell)
-	{
-		return pDocShell->IsOle();
-	}
-	return FALSE;
-}
-
-double ScModelObj::GetOutputFactor() const
-{
-	if (pDocShell)
-		return pDocShell->GetOutputFactor();
-	return 1.0;
-}
-
-BOOL ScModelObj::AdjustRowHeight( SCROW nStartRow, SCROW nEndRow, SCTAB nTab )
-{
-	if (pDocShell)
-		return pDocShell->AdjustRowHeight( nStartRow, nEndRow, nTab );
-	return FALSE;
-}
-
 void ScModelObj::UpdateAllRowHeights()
 {
     if (pDocShell)
@@ -2807,11 +2784,11 @@
 
 //------------------------------------------------------------------------
 
-ScSpreadsheetSettingsObj::ScSpreadsheetSettingsObj(ScDocShell* pDocSh) :
-	pDocShell( pDocSh )
-{
-	pDocShell->GetDocument()->AddUnoObject(*this);
-}
+//UNUSED2008-05  ScSpreadsheetSettingsObj::ScSpreadsheetSettingsObj(ScDocShell* pDocSh) :
+//UNUSED2008-05  pDocShell( pDocSh )
+//UNUSED2008-05  {
+//UNUSED2008-05      pDocShell->GetDocument()->AddUnoObject(*this);
+//UNUSED2008-05  }
 
 ScSpreadsheetSettingsObj::~ScSpreadsheetSettingsObj()
 {
Index: sc/source/ui/unoobj/editsrc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/editsrc.cxx,v
retrieving revision 1.26
retrieving revision 1.26.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.26 -r1.26.32.1
--- sc/source/ui/unoobj/editsrc.cxx	11 Apr 2008 00:39:11 -0000	1.26
+++ sc/source/ui/unoobj/editsrc.cxx	9 May 2008 04:46:00 -0000	1.26.32.1
@@ -416,13 +416,3 @@
 	return mpAccessibleTextData->GetBroadcaster();
 }
 
-void ScAccessibilityEditSource::SetDoUpdateData(sal_Bool bValue)
-{
-	mpAccessibleTextData->SetDoUpdate(bValue);
-}
-
-sal_Bool ScAccessibilityEditSource::IsDirty() const
-{
-	return mpAccessibleTextData->IsDirty();
-}
-
Index: sc/source/ui/unoobj/fielduno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/fielduno.cxx,v
retrieving revision 1.18
retrieving revision 1.18.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.32.3
--- sc/source/ui/unoobj/fielduno.cxx	11 Apr 2008 00:39:27 -0000	1.18
+++ sc/source/ui/unoobj/fielduno.cxx	13 May 2008 14:34:14 -0000	1.18.32.3
@@ -431,13 +431,14 @@
 
 //	Default-ctor wird fuer SMART_REFLECTION_IMPLEMENTATION gebraucht
 
-ScCellFieldObj::ScCellFieldObj() :
-	OComponentHelper( getMutex() ),
-	aPropSet( lcl_GetURLPropertyMap() ),
-	pDocShell( NULL )
-{
-	pEditSource = NULL;
-}
+
+//UNUSED2008-05  ScCellFieldObj::ScCellFieldObj() :
+//UNUSED2008-05      OComponentHelper( getMutex() ),
+//UNUSED2008-05      aPropSet( lcl_GetURLPropertyMap() ),
+//UNUSED2008-05      pDocShell( NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05      pEditSource = NULL;
+//UNUSED2008-05  }
 
 ScCellFieldObj::ScCellFieldObj(ScDocShell* pDocSh, const ScAddress& rPos,
 											const ESelection& rSel) :
@@ -1114,17 +1115,16 @@
 
 
 //	Default-ctor wird fuer SMART_REFLECTION_IMPLEMENTATION gebraucht
-
-ScHeaderFieldObj::ScHeaderFieldObj() :
-	OComponentHelper( getMutex() ),
-	aPropSet( lcl_GetHeaderFieldPropertyMap() ),
-	pContentObj( NULL ),
-	nPart( 0 ),
-	nType( 0 ),
-	nFileFormat( SVXFILEFORMAT_NAME_EXT )
-{
-	pEditSource = NULL;
-}
+//UNUSED2008-05  ScHeaderFieldObj::ScHeaderFieldObj() :
+//UNUSED2008-05      OComponentHelper( getMutex() ),
+//UNUSED2008-05      aPropSet( lcl_GetHeaderFieldPropertyMap() ),
+//UNUSED2008-05      pContentObj( NULL ),
+//UNUSED2008-05      nPart( 0 ),
+//UNUSED2008-05      nType( 0 ),
+//UNUSED2008-05      nFileFormat( SVXFILEFORMAT_NAME_EXT )
+//UNUSED2008-05  {
+//UNUSED2008-05      pEditSource = NULL;
+//UNUSED2008-05  }
 
 ScHeaderFieldObj::ScHeaderFieldObj(ScHeaderFooterContentObj* pContent, USHORT nP,
 											USHORT nT, const ESelection& rSel) :
Index: sc/source/ui/unoobj/fmtuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/fmtuno.cxx,v
retrieving revision 1.18
retrieving revision 1.18.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.18 -r1.18.32.2
--- sc/source/ui/unoobj/fmtuno.cxx	11 Apr 2008 00:39:58 -0000	1.18
+++ sc/source/ui/unoobj/fmtuno.cxx	12 May 2008 15:57:01 -0000	1.18.32.2
@@ -130,9 +130,9 @@
 
 //------------------------------------------------------------------------
 
-ScTableConditionalFormat::ScTableConditionalFormat()
-{
-}
+//UNUSED2008-05  ScTableConditionalFormat::ScTableConditionalFormat()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScTableConditionalFormat::ScTableConditionalFormat(ScDocument* pDoc, ULONG nKey,
 													const ScGrammar::Grammar eGrammar)
@@ -488,10 +488,10 @@
 
 //------------------------------------------------------------------------
 
-ScTableConditionalEntry::ScTableConditionalEntry() :
-	pParent( NULL )
-{
-}
+//UNUSED2008-05  ScTableConditionalEntry::ScTableConditionalEntry() :
+//UNUSED2008-05  pParent( NULL )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScTableConditionalEntry::ScTableConditionalEntry(ScTableConditionalFormat* pPar,
                                                  const ScCondFormatEntryItem& aItem) :
@@ -599,11 +599,11 @@
 
 //------------------------------------------------------------------------
 
-ScTableValidationObj::ScTableValidationObj() :
-	aPropSet( lcl_GetValidatePropertyMap() ),
-    meGrammar( ScGrammar::GRAM_UNSPECIFIED )
-{
-}
+//UNUSED2008-05  ScTableValidationObj::ScTableValidationObj() :
+//UNUSED2008-05  aPropSet( lcl_GetValidatePropertyMap() ),
+//UNUSED2008-05  meGrammar( ScGrammar::GRAM_UNSPECIFIED )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScTableValidationObj::ScTableValidationObj(ScDocument* pDoc, ULONG nKey,
 											const ScGrammar::Grammar eGrammar) :
Index: sc/source/ui/unoobj/miscuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/miscuno.cxx,v
retrieving revision 1.14
retrieving revision 1.14.32.4
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.14 -r1.14.32.4
--- sc/source/ui/unoobj/miscuno.cxx	11 Apr 2008 00:41:38 -0000	1.14
+++ sc/source/ui/unoobj/miscuno.cxx	13 May 2008 19:05:21 -0000	1.14.32.4
@@ -42,10 +42,10 @@
 
 //------------------------------------------------------------------------
 
-SC_SIMPLE_SERVICE_INFO( ScEmptyEnumeration, "ScEmptyEnumeration", "stardiv.unknown" )
-SC_SIMPLE_SERVICE_INFO( ScEmptyEnumerationAccess, "ScEmptyEnumerationAccess", "stardiv.unknown" )
-//SC_SIMPLE_SERVICE_INFO( ScIndexEnumeration, "ScIndexEnumeration", "stardiv.unknown" )
-SC_SIMPLE_SERVICE_INFO( ScPrintSettingsObj, "ScPrintSettingsObj", "stardiv.unknown" )
+//UNUSED2008-05  SC_SIMPLE_SERVICE_INFO( ScEmptyEnumeration, "ScEmptyEnumeration", "stardiv.unknown" )
+//UNUSED2008-05  SC_SIMPLE_SERVICE_INFO( ScEmptyEnumerationAccess, "ScEmptyEnumerationAccess", "stardiv.unknown" )
+//UNUSED2008-05  SC_SIMPLE_SERVICE_INFO( ScIndexEnumeration, "ScIndexEnumeration", "stardiv.unknown" )
+//UNUSED2008-05  SC_SIMPLE_SERVICE_INFO( ScPrintSettingsObj, "ScPrintSettingsObj", "stardiv.unknown" )
 
 SC_SIMPLE_SERVICE_INFO( ScNameToIndexAccess, "ScNameToIndexAccess", "stardiv.unknown" )
 
@@ -242,58 +242,58 @@
 
 //------------------------------------------------------------------------
 
-ScEmptyEnumerationAccess::ScEmptyEnumerationAccess()
-{
-}
-
-ScEmptyEnumerationAccess::~ScEmptyEnumerationAccess()
-{
-}
-
-// XEnumerationAccess
-
-uno::Reference<container::XEnumeration> SAL_CALL ScEmptyEnumerationAccess::createEnumeration()
-													throw(uno::RuntimeException)
-{
-	ScUnoGuard aGuard;
-	return new ScEmptyEnumeration;
-}
-
-uno::Type SAL_CALL ScEmptyEnumerationAccess::getElementType() throw(uno::RuntimeException)
-{
-	ScUnoGuard aGuard;
-	return getCppuType((uno::Reference<uno::XInterface>*)0);	// or what?
-}
-
-sal_Bool SAL_CALL ScEmptyEnumerationAccess::hasElements() throw(uno::RuntimeException)
-{
-	return FALSE;
-}
+//UNUSED2008-05  ScEmptyEnumerationAccess::ScEmptyEnumerationAccess()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  ScEmptyEnumerationAccess::~ScEmptyEnumerationAccess()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  // XEnumerationAccess
+//UNUSED2008-05  
+//UNUSED2008-05  uno::Reference<container::XEnumeration> SAL_CALL ScEmptyEnumerationAccess::createEnumeration()
+//UNUSED2008-05                                                      throw(uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      ScUnoGuard aGuard;
+//UNUSED2008-05      return new ScEmptyEnumeration;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  uno::Type SAL_CALL ScEmptyEnumerationAccess::getElementType() throw(uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      ScUnoGuard aGuard;
+//UNUSED2008-05      return getCppuType((uno::Reference<uno::XInterface>*)0);    // or what?
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  sal_Bool SAL_CALL ScEmptyEnumerationAccess::hasElements() throw(uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      return FALSE;
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
-ScEmptyEnumeration::ScEmptyEnumeration()
-{
-}
-
-ScEmptyEnumeration::~ScEmptyEnumeration()
-{
-}
-
-// XEnumeration
-
-sal_Bool SAL_CALL ScEmptyEnumeration::hasMoreElements() throw(uno::RuntimeException)
-{
-	ScUnoGuard aGuard;
-	return FALSE;
-}
-
-uno::Any SAL_CALL ScEmptyEnumeration::nextElement() throw(container::NoSuchElementException,
-										lang::WrappedTargetException, uno::RuntimeException)
-{
-	ScUnoGuard aGuard;
-	return uno::Any();
-}
+//UNUSED2008-05  ScEmptyEnumeration::ScEmptyEnumeration()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  ScEmptyEnumeration::~ScEmptyEnumeration()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  // XEnumeration
+//UNUSED2008-05  
+//UNUSED2008-05  sal_Bool SAL_CALL ScEmptyEnumeration::hasMoreElements() throw(uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      ScUnoGuard aGuard;
+//UNUSED2008-05      return FALSE;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  uno::Any SAL_CALL ScEmptyEnumeration::nextElement() throw(container::NoSuchElementException,
+//UNUSED2008-05                                          lang::WrappedTargetException, uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      ScUnoGuard aGuard;
+//UNUSED2008-05      return uno::Any();
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------------
 
@@ -348,40 +348,40 @@
 
 //------------------------------------------------------------------------
 
-ScPrintSettingsObj::ScPrintSettingsObj()
-{
-}
-
-ScPrintSettingsObj::~ScPrintSettingsObj()
-{
-}
-
-// XPropertySet
-
-uno::Reference<beans::XPropertySetInfo> SAL_CALL ScPrintSettingsObj::getPropertySetInfo()
-														throw(uno::RuntimeException)
-{
-	return NULL;
-}
-
-void SAL_CALL ScPrintSettingsObj::setPropertyValue(
-                        const rtl::OUString& /* aPropertyName */, const uno::Any& /* aValue */ )
-				throw(beans::UnknownPropertyException, beans::PropertyVetoException,
-						lang::IllegalArgumentException, lang::WrappedTargetException,
-						uno::RuntimeException)
-{
-	//!	later...
-}
-
-uno::Any SAL_CALL ScPrintSettingsObj::getPropertyValue( const rtl::OUString& /* aPropertyName */ )
-				throw(beans::UnknownPropertyException, lang::WrappedTargetException,
-						uno::RuntimeException)
-{
-	//!	later...
-	return uno::Any();
-}
-
-SC_IMPL_DUMMY_PROPERTY_LISTENER( ScPrintSettingsObj )
+//UNUSED2008-05  ScPrintSettingsObj::ScPrintSettingsObj()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  ScPrintSettingsObj::~ScPrintSettingsObj()
+//UNUSED2008-05  {
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  // XPropertySet
+//UNUSED2008-05  
+//UNUSED2008-05  uno::Reference<beans::XPropertySetInfo> SAL_CALL ScPrintSettingsObj::getPropertySetInfo()
+//UNUSED2008-05                                                          throw(uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      return NULL;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void SAL_CALL ScPrintSettingsObj::setPropertyValue(
+//UNUSED2008-05                          const rtl::OUString& /* aPropertyName */, const uno::Any& /* aValue */ )
+//UNUSED2008-05                  throw(beans::UnknownPropertyException, beans::PropertyVetoException,
+//UNUSED2008-05                          lang::IllegalArgumentException, lang::WrappedTargetException,
+//UNUSED2008-05                          uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      //! later...
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  uno::Any SAL_CALL ScPrintSettingsObj::getPropertyValue( const rtl::OUString& /* aPropertyName */ )
+//UNUSED2008-05                  throw(beans::UnknownPropertyException, lang::WrappedTargetException,
+//UNUSED2008-05                          uno::RuntimeException)
+//UNUSED2008-05  {
+//UNUSED2008-05      //! later...
+//UNUSED2008-05      return uno::Any();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  SC_IMPL_DUMMY_PROPERTY_LISTENER( ScPrintSettingsObj )
 
 
 //------------------------------------------------------------------------
Index: sc/source/ui/unoobj/servuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/servuno.cxx,v
retrieving revision 1.17
retrieving revision 1.17.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.17 -r1.17.32.2
--- sc/source/ui/unoobj/servuno.cxx	11 Apr 2008 00:43:36 -0000	1.17
+++ sc/source/ui/unoobj/servuno.cxx	12 May 2008 15:57:01 -0000	1.17.32.2
@@ -174,13 +174,13 @@
 
 //	alles static
 
-String ScServiceProvider::GetProviderName(sal_uInt16 nObjectType)
-{
-	String sRet;
-	if (nObjectType < SC_SERVICE_COUNT)
-		sRet = String::CreateFromAscii( aProvNames[nObjectType] );
-	return sRet;
-}
+//UNUSED2008-05  String ScServiceProvider::GetProviderName(sal_uInt16 nObjectType)
+//UNUSED2008-05  {
+//UNUSED2008-05      String sRet;
+//UNUSED2008-05      if (nObjectType < SC_SERVICE_COUNT)
+//UNUSED2008-05          sRet = String::CreateFromAscii( aProvNames[nObjectType] );
+//UNUSED2008-05      return sRet;
+//UNUSED2008-05  }
 
 sal_uInt16 ScServiceProvider::GetProviderType(const String& rServiceName)
 {
Index: sc/source/ui/unoobj/shapeuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/shapeuno.cxx,v
retrieving revision 1.21
retrieving revision 1.21.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.21 -r1.21.32.1
--- sc/source/ui/unoobj/shapeuno.cxx	11 Apr 2008 00:43:52 -0000	1.21
+++ sc/source/ui/unoobj/shapeuno.cxx	8 May 2008 21:46:17 -0000	1.21.32.1
@@ -241,17 +241,6 @@
 	return mxPropSetInfo;
 }
 
-ScDocument* lcl_GetDocument( SdrObject* pObj )
-{
-	if( pObj )
-	{
-		ScDrawLayer* pModel = (ScDrawLayer*)pObj->GetModel();
-		if ( pModel )
-			return pModel->GetDocument();
-	}
-	return NULL;
-}
-
 BOOL lcl_GetPageNum( SdrPage* pPage, SdrModel& rModel, SCTAB& rNum )
 {
 	USHORT nCount = rModel.GetPageCount();
Index: sc/source/ui/unoobj/styleuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/styleuno.cxx,v
retrieving revision 1.43
retrieving revision 1.43.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.43 -r1.43.32.2
--- sc/source/ui/unoobj/styleuno.cxx	11 Apr 2008 00:44:22 -0000	1.43
+++ sc/source/ui/unoobj/styleuno.cxx	12 May 2008 15:57:01 -0000	1.43.32.2
@@ -1014,12 +1014,12 @@
 
 //	Default-ctor wird fuer die Reflection gebraucht
 
-ScStyleObj::ScStyleObj() :
-	aPropSet( lcl_GetCellStyleMap() ),
-	pDocShell( NULL ),
-	eFamily( SFX_STYLE_FAMILY_PARA )
-{
-}
+//UNUSED2008-05  ScStyleObj::ScStyleObj() :
+//UNUSED2008-05  aPropSet( lcl_GetCellStyleMap() ),
+//UNUSED2008-05  pDocShell( NULL ),
+//UNUSED2008-05  eFamily( SFX_STYLE_FAMILY_PARA )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScStyleObj::ScStyleObj(ScDocShell* pDocSh, SfxStyleFamily eFam, const String& rName) :
 	aPropSet( (eFam == SFX_STYLE_FAMILY_PARA) ? lcl_GetCellStyleMap() : lcl_GetPageStyleMap() ),
Index: sc/source/ui/unoobj/textuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/textuno.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.1
--- sc/source/ui/unoobj/textuno.cxx	11 Apr 2008 00:44:52 -0000	1.25
+++ sc/source/ui/unoobj/textuno.cxx	9 May 2008 16:11:52 -0000	1.25.32.1
@@ -111,14 +111,6 @@
 
 //------------------------------------------------------------------------
 
-ScHeaderFooterContentObj::ScHeaderFooterContentObj() :
-	pLeftText	( NULL ),
-	pCenterText	( NULL ),
-	pRightText	( NULL )
-{
-	//	fuer getReflection
-}
-
 ScHeaderFooterContentObj::ScHeaderFooterContentObj( const EditTextObject* pLeft,
 													const EditTextObject* pCenter,
 													const EditTextObject* pRight ) :
@@ -936,15 +928,6 @@
 {
 }
 
-void ScEditEngineTextObj::SetText( const String& rStr )
-{
-	GetEditEngine()->SetText( rStr );
-
-	ESelection aSel;
-	::GetSelection( aSel, GetEditSource()->GetTextForwarder() );
-	SetSelection( aSel );
-}
-
 void ScEditEngineTextObj::SetText( const EditTextObject& rTextObject )
 {
 	GetEditEngine()->SetText( rTextObject );
Index: sc/source/ui/unoobj/viewuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/viewuno.cxx,v
retrieving revision 1.37
retrieving revision 1.37.24.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.37 -r1.37.24.2
--- sc/source/ui/unoobj/viewuno.cxx	18 Apr 2008 11:39:11 -0000	1.37
+++ sc/source/ui/unoobj/viewuno.cxx	12 May 2008 15:57:01 -0000	1.37.24.2
@@ -462,15 +462,15 @@
 
 //	Default-ctor wird fuer SMART_REFLECTION_IMPLEMENTATION gebraucht
 
-ScTabViewObj::ScTabViewObj() :
-	ScViewPaneBase( NULL, SC_VIEWPANE_ACTIVE ),
-	SfxBaseController( NULL ),
-	aPropSet( lcl_GetViewOptPropertyMap() ),
-	aMouseClickHandlers( 0 ),
-	aActivationListeners( 0 ),
-	bDrawSelModeSet(sal_False)
-{
-}
+//UNUSED2008-05  ScTabViewObj::ScTabViewObj() :
+//UNUSED2008-05  ScViewPaneBase( NULL, SC_VIEWPANE_ACTIVE ),
+//UNUSED2008-05  SfxBaseController( NULL ),
+//UNUSED2008-05  aPropSet( lcl_GetViewOptPropertyMap() ),
+//UNUSED2008-05  aMouseClickHandlers( 0 ),
+//UNUSED2008-05  aActivationListeners( 0 ),
+//UNUSED2008-05  bDrawSelModeSet(sal_False)
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScTabViewObj::ScTabViewObj( ScTabViewShell* pViewSh ) :
 	ScViewPaneBase( pViewSh, SC_VIEWPANE_ACTIVE ),
Index: sc/source/ui/vba/vbahelper.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/vba/vbahelper.cxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/ui/vba/vbahelper.cxx	11 Apr 2008 01:02:33 -0000	1.5
+++ sc/source/ui/vba/vbahelper.cxx	9 May 2008 00:56:57 -0000	1.5.32.1
@@ -278,22 +278,6 @@
 
 }
 
-bool
-isRangeShortCut( const ::rtl::OUString& sParam )
-{
-        // for a ShortCutRange param, I'd expect the first letter to be
-        //[A-Z] and the last letter to be a digit 0-9 e.g A10, [A1:A10] etc.
-        ::rtl::OString sStr = rtl::OUStringToOString( sParam,
-                RTL_TEXTENCODING_UTF8 );
-        const sal_Char* pFirst = (const sal_Char*)sStr;
-        const sal_Char* pLast = pFirst + ( sStr.getLength() - 1 );
-        if ( (( *pFirst >= 'A' && *pFirst <= 'Z' ) || ( *pFirst >= 'a' && *pFirst <= 'Z' ) )  )
-                if ( ( *pLast >= '0' ) && ( *pLast <= '9' ) )
-                        return true;
-
-        return false;
-}
-
  uno::Reference< frame::XModel > 
 getCurrentDocument() throw (uno::RuntimeException)
 {
Index: sc/source/ui/vba/vbahelper.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/vba/vbahelper.hxx,v
retrieving revision 1.5
retrieving revision 1.5.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.32.1
--- sc/source/ui/vba/vbahelper.hxx	11 Apr 2008 01:02:47 -0000	1.5
+++ sc/source/ui/vba/vbahelper.hxx	9 May 2008 00:56:57 -0000	1.5.32.1
@@ -64,7 +64,6 @@
 		void implnPaste();
 		void implnCut();
 		void implnPasteSpecial(sal_uInt16 nFlags,sal_uInt16 nFunction,sal_Bool bSkipEmpty, sal_Bool bTranspose);
-		bool isRangeShortCut( const ::rtl::OUString& sParam );
 		css::uno::Reference< css::frame::XModel >
 			getCurrentDocument() throw (css::uno::RuntimeException);
 		ScTabViewShell* getBestViewShell( css::uno::Reference< css::frame::XModel>& xModel ) ;
Index: sc/source/ui/vba/vbarange.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/vba/vbarange.cxx,v
retrieving revision 1.8
retrieving revision 1.8.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.8 -r1.8.30.1
--- sc/source/ui/vba/vbarange.cxx	11 Apr 2008 01:15:15 -0000	1.8
+++ sc/source/ui/vba/vbarange.cxx	8 May 2008 21:46:17 -0000	1.8.30.1
@@ -171,7 +171,6 @@
 //    * 1 inch = 72 points = 1440 twips
 //    * 1 cm = 567 twips
 double lcl_hmmToPoints( double nVal ) { return ( (double)((nVal /1000 ) * 567 ) / 20 ); }
-double lcl_pointsToHmm( double nVal ) { return (double)( ( nVal * 20 ) / 567 ) * 1000; }
 
 static const sal_Int16 supportedIndexTable[] = {  excel::XlBordersIndex::xlEdgeLeft, excel::XlBordersIndex::xlEdgeTop, excel::XlBordersIndex::xlEdgeBottom, excel::XlBordersIndex::xlEdgeRight, excel::XlBordersIndex::xlDiagonalDown, excel::XlBordersIndex::xlDiagonalUp, excel::XlBordersIndex::xlInsideVertical, excel::XlBordersIndex::xlInsideHorizontal };
 
@@ -2590,19 +2589,6 @@
 	}	
 }
 
-rtl::OUString lcl_replaceAll( const rtl::OUString& rString, rtl::OUString sWhat, rtl::OUString sWith )
-{
-	rtl::OUString sString( rString );
-	sal_Int32 offset = 0;
-	sal_Int32 nWithLen = sWith.getLength();
-	while ((offset = sString.indexOf(sWhat )) >= 0) 
-	{
-		sString = sString.replaceAt(offset, nWithLen, sWith);
-		offset += nWithLen;
-	}
-	return sString;
-}
-
 ::sal_Bool SAL_CALL 
 ScVbaRange::Replace( const ::rtl::OUString& What, const ::rtl::OUString& Replacement, const uno::Any& LookAt, const uno::Any& SearchOrder, const uno::Any& MatchCase, const uno::Any& MatchByte, const uno::Any& SearchFormat, const uno::Any& ReplaceFormat  ) throw (uno::RuntimeException)
 {
Index: sc/source/ui/vba/vbashapes.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/vba/vbashapes.cxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/source/ui/vba/vbashapes.cxx	11 Apr 2008 01:17:46 -0000	1.3
+++ sc/source/ui/vba/vbashapes.cxx	8 May 2008 21:46:17 -0000	1.3.32.1
@@ -382,6 +382,8 @@
     return sName;
 }
 
+#if 0
+//TODO helperapi using a writer document
 awt::Point
 calculateTopLeftMargin( uno::Reference< vba::XHelperInterface > xDocument )
 {
@@ -389,3 +391,4 @@
     uno::Reference< frame::XModel > xModel( xDocument, uno::UNO_QUERY_THROW );
     return awt::Point();
 }
+#endif
Index: sc/source/ui/vba/vbashapes.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/vba/vbashapes.hxx,v
retrieving revision 1.3
retrieving revision 1.3.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.3 -r1.3.32.1
--- sc/source/ui/vba/vbashapes.hxx	11 Apr 2008 01:18:01 -0000	1.3
+++ sc/source/ui/vba/vbashapes.hxx	8 May 2008 21:46:17 -0000	1.3.32.1
@@ -56,7 +56,8 @@
     css::uno::Any AddRectangle( sal_Int32 startX, sal_Int32 startY, sal_Int32 nLineWidth, sal_Int32 nLineHeight, css::uno::Any aRange ) throw (css::uno::RuntimeException);
     css::uno::Any AddEllipse( sal_Int32 startX, sal_Int32 startY, sal_Int32 nLineWidth, sal_Int32 nLineHeight, css::uno::Any aRange ) throw (css::uno::RuntimeException);
     rtl::OUString createName( rtl::OUString sName );
-    css::awt::Point calculateTopLeftMargin( css::uno::Reference< oo::vba::XHelperInterface > xDocument );
+    //TODO helperapi using a writer document
+    //css::awt::Point calculateTopLeftMargin( css::uno::Reference< oo::vba::XHelperInterface > xDocument );
     
 public:
     ScVbaShapes( const css::uno::Reference< oo::vba::XHelperInterface >& xParent, const css::uno::Reference< css::uno::XComponentContext >& xContext, const css::uno::Reference< css::container::XIndexAccess > xShapes );
Index: sc/source/ui/view/cellsh2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/cellsh2.cxx,v
retrieving revision 1.34
retrieving revision 1.34.24.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.24.1
--- sc/source/ui/view/cellsh2.cxx	18 Apr 2008 11:42:04 -0000	1.34
+++ sc/source/ui/view/cellsh2.cxx	13 May 2008 00:33:46 -0000	1.34.24.1
@@ -1094,6 +1094,7 @@
 							bOk = pDBData->HasQueryParam() ||
 								  pDBData->HasSortParam() ||
 								  pDBData->HasSubTotalParam();
+#if OLD_PIVOT_IMPLEMENTATION
 							if (!bOk)
 							{
 								//	Pivottabelle mit den Daten als Quellbereich ?
@@ -1108,6 +1109,7 @@
 										bOk = TRUE;
 								}
 							}
+#endif
 						}
 					}
 					if (!bOk)
Index: sc/source/ui/view/dbfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/dbfunc.cxx,v
retrieving revision 1.15
retrieving revision 1.15.24.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.24.1
--- sc/source/ui/view/dbfunc.cxx	18 Apr 2008 11:42:34 -0000	1.15
+++ sc/source/ui/view/dbfunc.cxx	13 May 2008 14:34:14 -0000	1.15.24.1
@@ -60,10 +60,10 @@
 {
 }
 
-ScDBFunc::ScDBFunc( Window* pParent, const ScDBFunc& rDBFunc, ScTabViewShell* pViewShell ) :
-	ScViewFunc( pParent, rDBFunc, pViewShell )
-{
-}
+//UNUSED2008-05  ScDBFunc::ScDBFunc( Window* pParent, const ScDBFunc& rDBFunc, ScTabViewShell* pViewShell ) :
+//UNUSED2008-05      ScViewFunc( pParent, rDBFunc, pViewShell )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScDBFunc::~ScDBFunc()
 {
Index: sc/source/ui/view/drawvie3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/drawvie3.cxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/source/ui/view/drawvie3.cxx	11 Apr 2008 01:29:04 -0000	1.16
+++ sc/source/ui/view/drawvie3.cxx	9 May 2008 16:11:52 -0000	1.16.32.1
@@ -75,26 +75,6 @@
 	Construct();
 }
 
-ScDrawView::ScDrawView( OutputDevice* pOut, ScDocument* pDocument, SCTAB nTable ) :
-	FmFormView( pDocument->GetDrawLayer(), pOut ),
-	pViewData( NULL ),
-	pDev( pOut ),
-	pDoc( pDocument ),
-	nTab( nTable ),
-	pDropMarker( NULL ),
-	pDropMarkObj( NULL ),
-	bInConstruct( TRUE )
-	//HMHbDisableHdl( FALSE )
-{
-	// #i73602# Use default from the configuration
-	SetBufferedOverlayAllowed(getOptionsDrawinglayer().IsOverlayBuffer_Calc());
-
-	// #i74769#, #i75172# Use default from the configuration
-	SetBufferedOutputAllowed(getOptionsDrawinglayer().IsPaintBuffer_Calc());
-
-	Construct();
-}
-
 // Verankerung setzen
 
 void ScDrawView::SetAnchor( ScAnchorType eType )
Index: sc/source/ui/view/drawview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/drawview.cxx,v
retrieving revision 1.50
retrieving revision 1.50.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.50 -r1.50.32.1
--- sc/source/ui/view/drawview.cxx	11 Apr 2008 01:29:33 -0000	1.50
+++ sc/source/ui/view/drawview.cxx	13 May 2008 14:34:14 -0000	1.50.32.1
@@ -728,22 +728,22 @@
 	return ( pFound != NULL );
 }
 
-String ScDrawView::GetSelectedChartName() const
-{
-	//	used for modifying a chart's data area - PersistName must always be used
-	//	(as in ScDocument::FindChartData and UpdateChartArea)
-
-	const SdrMarkList& rMarkList = GetMarkedObjectList();
-	if (rMarkList.GetMarkCount() == 1)
-	{
-		SdrObject* pObj = rMarkList.GetMark(0)->GetMarkedSdrObj();
-		if (pObj->GetObjIdentifier() == OBJ_OLE2)
-			if ( pDoc->IsChart(pObj) )
-				return static_cast<SdrOle2Obj*>(pObj)->GetPersistName();
-	}
-
-	return EMPTY_STRING;		// nichts gefunden
-}
+//UNUSED2008-05  String ScDrawView::GetSelectedChartName() const
+//UNUSED2008-05  {
+//UNUSED2008-05      //  used for modifying a chart's data area - PersistName must always be used
+//UNUSED2008-05      //  (as in ScDocument::FindChartData and UpdateChartArea)
+//UNUSED2008-05  
+//UNUSED2008-05      const SdrMarkList& rMarkList = GetMarkedObjectList();
+//UNUSED2008-05      if (rMarkList.GetMarkCount() == 1)
+//UNUSED2008-05      {
+//UNUSED2008-05          SdrObject* pObj = rMarkList.GetMark(0)->GetMarkedSdrObj();
+//UNUSED2008-05          if (pObj->GetObjIdentifier() == OBJ_OLE2)
+//UNUSED2008-05              if ( pDoc->IsChart(pObj) )
+//UNUSED2008-05                  return static_cast<SdrOle2Obj*>(pObj)->GetPersistName();
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      return EMPTY_STRING;        // nichts gefunden
+//UNUSED2008-05  }
 
 FASTBOOL ScDrawView::InsertObjectSafe(SdrObject* pObj, SdrPageView& rPV, ULONG nOptions)
 {
Index: sc/source/ui/view/formatsh.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/formatsh.cxx,v
retrieving revision 1.41
retrieving revision 1.41.24.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.41 -r1.41.24.1
--- sc/source/ui/view/formatsh.cxx	18 Apr 2008 11:45:48 -0000	1.41
+++ sc/source/ui/view/formatsh.cxx	9 May 2008 16:11:52 -0000	1.41.24.1
@@ -1971,15 +1971,6 @@
 	}
 }
 
-void ScFormatShell::ExecBckCol( SfxRequest& rReq )
-{
-	ExecuteAttr( rReq );
-}
-
-void ScFormatShell::GetBckColState( SfxItemSet& rSet )
-{
-	GetAttrState( rSet );
-}
 void ScFormatShell::GetNumFormatState( SfxItemSet& rSet )
 {
 	ScTabViewShell*	pTabViewShell  	= GetViewData()->GetViewShell();
Index: sc/source/ui/view/gridwin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin.cxx,v
retrieving revision 1.94
retrieving revision 1.94.20.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.94 -r1.94.20.1
--- sc/source/ui/view/gridwin.cxx	18 Apr 2008 11:47:50 -0000	1.94
+++ sc/source/ui/view/gridwin.cxx	13 May 2008 00:33:46 -0000	1.94.20.1
@@ -413,7 +413,9 @@
 			bEEMouse( FALSE ),
 			nMouseStatus( SC_GM_NONE ),
             nNestedButtonState( SC_NESTEDBUTTON_NONE ),
+#if OLD_PIVOT_IMPLEMENTATION
 			bPivotMouse( FALSE ),
+#endif
 			bDPMouse( FALSE ),
 			bRFMouse( FALSE ),
 			nPagebreakMouse( SC_PD_NONE ),
@@ -1818,12 +1820,14 @@
 		return;
 	}
 
+#if OLD_PIVOT_IMPLEMENTATION
 	if (bPivotMouse)
 	{
 		PivotMouseButtonUp( rMEvt );
 		bPivotMouse = FALSE;
 		return;
 	}
+#endif
 
 	if (bDPMouse)
 	{
@@ -2211,11 +2215,13 @@
         return;
 	}
 
+#if OLD_PIVOT_IMPLEMENTATION
 	if (bPivotMouse)
 	{
 		PivotMouseMove( rMEvt );
 		return;
 	}
+#endif
 
 	if (bDPMouse)
 	{
@@ -2425,8 +2431,10 @@
 	{
 		if (!pViewData->GetView()->IsInActivatePart())
 		{
+#if OLD_PIVOT_IMPLEMENTATION
 			if (bPivotMouse)
 				bPivotMouse = FALSE;			// gezeichnet wird per bDragRect
+#endif
 			if (bDPMouse)
 				bDPMouse = FALSE;				// gezeichnet wird per bDragRect
 			if (bDragRect)
Index: sc/source/ui/view/gridwin2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin2.cxx,v
retrieving revision 1.16
retrieving revision 1.16.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.1
--- sc/source/ui/view/gridwin2.cxx	11 Apr 2008 01:31:15 -0000	1.16
+++ sc/source/ui/view/gridwin2.cxx	13 May 2008 00:33:46 -0000	1.16.32.1
@@ -102,11 +102,12 @@
 	ScDocument* pDoc = pViewData->GetDocument();
 	SCTAB nTab = pViewData->GetTabNo();
 
+	ScDPObject*	pDPObj	= pDoc->GetDPAtCursor(nCol, nRow, nTab);
+
+#if OLD_PIVOT_IMPLEMENTATION
 	ScPivotCollection* pPivotCollection = pDoc->GetPivotCollection();
 	ScPivot* pPivot = pPivotCollection->GetPivotAtCursor(nCol, nRow, nTab);
 
-	ScDPObject*	pDPObj	= pDoc->GetDPAtCursor(nCol, nRow, nTab);
-
 	if (pPivot)				// alte Pivottabellen
 	{
 		if (pPivot->IsFilterAtCursor(nCol, nRow, nTab))
@@ -186,7 +187,9 @@
 			}
 		}
 	}
-	else if (pDPObj)
+#endif
+
+	if (pDPObj)
 	{
 		USHORT nOrient = sheet::DataPilotFieldOrientation_HIDDEN;
 		ScAddress aPos( nCol, nRow, nTab );
@@ -253,6 +256,7 @@
 	}
 }
 
+#if OLD_PIVOT_IMPLEMENTATION
 void ScGridWindow::DoPivotDrop( BOOL bDelete, BOOL bToCols, SCSIZE nDestPos )
 {
 	if ( nPivotField == PIVOT_DATA_FIELD && bDelete )
@@ -609,6 +613,7 @@
 	PivotTestMouse( rMEvt, FALSE );
 	SetPointer( Pointer( POINTER_ARROW ) );
 }
+#endif
 
 // -----------------------------------------------------------------------
 //
Index: sc/source/ui/view/gridwin3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin3.cxx,v
retrieving revision 1.20
retrieving revision 1.20.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.20 -r1.20.32.1
--- sc/source/ui/view/gridwin3.cxx	11 Apr 2008 01:31:31 -0000	1.20
+++ sc/source/ui/view/gridwin3.cxx	9 May 2008 16:11:52 -0000	1.20.32.1
@@ -371,79 +371,6 @@
 	}
 }
 
-void ScGridWindow::OutlinerViewPaint( const Rectangle& rRect )
-{
-	ScDrawView* pDrView = pViewData->GetView()->GetScDrawView();
-	if (pDrView && pDrView->GetTextEditOutlinerView())
-	{
-		Outliner* pOut = pDrView->GetTextEditOutliner();
-		ULONG nViewCount = pOut ? pOut->GetViewCount() : 0;
-		for (ULONG nView=0; nView<nViewCount; nView++)
-		{
-			OutlinerView* pOlView = pOut->GetView(nView);
-
-			if (pOlView && pOlView->GetWindow() == this)
-			{
-				BOOL bFrame = FALSE;
-				Rectangle aEditRect = pOlView->GetOutputArea();
-				SdrObject* pEditObj = GetEditObject();
-				if (pEditObj && pEditObj->ISA(SdrTextObj))
-				{
-					SdrTextObj* pTextObj = (SdrTextObj*)pEditObj;
-					Rectangle aMinRect;
-	                pTextObj->TakeTextEditArea(NULL,NULL,NULL,&aMinRect); // PageView Offset ist 0
-	                aEditRect.Union(aMinRect);
-                    bFrame = sal::static_int_cast<BOOL>( pTextObj->IsTextFrame() );
-				}
-
-				if ( aEditRect.IsOver( rRect ) )
-				{
-					ULONG nOldDrawMode = GetDrawMode();
-					if ( Application::GetSettings().GetStyleSettings().GetHighContrastMode() )
-					{
-						SetDrawMode( nOldDrawMode | DRAWMODE_SETTINGSLINE | DRAWMODE_SETTINGSFILL |
-											DRAWMODE_SETTINGSTEXT | DRAWMODE_SETTINGSGRADIENT );
-					}
-
-					Rectangle aEffRect = rRect.GetIntersection( aEditRect );
-					if (bFrame)
-					{
-						if ( pEditObj->GetLayer() ==SC_LAYER_INTERN )	// cell note?
-						{
-							//	#78828# always draw the edit background in case notes overlap
-							SetFillColor( pOlView->GetBackgroundColor() );
-							SetLineColor();
-							DrawRect( aEffRect );
-						}
-
-						//	DrawLayer mit dem Text-Rechteck zeichnet nur die Outliner-View
-						//	und den Text-Rahmen (an den kommt man sonst von aussen nicht heran).
-
-						SdrPageView* pPV = pDrView->GetSdrPageView();
-						DBG_ASSERT(pPV, "keine PageView");
-						if (pPV)
-						{
-							SdrLayerID nLayer = pEditObj ? pEditObj->GetLayer() : SC_LAYER_FRONT;
-							// Region aDrawRegion(aEffRect);
-							// pPV->DrawLayer( nLayer, aDrawRegion, this );
-							pPV->DrawLayer( nLayer, this );
-						}
-					}
-					else
-					{
-						SetFillColor( pOlView->GetBackgroundColor() );
-						SetLineColor();
-						DrawRect( aEffRect );
-						pOlView->Paint( aEffRect );
-					}
-
-					SetDrawMode( nOldDrawMode );
-				}
-			}
-		}
-	}
-}
-
 SdrObject* ScGridWindow::GetEditObject()
 {
 	ScDrawView* pDrView = pViewData->GetView()->GetScDrawView();
Index: sc/source/ui/view/gridwin4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin4.cxx,v
retrieving revision 1.39
retrieving revision 1.39.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.39 -r1.39.32.2
--- sc/source/ui/view/gridwin4.cxx	11 Apr 2008 01:31:46 -0000	1.39
+++ sc/source/ui/view/gridwin4.cxx	13 May 2008 14:34:15 -0000	1.39.32.2
@@ -1182,63 +1182,6 @@
 	}
 }
 
-void ScGridWindow::DrawRefMark( SCCOL nRefStartX, SCROW nRefStartY,
-									SCCOL nRefEndX, SCROW nRefEndY,
-									const Color& rColor, BOOL bHandle )
-{
-	PutInOrder( nRefStartX, nRefEndX );
-	PutInOrder( nRefStartY, nRefEndY );
-
-	SCTAB nTab = pViewData->GetTabNo();
-	ScDocument* pDoc = pViewData->GetDocument();
-	if ( nRefStartX == nRefEndX && nRefStartY == nRefEndY )
-		pDoc->ExtendMerge( nRefStartX, nRefStartY, nRefEndX, nRefEndY, nTab );
-
-	MapMode aOld = GetMapMode();
-	SetMapMode(MAP_PIXEL);
-
-	SCCOL nCurX = pViewData->GetCurX();
-	SCROW nCurY = pViewData->GetCurY();
-	BOOL bHide = ( nCurX+1 >= nRefStartX && nCurX <= nRefEndX+1 &&
-				   nCurY+1 >= nRefStartY && nCurY <= nRefEndY+1 );
-
-	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
-	long nLayoutSign = bLayoutRTL ? -1 : 1;
-
-	Point aStartPos = pViewData->GetScrPos( nRefStartX, nRefStartY, eWhich, TRUE );
-	Point aEndPos = pViewData->GetScrPos( nRefEndX+1, nRefEndY+1, eWhich, TRUE );
-	aEndPos.X() -= 2 * nLayoutSign;
-	aEndPos.Y() -= 2;	// don't paint over the grid
-
-	//	begrenzen um Ueberlaeufe mit Paint-Fehlern zu vermeiden
-	long nMinY = -10;
-	long nMaxY = GetOutputSizePixel().Height() + 10;	// mit Abstand fuer Handle
-	if (aStartPos.Y() < nMinY) aStartPos.Y() = nMinY;
-	if (aStartPos.Y() > nMaxY) aStartPos.Y() = nMaxY;
-	if (aEndPos.Y() > nMaxY) aEndPos.Y() = nMaxY;
-	if (aEndPos.Y() < nMinY) aEndPos.Y() = nMinY;
-
-	if (bHide)
-		HideCursor();
-
-	SetLineColor( rColor );
-	SetFillColor();
-	DrawRect( Rectangle( aStartPos, aEndPos ) );
-
-	if ( bHandle )
-	{
-		SetLineColor();
-		SetFillColor( rColor );
-		DrawRect( Rectangle( aEndPos.X()-3*nLayoutSign, aEndPos.Y()-3,
-								aEndPos.X()+nLayoutSign, aEndPos.Y()+1 ) );
-	}
-
-	if (bHide)
-		ShowCursor();
-
-	SetMapMode(aOld);
-}
-
 void ScGridWindow::DrawButtons( SCCOL nX1, SCROW /*nY1*/, SCCOL nX2, SCROW /*nY2*/, ScTableInfo& rTabInfo, OutputDevice* pContentDev )
 {
     aComboButton.SetOutputDevice( pContentDev );
@@ -1866,72 +1809,72 @@
 
 // -------------------------------------------------------------------------
 
-void ScGridWindow::DrawDragRect( SCCOL nX1, SCROW nY1, SCCOL nX2, SCROW nY2 )
-{
-	if ( nX2 < pViewData->GetPosX(eHWhich) || nY2 < pViewData->GetPosY(eVWhich) )
-		return;
-
-	Update();			// wegen XOR
-
-	MapMode aOld = GetMapMode(); SetMapMode(MAP_PIXEL);
-
-	SCTAB nTab = pViewData->GetTabNo();
-
-	SCCOL nPosX = pViewData->GetPosX(WhichH(eWhich));
-	SCROW nPosY = pViewData->GetPosY(WhichV(eWhich));
-	if (nX1 < nPosX) nX1 = nPosX;
-	if (nX2 < nPosX) nX2 = nPosX;
-	if (nY1 < nPosY) nY1 = nPosY;
-	if (nY2 < nPosY) nY2 = nPosY;
-
-	Point aScrPos( pViewData->GetScrPos( nX1, nY1, eWhich ) );
-
-	long nSizeXPix=0;
-	long nSizeYPix=0;
-	ScDocument* pDoc = pViewData->GetDocument();
-	double nPPTX = pViewData->GetPPTX();
-	double nPPTY = pViewData->GetPPTY();
-	SCCOLROW i;
-
-	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
-	long nLayoutSign = bLayoutRTL ? -1 : 1;
-
-    if (ValidCol(nX2) && nX2>=nX1)
-        for (i=nX1; i<=nX2; i++)
-            nSizeXPix += ScViewData::ToPixel( pDoc->GetColWidth( static_cast<SCCOL>(i), nTab ), nPPTX );
-    else
-    {
-        aScrPos.X() -= nLayoutSign;
-        nSizeXPix   += 2;
-    }
-
-	if (ValidRow(nY2) && nY2>=nY1)
-		for (i=nY1; i<=nY2; i++)
-			nSizeYPix += ScViewData::ToPixel( pDoc->GetRowHeight( i, nTab ), nPPTY );
-	else
-	{
-		aScrPos.Y() -= 1;
-		nSizeYPix   += 2;
-	}
-
-	aScrPos.X() -= 2 * nLayoutSign;
-	aScrPos.Y() -= 2;
-//	Rectangle aRect( aScrPos, Size( nSizeXPix + 3, nSizeYPix + 3 ) );
-	Rectangle aRect( aScrPos.X(), aScrPos.Y(),
-					 aScrPos.X() + ( nSizeXPix + 2 ) * nLayoutSign, aScrPos.Y() + nSizeYPix + 2 );
-	if ( bLayoutRTL )
-	{
-		aRect.Left() = aRect.Right();	// end position is left
-		aRect.Right() = aScrPos.X();
-	}
-
-	Invert(Rectangle( aRect.Left(), aRect.Top(), aRect.Left()+2, aRect.Bottom() ));
-	Invert(Rectangle( aRect.Right()-2, aRect.Top(), aRect.Right(), aRect.Bottom() ));
-	Invert(Rectangle( aRect.Left()+3, aRect.Top(), aRect.Right()-3, aRect.Top()+2 ));
-	Invert(Rectangle( aRect.Left()+3, aRect.Bottom()-2, aRect.Right()-3, aRect.Bottom() ));
-
-	SetMapMode(aOld);
-}
+//UNUSED2008-05  void ScGridWindow::DrawDragRect( SCCOL nX1, SCROW nY1, SCCOL nX2, SCROW nY2 )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( nX2 < pViewData->GetPosX(eHWhich) || nY2 < pViewData->GetPosY(eVWhich) )
+//UNUSED2008-05          return;
+//UNUSED2008-05  
+//UNUSED2008-05      Update();           // wegen XOR
+//UNUSED2008-05  
+//UNUSED2008-05      MapMode aOld = GetMapMode(); SetMapMode(MAP_PIXEL);
+//UNUSED2008-05  
+//UNUSED2008-05      SCTAB nTab = pViewData->GetTabNo();
+//UNUSED2008-05  
+//UNUSED2008-05      SCCOL nPosX = pViewData->GetPosX(WhichH(eWhich));
+//UNUSED2008-05      SCROW nPosY = pViewData->GetPosY(WhichV(eWhich));
+//UNUSED2008-05      if (nX1 < nPosX) nX1 = nPosX;
+//UNUSED2008-05      if (nX2 < nPosX) nX2 = nPosX;
+//UNUSED2008-05      if (nY1 < nPosY) nY1 = nPosY;
+//UNUSED2008-05      if (nY2 < nPosY) nY2 = nPosY;
+//UNUSED2008-05  
+//UNUSED2008-05      Point aScrPos( pViewData->GetScrPos( nX1, nY1, eWhich ) );
+//UNUSED2008-05  
+//UNUSED2008-05      long nSizeXPix=0;
+//UNUSED2008-05      long nSizeYPix=0;
+//UNUSED2008-05      ScDocument* pDoc = pViewData->GetDocument();
+//UNUSED2008-05      double nPPTX = pViewData->GetPPTX();
+//UNUSED2008-05      double nPPTY = pViewData->GetPPTY();
+//UNUSED2008-05      SCCOLROW i;
+//UNUSED2008-05  
+//UNUSED2008-05      BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
+//UNUSED2008-05      long nLayoutSign = bLayoutRTL ? -1 : 1;
+//UNUSED2008-05  
+//UNUSED2008-05      if (ValidCol(nX2) && nX2>=nX1)
+//UNUSED2008-05          for (i=nX1; i<=nX2; i++)
+//UNUSED2008-05              nSizeXPix += ScViewData::ToPixel( pDoc->GetColWidth( static_cast<SCCOL>(i), nTab ), nPPTX );
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          aScrPos.X() -= nLayoutSign;
+//UNUSED2008-05          nSizeXPix   += 2;
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      if (ValidRow(nY2) && nY2>=nY1)
+//UNUSED2008-05          for (i=nY1; i<=nY2; i++)
+//UNUSED2008-05              nSizeYPix += ScViewData::ToPixel( pDoc->GetRowHeight( i, nTab ), nPPTY );
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          aScrPos.Y() -= 1;
+//UNUSED2008-05          nSizeYPix   += 2;
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      aScrPos.X() -= 2 * nLayoutSign;
+//UNUSED2008-05      aScrPos.Y() -= 2;
+//UNUSED2008-05  //	Rectangle aRect( aScrPos, Size( nSizeXPix + 3, nSizeYPix + 3 ) );
+//UNUSED2008-05      Rectangle aRect( aScrPos.X(), aScrPos.Y(),
+//UNUSED2008-05                       aScrPos.X() + ( nSizeXPix + 2 ) * nLayoutSign, aScrPos.Y() + nSizeYPix + 2 );
+//UNUSED2008-05      if ( bLayoutRTL )
+//UNUSED2008-05      {
+//UNUSED2008-05          aRect.Left() = aRect.Right();   // end position is left
+//UNUSED2008-05          aRect.Right() = aScrPos.X();
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      Invert(Rectangle( aRect.Left(), aRect.Top(), aRect.Left()+2, aRect.Bottom() ));
+//UNUSED2008-05      Invert(Rectangle( aRect.Right()-2, aRect.Top(), aRect.Right(), aRect.Bottom() ));
+//UNUSED2008-05      Invert(Rectangle( aRect.Left()+3, aRect.Top(), aRect.Right()-3, aRect.Top()+2 ));
+//UNUSED2008-05      Invert(Rectangle( aRect.Left()+3, aRect.Bottom()-2, aRect.Right()-3, aRect.Bottom() ));
+//UNUSED2008-05  
+//UNUSED2008-05      SetMapMode(aOld);
+//UNUSED2008-05  }
 
 // -------------------------------------------------------------------------
 
Index: sc/source/ui/view/olinewin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/olinewin.cxx,v
retrieving revision 1.15
retrieving revision 1.15.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.15 -r1.15.32.1
--- sc/source/ui/view/olinewin.cxx	11 Apr 2008 01:33:48 -0000	1.15
+++ sc/source/ui/view/olinewin.cxx	9 May 2008 21:22:47 -0000	1.15.32.1
@@ -151,14 +151,6 @@
     ShowFocus();
 }
 
-void ScOutlineWindow::ScrollRel( long nEntryDiff )
-{
-    if ( mbHoriz )
-        Scroll( nEntryDiff, 0 );
-    else
-        Scroll( 0, nEntryDiff );
-}
-
 void ScOutlineWindow::ScrollRel( long nEntryDiff, long nEntryStart, long nEntryEnd )
 {
     Rectangle aRect( GetRectangle( 0, nEntryStart, GetOutputSizeLevel() - 1, nEntryEnd ) );
Index: sc/source/ui/view/output.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/output.cxx,v
retrieving revision 1.34
retrieving revision 1.34.30.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.34 -r1.34.30.3
--- sc/source/ui/view/output.cxx	11 Apr 2008 01:34:19 -0000	1.34
+++ sc/source/ui/view/output.cxx	13 May 2008 14:34:15 -0000	1.34.30.3
@@ -1146,11 +1146,6 @@
     return static_cast< size_t >( bRTL ? (nCellInfoLastX + 2 - nCellInfoX) : (nCellInfoX - nCellInfoFirstX) );
 }
 
-USHORT lclGetCellInfoXFromArrayCol( size_t nCol, USHORT nCellInfoFirstX, USHORT nCellInfoLastX, bool bRTL )
-{
-    return static_cast< USHORT >( bRTL ? (nCellInfoLastX + 2 - nCol) : (nCol + nCellInfoFirstX) );
-}
-
 void ScOutputData::DrawFrame()
 {
 	ULONG nOldDrawMode = pDev->GetDrawMode();
@@ -1691,81 +1686,6 @@
 
 //	Drucker
 
-void ScOutputData::DrawPageBorder( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY )
-{
-	PutInOrder( nStartX, nEndX );
-	PutInOrder( nStartY, nEndY );
-
-	if ( nStartX <= nX2 && nEndX >= nX1 &&
-		 nStartY <= nY2 && nEndY >= nY1 )
-	{
-		long nMinX = nScrX;
-		long nMinY = nScrY;
-		long nMaxX = nScrX+nScrW-1;
-		long nMaxY = nScrY+nScrH-1;
-		BOOL bTop    = FALSE;
-		BOOL bBottom = FALSE;
-		BOOL bLeft   = FALSE;
-		BOOL bRight	 = FALSE;
-
-		long nPosY = nScrY;
-		for (SCSIZE nArrY=1; nArrY+1<nArrCount; nArrY++)
-		{
-			SCROW nY = pRowInfo[nArrY].nRowNo;
-
-			if ( nY==nStartY )
-			{
-				nMinY = nPosY;
-				bTop = TRUE;
-			}
-
-			if ( nY==nEndY )
-			{
-//				nMaxY = nPosY + pRowInfo[nArrY].nHeight - 2;
-				nMaxY = nPosY + pRowInfo[nArrY].nHeight;
-				bBottom = TRUE;
-			}
-
-			nPosY += pRowInfo[nArrY].nHeight;
-		}
-
-		long nPosX = nScrX;
-		for (SCCOL nX=nX1; nX<=nX2; nX++)
-		{
-			if ( nX==nStartX )
-			{
-				nMinX = nPosX;
-				bLeft = TRUE;
-			}
-			if ( nX==nEndX )
-			{
-//				nMaxX = nPosX + pRowInfo[0].pCellInfo[nX+1].nWidth - 2;
-				nMaxX = nPosX + pRowInfo[0].pCellInfo[nX+1].nWidth;
-				bRight = TRUE;
-			}
-			nPosX += pRowInfo[0].pCellInfo[nX+1].nWidth;
-		}
-
-		pDev->SetLineColor( COL_BLACK );
-		if (bTop && bBottom && bLeft && bRight)
-		{
-			pDev->SetFillColor();
-			pDev->DrawRect( Rectangle( nMinX, nMinY, nMaxX, nMaxY ) );
-		}
-		else
-		{
-			if (bTop)
-				pDev->DrawLine( Point( nMinX,nMinY ), Point( nMaxX,nMinY ) );
-			if (bBottom)
-				pDev->DrawLine( Point( nMinX,nMaxY ), Point( nMaxX,nMaxY ) );
-			if (bLeft)
-				pDev->DrawLine( Point( nMinX,nMinY ), Point( nMinX,nMaxY ) );
-			if (bRight)
-				pDev->DrawLine( Point( nMaxX,nMinY ), Point( nMaxX,nMaxY ) );
-		}
-	}
-}
-
 PolyPolygon ScOutputData::GetChangedArea()
 {
 	PolyPolygon aPoly;
@@ -2403,64 +2323,6 @@
     }
 }
 
-long lcl_FindInList( const List& rPosList, const ScAddress &rPos )
-{
-	long nCount = rPosList.Count();
-	for (long i=0; i<nCount; i++)
-		if (*(ScAddress*)rPosList.GetObject(i) == rPos)
-			return i+1;
-
-	return 0;
-}
-
-void ScOutputData::PrintNoteMarks( const List& rPosList )
-{
-	Font aFont;
-	ScAutoFontColorMode eColorMode = bUseStyleColor ?
-										( bForceAutoColor ? SC_AUTOCOL_IGNOREFONT : SC_AUTOCOL_DISPLAY ) :
-										SC_AUTOCOL_PRINT;
-	((const ScPatternAttr&)pDoc->GetPool()->GetDefaultItem(ATTR_PATTERN)).GetFont(aFont, eColorMode);
-	aFont.SetSize( Size( 0, (long) ( 120 * nPPTY ) ) );			// 6 pt
-	pDev->SetFont( aFont );
-
-	String aStr;
-
-	long nPosY = nScrY;
-	for (SCSIZE nArrY=1; nArrY+1<nArrCount; nArrY++)
-	{
-		RowInfo* pThisRowInfo = &pRowInfo[nArrY];
-		if ( pThisRowInfo->bChanged )
-		{
-			long nPosX = nScrX;
-			for (SCCOL nX=nX1; nX<=nX2; nX++)
-			{
-				CellInfo* pInfo = &pThisRowInfo->pCellInfo[nX+1];
-				ScBaseCell* pCell = pInfo->pCell;
-				if ( pCell && pCell->GetNotePtr() )		// auch verdeckte wegen der Numerierung
-				{
-                    aStr = String::CreateFromInt32( lcl_FindInList( rPosList,
-                                ScAddress( nX, pThisRowInfo->nRowNo, nTab)));
-					long nMarkX = nPosX + pRowInfo[0].pCellInfo[nX+1].nWidth - 2 -
-									pDev->GetTextWidth(aStr);
-					pDev->DrawText( Point( nMarkX,nPosY ), aStr );
-				}
-
-				nPosX += pRowInfo[0].pCellInfo[nX+1].nWidth;
-			}
-		}
-		nPosY += pThisRowInfo->nHeight;
-	}
-}
-
-void ScOutputData::ConnectObject( const uno::Reference < embed::XEmbeddedObject >& rRef, SdrOle2Obj* pOleObj )
-{
-    if (rRef.is())
-	{
-        if ( rRef->getStatus( pOleObj->GetAspect() ) & embed::EmbedMisc::MS_EMBED_ACTIVATEWHENVISIBLE )
-			pViewShell->ConnectObject( pOleObj );
-	}
-}
-
 void ScOutputData::DrawClipMarks()
 {
 	if (!bAnyClipped)
Index: sc/source/ui/view/output2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/output2.cxx,v
retrieving revision 1.56
retrieving revision 1.56.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.56 -r1.56.32.3
--- sc/source/ui/view/output2.cxx	11 Apr 2008 01:34:35 -0000	1.56
+++ sc/source/ui/view/output2.cxx	9 May 2008 21:22:47 -0000	1.56.32.3
@@ -135,7 +135,6 @@
 	void		SetPatternSimple( const ScPatternAttr* pNew, const SfxItemSet* pSet );
 
 	BOOL		SetText( ScBaseCell* pCell );	// TRUE -> pOldPattern vergessen
-	void		ResetText();
 	void		SetHashText();
 	void		SetAutoText( const String& rAutoText );
 
@@ -164,7 +163,6 @@
 	BOOL	HasCondHeight() const	{ return pCondSet && SFX_ITEM_SET ==
 										pCondSet->GetItemState( ATTR_FONT_HEIGHT, TRUE ); }
 
-	BOOL	IsRightToLeftAttr() const;
     BOOL    HasEditCharacters() const;
 };
 
@@ -507,14 +505,6 @@
 	return bChanged;
 }
 
-void ScDrawStringsVars::ResetText()
-{
-	aString.Erase();
-	pLastCell = NULL;
-	aTextSize = Size(0,0);
-	nOriginalWidth = 0;
-}
-
 void ScDrawStringsVars::SetHashText()
 {
     SetAutoText( String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("###")) );
@@ -550,14 +540,6 @@
 	pLastCell = NULL;		// derselbe Text kann in der naechsten Zelle wieder passen
 }
 
-BOOL ScDrawStringsVars::IsRightToLeftAttr() const
-{
-	SvxFrameDirection eCellDir = (SvxFrameDirection)((const SvxFrameDirectionItem&)
-									pPattern->GetItem( ATTR_WRITINGDIR, pCondSet )).GetValue();
-	return ( eCellDir == FRMDIR_HORI_RIGHT_TOP ||
-			( eCellDir == FRMDIR_ENVIRONMENT && pOutput->nTabTextDirection == EE_HTEXTDIR_R2L ) );
-}
-
 BOOL ScDrawStringsVars::HasEditCharacters() const
 {
     static const sal_Unicode pChars[] =
@@ -846,31 +828,6 @@
 	}
 }
 
-BOOL lcl_IsValueDataAtPos( BOOL& bProgress, ScDocument* pDoc,
-		SCCOL nCol, SCROW nRow, SCTAB nTab )
-{
-	ScBaseCell* pCell;
-	pDoc->GetCell( nCol, nRow, nTab, pCell );
-	if ( pCell )
-	{
-		if ( pCell->GetCellType() == CELLTYPE_FORMULA )
-		{	// kein weiteres Interpret anstossen
-			ScFormulaCell* pFCell = (ScFormulaCell*) pCell;
-			if ( pFCell->IsRunning() )
-				return TRUE;
-			else
-			{
-				lcl_CreateInterpretProgress( bProgress, pDoc, pFCell );
-				return pFCell->HasValueData();
-			}
-		}
-		else
-			return pCell->HasValueData();
-	}
-	else
-		return FALSE;
-}
-
 inline BYTE GetScriptType( ScDocument* pDoc, ScBaseCell* pCell,
 							const ScPatternAttr* pPattern,
 							const SfxItemSet* pCondSet )
@@ -953,38 +910,6 @@
 	return TRUE;
 }
 
-long ScOutputData::GetAvailableWidth( SCCOL nX, SCROW nY, long nNeeded )
-{
-	//	get the pixel width that's available for the cell's text,
-	//	including cells outside of the current screen area
-
-	long nAvailable = (long) ( pDoc->GetColWidth( nX, nTab ) * nPPTX );		// cell itself
-
-	const ScMergeAttr* pMerge = (const ScMergeAttr*)pDoc->GetAttr( nX, nY, nTab, ATTR_MERGE );
-	if ( pMerge->IsMerged() )
-	{
-		//	for merged cells, allow only the merged area
-		SCCOL nCount = pMerge->GetColMerge();
-		for (SCCOL nAdd=1; nAdd<nCount; nAdd++)
-			nAvailable += (long) ( pDoc->GetColWidth( nX + nAdd, nTab ) * nPPTX );
-	}
-	else
-	{
-		//	look for empty cells into which the text can be extended
-		while ( nAvailable < nNeeded && nX < MAXCOL && IsAvailable( nX+1, nY ) )
-		{
-			++nX;
-			nAvailable += (long) ( pDoc->GetColWidth( nX, nTab ) * nPPTX );
-		}
-	}
-
-	if ( bMarkClipped && nAvailable < nNeeded )
-		nAvailable -= (long)( SC_CLIPMARK_SIZE * nPPTX );
-
-	return nAvailable;
-}
-
-
 // nX, nArrY:		loop variables from DrawStrings / DrawEdit
 // nPosX, nPosY:	corresponding positions for nX, nArrY
 // nCellX, nCellY:	position of the cell that contains the text
@@ -1790,28 +1715,6 @@
 
 //	-------------------------------------------------------------------------------
 
-Size lcl_GetVertPaperSize( ScDocument* pDoc, SCCOL nCol, SCROW nRow, SCTAB nTab )
-{
-	const double nPPTY = HMM_PER_TWIPS;
-
-	const ScPatternAttr* pPattern = pDoc->GetPattern( nCol, nRow, nTab );
-	const ScMergeAttr& rMerge = (const ScMergeAttr&)pPattern->GetItem(ATTR_MERGE);
-
-	long nCellY = (long) ( pDoc->GetRowHeight(nRow,nTab) * nPPTY );
-	if ( rMerge.GetRowMerge() > 1 )
-	{
-		SCROW nCountY = rMerge.GetRowMerge();
-        nCellY += (long) pDoc->GetScaledRowHeight( nRow+1, nRow+nCountY-1, nTab, nPPTY);
-	}
-
-	//	only top/bottom margin are interesting
-	const SvxMarginItem& rMargin = (const SvxMarginItem&)pPattern->GetItem(ATTR_MARGIN);
-	nCellY -= (long) ( rMargin.GetTopMargin() * nPPTY );
-	nCellY -= (long) ( rMargin.GetBottomMargin() * nPPTY );
-
-	return Size( nCellY - 1, 1000000 );		// cell height as width for PaperSize
-}
-
 void lcl_ClearEdit( EditEngine& rEngine )		// Text und Attribute
 {
 	rEngine.SetUpdateMode( FALSE );
@@ -2380,80 +2283,6 @@
 							}
 							pEngine->SetDefaultItem( SvxAdjustItem( eSvxAdjust, EE_PARA_JUST ) );
 
-							//	Raender
-
-							//!		Position und Papersize auf EditUtil umstellen !!!
-
-/*							Rectangle aPixRect = ScEditUtil( pDoc,
-												nX,nY,nTab, Point(nStartX,nStartY),
-												pDev, nPPTX, nPPTY, nZoom )
-												.GetEditArea( pPattern );
-
-							pDev->SetFillInBrush(Brush(Color(COL_LIGHTRED)));
-							pDev->DrawRect(pDev->PixelToLogic(aPixRect));
-*/
-
-#if 0
-							Size aPaperSize = Size( 1000000, 1000000 );
-							if ( eOrient==SVX_ORIENTATION_STACKED )
-								aPaperSize.Width() = nOutWidth;				// zum Zentrieren
-							else if (bAsianVertical)
-							{
-								aPaperSize.Width() = nOutWidth;
-								if (bBreak)
-								{
-									//	add some extra height (default margin value) for safety
-									//	as long as GetEditArea isn't used below
-									long nExtraHeight = (long)( 20 * nPPTY );
-									aPaperSize.Height() = nOutHeight + nExtraHeight;
-								}
-							}
-							else if (bBreak)
-							{
-								if (eOrient == SVX_ORIENTATION_STANDARD)
-								{
-									if (eType==OUTTYPE_WINDOW &&
-											eOrient!=SVX_ORIENTATION_STACKED &&
-											pInfo && pInfo->bAutoFilter)
-									{
-										long nSub = Min( pRowInfo[nArrY].nHeight,
-														(USHORT) DROPDOWN_BITMAP_SIZE );
-										if ( nOutWidth > nSub )
-											nOutWidth -= nSub;
-									}
-									aPaperSize.Width() = nOutWidth;
-								}
-								else
-									aPaperSize.Width() = nOutHeight - 1;
-							}
-							if (bPixelToLogic)
-							{
-								//!	also handle bAsianVertical in GetEditArea
-								if ( bBreak && pFmtDevice != pRefDevice && !bAsianVertical )
-								{
-									//	calculate PaperSize for automatic line breaks from logic size,
-									//	not pixel sizes, to get the same breaks at all scales
-
-									if ( eOrient == SVX_ORIENTATION_STANDARD )
-									{
-										Fraction aFract(1,1);
-										Rectangle aUtilRect = ScEditUtil( pDoc,nX,nY,nTab,
-																Point(nStartX,nStartY), pDev,
-																HMM_PER_TWIPS, HMM_PER_TWIPS, aFract, aFract )
-															.GetEditArea( pPattern, FALSE );
-										Size aLogic = aUtilRect.GetSize();
-										pEngine->SetPaperSize( aLogic );
-									}
-									else
-										pEngine->SetPaperSize( lcl_GetVertPaperSize(pDoc,nX,nY,nTab) );
-								}
-								else
-									pEngine->SetPaperSize(pRefDevice->PixelToLogic(aPaperSize));
-							}
-							else
-								pEngine->SetPaperSize(aPaperSize);
-#endif
-
 							//	Read content from cell
 
 							BOOL bWrapFields = FALSE;
Index: sc/source/ui/view/prevloc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/prevloc.cxx,v
retrieving revision 1.16
retrieving revision 1.16.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.16 -r1.16.32.2
--- sc/source/ui/view/prevloc.cxx	11 Apr 2008 01:36:07 -0000	1.16
+++ sc/source/ui/view/prevloc.cxx	13 May 2008 14:34:15 -0000	1.16.32.2
@@ -285,18 +285,6 @@
 	}
 }
 
-ScPreviewLocationEntry* lcl_GetEntryByPosition( const List& rEntries, const Point& rPos, ScPreviewLocationType eType )
-{
-	ULONG nCount = rEntries.Count();
-	for (ULONG nListPos=0; nListPos<nCount; nListPos++)
-	{
-		ScPreviewLocationEntry* pEntry = (ScPreviewLocationEntry*)rEntries.GetObject(nListPos);
-		if ( pEntry->eType == eType && pEntry->aPixelRect.IsInside( rPos ) )
-			return pEntry;
-	}
-	return NULL;
-}
-
 ScPreviewLocationEntry* lcl_GetEntryByAddress( const List& rEntries, const ScAddress& rPos, ScPreviewLocationType eType )
 {
 	ULONG nCount = rEntries.Count();
@@ -309,44 +297,44 @@
 	return NULL;
 }
 
-ScAddress ScPreviewLocationData::GetCellFromRange( const Size& rOffsetPixel, const ScRange& rRange ) const
-{
-	const double nScaleX = HMM_PER_TWIPS;
-	const double nScaleY = HMM_PER_TWIPS;
-
-	Size aOffsetLogic = pWindow->PixelToLogic( rOffsetPixel, aCellMapMode );
-	SCTAB nTab = rRange.aStart.Tab();
-
-	long nPosX = 0;
-	SCCOL nCol = rRange.aStart.Col();
-	SCCOL nEndCol = rRange.aEnd.Col();
-	while ( nCol <= nEndCol && nPosX < aOffsetLogic.Width() )
-	{
-		USHORT nDocW = pDoc->GetColWidth( nCol, nTab );
-		if (nDocW)
-			nPosX += (long) (nDocW * nScaleX);
-		++nCol;
-	}
-	if ( nCol > rRange.aStart.Col() )
-		--nCol;
-
-    long nPosY = 0;
-    ScCoupledCompressedArrayIterator< SCROW, BYTE, USHORT> aIter(
-            pDoc->GetRowFlagsArray( nTab), rRange.aStart.Row(),
-            rRange.aEnd.Row(), CR_HIDDEN, 0, pDoc->GetRowHeightArray( nTab));
-    while ( aIter && nPosY < aOffsetLogic.Height() )
-    {
-        USHORT nDocH = *aIter;
-        if (nDocH)
-            nPosY += (long) (nDocH * nScaleY);
-        ++aIter;
-    }
-    SCROW nRow = aIter.GetPos();
-	if ( nRow > rRange.aStart.Row() )
-		--nRow;
-
-	return ScAddress( nCol, nRow, nTab );
-}
+//UNUSED2008-05  ScAddress ScPreviewLocationData::GetCellFromRange( const Size& rOffsetPixel, const ScRange& rRange ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      const double nScaleX = HMM_PER_TWIPS;
+//UNUSED2008-05      const double nScaleY = HMM_PER_TWIPS;
+//UNUSED2008-05  
+//UNUSED2008-05      Size aOffsetLogic = pWindow->PixelToLogic( rOffsetPixel, aCellMapMode );
+//UNUSED2008-05      SCTAB nTab = rRange.aStart.Tab();
+//UNUSED2008-05  
+//UNUSED2008-05      long nPosX = 0;
+//UNUSED2008-05      SCCOL nCol = rRange.aStart.Col();
+//UNUSED2008-05      SCCOL nEndCol = rRange.aEnd.Col();
+//UNUSED2008-05      while ( nCol <= nEndCol && nPosX < aOffsetLogic.Width() )
+//UNUSED2008-05      {
+//UNUSED2008-05          USHORT nDocW = pDoc->GetColWidth( nCol, nTab );
+//UNUSED2008-05          if (nDocW)
+//UNUSED2008-05              nPosX += (long) (nDocW * nScaleX);
+//UNUSED2008-05          ++nCol;
+//UNUSED2008-05      }
+//UNUSED2008-05      if ( nCol > rRange.aStart.Col() )
+//UNUSED2008-05          --nCol;
+//UNUSED2008-05  
+//UNUSED2008-05      long nPosY = 0;
+//UNUSED2008-05      ScCoupledCompressedArrayIterator< SCROW, BYTE, USHORT> aIter(
+//UNUSED2008-05              pDoc->GetRowFlagsArray( nTab), rRange.aStart.Row(),
+//UNUSED2008-05              rRange.aEnd.Row(), CR_HIDDEN, 0, pDoc->GetRowHeightArray( nTab));
+//UNUSED2008-05      while ( aIter && nPosY < aOffsetLogic.Height() )
+//UNUSED2008-05      {
+//UNUSED2008-05          USHORT nDocH = *aIter;
+//UNUSED2008-05          if (nDocH)
+//UNUSED2008-05              nPosY += (long) (nDocH * nScaleY);
+//UNUSED2008-05          ++aIter;
+//UNUSED2008-05      }
+//UNUSED2008-05      SCROW nRow = aIter.GetPos();
+//UNUSED2008-05      if ( nRow > rRange.aStart.Row() )
+//UNUSED2008-05          --nRow;
+//UNUSED2008-05  
+//UNUSED2008-05      return ScAddress( nCol, nRow, nTab );
+//UNUSED2008-05  }
 
 Rectangle ScPreviewLocationData::GetOffsetPixel( const ScAddress& rCellPos, const ScRange& rRange ) const
 {
@@ -377,24 +365,6 @@
 	return Rectangle( Point( aOffsetPixel.Width(), aOffsetPixel.Height() ), aSizePixel );
 }
 
-BOOL ScPreviewLocationData::GetCell( const Point& rPos, ScAddress& rCellPos, Rectangle& rCellRect ) const
-{
-	ScPreviewLocationEntry* pEntry = lcl_GetEntryByPosition( aEntries, rPos, SC_PLOC_CELLRANGE );
-	if ( pEntry )
-	{
-		Size aOffsetPixel( rPos.X() - pEntry->aPixelRect.Left(), rPos.Y() - pEntry->aPixelRect.Top() );
-		rCellPos = GetCellFromRange( aOffsetPixel, pEntry->aCellRange );
-
-		Rectangle aOffsetRect = GetOffsetPixel( rCellPos, pEntry->aCellRange );
-		rCellRect = Rectangle( aOffsetRect.Left() + pEntry->aPixelRect.Left(),
-							   aOffsetRect.Top() + pEntry->aPixelRect.Top(),
-							   aOffsetRect.Right() + pEntry->aPixelRect.Left(),
-							   aOffsetRect.Bottom() + pEntry->aPixelRect.Top() );
-		return TRUE;
-	}
-	return FALSE;
-}
-
 BOOL ScPreviewLocationData::GetCellPosition( const ScAddress& rCellPos, Rectangle& rCellRect ) const
 {
 	ScPreviewLocationEntry* pEntry = lcl_GetEntryByAddress( aEntries, rCellPos, SC_PLOC_CELLRANGE );
Index: sc/source/ui/view/prevwsh.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/prevwsh.cxx,v
retrieving revision 1.44
retrieving revision 1.44.30.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.44 -r1.44.30.1
--- sc/source/ui/view/prevwsh.cxx	11 Apr 2008 01:36:22 -0000	1.44
+++ sc/source/ui/view/prevwsh.cxx	9 May 2008 21:22:48 -0000	1.44.30.1
@@ -144,27 +144,6 @@
 }
 
 ScPreviewShell::ScPreviewShell( SfxViewFrame* pViewFrame,
-								const ScPreviewShell& rWin ) :
-	SfxViewShell( pViewFrame, SFX_VIEW_MAXIMIZE_FIRST | SFX_VIEW_CAN_PRINT | SFX_VIEW_HAS_PRINTOPTIONS ),
-	pDocShell( rWin.pDocShell ),
-	aSourceData( rWin.aSourceData ),
-	nSourceDesignMode( rWin.nSourceDesignMode ),
-	pAccessibilityBroadcaster( NULL )
-{
-	Construct( &pViewFrame->GetWindow() );
-}
-
-ScPreviewShell::ScPreviewShell( SfxViewFrame* pViewFrame,
-								Window *pParent ) :
-	SfxViewShell( pViewFrame, SFX_VIEW_MAXIMIZE_FIRST | SFX_VIEW_CAN_PRINT | SFX_VIEW_HAS_PRINTOPTIONS ),
-	pDocShell( (ScDocShell*)pViewFrame->GetObjectShell() ),
-	nSourceDesignMode( SC_FORCEMODE_NONE ),
-	pAccessibilityBroadcaster( NULL )
-{
-	Construct( pParent );
-}
-
-ScPreviewShell::ScPreviewShell( SfxViewFrame* pViewFrame,
 								SfxViewShell* pOldSh ) :
 	SfxViewShell( pViewFrame, SFX_VIEW_MAXIMIZE_FIRST | SFX_VIEW_CAN_PRINT | SFX_VIEW_HAS_PRINTOPTIONS ),
 	pDocShell( (ScDocShell*)pViewFrame->GetObjectShell() ),
Index: sc/source/ui/view/printfun.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/printfun.cxx,v
retrieving revision 1.56
retrieving revision 1.56.30.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.56 -r1.56.30.2
--- sc/source/ui/view/printfun.cxx	11 Apr 2008 01:37:03 -0000	1.56
+++ sc/source/ui/view/printfun.cxx	9 May 2008 04:46:00 -0000	1.56.30.2
@@ -1163,22 +1163,6 @@
 		pOut->Pop();
 }
 
-void lcl_DrawGraphic( const Bitmap& rBitmap, OutputDevice *pOut,
-						const Rectangle &rGrf, const Rectangle &rOut )
-{
-	const FASTBOOL bNotInside = !rOut.IsInside( rGrf );
-	if ( bNotInside )
-	{
-		pOut->Push();
-		pOut->IntersectClipRegion( rOut );
-	}
-
-	pOut->DrawBitmap( rGrf.TopLeft(), rGrf.GetSize(), rBitmap );
-
-	if ( bNotInside )
-		pOut->Pop();
-}
-
 void lcl_DrawGraphic( const SvxBrushItem &rBrush, OutputDevice *pOut, OutputDevice* pRefDev,
 						const Rectangle &rOrg, const Rectangle &rOut )
 {
@@ -1778,15 +1762,6 @@
 	pDoc->GetName( nPrintTab, aFieldData.aTabName );
 }
 
-String lcl_CmdStr( USHORT nId )
-{
-	String aDel( ScGlobal::GetRscString( STR_HFCMD_DELIMITER ) );
-	String aCmd = aDel;
-	aCmd += ScGlobal::GetRscString( nId );
-	aCmd += aDel;
-	return aCmd;
-}
-
 void ScPrintFunc::MakeEditEngine()
 {
 	if (!pEditEngine)
Index: sc/source/ui/view/tabview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview.cxx,v
retrieving revision 1.36
retrieving revision 1.36.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.36 -r1.36.32.2
--- sc/source/ui/view/tabview.cxx	11 Apr 2008 01:39:57 -0000	1.36
+++ sc/source/ui/view/tabview.cxx	12 May 2008 15:57:01 -0000	1.36.32.2
@@ -1092,10 +1092,10 @@
 */
 }
 
-void ScTabView::SetActivePointer( const ResId& )
-{
-	DBG_ERRORFILE( "keine Pointer mit ResId!" );
-}
+//UNUSED2008-05  void ScTabView::SetActivePointer( const ResId& )
+//UNUSED2008-05  {
+//UNUSED2008-05      DBG_ERRORFILE( "keine Pointer mit ResId!" );
+//UNUSED2008-05  }
 
 void ScTabView::ActiveGrabFocus()
 {
@@ -1104,28 +1104,28 @@
 		pGridWin[ePos]->GrabFocus();
 }
 
-void ScTabView::ActiveCaptureMouse()
-{
-	ScSplitPos ePos = aViewData.GetActivePart();
-	if (pGridWin[ePos])
-		pGridWin[ePos]->CaptureMouse();
-}
-
-void ScTabView::ActiveReleaseMouse()
-{
-	ScSplitPos ePos = aViewData.GetActivePart();
-	if (pGridWin[ePos])
-		pGridWin[ePos]->ReleaseMouse();
-}
-
-Point ScTabView::ActivePixelToLogic( const Point& rDevicePoint )
-{
-	ScSplitPos ePos = aViewData.GetActivePart();
-	if (pGridWin[ePos])
-		return pGridWin[ePos]->PixelToLogic(rDevicePoint);
-	else
-		return Point();
-}
+//UNUSED2008-05  void ScTabView::ActiveCaptureMouse()
+//UNUSED2008-05  {
+//UNUSED2008-05      ScSplitPos ePos = aViewData.GetActivePart();
+//UNUSED2008-05      if (pGridWin[ePos])
+//UNUSED2008-05          pGridWin[ePos]->CaptureMouse();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void ScTabView::ActiveReleaseMouse()
+//UNUSED2008-05  {
+//UNUSED2008-05      ScSplitPos ePos = aViewData.GetActivePart();
+//UNUSED2008-05      if (pGridWin[ePos])
+//UNUSED2008-05          pGridWin[ePos]->ReleaseMouse();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  Point ScTabView::ActivePixelToLogic( const Point& rDevicePoint )
+//UNUSED2008-05  {
+//UNUSED2008-05      ScSplitPos ePos = aViewData.GetActivePart();
+//UNUSED2008-05      if (pGridWin[ePos])
+//UNUSED2008-05          return pGridWin[ePos]->PixelToLogic(rDevicePoint);
+//UNUSED2008-05      else
+//UNUSED2008-05          return Point();
+//UNUSED2008-05  }
 
 ScSplitPos ScTabView::FindWindow( Window* pWindow ) const
 {
Index: sc/source/ui/view/tabview3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview3.cxx,v
retrieving revision 1.67
retrieving revision 1.67.22.5
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.67 -r1.67.22.5
--- sc/source/ui/view/tabview3.cxx	18 Apr 2008 11:48:39 -0000	1.67
+++ sc/source/ui/view/tabview3.cxx	13 May 2008 14:34:15 -0000	1.67.22.5
@@ -112,93 +112,6 @@
 
 // -----------------------------------------------------------------------
 
-//	helper class for DoChartSelection
-
-#define SC_BGCOLLECT_FIRST		0
-#define SC_BGCOLLECT_FOUND		1
-#define SC_BGCOLLECT_AMBIGUOUS	2
-
-class ScBackgroundCollector
-{
-private:
-	ScDocument*	pDoc;
-	BOOL		bTransparent;
-	Color		aBackColor;
-	USHORT		nMode;
-public:
-			ScBackgroundCollector( ScDocument* pD );
-	void	AddRange( const ScRange& rRange );
-	Color	GetHighlightColor() const;
-};
-
-ScBackgroundCollector::ScBackgroundCollector( ScDocument* pD ) :
-	pDoc( pD ),
-	bTransparent( FALSE ),
-	nMode( SC_BGCOLLECT_FIRST )
-{
-}
-
-void ScBackgroundCollector::AddRange( const ScRange& rRange )
-{
-	if ( nMode == SC_BGCOLLECT_AMBIGUOUS )
-		return;									// nothing more to do
-
-	ScDocAttrIterator aIter( pDoc, rRange.aStart.Tab(),
-							rRange.aStart.Col(), rRange.aStart.Row(),
-							rRange.aEnd.Col(), rRange.aEnd.Row() );
-	SCCOL nCol;
-	SCROW nRow1, nRow2;
-	const ScPatternAttr* pPattern = aIter.GetNext( nCol, nRow1, nRow2 );
-	while ( pPattern )
-	{
-		//!	look at conditional formats?
-		const Color& rAttrColor = ((const SvxBrushItem&)pPattern->GetItem(ATTR_BACKGROUND)).GetColor();
-		BOOL bAttrTransp = ( rAttrColor.GetTransparency() != 0 );
-
-		if ( nMode == SC_BGCOLLECT_FIRST )
-		{
-			//	just copy first background
-			bTransparent = bAttrTransp;
-			aBackColor   = rAttrColor;
-			nMode = SC_BGCOLLECT_FOUND;
-		}
-		else if ( nMode == SC_BGCOLLECT_FOUND )
-		{
-			BOOL bEqual = ( bTransparent == bAttrTransp );
-			if ( bEqual && !bTransparent )
-				bEqual = ( aBackColor == rAttrColor );
-			if ( !bEqual )
-			{
-				nMode = SC_BGCOLLECT_AMBIGUOUS;		// different backgrounds found
-				return;								// dont need to continue
-			}
-		}
-
-		pPattern = aIter.GetNext( nCol, nRow1, nRow2 );
-	}
-}
-
-Color ScBackgroundCollector::GetHighlightColor() const
-{
-	if ( nMode == SC_BGCOLLECT_FOUND && !bTransparent )
-	{
-		//	everything formatted with a single background color
-		//	-> use contrasting color (blue or yellow)
-
-		Color aBlue( COL_LIGHTBLUE );
-		Color aYellow( COL_YELLOW );
-
-		if ( aBackColor.GetColorError(aBlue) >= aBackColor.GetColorError(aYellow) )
-			return aBlue;
-		else
-			return aYellow;
-	}
-	else
-		return Color( COL_LIGHTBLUE );		// default for transparent or ambiguous background
-}
-
-// -----------------------------------------------------------------------
-
 //
 // ---	Public-Funktionen
 //
@@ -545,6 +458,7 @@
 	//	Broadcast, damit andere Views des Dokuments auch umschalten
 
 	ScDocument* pDoc = aViewData.GetDocument();
+#if OLD_PIVOT_IMPLEMENTATION
 	BOOL bPivot = ( NULL != pDoc->GetPivotAtCursor( aViewData.GetCurX(),
 													aViewData.GetCurY(),
 													aViewData.GetTabNo() ) ||
@@ -552,6 +466,11 @@
 													aViewData.GetCurY(),
 													aViewData.GetTabNo() ) );
 	aViewData.GetViewShell()->SetPivotShell(bPivot);
+#else
+	bool bDP = NULL != pDoc->GetDPAtCursor( 
+		aViewData.GetCurX(), aViewData.GetCurY(), aViewData.GetTabNo() );
+	aViewData.GetViewShell()->SetPivotShell(bDP);
+#endif
 
 	//	UpdateInputHandler jetzt in CellContentChanged
 
@@ -2015,20 +1934,6 @@
 		UpdateEditView();
 }
 
-//	PaintCell - einzelne Zelle neu zeichnen
-
-void ScTabView::PaintCell( SCCOL nCol, SCROW nRow, SCTAB nTab )
-{
-	if ( aViewData.GetTabNo() == nTab )
-	{
-		USHORT i;
-		for (i=0; i<4; i++)
-			if (pGridWin[i])
-				if (pGridWin[i]->IsVisible())
-					pGridWin[i]->Draw( nCol, nRow, nCol, nRow );
-	}
-}
-
 //	PaintArea -Block neu zeichnen
 
 void ScTabView::PaintArea( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
@@ -2271,19 +2176,43 @@
 
 //	DrawDragRect - Drag&Drop-Rechteck zeichnen (XOR)
 
-void ScTabView::DrawDragRect( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY,
-								ScSplitPos ePos )
-{
-	if ( aViewData.GetHSplitMode() == SC_SPLIT_FIX || aViewData.GetVSplitMode() == SC_SPLIT_FIX )
-	{
-		for (USHORT  i=0; i<4; i++)
-			if (pGridWin[i])
-				if (pGridWin[i]->IsVisible())
-					pGridWin[i]->DrawDragRect( nStartX, nStartY, nEndX, nEndY );
-	}
-	else
-		pGridWin[ePos]->DrawDragRect( nStartX, nStartY, nEndX, nEndY );
-}
+//UNUSED2008-05  void ScTabView::DrawDragRect( SCCOL nStartX, SCROW nStartY, SCCOL nEndX, SCROW nEndY,
+//UNUSED2008-05                                ScSplitPos ePos )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( aViewData.GetHSplitMode() == SC_SPLIT_FIX || aViewData.GetVSplitMode() == SC_SPLIT_FIX )
+//UNUSED2008-05      {
+//UNUSED2008-05          for (USHORT  i=0; i<4; i++)
+//UNUSED2008-05              if (pGridWin[i])
+//UNUSED2008-05                  if (pGridWin[i]->IsVisible())
+//UNUSED2008-05                      pGridWin[i]->DrawDragRect( nStartX, nStartY, nEndX, nEndY );
+//UNUSED2008-05      }
+//UNUSED2008-05      else
+//UNUSED2008-05          pGridWin[ePos]->DrawDragRect( nStartX, nStartY, nEndX, nEndY );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  //	PaintCell - einzelne Zelle neu zeichnen
+//UNUSED2008-05  
+//UNUSED2008-05  void ScTabView::PaintCell( SCCOL nCol, SCROW nRow, SCTAB nTab )
+//UNUSED2008-05  {
+//UNUSED2008-05      if ( aViewData.GetTabNo() == nTab )
+//UNUSED2008-05      {
+//UNUSED2008-05          USHORT i;
+//UNUSED2008-05          for (i=0; i<4; i++)
+//UNUSED2008-05              if (pGridWin[i])
+//UNUSED2008-05                  if (pGridWin[i]->IsVisible())
+//UNUSED2008-05                      pGridWin[i]->Draw( nCol, nRow, nCol, nRow );
+//UNUSED2008-05      }
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void ScTabView::PaintLeftRow( SCROW nRow )
+//UNUSED2008-05  {
+//UNUSED2008-05      PaintLeftArea( nRow, nRow );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void ScTabView::PaintTopCol( SCCOL nCol )
+//UNUSED2008-05  {
+//UNUSED2008-05      PaintTopArea( nCol, nCol );
+//UNUSED2008-05  }
 
 //	PaintGrid - Datenbereiche neu zeichnen
 
@@ -2326,11 +2255,6 @@
 	}
 }
 
-void ScTabView::PaintTopCol( SCCOL nCol )
-{
-	PaintTopArea( nCol, nCol );
-}
-
 void ScTabView::PaintTopArea( SCCOL nStartCol, SCCOL nEndCol )
 {
 		//	Pixel-Position der linken Kante
@@ -2388,11 +2312,6 @@
 	}
 }
 
-void ScTabView::PaintLeftRow( SCROW nRow )
-{
-	PaintLeftArea( nRow, nRow );
-}
-
 void ScTabView::PaintLeftArea( SCROW nStartRow, SCROW nEndRow )
 {
 		//	Pixel-Position der oberen Kante
Index: sc/source/ui/view/tabview4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview4.cxx,v
retrieving revision 1.11
retrieving revision 1.11.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.11 -r1.11.32.2
--- sc/source/ui/view/tabview4.cxx	11 Apr 2008 01:41:04 -0000	1.11
+++ sc/source/ui/view/tabview4.cxx	12 May 2008 15:57:02 -0000	1.11.32.2
@@ -335,13 +335,13 @@
 	}
 }
 
-void ScTabView::EndSelection()
-{
-	ScModule* pScMod = SC_MOD();
-	BOOL bRefMode = pScMod->IsFormulaMode();
-	if ( bRefMode )
-		pScMod->EndReference();
-}
+//UNUSED2008-05  void ScTabView::EndSelection()
+//UNUSED2008-05  {
+//UNUSED2008-05      ScModule* pScMod = SC_MOD();
+//UNUSED2008-05      BOOL bRefMode = pScMod->IsFormulaMode();
+//UNUSED2008-05      if ( bRefMode )
+//UNUSED2008-05          pScMod->EndReference();
+//UNUSED2008-05  }
 
 // static
 void ScTabView::SetScrollBar( ScrollBar& rScroll, long nRangeMax, long nVisible, long nPos, BOOL bLayoutRTL )
Index: sc/source/ui/view/tabview5.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview5.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.25 -r1.25.32.3
--- sc/source/ui/view/tabview5.cxx	15 Apr 2008 14:35:08 -0000	1.25
+++ sc/source/ui/view/tabview5.cxx	12 May 2008 15:57:02 -0000	1.25.32.3
@@ -412,13 +412,13 @@
 		return FALSE;
 }
 
-String ScTabView::GetSelectedChartName() const
-{
-	if (pDrawView)
-		return pDrawView->GetSelectedChartName();
-	else
-		return EMPTY_STRING;
-}
+//UNUSED2008-05  String ScTabView::GetSelectedChartName() const
+//UNUSED2008-05  {
+//UNUSED2008-05      if (pDrawView)
+//UNUSED2008-05          return pDrawView->GetSelectedChartName();
+//UNUSED2008-05      else
+//UNUSED2008-05          return EMPTY_STRING;
+//UNUSED2008-05  }
 
 SvxZoomType ScTabView::GetZoomType() const
 {
@@ -568,7 +568,6 @@
 		else
 		{
 			pDrawView->SetAnimationEnabled(FALSE);
-			//	StopAnimations am Dokument ist nicht mehr noetig
 		}
 	}
 }
Index: sc/source/ui/view/tabvwsh2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsh2.cxx,v
retrieving revision 1.27
retrieving revision 1.27.32.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.27 -r1.27.32.2
--- sc/source/ui/view/tabvwsh2.cxx	11 Apr 2008 01:42:01 -0000	1.27
+++ sc/source/ui/view/tabvwsh2.cxx	12 May 2008 15:57:02 -0000	1.27.32.2
@@ -323,7 +323,7 @@
 			break;
 
 		case SID_DRAW_CHART:
-			bChartDlgIsEdit = FALSE;
+//UNUSED2008-05  bChartDlgIsEdit = FALSE;
 			pTabView->SetDrawFuncPtr(new FuMarkRect(this, pWin, pView, pDoc, aNewReq));
 			break;
 
Index: sc/source/ui/view/tabvwsh4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsh4.cxx,v
retrieving revision 1.75
retrieving revision 1.75.24.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.75 -r1.75.24.2
--- sc/source/ui/view/tabvwsh4.cxx	18 Apr 2008 11:49:02 -0000	1.75
+++ sc/source/ui/view/tabvwsh4.cxx	12 May 2008 15:57:02 -0000	1.75.24.2
@@ -648,37 +648,26 @@
 	//!	if ViewData has more tables than document, remove tables in ViewData
 }
 
-
 //------------------------------------------------------------------
 
-void ScTabViewShell::TestFunction( USHORT /* nPar */ )
-{
-/*	switch (nPar)
-	{
-	}
-*/
-}
-
-//------------------------------------------------------------------
-
-void ScTabViewShell::ExecuteShowNIY( SfxRequest& /* rReq */ )
-{
-	ErrorMessage(STR_BOX_YNI);
-}
-
-//------------------------------------------------------------------
-
-void ScTabViewShell::StateDisabled( SfxItemSet& rSet )
-{
-	SfxWhichIter aIter( rSet );
-	USHORT		 nWhich = aIter.FirstWhich();
-
-	while ( nWhich )
-	{
-		rSet.DisableItem( nWhich );
-		nWhich = aIter.NextWhich();
-	}
-}
+//UNUSED2008-05  void ScTabViewShell::ExecuteShowNIY( SfxRequest& /* rReq */ )
+//UNUSED2008-05  {
+//UNUSED2008-05      ErrorMessage(STR_BOX_YNI);
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  //------------------------------------------------------------------
+//UNUSED2008-05  
+//UNUSED2008-05  void ScTabViewShell::StateDisabled( SfxItemSet& rSet )
+//UNUSED2008-05  {
+//UNUSED2008-05      SfxWhichIter aIter( rSet );
+//UNUSED2008-05      USHORT       nWhich = aIter.FirstWhich();
+//UNUSED2008-05  
+//UNUSED2008-05      while ( nWhich )
+//UNUSED2008-05      {
+//UNUSED2008-05          rSet.DisableItem( nWhich );
+//UNUSED2008-05          nWhich = aIter.NextWhich();
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 void ScTabViewShell::SetDrawShellOrSub()
 {
@@ -1117,17 +1106,17 @@
 	return NULL;		// keine von meinen dabei
 }
 
-void ScTabViewShell::SetMySubShell( SfxShell* pShell )
-{
-	SfxShell* pOld = GetMySubShell();
-	if ( pOld != pShell )
-	{
-		if (pOld)
-			RemoveSubShell(pOld);	// alte SubShell entfernen
-		if (pShell)
-			AddSubShell(*pShell);	// neue setzen
-	}
-}
+//UNUSED2008-05  void ScTabViewShell::SetMySubShell( SfxShell* pShell )
+//UNUSED2008-05  {
+//UNUSED2008-05      SfxShell* pOld = GetMySubShell();
+//UNUSED2008-05      if ( pOld != pShell )
+//UNUSED2008-05      {
+//UNUSED2008-05          if (pOld)
+//UNUSED2008-05              RemoveSubShell(pOld);   // alte SubShell entfernen
+//UNUSED2008-05          if (pShell)
+//UNUSED2008-05              AddSubShell(*pShell);   // neue setzen
+//UNUSED2008-05      }
+//UNUSED2008-05  }
 
 BOOL ScTabViewShell::IsDrawTextShell() const
 {
@@ -1701,7 +1690,7 @@
 	bPrintSelected(FALSE),		\
 	bReadOnly(FALSE),			\
 	pScSbxObject(NULL),			\
-	bChartDlgIsEdit(FALSE),		\
+	/*bChartDlgIsEdit(FALSE),*/		\
 	bChartAreaValid(FALSE),		\
     nCurRefDlgId(0),            \
 	pAccessibilityBroadcaster(NULL)
@@ -1894,29 +1883,29 @@
 
 //------------------------------------------------------------------
 
-ScTabViewShell::ScTabViewShell( SfxViewFrame* pViewFrame,
-								const ScTabViewShell& rWin ) :
-    SfxViewShell( pViewFrame, SFX_VIEW_MAXIMIZE_FIRST | SFX_VIEW_CAN_PRINT | SFX_VIEW_HAS_PRINTOPTIONS ),
-    ScDBFunc( &pViewFrame->GetWindow(), rWin, this ),
-    __INIT_ScTabViewShell
-{
-	RTL_LOGFILE_CONTEXT_AUTHOR ( aLog, "sc", "nn93723", "ScTabViewShell::ScTabViewShell" );
-
-	Construct();
-
-	UpdatePageBreakData();
-
-    /*uno::Reference<frame::XFrame> xFrame = pViewFrame->GetFrame()->GetFrameInterface();
-	if (xFrame.is())
-        xFrame->setComponent( uno::Reference<awt::XWindow>(), new ScTabViewObj( this ) );*/
-    // make Controller known to SFX
-    new ScTabViewObj( this );
-
-	SetCurSubShell(OST_Cell);
-	SvBorder aBorder;
-    GetBorderSize( aBorder, Size() );
-	SetBorderPixel( aBorder );
-}
+//UNUSED2008-05  ScTabViewShell::ScTabViewShell( SfxViewFrame* pViewFrame,
+//UNUSED2008-05                                  const ScTabViewShell& rWin ) :
+//UNUSED2008-05  SfxViewShell( pViewFrame, SFX_VIEW_MAXIMIZE_FIRST | SFX_VIEW_CAN_PRINT | SFX_VIEW_HAS_PRINTOPTIONS ),
+//UNUSED2008-05  ScDBFunc( &pViewFrame->GetWindow(), rWin, this ),
+//UNUSED2008-05  __INIT_ScTabViewShell
+//UNUSED2008-05  {
+//UNUSED2008-05      RTL_LOGFILE_CONTEXT_AUTHOR ( aLog, "sc", "nn93723", "ScTabViewShell::ScTabViewShell" );
+//UNUSED2008-05  
+//UNUSED2008-05      Construct();
+//UNUSED2008-05  
+//UNUSED2008-05      UpdatePageBreakData();
+//UNUSED2008-05  
+//UNUSED2008-05      /*uno::Reference<frame::XFrame> xFrame = pViewFrame->GetFrame()->GetFrameInterface();
+//UNUSED2008-05      if (xFrame.is())
+//UNUSED2008-05          xFrame->setComponent( uno::Reference<awt::XWindow>(), new ScTabViewObj( this ) );*/
+//UNUSED2008-05      // make Controller known to SFX
+//UNUSED2008-05      new ScTabViewObj( this );
+//UNUSED2008-05  
+//UNUSED2008-05      SetCurSubShell(OST_Cell);
+//UNUSED2008-05      SvBorder aBorder;
+//UNUSED2008-05      GetBorderSize( aBorder, Size() );
+//UNUSED2008-05      SetBorderPixel( aBorder );
+//UNUSED2008-05  }
 
 //------------------------------------------------------------------
 
@@ -2059,10 +2048,10 @@
 	nChartDestTab	= GetViewData()->GetTabNo();
 }
 
-void ScTabViewShell::ResetChartArea()
-{
-	bChartAreaValid = FALSE;
-}
+//UNUSED2008-05  void ScTabViewShell::ResetChartArea()
+//UNUSED2008-05  {
+//UNUSED2008-05      bChartAreaValid = FALSE;
+//UNUSED2008-05  }
 
 BOOL ScTabViewShell::GetChartArea( ScRangeListRef& rSource, Rectangle& rDest, SCTAB& rTab ) const
 {
@@ -2072,15 +2061,15 @@
 	return bChartAreaValid;
 }
 
-BOOL ScTabViewShell::IsChartDlgEdit() const
-{
-	return bChartDlgIsEdit;
-}
-
-const String& ScTabViewShell::GetEditChartName() const
-{
-	return aEditChartName;
-}
+//UNUSED2008-05  BOOL ScTabViewShell::IsChartDlgEdit() const
+//UNUSED2008-05  {
+//UNUSED2008-05      return bChartDlgIsEdit;
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  const String& ScTabViewShell::GetEditChartName() const
+//UNUSED2008-05  {
+//UNUSED2008-05      return aEditChartName;
+//UNUSED2008-05  }
 
 ScNavigatorSettings* ScTabViewShell::GetNavigatorSettings()
 {
Index: sc/source/ui/view/tabvwsh5.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsh5.cxx,v
retrieving revision 1.13
retrieving revision 1.13.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.1
--- sc/source/ui/view/tabvwsh5.cxx	11 Apr 2008 01:43:00 -0000	1.13
+++ sc/source/ui/view/tabvwsh5.cxx	8 May 2008 21:46:18 -0000	1.13.32.1
@@ -194,10 +194,6 @@
 		{
 			SCCOL nCol = pHint->GetCol();
 			SCROW nRow = pHint->GetRow();
-#if 0
-// Abfrage ist ueberfluessig, passiert bereits in ScInputHandler StartTable
-//			if (pDoc->IsSelectionOrBlockEditable( nTab, nCol,nRow, nCol,nRow ))
-#endif
 			{
 				HideNoteMarker();
 
@@ -217,11 +213,6 @@
 					SetEditShell(pView ,TRUE);
 				}
 			}
-#if 0
-//			else
-//				if (GetViewData()->IsActive())
-//					ErrorMessage(STR_PROTECTIONERR);
-#endif
 		}
 	}
 	else if (rHint.ISA(ScTablesHint))				// Tabelle eingefuegt / geloescht
Index: sc/source/ui/view/tabvwshc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwshc.cxx,v
retrieving revision 1.13
retrieving revision 1.13.32.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.32.1
--- sc/source/ui/view/tabvwshc.cxx	11 Apr 2008 01:44:22 -0000	1.13
+++ sc/source/ui/view/tabvwshc.cxx	8 May 2008 21:46:18 -0000	1.13.32.1
@@ -72,19 +72,6 @@
 #include "simpref.hxx"
 #include "dpobject.hxx"
 
-// -----------------------------------------------------------------------
-
-//! 	nach document verschieben !!!
-
-BOOL lcl_IsValueCol( ScDocument* pDoc, SCCOL nCol, SCROW nRow1, SCROW nRow2, SCTAB nTab )
-{
-	BOOL bVal = TRUE;
-	for (SCROW nRow=nRow1; nRow<=nRow2 && bVal; nRow++)
-		if (pDoc->HasStringData( nCol, nRow, nTab ))
-			bVal = FALSE;
-	return bVal;
-}
-
 //------------------------------------------------------------------
 
 void ScTabViewShell::SetCurRefDlgId( USHORT nNew )
@@ -267,109 +254,6 @@
             {
                 GetViewData()->SetRefTabNo( GetViewData()->GetTabNo() );
                 pResult = new ScDPLayoutDlg( pB, pCW, pParent, *pDialogDPObject );
-
-#if 0
-			ScDocument* 	pDoc = GetViewData()->GetDocument();
-			SCTAB			nTab  = 0;
-			SCCOL			nCol1 = 0;
-			SCCOL			nCol2 = 0;
-			SCROW			nRow1 = 0;
-			SCROW			nRow2 = 0;
-
-			ScPivot*		pPivot = pDoc->GetPivotAtCursor(
-										GetViewData()->GetCurX(),
-										GetViewData()->GetCurY(),
-										GetViewData()->GetTabNo() );
-			ScDPObject*		pDPObj = pDoc->GetDPAtCursor(
-										GetViewData()->GetCurX(),
-										GetViewData()->GetCurY(),
-										GetViewData()->GetTabNo() );
-			ScPivotParam	aPivotParam;
-
-			if ( pPivot ) // befinden wir uns auf einer Pivot-Tabelle?
-			{
-				ScArea aArea;
-				ScQueryParam aQuery;
-				pPivot->GetParam( aPivotParam, aQuery, aArea );
-				pPivot->GetSrcArea( nCol1, nRow1, nCol2, nRow2, nTab);
-
-				// Quelldatenbereich markieren
-				if ( nTab == GetViewData()->GetTabNo() )
-					MarkRange( ScRange( nCol1,nRow1,nTab, nCol2,nRow2,nTab ) );
-			}
-			else if ( pDPObj && pDPObj->IsSheetData() )
-			{
-				//	get (old) ScPivotParam
-
-				pDPObj->FillOldParam( aPivotParam );
-				ScRange aSource = pDPObj->GetSourceRange();
-				nCol1 = aSource.aStart.Col();
-				nRow1 = aSource.aStart.Row();
-				nCol2 = aSource.aEnd.Col();
-				nRow2 = aSource.aEnd.Row();
-				nTab  = aSource.aStart.Tab();
-
-				if ( nTab == GetViewData()->GetTabNo() )
-					MarkRange( ScRange( nCol1,nRow1,nTab, nCol2,nRow2,nTab ) );
-			}
-			else // neue Pivot-Tabelle erzeugen
-			{
-				ScDBData*	pDBData = GetDBData();
-				String		aErrMsg;
-
-				pDBData->GetArea( nTab, nCol1, nRow1, nCol2, nRow2 );
-
-
-				if (nRow2+2 <= MAXROW - 4)				// Default-Ausgabebereich
-				{										// min. Tabelle hat 5 Zeilen
-					aPivotParam.nCol = nCol1;
-					aPivotParam.nRow = nRow2+2;
-					aPivotParam.nTab = nTab;
-				}
-				else
-				{
-					aPivotParam.nCol = 0;
-					aPivotParam.nRow = 0;
-					aPivotParam.nTab = MAXTAB+1;
-				}
-
-			}
-
-			SfxItemSet aArgSet( GetPool(),
-								SCITEM_PIVOTDATA,
-								SCITEM_PIVOTDATA );
-
-			// Ermitteln der Ueberschriften:
-			String		aFieldName;
-			USHORT		nLabelCount = nCol2-nCol1+1;
-			SCsCOL		nCol		= nCol1;
-			BOOL		bIsValue	= FALSE;
-			LabelData** aLabelArr	= new LabelData*[nLabelCount];
-
-			for ( USHORT i=0; i<nLabelCount; i++ )
-			{
-				pDoc->GetString( nCol, nRow1, nTab, aFieldName );
-				if ( !aFieldName )
-					aFieldName = ColToAlpha( nCol );
-				bIsValue = lcl_IsValueCol( pDoc, nCol, nRow1+1, nRow2, nTab );
-				aLabelArr[i] = new LabelData( aFieldName, nCol, bIsValue );
-				nCol++;
-			}
-
-			aPivotParam.SetLabelData( aLabelArr, nLabelCount );
-			aArgSet.Put( ScPivotItem( SCITEM_PIVOTDATA, &aPivotParam ) );
-
-			// aktuelle Tabelle merken (wg. RefInput im Dialog)
-			GetViewData()->SetRefTabNo( GetViewData()->GetTabNo() );
-
-			*pPivotSource = ScArea( nTab, nCol1,nRow1, nCol2,nRow2 );
-			pResult = new ScPivotLayoutDlg( pB, pCW, pParent, aArgSet );
-
-
-			for ( USHORT p=0; p<nLabelCount; p++ )
-				delete aLabelArr[p];
-			delete [] aLabelArr;
-#endif
             }
 		}
 		break;
Index: sc/source/ui/view/viewdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewdata.cxx,v
retrieving revision 1.65
retrieving revision 1.65.24.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.65 -r1.65.24.2
--- sc/source/ui/view/viewdata.cxx	18 Apr 2008 12:01:29 -0000	1.65
+++ sc/source/ui/view/viewdata.cxx	12 May 2008 15:57:02 -0000	1.65.24.2
@@ -411,57 +411,57 @@
 	CalcPPT();
 }
 
-void ScViewData::SetDocShell( ScDocShell* pShell )
-{
-	pDocShell = pShell;
-	pDoc = pDocShell->GetDocument();
-	*pOptions = pDoc->GetViewOptions();
-	CalcPPT();
-}
-
 void ScViewData::InitData( ScDocument* pDocument )
 {
 	pDoc = pDocument;
 	*pOptions = pDoc->GetViewOptions();
 }
 
-void ScViewData::InitFrom( const ScViewData* pRef )
-{
-	if (pRef==NULL)
-	{
-		DBG_ERROR("ScViewData::InitFrom mit NULL");
-		return;
-	}
-
-	aScrSize	= pRef->aScrSize;
-	nTabNo		= pRef->nTabNo;
-    eDefZoomType = pRef->eDefZoomType;
-    aDefZoomX   = pRef->aDefZoomX;
-    aDefZoomY   = pRef->aDefZoomY;
-    aDefPageZoomX = pRef->aDefPageZoomX;
-    aDefPageZoomY = pRef->aDefPageZoomY;
-	bPagebreak	= pRef->bPagebreak;
-	aLogicMode	= pRef->aLogicMode;
-
-	SetGridMode		( pRef->IsGridMode() );
-	SetSyntaxMode	( pRef->IsSyntaxMode() );
-	SetHeaderMode	( pRef->IsHeaderMode() );
-	SetTabMode		( pRef->IsTabMode() );
-	SetVScrollMode	( pRef->IsVScrollMode() );
-	SetHScrollMode	( pRef->IsHScrollMode() );
-	SetOutlineMode	( pRef->IsOutlineMode() );
-
-	for (SCTAB i=0; i<=MAXTAB; i++)
-	{
-		delete pTabData[i];
-		if (pRef->pTabData[i])
-			pTabData[i] = new ScViewDataTable( *pRef->pTabData[i] );
-		else
-			pTabData[i] = NULL;
-	}
-	pThisTab = pTabData[nTabNo];
-	CalcPPT();
-}
+//UNUSED2008-05  void ScViewData::InitFrom( const ScViewData* pRef )
+//UNUSED2008-05  {
+//UNUSED2008-05      if (pRef==NULL)
+//UNUSED2008-05      {
+//UNUSED2008-05          DBG_ERROR("ScViewData::InitFrom mit NULL");
+//UNUSED2008-05          return;
+//UNUSED2008-05      }
+//UNUSED2008-05  
+//UNUSED2008-05      aScrSize    = pRef->aScrSize;
+//UNUSED2008-05      nTabNo      = pRef->nTabNo;
+//UNUSED2008-05      eDefZoomType = pRef->eDefZoomType;
+//UNUSED2008-05      aDefZoomX   = pRef->aDefZoomX;
+//UNUSED2008-05      aDefZoomY   = pRef->aDefZoomY;
+//UNUSED2008-05      aDefPageZoomX = pRef->aDefPageZoomX;
+//UNUSED2008-05      aDefPageZoomY = pRef->aDefPageZoomY;
+//UNUSED2008-05      bPagebreak  = pRef->bPagebreak;
+//UNUSED2008-05      aLogicMode  = pRef->aLogicMode;
+//UNUSED2008-05  
+//UNUSED2008-05      SetGridMode     ( pRef->IsGridMode() );
+//UNUSED2008-05      SetSyntaxMode   ( pRef->IsSyntaxMode() );
+//UNUSED2008-05      SetHeaderMode   ( pRef->IsHeaderMode() );
+//UNUSED2008-05      SetTabMode      ( pRef->IsTabMode() );
+//UNUSED2008-05      SetVScrollMode  ( pRef->IsVScrollMode() );
+//UNUSED2008-05      SetHScrollMode  ( pRef->IsHScrollMode() );
+//UNUSED2008-05      SetOutlineMode  ( pRef->IsOutlineMode() );
+//UNUSED2008-05  
+//UNUSED2008-05      for (SCTAB i=0; i<=MAXTAB; i++)
+//UNUSED2008-05      {
+//UNUSED2008-05          delete pTabData[i];
+//UNUSED2008-05          if (pRef->pTabData[i])
+//UNUSED2008-05              pTabData[i] = new ScViewDataTable( *pRef->pTabData[i] );
+//UNUSED2008-05          else
+//UNUSED2008-05              pTabData[i] = NULL;
+//UNUSED2008-05      }
+//UNUSED2008-05      pThisTab = pTabData[nTabNo];
+//UNUSED2008-05      CalcPPT();
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  void ScViewData::SetDocShell( ScDocShell* pShell )
+//UNUSED2008-05  {
+//UNUSED2008-05      pDocShell = pShell;
+//UNUSED2008-05      pDoc = pDocShell->GetDocument();
+//UNUSED2008-05      *pOptions = pDoc->GetViewOptions();
+//UNUSED2008-05      CalcPPT();
+//UNUSED2008-05  }
 
 ScDocument* ScViewData::GetDocument() const
 {
@@ -580,10 +580,10 @@
 	aMarkData.InsertTab( nInsTab );			// ggf. angepasst
 }
 
-void ScViewData::UpdateOle( ScSplitPos /* eWhich */ )
-{
-	GetDocShell()->UpdateOle(this);
-}
+//UNUSED2008-05  void ScViewData::UpdateOle( ScSplitPos /* eWhich */ )
+//UNUSED2008-05  {
+//UNUSED2008-05      GetDocShell()->UpdateOle(this);
+//UNUSED2008-05  }
 
 void ScViewData::SetViewShell( ScTabViewShell* pViewSh )
 {
@@ -1682,15 +1682,15 @@
 	return CellsAtY( GetPosY( eWhichY ), -1, eWhichY, SC_SIZE_NONE );
 }
 
-SCCOL ScViewData::LastCellsX( ScHSplitPos eWhichX ) const
-{
-	return CellsAtX( MAXCOL+1, -1, eWhichX, SC_SIZE_NONE );
-}
-
-SCROW ScViewData::LastCellsY( ScVSplitPos eWhichY ) const
-{
-	return CellsAtY( MAXROW+1, -1, eWhichY, SC_SIZE_NONE );
-}
+//UNUSED2008-05  SCCOL ScViewData::LastCellsX( ScHSplitPos eWhichX ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return CellsAtX( MAXCOL+1, -1, eWhichX, SC_SIZE_NONE );
+//UNUSED2008-05  }
+//UNUSED2008-05  
+//UNUSED2008-05  SCROW ScViewData::LastCellsY( ScVSplitPos eWhichY ) const
+//UNUSED2008-05  {
+//UNUSED2008-05      return CellsAtY( MAXROW+1, -1, eWhichY, SC_SIZE_NONE );
+//UNUSED2008-05  }
 
 BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix )
 {
Index: sc/source/ui/view/viewfun2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewfun2.cxx,v
retrieving revision 1.40
retrieving revision 1.40.20.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.40 -r1.40.20.2
--- sc/source/ui/view/viewfun2.cxx	18 Apr 2008 11:50:10 -0000	1.40
+++ sc/source/ui/view/viewfun2.cxx	12 May 2008 15:57:02 -0000	1.40.20.2
@@ -829,36 +829,36 @@
 
 //----------------------------------------------------------------------------
 
-void ScViewFunc::PaintWidthHeight( BOOL bColumns, SCCOLROW nStart, SCCOLROW nEnd )
-{
-	SCTAB nTab = GetViewData()->GetTabNo();
-	ScDocument* pDoc = GetViewData()->GetDocument();
-
-	USHORT nParts = PAINT_GRID;
-	SCCOL nStartCol = 0;
-	SCROW nStartRow = 0;
-	SCCOL nEndCol = MAXCOL;			// fuer Test auf Merge
-	SCROW nEndRow = MAXROW;
-	if ( bColumns )
-	{
-		nParts |= PAINT_TOP;
-		nStartCol = static_cast<SCCOL>(nStart);
-		nEndCol = static_cast<SCCOL>(nEnd);
-	}
-	else
-	{
-		nParts |= PAINT_LEFT;
-		nStartRow = nStart;
-		nEndRow = nEnd;
-	}
-	if (pDoc->HasAttrib( nStartCol,nStartRow,nTab, nEndCol,nEndRow,nTab,
-							HASATTR_MERGED | HASATTR_OVERLAPPED ))
-	{
-		nStartCol = 0;
-		nStartRow = 0;
-	}
-	GetViewData()->GetDocShell()->PostPaint( nStartCol,nStartRow,nTab, MAXCOL,MAXROW,nTab, nParts );
-}
+//UNUSED2008-05  void ScViewFunc::PaintWidthHeight( BOOL bColumns, SCCOLROW nStart, SCCOLROW nEnd )
+//UNUSED2008-05  {
+//UNUSED2008-05      SCTAB nTab = GetViewData()->GetTabNo();
+//UNUSED2008-05      ScDocument* pDoc = GetViewData()->GetDocument();
+//UNUSED2008-05  
+//UNUSED2008-05      USHORT nParts = PAINT_GRID;
+//UNUSED2008-05      SCCOL nStartCol = 0;
+//UNUSED2008-05      SCROW nStartRow = 0;
+//UNUSED2008-05      SCCOL nEndCol = MAXCOL;         // fuer Test auf Merge
+//UNUSED2008-05      SCROW nEndRow = MAXROW;
+//UNUSED2008-05      if ( bColumns )
+//UNUSED2008-05      {
+//UNUSED2008-05          nParts |= PAINT_TOP;
+//UNUSED2008-05          nStartCol = static_cast<SCCOL>(nStart);
+//UNUSED2008-05          nEndCol = static_cast<SCCOL>(nEnd);
+//UNUSED2008-05      }
+//UNUSED2008-05      else
+//UNUSED2008-05      {
+//UNUSED2008-05          nParts |= PAINT_LEFT;
+//UNUSED2008-05          nStartRow = nStart;
+//UNUSED2008-05          nEndRow = nEnd;
+//UNUSED2008-05      }
+//UNUSED2008-05      if (pDoc->HasAttrib( nStartCol,nStartRow,nTab, nEndCol,nEndRow,nTab,
+//UNUSED2008-05                           HASATTR_MERGED | HASATTR_OVERLAPPED ))
+//UNUSED2008-05      {
+//UNUSED2008-05          nStartCol = 0;
+//UNUSED2008-05          nStartRow = 0;
+//UNUSED2008-05      }
+//UNUSED2008-05      GetViewData()->GetDocShell()->PostPaint( nStartCol,nStartRow,nTab, MAXCOL,MAXROW,nTab, nParts );
+//UNUSED2008-05  }
 
 
 //----------------------------------------------------------------------------
Index: sc/source/ui/view/viewfun4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewfun4.cxx,v
retrieving revision 1.39
retrieving revision 1.39.32.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.39 -r1.39.32.3
--- sc/source/ui/view/viewfun4.cxx	11 Apr 2008 01:46:54 -0000	1.39
+++ sc/source/ui/view/viewfun4.cxx	13 May 2008 18:35:18 -0000	1.39.32.3
@@ -338,11 +338,11 @@
 	pDocSh->PostPaintGridAll();
 }
 
-//	Spelling Checker - Undo ok
-void ScViewFunc::DoSpellingChecker( BOOL bRecord )
-{
-    DoSheetConversion( ScConversionParam( SC_CONVERSION_SPELLCHECK ), bRecord );
-}
+//UNUSED2008-05  //	Spelling Checker - Undo ok
+//UNUSED2008-05  void ScViewFunc::DoSpellingChecker( BOOL bRecord )
+//UNUSED2008-05  {
+//UNUSED2008-05      DoSheetConversion( ScConversionParam( SC_CONVERSION_SPELLCHECK ), bRecord );
+//UNUSED2008-05  }
 
 void ScViewFunc::DoHangulHanjaConversion( BOOL bRecord )
 {
@@ -489,16 +489,16 @@
 }
 
 
-IMPL_LINK_INLINE_START( ScViewFunc, SpellError, void *, nLang )
-{
-	SvtLanguageTable aLangTab;
-	String aErr = aLangTab.GetString((LanguageType) (ULONG) nLang);
-	ErrorHandler::HandleError(*new StringErrorInfo(
-								ERRCODE_SVX_LINGU_LANGUAGENOTEXISTS, aErr) );
-
-	return 0;
-}
-IMPL_LINK_INLINE_END( ScViewFunc, SpellError, void *, nLang )
+//UNUSED2008-05  IMPL_LINK_INLINE_START( ScViewFunc, SpellError, void *, nLang )
+//UNUSED2008-05  {
+//UNUSED2008-05      SvtLanguageTable aLangTab;
+//UNUSED2008-05      String aErr = aLangTab.GetString((LanguageType) (ULONG) nLang);
+//UNUSED2008-05      ErrorHandler::HandleError(*new StringErrorInfo(
+//UNUSED2008-05                                  ERRCODE_SVX_LINGU_LANGUAGENOTEXISTS, aErr) );
+//UNUSED2008-05  
+//UNUSED2008-05      return 0;
+//UNUSED2008-05  }
+//UNUSED2008-05  IMPL_LINK_INLINE_END( ScViewFunc, SpellError, void *, nLang )
 
 // Pasten von FORMAT_FILE-Items
 //	wird nicht direkt aus Drop aufgerufen, sondern asynchron -> Dialoge sind erlaubt
Index: sc/source/ui/view/viewfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewfunc.cxx,v
retrieving revision 1.44
retrieving revision 1.44.22.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.44 -r1.44.22.1
--- sc/source/ui/view/viewfunc.cxx	18 Apr 2008 11:50:48 -0000	1.44
+++ sc/source/ui/view/viewfunc.cxx	13 May 2008 18:35:18 -0000	1.44.22.1
@@ -99,11 +99,11 @@
 {
 }
 
-ScViewFunc::ScViewFunc( Window* pParent, const ScViewFunc& rViewFunc, ScTabViewShell* pViewShell ) :
-	ScTabView( pParent, rViewFunc, pViewShell ),
-	bFormatValid( FALSE )
-{
-}
+//UNUSED2008-05  ScViewFunc::ScViewFunc( Window* pParent, const ScViewFunc& rViewFunc, ScTabViewShell* pViewShell ) :
+//UNUSED2008-05      ScTabView( pParent, rViewFunc, pViewShell ),
+//UNUSED2008-05      bFormatValid( FALSE )
+//UNUSED2008-05  {
+//UNUSED2008-05  }
 
 ScViewFunc::~ScViewFunc()
 {
