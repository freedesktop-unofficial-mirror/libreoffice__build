--- filter/source/config/fragments/types/calc_QPro.xcu.bak	2005-05-20 15:49:17.141606592 +0530
+++ filter/source/config/fragments/types/calc_QPro.xcu	2005-05-20 15:49:38.273394072 +0530
@@ -1,7 +1,7 @@
 <node oor:name="calc_QPro" oor:op="replace" oor:finalized="true" oor:mandatory="true">
                 <prop oor:name="DetectService"><value>com.sun.star.comp.calc.FormatDetector</value></prop>
                 <prop oor:name="URLPattern"/>
-                <prop oor:name="Extensions"><value>wb2</value></prop>
+                <prop oor:name="Extensions"><value>qpw wb2</value></prop>
                 <prop oor:name="MediaType"/>
                 <prop oor:name="Preferred"><value>true</value></prop>
                 <prop oor:name="PreferredFilter"><value>Quattro Pro</value></prop>
--- sc/source/ui/unoobj/scdetect.cxx.bak	2005-05-20 15:55:26.269490624 +0530
+++ sc/source/ui/unoobj/scdetect.cxx	2005-05-20 10:56:58.000000000 +0530
@@ -631,6 +631,13 @@
                             0x0010,
                             M_ENDE };
 
+                        const UINT16 pQPro12[] =
+                            { 0x00D0, 0x00EF, 0x0011, 0x00E0,
+                            M_ALT(4), 0x0001, 0x0002, // WB1, WB2
+                            0x0006, 0x0007,           // QPro 6/7 (?)
+                            0x0010,
+                            M_ENDE };
+
                         const UINT16 pDIF1[] =          // DIF mit CR-LF
                             {
                             'T', 'A', 'B', 'L', 'E',
@@ -666,6 +673,7 @@
                             pDIF2,
                             pSylk,
                             pQPro,
+                            pQPro12,	
                             pLotusNew,
                             pLotus2
                             };
@@ -683,6 +691,7 @@
                             pFilterDif,
                             pFilterSylk,
                             pFilterQPro,
+                            pFilterQPro,
                             pFilterLotus,
                             pFilterLotus
                             };
--- sc/source/filter/qpro/qpro.cxx.bak	2005-05-19 16:16:40.000000000 +0530
+++ sc/source/filter/qpro/qpro.cxx	2005-05-20 15:58:09.287708088 +0530
@@ -155,8 +154,17 @@
 FltError ScImportQuattroPro( SfxMedium &rMedium, ScDocument *pDoc )
 {
     FltError   eRet = eERR_OK;
-    ScQProReader aReader( rMedium, pDoc );
-    eRet = aReader.import( pDoc );
+    SvStream *pStream;
+    pStream = rMedium.GetInStream();
+    sal_uInt8 nVersion;
+    *pStream >> nVersion;
+    if( nVersion == 0x0000 )
+    {
+        ScQProReader aReader( rMedium, pDoc );     
+        eRet = aReader.import( pDoc );
+    }
+    else 
+        eRet = eERR_OK;        
     return eRet;
 }
