---
 scp2/source/ooo/file_library_ooo.scp |    6 ++--
 scp2/source/ooo/makefile.mk          |    4 ++
 scp2/source/ooo/ure.scp              |   54 +++++++++++++++++++++++++--------
 3 files changed, 48 insertions(+), 16 deletions(-)

diff --git scp2/source/ooo/file_library_ooo.scp scp2/source/ooo/file_library_ooo.scp
index 8fba1b2..fb70739 100644
--- scp2/source/ooo/file_library_ooo.scp
+++ scp2/source/ooo/file_library_ooo.scp
@@ -106,7 +106,7 @@ STD_UNO_LIB_FILE(gid_File_Lib_Charttools, charttools)
 STD_UNO_LIB_FILE(gid_File_Lib_Chartview, chartview)
 
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Lib_Cli_Oootypes_Assembly
     TXT_FILE_BODY;
@@ -125,7 +125,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 File gid_File_Lib_Policy_Cli_Oootypes_Assembly
     TXT_FILE_BODY;
     Styles = (PACKED, ASSEMBLY, DONTRENAMEINPATCH);
@@ -143,7 +143,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Lib_Policy_Cli_Oootypes_Config
     TXT_FILE_BODY;
diff --git scp2/source/ooo/makefile.mk scp2/source/ooo/makefile.mk
index 0777feb..2ecb10f 100644
--- scp2/source/ooo/makefile.mk
+++ scp2/source/ooo/makefile.mk
@@ -147,6 +147,10 @@ SCPDEFS+=-DSYSTEM_CURL
 SCPDEFS+=-DSYSTEM_STDLIBS
 .ENDIF
 
+.IF "$(ENABLE_MONO)" == "YES"
+SCPDEFS+=-DENABLE_MONO
+.ENDIF
+
 .IF "$(SYSTEM_SNDFILE)" == "YES"
 SCPDEFS+=-DSYSTEM_SNDFILE
 .ENDIF
diff --git scp2/source/ooo/ure.scp scp2/source/ooo/ure.scp
index 22aba30..0db7e2b 100755
--- scp2/source/ooo/ure.scp
+++ scp2/source/ooo/ure.scp
@@ -414,7 +414,7 @@ File gid_File_Dl_LogUnoUno
     Styles = (PACKED, VERSION_INDEPENDENT_COMP_ID);
 End
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 File gid_File_Dl_Cli_Uno
     TXT_FILE_BODY;
     Dir = SCP2_URE_DL_DIR;
@@ -424,7 +424,7 @@ File gid_File_Dl_Cli_Uno
 End
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Cli_Ure_Assembly
     TXT_FILE_BODY;
@@ -443,7 +443,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Ure_Assembly
     TXT_FILE_BODY;
@@ -462,7 +462,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC 
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Ure_Config
     TXT_FILE_BODY;
@@ -474,7 +474,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Cli_Basetypes_Assembly
     TXT_FILE_BODY;
@@ -493,7 +493,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Basetypes_Assembly
     TXT_FILE_BODY;
@@ -511,7 +511,7 @@ File gid_File_Dl_Policy_Cli_Basetypes_Assembly
 End
 
 #endif
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Basetypes_Config
     TXT_FILE_BODY;
@@ -524,7 +524,7 @@ End
 #endif
 
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Cli_Uretypes_Assembly
     TXT_FILE_BODY;
@@ -543,7 +543,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT || defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Uretypes_Assembly
     TXT_FILE_BODY;
@@ -562,7 +562,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC 
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Dl_Policy_Cli_Uretypes_Config
     TXT_FILE_BODY;
@@ -574,7 +574,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Lib_Cli_Cppuhelper_Assembly
     TXT_FILE_BODY;
@@ -593,7 +593,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Lib_Policy_Cli_Cppuhelper_Assembly
     TXT_FILE_BODY;
@@ -612,7 +612,7 @@ End
 
 #endif
 
-#if defined WNT && defined _MSC
+#if (defined WNT && defined _MSC) || defined ENABLE_MONO
 
 File gid_File_Lib_Policy_Cli_Cppuhelper_Config
     TXT_FILE_BODY;
@@ -624,6 +624,33 @@ End
 
 #endif
 
+#ifdef ENABLE_MONO
+
+File gid_File_Lib_Cli_Uno_Glue
+    TXT_FILE_BODY;
+    Styles = (PACKED);
+    Dir = SCP2_URE_DL_DIR;
+  #ifdef UNX
+    Name = STRING(CONCAT2(libcli_uno_glue,UNXSUFFIX));
+  #else
+    Name = "cli_uno_glue.dll";
+  #endif
+End
+
+File gid_File_Lib_Cli_Uno_Bridge_Assembly
+    TXT_FILE_BODY;
+    Styles = (PACKED, ASSEMBLY);
+    Name = "cli_uno_bridge.dll";
+    Dir = SCP2_URE_DL_DIR;
+    Assemblyname = "cli_uno_bridge";
+    PublicKeyToken = "ce2cb7e279207b9e";
+    Version = "1.0.0.0";
+    Culture = "neutral";
+    Attributes = "0";
+End
+
+#endif
+
 #if defined SOLAR_JAVA
 File gid_File_Dl_Jpipe
     TXT_FILE_BODY;
@@ -1250,6 +1250,7 @@ Module gid_Module_Root_Ure_Hidden
            	gid_File_Lib_Cli_Cppuhelper_Assembly,
             gid_File_Lib_Policy_Cli_Cppuhelper_Assembly,
 	        gid_File_Lib_Policy_Cli_Cppuhelper_Config,
+            gid_File_Lib_Cli_Uno_Glue,
             gid_File_Dl_Cppu,
             gid_Unixlink_File_Dl_Cppu,
             gid_File_Dl_Cppuhelper,
-- 
1.7.0.1

