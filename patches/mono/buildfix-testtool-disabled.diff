From ca0c301bf27bfc5d85f246cc1d130ca5af224a4d Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:59:36 +0200
Subject: [PATCH 380/878] buildfix-testtool-disabled.diff

---
 testtools/source/bridgetest/idl/makefile.mk |    6 ++++++
 testtools/util/makefile.pmk                 |    2 +-
 2 files changed, 7 insertions(+), 1 deletions(-)

diff --git a/testtools/source/bridgetest/idl/makefile.mk b/testtools/source/bridgetest/idl/makefile.mk
index 14f512b..8637b97 100644
--- a/testtools/source/bridgetest/idl/makefile.mk
+++ b/testtools/source/bridgetest/idl/makefile.mk
@@ -55,6 +55,8 @@ CLIMAKERFLAGS =
 CLIMAKERFLAGS += --verbose
 .ENDIF
 
+
+.IF "$(BUILD_FOR_CLI)" == "true"
 ALLTAR: $(MISC)$/$(TARGET).cppumaker.done \
     $(MISC)$/$(TARGET).javamaker.done \
     $(BIN)$/cli_types_bridgetest.dll 
@@ -63,6 +65,10 @@ $(BIN)$/cli_types_bridgetest.dll: $(BIN)$/bridgetest.rdb
     $(CLIMAKER) $(CLIMAKERFLAGS) --out $@ -r $(SOLARBINDIR)$/cli_uretypes.dll \
         -X $(SOLARBINDIR)$/types.rdb $< 
     $(TOUCH) $@
+.ELSE
+ALLTAR: $(MISC)$/$(TARGET).cppumaker.done \
+    $(MISC)$/$(TARGET).javamaker.done
+.ENDIF
 
 .ENDIF
 .ENDIF # GUI, WNT
diff --git a/testtools/util/makefile.pmk b/testtools/util/makefile.pmk
index 84a7eb9..ff3eb76 100644
--- a/testtools/util/makefile.pmk
+++ b/testtools/util/makefile.pmk
@@ -27,7 +27,7 @@
 
 # no translation here anyway
 .IF "$(L10N_framework)"==""
-.IF "$(COM)" == "MSC"
+.IF "$(COM)" == "MSC" || "$(ENABLE_MONO)" == "YES"
 BUILD_FOR_CLI = "true"
 CFLAGSENABLESYMBOLS:=-Z7
 .ENDIF
-- 
1.7.0.1

