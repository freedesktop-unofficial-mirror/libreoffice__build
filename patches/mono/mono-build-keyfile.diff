--- cli_ure/source/basetypes/makefile.mk.old	2009-12-18 13:21:31.000000000 +0000
+++ cli_ure/source/basetypes/makefile.mk	2009-12-18 18:29:50.000000000 +0000
@@ -58,8 +58,8 @@ POLICY_ASSEMBLY_FILE=$(BIN)$/$(CLI_BASET
 ALLTAR : \
     $(BIN)$/cli_basetypes.dll \
     $(POLICY_ASSEMBLY_FILE)
-    
-.IF "$(CCNUMVER)" >= "001399999999"
+
+.IF "$(COM)" != "MSC" || "$(CCNUMVER)" >= "001399999999"
 CSCFLAGS+=-keyfile:"$(BIN)$/cliuno.snk"
 .ENDIF
 
@@ -74,7 +74,7 @@ CSFILES = \
     uno$/PolymorphicType.cs \
     $(ASSEMBLY_ATTRIBUTES)
 
-.IF "$(CCNUMVER)" <= "001399999999"
+.IF "$(COM)" == "MSC" && "$(CCNUMVER)" <= "001399999999"
 $(ASSEMBLY_ATTRIBUTES) : assembly.cs makefile.mk $(BIN)$/cliuno.snk $(BIN)$/cliureversion.mk 
     $(GNUCOPY) -p assembly.cs $@
     echo $(ECHOQUOTE) \
--- cli_ure/source/bootstrap/makefile.mk.old	2009-12-18 13:21:31.000000000 +0000
+++ cli_ure/source/bootstrap/makefile.mk	2009-12-18 18:44:44.000000000 +0000
@@ -75,7 +75,6 @@ $(ASSEMBLY_ATTRIBUTES) .PHONY: assembly.
 	$(GNUCOPY) -p assembly.cs $@
 	+echo $(ECHOQUOTE) \
 	[assembly:System.Reflection.AssemblyVersion( "$(CLI_CPPUHELPER_NEW_VERSION)" )] $(ECHOQUOTE) \
-	$(ECHOQUOTE) [assembly:System.Reflection.AssemblyKeyFile($(ASSEMBLY_KEY))] $(ECHOQUOTE) \
 	>> $@
 
 EXTERNAL_DIR=$(PRJ)$/..$/external/cli
@@ -91,6 +90,7 @@ $(BIN)$/cli_cppuhelper.dll : $(CSFILES)
 	+$(CSC) $(CSCFLAGS) \
 		-target:library \
 		-out:$@ \
+		-keyfile:$(BIN)$/cliuno.snk \
 		-reference:$(OUT)$/bin$/cli_uretypes.dll \
 		-reference:System.dll \
 		$(CSFILES)
--- cli_ure/prj/d.lst.old	2009-04-06 16:41:58.000000000 +0000
+++ cli_ure/prj/d.lst	2009-04-06 16:41:58.000000000 +0000
@@ -11,4 +11,6 @@
 
 ..\%__SRC%\bin\cliuno.snk %_DEST%\bin%_EXT%\cliuno.snk
 
-..\%__SRC%\bin\cliureversion.mk %_DEST%\bin%_EXT%\cliureversion.mk
\ No newline at end of file
+..\%__SRC%\bin\cliureversion.mk %_DEST%\bin%_EXT%\cliureversion.mk
+
+..\%__SRC%\bin\cliuno.snk %_DEST%\bin%_EXT%\cliuno.snk
--- cli_ure/source/ure/makefile.mk.old	2009-12-18 13:21:31.000000000 +0000
+++ cli_ure/source/ure/makefile.mk	2009-12-18 18:33:45.000000000 +0000
@@ -60,7 +60,7 @@ ALLTAR : \
     $(BIN)$/cli_ure.dll \
     $(POLICY_ASSEMBLY_FILE)
 
-.IF "$(CCNUMVER)" >= "001399999999"
+.IF "$(COM)" != "MSC" || "$(CCNUMVER)" >= "001399999999"
 CSCFLAGS+=-keyfile:"$(BIN)$/cliuno.snk"
 .ENDIF
 
@@ -71,7 +71,7 @@ CSFILES = \
     uno$/util$/WeakComponentBase.cs	\
     $(ASSEMBLY_ATTRIBUTES)
 
-.IF "$(CCNUMVER)" <= "001399999999"
+.IF "$(COM)" == "MSC" && "$(CCNUMVER)" <= "001399999999"
 $(ASSEMBLY_ATTRIBUTES) : assembly.cs makefile.mk $(BIN)$/cliuno.snk $(BIN)$/cliureversion.mk 
     $(GNUCOPY) -p assembly.cs $@
     echo $(ECHOQUOTE) \
