From 4f0425eaabf2431ce04f72b08bdda7378035b55a Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:02:29 +0200
Subject: [PATCH 449/768] autocorrect-accidental-caps-lock-sc.diff

---
 sc/source/ui/app/inputhdl.cxx |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

diff --git sc/source/ui/app/inputhdl.cxx sc/source/ui/app/inputhdl.cxx
index 36700fc..c500b5c 100644
--- sc/source/ui/app/inputhdl.cxx
+++ sc/source/ui/app/inputhdl.cxx
@@ -2393,10 +2393,12 @@ void ScInputHandler::EnterHandler( BYTE nBlockMode )
             lcl_SelectionToEnd(pTableView);
         }
 
+        Window* pFrameWin = pActiveViewSh ? pActiveViewSh->GetFrameWin() : NULL;
+
         if (pTopView)
             pTopView->CompleteAutoCorrect();	// #59759# CompleteAutoCorrect fuer beide Views
         if (pTableView)
-            pTableView->CompleteAutoCorrect();
+            pTableView->CompleteAutoCorrect(pFrameWin);
         aString = GetEditText(pEngine);
     }
     lcl_RemoveTabs(aString);
@@ -3141,8 +3143,11 @@ BOOL ScInputHandler::KeyInput( const KeyEvent& rKEvt, BOOL bStartEdit /* = FALSE
                 else
                 {
                     if (pTableView)
-                        if ( pTableView->PostKeyEvent( rKEvt ) )
+                    {
+                        Window* pFrameWin = pActiveViewSh ? pActiveViewSh->GetFrameWin() : NULL;
+                        if ( pTableView->PostKeyEvent( rKEvt, pFrameWin ) )
                             bUsed = TRUE;
+                    }
                     if (pTopView)
                         if ( pTopView->PostKeyEvent( rKEvt ) )
                             bUsed = TRUE;
-- 
1.7.0.1

