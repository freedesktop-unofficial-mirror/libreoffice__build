From c29f260da07b9c3a90f5e45a23e2ef294338a8bc Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:09:02 +0200
Subject: [PATCH 744/768] vbahelper-optionality-fix.diff

---
 solenv/inc/libs.mk                     |    2 ++
 sw/util/makefile.mk                    |    2 ++
 vbahelper/source/msforms/makefile.mk   |    5 +++++
 vbahelper/source/vbahelper/makefile.mk |    5 +++++
 vbahelper/util/makefile.mk             |    4 ++++
 5 files changed, 18 insertions(+), 0 deletions(-)

diff --git solenv/inc/libs.mk solenv/inc/libs.mk
index 1daf69c..ebb3dd0 100644
--- solenv/inc/libs.mk
+++ solenv/inc/libs.mk
@@ -185,7 +185,9 @@ SAXLIB=-lsax$(DLLPOSTFIX)
 MAILLIB=-lmail
 DOCMGRLIB=-ldmg$(DLLPOSTFIX)
 BASICLIB=-lsb$(DLLPOSTFIX)
+.IF "$(ENABLE_VBA)"=="YES"
 VBAHELPERLIB=-lvbahelper$(DLLPOSTFIX)
+.ENDIF
 DBTOOLSLIB=-ldbtools$(DLLPOSTFIX)
 HM2LIBSH=-lhmwrpdll
 HM2LIBST=-lhmwrap
diff --git sw/util/makefile.mk sw/util/makefile.mk
index f041898..4d7e06d 100644
--- sw/util/makefile.mk
+++ sw/util/makefile.mk
@@ -339,6 +339,7 @@ SHL4STDLIBS= \
     $(BASICLIB)     \
     $(I18NUTILLIB)
 
+.IF "$(ENABLE_VBA)" == "YES"
 #target vba
 TARGET_VBA=vbaswobj
 SHL5TARGET=$(TARGET_VBA)$(DLLPOSTFIX).uno
@@ -372,5 +373,6 @@ SHL5STDLIBS= \
 
 SHL5DEPN=$(SHL1TARGETN)
 SHL5LIBS=$(SLB)$/$(TARGET_VBA).lib
+.ENDIF # .IF "$(ENABLE_VBA)" == "YES"
 
 .INCLUDE :  target.mk
diff --git vbahelper/source/msforms/makefile.mk vbahelper/source/msforms/makefile.mk
index 9c24c77..7c61e43 100644
--- vbahelper/source/msforms/makefile.mk
+++ vbahelper/source/msforms/makefile.mk
@@ -34,6 +34,11 @@ VISIBILITY_HIDDEN=TRUE
 
 # --- Settings -----------------------------------------------------
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
+
 .INCLUDE :  settings.mk
 
 SLOFILES=\
diff --git vbahelper/source/vbahelper/makefile.mk vbahelper/source/vbahelper/makefile.mk
index 88f8f53..3284ec5 100644
--- vbahelper/source/vbahelper/makefile.mk
+++ vbahelper/source/vbahelper/makefile.mk
@@ -33,6 +33,11 @@ ENABLE_EXCEPTIONS := TRUE
 VISIBILITY_HIDDEN=TRUE
 # --- Settings -----------------------------------------------------
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
+
 .INCLUDE :  settings.mk
 
 SLOFILES=\
diff --git vbahelper/util/makefile.mk vbahelper/util/makefile.mk
index 98adae4..49bc8e7 100644
--- vbahelper/util/makefile.mk
+++ vbahelper/util/makefile.mk
@@ -34,6 +34,10 @@ TARGET=vbahelper
 
 .INCLUDE :  settings.mk
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
 
 TARGET_HELPER=vbahelper
 
-- 
1.7.0.1

