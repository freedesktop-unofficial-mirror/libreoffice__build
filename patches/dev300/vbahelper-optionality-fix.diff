From 593d089b61f58466f1a9cadb84aff79ca7b34402 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:09:02 +0200
Subject: [PATCH 847/878] vbahelper-optionality-fix.diff

---
 solenv/inc/libs.mk                     |    2 ++
 sw/util/makefile.mk                    |    2 ++
 vbahelper/source/msforms/makefile.mk   |    5 +++++
 vbahelper/source/vbahelper/makefile.mk |    5 +++++
 vbahelper/util/makefile.mk             |    4 ++++
 5 files changed, 18 insertions(+), 0 deletions(-)

diff --git a/solenv/inc/libs.mk b/solenv/inc/libs.mk
index 5db94c2..6bd5e7f 100644
--- a/solenv/inc/libs.mk
+++ b/solenv/inc/libs.mk
@@ -186,7 +186,9 @@ SAXLIB=-lsax$(DLLPOSTFIX)
 MAILLIB=-lmail
 DOCMGRLIB=-ldmg$(DLLPOSTFIX)
 BASICLIB=-lsb$(DLLPOSTFIX)
+.IF "$(ENABLE_VBA)"=="YES"
 VBAHELPERLIB=-lvbahelper$(DLLPOSTFIX)
+.ENDIF
 DBTOOLSLIB=-ldbtools$(DLLPOSTFIX)
 HM2LIBSH=-lhmwrpdll
 HM2LIBST=-lhmwrap
diff --git a/sw/util/makefile.mk b/sw/util/makefile.mk
index 6730073..cce04d0 100644
--- a/sw/util/makefile.mk
+++ b/sw/util/makefile.mk
@@ -340,6 +340,7 @@ SHL4STDLIBS= \
     $(BASICLIB)     \
     $(I18NUTILLIB)
 
+.IF "$(ENABLE_VBA)" == "YES"
 #target vba
 TARGET_VBA=vbaswobj
 SHL5TARGET=$(TARGET_VBA)$(DLLPOSTFIX).uno
@@ -376,5 +377,6 @@ SHL5STDLIBS+=$(SHELLLIB)
 
 SHL5DEPN=$(SHL1TARGETN)
 SHL5LIBS=$(SLB)$/$(TARGET_VBA).lib
+.ENDIF # .IF "$(ENABLE_VBA)" == "YES"
 
 .INCLUDE :  target.mk
diff --git a/vbahelper/source/msforms/makefile.mk b/vbahelper/source/msforms/makefile.mk
index d45b632..3c1d4ea 100644
--- a/vbahelper/source/msforms/makefile.mk
+++ b/vbahelper/source/msforms/makefile.mk
@@ -38,6 +38,11 @@ VISIBILITY_HIDDEN=TRUE
 
 # --- Settings -----------------------------------------------------
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
+
 .INCLUDE :  settings.mk
 
 CDEFS+=-DVBA_OOBUILD_HACK
diff --git a/vbahelper/source/vbahelper/makefile.mk b/vbahelper/source/vbahelper/makefile.mk
index db4a122..bbce04c 100644
--- a/vbahelper/source/vbahelper/makefile.mk
+++ b/vbahelper/source/vbahelper/makefile.mk
@@ -37,6 +37,11 @@ ENABLE_EXCEPTIONS := TRUE
 VISIBILITY_HIDDEN=TRUE
 # --- Settings -----------------------------------------------------
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
+
 .INCLUDE :  settings.mk
 
 SLOFILES=\
diff --git a/vbahelper/util/makefile.mk b/vbahelper/util/makefile.mk
index 66032e6..6983a76 100644
--- a/vbahelper/util/makefile.mk
+++ b/vbahelper/util/makefile.mk
@@ -38,6 +38,10 @@ TARGET=vbahelper
 
 .INCLUDE :  settings.mk
 
+.IF "$(ENABLE_VBA)" == "NO"
+dummy:
+    @echo "Nothing to build"
+.ENDIF
 
 TARGET_HELPER=vbahelper
 
-- 
1.7.0.1

