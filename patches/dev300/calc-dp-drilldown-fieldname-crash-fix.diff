From 71def71d82b49e8d728983267081570da3a82567 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:43 +0200
Subject: [PATCH 224/878] calc-dp-drilldown-fieldname-crash-fix.diff

---
 sc/source/ui/dbgui/pvfundlg.cxx |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/sc/source/ui/dbgui/pvfundlg.cxx b/sc/source/ui/dbgui/pvfundlg.cxx
index 8609bfc..03de0b8 100644
--- a/sc/source/ui/dbgui/pvfundlg.cxx
+++ b/sc/source/ui/dbgui/pvfundlg.cxx
@@ -739,9 +739,12 @@ ScDPShowDetailDlg::ScDPShowDetailDlg( Window* pParent, ScDPObject& rDPObj, USHOR
             const ScDPSaveDimension* pDimension = pSaveData ? pSaveData->GetExistingDimensionByName(aName) : 0;
             if ( !pDimension || (pDimension->GetOrientation() != nOrient) )
             {
-                const OUString* pLayoutName = pDimension->GetLayoutName();
-                if (pLayoutName)
-                    aName = *pLayoutName;
+                if (pDimension)
+                {
+                    const OUString* pLayoutName = pDimension->GetLayoutName();
+                    if (pLayoutName)
+                        aName = *pLayoutName;
+                }
                 maLbDims.InsertEntry( aName );
                 maNameIndexMap.insert(DimNameIndexMap::value_type(aName, nDim));
             }
-- 
1.7.0.1

