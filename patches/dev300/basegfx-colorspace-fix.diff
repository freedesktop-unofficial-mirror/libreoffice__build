From 08489bfa02d5183b615ce86245ef0342d009a6af Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:09:01 +0200
Subject: [PATCH 846/878] basegfx-colorspace-fix.diff

---
 basegfx/source/color/bcolortools.cxx |    2 +-
 basegfx/test/basegfx2d.cxx           |    2 ++
 2 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/basegfx/source/color/bcolortools.cxx b/basegfx/source/color/bcolortools.cxx
index a84e222..8348623 100644
--- a/basegfx/source/color/bcolortools.cxx
+++ b/basegfx/source/color/bcolortools.cxx
@@ -61,7 +61,7 @@ namespace basegfx { namespace tools
             else if( g == maxVal )
                 h = 2.0 + (b - r)/d;
             else
-                h = 4.0 + (r - h)/d;
+                h = 4.0 + (r - g)/d;
 
             h *= 60.0;
 
diff --git a/basegfx/test/basegfx2d.cxx b/basegfx/test/basegfx2d.cxx
index e7af563..6ec76ac 100644
--- a/basegfx/test/basegfx2d.cxx
+++ b/basegfx/test/basegfx2d.cxx
@@ -1494,6 +1494,8 @@ public:
                                tools::rgb2hsl(maMagenta) == BColor(300,1,0.5));
         CPPUNIT_ASSERT_MESSAGE("cyan", 
                                tools::rgb2hsl(maCyan) == BColor(180,1,0.5));
+        CPPUNIT_ASSERT_MESSAGE("third hue case",
+                               tools::rgb2hsl(BColor(0,0.5,1)) == BColor(210,1,0.5));
 
         CPPUNIT_ASSERT_MESSAGE("roundtrip white", 
                                tools::hsl2rgb(tools::rgb2hsl(maWhite)) == maWhite);
-- 
1.7.0.1

