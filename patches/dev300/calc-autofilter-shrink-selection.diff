From e5b572ad1006d7811c8c3b61d44e6d488a939e84 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:15 +0200
Subject: [PATCH 199/878] calc-autofilter-shrink-selection.diff

---
 sc/source/ui/view/dbfunc.cxx |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/sc/source/ui/view/dbfunc.cxx b/sc/source/ui/view/dbfunc.cxx
index d31a785..d9acfff 100644
--- a/sc/source/ui/view/dbfunc.cxx
+++ b/sc/source/ui/view/dbfunc.cxx
@@ -299,7 +299,7 @@ void ScDBFunc::ToggleAutoFilter()
 
     ScQueryParam	aParam;
     ScDocument*		pDoc	= GetViewData()->GetDocument();
-    ScDBData*		pDBData = GetDBData( FALSE );
+    ScDBData*		pDBData = GetDBData(false, SC_DB_MAKE, false, true);
 
     pDBData->SetByRow( TRUE );				//! Undo, vorher abfragen ??
     pDBData->GetQueryParam( aParam );
-- 
1.7.0.1

