---
 sw/source/ui/shells/textsh1.cxx |   15 ++++++++++++++-
 1 files changed, 14 insertions(+), 1 deletions(-)

diff --git sw/source/ui/shells/textsh1.cxx sw/source/ui/shells/textsh1.cxx
index 1e3b6ff..6ce6c6f 100644
--- sw/source/ui/shells/textsh1.cxx
+++ sw/source/ui/shells/textsh1.cxx
@@ -1596,7 +1596,6 @@ void SwTextShell::GetState( SfxItemSet &rSet )
                                 GetViewFrame()->GetChildWindow( nWhich ) ));
                 break;
             case FN_EDIT_HYPERLINK:
-            case FN_REMOVE_HYPERLINK:
             case FN_COPY_HYPERLINK_LOCATION:
             {
                 SfxItemSet aSet(GetPool(),
@@ -1609,6 +1608,20 @@ void SwTextShell::GetState( SfxItemSet &rSet )
                 }
             }
             break;
+            case FN_REMOVE_HYPERLINK:
+            {
+                SfxItemSet aSet(GetPool(),
+                                RES_TXTATR_INETFMT,
+                                RES_TXTATR_INETFMT);
+                rSh.GetCurAttr(aSet);
+
+        // If a hyperlink is selected, either alone or along with other text...
+                if( ((SFX_ITEM_DONTCARE & aSet.GetItemState( RES_TXTATR_INETFMT, TRUE )) == 0) || rSh.HasReadonlySel())
+                {
+                    rSet.DisableItem(nWhich);
+                }
+            }
+            break;
             case SID_TRANSLITERATE_HALFWIDTH:
             case SID_TRANSLITERATE_FULLWIDTH:
             case SID_TRANSLITERATE_HIRAGANA:
-- 
1.7.0.1

