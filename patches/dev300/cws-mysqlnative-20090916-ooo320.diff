Index: mysqlcppconn/mysql_config.pmk
===================================================================
--- mysqlcppconn/mysql_config.pmk	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/mysql_config.pmk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,55 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+#   OpenOffice.org - a multi-platform office productivity suite
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+#     but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+.IF "$(SYSTEM_MYSQL)" == "YES"
+  CFLAGS+=-DSYSTEM_MYSQL
+.ELSE
+  .IF "$(LIBMYSQL_PATH)" == ""
+    alltar:
+      @echo "need to have LIBMYSQL_PATH set to the location where libmysql (also known as 'MySQL Connector/C') is installed"
+      @force_dmake_to_error
+  .ENDIF
+.ENDIF
+
+.IF "$(GUI)"!="WNT"
+
+.IF "$(SYSTEM_MYSQL)" == "YES"
+    MYSQL_LIB+=-lmysqlcppconn
+.ENDIF
+
+.ELSE   # "$(GUI)"!="WNT"
+
+CFLAGS+=-DCPPDBC_WIN32 -D_CRT_SECURE_NO_WARNINGS -D_SCL_SECURE_NO_WARNINGS
+
+.ENDIF  # "$(GUI)"!="WNT"
+
+.IF "$(SYSTEM_MYSQL)" != "YES"
+    MYSQL_INC+=-I$(LIBMYSQL_PATH)$/include
+.ENDIF
+
+CFLAGS+=-I$(PRJINC) -I$(PRJINC)$/cppconn $(MYSQL_INC) -DCPPCONN_LIB_BUILD
+
Index: mysqlcppconn/makefile.mk
===================================================================
--- mysqlcppconn/makefile.mk	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/makefile.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,88 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# $RCSfile: makefile.mk,v $
+#
+# $Revision: 1.22 $
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+PRJ=.
+
+PRJNAME=mysqlcppconn
+TARGET=so_mysqlcppconn
+
+EXT_PROJECT_NAME=mysql-connector-cpp
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :	settings.mk
+
+# --- Files --------------------------------------------------------
+
+TARFILE_NAME=$(EXT_PROJECT_NAME)
+ADDITIONAL_FILES=\
+ 				driver$/makefile.mk \
+ 				driver$/nativeapi$/makefile.mk \
+ 				driver$/nativeapi$/binding_config.h \
+ 				cppconn$/config.h
+
+CONVERTFILES=\
+				cppconn$/build_config.h
+
+PATCH_FILE_NAME=$(TARFILE_NAME).patch
+
+BUILD_DIR=driver
+BUILD_ACTION = \
+            cd nativeapi \
+         && $(MAKE) $(MFLAGS) $(CALLMACROS) \
+         && cd .. \
+         && $(MAKE) $(MFLAGS) $(CALLMACROS)
+
+# --- Targets ------------------------------------------------------
+
+.INCLUDE : set_ext.mk
+.INCLUDE : target.mk
+.INCLUDE : tg_ext.mk
+
+# --- post-build ---------------------------------------------------
+
+# "normalize" the output structure, in that the C/C++ headers are
+# copied to the canonic location in OUTPATH
+# The allows, later on, to use the standard mechanisms to deliver those
+# files, instead of delivering them out of OUTPATH/misc/build/..., which
+# could cause problems
+
+NORMALIZE_FLAG_FILE=so_normalized_$(TARGET)
+
+$(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE) : $(PACKAGE_DIR)$/$(BUILD_FLAG_FILE)
+    @$(GNUCOPY) -r $(PACKAGE_DIR)$/$(EXT_PROJECT_NAME)$/driver$/mysql_driver.h $(INCCOM)
+    -@$(MKDIRHIER) $(INCCOM)$/cppconn
+    @$(GNUCOPY) -r $(PACKAGE_DIR)$/$(EXT_PROJECT_NAME)$/cppconn$/* $(INCCOM)$/cppconn
+    @$(TOUCH) $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
+
+normalize: $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
+
+$(PACKAGE_DIR)$/$(PREDELIVER_FLAG_FILE) : normalize

Index: mysqlcppconn/cppconn_config.pmk
===================================================================
--- mysqlcppconn/cppconn_config.pmk	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/cppconn_config.pmk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,33 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+#   OpenOffice.org - a multi-platform office productivity suite
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+#     but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+PRJNAME = mysqlcppconn
+ENABLE_EXCEPTIONS = TRUE
+USE_LDUMP2 = TRUE
+EXTERNAL_WARNINGS_NOT_ERRORS = TRUE
+
+CPPCONN_NATIVEAPI = cppconn_nativeapi
Index: mysqlcppconn/mysql-connector-cpp.patch
===================================================================
--- mysqlcppconn/mysql-connector-cpp.patch	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/mysql-connector-cpp.patch	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,385 @@
+--- misc/mysql-connector-cpp/cppconn/build_config.h	2009-08-13 17:13:46.000000000 +0200
++++ misc/build/mysql-connector-cpp/cppconn/build_config.h	2009-09-11 09:41:41.150391316 +0200
+@@ -1,36 +1,34 @@
+-/*
+-   Copyright 2007 - 2008 MySQL AB, 2008 - 2009 Sun Microsystems, Inc.  All rights reserved.
+-
+-   The MySQL Connector/C++ is licensed under the terms of the GPL
+-   <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>, like most
+-   MySQL Connectors. There are special exceptions to the terms and
+-   conditions of the GPL as it is applied to this software, see the
+-   FLOSS License Exception
+-   <http://www.mysql.com/about/legal/licensing/foss-exception.html>.
+-*/
+-
+-#ifndef _SQL_BUILD_CONFIG_H_
+-#define _SQL_BUILD_CONFIG_H_
+-
+-#ifndef CPPCONN_PUBLIC_FUNC
+-
+-#if defined(_WIN32)
+- // mysqlcppconn_EXPORTS is added by cmake and defined for dynamic lib build only
+-  #ifdef mysqlcppconn_EXPORTS
+-    #define CPPCONN_PUBLIC_FUNC __declspec(dllexport)
+-  #else
+-    // this is for static build
+-    #ifdef CPPCONN_LIB_BUILD
+-      #define CPPCONN_PUBLIC_FUNC
+-    #else
+-      // this is for clients using dynamic lib
+-      #define CPPCONN_PUBLIC_FUNC __declspec(dllimport)
+-    #endif
+-  #endif
+-#else
+-  #define CPPCONN_PUBLIC_FUNC
+-#endif
+-
+-#endif    //#ifndef CPPCONN_PUBLIC_FUNC
+-
+-#endif    //#ifndef _SQL_BUILD_CONFIG_H_
++/*
++   Copyright 2007 - 2008 MySQL AB, 2008 - 2009 Sun Microsystems, Inc.  All rights reserved.
++
++   The MySQL Connector/C++ is licensed under the terms of the GPL
++   <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>, like most
++   MySQL Connectors. There are special exceptions to the terms and
++   conditions of the GPL as it is applied to this software, see the
++   FLOSS License Exception
++   <http://www.mysql.com/about/legal/licensing/foss-exception.html>.
++*/
++
++#ifndef _SQL_BUILD_CONFIG_H_
++#define _SQL_BUILD_CONFIG_H_
++
++#ifndef _SAL_TYPES_H_
++#include <sal/types.h>
++#endif
++  
++ // mysqlcppconn_EXPORTS is added by cmake and defined for dynamic lib build only
++  #ifdef mysqlcppconn_EXPORTS
++    #define CPPCONN_PUBLIC_FUNC SAL_DLLPUBLIC_EXPORT
++  #else
++    // this is for static build
++    #ifdef CPPCONN_LIB_BUILD
++      #define CPPCONN_PUBLIC_FUNC
++    #else
++      // this is for clients using dynamic lib
++      #define CPPCONN_PUBLIC_FUNC SAL_DLLPUBLIC_IMPORT
++    #endif
++  #endif
++
++  #define CPPCONN_PUBLIC_EXCEPTION SAL_EXCEPTION_DLLPUBLIC_EXPORT
++
++#endif    //#ifndef _SQL_BUILD_CONFIG_H_
+--- misc/mysql-connector-cpp/cppconn/config.h	2009-08-14 10:17:38.234375000 +0200
++++ misc/build/mysql-connector-cpp/cppconn/config.h	2009-08-14 09:56:37.000000000 +0200
+@@ -1 +1,34 @@
+-dummy
++#include <sal/types.h>
++
++#define HAVE_FUNCTION_STRTOL 1
++#define HAVE_FUNCTION_STRTOUL 1
++#define HAVE_FUNCTION_STRTOL 1
++#define HAVE_FUNCTION_STRTOULL 1
++
++#if defined(MACOSX) || defined(SOLARIS) || defined(LINUX)
++    #define HAVE_STDINT_H
++    #define HAVE_INTTYPES_H
++#endif
++
++#ifdef HAVE_STDINT_H
++#include <stdint.h>
++#endif
++
++#ifdef HAVE_INTTYPES_H
++#include <inttypes.h>
++#endif
++
++#if !defined(HAVE_STDINT_H) && !defined(HAVE_INTTYPES_H) 
++
++// if we do not have the standard C99 integer types, then define them based on the respective SAL types
++#if !defined(_SYS_TYPES_H)
++typedef sal_Int8    int8_t;
++typedef sal_Int16   int16_t;
++typedef sal_Int32   int32_t;
++#endif // !defined(_SYS_TYPES_H)
++typedef sal_uInt8   uint8_t;
++typedef sal_uInt16  uint16_t;
++typedef sal_uInt32  uint32_t;
++typedef sal_Int64   int64_t;
++typedef sal_uInt64  uint64_t;
++#endif // !defined(HAVE_STDINT_H) && !defined(HAVE_INTTYPES_H)
+--- misc/mysql-connector-cpp/cppconn/connection.h	2009-08-13 17:13:46.000000000 +0200
++++ misc/build/mysql-connector-cpp/cppconn/connection.h	2009-08-14 09:56:37.000000000 +0200
+@@ -13,7 +13,6 @@
+ #define _SQL_CONNECTION_H_
+ 
+ #include <map>
+-#include <boost/variant.hpp>
+ 
+ #include "build_config.h"
+ #include "warning.h"
+@@ -22,8 +21,54 @@
+ namespace sql
+ {
+ 
+-
+-typedef boost::variant<int, double, bool, sql::SQLString > ConnectPropertyVal;
++// hack around the non-existent ::boost::variant in OOo 3.1 build env
++struct ConnectPropertyVal
++{
++    sql::SQLString valString;
++    int            valInt;
++    bool           valBool;
++
++    ConnectPropertyVal()
++    {
++        reset();
++    }
++    ConnectPropertyVal( const sql::SQLString& _val )
++    {
++        *this = _val;
++    }
++    ConnectPropertyVal( const int _val )
++    {
++        *this = _val;
++    }
++    ConnectPropertyVal( const bool _val )
++    {
++        *this = _val;
++    }
++    ConnectPropertyVal& operator=( const sql::SQLString& _val )
++    {
++        reset();
++        valString = _val;
++        return *this;
++    }
++    ConnectPropertyVal& operator=( const int _val )
++    {
++        reset();
++        valInt = _val;
++        return *this;
++    }
++    ConnectPropertyVal& operator=( const bool _val )
++    {
++        reset();
++        valBool = _val;
++        return *this;
++    }
++    void reset()
++    {
++        valString = std::string();
++        valInt = 0;
++        valBool = false;
++    }
++};
+ 
+ typedef std::map< sql::SQLString, ConnectPropertyVal > ConnectOptionsMap;
+ 
+--- misc/mysql-connector-cpp/cppconn/exception.h	2009-08-20 17:51:23.000000000 +0200
++++ misc/build/mysql-connector-cpp/cppconn/exception.h	2009-09-11 09:41:41.076379817 +0200
+@@ -37,7 +37,7 @@
+ #pragma warning(push)
+ #pragma warning(disable: 4275)
+ #endif
+-class CPPCONN_PUBLIC_FUNC SQLException : public std::runtime_error
++class CPPCONN_PUBLIC_EXCEPTION SQLException : public std::runtime_error
+ {
+ #ifdef _WIN32
+ #pragma warning(pop)
+@@ -83,26 +83,26 @@
+ 	MEMORY_ALLOC_OPERATORS(SQLException)
+ };
+ 
+-struct CPPCONN_PUBLIC_FUNC MethodNotImplementedException : public SQLException
++struct CPPCONN_PUBLIC_EXCEPTION MethodNotImplementedException : public SQLException
+ {
+ 	MethodNotImplementedException(const MethodNotImplementedException& e) : SQLException(e.what(), e.sql_state, e.errNo) { }
+ 	MethodNotImplementedException(const std::string& reason) : SQLException(reason, "", 0) {}
+ };
+ 
+-struct CPPCONN_PUBLIC_FUNC InvalidArgumentException : public SQLException
++struct CPPCONN_PUBLIC_EXCEPTION InvalidArgumentException : public SQLException
+ {
+ 	InvalidArgumentException(const InvalidArgumentException& e) : SQLException(e.what(), e.sql_state, e.errNo) { }
+ 	InvalidArgumentException(const std::string& reason) : SQLException(reason, "", 0) {}
+ };
+ 
+-struct CPPCONN_PUBLIC_FUNC InvalidInstanceException : public SQLException
++struct CPPCONN_PUBLIC_EXCEPTION InvalidInstanceException : public SQLException
+ {
+ 	InvalidInstanceException(const InvalidInstanceException& e) : SQLException(e.what(), e.sql_state, e.errNo) { }
+ 	InvalidInstanceException(const std::string& reason) : SQLException(reason, "", 0) {}
+ };
+ 
+ 
+-struct CPPCONN_PUBLIC_FUNC NonScrollableException : public SQLException
++struct CPPCONN_PUBLIC_EXCEPTION NonScrollableException : public SQLException
+ {
+ 	NonScrollableException(const NonScrollableException& e) : SQLException(e.what(), e.sql_state, e.errNo) { }
+ 	NonScrollableException(const std::string& reason) : SQLException(reason, "", 0) {}
+--- misc/mysql-connector-cpp/driver/makefile.mk	2009-09-11 09:42:34.087202551 +0200
++++ misc/build/mysql-connector-cpp/driver/makefile.mk	2009-09-11 09:42:25.902286382 +0200
+@@ -1 +1,64 @@
+-dummy
++PRJ=..$/..$/..$/..$/..
++
++.INCLUDE : $(PRJ)$/cppconn_config.pmk
++
++PRJINC=..
++TARGET=$(PRJNAME)
++
++# --- Settings -----------------------------------------------------
++
++.INCLUDE :  settings.mk
++
++.INCLUDE : $(PRJ)$/mysql_config.pmk
++
++# --- Files --------------------------------------------------------
++
++.IF "$(GUI)-$(OS)-$(RTL_ARCH)" == "UNX-LINUX-x86"
++    SHL1NOCHECK=TRUE
++.ENDIF
++SHL1TARGET=$(TARGET)
++
++LIB1TARGET=$(SLB)$/$(PRJNAME).lib
++LIB1OBJFILES+= \
++        $(SLO)$/mysql_art_resultset.obj \
++        $(SLO)$/mysql_art_rset_metadata.obj \
++        $(SLO)$/mysql_connection.obj \
++        $(SLO)$/mysql_debug.obj \
++        $(SLO)$/mysql_driver.obj \
++        $(SLO)$/mysql_metadata.obj \
++        $(SLO)$/mysql_parameter_metadata.obj \
++        $(SLO)$/mysql_prepared_statement.obj \
++        $(SLO)$/mysql_ps_resultset.obj \
++        $(SLO)$/mysql_ps_resultset_metadata.obj \
++        $(SLO)$/mysql_resultbind.obj \
++        $(SLO)$/mysql_resultset.obj \
++        $(SLO)$/mysql_resultset_metadata.obj \
++        $(SLO)$/mysql_statement.obj \
++        $(SLO)$/mysql_util.obj \
++        $(SLO)$/mysql_warning.obj \
++
++SHL1STDLIBS=\
++       $(MYSQL_LIB)
++
++SHL1RPATH=OXT
++SHL1IMPLIB=  i$(TARGET)
++SHL1LIBS=    $(LIB1TARGET) $(SLB)$/$(CPPCONN_NATIVEAPI).lib
++SHL1DEF=     $(MISC)$/$(SHL1TARGET).def
++DEF1NAME=    $(SHL1TARGET)
++DEF1DEPN=    $(MISC)$/$(SHL1TARGET).flt \
++              $(LIB1TARGET)
++DEFLIB1NAME=$(TARGET)
++
++# --- Targets ------------------------------------------------------
++
++.INCLUDE :  target.mk
++
++# --- filter file ------------------------------
++
++.IF "$(depend)"==""
++$(MISC)$/$(SHL1TARGET).flt: makefile.mk
++    @echo CLEAR_THE_FILE	> $@
++	@echo _TI				>>$@
++	@echo _real				>>$@
++	@echo __CT				>>$@
++.ENDIF # "$(depend)"==""
+--- misc/mysql-connector-cpp/driver/mysql_connection.cpp	2009-08-13 17:13:46.000000000 +0200
++++ misc/build/mysql-connector-cpp/driver/mysql_connection.cpp	2009-08-14 09:56:37.015625000 +0200
+@@ -50,6 +50,34 @@
+ #include "mysql_debug.h"
+ 
+ 
++// part II of the hack to make C/C++ compile in an OOo env which doesn't have boost::variant installed
++namespace boost
++{
++    template < class TYPE >
++    const TYPE* get( const sql::ConnectPropertyVal* val )
++    {
++        return val;
++    }
++
++    template < >
++    const sql::SQLString* get< sql::SQLString >( const sql::ConnectPropertyVal* val )
++    {
++        return &val->valString;
++    }
++
++    template < >
++    const int* get< int >( const sql::ConnectPropertyVal* val )
++    {
++        return &val->valInt;
++    }
++
++    template < >
++    const bool* get< bool >( const sql::ConnectPropertyVal* val )
++    {
++        return &val->valBool;
++    }
++}
++
+ namespace sql
+ {
+ namespace mysql
+--- misc/mysql-connector-cpp/driver/mysql_debug.h	2009-08-13 17:13:46.000000000 +0200
++++ misc/build/mysql-connector-cpp/driver/mysql_debug.h	2009-08-14 09:56:37.015625000 +0200
+@@ -25,16 +25,6 @@
+ 
+ 
+ 
+-#if defined(WE_HAVE_VARARGS_MACRO_SUPPORT) && (CPPCONN_TRACE_ENABLED || defined(SAL_DLLPRIVATE))
+-	#define CPP_ENTER(msg)			const boost::shared_ptr< MySQL_DebugLogger > __l = this->logger;(void)__l;\
+-									MySQL_DebugEnterEvent __this_func(__LINE__, __FILE__, msg, this->logger)
+-	#define CPP_ENTER_WL(l, msg)	const boost::shared_ptr< MySQL_DebugLogger > __l = (l);(void)__l;\
+-									MySQL_DebugEnterEvent __this_func(__LINE__, __FILE__, msg, (l))
+-	#define CPP_INFO(msg)		{if (__l) __l->log("INF", msg); }
+-	#define CPP_INFO_FMT(...)	{if (__l) __l->log_va("INF", __VA_ARGS__); }
+-	#define CPP_ERR(msg)		{if (__l) __l->log("ERR", msg); }
+-	#define CPP_ERR_FMT(...)	{if (__l) __l->log_va("ERR", __VA_ARGS__); }
+-#else
+ 	#define CPP_ENTER(msg)
+ 	#define CPP_ENTER_WL(l, msg)
+ 	#define CPP_INFO(msg)
+@@ -42,7 +32,6 @@
+ 	#define CPP_ENTER_WL(l, msg)
+ 	static inline void CPP_INFO_FMT(...) {}
+ 	static inline void CPP_ERR_FMT(...) {}
+-#endif
+ 
+ #include <stack>
+ #include "mysql_util.h"
+--- misc/mysql-connector-cpp/driver/nativeapi/binding_config.h	2009-08-14 10:17:23.640625000 +0200
++++ misc/build/mysql-connector-cpp/driver/nativeapi/binding_config.h	2009-08-14 10:13:50.359375000 +0200
+@@ -1 +1,2 @@
+-dummy
++#define HAVE_DLFCN_H 1
++//#define MYSQLCLIENT_STATIC_BINDING 1
+--- misc/mysql-connector-cpp/driver/nativeapi/makefile.mk	2009-08-17 21:32:53.694119382 +0200
++++ misc/build/mysql-connector-cpp/driver/nativeapi/makefile.mk	2009-08-17 21:32:50.534346360 +0200
+@@ -1 +1,23 @@
+-dummy
++PRJ=..$/..$/..$/..$/..$/..
++PRJINC=..$/..
++
++.INCLUDE : $(PRJ)$/cppconn_config.pmk
++
++TARGET=$(CPPCONN_NATIVEAPI)
++
++# --- Settings -----------------------------------------------------
++
++.INCLUDE :  settings.mk
++
++.INCLUDE : $(PRJ)$/mysql_config.pmk
++
++LIB1TARGET=$(SLB)$/$(TARGET).lib
++LIB1OBJFILES+= \
++        $(SLO)$/mysql_client_api.obj \
++        $(SLO)$/library_loader.obj \
++        $(SLO)$/mysql_native_connection_wrapper.obj \
++        $(SLO)$/mysql_native_resultset_wrapper.obj \
++        $(SLO)$/mysql_native_statement_wrapper.obj \
++
++# --- Targets ------------------------------------------------------
++.INCLUDE :  target.mk
Index: mysqlcppconn/prj/build.lst
===================================================================
--- mysqlcppconn/prj/build.lst	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/prj/build.lst	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,3 @@
+my	mysqlcppconn	:	solenv sal NULL
+my	mysqlcppconn    nmake	-	all	my_mkout NULL
+

Index: mysqlcppconn/prj/d.lst
===================================================================
--- mysqlcppconn/prj/d.lst	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlcppconn/prj/d.lst	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,15 @@
+# mirror the dir structure a make install would create
+mkdir: %_DEST%\inc%_EXT%\mysqlcppconn
+mkdir: %_DEST%\inc%_EXT%\mysqlcppconn\cppconn
+
+..\%__SRC%\inc\*.h %_DEST%\inc%_EXT%\mysqlcppconn\*.h
+..\%__SRC%\inc\cppconn\*.h %_DEST%\inc%_EXT%\mysqlcppconn\cppconn\*.h
+
+..\%__SRC%\bin\*.dll %_DEST%\bin%_EXT%\*.dll
+
+ ..\%__SRC%\lib\lib*.so* %_DEST%\lib%_EXT%
+..\%__SRC%\lib\*.sl %_DEST%\lib%_EXT%\*.sl
+..\%__SRC%\lib\*.dylib %_DEST%\lib%_EXT%\*.dylib
+..\%__SRC%\lib\*.dylib.* %_DEST%\lib%_EXT%\*.dylib.*
+..\%__SRC%\lib\*.a %_DEST%\lib%_EXT%\*.a
+..\%__SRC%\lib\i*.lib %_DEST%\lib%_EXT%

Index: dbaccess/source/ui/browser/brwctrlr.cxx
===================================================================
--- dbaccess/source/ui/browser/brwctrlr.cxx	(.../tags/OOO310_m10)	(Revision 275542)
+++ dbaccess/source/ui/browser/brwctrlr.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -468,6 +468,7 @@
 //------------------------------------------------------------------------------
 SbaXDataBrowserController::SbaXDataBrowserController(const Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rM)
 	:SbaXDataBrowserController_Base(_rM)
+    ,m_nRowSetPrivileges(0)
     ,m_pClipbordNotifier( NULL )
 	,m_aAsyncGetCellFocus(LINK(this, SbaXDataBrowserController, OnAsyncGetCellFocus))
 	,m_sStateSaveRecord(ModuleRes(RID_STR_SAVE_CURRENT_RECORD))
@@ -1201,19 +1202,21 @@
 			m_xRowSet			= NULL;
 			m_xColumnsSupplier	= NULL;
 			m_xLoadable 		= NULL;
+
+            m_nRowSetPrivileges = 0;
 		}
-		catch(Exception&)
+		catch(const Exception&)
 		{
-			OSL_ENSURE(0,"Exception thrown by dispose");
+            DBG_UNHANDLED_EXCEPTION();
 		}
 	}
 	try
 	{
 		::comphelper::disposeComponent(m_xParser);
 	}
-	catch(Exception&)
+	catch(const Exception&)
 	{
-		OSL_ENSURE(0,"Exception thrown by dispose");
+        DBG_UNHANDLED_EXCEPTION();
 	}
 }
 //------------------------------------------------------------------------------
@@ -1414,21 +1417,39 @@
             case ID_BROWSER_INSERT_ROW:
                 {
                     // check if it is available
-				    Reference< XPropertySet >  xDataSourceSet(getRowSet(), UNO_QUERY);
-				    if (!xDataSourceSet.is())
-					    break;	// no datasource -> no edit mode
-
-				    sal_Int32 nDataSourcePrivileges = ::comphelper::getINT32(xDataSourceSet->getPropertyValue(PROPERTY_PRIVILEGES));
-				    aReturn.bEnabled = ((nDataSourcePrivileges & ::com::sun::star::sdbcx::Privilege::INSERT) != 0) && ::comphelper::getBOOL(xDataSourceSet->getPropertyValue(::rtl::OUString::createFromAscii("AllowInserts")));
+                    sal_Bool bInsertPrivilege = ( m_nRowSetPrivileges & Privilege::INSERT) != 0;
+                    sal_Bool bAllowInsertions = sal_True;
+                    try
+                    {
+				        Reference< XPropertySet > xRowSetProps( getRowSet(), UNO_QUERY_THROW );
+                        OSL_VERIFY( xRowSetProps->getPropertyValue( ::rtl::OUString::createFromAscii( "AllowInserts" ) ) >>= bAllowInsertions );
+                    }
+                    catch( const Exception& )
+                    {
+                    	DBG_UNHANDLED_EXCEPTION();
+                    }
+				    aReturn.bEnabled = bInsertPrivilege && bAllowInsertions;
                 }
                 break;
             case SID_FM_DELETEROWS:
                 {
-				    Reference< XPropertySet >  xFormSet(getRowSet(), UNO_QUERY);
-				    sal_Int32 nCount = ::comphelper::getINT32(xFormSet->getPropertyValue(PROPERTY_ROWCOUNT));
-                    sal_Bool bNew = sal_False;
-                    xFormSet->getPropertyValue(PROPERTY_ISNEW) >>= bNew;
-				    aReturn.bEnabled = nCount != 0 && !bNew;
+                    // check if it is available
+                    sal_Bool bDeletePrivilege = ( m_nRowSetPrivileges & Privilege::INSERT) != 0;
+                    sal_Bool bAllowDeletions = sal_True;
+                    sal_Int32 nRowCount = 0;
+                    sal_Bool bInsertionRow = sal_False;
+                    try
+                    {
+				        Reference< XPropertySet > xRowSetProps( getRowSet(), UNO_QUERY_THROW );
+                        OSL_VERIFY( xRowSetProps->getPropertyValue( ::rtl::OUString::createFromAscii( "AllowDeletes" ) ) >>= bAllowDeletions );
+                        OSL_VERIFY( xRowSetProps->getPropertyValue( PROPERTY_ROWCOUNT ) >>= nRowCount );
+                        OSL_VERIFY( xRowSetProps->getPropertyValue( PROPERTY_ISNEW ) >>= bInsertionRow );
+                    }
+                    catch( const Exception& )
+                    {
+                    	DBG_UNHANDLED_EXCEPTION();
+                    }
+                    aReturn.bEnabled = bDeletePrivilege && bAllowDeletions && ( nRowCount != 0 ) && !bInsertionRow;
 			    }
                 break;
 
@@ -2556,14 +2556,28 @@
 {
     RTL_LOGFILE_CONTEXT_AUTHOR( aLogger, "dbaui", "Ocke.Janssen@sun.com", "SbaXDataBrowserController::criticalFail" );
     InvalidateAll();
+    m_nRowSetPrivileges = 0;
 }

 //------------------------------------------------------------------------------
 void SbaXDataBrowserController::LoadFinished(sal_Bool /*bWasSynch*/)
 {
     RTL_LOGFILE_CONTEXT_AUTHOR( aLogger, "dbaui", "Ocke.Janssen@sun.com", "SbaXDataBrowserController::LoadFinished" );
+    m_nRowSetPrivileges = 0;
+
     if (isValid() && !loadingCancelled())
     {
+        // obtain cached values
+        try
+        {
+            Reference< XPropertySet > xFormProps( m_xLoadable, UNO_QUERY_THROW );
+            OSL_VERIFY( xFormProps->getPropertyValue( PROPERTY_PRIVILEGES ) >>= m_nRowSetPrivileges );
+        }
+        catch( const Exception& )
+        {
+           DBG_UNHANDLED_EXCEPTION();
+        }
+
         // --------------------------------
         // switch the control to alive mode
         getBrowserView()->getGridControl()->setDesignMode(sal_False);
Index: dbaccess/source/ui/inc/brwctrlr.hxx
===================================================================
--- dbaccess/source/ui/inc/brwctrlr.hxx	(.../tags/OOO310_m10)	(Revision 275542)
+++ dbaccess/source/ui/inc/brwctrlr.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -100,6 +100,8 @@
 		::com::sun::star::uno::Reference< ::com::sun::star::uno::XAggregation >			m_xFormControllerImpl;
 		::com::sun::star::uno::Reference< ::com::sun::star::sdb::XSingleSelectQueryComposer > 	m_xParser;		// for sorting 'n filtering
 
+        sal_Int32               m_nRowSetPrivileges;    // cached Privileges property of m_xRowSet
+
 		AutoTimer				m_aInvalidateClipboard;				// for testing the state of the CUT/COPY/PASTE-slots
 
 		TransferableDataHelper	m_aSystemClipboard;		// content of the clipboard

Index: mysqlc/source/mysqlc_propertyids.hxx
===================================================================
--- mysqlc/source/mysqlc_propertyids.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_propertyids.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,136 @@
+
+#ifndef _CONNECTIVITY_PROPERTYIDS_HXX_
+#define _CONNECTIVITY_PROPERTYIDS_HXX_
+
+// this define has to be set to split the names into different dll's or so's
+// every dll has his own set of property names
+#ifndef _RTL_USTRING_
+#include <rtl/ustring.hxx>
+#endif
+#ifndef _MAP_
+#include <map>
+#endif
+
+namespace connectivity
+{
+namespace mysqlc
+{
+	class OPropertyMap
+	{
+		::std::map<sal_Int32 , rtl_uString*> m_aPropertyMap; 
+
+		::rtl::OUString fillValue(sal_Int32 _nIndex);
+	public:
+		OPropertyMap()
+		{
+		}
+		~OPropertyMap();
+		::rtl::OUString getNameByIndex(sal_Int32 _nIndex) const;
+
+		static OPropertyMap& getPropMap()
+		{
+			static OPropertyMap s_aPropMap;
+			return s_aPropMap;
+		}
+	};
+
+
+	typedef const sal_Char* (*PVFN)();
+
+	struct UStringDescription
+	{
+		const sal_Char*	pZeroTerminatedName;
+		sal_Int32 nLength;
+
+		UStringDescription(PVFN _fCharFkt); 
+		operator ::rtl::OUString() const { return ::rtl::OUString(pZeroTerminatedName,nLength,RTL_TEXTENCODING_ASCII_US); }
+		~UStringDescription();
+	private:
+		UStringDescription();
+	};
+
+
+enum
+{
+	PROPERTY_ID_FIRST = 0,
+	PROPERTY_ID_QUERYTIMEOUT,
+	PROPERTY_ID_MAXFIELDSIZE,
+	PROPERTY_ID_MAXROWS,
+	PROPERTY_ID_CURSORNAME,
+	PROPERTY_ID_RESULTSETCONCURRENCY,
+	PROPERTY_ID_RESULTSETTYPE,
+	PROPERTY_ID_FETCHDIRECTION,
+	PROPERTY_ID_FETCHSIZE,
+	PROPERTY_ID_ESCAPEPROCESSING,
+	PROPERTY_ID_USEBOOKMARKS,
+// Column
+	PROPERTY_ID_NAME,
+	PROPERTY_ID_TYPE,
+	PROPERTY_ID_TYPENAME,
+	PROPERTY_ID_PRECISION,
+	PROPERTY_ID_SCALE,
+	PROPERTY_ID_ISNULLABLE,
+	PROPERTY_ID_ISAUTOINCREMENT,
+	PROPERTY_ID_ISROWVERSION,
+	PROPERTY_ID_DESCRIPTION,
+	PROPERTY_ID_DEFAULTVALUE,
+
+	PROPERTY_ID_REFERENCEDTABLE,
+	PROPERTY_ID_UPDATERULE,
+	PROPERTY_ID_DELETERULE,
+	PROPERTY_ID_CATALOG,
+	PROPERTY_ID_ISUNIQUE,
+	PROPERTY_ID_ISPRIMARYKEYINDEX,
+	PROPERTY_ID_ISCLUSTERED,
+	PROPERTY_ID_ISASCENDING,
+	PROPERTY_ID_SCHEMANAME,
+	PROPERTY_ID_CATALOGNAME,
+
+	PROPERTY_ID_COMMAND,
+	PROPERTY_ID_CHECKOPTION,
+	PROPERTY_ID_PASSWORD,
+	PROPERTY_ID_RELATEDCOLUMN,
+
+	PROPERTY_ID_FUNCTION,
+	PROPERTY_ID_TABLENAME,
+	PROPERTY_ID_REALNAME,
+	PROPERTY_ID_DBASEPRECISIONCHANGED,
+	PROPERTY_ID_ISCURRENCY,
+	PROPERTY_ID_ISBOOKMARKABLE,
+
+	PROPERTY_ID_INVALID_INDEX,
+	PROPERTY_ID_ERRORMSG_SEQUENCE,
+	PROPERTY_ID_HY010,
+	PROPERTY_ID_HY0000,
+	PROPERTY_ID_DELIMITER,
+	PROPERTY_ID_FORMATKEY,
+	PROPERTY_ID_LOCALE,
+	PROPERTY_ID_IM001,
+
+	PROPERTY_ID_AUTOINCREMENTCREATION,
+
+	PROPERTY_ID_PRIVILEGES,
+
+	PROPERTY_ID_LAST
+};
+}/* mysqlc */
+}/* connectivity */
+
+//------------------------------------------------------------------------------
+#define DECL_PROP1IMPL(varname, type) \
+pProperties[nPos++] = Property(OPropertyMap::getPropMap().getNameByIndex(PROPERTY_ID_##varname), PROPERTY_ID_##varname, ::getCppuType(reinterpret_cast< type*>(NULL)),
+//------------------------------------------------------------------------------
+#define DECL_PROP0(varname, type)	\
+	DECL_PROP1IMPL(varname, type) 0)
+//------------------------------------------------------------------------------
+#define DECL_BOOL_PROP1IMPL(varname) \
+        pProperties[nPos++] = Property(OPropertyMap::getPropMap().getNameByIndex(PROPERTY_ID_##varname), PROPERTY_ID_##varname, ::getBooleanCppuType(),
+//------------------------------------------------------------------------------
+#define DECL_BOOL_PROP0(varname)	\
+	DECL_BOOL_PROP1IMPL(varname) 0)
+
+
+
+#endif // _CONNECTIVITY_PROPERTYIDS_HXX_
+
+
Index: mysqlc/source/description.xml
===================================================================
--- mysqlc/source/description.xml	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description.xml	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<description xmlns="http://openoffice.org/extensions/description/2006" xmlns:d="http://openoffice.org/extensions/description/2006" 
+    xmlns:xlink="http://www.w3.org/1999/xlink">
+
+    <identifier value="UPDATED_IDENTIFIER"/>
+    <version value="#VERSION#" />    
+    <platform value="UPDATED_SUPPORTED_PLATFORM" />
+    <display-name>
+        <name lang="en-US">#TITLE#</name>
+    </display-name>
+    <dependencies>
+         <OpenOffice.org-minimal-version value="3.1" d:name="OpenOffice.org 3.1"/>
+    </dependencies>
+    <publisher>
+        <name xlink:href="http://www.sun.com/software/star/staroffice/extensions.jsp?cid=925095" lang="en">Sun Microsystems</name>
+    </publisher>
+    <extension-description>
+        <src lang="en-US" xlink:href="description/description_en-US.txt"/>
+    </extension-description>
+</description> 
Index: mysqlc/source/mysqlc_resultsetmetadata.cxx
===================================================================
--- mysqlc/source/mysqlc_resultsetmetadata.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_resultsetmetadata.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,468 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_resultsetmetadata.cxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include "mysqlc_resultsetmetadata.hxx"
+#include "mysqlc_general.hxx"
+#include "cppconn/exception.h"
+
+#include <rtl/ustrbuf.hxx>
+
+using namespace connectivity::mysqlc;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::sdbc;
+using ::rtl::OUString;
+
+// -------------------------------------------------------------------------
+OResultSetMetaData::~OResultSetMetaData()
+{
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnDisplaySize() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::getColumnDisplaySize(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnDisplaySize");
+
+	try {
+		meta->getColumnDisplaySize(column);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getColumnDisplaySize", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnType() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::getColumnType(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnType");
+	checkColumnIndex(column);
+
+	try {
+		return mysqlc_sdbc_driver::mysqlToOOOType(meta->getColumnType(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+/*
+  XXX: This method doesn't throw exceptions at all.
+  Should it declare that it throws ?? What if throw() is removed?
+  Does it change the API, the open-close principle?  
+*/
+/* {{{ OResultSetMetaData::getColumnCount() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::getColumnCount()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnCount");
+	try {
+		return meta->getColumnCount();
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isCaseSensitive() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isCaseSensitive(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isCaseSensitive");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isCaseSensitive(column);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getSchemaName() -I- */
+OUString SAL_CALL OResultSetMetaData::getSchemaName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getSchemaName");
+	checkColumnIndex(column);
+
+	try {
+		return convert(meta->getSchemaName(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnName() -I- */
+OUString SAL_CALL OResultSetMetaData::getColumnName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnName");
+	checkColumnIndex(column);
+
+	try {
+		return convert( meta->getColumnName( column ) );
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getTableName() -I- */
+OUString SAL_CALL OResultSetMetaData::getTableName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getTableName");
+	checkColumnIndex(column);
+
+	try {
+		return convert(meta->getTableName(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getCatalogName() -I- */
+OUString SAL_CALL OResultSetMetaData::getCatalogName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getCatalogName");
+	checkColumnIndex(column);
+
+	try {
+		return convert(meta->getCatalogName(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnTypeName() -I- */
+OUString SAL_CALL OResultSetMetaData::getColumnTypeName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnTypeName");
+	checkColumnIndex(column);
+
+	try {
+		return convert(meta->getColumnTypeName(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnLabel() -I- */
+OUString SAL_CALL OResultSetMetaData::getColumnLabel(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnLabel");
+	checkColumnIndex(column);
+
+	try {
+		return convert(meta->getColumnLabel(column));
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getColumnServiceName() -I- */
+OUString SAL_CALL OResultSetMetaData::getColumnServiceName(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getColumnServiceName");
+	checkColumnIndex(column);
+
+	OUString aRet = OUString();
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isCurrency() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isCurrency(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isCurrency");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isCurrency(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isAutoIncrement() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isAutoIncrement(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isAutoIncrement");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isAutoIncrement(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isSigned() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isSigned(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isSigned");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isSigned(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getPrecision() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::getPrecision(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getPrecision");
+	checkColumnIndex(column);
+
+	try {
+		return meta->getPrecision(column);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getPrecision", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::getScale() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::getScale(sal_Int32 column)
+	throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::getScale");
+	checkColumnIndex(column);
+	try {
+		return meta->getScale(column);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getScale", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isNullable() -I- */
+sal_Int32 SAL_CALL OResultSetMetaData::isNullable(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isNullable");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isNullable(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isSearchable() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isSearchable(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isSearchable");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isSearchable(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isReadOnly() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isReadOnly(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isReadOnly");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isReadOnly(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isDefinitelyWritable() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isDefinitelyWritable(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isDefinitelyWritable");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isDefinitelyWritable(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::isWritable() -I- */
+sal_Bool SAL_CALL OResultSetMetaData::isWritable(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::isWritable");
+	checkColumnIndex(column);
+
+	try {
+		return meta->isWritable(column)? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSetMetaData::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSetMetaData::checkColumnIndex() -I- */
+void OResultSetMetaData::checkColumnIndex(sal_Int32 columnIndex)
+	throw (SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSetMetaData::checkColumnIndex");
+	if (columnIndex < 1 || columnIndex > (sal_Int32) meta->getColumnCount()) {
+
+        ::rtl::OUStringBuffer buf;
+        buf.appendAscii( "Column index out of range (expected 1 to " );
+        buf.append( sal_Int32( meta->getColumnCount() ) );
+        buf.appendAscii( ", got " );
+        buf.append( sal_Int32( columnIndex ) );
+        buf.append( sal_Unicode( '.' ) );
+		throw SQLException( buf.makeStringAndClear(), *this, OUString(), 1, Any() );
+	}
+}
+/* }}} */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
+
Index: mysqlc/source/mysqlc_resultsetmetadata.hxx
===================================================================
--- mysqlc/source/mysqlc_resultsetmetadata.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_resultsetmetadata.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,121 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_resultsetmetadata.hxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef CONNECTIVITY_SRESULSETMETADATA_HXX
+#define CONNECTIVITY_SRESULSETMETADATA_HXX
+
+#include "mysqlc_connection.hxx"
+
+#include <com/sun/star/sdbc/XResultSetMetaData.hpp>
+
+#include <cppuhelper/implbase1.hxx>
+#include <cppconn/resultset_metadata.h>
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::RuntimeException;
+		using ::rtl::OUString;
+		//**************************************************************
+		//************ Class: ResultSetMetaData
+		//**************************************************************
+		typedef ::cppu::WeakImplHelper1< ::com::sun::star::sdbc::XResultSetMetaData> OResultSetMetaData_BASE;
+
+		class OResultSetMetaData : public OResultSetMetaData_BASE
+		{
+			sql::ResultSetMetaData * meta;
+            rtl_TextEncoding        m_encoding;
+		protected:
+			virtual ~OResultSetMetaData();
+		public:
+			OResultSetMetaData( sql::ResultSetMetaData * _meta, rtl_TextEncoding _encoding )
+                :meta(_meta)
+                ,m_encoding( _encoding )
+            {
+            }
+
+            inline ::rtl::OUString convert( const ::std::string& _string ) const
+            {
+                return ::rtl::OUString( _string.c_str(), _string.size(), m_encoding );
+            }
+
+			/// Avoid ambigous cast error from the compiler.
+			inline operator ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData > () throw()
+			{ return this; }
+
+			sal_Int32 SAL_CALL getColumnCount()						throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isAutoIncrement(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isCaseSensitive(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isSearchable(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isCurrency(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL isNullable(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isSigned(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getColumnDisplaySize(sal_Int32 column)throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getColumnLabel(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getColumnName(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getSchemaName(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getPrecision(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getScale(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getTableName(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getCatalogName(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getColumnType(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getColumnTypeName(sal_Int32 column) 	throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isReadOnly(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isWritable(sal_Int32 column)			throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isDefinitelyWritable(sal_Int32 column)throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getColumnServiceName(sal_Int32 column)throw(SQLException, RuntimeException);
+
+			void checkColumnIndex(sal_Int32 columnIndex)			throw (SQLException, RuntimeException);
+		};
+	}
+}
+
+#endif // CONNECTIVITY_SRESULSETMETADATA_HXX
Index: mysqlc/source/DataAccess.xcu
===================================================================
--- mysqlc/source/DataAccess.xcu	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/DataAccess.xcu	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<oor:node xmlns:oor="http://openoffice.org/2001/registry" xmlns:xs="http://www.w3.org/2001/XMLSchema" oor:name="DataAccess" oor:package="org.openoffice.Office">
+ <node oor:name="UserDefinedDriverSettings">
+  <node oor:name="org.openoffice.comp.connectivity.mysql_native.Driver" oor:op="replace">
+   <prop oor:name="DriverName">
+    <value>org.openoffice.comp.connectivity.mysql_native.Driver</value>
+   </prop>
+   <prop oor:name="DriverPageDisplayName">
+    <value>MySQL native driver</value>
+   </prop>
+   <prop oor:name="DriverTypeDisplayName">
+    <value>MySQL native driver</value>
+   </prop>
+   <prop oor:name="DriverDsnPrefix">
+    <value>sdbc:mysqlc:</value>
+   </prop>
+  </node>
+ </node>
+</oor:node>
Index: mysqlc/source/mysqlc_types.cxx
===================================================================
--- mysqlc/source/mysqlc_types.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_types.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,792 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_types.cxx,v $
+*
+* $Revision: 1.1.2.2 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include <stdio.h>
+#include <com/sun/star/sdbc/DataType.hpp>
+#include <com/sun/star/sdbc/ColumnValue.hpp>
+#include <com/sun/star/sdbc/ColumnSearch.hpp>
+#include "mysqlc_types.hxx"
+
+using namespace com::sun::star::sdbc;
+
+TypeInfoDef mysqlc_types[] = {
+
+    // ------------- MySQL-Type: BIT. SDBC-Type: Bit -------------
+    {
+        "BIT",                                       // Typename
+        com::sun::star::sdbc::DataType::BIT,         // sdbc-type
+        1,                                           // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "BIT",                                       // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ------------ MySQL-Type: BOOL. SDBC-Type: Bit -------------
+    {
+        "BOOL",                                      // Typename
+        com::sun::star::sdbc::DataType::BIT,         // sdbc-type
+        1,                                           // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "BOOL",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // --------- MySQL-Type: TINYINT SDBC-Type: TINYINT ----------
+    {
+        "TINYINT",                                   // Typename
+        com::sun::star::sdbc::DataType::TINYINT,     // sdbc-type
+        3,                                           // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "TINYINT",                                   // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: BIGINT SDBC-Type: BIGINT ----------
+    {
+        "BIGINT",                                    // Typename
+        com::sun::star::sdbc::DataType::BIGINT,      // sdbc-type
+        19,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "BIGINT",                                    // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: LONG VARBINARY SDBC-Type: LONGVARBINARY ----------
+    {
+        "LONG VARBINARY",                            // Typename
+        com::sun::star::sdbc::DataType::LONGVARBINARY, // sdbc-type
+        16777215,                                    // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "LONG VARBINARY",                            // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: MEDIUMBLOB SDBC-Type: LONGVARBINARY ----------
+    {
+        "MEDIUMBLOB",                                // Typename
+        com::sun::star::sdbc::DataType::LONGVARBINARY, // sdbc-type
+        16777215,                                    // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "MEDIUMBLOB",                                // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: LONGBLOB SDBC-Type: LONGVARBINARY ----------
+    {
+        "LONGBLOB",                                  // Typename
+        com::sun::star::sdbc::DataType::LONGVARBINARY, // sdbc-type
+        0xFFFFFFFF,                                  // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "LONGBLOB",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: BLOB SDBC-Type: LONGVARBINARY ----------
+    {
+        "BLOB",                                      // Typename
+        com::sun::star::sdbc::DataType::LONGVARBINARY, // sdbc-type
+        0xFFFF,                                      // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "BLOB",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: TINYBLOB SDBC-Type: LONGVARBINARY ----------
+    {
+        "TINYBLOB",                                  // Typename
+        com::sun::star::sdbc::DataType::LONGVARBINARY, // sdbc-type
+        0xFF,                                         // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "TINYBLOB",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: VARBINARY SDBC-Type: VARBINARY ----------
+    {
+        "VARBINARY",                                 // Typename
+        com::sun::star::sdbc::DataType::VARBINARY,   // sdbc-type
+        0xFF,                                        // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "(M)",                                       // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "VARBINARY",                                 // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: BINARY SDBC-Type: BINARY ----------
+    {
+        "BINARY",                                    // Typename
+        com::sun::star::sdbc::DataType::BINARY,      // sdbc-type
+        0xFF,                                        // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "(M)",                                       // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_True,                                    // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "VARBINARY",                                 // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: LONG VARCHAR SDBC-Type: LONG VARCHAR ----------
+    {
+        "LONG VARCHAR",                              // Typename
+        com::sun::star::sdbc::DataType::LONGVARCHAR, // sdbc-type
+        0xFFFFFF,                                    // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "LONG VARCHAR",                              // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: MEDIUMTEXT SDBC-Type: LONG VARCHAR ----------
+    {
+        "MEDIUMTEXT",                                // Typename
+        com::sun::star::sdbc::DataType::LONGVARCHAR, // sdbc-type
+        0xFFFFFF,                                    // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "MEDIUMTEXT",                                // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: LONGTEXT SDBC-Type: LONG VARCHAR ----------
+    {
+        "LONGTEXT",                                  // Typename
+        com::sun::star::sdbc::DataType::LONGVARCHAR, // sdbc-type
+        0xFFFFFF,                                    // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "LONGTEXT",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: TEXT SDBC-Type: LONG VARCHAR ----------
+    {
+        "TEXT",                                      // Typename
+        com::sun::star::sdbc::DataType::LONGVARCHAR, // sdbc-type
+        0xFFFF,                                      // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "TEXT",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: TINYTEXT SDBC-Type: LONG VARCHAR ----------
+    {
+        "TINYTEXT",                                  // Typename
+        com::sun::star::sdbc::DataType::LONGVARCHAR, // sdbc-type
+        0xFF,                                        // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "TINYTEXT",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: CHAR SDBC-Type: CHAR ----------
+    {
+        "CHAR",                                      // Typename
+        com::sun::star::sdbc::DataType::CHAR,        // sdbc-type
+        0xFF,                                        // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "(M)",                                       // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "NUMERIC",                                   // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: DECIMAL SDBC-Type: DECIMAL ----------
+    {
+        "DECIMAL",                                   // Typename
+        com::sun::star::sdbc::DataType::DECIMAL,     // sdbc-type
+        17,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M[,D])] [ZEROFILL]",                      // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "DECIMAL",                                   // local type name
+        -308,                                        // minimum scale
+        308,                                         // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: NUMERIC SDBC-Type: NUMERIC ----------
+    {
+        "NUMERIC",                                   // Typename
+        com::sun::star::sdbc::DataType::NUMERIC,     // sdbc-type
+        17,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M[,D])] [ZEROFILL]",                      // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "NUMERIC",                                   // local type name
+        -308,                                        // minimum scale
+        308,                                         // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: INTEGER SDBC-Type: INTEGER ----------
+    {
+        "INTEGER",                                   // Typename
+        com::sun::star::sdbc::DataType::INTEGER,     // sdbc-type
+        10,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "INTEGER",                                   // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: INT SDBC-Type: INTEGER ----------
+    {
+        "INT",                                       // Typename
+        com::sun::star::sdbc::DataType::INTEGER,     // sdbc-type
+        10,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "INT",                                       // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: MEDIUMINT SDBC-Type: INTEGER ----------
+    {
+        "MEDIUMINT",                                 // Typename
+        com::sun::star::sdbc::DataType::INTEGER,     // sdbc-type
+         7,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "MEDIUMINT",                                 // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: SMALLINT SDBC-Type: INTEGER ----------
+    {
+        "SMALLINT",                                  // Typename
+        com::sun::star::sdbc::DataType::SMALLINT,    // sdbc-type
+         5,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M)] [UNSIGNED] [ZEROFILL]",               // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_True,                                    // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "SMALLINT",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: FLOAT SDBC-Type: REAL ----------
+    {
+        "FLOAT",                                     // Typename
+        com::sun::star::sdbc::DataType::REAL,        // sdbc-type
+        10,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M,D)] [ZEROFILL]",                        // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "FLOAT",                                     // local type name
+        -38,                                         // minimum scale
+        38,                                          // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: DOUBLE SDBC-Type: DOUBLE ----------
+    {
+        "DOUBLE",                                    // Typename
+        com::sun::star::sdbc::DataType::DOUBLE,      // sdbc-type
+        17,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M,D)] [ZEROFILL]",                        // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "DOUBLE",                                    // local type name
+        -308,                                        // minimum scale
+        308,                                         // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: DOUBLE PRECISION SDBC-Type: DOUBLE ----------
+    {
+        "DOUBLE PRECISION",                          // Typename
+        com::sun::star::sdbc::DataType::DOUBLE,      // sdbc-type
+        17,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M,D)] [ZEROFILL]",                        // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "DOUBLE PRECISION",                          // local type name
+        -308,                                        // minimum scale
+        308,                                         // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: REAL SDBC-Type: DOUBLE ----------
+    {
+        "REAL",                                      // Typename
+        com::sun::star::sdbc::DataType::DOUBLE,      // sdbc-type
+        17,                                          // Precision
+        "",                                          // Literal prefix
+        "",                                          // Literal suffix
+        "[(M,D)] [ZEROFILL]",                        // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_True,                                    // auto_increment
+        "REAL",                                      // local type name
+        -308,                                        // minimum scale
+        308,                                         // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: VARCHAR SDBC-Type: VARCHAR ----------
+    {
+        "VARCHAR",                                   // Typename
+        com::sun::star::sdbc::DataType::VARCHAR,     // sdbc-type
+        255,                                         // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "(M)",                                       // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "VARCHAR",                                   // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: ENUM SDBC-Type: VARCHAR ----------
+    {
+        "ENUM",                                      // Typename
+        com::sun::star::sdbc::DataType::VARCHAR,     // sdbc-type
+        0xFFFF,                                      // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "ENUM",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: SET SDBC-Type: VARCHAR ----------
+    {
+        "SET",                                       // Typename
+        com::sun::star::sdbc::DataType::VARCHAR,     // sdbc-type
+        64,                                          // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "SET",                                       // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: DATE SDBC-Type: DATE ----------
+    {
+        "DATE",                                      // Typename
+        com::sun::star::sdbc::DataType::DATE,        // sdbc-type
+        0,                                           // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "DATE",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: TIME SDBC-Type: TIME ----------
+    {
+        "TIME",                                      // Typename
+        com::sun::star::sdbc::DataType::TIME,        // sdbc-type
+        0,                                           // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "TIME",                                      // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: DATETIME SDBC-Type: TIMESTAMP ----------
+    {
+        "DATETIME",                                  // Typename
+        com::sun::star::sdbc::DataType::TIMESTAMP,   // sdbc-type
+        0,                                           // Precision
+        "'",                                          // Literal prefix
+        "'",                                          // Literal suffix
+        "",                                          // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "DATETIME",                                  // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+     },
+
+    // ----------- MySQL-Type: TIMESTAMP SDBC-Type: TIMESTAMP ----------
+    {
+        "TIMESTAMP",                                 // Typename
+        com::sun::star::sdbc::DataType::TIMESTAMP,   // sdbc-type
+        0,                                           // Precision
+        "'",                                         // Literal prefix
+        "'",                                         // Literal suffix
+        "[(M)]",                                     // Create params
+        com::sun::star::sdbc::ColumnValue::NULLABLE, // nullable
+        sal_False,                                   // case sensitive
+        com::sun::star::sdbc::ColumnSearch::FULL,    // searchable
+        sal_False,                                   // unsignable
+        sal_False,                                   // fixed_prec_scale
+        sal_False,                                   // auto_increment
+        "TIMESTAMP",                                 // local type name
+        0,                                           // minimum scale
+        0,                                           // maximum scale
+        0,                                           // sql data type (unsued)
+        0,                                           // sql datetime sub (unsued)
+        10                                           // num prec radix
+    },
+
+    // ----------- MySQL-Type: TIMESTAMP SDBC-Type: TIMESTAMP ----------
+    {
+        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
+    }
+};
Index: mysqlc/source/mysqlc_statement.cxx
===================================================================
--- mysqlc/source/mysqlc_statement.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_statement.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,531 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_statement.cxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+#include <stdio.h>
+#include "mysqlc_connection.hxx"
+#include "mysqlc_propertyids.hxx"
+#include "mysqlc_resultset.hxx"
+#include "mysqlc_statement.hxx"
+#include "mysqlc_general.hxx"
+
+#include <com/sun/star/lang/DisposedException.hpp>
+#include <com/sun/star/sdbc/FetchDirection.hpp>
+#include <com/sun/star/sdbc/ResultSetConcurrency.hpp>
+#include <com/sun/star/sdbc/ResultSetType.hpp>
+
+#include <cppconn/connection.h>
+#include <cppconn/exception.h>
+#include <cppconn/statement.h>
+#include <cppuhelper/typeprovider.hxx>
+#include <osl/diagnose.h>
+#include <osl/thread.h>
+
+#define USE_CPP_CONN 1
+
+using namespace connectivity::mysqlc;
+//------------------------------------------------------------------------------
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+using ::osl::MutexGuard;
+using ::rtl::OUString;
+
+#include <stdio.h>
+
+/* {{{ OConnection::OCommonStatement() -I- */
+OCommonStatement::OCommonStatement(OConnection* _pConnection, sql::Statement *_cppStatement) 
+	:OCommonStatement_IBase(m_aMutex)
+	,OPropertySetHelper(OCommonStatement_IBase::rBHelper)
+    ,OStatement_CBase( (::cppu::OWeakObject*)_pConnection, this )
+	,m_pConnection(_pConnection)
+	,cppStatement(_cppStatement)
+	,rBHelper(OCommonStatement_IBase::rBHelper)
+{
+	OSL_TRACE("OCommonStatement::OCommonStatement");
+	m_pConnection->acquire();
+}
+/* }}} */
+
+
+/* {{{ OConnection::~OCommonStatement() -I- */
+OCommonStatement::~OCommonStatement()
+{
+	OSL_TRACE("OCommonStatement::~OCommonStatement");
+}
+/* }}} */
+
+
+/* {{{ OConnection::disposeResultSet() -I- */
+void OCommonStatement::disposeResultSet()
+{
+	OSL_TRACE("OCommonStatement::disposeResultSet");
+	// free the cursor if alive
+	delete cppStatement;
+	cppStatement = NULL;
+}
+/* }}} */
+
+
+/* {{{ OConnection::disposing() -I- */
+void OCommonStatement::disposing()
+{
+	OSL_TRACE("OCommonStatement::disposing");
+	MutexGuard aGuard(m_aMutex);
+
+	disposeResultSet();
+
+    if (m_pConnection) {
+		m_pConnection->release();
+		m_pConnection = NULL;
+	}
+	delete cppStatement;
+
+    dispose_ChildImpl();
+	OCommonStatement_IBase::disposing();
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::queryInterface() -I- */
+Any SAL_CALL OCommonStatement::queryInterface(const Type & rType)
+	throw(RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::queryInterface");
+	Any aRet = OCommonStatement_IBase::queryInterface(rType);
+	if (!aRet.hasValue()) {
+		aRet = OPropertySetHelper::queryInterface(rType);
+	}
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getTypes() -I- */
+Sequence< Type > SAL_CALL OCommonStatement::getTypes()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getTypes");
+	::cppu::OTypeCollection aTypes(	::getCppuType( (const Reference< XMultiPropertySet > *)0 ),
+									::getCppuType( (const Reference< XFastPropertySet > *)0 ),
+									::getCppuType( (const Reference< XPropertySet > *)0 ));
+
+	return concatSequences(aTypes.getTypes(), OCommonStatement_IBase::getTypes());
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::cancel() -I- */
+void SAL_CALL OCommonStatement::cancel()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::cancel");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+	// cancel the current sql statement
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::close() -I- */
+void SAL_CALL OCommonStatement::close()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::close");
+	/*
+	  We need a block for the checkDisposed call. 
+	  After the check we can call dispose() as we are not under lock ??
+	*/
+	{
+		MutexGuard aGuard(m_aMutex);
+		checkDisposed(rBHelper.bDisposed);
+	}
+	dispose();
+}
+/* }}} */
+
+
+/* {{{ OStatement::clearBatch() -I- */
+void SAL_CALL OStatement::clearBatch()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OStatement::clearBatch");
+	// if you support batches clear it here
+}
+/* }}} */
+
+
+/* {{{ OStatement::execute() -I- */
+sal_Bool SAL_CALL OCommonStatement::execute(const OUString& sql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::execute");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+    const ::rtl::OUString sSqlStatement = m_pConnection->transFormPreparedStatement( sql );
+
+    sal_Bool success = false;
+	try {
+		success = cppStatement->execute(OUStringToOString(sSqlStatement, m_pConnection->getConnectionSettings().encoding).getStr())? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return success;
+}
+/* }}} */
+
+
+/* {{{ OStatement::executeQuery() -I- */
+Reference< XResultSet > SAL_CALL OCommonStatement::executeQuery(const OUString& sql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::executeQuery");
+
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+    const ::rtl::OUString sSqlStatement = m_pConnection->transFormPreparedStatement(sql);
+
+    Reference< XResultSet > xResultSet;
+	try {
+		std::auto_ptr< sql::ResultSet > rset(cppStatement->executeQuery(OUStringToOString(sSqlStatement, m_pConnection->getConnectionEncoding()).getStr()));
+		xResultSet = new OResultSet(this, rset.get(), m_pConnection->getConnectionEncoding());
+		rset.release();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ OStatement::getConnection() -I- */
+Reference< XConnection > SAL_CALL OCommonStatement::getConnection()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getConnection");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	// just return(our connection here
+	return ((Reference< XConnection >)m_pConnection);
+}
+/* }}} */
+
+
+/* {{{ OStatement::getUpdateCount() -I- */
+sal_Int32 SAL_CALL OCommonStatement::getUpdateCount()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getUpdateCount");
+	return 0;
+}
+/* }}} */
+
+
+/* {{{ OStatement::queryInterface() -I- */
+Any SAL_CALL OStatement::queryInterface(const Type & rType)
+	throw(RuntimeException)
+{
+	OSL_TRACE("OStatement::queryInterface");
+	Any aRet = ::cppu::queryInterface(rType,static_cast< XBatchExecution*> (this));
+	if (!aRet.hasValue()) {
+		aRet = OCommonStatement::queryInterface(rType);
+	}
+	return (aRet);
+}
+/* }}} */
+
+
+/* {{{ OStatement::addBatch() -I- */
+void SAL_CALL OStatement::addBatch(const OUString& sql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OStatement::addBatch");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	m_aBatchList.push_back(sql);
+}
+/* }}} */
+
+
+/* {{{ OStatement::executeBatch() -I- */
+Sequence< sal_Int32 > SAL_CALL OStatement::executeBatch()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OStatement::executeBatch");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	Sequence< sal_Int32 > aRet = Sequence< sal_Int32 >();
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::executeUpdate() -I- */
+sal_Int32 SAL_CALL OCommonStatement::executeUpdate(const OUString& sql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::executeUpdate");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+    const ::rtl::OUString sSqlStatement = m_pConnection->transFormPreparedStatement(sql);
+
+    sal_Int32 affectedRows = 0;
+	try {
+		affectedRows = cppStatement->executeUpdate(OUStringToOString(sSqlStatement, m_pConnection->getConnectionEncoding()).getStr());
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return affectedRows;
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getResultSet() -I- */
+Reference< XResultSet > SAL_CALL OCommonStatement::getResultSet()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getResultSet");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+    Reference< XResultSet > xResultSet;
+	try {
+		std::auto_ptr< sql::ResultSet > rset(cppStatement->getResultSet());
+		xResultSet = new OResultSet(this, rset.get(), m_pConnection->getConnectionEncoding());
+		rset.release();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getMoreResults() -I- */
+sal_Bool SAL_CALL OCommonStatement::getMoreResults()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getMoreResults");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	// if your driver supports more than only one resultset 
+	// and has one more at this moment return(true
+	return (sal_False);
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getWarnings() -I- */
+Any SAL_CALL OCommonStatement::getWarnings()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getWarnings");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	return makeAny(m_aLastWarning);
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::clearWarnings() -I- */
+void SAL_CALL OCommonStatement::clearWarnings()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::clearWarnings");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+
+	m_aLastWarning = SQLWarning();
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::createArrayHelper() -I- */
+::cppu::IPropertyArrayHelper* OCommonStatement::createArrayHelper( ) const
+{
+	OSL_TRACE("OCommonStatement::createArrayHelper");
+	// this properties are define by the service statement
+	// they must in alphabetic order
+	Sequence< Property > aProps(10);
+	Property* pProperties = aProps.getArray();
+	sal_Int32 nPos = 0;
+	DECL_PROP0(CURSORNAME,	OUString);
+	DECL_BOOL_PROP0(ESCAPEPROCESSING);
+	DECL_PROP0(FETCHDIRECTION,sal_Int32);
+	DECL_PROP0(FETCHSIZE,	sal_Int32);
+	DECL_PROP0(MAXFIELDSIZE,sal_Int32);
+	DECL_PROP0(MAXROWS,		sal_Int32);
+	DECL_PROP0(QUERYTIMEOUT,sal_Int32);
+	DECL_PROP0(RESULTSETCONCURRENCY,sal_Int32);
+	DECL_PROP0(RESULTSETTYPE,sal_Int32);
+	DECL_BOOL_PROP0(USEBOOKMARKS);
+
+	return new ::cppu::OPropertyArrayHelper(aProps);
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getInfoHelper() -I- */
+::cppu::IPropertyArrayHelper & OCommonStatement::getInfoHelper()
+{
+	OSL_TRACE("OCommonStatement::getInfoHelper");
+	return(*const_cast<OCommonStatement*>(this)->getArrayHelper());
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::convertFastPropertyValue() -I- */
+sal_Bool OCommonStatement::convertFastPropertyValue(
+		Any & /* rConvertedValue */, Any & /* rOldValue */,
+		sal_Int32 /* nHandle */, const Any& /* rValue */)
+	throw (IllegalArgumentException)
+{
+	OSL_TRACE("OCommonStatement::convertFastPropertyValue");
+	sal_Bool bConverted = sal_False;
+	// here we have to try to convert
+	return bConverted;
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::setFastPropertyValue_NoBroadcast() -I- */
+void OCommonStatement::setFastPropertyValue_NoBroadcast(sal_Int32 nHandle, const Any& /* rValue */)
+	throw (Exception)
+{
+	OSL_TRACE("OCommonStatement::setFastPropertyValue_NoBroadcast");
+	// set the value to what ever is nescessary
+	switch (nHandle) {
+		case PROPERTY_ID_QUERYTIMEOUT:
+		case PROPERTY_ID_MAXFIELDSIZE:
+		case PROPERTY_ID_MAXROWS:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		case PROPERTY_ID_ESCAPEPROCESSING:
+		case PROPERTY_ID_USEBOOKMARKS:
+		default:
+			;
+	}
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getFastPropertyValue() -I- */
+void OCommonStatement::getFastPropertyValue(Any& _rValue, sal_Int32 nHandle) const
+{
+	OSL_TRACE("OCommonStatement::getFastPropertyValue");
+	switch (nHandle)	{
+		case PROPERTY_ID_QUERYTIMEOUT:
+		case PROPERTY_ID_MAXFIELDSIZE:
+		case PROPERTY_ID_MAXROWS:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		case PROPERTY_ID_ESCAPEPROCESSING:
+			break;
+		case PROPERTY_ID_USEBOOKMARKS:
+            _rValue <<= sal_False;
+            break;
+		default:
+			;
+	}
+}
+/* }}} */
+
+IMPLEMENT_SERVICE_INFO(OStatement,"com.sun.star.sdbcx.OStatement","com.sun.star.sdbc.Statement");
+
+/* {{{ OCommonStatement::acquire() -I- */
+void SAL_CALL OCommonStatement::acquire()
+	throw()
+{
+	OSL_TRACE("OCommonStatement::acquire");
+	OCommonStatement_IBase::acquire();
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::release() -I- */
+void SAL_CALL OCommonStatement::release()
+	throw()
+{
+	OSL_TRACE("OCommonStatement::release");
+    relase_ChildImpl();
+}
+/* }}} */
+
+
+/* {{{ OStatement::acquire() -I- */
+void SAL_CALL OStatement::acquire()
+	throw()
+{
+	OSL_TRACE("OStatement::acquire");
+	OCommonStatement::acquire();
+}
+/* }}} */
+
+
+/* {{{ OStatement::release() -I- */
+void SAL_CALL OStatement::release()
+	throw()
+{
+	OSL_TRACE("OStatement::release");
+	OCommonStatement::release();
+}
+/* }}} */
+
+
+/* {{{ OCommonStatement::getPropertySetInfo() -I- */
+Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL OCommonStatement::getPropertySetInfo()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OCommonStatement::getPropertySetInfo");
+	return(::cppu::OPropertySetHelper::createPropertySetInfo(getInfoHelper()));
+}
+/* }}} */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_databasemetadata.cxx
===================================================================
--- mysqlc/source/mysqlc_databasemetadata.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_databasemetadata.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,2215 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_databasemetadata.cxx,v $
+*
+* $Revision: 1.1.2.5 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+#include "mysqlc_databasemetadata.hxx"
+#include <com/sun/star/sdbc/DataType.hpp>
+#include <com/sun/star/sdbc/ResultSetType.hpp>
+#include <com/sun/star/sdbc/ResultSetConcurrency.hpp>
+#include <com/sun/star/sdbc/TransactionIsolation.hpp>
+#include <com/sun/star/sdbc/KeyRule.hpp>
+#include <com/sun/star/sdbc/Deferrability.hpp>
+#include <com/sun/star/sdbc/IndexType.hpp>
+#include <com/sun/star/sdbc/BestRowScope.hpp>
+#include <com/sun/star/sdbc/ColumnType.hpp>
+#include <com/sun/star/lang/XInitialization.hpp>
+
+
+#include "mysqlc_general.hxx"
+#include "mysqlc_statement.hxx"
+#include "mysqlc_driver.hxx"
+#include "mysqlc_preparedstatement.hxx"
+
+#include <stdio.h>
+
+using namespace connectivity::mysqlc;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using ::rtl::OUString;
+using mysqlc_sdbc_driver::getStringFromAny;
+
+#include <cppconn/connection.h>
+#include <cppconn/resultset.h>
+#include <cppconn/metadata.h>
+#include <cppconn/statement.h>
+#include <cppconn/prepared_statement.h>
+
+static std::string wild("%");
+
+using ::rtl::OUStringToOString;
+
+// -----------------------------------------------------------------------------
+void lcl_setRows_throw(const Reference< XResultSet >& _xResultSet,sal_Int32 _nType,const std::vector< std::vector< Any > >& _rRows)
+{
+	Reference< XInitialization> xIni(_xResultSet,UNO_QUERY);
+	Sequence< Any > aArgs(2);
+	aArgs[0] <<= _nType;
+
+	Sequence< Sequence< Any > > aRows(_rRows.size());
+
+	std::vector< std::vector< Any > >::const_iterator aIter = _rRows.begin();
+	Sequence< Any > * pRowsIter = aRows.getArray();
+	Sequence< Any > * pRowsEnd  = pRowsIter + aRows.getLength();
+	for (; pRowsIter != pRowsEnd;++pRowsIter,++aIter) {
+		if (!aIter->empty()) {
+			Sequence<Any> aSeq(&(*aIter->begin()),aIter->size());
+			(*pRowsIter) = aSeq;
+		}
+	}
+	aArgs[1] <<= aRows;
+	xIni->initialize(aArgs);
+}
+
+
+/* {{{ ODatabaseMetaData::ODatabaseMetaData() -I- */
+ODatabaseMetaData::ODatabaseMetaData(OConnection& _rCon)
+	:m_rConnection(_rCon)
+	,m_bUseCatalog(sal_True)
+	,meta(_rCon.getConnectionSettings().cppConnection->getMetaData())
+	,identifier_quote_string_set(false)
+{
+	OSL_TRACE("ODatabaseMetaData::ODatabaseMetaData");
+	if (!m_rConnection.isCatalogUsed())
+	{
+		osl_incrementInterlockedCount(&m_refCount);
+		m_bUseCatalog = !(usesLocalFiles() || usesLocalFilePerTable());
+		osl_decrementInterlockedCount(&m_refCount);
+	}
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::~ODatabaseMetaData() -I- */
+ODatabaseMetaData::~ODatabaseMetaData()
+{
+	OSL_TRACE("ODatabaseMetaData::~ODatabaseMetaData");
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getStringMetaData() -I- */
+OUString ODatabaseMetaData::impl_getStringMetaData(const sal_Char* _methodName, const std::string& (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	OUString stringMetaData;
+	try {
+		stringMetaData = mysqlc_sdbc_driver::convert((meta->*_Method)(), m_rConnection.getConnectionEncoding());
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return stringMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getStringMetaData() -I- */
+OUString ODatabaseMetaData::impl_getStringMetaData(const sal_Char* _methodName, std::string (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	OUString stringMetaData;
+	try {
+		stringMetaData = mysqlc_sdbc_driver::convert((meta->*_Method)(), m_rConnection.getConnectionEncoding());
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return stringMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getStringMetaData() -I- */
+OUString ODatabaseMetaData::impl_getStringMetaData(const sal_Char* _methodName, const sql::SQLString& (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	OUString stringMetaData;
+	try {
+		stringMetaData = mysqlc_sdbc_driver::convert((meta->*_Method)(), m_rConnection.getConnectionEncoding());
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return stringMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getStringMetaData() -I- */
+OUString ODatabaseMetaData::impl_getStringMetaData(const sal_Char* _methodName, sql::SQLString (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	OUString stringMetaData;
+	try {
+		stringMetaData = mysqlc_sdbc_driver::convert((meta->*_Method)(), m_rConnection.getConnectionEncoding());
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return stringMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getInt32MetaData() -I- */
+sal_Int32 ODatabaseMetaData::impl_getInt32MetaData(const sal_Char* _methodName, unsigned int (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	sal_Int32 int32MetaData(0);
+	try {
+		int32MetaData = (meta->*_Method)();
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return int32MetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getBoolMetaData() -I- */
+sal_Bool ODatabaseMetaData::impl_getBoolMetaData(const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)() )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	sal_Bool boolMetaData(0);
+	try {
+		boolMetaData = (meta->*_Method)() ? sal_True : sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return boolMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getBoolMetaData() -I- */
+sal_Bool ODatabaseMetaData::impl_getBoolMetaData(const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)(int), sal_Int32 _arg )
+{
+	OSL_TRACE( "mysqlc::ODatabaseMetaData::%s", _methodName);
+	sal_Bool boolMetaData(0);
+	try {
+		boolMetaData = (meta->*_Method)( _arg ) ? sal_True : sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException(_methodName, *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException(_methodName, *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return boolMetaData;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::impl_getRSTypeMetaData() -I- */
+sal_Bool ODatabaseMetaData::impl_getRSTypeMetaData(const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)(int), sal_Int32 _resultSetType )
+{
+	int resultSetType(sql::ResultSet::TYPE_FORWARD_ONLY);
+	switch ( _resultSetType ) {
+		case ResultSetType::SCROLL_INSENSITIVE:	resultSetType = sql::ResultSet::TYPE_SCROLL_INSENSITIVE;	break;
+		case ResultSetType::SCROLL_SENSITIVE:	resultSetType = sql::ResultSet::TYPE_SCROLL_SENSITIVE;		break;
+	}
+
+	return impl_getBoolMetaData(_methodName, _Method, resultSetType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getCatalogSeparator() -I- */
+OUString SAL_CALL ODatabaseMetaData::getCatalogSeparator()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getCatalogSeparator", &sql::DatabaseMetaData::getCatalogSeparator);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxBinaryLiteralLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxBinaryLiteralLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxBinaryLiteralLength", &sql::DatabaseMetaData::getMaxBinaryLiteralLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxRowSize() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxRowSize()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxRowSize", &sql::DatabaseMetaData::getMaxRowSize);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxCatalogNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxCatalogNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxCatalogNameLength", &sql::DatabaseMetaData::getMaxCatalogNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxCharLiteralLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxCharLiteralLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxCharLiteralLength", &sql::DatabaseMetaData::getMaxCharLiteralLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnNameLength", &sql::DatabaseMetaData::getMaxColumnNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnsInIndex() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnsInIndex()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnsInIndex", &sql::DatabaseMetaData::getMaxColumnsInIndex);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxCursorNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxCursorNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxCursorNameLength", &sql::DatabaseMetaData::getMaxCursorNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxConnections() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxConnections()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxConnections", &sql::DatabaseMetaData::getMaxConnections);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnsInTable() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnsInTable()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnsInTable", &sql::DatabaseMetaData::getMaxColumnsInTable);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxStatementLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxStatementLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxStatementLength", &sql::DatabaseMetaData::getMaxStatementLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxTableNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxTableNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxTableNameLength", &sql::DatabaseMetaData::getMaxTableNameLength);
+}
+/* }}} */
+
+/* {{{ ODatabaseMetaData::getMaxTablesInSelect() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxTablesInSelect()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxTablesInSelect", &sql::DatabaseMetaData::getMaxTablesInSelect);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::doesMaxRowSizeIncludeBlobs() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::doesMaxRowSizeIncludeBlobs()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("doesMaxRowSizeIncludeBlobs", &sql::DatabaseMetaData::doesMaxRowSizeIncludeBlobs);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesLowerCaseQuotedIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesLowerCaseQuotedIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesLowerCaseQuotedIdentifiers", &sql::DatabaseMetaData::storesLowerCaseQuotedIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesLowerCaseIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesLowerCaseIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesLowerCaseIdentifiers", &sql::DatabaseMetaData::storesLowerCaseIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesMixedCaseQuotedIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesMixedCaseQuotedIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesMixedCaseQuotedIdentifiers", &sql::DatabaseMetaData::storesMixedCaseQuotedIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesMixedCaseIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesMixedCaseIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesMixedCaseIdentifiers", &sql::DatabaseMetaData::storesMixedCaseIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesUpperCaseQuotedIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesUpperCaseQuotedIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesUpperCaseQuotedIdentifiers", &sql::DatabaseMetaData::storesUpperCaseQuotedIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::storesUpperCaseIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::storesUpperCaseIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("storesUpperCaseIdentifiers", &sql::DatabaseMetaData::storesUpperCaseIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsAlterTableWithAddColumn() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsAlterTableWithAddColumn()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsAlterTableWithAddColumn", &sql::DatabaseMetaData::supportsAlterTableWithAddColumn);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsAlterTableWithDropColumn() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsAlterTableWithDropColumn()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsAlterTableWithDropColumn", &sql::DatabaseMetaData::supportsAlterTableWithDropColumn);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxIndexLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxIndexLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxIndexLength", &sql::DatabaseMetaData::getMaxIndexLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsNonNullableColumns() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsNonNullableColumns()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsNonNullableColumns", &sql::DatabaseMetaData::supportsNonNullableColumns);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getCatalogTerm() -I- */
+OUString SAL_CALL ODatabaseMetaData::getCatalogTerm()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getCatalogTerm", &sql::DatabaseMetaData::getCatalogTerm);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getIdentifierQuoteString() -I- */
+OUString SAL_CALL ODatabaseMetaData::getIdentifierQuoteString()
+	throw(SQLException, RuntimeException)
+{
+	if (identifier_quote_string_set == false) {
+		identifier_quote_string = impl_getStringMetaData("getIdentifierQuoteString", &sql::DatabaseMetaData::getIdentifierQuoteString);
+		identifier_quote_string_set = true;
+	}
+	return identifier_quote_string;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getExtraNameCharacters() -I- */
+OUString SAL_CALL ODatabaseMetaData::getExtraNameCharacters()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getExtraNameCharacters", &sql::DatabaseMetaData::getExtraNameCharacters);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsDifferentTableCorrelationNames() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsDifferentTableCorrelationNames()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsDifferentTableCorrelationNames", &sql::DatabaseMetaData::supportsDifferentTableCorrelationNames);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::isCatalogAtStart() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::isCatalogAtStart()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("isCatalogAtStart", &sql::DatabaseMetaData::isCatalogAtStart);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::dataDefinitionIgnoredInTransactions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::dataDefinitionIgnoredInTransactions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("dataDefinitionIgnoredInTransactions", &sql::DatabaseMetaData::dataDefinitionIgnoredInTransactions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::dataDefinitionCausesTransactionCommit() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::dataDefinitionCausesTransactionCommit()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("dataDefinitionCausesTransactionCommit", &sql::DatabaseMetaData::dataDefinitionCausesTransactionCommit);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsDataManipulationTransactionsOnly() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsDataManipulationTransactionsOnly()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsDataManipulationTransactionsOnly", &sql::DatabaseMetaData::supportsDataManipulationTransactionsOnly);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsDataDefinitionAndDataManipulationTransactions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsDataDefinitionAndDataManipulationTransactions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsDataDefinitionAndDataManipulationTransactions", &sql::DatabaseMetaData::supportsDataDefinitionAndDataManipulationTransactions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsPositionedDelete() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsPositionedDelete()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsPositionedDelete", &sql::DatabaseMetaData::supportsPositionedDelete);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsPositionedUpdate() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsPositionedUpdate()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsPositionedUpdate", &sql::DatabaseMetaData::supportsPositionedUpdate);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOpenStatementsAcrossRollback() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOpenStatementsAcrossRollback()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOpenStatementsAcrossRollback", &sql::DatabaseMetaData::supportsOpenStatementsAcrossRollback);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOpenStatementsAcrossCommit() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOpenStatementsAcrossCommit()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOpenStatementsAcrossCommit", &sql::DatabaseMetaData::supportsOpenStatementsAcrossCommit);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOpenCursorsAcrossCommit() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOpenCursorsAcrossCommit()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOpenCursorsAcrossCommit", &sql::DatabaseMetaData::supportsOpenCursorsAcrossCommit);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOpenCursorsAcrossRollback() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOpenCursorsAcrossRollback()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOpenCursorsAcrossRollback", &sql::DatabaseMetaData::supportsOpenCursorsAcrossRollback);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsTransactionIsolationLevel() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsTransactionIsolationLevel(sal_Int32 level)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsTransactionIsolationLevel", &sql::DatabaseMetaData::supportsTransactionIsolationLevel, level);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSchemasInDataManipulation() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSchemasInDataManipulation()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSchemasInDataManipulation", &sql::DatabaseMetaData::supportsSchemasInDataManipulation);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsANSI92FullSQL() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsANSI92FullSQL()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsANSI92FullSQL", &sql::DatabaseMetaData::supportsANSI92FullSQL);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsANSI92EntryLevelSQL() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsANSI92EntryLevelSQL()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsANSI92EntryLevelSQL", &sql::DatabaseMetaData::supportsANSI92EntryLevelSQL);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsIntegrityEnhancementFacility() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsIntegrityEnhancementFacility()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsIntegrityEnhancementFacility", &sql::DatabaseMetaData::supportsIntegrityEnhancementFacility);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSchemasInIndexDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSchemasInIndexDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSchemasInIndexDefinitions", &sql::DatabaseMetaData::supportsSchemasInIndexDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSchemasInTableDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSchemasInTableDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSchemasInTableDefinitions", &sql::DatabaseMetaData::supportsSchemasInTableDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCatalogsInTableDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCatalogsInTableDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCatalogsInTableDefinitions", &sql::DatabaseMetaData::supportsCatalogsInTableDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCatalogsInIndexDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCatalogsInIndexDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCatalogsInIndexDefinitions", &sql::DatabaseMetaData::supportsCatalogsInIndexDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCatalogsInDataManipulation() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCatalogsInDataManipulation()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCatalogsInDataManipulation", &sql::DatabaseMetaData::supportsCatalogsInDataManipulation);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOuterJoins() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOuterJoins()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOuterJoins", &sql::DatabaseMetaData::supportsOuterJoins);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxStatements() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxStatements()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxStatements", &sql::DatabaseMetaData::getMaxStatements);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxProcedureNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxProcedureNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxProcedureNameLength", &sql::DatabaseMetaData::getMaxProcedureNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxSchemaNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxSchemaNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxSchemaNameLength", &sql::DatabaseMetaData::getMaxSchemaNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsTransactions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsTransactions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsTransactions", &sql::DatabaseMetaData::supportsTransactions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::allProceduresAreCallable() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::allProceduresAreCallable()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("allProceduresAreCallable", &sql::DatabaseMetaData::allProceduresAreCallable);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsStoredProcedures() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsStoredProcedures()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsStoredProcedures", &sql::DatabaseMetaData::supportsStoredProcedures);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSelectForUpdate() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSelectForUpdate()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSelectForUpdate", &sql::DatabaseMetaData::supportsSelectForUpdate);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::allTablesAreSelectable() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::allTablesAreSelectable()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("allTablesAreSelectable", &sql::DatabaseMetaData::allTablesAreSelectable);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::isReadOnly() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::isReadOnly()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("isReadOnly", &sql::DatabaseMetaData::isReadOnly);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::usesLocalFiles() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::usesLocalFiles()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("usesLocalFiles", &sql::DatabaseMetaData::usesLocalFiles);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::usesLocalFilePerTable() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::usesLocalFilePerTable()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("usesLocalFilePerTable", &sql::DatabaseMetaData::usesLocalFilePerTable);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsTypeConversion() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsTypeConversion()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsTypeConversion", &sql::DatabaseMetaData::supportsTypeConversion);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::nullPlusNonNullIsNull() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::nullPlusNonNullIsNull()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("nullPlusNonNullIsNull", &sql::DatabaseMetaData::nullPlusNonNullIsNull);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsColumnAliasing() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsColumnAliasing()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsColumnAliasing", &sql::DatabaseMetaData::supportsColumnAliasing);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsTableCorrelationNames() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsTableCorrelationNames()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsTableCorrelationNames", &sql::DatabaseMetaData::supportsTableCorrelationNames);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsConvert() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsConvert(sal_Int32 /* fromType */, sal_Int32 /* toType */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::supportsConvert");
+	try {
+		/* ToDo -> use supportsConvert( fromType, toType) */
+		return meta->supportsConvert()? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::supportsConvert", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::supportsConvert", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsExpressionsInOrderBy() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsExpressionsInOrderBy()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsExpressionsInOrderBy", &sql::DatabaseMetaData::supportsExpressionsInOrderBy);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsGroupBy() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsGroupBy()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsGroupBy", &sql::DatabaseMetaData::supportsGroupBy);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsGroupByBeyondSelect() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsGroupByBeyondSelect()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsGroupByBeyondSelect", &sql::DatabaseMetaData::supportsGroupByBeyondSelect);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsGroupByUnrelated() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsGroupByUnrelated()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsGroupByUnrelated", &sql::DatabaseMetaData::supportsGroupByUnrelated);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsMultipleTransactions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsMultipleTransactions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsMultipleTransactions", &sql::DatabaseMetaData::supportsMultipleTransactions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsMultipleResultSets() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsMultipleResultSets()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsMultipleResultSets", &sql::DatabaseMetaData::supportsMultipleResultSets);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsLikeEscapeClause() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsLikeEscapeClause()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsLikeEscapeClause", &sql::DatabaseMetaData::supportsLikeEscapeClause);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsOrderByUnrelated() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsOrderByUnrelated()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsOrderByUnrelated", &sql::DatabaseMetaData::supportsOrderByUnrelated);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsUnion() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsUnion()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsUnion", &sql::DatabaseMetaData::supportsUnion);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsUnionAll() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsUnionAll()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsUnionAll", &sql::DatabaseMetaData::supportsUnionAll);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsMixedCaseIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsMixedCaseIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsMixedCaseIdentifiers", &sql::DatabaseMetaData::supportsMixedCaseIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsMixedCaseQuotedIdentifiers() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsMixedCaseQuotedIdentifiers()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsMixedCaseQuotedIdentifiers", &sql::DatabaseMetaData::supportsMixedCaseQuotedIdentifiers);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::nullsAreSortedAtEnd() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::nullsAreSortedAtEnd()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("nullsAreSortedAtEnd", &sql::DatabaseMetaData::nullsAreSortedAtEnd);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::nullsAreSortedAtStart() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::nullsAreSortedAtStart()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("nullsAreSortedAtStart", &sql::DatabaseMetaData::nullsAreSortedAtStart);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::nullsAreSortedHigh() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::nullsAreSortedHigh()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("nullsAreSortedHigh", &sql::DatabaseMetaData::nullsAreSortedHigh);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::nullsAreSortedLow() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::nullsAreSortedLow()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("nullsAreSortedLow", &sql::DatabaseMetaData::nullsAreSortedLow);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSchemasInProcedureCalls() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSchemasInProcedureCalls()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSchemasInProcedureCalls", &sql::DatabaseMetaData::supportsSchemasInProcedureCalls);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSchemasInPrivilegeDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSchemasInPrivilegeDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSchemasInPrivilegeDefinitions", &sql::DatabaseMetaData::supportsSchemasInPrivilegeDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCatalogsInProcedureCalls() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCatalogsInProcedureCalls()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCatalogsInProcedureCalls", &sql::DatabaseMetaData::supportsCatalogsInProcedureCalls);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCatalogsInPrivilegeDefinitions() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCatalogsInPrivilegeDefinitions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCatalogsInPrivilegeDefinitions", &sql::DatabaseMetaData::supportsCatalogsInPrivilegeDefinitions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCorrelatedSubqueries() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCorrelatedSubqueries()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCorrelatedSubqueries", &sql::DatabaseMetaData::supportsCorrelatedSubqueries);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSubqueriesInComparisons() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSubqueriesInComparisons()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSubqueriesInComparisons", &sql::DatabaseMetaData::supportsSubqueriesInComparisons);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSubqueriesInExists() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSubqueriesInExists()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSubqueriesInExists", &sql::DatabaseMetaData::supportsSubqueriesInExists);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSubqueriesInIns() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSubqueriesInIns()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSubqueriesInIns", &sql::DatabaseMetaData::supportsSubqueriesInIns);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsSubqueriesInQuantifieds() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsSubqueriesInQuantifieds()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsSubqueriesInQuantifieds", &sql::DatabaseMetaData::supportsSubqueriesInQuantifieds);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsANSI92IntermediateSQL() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsANSI92IntermediateSQL()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsANSI92IntermediateSQL", &sql::DatabaseMetaData::supportsANSI92IntermediateSQL);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getURL() -I- */
+OUString SAL_CALL ODatabaseMetaData::getURL()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getURL");
+	return m_rConnection.getConnectionSettings().connectionURL;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getUserName() -I- */
+OUString SAL_CALL ODatabaseMetaData::getUserName()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getUserName", &sql::DatabaseMetaData::getUserName);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDriverName() -I- */
+OUString SAL_CALL ODatabaseMetaData::getDriverName()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getDriverName");
+	OUString aValue( RTL_CONSTASCII_USTRINGPARAM( "MySQL Connector/OO.org" ) );
+	return aValue;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDriverVersion() -I- */
+OUString SAL_CALL ODatabaseMetaData::getDriverVersion()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getDriverVersion");
+	static const OUString sVersion( RTL_CONSTASCII_USTRINGPARAM( "0.9.2" ) );
+	return sVersion;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDatabaseProductVersion() -I- */
+OUString SAL_CALL ODatabaseMetaData::getDatabaseProductVersion()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getDatabaseProductVersion", &sql::DatabaseMetaData::getDatabaseProductVersion);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDatabaseProductName() -I- */
+OUString SAL_CALL ODatabaseMetaData::getDatabaseProductName()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getDatabaseProductName", &sql::DatabaseMetaData::getDatabaseProductName);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getProcedureTerm() -I- */
+OUString SAL_CALL ODatabaseMetaData::getProcedureTerm()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getProcedureTerm", &sql::DatabaseMetaData::getProcedureTerm);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getSchemaTerm() -I- */
+OUString SAL_CALL ODatabaseMetaData::getSchemaTerm()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getSchemaTerm", &sql::DatabaseMetaData::getSchemaTerm);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDriverMajorVersion() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getDriverMajorVersion()
+	throw(RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getDriverMajorVersion");
+	return MYSQLC_VERSION_MAJOR;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDefaultTransactionIsolation() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getDefaultTransactionIsolation()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getDefaultTransactionIsolation");
+	try {
+		switch (meta->getDefaultTransactionIsolation()) {
+			case sql::TRANSACTION_SERIALIZABLE:		return TransactionIsolation::SERIALIZABLE;
+			case sql::TRANSACTION_REPEATABLE_READ:	return TransactionIsolation::REPEATABLE_READ;
+			case sql::TRANSACTION_READ_COMMITTED:	return TransactionIsolation::READ_COMMITTED;
+			case sql::TRANSACTION_READ_UNCOMMITTED:	return TransactionIsolation::READ_UNCOMMITTED;
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getDriverMajorVersion", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getDriverMajorVersion", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return TransactionIsolation::NONE;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getDriverMinorVersion() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getDriverMinorVersion()
+	throw(RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getDriverMinorVersion");
+	return MYSQLC_VERSION_MINOR;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getSQLKeywords() -I- */
+OUString SAL_CALL ODatabaseMetaData::getSQLKeywords()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getSQLKeywords", &sql::DatabaseMetaData::getSQLKeywords);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getSearchStringEscape() -I- */
+OUString SAL_CALL ODatabaseMetaData::getSearchStringEscape()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getSearchStringEscape", &sql::DatabaseMetaData::getSearchStringEscape);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getStringFunctions() -I- */
+OUString SAL_CALL ODatabaseMetaData::getStringFunctions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getStringFunctions", &sql::DatabaseMetaData::getStringFunctions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getTimeDateFunctions() -I- */
+OUString SAL_CALL ODatabaseMetaData::getTimeDateFunctions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getTimeDateFunctions", &sql::DatabaseMetaData::getTimeDateFunctions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getSystemFunctions() -I- */
+OUString SAL_CALL ODatabaseMetaData::getSystemFunctions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getSystemFunctions", &sql::DatabaseMetaData::getSystemFunctions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getNumericFunctions() -I- */
+OUString SAL_CALL ODatabaseMetaData::getNumericFunctions()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getStringMetaData("getNumericFunctions", &sql::DatabaseMetaData::getNumericFunctions);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsExtendedSQLGrammar() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsExtendedSQLGrammar()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsExtendedSQLGrammar", &sql::DatabaseMetaData::supportsExtendedSQLGrammar);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsCoreSQLGrammar() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsCoreSQLGrammar()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsCoreSQLGrammar", &sql::DatabaseMetaData::supportsCoreSQLGrammar);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsMinimumSQLGrammar() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsMinimumSQLGrammar()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsMinimumSQLGrammar", &sql::DatabaseMetaData::supportsMinimumSQLGrammar);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsFullOuterJoins() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsFullOuterJoins()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsFullOuterJoins", &sql::DatabaseMetaData::supportsFullOuterJoins);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsLimitedOuterJoins() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsLimitedOuterJoins()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsLimitedOuterJoins", &sql::DatabaseMetaData::supportsLimitedOuterJoins);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnsInGroupBy() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnsInGroupBy()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnsInGroupBy", &sql::DatabaseMetaData::getMaxColumnsInGroupBy);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnsInOrderBy() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnsInOrderBy()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnsInOrderBy", &sql::DatabaseMetaData::getMaxColumnsInOrderBy);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxColumnsInSelect() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxColumnsInSelect()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxColumnsInSelect", &sql::DatabaseMetaData::getMaxColumnsInSelect);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getMaxUserNameLength() -I- */
+sal_Int32 SAL_CALL ODatabaseMetaData::getMaxUserNameLength()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getInt32MetaData("getMaxUserNameLength", &sql::DatabaseMetaData::getMaxUserNameLength);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsResultSetType() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsResultSetType(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("supportsResultSetType", &sql::DatabaseMetaData::supportsResultSetType, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsResultSetConcurrency() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsResultSetConcurrency(sal_Int32 setType, sal_Int32 concurrency)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::supportsResultSetConcurrency");
+	/* TODO: Check this out */
+	try {
+		return meta->supportsResultSetConcurrency(setType, concurrency==com::sun::star::sdbc::TransactionIsolation::READ_COMMITTED?
+													sql::TRANSACTION_READ_COMMITTED:
+													(concurrency == com::sun::star::sdbc::TransactionIsolation::SERIALIZABLE? 
+														sql::TRANSACTION_SERIALIZABLE:sql::TRANSACTION_SERIALIZABLE))? sal_True:sal_False;
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::supportsResultSetConcurrency", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::supportsResultSetConcurrency", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::ownUpdatesAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::ownUpdatesAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("ownUpdatesAreVisible", &sql::DatabaseMetaData::ownUpdatesAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::ownDeletesAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::ownDeletesAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("ownDeletesAreVisible", &sql::DatabaseMetaData::ownDeletesAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::ownInsertsAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::ownInsertsAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("ownInsertsAreVisible", &sql::DatabaseMetaData::ownInsertsAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::othersUpdatesAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::othersUpdatesAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("othersUpdatesAreVisible", &sql::DatabaseMetaData::othersUpdatesAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::othersDeletesAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::othersDeletesAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("othersDeletesAreVisible", &sql::DatabaseMetaData::othersDeletesAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::othersInsertsAreVisible() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::othersInsertsAreVisible(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("othersInsertsAreVisible", &sql::DatabaseMetaData::othersInsertsAreVisible, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::updatesAreDetected() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::updatesAreDetected(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("updatesAreDetected", &sql::DatabaseMetaData::updatesAreDetected, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::deletesAreDetected() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::deletesAreDetected(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("deletesAreDetected", &sql::DatabaseMetaData::deletesAreDetected, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::insertsAreDetected() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::insertsAreDetected(sal_Int32 setType)
+	throw(SQLException, RuntimeException)
+{
+	return impl_getRSTypeMetaData("insertsAreDetected", &sql::DatabaseMetaData::insertsAreDetected, setType);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::supportsBatchUpdates() -I- */
+sal_Bool SAL_CALL ODatabaseMetaData::supportsBatchUpdates()
+	throw(SQLException, RuntimeException)
+{
+	return impl_getBoolMetaData("supportsBatchUpdates", &sql::DatabaseMetaData::supportsBatchUpdates);
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getConnection() -I- */
+Reference< XConnection > SAL_CALL ODatabaseMetaData::getConnection()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getConnection");
+	return (Reference< XConnection >)&m_rConnection;
+}
+/* }}} */
+
+
+/*
+  Here follow all methods which return(a resultset
+  the first methods is an example implementation how to use this resultset
+  of course you could implement it on your and you should do this because
+  the general way is more memory expensive
+*/
+
+/* {{{ ODatabaseMetaData::getTableTypes() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getTableTypes()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getTableTypes");
+	const char * table_types[] = {"TABLE", "VIEW"};
+	sal_Int32 requiredVersion[] = {0, 50000};
+
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+	rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+
+	for (sal_uInt32 i = 0; i < 2; i++) {
+		if (m_rConnection.getMysqlVersion() >= requiredVersion[i]) {
+			std::vector< Any > aRow(1);
+			aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(table_types[i], encoding)));
+			rRows.push_back(aRow);
+		}
+	}
+	lcl_setRows_throw(xResultSet, 5 ,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getTypeInfo() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getTypeInfo()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getTypeInfo");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+
+	std::vector< std::vector< Any > > rRows;
+
+	rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+	unsigned int i = 0;
+	while (mysqlc_types[i].typeName) {
+		std::vector< Any > aRow(1);
+
+		aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(mysqlc_types[i].typeName, encoding)));
+		aRow.push_back(makeAny(mysqlc_types[i].dataType));
+		aRow.push_back(makeAny(mysqlc_types[i].precision));
+		aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(mysqlc_types[i].literalPrefix, encoding)));
+		aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(mysqlc_types[i].literalSuffix, encoding)));
+		aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(mysqlc_types[i].createParams, encoding)));
+		aRow.push_back(makeAny(mysqlc_types[i].nullable));
+		aRow.push_back(makeAny(mysqlc_types[i].caseSensitive));
+		aRow.push_back(makeAny(mysqlc_types[i].searchable));
+		aRow.push_back(makeAny(mysqlc_types[i].isUnsigned));
+		aRow.push_back(makeAny(mysqlc_types[i].fixedPrecScale));
+		aRow.push_back(makeAny(mysqlc_types[i].autoIncrement));
+		aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(mysqlc_types[i].localTypeName, encoding)));
+		aRow.push_back(makeAny(mysqlc_types[i].minScale));
+		aRow.push_back(makeAny(mysqlc_types[i].maxScale));
+		aRow.push_back(makeAny(sal_Int32(0)));
+		aRow.push_back(makeAny(sal_Int32(0)));
+		aRow.push_back(makeAny(sal_Int32(10)));
+
+		rRows.push_back(aRow);
+		i++;
+	}
+
+	lcl_setRows_throw(xResultSet, 14, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getCatalogs() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getCatalogs()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getCatalogs");
+
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getCatalogs());
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getCatalogs", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getCatalogs", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 0, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getSchemas() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getSchemas()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getSchemas");
+
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getSchemas());
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			bool informationSchema = false;
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				sql::SQLString columnStringValue = rset->getString(i);
+				if (i == 1) {   // TABLE_SCHEM
+					informationSchema = (0 == columnStringValue.compare("information_schema"));
+				}
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(columnStringValue, encoding)));
+			}
+			if (!informationSchema ) {
+			    rRows.push_back(aRow);
+			}
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getSchemas", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getSchemas", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 1, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getColumnPrivileges() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getColumnPrivileges(
+		const Any& catalog,
+		const OUString& schema,
+		const OUString& table,
+		const OUString& columnNamePattern)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getColumnPrivileges");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+    std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr()),
+				cNamePattern(OUStringToOString(columnNamePattern, m_rConnection.getConnectionEncoding()).getStr());
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getColumnPrivileges(cat, sch, tab, cNamePattern.compare("")? cNamePattern:wild));
+
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getColumnPrivileges", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getColumnPrivileges", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 2, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getColumns() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getColumns( 
+		const Any& catalog,
+		const OUString& schemaPattern,
+		const OUString& tableNamePattern, 
+		const OUString& columnNamePattern)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getColumns");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sPattern(OUStringToOString(schemaPattern, m_rConnection.getConnectionEncoding()).getStr()),
+				tNamePattern(OUStringToOString(tableNamePattern, m_rConnection.getConnectionEncoding()).getStr()),
+				cNamePattern(OUStringToOString(columnNamePattern, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+	    std::auto_ptr< sql::ResultSet> rset( meta->getColumns(cat,
+											    sPattern.compare("")? sPattern:wild,
+											    tNamePattern.compare("")? tNamePattern:wild,
+											    cNamePattern.compare("")? cNamePattern:wild));
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				if (i == 5) { // ColumnType
+					sal_Int32 sdbc_type = mysqlc_sdbc_driver::mysqlToOOOType(atoi(rset->getString(i).c_str()));
+					aRow.push_back(makeAny(sdbc_type));
+				} else {
+					aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+				}
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getColumns", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getColumns", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+	lcl_setRows_throw(xResultSet, 3, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getTables() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getTables( 
+		const Any& catalog,
+		const OUString& schemaPattern, 
+		const OUString& tableNamePattern,
+		const Sequence< OUString >& types )
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getTables");
+	sal_Int32 nLength = types.getLength();
+
+	Reference< XResultSet > xResultSet(getOwnConnection().
+		getDriver().getFactory()->createInstance(
+				::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sPattern(OUStringToOString(schemaPattern, m_rConnection.getConnectionEncoding()).getStr()),
+				tNamePattern(OUStringToOString(tableNamePattern, m_rConnection.getConnectionEncoding()).getStr());
+
+	std::list<sql::SQLString> tabTypes;
+	for (const OUString *pStart = types.getConstArray(), *p = pStart, *pEnd = pStart + nLength; p != pEnd; ++p) {
+		tabTypes.push_back(OUStringToOString(*p, m_rConnection.getConnectionEncoding()).getStr());
+	}
+
+	try {
+		std::auto_ptr< sql::ResultSet> rset( meta->getTables(cat,
+											   sPattern.compare("")? sPattern:wild,
+											   tNamePattern.compare("")? tNamePattern:wild,
+											   tabTypes));
+
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			bool informationSchema = false;
+			for (sal_uInt32 i = 1; (i <= columns) && !informationSchema; ++i) {
+				sql::SQLString columnStringValue = rset->getString(i);
+				if (i == 2) {   // TABLE_SCHEM
+					informationSchema = ( 0 == columnStringValue.compare("information_schema"));
+				}
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(columnStringValue, encoding)));
+			}
+			if (!informationSchema) {
+				rRows.push_back(aRow);
+			}
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getTables", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getTables", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 4, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getProcedureColumns() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getProcedureColumns(
+		const Any& /* catalog */,
+		const OUString& /* schemaPattern */, 
+		const OUString& /* procedureNamePattern */,
+		const OUString& /* columnNamePattern */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getProcedureColumns");
+	// Currently there is no information available
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getProcedures() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getProcedures(
+		const Any& catalog,
+		const OUString& schemaPattern,
+		const OUString& procedureNamePattern)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getProcedures");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sPattern(OUStringToOString(schemaPattern, m_rConnection.getConnectionEncoding()).getStr()),
+				pNamePattern(OUStringToOString(procedureNamePattern, m_rConnection.getConnectionEncoding()).getStr());
+
+	
+	try {
+		std::auto_ptr< sql::ResultSet> rset( meta->getProcedures(cat,
+												   sPattern.compare("")? sPattern:wild,
+												   pNamePattern.compare("")? pNamePattern:wild));
+
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getProcedures", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getProcedures", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 7,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getVersionColumns() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getVersionColumns(
+		const Any& /* catalog */,
+		const OUString& /* schema */,
+		const OUString& /* table */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getVersionColumns");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+	lcl_setRows_throw(xResultSet, 16,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getExportedKeys() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getExportedKeys(
+		const Any&  catalog ,
+		const OUString&  schema ,
+		const OUString&  table )
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getExportedKeys");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getExportedKeys(cat, sch, tab));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getExportedKeys", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getExportedKeys", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 8, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getImportedKeys() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getImportedKeys(
+		const Any& catalog,
+		const OUString& schema,
+		const OUString& table)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getImportedKeys");
+
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getImportedKeys(cat, sch, tab));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getImportedKeys", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getImportedKeys", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet,9,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getPrimaryKeys() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getPrimaryKeys(
+		const Any& catalog,
+		const OUString& schema,
+		const OUString& table)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getPrimaryKeys");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getPrimaryKeys(cat, sch, tab));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getPrimaryKeys", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getPrimaryKeys", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 10, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getIndexInfo() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getIndexInfo(
+		const Any& catalog,
+		const OUString& schema,
+		const OUString& table,
+		sal_Bool unique,
+		sal_Bool approximate)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getIndexInfo");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getIndexInfo(cat, sch, tab, unique, approximate));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getIndexInfo", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getIndexInfo", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 11, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getBestRowIdentifier() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getBestRowIdentifier( 
+		const Any& catalog,
+		const OUString& schema,
+		const OUString& table,
+		sal_Int32 scope,
+		sal_Bool nullable)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getBestRowIdentifier");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sch(OUStringToOString(schema, m_rConnection.getConnectionEncoding()).getStr()),
+				tab(OUStringToOString(table, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getBestRowIdentifier(cat, sch, tab, scope, nullable));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getBestRowIdentifier", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getBestRowIdentifier", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet, 15, rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getTablePrivileges() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getTablePrivileges(
+		const Any& catalog,
+		const OUString& schemaPattern,
+		const OUString& tableNamePattern)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getTablePrivileges");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string	cat(catalog.hasValue()? OUStringToOString(getStringFromAny(catalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				sPattern(OUStringToOString(schemaPattern, m_rConnection.getConnectionEncoding()).getStr()),
+				tPattern(OUStringToOString(tableNamePattern, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		static bool fakeTablePrivileges = false;
+		if (fakeTablePrivileges) {
+			static const sal_Char* allPrivileges[] = {
+				"ALTER", "DELETE", "DROP", "INDEX", "INSERT", "LOCK TABLES", "SELECT", "UPDATE"
+			};
+			Any userName; userName <<= getUserName();
+			for (size_t i = 0; i < sizeof( allPrivileges ) / sizeof( allPrivileges[0]); ++i) {
+				std::vector< Any > aRow;
+				aRow.push_back(makeAny( sal_Int32( i ) ));
+				aRow.push_back(catalog);                                                          // TABLE_CAT
+				aRow.push_back(makeAny( schemaPattern ));                                         // TABLE_SCHEM
+				aRow.push_back(makeAny( tableNamePattern ));                                      // TABLE_NAME
+				aRow.push_back(Any());                                                            // GRANTOR
+				aRow.push_back(userName);                                                         // GRANTEE
+				aRow.push_back(makeAny( ::rtl::OUString::createFromAscii( allPrivileges[i] ) ));  // PRIVILEGE
+				aRow.push_back(Any());                                                            // IS_GRANTABLE
+
+				rRows.push_back(aRow);
+			}
+		} else {
+			rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+			std::auto_ptr< sql::ResultSet> rset( meta->getTablePrivileges(cat, sPattern.compare("")? sPattern:wild, tPattern.compare("")? tPattern:wild));
+			sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+			sal_uInt32 columns = rs_meta->getColumnCount();
+			while (rset->next()) {
+				std::vector< Any > aRow(1);
+				for (sal_uInt32 i = 1; i <= columns; i++) {
+					aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+				}
+				rRows.push_back(aRow);
+			}
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getTablePrivileges", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getTablePrivileges", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet,12,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getCrossReference() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getCrossReference(
+		const Any& primaryCatalog,
+		const OUString& primarySchema,
+		const OUString& primaryTable,
+		const Any& foreignCatalog,
+		const OUString& foreignSchema,
+		const OUString& foreignTable)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getCrossReference");
+	Reference< XResultSet > xResultSet(getOwnConnection().getDriver().getFactory()->createInstance(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.DatabaseMetaDataResultSet"))),UNO_QUERY);
+	std::vector< std::vector< Any > > rRows;
+
+	std::string	primaryCat(primaryCatalog.hasValue()? OUStringToOString(getStringFromAny(primaryCatalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				foreignCat(foreignCatalog.hasValue()? OUStringToOString(getStringFromAny(foreignCatalog), m_rConnection.getConnectionEncoding()).getStr():""),
+				pSchema(OUStringToOString(primarySchema, m_rConnection.getConnectionEncoding()).getStr()),
+				pTable(OUStringToOString(primaryTable, m_rConnection.getConnectionEncoding()).getStr()),
+				fSchema(OUStringToOString(foreignSchema, m_rConnection.getConnectionEncoding()).getStr()),
+				fTable(OUStringToOString(foreignTable, m_rConnection.getConnectionEncoding()).getStr());
+
+	try {
+		rtl_TextEncoding encoding = m_rConnection.getConnectionEncoding();
+		std::auto_ptr< sql::ResultSet> rset( meta->getCrossReference(primaryCat, pSchema, pTable, foreignCat, fSchema, fTable));
+		sql::ResultSetMetaData * rs_meta = rset->getMetaData();
+		sal_uInt32 columns = rs_meta->getColumnCount();
+		while (rset->next()) {
+			std::vector< Any > aRow(1);
+			for (sal_uInt32 i = 1; i <= columns; i++) {
+				aRow.push_back(makeAny(mysqlc_sdbc_driver::convert(rset->getString(i), encoding)));
+			}
+			rRows.push_back(aRow);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getCrossReference", *this);
+	} catch (sql::InvalidArgumentException) {
+		mysqlc_sdbc_driver::throwInvalidArgumentException("ODatabaseMetaData::getCrossReference", *this);
+	} catch (const sql::SQLException& e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, m_rConnection.getConnectionEncoding());
+	}
+
+	lcl_setRows_throw(xResultSet,13,rRows);
+	return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ ODatabaseMetaData::getUDTs() -I- */
+Reference< XResultSet > SAL_CALL ODatabaseMetaData::getUDTs(
+		const Any& /* catalog */,
+		const OUString& /* schemaPattern */,
+		const OUString& /* typeNamePattern */,
+		const Sequence< sal_Int32 >& /* types */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("ODatabaseMetaData::getUDTs");
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("ODatabaseMetaData::getUDTs", *this);
+	return NULL;
+}
+/* }}} */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
+
Index: mysqlc/source/mysqlc_types.hxx
===================================================================
--- mysqlc/source/mysqlc_types.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_types.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,56 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_types.hxx,v $
+*
+* $Revision: 1.1.2.2 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef MYSQLC_TYPES_HXX
+#define MYSQLC_TYPES_HXX
+
+struct TypeInfoDef {
+    const char *typeName;
+    sal_Int32 dataType;
+    sal_Int32 precision;
+    const char *literalPrefix;
+    const char *literalSuffix;
+    const char *createParams;
+    sal_Int16 nullable;
+    sal_Bool caseSensitive;
+    sal_Int16 searchable;
+    sal_Bool isUnsigned;
+    sal_Bool fixedPrecScale;
+    sal_Bool autoIncrement;
+    const char *localTypeName;
+    sal_Int32 minScale;
+    sal_Int32 maxScale;
+	sal_Int32 sqlDataType; 
+	sal_Int32 sqlDateTimeSub; 
+    sal_Int32 numPrecRadix;
+};
+
+extern TypeInfoDef mysqlc_types[];
+
+#endif /* MYSQLC_TYPES_HXX */
Index: mysqlc/source/mysqlc_statement.hxx
===================================================================
--- mysqlc/source/mysqlc_statement.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_statement.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,187 @@
+#ifndef MYSQLC_STATEMENT_HXX
+#define MYSQLC_STATEMENT_HXX
+
+#include "mysqlc_connection.hxx"
+#include "mysqlc_subcomponent.hxx"
+
+#include <com/sun/star/lang/XServiceInfo.hpp>
+#include <com/sun/star/sdbc/SQLWarning.hpp>
+#include <com/sun/star/sdbc/XBatchExecution.hpp>
+#include <com/sun/star/sdbc/XCloseable.hpp>
+#include <com/sun/star/sdbc/XMultipleResults.hpp>
+#include <com/sun/star/sdbc/XStatement.hpp>
+#include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+#include <com/sun/star/util/XCancellable.hpp>
+
+#include <cppconn/statement.h>
+#include <cppuhelper/compbase5.hxx>
+#include <list>
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		using ::com::sun::star::sdbc::SQLWarning;
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::Any;
+		using ::com::sun::star::uno::RuntimeException;
+		using ::rtl::OUString;
+
+        typedef ::cppu::WeakComponentImplHelper5<	::com::sun::star::sdbc::XStatement,
+                                                    ::com::sun::star::sdbc::XWarningsSupplier,
+                                                    ::com::sun::star::util::XCancellable,
+                                                    ::com::sun::star::sdbc::XCloseable,
+                                                    ::com::sun::star::sdbc::XMultipleResults> OCommonStatement_IBase;
+
+        class OCommonStatement;
+        typedef OSubComponent< OCommonStatement, OCommonStatement_IBase >   OStatement_CBase;
+
+		//**************************************************************
+		//************ Class: OCommonStatement
+		// is a base class for the normal statement and for the prepared statement
+		//**************************************************************
+        class OCommonStatement  :public OBase_Mutex
+                                ,public OCommonStatement_IBase
+                                ,public ::cppu::OPropertySetHelper
+                                ,public OPropertyArrayUsageHelper<OCommonStatement>
+                                ,public OStatement_CBase
+
+		{
+            friend class OSubComponent< OCommonStatement, OCommonStatement_IBase >;
+
+        private:
+			SQLWarning m_aLastWarning;
+
+		protected:
+			::std::list< OUString>	m_aBatchList;
+
+			OConnection*			m_pConnection;	// The owning Connection object
+
+			sql::Statement			*cppStatement;
+
+		protected:
+			void disposeResultSet();
+
+			// OPropertyArrayUsageHelper
+			::cppu::IPropertyArrayHelper* createArrayHelper( ) const;
+
+			// OPropertySetHelper
+			::cppu::IPropertyArrayHelper & SAL_CALL getInfoHelper();
+			sal_Bool SAL_CALL convertFastPropertyValue(Any & rConvertedValue, Any & rOldValue,
+															   sal_Int32 nHandle, const Any& rValue)
+												throw (::com::sun::star::lang::IllegalArgumentException);
+
+			void SAL_CALL setFastPropertyValue_NoBroadcast(sal_Int32 nHandle, const Any& rValue)
+												throw(::com::sun::star::uno::Exception);
+
+			void SAL_CALL getFastPropertyValue(Any& rValue, sal_Int32 nHandle) const;
+			virtual ~OCommonStatement();
+
+        protected:
+			OCommonStatement(OConnection* _pConnection, sql::Statement *_cppStatement);
+
+		public:
+			::cppu::OBroadcastHelper& rBHelper;
+			using OCommonStatement_IBase::operator ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >;
+
+			// OComponentHelper
+			void SAL_CALL disposing(void);
+
+			// XInterface
+			void SAL_CALL release() 			throw();
+
+			void SAL_CALL acquire() 			throw();
+
+			// XInterface
+			Any SAL_CALL queryInterface(const ::com::sun::star::uno::Type & rType)
+												throw(RuntimeException);
+
+			//XTypeProvider
+			::com::sun::star::uno::Sequence< ::com::sun::star::uno::Type > SAL_CALL getTypes()
+												throw(RuntimeException);
+
+			// XPropertySet
+			::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL getPropertySetInfo()
+												throw(RuntimeException);
+
+			// XStatement
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL executeQuery(const OUString& sql)
+												throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL executeUpdate(const OUString& sql)
+												throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL execute( const OUString& sql )
+												throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection()
+												throw(SQLException, RuntimeException);
+
+			// XWarningsSupplier
+			Any SAL_CALL getWarnings() 		throw(SQLException, RuntimeException);
+
+			void SAL_CALL clearWarnings() 		throw(SQLException, RuntimeException);
+
+			// XCancellable
+			void SAL_CALL cancel() 				throw(RuntimeException);
+
+			// XCloseable
+			void SAL_CALL close() 				throw(SQLException, RuntimeException);
+
+			// XMultipleResults
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getResultSet()
+												throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getUpdateCount() throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL getMoreResults()	throw(SQLException, RuntimeException);
+
+			// other methods
+			OConnection* getOwnConnection() const { return m_pConnection;}
+
+		private:
+			using ::cppu::OPropertySetHelper::getFastPropertyValue;
+		};
+
+
+		class OStatement :	public OCommonStatement,
+							public ::com::sun::star::sdbc::XBatchExecution,
+							public ::com::sun::star::lang::XServiceInfo
+
+		{
+		protected:
+			virtual ~OStatement(){}
+
+		public:
+			// ein Konstruktor, der fuer das Returnen des Objektes benoetigt wird:
+			OStatement(OConnection* _pConnection, sql::Statement *_cppStatement) : OCommonStatement(_pConnection, _cppStatement) {}
+			DECLARE_SERVICE_INFO();
+
+			Any SAL_CALL queryInterface( const ::com::sun::star::uno::Type & rType )
+												throw(RuntimeException);
+
+			void SAL_CALL acquire() 			throw();
+			void SAL_CALL release() 			throw();
+
+			// XBatchExecution
+			void SAL_CALL addBatch(const OUString& sql)
+												throw(SQLException, RuntimeException);
+
+			void SAL_CALL clearBatch()			throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Sequence< sal_Int32 > SAL_CALL executeBatch()
+												throw(SQLException, RuntimeException);
+
+		};
+	}
+}
+#endif // MYSQLC_STATEMENT_HXX
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_databasemetadata.hxx
===================================================================
--- mysqlc/source/mysqlc_databasemetadata.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_databasemetadata.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,243 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_databasemetadata.hxx,v $
+*
+* $Revision: 1.1.2.3 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef CONNECTIVITY_SDATABASEMETADATA_HXX
+#define CONNECTIVITY_SDATABASEMETADATA_HXX
+
+#include "mysqlc_connection.hxx"
+
+#ifndef _COM_SUN_STAR_SDBC_XDATABASEMETADATA_HPP_
+#include <com/sun/star/sdbc/XDatabaseMetaData.hpp>
+#endif
+#ifndef _CPPUHELPER_IMPLBASE1_HXX_
+#include <cppuhelper/implbase1.hxx>
+#endif
+
+#include <cppconn/metadata.h>
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		typedef ::com::sun::star::sdbc::SQLException my_SQLException;
+		typedef ::com::sun::star::uno::RuntimeException my_RuntimeException;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > my_XResultSetRef;
+		using ::com::sun::star::uno::Any;
+		using ::rtl::OUString;
+
+		//**************************************************************
+		//************ Class: ODatabaseMetaData
+		//**************************************************************
+
+		typedef ::cppu::WeakImplHelper1< ::com::sun::star::sdbc::XDatabaseMetaData> ODatabaseMetaData_BASE;
+
+        class ODatabaseMetaData : public ODatabaseMetaData_BASE
+		{
+			OConnection&	m_rConnection;
+			sal_Bool		m_bUseCatalog;
+		protected:
+			sql::DatabaseMetaData * meta;
+			OUString		identifier_quote_string;
+			bool			identifier_quote_string_set;
+
+        private:
+            OUString impl_getStringMetaData( const sal_Char* _methodName, const std::string& (sql::DatabaseMetaData::*_Method)() );
+            OUString impl_getStringMetaData( const sal_Char* _methodName, std::string (sql::DatabaseMetaData::*_Method)() );
+            OUString impl_getStringMetaData( const sal_Char* _methodName, const sql::SQLString& (sql::DatabaseMetaData::*_Method)() );
+            OUString impl_getStringMetaData( const sal_Char* _methodName, sql::SQLString (sql::DatabaseMetaData::*_Method)() );
+            sal_Int32 impl_getInt32MetaData( const sal_Char* _methodName, unsigned int (sql::DatabaseMetaData::*_Method)() );
+            sal_Bool impl_getBoolMetaData( const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)() );
+            sal_Bool impl_getBoolMetaData( const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)(int), sal_Int32 _arg );
+            sal_Bool impl_getRSTypeMetaData( const sal_Char* _methodName, bool (sql::DatabaseMetaData::*_Method)(int), sal_Int32 _resultSetType );
+
+        public:
+			inline const OConnection& getOwnConnection() const { return m_rConnection; }
+
+			ODatabaseMetaData(OConnection& _rCon);
+			virtual ~ODatabaseMetaData();
+
+			// as I mentioned before this interface is really BIG
+			// XDatabaseMetaData
+            sal_Bool SAL_CALL allProceduresAreCallable()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL allTablesAreSelectable()				throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getURL()						throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getUserName()					throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL isReadOnly()							throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL nullsAreSortedHigh()					throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL nullsAreSortedLow()					throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL nullsAreSortedAtStart()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL nullsAreSortedAtEnd()					throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getDatabaseProductName()		throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getDatabaseProductVersion()	throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getDriverName()				throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getDriverVersion()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getDriverMajorVersion()				throw(my_RuntimeException);
+            sal_Int32 SAL_CALL getDriverMinorVersion()				throw(my_RuntimeException);
+            sal_Bool SAL_CALL usesLocalFiles()						throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL usesLocalFilePerTable()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsMixedCaseIdentifiers()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesUpperCaseIdentifiers()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesLowerCaseIdentifiers()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesMixedCaseIdentifiers()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsMixedCaseQuotedIdentifiers()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesUpperCaseQuotedIdentifiers()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesLowerCaseQuotedIdentifiers()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL storesMixedCaseQuotedIdentifiers()	throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getIdentifierQuoteString() 	throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getSQLKeywords()				throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getNumericFunctions()			throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getStringFunctions()			throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getSystemFunctions()			throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getTimeDateFunctions()			throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getSearchStringEscape()		throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getExtraNameCharacters()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsAlterTableWithAddColumn()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsAlterTableWithDropColumn()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsColumnAliasing()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL nullPlusNonNullIsNull()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsTypeConversion()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsConvert(sal_Int32 fromType, sal_Int32 toType)
+																	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsTableCorrelationNames()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsDifferentTableCorrelationNames() throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsExpressionsInOrderBy()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOrderByUnrelated()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsGroupBy()						throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsGroupByUnrelated()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsGroupByBeyondSelect()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsLikeEscapeClause()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsMultipleResultSets()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsMultipleTransactions()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsNonNullableColumns()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsMinimumSQLGrammar()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCoreSQLGrammar()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsExtendedSQLGrammar()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsANSI92EntryLevelSQL()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsANSI92IntermediateSQL()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsANSI92FullSQL()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsIntegrityEnhancementFacility()throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOuterJoins()					throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsFullOuterJoins()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsLimitedOuterJoins()			throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getSchemaTerm()				throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getProcedureTerm()				throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getCatalogTerm()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL isCatalogAtStart()					throw(my_SQLException, my_RuntimeException);
+            OUString SAL_CALL getCatalogSeparator()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSchemasInDataManipulation()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSchemasInProcedureCalls()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSchemasInTableDefinitions()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSchemasInIndexDefinitions()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSchemasInPrivilegeDefinitions() throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCatalogsInDataManipulation()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCatalogsInProcedureCalls()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCatalogsInTableDefinitions()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCatalogsInIndexDefinitions()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCatalogsInPrivilegeDefinitions() throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsPositionedDelete()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsPositionedUpdate()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSelectForUpdate()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsStoredProcedures()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSubqueriesInComparisons()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSubqueriesInExists()			throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSubqueriesInIns()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsSubqueriesInQuantifieds()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsCorrelatedSubqueries()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsUnion()						throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsUnionAll()					throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOpenCursorsAcrossCommit()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOpenCursorsAcrossRollback()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOpenStatementsAcrossCommit()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsOpenStatementsAcrossRollback() throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxBinaryLiteralLength()			throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxCharLiteralLength()			throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnNameLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnsInGroupBy()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnsInIndex()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnsInOrderBy()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnsInSelect()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxColumnsInTable()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxConnections()					throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxCursorNameLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxIndexLength()					throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxSchemaNameLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxProcedureNameLength()			throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxCatalogNameLength()			throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxRowSize()						throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL doesMaxRowSizeIncludeBlobs()			throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxStatementLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxStatements()					throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxTableNameLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxTablesInSelect()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getMaxUserNameLength()				throw(my_SQLException, my_RuntimeException);
+            sal_Int32 SAL_CALL getDefaultTransactionIsolation()		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsTransactions()				throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsTransactionIsolationLevel(sal_Int32 level)
+																	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsDataDefinitionAndDataManipulationTransactions()
+																	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsDataManipulationTransactionsOnly()throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL dataDefinitionCausesTransactionCommit()	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL dataDefinitionIgnoredInTransactions()		throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getProcedures(const Any& catalog, const OUString& schemaPattern, const OUString& procedureNamePattern) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getProcedureColumns(const Any& catalog, const OUString& schemaPattern, const OUString& procedureNamePattern, const OUString& columnNamePattern) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getTables(const Any& catalog, const OUString& schemaPattern, const OUString& tableNamePattern, const ::com::sun::star::uno::Sequence< OUString >& types) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getSchemas() throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getCatalogs() throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getTableTypes() throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getColumns(const Any& catalog, const OUString& schemaPattern, const OUString& tableNamePattern, const OUString& columnNamePattern) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getColumnPrivileges(const Any& catalog, const OUString& schema, const OUString& table, const OUString& columnNamePattern) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getTablePrivileges(const Any& catalog, const OUString& schemaPattern, const OUString& tableNamePattern) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getBestRowIdentifier(const Any& catalog, const OUString& schema, const OUString& table, sal_Int32 scope, sal_Bool nullable) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getVersionColumns(const Any& catalog, const OUString& schema, const OUString& table) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getPrimaryKeys(const Any& catalog, const OUString& schema, const OUString& table) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getImportedKeys(const Any& catalog, const OUString& schema, const OUString& table) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getExportedKeys(const Any& catalog, const OUString& schema, const OUString& table) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getCrossReference(const Any& primaryCatalog, const OUString& primarySchema, const OUString& primaryTable, const Any& foreignCatalog, const OUString& foreignSchema, const OUString& foreignTable) throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getTypeInfo() throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getIndexInfo(const Any& catalog, const OUString& schema, const OUString& table, sal_Bool unique, sal_Bool approximate) throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsResultSetType(sal_Int32 setType) throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsResultSetConcurrency(sal_Int32 setType, sal_Int32 concurrency) throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL ownUpdatesAreVisible(sal_Int32 setType)	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL ownDeletesAreVisible(sal_Int32 setType)	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL ownInsertsAreVisible(sal_Int32 setType)	throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL othersUpdatesAreVisible(sal_Int32 setType)throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL othersDeletesAreVisible(sal_Int32 setType)throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL othersInsertsAreVisible(sal_Int32 setType)throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL updatesAreDetected(sal_Int32 setType)		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL deletesAreDetected(sal_Int32 setType)		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL insertsAreDetected(sal_Int32 setType)		throw(my_SQLException, my_RuntimeException);
+            sal_Bool SAL_CALL supportsBatchUpdates() throw(my_SQLException, my_RuntimeException);
+            my_XResultSetRef SAL_CALL getUDTs(const Any& catalog, const OUString& schemaPattern, const OUString& typeNamePattern, const ::com::sun::star::uno::Sequence< sal_Int32 >& types) throw(my_SQLException, my_RuntimeException);
+            ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection() throw(my_SQLException, my_RuntimeException);
+		};
+	}
+}
+
+#endif // CONNECTIVITY_SDATABASEMETADATA_HXX
Index: mysqlc/source/mysqlc_general.cxx
===================================================================
--- mysqlc/source/mysqlc_general.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_general.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,176 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_general.cxx,v $
+*
+* $Revision: 1.1.2.3 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+#include "mysqlc_general.hxx"
+#include "mysqlc_resultsetmetadata.hxx"
+
+#include <cppconn/exception.h>
+#include <cppconn/datatype.h>
+
+using com::sun::star::sdbc::SQLException;
+
+using com::sun::star::uno::UNO_QUERY;
+using com::sun::star::uno::Reference;
+using com::sun::star::uno::XInterface;
+using com::sun::star::uno::Any;
+using ::rtl::OUString;
+
+namespace mysqlc_sdbc_driver
+{
+// -----------------------------------------------------------------------------
+void throwFeatureNotImplementedException( const sal_Char* _pAsciiFeatureName, const Reference< XInterface >& _rxContext, const Any* _pNextException )
+    throw (SQLException)
+{
+    const ::rtl::OUString sMessage = ::rtl::OUString::createFromAscii( _pAsciiFeatureName ) + ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( ": feature not implemented." ) );
+    throw SQLException(
+        sMessage,
+        _rxContext,
+        ::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("HYC00")),
+        0,
+        _pNextException ? *_pNextException : Any()
+    );
+}
+
+
+void throwInvalidArgumentException( const sal_Char* _pAsciiFeatureName, const Reference< XInterface >& _rxContext, const Any* _pNextException )
+    throw (SQLException)
+{
+    const ::rtl::OUString sMessage = ::rtl::OUString::createFromAscii( _pAsciiFeatureName ) + ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( ": invalid arguments." ) );
+    throw SQLException(
+        sMessage,
+        _rxContext,
+        ::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("HYC00")),
+        0,
+        _pNextException ? *_pNextException : Any()
+    );
+}
+
+void translateAndThrow(const ::sql::SQLException& _error, const ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _context, const rtl_TextEncoding encoding)
+{
+	throw SQLException(
+			convert(_error.what(), encoding),
+			_context,
+			convert(_error.getSQLState(), encoding),
+			_error.getErrorCode(),
+			Any()
+		);
+}
+
+
+OUString getStringFromAny(const Any& _rAny)
+{
+	OUString nReturn;
+	OSL_VERIFY( _rAny >>= nReturn );
+	return nReturn;
+}
+
+
+int mysqlToOOOType(int cppConnType)
+	throw ()
+{
+	switch (cppConnType) {
+		case sql::DataType::BIT:
+			return com::sun::star::sdbc::DataType::VARCHAR;
+
+		case sql::DataType::TINYINT:
+			return com::sun::star::sdbc::DataType::TINYINT;
+
+		case sql::DataType::SMALLINT:
+			return com::sun::star::sdbc::DataType::SMALLINT;
+
+		case sql::DataType::INTEGER:
+			return com::sun::star::sdbc::DataType::INTEGER;
+
+		case sql::DataType::BIGINT:
+			return com::sun::star::sdbc::DataType::BIGINT;
+
+		case sql::DataType::REAL:
+			return com::sun::star::sdbc::DataType::REAL;
+
+		case sql::DataType::DOUBLE:
+			return com::sun::star::sdbc::DataType::DOUBLE;
+
+		case sql::DataType::DECIMAL:
+			return com::sun::star::sdbc::DataType::DECIMAL;
+
+		case sql::DataType::CHAR:
+			return com::sun::star::sdbc::DataType::CHAR;
+
+		case sql::DataType::BINARY:
+			return com::sun::star::sdbc::DataType::BINARY;
+
+		case sql::DataType::ENUM:
+		case sql::DataType::SET:
+		case sql::DataType::VARCHAR:
+			return com::sun::star::sdbc::DataType::VARCHAR;
+		
+		case sql::DataType::VARBINARY:
+			return com::sun::star::sdbc::DataType::VARBINARY;
+
+		case sql::DataType::LONGVARCHAR:
+			return com::sun::star::sdbc::DataType::LONGVARCHAR;
+		
+		case sql::DataType::LONGVARBINARY:
+			return com::sun::star::sdbc::DataType::LONGVARBINARY;
+
+		case sql::DataType::TIMESTAMP:
+			return com::sun::star::sdbc::DataType::TIMESTAMP;
+		
+		case sql::DataType::DATE:
+			return com::sun::star::sdbc::DataType::DATE;
+
+		case sql::DataType::TIME:
+			return com::sun::star::sdbc::DataType::TIME;
+
+		case sql::DataType::GEOMETRY:
+			return com::sun::star::sdbc::DataType::VARCHAR;
+		
+		case sql::DataType::SQLNULL:
+			return com::sun::star::sdbc::DataType::SQLNULL;
+
+		case sql::DataType::UNKNOWN:
+			return com::sun::star::sdbc::DataType::VARCHAR;
+	}
+
+    OSL_ENSURE( false, "mysqlToOOOType: unhandled case, falling back to VARCHAR" );
+    return com::sun::star::sdbc::DataType::VARCHAR;
+}
+
+
+::rtl::OUString convert(const ::std::string& _string, const rtl_TextEncoding encoding)
+{
+	return ::rtl::OUString( _string.c_str(), _string.size(), encoding );
+}
+
+::std::string convert(const ::rtl::OUString& _string, const rtl_TextEncoding encoding)
+{
+	return ::std::string( ::rtl::OUStringToOString( _string, encoding ).getStr() );
+}
+
+
+} /* namespace */
Index: mysqlc/source/mysqlc_general.hxx
===================================================================
--- mysqlc/source/mysqlc_general.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_general.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,66 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_general.hxx,v $
+*
+* $Revision: 1.1.2.3 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef _MYSQLC_GENERAL_
+#define _MYSQLC_GENERAL_
+
+#include <cppconn/exception.h>
+
+#include <com/sun/star/uno/XInterface.hpp>
+#include <com/sun/star/sdbc/SQLException.hpp>
+
+namespace mysqlc_sdbc_driver
+{
+	rtl::OUString getStringFromAny(const ::com::sun::star::uno::Any& _rAny);
+
+    void throwFeatureNotImplementedException(
+            const sal_Char* _pAsciiFeatureName,
+            const ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _rxContext,
+            const ::com::sun::star::uno::Any* _pNextException = NULL
+        )
+        throw (::com::sun::star::sdbc::SQLException);
+
+    void throwInvalidArgumentException(
+            const sal_Char* _pAsciiFeatureName,
+            const ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _rxContext,
+            const ::com::sun::star::uno::Any* _pNextException = NULL
+        )
+        throw (::com::sun::star::sdbc::SQLException);
+
+	void translateAndThrow(const ::sql::SQLException& _error, const ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _context, const rtl_TextEncoding encoding);
+
+	int mysqlToOOOType(int mysqlType) throw ();
+
+
+	::rtl::OUString convert(const ::std::string& _string, const rtl_TextEncoding encoding);
+
+	::std::string convert(const ::rtl::OUString& _string, const rtl_TextEncoding encoding);
+}
+
+#endif
Index: mysqlc/source/mysqlc_services.cxx
===================================================================
--- mysqlc/source/mysqlc_services.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_services.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,183 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_services.cxx,v $
+*
+* $Revision: 1.1.2.5 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include "mysqlc_driver.hxx"
+
+#include <cppuhelper/factory.hxx>
+#include <osl/diagnose.h>
+#include <rtl/ustrbuf.hxx>
+
+using namespace connectivity::mysqlc;
+using ::rtl::OUString;
+using ::com::sun::star::uno::Reference;
+using ::com::sun::star::uno::Sequence;
+using ::com::sun::star::registry::XRegistryKey;
+using ::com::sun::star::lang::XSingleServiceFactory;
+using ::com::sun::star::lang::XMultiServiceFactory;
+
+typedef Reference< XSingleServiceFactory > (SAL_CALL *createFactoryFunc)
+		(
+			const Reference< XMultiServiceFactory > & rServiceManager,
+			const OUString & rComponentName, 
+			::cppu::ComponentInstantiation pCreateFunction,
+			const Sequence< OUString > & rServiceNames,
+			rtl_ModuleCount* _pTemp
+		);
+
+//***************************************************************************************
+//
+// Die vorgeschriebene C-API muss erfuellt werden!
+// Sie besteht aus drei Funktionen, die von dem Modul exportiert werden muessen.
+//
+
+//---------------------------------------------------------------------------------------
+void REGISTER_PROVIDER(
+		const OUString& aServiceImplName, 
+		const Sequence< OUString>& Services, 
+		const Reference< XRegistryKey > & xKey)
+{
+    ::rtl::OUStringBuffer aMainKeyName;
+    aMainKeyName.append( sal_Unicode( '/' ) );
+    aMainKeyName.append( aServiceImplName );
+    aMainKeyName.appendAscii( "/UNO/SERVICES" );
+
+	Reference< XRegistryKey > xNewKey( xKey->createKey( aMainKeyName.makeStringAndClear() ) );
+	OSL_ENSURE(xNewKey.is(), "SKELETON::component_writeInfo : could not create a registry key !");
+
+	for (sal_Int32 i = 0; i < Services.getLength(); ++i) {
+		xNewKey->createKey(Services[i]);
+	}
+}
+
+
+//---------------------------------------------------------------------------------------
+struct ProviderRequest
+{
+	Reference< XSingleServiceFactory > xRet;
+	Reference< XMultiServiceFactory > const xServiceManager;
+	OUString const sImplementationName;
+
+	ProviderRequest(
+		void* pServiceManager,
+		sal_Char const* pImplementationName
+	) : xServiceManager(reinterpret_cast<XMultiServiceFactory*>(pServiceManager))
+	  , sImplementationName(OUString::createFromAscii(pImplementationName))
+	{
+	}
+
+	/* {{{ CREATE_PROVIDER -I- */
+	inline sal_Bool CREATE_PROVIDER(
+				const OUString& Implname, 
+				const Sequence< OUString > & Services,
+				::cppu::ComponentInstantiation Factory,
+				createFactoryFunc creator
+			)
+	{
+		if (!xRet.is() && (Implname == sImplementationName)) {
+			try {
+				xRet = creator( xServiceManager, sImplementationName,Factory, Services,0);
+			} catch (...) {
+			}
+		}
+		return xRet.is();
+	}
+
+	void* getProvider() const { return xRet.get(); }
+};
+/* }}} */
+
+
+/* {{{ component_getImplementationEnvironment -I- */
+extern "C" SAL_DLLPUBLIC_EXPORT void SAL_CALL component_getImplementationEnvironment(
+				const sal_Char	**ppEnvTypeName,
+				uno_Environment	** /* ppEnv */
+			)
+{
+	*ppEnvTypeName = CPPU_CURRENT_LANGUAGE_BINDING_NAME;
+}
+/* }}} */
+
+
+/* {{{ component_writeInfo -I- */
+extern "C" SAL_DLLPUBLIC_EXPORT sal_Bool SAL_CALL component_writeInfo(void * /* pServiceManager */, void * pRegistryKey)
+{
+	if (pRegistryKey) {
+		try	{
+			Reference< XRegistryKey > xKey(reinterpret_cast< XRegistryKey*>(pRegistryKey));
+
+			REGISTER_PROVIDER(
+				MysqlCDriver::getImplementationName_Static(), 
+				MysqlCDriver::getSupportedServiceNames_Static(), xKey);
+
+			return sal_True;
+		} catch (::com::sun::star::registry::InvalidRegistryException& ) {
+			OSL_ENSURE(sal_False, "SKELETON::component_writeInfo : could not create a registry key ! ## InvalidRegistryException !");
+		}
+	}
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ component_getFactory -I- */
+extern "C" SAL_DLLPUBLIC_EXPORT void* SAL_CALL component_getFactory(
+					const sal_Char * pImplementationName,
+					void * pServiceManager,
+					void * /* pRegistryKey */)
+{
+	void* pRet = 0;
+	if (pServiceManager) {
+		ProviderRequest aReq(pServiceManager,pImplementationName);
+
+		aReq.CREATE_PROVIDER(
+			MysqlCDriver::getImplementationName_Static(),
+			MysqlCDriver::getSupportedServiceNames_Static(),
+			MysqlCDriver_CreateInstance, ::cppu::createSingleFactory)
+		;
+
+		if(aReq.xRet.is()) {
+			aReq.xRet->acquire();
+		}
+
+		pRet = aReq.getProvider();
+	}
+
+	return pRet;
+};
+/* }}} */
+
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_preparedstatement.cxx
===================================================================
--- mysqlc/source/mysqlc_preparedstatement.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_preparedstatement.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,944 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_preparedstatement.cxx,v $
+*
+* $Revision: 1.1.2.5 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include "mysqlc_general.hxx"
+#include "mysqlc_preparedstatement.hxx"
+#include "mysqlc_propertyids.hxx"
+#include "mysqlc_resultsetmetadata.hxx"
+
+#include <com/sun/star/lang/DisposedException.hpp>
+#include <com/sun/star/sdbc/DataType.hpp>
+
+#include <cppconn/connection.h>
+#include <cppconn/exception.h>
+#include <cppconn/parameter_metadata.h>
+#include <cppconn/prepared_statement.h>
+#include <cppconn/statement.h>
+#include <cppuhelper/typeprovider.hxx>
+#include <osl/diagnose.h>
+
+#include <stdio.h>
+
+using namespace connectivity::mysqlc;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+using ::osl::MutexGuard;
+using mysqlc_sdbc_driver::getStringFromAny;
+
+
+/* {{{ my_i_to_a() -I- */
+static inline char * my_i_to_a(char * buf, size_t buf_size, int a)
+{
+	snprintf(buf, buf_size, "%d", a);
+	return buf;
+}
+/* }}} */
+
+
+IMPLEMENT_SERVICE_INFO(OPreparedStatement,"com.sun.star.sdbcx.mysqlc.PreparedStatement","com.sun.star.sdbc.PreparedStatement");
+
+
+/* {{{ OPreparedStatement::OPreparedStatement() -I- */
+OPreparedStatement::OPreparedStatement(OConnection* _pConnection, sql::PreparedStatement * _cppPrepStmt)
+	:OCommonStatement(_pConnection, _cppPrepStmt)
+{
+	OSL_TRACE("OPreparedStatement::OPreparedStatement");
+	m_pConnection = _pConnection;
+	m_pConnection->acquire();
+
+	try {
+		m_paramCount = ((sql::PreparedStatement *)cppStatement)->getParameterMetaData()->getParameterCount();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::~OPreparedStatement() -I- */
+OPreparedStatement::~OPreparedStatement()
+{
+	OSL_TRACE("OPreparedStatement::~OPreparedStatement");
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::acquire() -I- */
+void SAL_CALL OPreparedStatement::acquire()
+	throw()
+{
+	OSL_TRACE("OPreparedStatement::acquire");
+	OCommonStatement::acquire();
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::release() -I- */
+void SAL_CALL OPreparedStatement::release()
+	throw()
+{
+	OSL_TRACE("OPreparedStatement::release");
+	OCommonStatement::release();
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::queryInterface() -I- */
+Any SAL_CALL OPreparedStatement::queryInterface(const Type & rType)
+	throw(RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::queryInterface");
+	Any aRet = OCommonStatement::queryInterface(rType);
+	if (!aRet.hasValue()) {
+		aRet = OPreparedStatement_BASE::queryInterface(rType);
+	}
+	return (aRet);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::getPropertySetInfo() -I- */
+Sequence< Type > SAL_CALL OPreparedStatement::getTypes()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::getTypes");
+	return concatSequences(OPreparedStatement_BASE::getTypes(), OCommonStatement::getTypes());
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::getMetaData() -I- */
+Reference< XResultSetMetaData > SAL_CALL OPreparedStatement::getMetaData()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::getMetaData");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	
+	try {
+		if (!m_xMetaData.is()) {
+			m_xMetaData = new OResultSetMetaData(
+									((sql::PreparedStatement *)cppStatement)->getMetaData(),
+									getOwnConnection()->getConnectionEncoding()
+								);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+	return m_xMetaData;
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::close() -I- */
+void SAL_CALL OPreparedStatement::close()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::close");
+
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+		
+	try {
+		clearWarnings();
+		clearParameters();
+		OCommonStatement::close();
+	} catch (SQLException) {
+		// If we get an error, ignore
+	}
+
+	// Remove this Statement object from the Connection object's
+	// list
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::execute() -I- */
+sal_Bool SAL_CALL OPreparedStatement::execute()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::execute");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+
+    sal_Bool success = sal_False;
+	try {
+		success = ((sql::PreparedStatement *)cppStatement)->execute()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return success;
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::executeUpdate() -I- */
+sal_Int32 SAL_CALL OPreparedStatement::executeUpdate()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::executeUpdate");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	
+    sal_Int32 affectedRows = sal_False;
+	try {
+		affectedRows = ((sql::PreparedStatement *)cppStatement)->executeUpdate();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return affectedRows;
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::getPropertySetInfo() -I- */
+void SAL_CALL OPreparedStatement::setString(sal_Int32 parameter, const OUString& x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setString");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+        std::string stringie(::rtl::OUStringToOString(x, m_pConnection->getConnectionEncoding()).getStr());
+		((sql::PreparedStatement *)cppStatement)->setString(parameter, stringie);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::clearParameters", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::getConnection() -I- */
+Reference< XConnection > SAL_CALL OPreparedStatement::getConnection()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::getConnection");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+
+	return (Reference< XConnection >)m_pConnection;
+}
+/* }}} */
+
+Reference< XResultSet > SAL_CALL OPreparedStatement::executeQuery(const OUString& sql)
+    throw(SQLException, RuntimeException)
+{
+    return OCommonStatement::executeQuery( sql );
+}
+
+sal_Int32 SAL_CALL OPreparedStatement::executeUpdate(const OUString& sql)
+    throw(SQLException, RuntimeException)
+{
+    return OCommonStatement::executeUpdate( sql );
+}
+
+sal_Bool SAL_CALL OPreparedStatement::execute( const OUString& sql )
+    throw(SQLException, RuntimeException)
+{
+    return OCommonStatement::execute( sql );
+}
+
+/* {{{ OPreparedStatement::executeQuery() -I- */
+Reference< XResultSet > SAL_CALL OPreparedStatement::executeQuery()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::executeQuery");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+
+    Reference< XResultSet > xResultSet;
+    try {
+		sql::ResultSet * res = ((sql::PreparedStatement *)cppStatement)->executeQuery();
+		xResultSet = new OResultSet(this, res, getOwnConnection()->getConnectionEncoding());
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}
+    return xResultSet;
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setBoolean() -I- */
+void SAL_CALL OPreparedStatement::setBoolean(sal_Int32 parameter, sal_Bool x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setBoolean");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setBoolean(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setBoolean", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setByte() -I- */
+void SAL_CALL OPreparedStatement::setByte(sal_Int32 parameter, sal_Int8 x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setByte");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setInt(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setByte", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setDate() -I- */
+void SAL_CALL OPreparedStatement::setDate(sal_Int32 parameter, const Date& aData)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setDate");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	std::string dateStr;
+	char buf[20];
+	dateStr.append(my_i_to_a(buf, sizeof(buf)-1, aData.Year));
+	dateStr.append("-", 1);
+	dateStr.append(my_i_to_a(buf, sizeof(buf)-1, aData.Month));
+	dateStr.append("-", 1);
+	dateStr.append(my_i_to_a(buf, sizeof(buf)-1, aData.Day));
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setDateTime(parameter, dateStr);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setDate", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setTime() -I- */
+void SAL_CALL OPreparedStatement::setTime(sal_Int32 parameter, const Time& aVal)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setTime");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	std::string timeStr;
+	char buf[20];
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Hours));
+	timeStr.append(":", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Minutes));
+	timeStr.append(":", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Seconds));
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setDateTime(parameter, timeStr);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setTime", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setTimestamp() -I- */
+void SAL_CALL OPreparedStatement::setTimestamp(sal_Int32 parameter, const DateTime& aVal)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setTimestamp");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	std::string timeStr;
+	char buf[20];
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Year));
+	timeStr.append("-", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Month));
+	timeStr.append("-", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Day));
+
+	timeStr.append(" ", 1);
+
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Hours));
+	timeStr.append(":", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Minutes));
+	timeStr.append(":", 1);
+	timeStr.append(my_i_to_a(buf, sizeof(buf)-1, aVal.Seconds));
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setDateTime(parameter, timeStr);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setTimestamp", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setDouble() -I- */
+void SAL_CALL OPreparedStatement::setDouble(sal_Int32 parameter, double x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setDouble");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setDouble(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setDouble", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setFloat() -I- */
+void SAL_CALL OPreparedStatement::setFloat(sal_Int32 parameter, float x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setFloat");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setDouble(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setFloat", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setInt() -I- */
+void SAL_CALL OPreparedStatement::setInt(sal_Int32 parameter, sal_Int32 x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setInt");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setInt(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setInt", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setLong() -I- */
+void SAL_CALL OPreparedStatement::setLong(sal_Int32 parameter, sal_Int64 aVal)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setLong");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setInt64(parameter, aVal);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setLong", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setNull() -I- */
+void SAL_CALL OPreparedStatement::setNull(sal_Int32 parameter, sal_Int32 sqlType)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setNull");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setNull(parameter, sqlType);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setNull", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setClob() -U- */
+void SAL_CALL OPreparedStatement::setClob(sal_Int32 parameter, const Reference< XClob >& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setClob");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setClob", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setBlob() -U- */
+void SAL_CALL OPreparedStatement::setBlob(sal_Int32 parameter, const Reference< XBlob >& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setBlob");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setBlob", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setArray() -U- */
+void SAL_CALL OPreparedStatement::setArray(sal_Int32 parameter, const Reference< XArray >& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setArray");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setArray", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setRef() -U- */
+void SAL_CALL OPreparedStatement::setRef(sal_Int32 parameter, const Reference< XRef >& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setRef");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setRef", *this);
+}
+/* }}} */
+
+namespace
+{
+    template < class COMPLEXTYPE >
+    bool impl_setObject( const Reference< XParameters >& _rxParam, sal_Int32 _parameterIndex, const Any& _value,
+        void ( SAL_CALL XParameters::*_Setter )( sal_Int32, const COMPLEXTYPE& ), bool _throwIfNotExtractable )
+    {
+        COMPLEXTYPE aValue;
+        if ( _value >>= aValue )
+        {
+            (_rxParam.get()->*_Setter)( _parameterIndex, aValue );
+            return true;
+        }
+
+        if ( _throwIfNotExtractable )
+            mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", _rxParam );
+        return false;
+    }
+
+    template < class INTTYPE >
+    void impl_setObject( const Reference< XParameters >& _rxParam, sal_Int32 _parameterIndex, const Any& _value,
+        void ( SAL_CALL XParameters::*_Setter )( sal_Int32, INTTYPE ) )
+    {
+        sal_Int32 nValue(0);
+        if ( !( _value >>= nValue ) )
+            mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", _rxParam );
+        (_rxParam.get()->*_Setter)( _parameterIndex, (INTTYPE)nValue );
+    }
+}
+
+/* {{{ OPreparedStatement::setObjectWithInfo() -U- */
+void SAL_CALL OPreparedStatement::setObjectWithInfo(sal_Int32 _parameterIndex, const Any& _value, sal_Int32 _targetSqlType, sal_Int32 /* scale */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setObjectWithInfo");
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+	checkParameterIndex( _parameterIndex );
+
+    if ( !_value.hasValue() )
+    {
+	    setNull( _parameterIndex, _targetSqlType );
+        return;
+    }
+
+    switch ( _targetSqlType )
+    {
+    case DataType::DECIMAL:
+    case DataType::NUMERIC:
+    {
+        double nValue(0);
+        if ( _value >>= nValue )
+        {
+	        setDouble( _parameterIndex, nValue );
+            break;
+        }
+    }
+    // run through
+
+    case DataType::CHAR:
+    case DataType::VARCHAR:
+    case DataType::LONGVARCHAR:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setString, true );
+        break;
+
+    case DataType::BIGINT:
+    {
+	    sal_Int64 nValue = 0;
+        if ( !( _value >>= nValue ) )
+            mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", *this );
+        setLong( _parameterIndex, nValue );
+    }
+    break;
+
+    case DataType::FLOAT:
+    case DataType::REAL:
+    {
+	    float nValue = 0;
+	    if ( _value >>= nValue )
+	    {
+		    setFloat(_parameterIndex,nValue);
+		    break;
+	    }
+    }
+    // run through if we couldn't set a float value
+
+    case DataType::DOUBLE:
+    {
+        double nValue(0);
+        if ( !( _value >>= nValue ) )
+            mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", *this );
+	    setDouble( _parameterIndex, nValue );
+    }
+	break;
+
+    case DataType::DATE:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setDate, true );
+        break;
+
+    case DataType::TIME:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setTime, true );
+        break;
+
+    case DataType::TIMESTAMP:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setTimestamp, true );
+        break;
+
+    case DataType::BINARY:
+    case DataType::VARBINARY:
+    case DataType::LONGVARBINARY:
+    {
+        if  (   impl_setObject( this, _parameterIndex, _value, &XParameters::setBytes, false )
+            ||  impl_setObject( this, _parameterIndex, _value, &XParameters::setBlob, false )
+            ||  impl_setObject( this, _parameterIndex, _value, &XParameters::setClob, false )
+            )
+            break;
+
+        Reference< ::com::sun::star::io::XInputStream > xBinStream;
+	    if ( _value >>= xBinStream )
+        {
+		    setBinaryStream( _parameterIndex, xBinStream, xBinStream->available() );
+            break;
+        }
+
+        mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", *this );
+    }
+    break;
+
+    case DataType::BIT:
+    case DataType::BOOLEAN:
+    {
+        bool bValue( false );
+        if ( _value >>= bValue )
+        {
+            setBoolean( _parameterIndex, bValue );
+            break;
+        }
+        sal_Int32 nValue( 0 );
+        if ( _value >>= nValue )
+        {
+            setBoolean( _parameterIndex, ( nValue != 0 ) );
+            break;
+        }
+        mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", *this );
+    }
+    break;
+
+    case DataType::TINYINT:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setByte );
+	    break;
+
+    case DataType::SMALLINT:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setShort );
+	    break;
+
+    case DataType::INTEGER:
+        impl_setObject( this, _parameterIndex, _value, &XParameters::setInt );
+	    break;
+
+    default:
+        mysqlc_sdbc_driver::throwInvalidArgumentException( "OPreparedStatement::setObjectWithInfo", *this );
+        break;
+    }
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setObjectNull() -U- */
+void SAL_CALL OPreparedStatement::setObjectNull(sal_Int32 parameter, sal_Int32 /* sqlType */, const OUString& /* typeName */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setObjectNull");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setObjectNull", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setObject() -U- */
+void SAL_CALL OPreparedStatement::setObject(sal_Int32 parameter, const Any& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setObject");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setObject", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setShort() -I- */
+void SAL_CALL OPreparedStatement::setShort(sal_Int32 parameter, sal_Int16 x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setShort");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->setInt(parameter, x);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setShort", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setBytes() -I- */
+void SAL_CALL OPreparedStatement::setBytes(sal_Int32 parameter, const Sequence< sal_Int8 >& x)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setBytes");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	std::string blobby((char *)x.getConstArray(), x.getLength()); 
+	try {
+		((sql::PreparedStatement *)cppStatement)->setString(parameter, blobby);
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setBytes", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setCharacterStream() -U- */
+void SAL_CALL OPreparedStatement::setCharacterStream(sal_Int32 parameter,
+													const Reference< XInputStream >& /* x */,
+													sal_Int32 /* length */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setCharacterStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setCharacterStream", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setBinaryStream() -U- */
+void SAL_CALL OPreparedStatement::setBinaryStream(sal_Int32 parameter,
+												const Reference< XInputStream >& /* x */,
+												sal_Int32 /* length */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::setBinaryStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+	checkParameterIndex(parameter);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::setBinaryStream", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::clearParameters() -I- */
+void SAL_CALL OPreparedStatement::clearParameters()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::clearParameters");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OPreparedStatement::rBHelper.bDisposed);
+
+	try {
+		((sql::PreparedStatement *)cppStatement)->clearParameters();
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::clearParameters", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_pConnection->getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::clearBatch() -U- */
+void SAL_CALL OPreparedStatement::clearBatch()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::clearBatch");
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::clearBatch", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::addBatch() -U- */
+void SAL_CALL OPreparedStatement::addBatch()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::addBatch");
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OPreparedStatement::addBatch", *this);
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::executeBatch() -I- */
+Sequence< sal_Int32 > SAL_CALL OPreparedStatement::executeBatch()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OPreparedStatement::executeBatch");
+	Sequence< sal_Int32 > aRet= Sequence< sal_Int32 > ();
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::setFastPropertyValue_NoBroadcast() -I- */
+void OPreparedStatement::setFastPropertyValue_NoBroadcast(sal_Int32 nHandle,const Any& rValue)
+	throw(Exception)
+{
+	OSL_TRACE("OPreparedStatement::setFastPropertyValue_NoBroadcast");
+	switch(nHandle)
+	{
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+			break;
+		case PROPERTY_ID_RESULTSETTYPE:
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+			break;
+		case PROPERTY_ID_USEBOOKMARKS:
+			break;
+		default:
+			/* XXX: Recursion ?? */
+			OPreparedStatement::setFastPropertyValue_NoBroadcast(nHandle,rValue);
+	}
+}
+/* }}} */
+
+
+/* {{{ OPreparedStatement::checkParameterIndex() -I- */
+void OPreparedStatement::checkParameterIndex(sal_Int32 column)
+{
+	OSL_TRACE("OPreparedStatement::checkColumnIndex");
+	if (column < 1 || column > (sal_Int32) m_paramCount) {
+        OUString buf( RTL_CONSTASCII_USTRINGPARAM( "Parameter index out of range" ) );
+		throw SQLException(buf, *this, OUString(), 1, Any ());
+	}
+}
+/* }}} */
+
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/makefile.mk
===================================================================
--- mysqlc/source/makefile.mk	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/makefile.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,328 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+#
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+PRJ=..
+PRJNAME=mysqlc
+
+.INCLUDE : $(PRJ)$/version.mk
+
+TARGET=mysqlc
+ENABLE_EXCEPTIONS=TRUE
+LIBTARGET=NO
+EXTENSIONNAME:=mysql-connector-ooo
+
+.IF "$(SYSTEM_MYSQL)" == "YES"
+EXTERNAL_WARNINGS_NOT_ERRORS = TRUE
+.ENDIF
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  settings.mk
+
+#-------------------------------------------------------------------
+
+#---- extension version
+EXTENSION_VERSION_BASE=$(MYSQLC_VERSION_MAJOR).$(MYSQLC_VERSION_MINOR).$(MYSQLC_VERSION_MICRO)
+.IF ( "$(CWS_WORK_STAMP)" == "" ) || ( "$(UPDATER)" == "YES" )
+    EXTENSION_VERSION=$(EXTENSION_VERSION_BASE)
+.ELSE
+    EXTENSION_VERSION=$(EXTENSION_VERSION_BASE).cws.$(CWS_WORK_STAMP)
+.ENDIF
+
+#---- extension title package name
+.IF "$(MYSQLC_STATUS)" == "final"
+    EXTENSION_TITLE:=$(MYSQLC_TITLE)
+    EXTENSION_ZIPNAME:=$(EXTENSIONNAME)-$(EXTENSION_VERSION_BASE)-$(RTL_OS:l)-$(RTL_ARCH:l)
+.ELSE
+    EXTENSION_TITLE:=$(MYSQLC_TITLE) ($(MYSQLC_STATUS))
+    EXTENSION_ZIPNAME:=$(EXTENSIONNAME)-$(EXTENSION_VERSION_BASE)-$(MYSQLC_STATUS:s/ /-/:l)-$(RTL_OS:l)-$(RTL_ARCH:l)
+.ENDIF
+
+#-------------------------------------------------------------------
+
+# set default symbol visibility / scope to hidden
+.IF "$(COMNAME)" == "gcc3"
+.IF "$(HAVE_GCC_VISIBILITY_FEATURE)" == "TRUE"
+ CFLAGS += -fvisibility=hidden
+.ENDIF # HAVE_GCC_VISIBILITY_FEATURE
+.ENDIF # gcc3
+
+.IF "$(COMNAME)" == "sunpro5"
+.IF "$(CCNUMVER)" >= "00050005"
+ CFLAGS += -xldscope=hidden
+.ENDIF # 5.5
+.ENDIF # sunpro5
+
+#-------------------------------------------------------------------
+
+# The headers delivered from C/C++ have a habit of putting a ";" after the closing bracked of a namespace, which
+# yields a warning with Solaris' compiler. Until this is fixed in C/C++, silence this warning
+.IF "$(OS)" == "SOLARIS"
+    CFLAGSWARNCXX+=,wemptydecl
+    CFLAGSWARNCXX:=$(CFLAGSWARNCXX:s/ ,/,/)
+.ENDIF
+
+#-------------------------------------------------------------------
+.IF "$(ENABLE_MYSQLC)" != "YES"
+@all:
+	@echo "Mysql native driver extension build disabled."
+.ENDIF
+
+# use the static version
+.IF "$(GUI)"=="WNT"
+  MYSQL_LIBDIR=$(LIBMYSQL_PATH)$/lib
+  MYSQL_INCDIR=$(LIBMYSQL_PATH)$/include
+.ELSE
+  .IF "$(SYSTEM_MYSQL)" != "YES"
+    MYSQL_LIBDIR=$(LIBMYSQL_PATH)$/lib
+    MYSQL_INCDIR=$(LIBMYSQL_PATH)$/include
+  .ENDIF
+.ENDIF
+
+.IF "$(SYSTEM_MYSQL)" == "YES"
+CFLAGS+=-DSYSTEM_MYSQL
+.ENDIF
+
+.IF "$(SYSTEM_MYSQL_CPPCONN)" == "YES"
+CFLAGS+=-DSYSTEM_MYSQL_CPPCONN
+.ENDIF
+
+CDEFS+=-DCPPDBC_EXPORTS -DCPPCONN_LIB_BUILD
+.IF "$(SYSTEM_MYSQL_CPPCONN)" != "YES"
+CDEFS += -DCPPCONN_LIB=\"$(DLLPRE)mysqlcppconn$(DLLPOST)\"
+.ELSE
+CDEFS += -DCPPCONN_LIB=\"$(shell readlink /usr/lib/libmysqlcppconn.so)\"
+.ENDIF
+
+# --------------- MySQL settings ------------------
+.IF "$(GUI)"=="WNT"
+  MYSQL_INC=-I$(SOLARINCDIR)$/mysqlcppconn -I$(SOLARINCDIR)$/mysqlcppconn/cppconn -I$(MYSQL_INCDIR)
+  MYSQL_LIB=$(MYSQL_LIBDIR)$/libmysql.lib
+  MYSQL_LIBFILE=$(MYSQL_LIBDIR)$/libmysql.dll
+  MYSQL_CPPCONNFILE=$(SOLARBINDIR)$/$(DLLPRE)mysqlcppconn$(DLLPOST)
+.ELSE
+  .IF "$(SYSTEM_MYSQL)" != "YES"
+    MYSQL_INC+=-I$(MYSQL_INCDIR)
+    .IF "$(OS)"=="MACOSX"
+      MYSQL_LIBFILE=$(MYSQL_LIBDIR)$/$(DLLPRE)mysql.16$(DLLPOST)
+    .ELSE
+      MYSQL_LIBFILE=$(MYSQL_LIBDIR)$/$(DLLPRE)mysql$(DLLPOST).16
+    .ENDIF
+
+    # checkdll will complain if we do not point it to the libmysql lib
+    EXTRALIBPATHS=-L$(MYSQL_LIBDIR)
+  .ENDIF
+
+  .IF "$(SYSTEM_MYSQL_CPPCONN)" != "YES"
+    .IF "$(OS)"=="MACOSX" || "$(OS)" == "SOLARIS"
+      MYSQL_LIB+=-lz -lm
+    .ELSE
+      MYSQL_LIB+=-rdynamic -lz -lcrypt -lnsl -lm
+    .ENDIF
+    MYSQL_CPPCONNFILE=$(SOLARLIBDIR)$/$(DLLPRE)mysqlcppconn$(DLLPOST)
+  .ELSE
+    MYSQL_CPPCONN_LIB+=-lmysqlcppconn
+  .ENDIF
+.ENDIF
+
+.IF "$(SYSTEM_MYSQL_CPPCONN)" != "YES"
+  MYSQL_INC+=-I$(SOLARINCDIR)$/mysqlcppconn -I$(SOLARINCDIR)$/mysqlcppconn/cppconn
+.ENDIF
+
+CFLAGS+=-I..$/..$/inc $(MYSQL_INC) \
+	-DMYSQLC_VERSION_MAJOR=$(MYSQLC_VERSION_MAJOR) \
+	-DMYSQLC_VERSION_MINOR=$(MYSQLC_VERSION_MINOR) \
+	-DMYSQLC_VERSION_MICRO=$(MYSQLC_VERSION_MICRO) \
+    $(MYSQL_DEFINES)
+
+# provide the name of the MySQL client lib to the C++ code
+.IF "$(SYSTEM_MYSQL)" != "YES"
+CDEFS += -DMYSQL_LIB=\"$(MYSQL_LIBFILE:f)\"
+.ENDIF
+
+#--------------------------------------------------
+
+SHL1DLLPRE=
+SHL1TARGET=$(TARGET).uno
+LIB1TARGET=$(SLB)$/$(SHL1TARGET).lib
+LIB1OBJFILES= \
+		$(SLO)$/mysqlc_driver.obj \
+		$(SLO)$/mysqlc_services.obj  \
+		$(SLO)$/mysqlc_connection.obj \
+		$(SLO)$/mysqlc_resultset.obj \
+		$(SLO)$/mysqlc_resultsetmetadata.obj \
+		$(SLO)$/mysqlc_statement.obj \
+		$(SLO)$/mysqlc_preparedstatement.obj \
+		$(SLO)$/mysqlc_databasemetadata.obj \
+		$(SLO)$/mysqlc_types.obj \
+		$(SLO)$/mysqlc_general.obj \
+		$(SLO)$/mysqlc_propertyids.obj
+
+SHL1STDLIBS= \
+		$(MYSQL_LIB)                \
+		$(MYSQL_CPPCONN_LIB)        \
+		$(CPPULIB)                  \
+		$(SALLIB)                   \
+		$(SALHELPERLIB)             \
+		$(CPPUHELPERLIB)
+
+SHL1VERSIONMAP=$(TARGET).map
+SHL1LIBS=	$(LIB1TARGET)
+SHL1DEF=	$(MISC)$/$(SHL1TARGET).def
+SHL1RPATH=OXT
+DEF1NAME=	$(SHL1TARGET)
+
+# create Extension -----------------------------
+
+# DESCRIPTION_SRC is the source file which is copied into the extension
+# It is defaulted to "description.xml", but we want to pre-process it, so we use an intermediate
+# file
+DESCRIPTION_SRC = $(MISC)$/description.xml
+
+COMPONENT_XCU=\
+        registry$/data$/org$/openoffice$/Office$/DataAccess$/Drivers.xcu
+
+COMPONENT_MERGED_XCU= \
+        $(foreach,i,$(COMPONENT_XCU) $(EXTENSIONDIR)$/$i)
+
+COMPONENT_LIBRARY = \
+            $(EXTENSIONDIR)$/$(SHL1TARGET)$(DLLPOST)
+
+COMPONENT_MYSQL_LIBFILE = \
+            $(EXTENSIONDIR)$/$(MYSQL_LIBFILE:f) 
+
+COMPONENT_MYSQL_CPPCONN_FILE=\
+            $(EXTENSIONDIR)$/$(MYSQL_CPPCONNFILE:f)
+
+COMPONENT_LIBRARIES=\
+			$(COMPONENT_LIBRARY)
+
+
+# ........ component description ........
+# one file for each WITH_LANG token
+DESC_LANGS=$(WITH_LANG)
+.IF "$(DESC_LANGS)" == ""
+    DESC_LANGS=en-US
+.ENDIF
+COMPONENT_DESCRIPTIONS=$/$(foreach,lang,$(DESC_LANGS) description$/description_$(lang).txt)
+COMPONENT_DESCRIPTIONS_PACKDEP= \
+    $(foreach,i,$(COMPONENT_DESCRIPTIONS) $(EXTENSIONDIR)$/$i)
+
+# WITH_LANG might contain languages which we actually do not have a description for (yet)
+# Find those, and treat the specially
+
+# first, find those locales which we actually have a description file for
+EXISTING_DESCRIPTIONS=$(foreach,i,$(shell $(FIND) .$/description -name "description_*.txt") $(i:f))
+EXISTING_LANGS=$(foreach,i,$(EXISTING_DESCRIPTIONS) $(i:s,description_,,:s,.txt,,))
+
+# then, create a version of WITH_LANG where we stripped all those locales
+EXISTING_LANGS_NORMALIZED=$(strip $(EXISTING_LANGS))
+EXISTING_LANGS_NORMALIZED:=+$(EXISTING_LANGS_NORMALIZED:s/ /+/)+
+MISSING_LANGS=$(foreach,lang,$(WITH_LANG) $(eq,$(EXISTING_LANGS_NORMALIZED:s/+$(lang)+//),$(EXISTING_LANGS_NORMALIZED) $(lang)  ))
+
+# ........ dependencies for packaging the extension ........
+EXTENSION_PACKDEPS=makefile.mk $(COMPONENT_DESCRIPTIONS_PACKDEP) $(COMPONENT_MERGED_XCU)
+
+.IF "$(SYSTEM_MYSQL)" != "YES"
+EXTENSION_PACKDEPS+=$(COMPONENT_MYSQL_LIBFILE)
+.ENDIF
+
+.IF "$(SYSTEM_MYSQL_CPPCONN)" != "YES"
+EXTENSION_PACKDEPS+=$(COMPONENT_MYSQL_CPPCONN_FILE)
+.ENDIF
+
+# --- Targets ------------------------------------------------------
+.INCLUDE : extension_pre.mk
+.INCLUDE : target.mk
+.INCLUDE : extension_post.mk
+
+$(EXTENSIONDIR)$/images$/%.png : $(PRJ)$/images$/%.png
+	@@-$(MKDIRHIER) $(@:d)
+    @$(COPY) $< $@ > $(NULLDEV)
+
+# existing descriptions: just copy
+$(EXTENSIONDIR)$/description$/%.txt: .$/description$/%.txt
+    @@-$(MKDIRHIER) $(@:d)
+    @$(COPY) $< $@ > $(NULLDEV)
+
+# xcu files: copy
+# the following is a hack for now - need to find out the generic mechanism later
+
+$(EXTENSIONDIR)$/registry$/data$/org$/openoffice$/Office$/DataAccess$/Drivers.xcu : .$/registry$/data$/org$/openoffice$/Office$/DataAccess$/Drivers.xcu
+    @@-$(MKDIRHIER) $(EXTENSIONDIR)$/registry$/data$/org$/openoffice$/Office$/DataAccess
+    @$(COPY) $< $(EXTENSIONDIR)$/registry$/data$/org$/openoffice$/Office$/DataAccess$/Drivers.xcu > $(NULLDEV)
+
+# The below doesn't work - it's completely beyond me .... $@ is some strange path when echoed, so the whole construct
+# doesn't work .... :(
+
+#$(foreach,i,$(COMPONENT_XCU) $(EXTENSIONDIR)$/$i : $i)
+#    @echo -----------------
+#    @echo $@
+#    @echo $<
+#    @echo -----------------
+#    -$(MKDIRHIER) $(@:d)
+#    (COPY) $< $@
+#    @echo -----------------
+
+# non-existing descriptions: copy from the English version
+.IF "$(strip $(MISSING_LANGS))" != ""
+$(foreach,i,$(MISSING_LANGS) $(EXTENSIONDIR)$/description$/description_$i.txt): .$/description$/description_en-US.txt
+    @echo ------ WARNING: .$/description$/$(@:f) not found, falling back to English description
+    @@-$(MKDIRHIER) $(@:d)
+    @$(COPY) $< $@ > $(NULLDEV)
+.ENDIF
+
+$(DESCRIPTION_SRC): description.xml
+    +-$(RM) $@
+    $(TYPE) description.xml | $(SED) "s/#VERSION#/$(EXTENSION_VERSION)/" | $(SED) "s,#TITLE#,$(EXTENSION_TITLE)," > $@
+
+.IF "$(SYSTEM_MYSQL)" != "YES" 
+# --- the MySQL client lib needs to be copied
+$(COMPONENT_MYSQL_LIBFILE): $(MYSQL_LIBFILE)
+	@@-$(MKDIRHIER) $(@:d)
+	@$(COPY) $< $@ > $(NULLDEV)
+    .IF "$(OS)" == "MACOSX"
+        install_name_tool -id @__________________________________________________OOO/$(MYSQL_LIBFILE:f) $@
+    .ENDIF
+.ENDIF
+
+.IF "$(SYSTEM_MYSQL_CPPCONN)" != "YES"
+# --- the MySQL cppconn lib needs to be copied
+$(COMPONENT_MYSQL_CPPCONN_FILE): $(MYSQL_CPPCONNFILE)
+	@@-$(MKDIRHIER) $(@:d)
+	@$(COPY) $< $@ > $(NULLDEV)
+    .IF "$(OS)" == "MACOSX"
+        install_name_tool -change $(MYSQL_LIBFILE:f) @loader_path/$(MYSQL_LIBFILE:f) $@
+    .ENDIF
+.ENDIF
+
+.IF "$(OS)" == "MACOSX"
+$(EXTENSION_TARGET): adjust_libmysql_path
+
+adjust_libmysql_path: $(EXTENSIONDIR)$/$(SHL1TARGET)$(DLLPOST)
+    install_name_tool -change $(MYSQL_LIBFILE:f) @loader_path/$(MYSQL_LIBFILE:f) $(EXTENSIONDIR)$/$(SHL1TARGET)$(DLLPOST)
+.ENDIF
Index: mysqlc/source/description/description_es.txt
===================================================================
--- mysqlc/source/description/description_es.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_es.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Conecta OpenOffice.org directamente con los servidores de MySQL
\ No newline at end of file
Index: mysqlc/source/description/description_fr.txt
===================================================================
--- mysqlc/source/description/description_fr.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_fr.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Connexion directe d'OpenOffice.org avec les serveurs MySQL.
\ No newline at end of file
Index: mysqlc/source/description/description_ko.txt
===================================================================
--- mysqlc/source/description/description_ko.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_ko.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+MySQL 서버를 통해 OpenOffice.org에 직접 연결합니다.
\ No newline at end of file
Index: mysqlc/source/description/description_nl.txt
===================================================================
--- mysqlc/source/description/description_nl.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_nl.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Verbindt OpenOffice.org direct met MySQL Servers
\ No newline at end of file
Index: mysqlc/source/description/description_zh-TW.txt
===================================================================
--- mysqlc/source/description/description_zh-TW.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_zh-TW.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+將 OpenOffice.org 直接連線至 MySQL 伺服器
\ No newline at end of file
Index: mysqlc/source/description/description_pl.txt
===================================================================
--- mysqlc/source/description/description_pl.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_pl.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Laczy witryne OpenOffice.org bezposrednio z systemem MySQL Servers
\ No newline at end of file
Index: mysqlc/source/description/description_hu.txt
===================================================================
--- mysqlc/source/description/description_hu.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_hu.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Közvetlen kapcsolatot teremt az OpenOffice.org és a MySQL-kiszolgálók között.
\ No newline at end of file
Index: mysqlc/source/description/description_it.txt
===================================================================
--- mysqlc/source/description/description_it.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_it.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Consente la connessione diretta tra OpenOffice.org e i server MySQL
\ No newline at end of file
Index: mysqlc/source/description/description_zh-CN.txt
===================================================================
--- mysqlc/source/description/description_zh-CN.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_zh-CN.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+将 OpenOffice.org 与 MySQL 服务器直接相连
\ No newline at end of file
Index: mysqlc/source/description/description_pt.txt
===================================================================
--- mysqlc/source/description/description_pt.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_pt.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Liga o OpenOffice.org directamente aos servidores MySQL
\ No newline at end of file
Index: mysqlc/source/description/description_pt-BR.txt
===================================================================
--- mysqlc/source/description/description_pt-BR.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_pt-BR.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Conecta o OpenOffice.org diretamente aos servidores MySQL
\ No newline at end of file
Index: mysqlc/source/description/description_ru.txt
===================================================================
--- mysqlc/source/description/description_ru.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_ru.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+﻿Подключает OpenOffice.org напрямую к серверам MySQL
Index: mysqlc/source/description/description_en-US.txt
===================================================================
--- mysqlc/source/description/description_en-US.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_en-US.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Connects OpenOffice.org directly with MySQL Servers
Index: mysqlc/source/description/description_de.txt
===================================================================
--- mysqlc/source/description/description_de.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_de.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Verbindet OpenOffice.org direkt mit MySQL-Servern
\ No newline at end of file
Index: mysqlc/source/description/description_sv.txt
===================================================================
--- mysqlc/source/description/description_sv.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_sv.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+Ansluter OpenOffice.org direkt till MySQL-servrarna
\ No newline at end of file
Index: mysqlc/source/description/description_ja.txt
===================================================================
--- mysqlc/source/description/description_ja.txt	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/description/description_ja.txt	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+OpenOffice.org を MySQL サーバーと直接に接続させる
\ No newline at end of file
Index: mysqlc/source/mysqlc_resultset.cxx
===================================================================
--- mysqlc/source/mysqlc_resultset.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_resultset.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,1509 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_resultset.cxx,v $
+*
+* $Revision: 1.1.2.5 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include "mysqlc_propertyids.hxx"
+#include "mysqlc_general.hxx"
+#include "mysqlc_resultset.hxx"
+#include "mysqlc_resultsetmetadata.hxx"
+
+#include <com/sun/star/sdbc/DataType.hpp>
+#include <com/sun/star/beans/PropertyAttribute.hpp>
+#include <com/sun/star/sdbcx/CompareBookmark.hpp>
+#include <cppuhelper/typeprovider.hxx>
+#include <com/sun/star/lang/DisposedException.hpp>
+
+using namespace connectivity::mysqlc;
+using namespace cppu;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+using ::osl::MutexGuard;
+using ::rtl::OUString;
+
+#include <cppconn/resultset.h>
+#include <cppconn/resultset_metadata.h>
+
+#include <stdio.h>
+
+
+//	IMPLEMENT_SERVICE_INFO(OResultSet,"com.sun.star.sdbcx.OResultSet","com.sun.star.sdbc.ResultSet");
+/* {{{ OResultSet::getImplementationName() -I- */
+OUString SAL_CALL OResultSet::getImplementationName()
+	throw (RuntimeException)
+{
+	OSL_TRACE("OResultSet::getImplementationName");
+    return ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "com.sun.star.sdbcx.mysqlc.ResultSet" ) );
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getSupportedServiceNames() -I- */
+Sequence< OUString > SAL_CALL OResultSet::getSupportedServiceNames()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OResultSet::getSupportedServiceNames");
+	Sequence< OUString > aSupported(2);
+	aSupported[0] = OUString( RTL_CONSTASCII_USTRINGPARAM( "com.sun.star.sdbc.ResultSet" ) );
+	aSupported[1] = OUString( RTL_CONSTASCII_USTRINGPARAM( "com.sun.star.sdbcx.ResultSet" ) );
+	return (aSupported);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::supportsService() -I- */
+sal_Bool SAL_CALL OResultSet::supportsService(const OUString& _rServiceName)
+	throw(RuntimeException)
+{
+	OSL_TRACE("OResultSet::supportsService");
+	Sequence< OUString > aSupported(getSupportedServiceNames());
+	const OUString* pSupported = aSupported.getConstArray();
+	const OUString* pEnd = pSupported + aSupported.getLength();
+	for (;pSupported != pEnd && !pSupported->equals(_rServiceName); ++pSupported) {}
+
+	return (pSupported != pEnd);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::OResultSet() -I- */
+OResultSet::OResultSet(OCommonStatement * pStmt, sql::ResultSet * result, rtl_TextEncoding _encoding ) 
+	: OResultSet_BASE(m_aMutex)
+	,OPropertySetHelper(OResultSet_BASE::rBHelper)
+	,m_aStatement((OWeakObject*)pStmt)
+	,m_xMetaData(NULL)
+	,m_result(result)
+    ,fieldCount( 0 )
+    ,m_encoding( _encoding )
+{
+	OSL_TRACE("OResultSet::OResultSet");
+	try {
+		sql::ResultSetMetaData * rs_meta = m_result->getMetaData();
+		fieldCount = rs_meta->getColumnCount();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::~OResultSet() -I- */
+OResultSet::~OResultSet()
+{
+	OSL_TRACE("OResultSet::~OResultSet");
+}
+/* }}} */
+
+
+/* {{{ OResultSet::disposing() -I- */
+void OResultSet::disposing()
+{
+	OSL_TRACE("OResultSet::disposing");
+	OPropertySetHelper::disposing();
+
+	MutexGuard aGuard(m_aMutex);
+
+	m_aStatement = NULL;
+	m_xMetaData  = NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::queryInterface() -I- */
+Any SAL_CALL OResultSet::queryInterface(const Type & rType)
+	throw(RuntimeException)
+{
+	OSL_TRACE("OResultSet::queryInterface");
+	Any aRet = OPropertySetHelper::queryInterface(rType);
+	if (!aRet.hasValue()) {
+		aRet = OResultSet_BASE::queryInterface(rType);
+	}
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getTypes() -I- */
+Sequence< Type > SAL_CALL OResultSet::getTypes()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OResultSet::getTypes");
+	OTypeCollection aTypes(	::getCppuType((const  Reference< XMultiPropertySet > *) NULL),
+												::getCppuType((const Reference< XFastPropertySet > *) NULL),
+												::getCppuType((const Reference< XPropertySet > *) NULL));
+
+	return concatSequences(aTypes.getTypes(), OResultSet_BASE::getTypes());
+}
+/* }}} */
+
+
+/* {{{ OResultSet::findColumn() -I- */
+sal_Int32 SAL_CALL OResultSet::findColumn(const OUString& columnName)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::findColumn");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		// find the first column with the name columnName
+		sql::ResultSetMetaData * meta = m_result->getMetaData();
+		for (sal_uInt32 i = 1; i <= fieldCount; i++) {
+			if (columnName.equalsIgnoreAsciiCaseAscii(meta->getColumnName(i).c_str())) {
+				/* SDBC knows them indexed from 1 */
+				return i;
+			}
+		}
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getBinaryStream() -U- */
+Reference< XInputStream > SAL_CALL OResultSet::getBinaryStream(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getBinaryStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getBinaryStream", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getCharacterStream() -U- */
+Reference< XInputStream > SAL_CALL OResultSet::getCharacterStream(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getCharacterStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getCharacterStream", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getBoolean() -I- */
+sal_Bool SAL_CALL OResultSet::getBoolean(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getBoolean");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getBoolean(column)? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False;
+#if 0
+	OUString str = getString(column);
+	switch (str[0]) {
+		case '1':
+		case 't':
+		case 'T':
+		case 'y':
+		case 'Y':
+			return sal_True;
+	}
+	return sal_False;
+#endif
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getByte() -I- */
+sal_Int8 SAL_CALL OResultSet::getByte(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getByte");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getInt(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getBytes() -I- */
+Sequence< sal_Int8 > SAL_CALL OResultSet::getBytes(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getBytes");
+	
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+
+
+	sql::SQLString val = m_result->getString(column);
+	if (!val.length()) {
+		return Sequence< sal_Int8>();
+	} else {
+		return Sequence< sal_Int8 > ((sal_Int8*)val.c_str(), val.length());
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getDate() -I- */
+Date SAL_CALL OResultSet::getDate(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getDate");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	Date d;
+	try {
+		OUString dateString = getString(column);
+		OUString token;
+		sal_Int32 nIndex = 0, i=0;
+
+		do {
+			token = dateString.getToken (0, '-', nIndex);
+			switch (i) {
+				case 0:
+					d.Year =  static_cast<sal_uInt16>(token.toInt32(10));
+					break;
+				case 1:
+					d.Month =  static_cast<sal_uInt16>(token.toInt32(10));
+					break;
+				case 2:
+					d.Day =  static_cast<sal_uInt16>(token.toInt32(10));
+					break;
+				default:;
+			}
+			i++;
+		} while (nIndex >= 0);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return d;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getDouble() -I- */
+double SAL_CALL OResultSet::getDouble(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getDouble");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getDouble(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0.0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getFloat() -I- */
+float SAL_CALL OResultSet::getFloat(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getFloat");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getDouble(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0.0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getInt() -I- */
+sal_Int32 SAL_CALL OResultSet::getInt(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getInt");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getInt(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getRow() -I- */
+sal_Int32 SAL_CALL OResultSet::getRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->getRow();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getLong() -I- */
+sal_Int64 SAL_CALL OResultSet::getLong(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getLong");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+	try {
+		return m_result->getInt64(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getMetaData() -I- */
+Reference< XResultSetMetaData > SAL_CALL OResultSet::getMetaData()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getMetaData");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	try {
+		if (!m_xMetaData.is()) {
+			m_xMetaData = new OResultSetMetaData(m_result->getMetaData(), m_encoding);
+		}
+	} catch (sql::MethodNotImplementedException) {
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getMetaData", *this);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return m_xMetaData;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getArray() -U- */
+Reference< XArray > SAL_CALL OResultSet::getArray(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getArray");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getArray", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getClob() -U- */
+Reference< XClob > SAL_CALL OResultSet::getClob(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getClob");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getClob", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getBlob() -U- */
+Reference< XBlob > SAL_CALL OResultSet::getBlob(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getBlob");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getBlob", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getRef() -U- */
+Reference< XRef > SAL_CALL OResultSet::getRef(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getRef");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getRef", *this);
+	return NULL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getObject() -U- */
+Any SAL_CALL OResultSet::getObject(sal_Int32 column, const Reference< XNameAccess >& /* typeMap */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getObject");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+
+	Any aRet= Any();
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getObject", *this);
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getShort() -I- */
+sal_Int16 SAL_CALL OResultSet::getShort(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getShort");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return (sal_Int16) m_result->getInt(column);
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return 0; // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getString() -I- */
+OUString SAL_CALL OResultSet::getString(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getString");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	checkColumnIndex(column);
+
+	try {
+		sql::SQLString val = m_result->getString(column);
+		if (!m_result->wasNull()) {
+			return OUString( val.c_str(), val.length(), m_encoding );
+		} else {
+			return OUString();
+		}
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return OUString(); // fool compiler
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getTime() -I- */
+Time SAL_CALL OResultSet::getTime(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getTime");
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+
+	checkColumnIndex(column);
+	Time t;
+	OUString timeString = getString(column);
+	OUString token;
+	sal_Int32 nIndex, i=0;
+
+	nIndex = timeString.indexOf(' ') + 1;
+
+	do {
+		token = timeString.getToken (0, ':', nIndex);
+		switch (i) {
+			case 0:
+				t.Hours =  static_cast<sal_uInt16>(token.toInt32(10));
+				break;
+			case 1:
+				t.Minutes =  static_cast<sal_uInt16>(token.toInt32(10));
+				break;
+			case 2:
+				t.Seconds =  static_cast<sal_uInt16>(token.toInt32(10));
+				break;
+		}
+		i++;
+	} while (nIndex >= 0);
+
+	return t;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getTimestamp() -I- */
+DateTime SAL_CALL OResultSet::getTimestamp(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getTimestamp");
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+
+	checkColumnIndex(column);
+	DateTime dt;
+	Date d = getDate(column);
+	Time t = getTime(column);
+
+	dt.Year = d.Year;
+	dt.Month = d.Month;
+	dt.Day = d.Day;
+	dt.Hours = t.Hours;
+	dt.Minutes = t.Minutes;
+	dt.Seconds = t.Seconds;
+	return dt;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::isBeforeFirst() -I- */
+sal_Bool SAL_CALL OResultSet::isBeforeFirst()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::isBeforeFirst");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->isBeforeFirst()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::isAfterLast() -I- */
+sal_Bool SAL_CALL OResultSet::isAfterLast()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::isAfterLast");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->isAfterLast()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::isFirst() -I- */
+sal_Bool SAL_CALL OResultSet::isFirst()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::isFirst");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->isFirst();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::isLast() -I- */
+sal_Bool SAL_CALL OResultSet::isLast()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::isLast");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->isLast()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::beforeFirst() -I- */
+void SAL_CALL OResultSet::beforeFirst()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::beforeFirst");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		m_result->beforeFirst();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::afterLast() -I- */
+void SAL_CALL OResultSet::afterLast()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::afterLast");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		m_result->afterLast();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::close() -I- */
+void SAL_CALL OResultSet::close() throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::close");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		m_result->close();
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+
+	dispose();
+}
+/* }}} */
+
+
+/* {{{ OResultSet::first() -I- */
+sal_Bool SAL_CALL OResultSet::first() throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::first");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->first()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::last() -I- */
+sal_Bool SAL_CALL OResultSet::last()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::last");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->last()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::absolute() -I- */
+sal_Bool SAL_CALL OResultSet::absolute(sal_Int32 row)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::absolute");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->absolute(row)? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::relative() -I- */
+sal_Bool SAL_CALL OResultSet::relative(sal_Int32 row)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::relative");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->relative(row)? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::previous() -I- */
+sal_Bool SAL_CALL OResultSet::previous()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::previous");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->previous()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getStatement() -I- */
+Reference< XInterface > SAL_CALL OResultSet::getStatement()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getStatement");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return m_aStatement.get();
+}
+/* }}} */
+
+
+/* {{{ OResultSet::rowDeleted() -I- */
+sal_Bool SAL_CALL OResultSet::rowDeleted()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::rowDeleted");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::rowInserted() -I- */
+sal_Bool SAL_CALL OResultSet::rowInserted()
+	throw(SQLException, RuntimeException)
+{	
+	OSL_TRACE("OResultSet::rowInserted");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::rowUpdated() -I- */
+sal_Bool SAL_CALL OResultSet::rowUpdated()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::rowUpdated");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::next() -I- */
+sal_Bool SAL_CALL OResultSet::next()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::next");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->next()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::wasNull() -I- */
+sal_Bool SAL_CALL OResultSet::wasNull()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::wasNull");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	try {
+		return m_result->wasNull()? sal_True:sal_False;
+	} catch (sql::SQLException &e) {
+        mysqlc_sdbc_driver::translateAndThrow(e, *this, m_encoding);
+	}
+	return sal_False; //fool
+}
+/* }}} */
+
+
+/* {{{ OResultSet::cancel() -I- */
+void SAL_CALL OResultSet::cancel()
+	throw(RuntimeException)
+{
+	OSL_TRACE("OResultSet::cancel");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::clearWarnings() -I- */
+void SAL_CALL OResultSet::clearWarnings()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::clearWarnings");
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getWarnings() -I- */
+Any SAL_CALL OResultSet::getWarnings()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getWarnings");
+	Any aRet= Any();
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::insertRow() -I- */
+void SAL_CALL OResultSet::insertRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::insertRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	// you only have to implement this if you want to insert new rows
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateRow() -I- */
+void SAL_CALL OResultSet::updateRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	// only when you allow updates
+}
+/* }}} */
+
+
+/* {{{ OResultSet::deleteRow() -I- */
+void SAL_CALL OResultSet::deleteRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::deleteRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::cancelRowUpdates() -I- */
+void SAL_CALL OResultSet::cancelRowUpdates()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::cancelRowUpdates");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::moveToInsertRow() -I- */
+void SAL_CALL OResultSet::moveToInsertRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::moveToInsertRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	// only when you allow insert's
+}
+/* }}} */
+
+
+/* {{{ OResultSet::moveToCurrentRow() -I- */
+void SAL_CALL OResultSet::moveToCurrentRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::moveToCurrentRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateNull() -U- */
+void SAL_CALL OResultSet::updateNull(sal_Int32 column)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateNull");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateNull", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateBoolean() -U- */
+void SAL_CALL OResultSet::updateBoolean(sal_Int32 column, sal_Bool /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateBoolean");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateBoolean", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateByte() -U- */
+void SAL_CALL OResultSet::updateByte(sal_Int32 column, sal_Int8 /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateByte");
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateByte", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateShort() -U- */
+void SAL_CALL OResultSet::updateShort(sal_Int32 column, sal_Int16 /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateShort");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateShort", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateInt() -U- */
+void SAL_CALL OResultSet::updateInt(sal_Int32 column, sal_Int32 /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateInt");
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	MutexGuard aGuard(m_aMutex);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateInt", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateLong() -U- */
+void SAL_CALL OResultSet::updateLong(sal_Int32 column, sal_Int64 /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateLong");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateLong", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateFloat() -U- */
+void SAL_CALL OResultSet::updateFloat(sal_Int32 column, float /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateFloat");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateFloat", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateDouble() -U- */
+void SAL_CALL OResultSet::updateDouble(sal_Int32 column, double /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateDouble");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateDouble", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateString() -U- */
+void SAL_CALL OResultSet::updateString(sal_Int32 column, const OUString& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateString");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateString", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateBytes() -U- */
+void SAL_CALL OResultSet::updateBytes(sal_Int32 column, const Sequence< sal_Int8 >& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateBytes");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateBytes", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateDate() -U- */
+void SAL_CALL OResultSet::updateDate(sal_Int32 column, const Date& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateDate");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateDate", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateTime() -U- */
+void SAL_CALL OResultSet::updateTime(sal_Int32 column, const Time& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateTime");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateTime", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateTimestamp() -U- */
+void SAL_CALL OResultSet::updateTimestamp(sal_Int32 column, const DateTime& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateTimestamp");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateTimestamp", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateBinaryStream() -U- */
+void SAL_CALL OResultSet::updateBinaryStream(sal_Int32 column, const Reference< XInputStream >& /* x */,
+											sal_Int32 /* length */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateBinaryStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateBinaryStream", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateCharacterStream() -U- */
+void SAL_CALL OResultSet::updateCharacterStream(sal_Int32 column, const Reference< XInputStream >& /* x */,
+												sal_Int32 /* length */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateCharacterStream");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateCharacterStream", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::refreshRow() -U- */
+void SAL_CALL OResultSet::refreshRow()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::refreshRow");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::refreshRow", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateObject() -U- */
+void SAL_CALL OResultSet::updateObject(sal_Int32 column, const Any& /* x */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateObject");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateObject", *this);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::updateNumericObject() -U- */
+void SAL_CALL OResultSet::updateNumericObject(sal_Int32 column, const Any& /* x */, sal_Int32 /* scale */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::updateNumericObject");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	checkColumnIndex(column);
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::updateNumericObject", *this);
+}
+/* }}} */
+
+
+// XRowLocate
+/* {{{ OResultSet::getBookmark() -U- */
+Any SAL_CALL OResultSet::getBookmark()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::getBookmark");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	Any aRet = Any();
+
+	// if you don't want to support bookmark you must remove the XRowLocate interface
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::getBookmark", *this);
+
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::moveToBookmark() -U- */
+sal_Bool SAL_CALL OResultSet::moveToBookmark(const Any& /* bookmark */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::moveToBookmark");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::moveRelativeToBookmark() -U- */
+sal_Bool SAL_CALL OResultSet::moveRelativeToBookmark(const Any& /* bookmark */, sal_Int32 /* rows */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::moveRelativeToBookmark");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::moveRelativeToBookmark", *this);
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::compareBookmarks() -I- */
+sal_Int32 SAL_CALL OResultSet::compareBookmarks(const Any& /* n1 */, const Any& /* n2 */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::compareBookmarks");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::compareBookmarks", *this);
+
+	return CompareBookmark::NOT_EQUAL;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::hasOrderedBookmarks() -I- */
+sal_Bool SAL_CALL OResultSet::hasOrderedBookmarks()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::hasOrderedBookmarks");
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::hashBookmark() -U- */
+sal_Int32 SAL_CALL OResultSet::hashBookmark(const Any& /* bookmark */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::hashBookmark");
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::hashBookmark", *this);
+	return 0;
+}
+/* }}} */
+
+
+// XDeleteRows
+/* {{{ OResultSet::deleteRows() -U- */
+Sequence< sal_Int32 > SAL_CALL OResultSet::deleteRows(const Sequence< Any >& /* rows */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::deleteRows");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OResultSet_BASE::rBHelper.bDisposed);
+	Sequence< sal_Int32 > aRet = Sequence< sal_Int32 >();
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OResultSet::deleteRows", *this);
+	return aRet;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::createArrayHelper() -I- */
+IPropertyArrayHelper * OResultSet::createArrayHelper() const
+{
+	OSL_TRACE("OResultSet::createArrayHelper");
+	Sequence< Property > aProps(5);
+	Property* pProperties = aProps.getArray();
+	sal_Int32 nPos = 0;
+	DECL_PROP0(FETCHDIRECTION,			sal_Int32);
+	DECL_PROP0(FETCHSIZE,				sal_Int32);
+	DECL_BOOL_PROP1IMPL(ISBOOKMARKABLE) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETCONCURRENCY,sal_Int32) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETTYPE,		sal_Int32) PropertyAttribute::READONLY);
+
+	return new OPropertyArrayHelper(aProps);
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getInfoHelper() -I- */
+IPropertyArrayHelper & OResultSet::getInfoHelper()
+{
+	OSL_TRACE("OResultSet::getInfoHelper");
+	return (*const_cast<OResultSet*>(this)->getArrayHelper());
+}
+/* }}} */
+
+
+/* {{{ OResultSet::convertFastPropertyValue() -I- */
+sal_Bool OResultSet::convertFastPropertyValue(Any & /* rConvertedValue */,
+											Any & /* rOldValue */,
+											sal_Int32 nHandle,
+											const Any& /* rValue */)
+	throw (::com::sun::star::lang::IllegalArgumentException)
+{
+	OSL_TRACE("OResultSet::convertFastPropertyValue");
+	switch (nHandle) {
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw ::com::sun::star::lang::IllegalArgumentException();
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		default:
+			;
+	}
+	return sal_False;
+}
+/* }}} */
+
+
+/* {{{ OResultSet::setFastPropertyValue_NoBroadcast() -I- */
+void OResultSet::setFastPropertyValue_NoBroadcast(sal_Int32 nHandle, const Any& /* rValue */)
+	throw (Exception)
+{
+	OSL_TRACE("OResultSet::setFastPropertyValue_NoBroadcast");
+	switch (nHandle) {
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw Exception();
+		case PROPERTY_ID_FETCHDIRECTION:
+			break;
+		case PROPERTY_ID_FETCHSIZE:
+			break;
+		default:
+			;
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getFastPropertyValue() -I- */
+void OResultSet::getFastPropertyValue(Any& _rValue, sal_Int32 nHandle) const
+{
+	OSL_TRACE("OResultSet::getFastPropertyValue");
+	switch (nHandle) {
+		case PROPERTY_ID_ISBOOKMARKABLE:
+            _rValue <<= sal_False;
+            break;
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+			;
+		default:
+			;
+	}
+}
+/* }}} */
+
+
+/* {{{ OResultSet::acquire() -I- */
+void SAL_CALL OResultSet::acquire()
+	throw()
+{
+	OSL_TRACE("OResultSet::acquire");
+	OResultSet_BASE::acquire();
+}
+/* }}} */
+
+
+/* {{{ OResultSet::release() -I- */
+void SAL_CALL OResultSet::release()
+	throw()
+{
+	OSL_TRACE("OResultSet::release");
+	OResultSet_BASE::release();
+}
+/* }}} */
+
+
+/* {{{ OResultSet::getPropertySetInfo() -I- */
+::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL OResultSet::getPropertySetInfo() throw(::com::sun::star::uno::RuntimeException)
+{
+	OSL_TRACE("OResultSet::getPropertySetInfo");
+	return (::cppu::OPropertySetHelper::createPropertySetInfo(getInfoHelper()));
+}
+/* }}} */
+
+
+/* {{{ OResultSet::checkColumnIndex() -I- */
+void OResultSet::checkColumnIndex(sal_Int32 index)
+	throw (SQLException, RuntimeException)
+{
+	OSL_TRACE("OResultSet::checkColumnIndex");
+	if ((index < 1 || index > (int) fieldCount)) {
+		/* static object for efficiency or thread safety is a problem ? */
+		OUString buf( RTL_CONSTASCII_USTRINGPARAM( "index out of range" ) );
+		throw SQLException(buf, *this, OUString(), 1, Any());
+	}
+}
+/* }}} */
+
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_driver.cxx
===================================================================
--- mysqlc/source/mysqlc_driver.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_driver.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,368 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_driver.cxx,v $
+*
+* $Revision: 1.1.2.5 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+#include "mysqlc_driver.hxx"
+#include "mysqlc_connection.hxx"
+#include "mysqlc_general.hxx"
+
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace connectivity::mysqlc;
+using ::rtl::OUString;
+#include <stdio.h>
+
+#include <cppconn/exception.h>
+
+#ifdef SYSTEM_MYSQL_CPPCONN
+    #include <mysql_driver.h>
+#endif
+
+
+/* {{{ MysqlCDriver::MysqlCDriver() -I- */
+MysqlCDriver::MysqlCDriver(const Reference< XMultiServiceFactory >& _rxFactory)
+	: ODriver_BASE(m_aMutex)
+    ,m_xFactory(_rxFactory)
+#ifndef SYSTEM_MYSQL_CPPCONN
+    ,m_hCppConnModule( NULL )
+    ,m_bAttemptedLoadCppConn( false )
+#endif
+{
+	OSL_TRACE("MysqlCDriver::MysqlCDriver");
+	cppDriver = NULL;
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::disposing() -I- */
+void MysqlCDriver::disposing()
+{
+	OSL_TRACE("MysqlCDriver::disposing");
+	::osl::MutexGuard aGuard(m_aMutex);
+	
+	// when driver will be destroied so all our connections have to be destroied as well
+	for (OWeakRefArray::iterator i = m_xConnections.begin(); m_xConnections.end() != i; ++i)
+	{
+		Reference< XComponent > xComp(i->get(), UNO_QUERY);
+		if (xComp.is()) {
+			xComp->dispose();
+		}
+	}
+	m_xConnections.clear();
+
+	ODriver_BASE::disposing();
+}
+/* }}} */
+
+
+// static ServiceInfo
+/* {{{ MysqlCDriver::getImplementationName_Static() -I- */
+OUString MysqlCDriver::getImplementationName_Static()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getImplementationName_Static");
+    return ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "com.sun.star.comp.sdbc.mysqlc.MysqlCDriver" ) );
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getSupportedServiceNames_Static() -I- */
+Sequence< OUString > MysqlCDriver::getSupportedServiceNames_Static()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getSupportedServiceNames_Static");
+	// which service is supported 
+	// for more information @see com.sun.star.sdbc.Driver
+	Sequence< OUString > aSNS(1);
+	aSNS[0] = OUString::createFromAscii("com.sun.star.sdbc.Driver");
+	return aSNS;
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getImplementationName() -I- */
+OUString SAL_CALL MysqlCDriver::getImplementationName()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getImplementationName");
+	return getImplementationName_Static();
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::supportsService() -I- */
+sal_Bool SAL_CALL MysqlCDriver::supportsService(const OUString& _rServiceName)
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::supportsService");
+	Sequence< OUString > aSupported(getSupportedServiceNames());
+	const OUString* pSupported = aSupported.getConstArray();
+	const OUString* pEnd = pSupported + aSupported.getLength();
+	for (;pSupported != pEnd && !pSupported->equals(_rServiceName); ++pSupported){}
+
+	return (pSupported != pEnd);
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getSupportedServiceNames() -I- */
+Sequence< OUString > SAL_CALL MysqlCDriver::getSupportedServiceNames()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getSupportedServiceNames");
+	return getSupportedServiceNames_Static();
+}
+/* }}} */
+
+
+extern "C" { static void SAL_CALL thisModule() {} }
+
+void MysqlCDriver::impl_initCppConn_lck_throw()
+{
+#ifdef SYSTEM_MYSQL_CPPCONN
+    cppDriver = get_driver_instance();
+#else
+    if ( !m_bAttemptedLoadCppConn )
+    {
+        const ::rtl::OUString sModuleName = ::rtl::OUString::createFromAscii( CPPCONN_LIB );
+        m_hCppConnModule = osl_loadModuleRelative( &thisModule, sModuleName.pData, 0 );
+        m_bAttemptedLoadCppConn = true;
+    }
+
+    // attempted to load - was it successful?
+    if ( !m_hCppConnModule )
+    {
+        OSL_ENSURE( false, "MysqlCDriver::impl_initCppConn_lck_throw: could not load the " CPPCONN_LIB " library!");
+        throw SQLException(
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "Unable to load the " CPPCONN_LIB " library." ) ),
+            *this,
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "08001" ) ),  // "unable to connect"
+            0,
+            Any()
+        );
+    }
+
+    // find the factory symbol
+    const ::rtl::OUString sSymbolName = ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "sql_mysql_get_driver_instance" ) );
+	typedef void* (* FGetMySQLDriver)();
+
+    const FGetMySQLDriver pFactoryFunction = (FGetMySQLDriver)( osl_getFunctionSymbol( m_hCppConnModule, sSymbolName.pData ) );
+    if ( !pFactoryFunction )
+    {
+        OSL_ENSURE( false, "MysqlCDriver::impl_initCppConn_lck_throw: could not find the factory symbol in " CPPCONN_LIB "!");
+        throw SQLException(
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( CPPCONN_LIB " is invalid: missing the driver factory function." ) ),
+            *this,
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "08001" ) ),  // "unable to connect"
+            0,
+            Any()
+        );
+    }
+
+    cppDriver = static_cast< sql::Driver* >( (*pFactoryFunction)() );
+#endif
+    if ( !cppDriver )
+    {
+        throw SQLException(
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "Unable to obtain the MySQL_Driver instance from Connector/C++." ) ),
+            *this,
+            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "08001" ) ),  // "unable to connect"
+            0,
+            Any()
+        );
+    }
+}
+
+/* {{{ MysqlCDriver::connect() -I- */
+Reference< XConnection > SAL_CALL MysqlCDriver::connect(const OUString& url, const Sequence< PropertyValue >& info)
+	throw(SQLException, RuntimeException)
+{
+    ::osl::MutexGuard aGuard( m_aMutex );
+
+	OSL_TRACE("MysqlCDriver::connect");
+	if (!acceptsURL(url)) {
+		return NULL;
+	}
+
+    if ( !cppDriver )
+    {
+        impl_initCppConn_lck_throw();
+        OSL_POSTCOND( cppDriver, "MySQLCDriver::connect: internal error." );
+        if ( !cppDriver )
+            throw RuntimeException( ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "MySQLCDriver::connect: internal error." ) ), *this );
+    }
+
+    Reference< XConnection > xConn;
+	// create a new connection with the given properties and append it to our vector
+	try {
+		OConnection* pCon = new OConnection(*this, cppDriver);
+		xConn = pCon;
+
+        pCon->construct(url,info);
+        m_xConnections.push_back(WeakReferenceHelper(*pCon));
+	}
+    catch (sql::SQLException &e)
+    {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getDefaultEncoding());	
+	}
+    return xConn;
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::acceptsURL() -I- */
+sal_Bool SAL_CALL MysqlCDriver::acceptsURL(const OUString& url)
+		throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::acceptsURL");
+	return (!url.compareTo(OUString::createFromAscii("sdbc:mysqlc:"), sizeof("sdbc:mysqlc:")-1));
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getPropertyInfo() -I- */
+Sequence< DriverPropertyInfo > SAL_CALL MysqlCDriver::getPropertyInfo(const OUString& url, const Sequence< PropertyValue >& /* info */)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getPropertyInfo");
+	if (acceptsURL(url)) {
+		::std::vector< DriverPropertyInfo > aDriverInfo;
+
+		aDriverInfo.push_back(DriverPropertyInfo(
+				OUString(RTL_CONSTASCII_USTRINGPARAM("Hostname"))
+				,OUString(RTL_CONSTASCII_USTRINGPARAM("Name of host"))
+				,sal_True
+				,OUString::createFromAscii("localhost")
+				,Sequence< OUString >())
+			);
+		aDriverInfo.push_back(DriverPropertyInfo(
+				OUString(RTL_CONSTASCII_USTRINGPARAM("Port"))
+				,OUString(RTL_CONSTASCII_USTRINGPARAM("Port"))
+				,sal_True
+				,OUString::createFromAscii("3306")
+				,Sequence< OUString >())
+			);
+		return Sequence< DriverPropertyInfo >(&(aDriverInfo[0]),aDriverInfo.size());
+	}
+
+	return Sequence< DriverPropertyInfo >();
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getMajorVersion() -I- */
+sal_Int32 SAL_CALL MysqlCDriver::getMajorVersion()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getMajorVersion");
+	return MYSQLC_VERSION_MAJOR;
+}
+/* }}} */
+
+
+/* {{{ MysqlCDriver::getMinorVersion() -I- */
+sal_Int32 SAL_CALL MysqlCDriver::getMinorVersion()
+	throw(RuntimeException)
+{
+	OSL_TRACE("MysqlCDriver::getMinorVersion");
+	return MYSQLC_VERSION_MINOR;
+}
+/* }}} */
+
+
+namespace connectivity
+{
+namespace mysqlc
+{
+
+Reference< XInterface >  SAL_CALL MysqlCDriver_CreateInstance(const Reference< XMultiServiceFactory >& _rxFactory)
+	throw(::com::sun::star::uno::Exception)
+{
+	return(*(new MysqlCDriver(_rxFactory)));
+}
+
+/* {{{ connectivity::mysqlc::release() -I- */
+void release(oslInterlockedCount& _refCount,
+			 ::cppu::OBroadcastHelper& rBHelper,
+			 Reference< XInterface >& _xInterface, 
+			 ::com::sun::star::lang::XComponent* _pObject)
+{
+	if (osl_decrementInterlockedCount(&_refCount) == 0) {
+		osl_incrementInterlockedCount(&_refCount);
+
+		if (!rBHelper.bDisposed && !rBHelper.bInDispose) {
+			// remember the parent
+			Reference< XInterface > xParent;
+			{
+				::osl::MutexGuard aGuard(rBHelper.rMutex);
+				xParent = _xInterface;
+				_xInterface = NULL;
+			}
+
+			// First dispose
+			_pObject->dispose();
+
+			// only the alive ref holds the object
+			OSL_ASSERT(_refCount == 1);
+
+			// release the parent in the destructor
+			if (xParent.is()) {
+				::osl::MutexGuard aGuard(rBHelper.rMutex);
+				_xInterface = xParent;
+			}
+		}
+	} else {
+		osl_incrementInterlockedCount(&_refCount);
+	}
+}
+/* }}} */
+
+
+
+/* {{{ connectivity::mysqlc::checkDisposed() -I- */
+void checkDisposed(sal_Bool _bThrow)
+	throw (DisposedException)
+{
+	if (_bThrow) {
+		throw DisposedException();
+	}
+}
+/* }}} */
+
+} /* mysqlc */
+} /* connectivity */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc.map
===================================================================
--- mysqlc/source/mysqlc.map	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc.map	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,8 @@
+UDK_3_0_0 {
+	global:
+		component_getImplementationEnvironment;
+		component_writeInfo;
+		component_getFactory;
+	local:
+		*;
+};
Index: mysqlc/source/mysqlc_preparedstatement.hxx
===================================================================
--- mysqlc/source/mysqlc_preparedstatement.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_preparedstatement.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,194 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_preparedstatement.hxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef CONNECTIVITY_SPREPAREDSTATEMENT_HXX
+#define CONNECTIVITY_SPREPAREDSTATEMENT_HXX
+#include "mysqlc_statement.hxx"
+#include "mysqlc_resultset.hxx"
+
+#ifndef _COM_SUN_STAR_SDBC_XPREPAREDSTATEMENT_HPP_
+#include <com/sun/star/sdbc/XPreparedStatement.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XPARAMETERS_HPP_
+#include <com/sun/star/sdbc/XParameters.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XRESULTSETMETADATASUPPLIER_HPP_
+#include <com/sun/star/sdbc/XResultSetMetaDataSupplier.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XPREPAREDBATCHEXECUTION_HPP_
+#include <com/sun/star/sdbc/XPreparedBatchExecution.hpp>
+#endif
+#ifndef _COM_SUN_STAR_IO_XINPUTSTREAM_HPP_
+#include <com/sun/star/io/XInputStream.hpp>
+#endif
+
+#include <cppconn/prepared_statement.h>
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		using ::com::sun::star::uno::Reference;
+		using ::com::sun::star::uno::Any;
+		using ::com::sun::star::uno::Type;
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::RuntimeException;
+		using ::com::sun::star::sdbc::XResultSetMetaData;
+
+		class OBoundParam;
+		typedef ::cppu::ImplHelper5<	::com::sun::star::sdbc::XPreparedStatement,
+										::com::sun::star::sdbc::XParameters,
+										::com::sun::star::sdbc::XPreparedBatchExecution,
+										::com::sun::star::sdbc::XResultSetMetaDataSupplier,
+										::com::sun::star::lang::XServiceInfo> OPreparedStatement_BASE;
+
+		class OPreparedStatement :	public OCommonStatement,
+									public OPreparedStatement_BASE
+		{
+		protected:
+			unsigned int		m_paramCount;	// number of placeholders
+			sal_Int32			m_nNumParams;	// Number of parameter markers for the prepared statement
+			Reference< XResultSetMetaData > m_xMetaData;
+
+			void checkParameterIndex(sal_Int32 parameter);
+
+		protected:
+			void SAL_CALL setFastPropertyValue_NoBroadcast(sal_Int32 nHandle, const Any& rValue)
+																					throw (::com::sun::star::uno::Exception);
+			virtual ~OPreparedStatement();
+		public:
+			DECLARE_SERVICE_INFO();
+			OPreparedStatement(OConnection* _pConnection, sql::PreparedStatement * cppPrepStmt);
+
+			//XInterface
+			Any SAL_CALL queryInterface(const Type & rType)	throw(RuntimeException);
+			void SAL_CALL acquire() throw();
+			void SAL_CALL release() throw();
+
+			//XTypeProvider
+			::com::sun::star::uno::Sequence< Type > SAL_CALL getTypes()
+																					throw(RuntimeException);
+
+			// XPreparedStatement
+			Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL executeQuery()	throw(SQLException, RuntimeException);
+			sal_Int32 SAL_CALL executeUpdate() throw(SQLException, RuntimeException);
+			sal_Bool SAL_CALL execute() throw(SQLException, RuntimeException);
+			Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection() throw(SQLException, RuntimeException);
+
+            // XStatement
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL executeQuery(const OUString& sql)
+												throw(SQLException, RuntimeException);
+			sal_Int32 SAL_CALL executeUpdate(const OUString& sql)
+												throw(SQLException, RuntimeException);
+			sal_Bool SAL_CALL execute( const OUString& sql )
+												throw(SQLException, RuntimeException);
+
+			// XParameters
+			void SAL_CALL setNull(sal_Int32 parameter, sal_Int32 sqlType)			throw(SQLException, RuntimeException);
+
+			void SAL_CALL setObjectNull(sal_Int32 parameter, sal_Int32 sqlType, const OUString& typeName)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setBoolean(sal_Int32 parameter, sal_Bool x)				throw(SQLException, RuntimeException);
+
+			void SAL_CALL setByte(sal_Int32 parameter, sal_Int8 x)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setShort(sal_Int32 parameter, sal_Int16 x)				throw(SQLException, RuntimeException);
+
+			void SAL_CALL setInt(sal_Int32 parameter, sal_Int32 x)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setLong(sal_Int32 parameter, sal_Int64 x)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setFloat(sal_Int32 parameter, float x)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setDouble(sal_Int32 parameter, double x)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setString(sal_Int32 parameter, const OUString& x)			throw(SQLException, RuntimeException);
+
+			void SAL_CALL setBytes(sal_Int32 parameter, const ::com::sun::star::uno::Sequence< sal_Int8 >& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setDate(sal_Int32 parameter, const ::com::sun::star::util::Date& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setTime(sal_Int32 parameter, const ::com::sun::star::util::Time& x)
+																					throw(SQLException, RuntimeException);
+			void SAL_CALL setTimestamp(sal_Int32 parameter, const ::com::sun::star::util::DateTime& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setBinaryStream(sal_Int32 parameter, const Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setCharacterStream(sal_Int32 parameter, const Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setObject(sal_Int32 parameter, const Any& x)				throw(SQLException, RuntimeException);
+
+			void SAL_CALL setObjectWithInfo(sal_Int32 parameter, const Any& x, sal_Int32 targetSqlType, sal_Int32 scale)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setRef(sal_Int32 parameter, const Reference< ::com::sun::star::sdbc::XRef >& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setBlob(sal_Int32 parameter, const Reference< ::com::sun::star::sdbc::XBlob >& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setClob(sal_Int32 parameter, const Reference< ::com::sun::star::sdbc::XClob >& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL setArray(sal_Int32 parameter, const Reference< ::com::sun::star::sdbc::XArray >& x)
+																					throw(SQLException, RuntimeException);
+
+			void SAL_CALL clearParameters() throw(SQLException, RuntimeException);
+
+			// XPreparedBatchExecution
+			void SAL_CALL addBatch() throw(SQLException, RuntimeException);
+			void SAL_CALL clearBatch() throw(SQLException, RuntimeException);
+			::com::sun::star::uno::Sequence< sal_Int32 > SAL_CALL executeBatch()	throw(SQLException, RuntimeException);
+
+			// XCloseable
+			void SAL_CALL close() throw(SQLException, RuntimeException);
+
+			// XResultSetMetaDataSupplier
+			Reference< ::com::sun::star::sdbc::XResultSetMetaData > SAL_CALL getMetaData()
+																					throw(SQLException, RuntimeException);
+		};
+	} /* mysqlc */
+} /* connectivity */
+#endif // CONNECTIVITY_SPREPAREDSTATEMENT_HXX
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
+ 
Index: mysqlc/source/delzip
===================================================================
Index: mysqlc/source/mysqlc_connection.cxx
===================================================================
--- mysqlc/source/mysqlc_connection.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_connection.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,791 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_connection.cxx,v $
+*
+* $Revision: 1.1.2.6 $*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#include <cppconn/driver.h>
+#include <cppconn/connection.h>
+#include <cppconn/statement.h>
+#include <cppconn/metadata.h>
+#include <cppconn/exception.h>
+
+#include "mysqlc_connection.hxx"
+#include "mysqlc_databasemetadata.hxx"
+
+
+#include "mysqlc_driver.hxx"
+#include "mysqlc_statement.hxx"
+#include "mysqlc_preparedstatement.hxx"
+#include "mysqlc_general.hxx"
+
+#include <com/sun/star/sdbc/ColumnValue.hpp>
+#include <com/sun/star/sdbc/XRow.hpp>
+#include <com/sun/star/sdbc/TransactionIsolation.hpp>
+#include <com/sun/star/lang/DisposedException.hpp>
+#include <com/sun/star/beans/NamedValue.hpp>
+
+#include <osl/module.hxx>
+#include <osl/thread.h>
+#include <osl/file.h>
+#include <rtl/uri.hxx>
+#include <rtl/ustrbuf.hxx>
+
+using namespace connectivity::mysqlc;
+
+#include <stdio.h>
+
+//------------------------------------------------------------------------------
+using namespace com::sun::star::uno;
+using namespace com::sun::star::container;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using ::osl::MutexGuard;
+using ::rtl::OUString;
+
+
+#define MYSQLC_URI_PREFIX "sdbc:mysqlc:"
+
+
+/* {{{ OConnection::OConnection() -I- */
+OConnection::OConnection(MysqlCDriver& _rDriver, sql::Driver * _cppDriver) 
+	:OMetaConnection_BASE(m_aMutex)
+	,OSubComponent<OConnection, OConnection_BASE>((::cppu::OWeakObject*)&_rDriver, this)
+	,m_xMetaData(NULL)
+	,m_rDriver(_rDriver)
+	,cppDriver(_cppDriver)
+	,m_bClosed(sal_False)
+	,m_bUseCatalog(sal_False)
+	,m_bUseOldDateFormat(sal_False)
+{
+	OSL_TRACE("OConnection::OConnection");
+	m_rDriver.acquire();
+}
+/* }}} */
+
+
+/* {{{ OConnection::OConnection() -I- */
+OConnection::~OConnection()
+{
+	OSL_TRACE("OConnection::~OConnection");
+	if (!isClosed()) {
+		close();
+	}
+	m_rDriver.release();
+}
+/* }}} */
+
+
+/* {{{ OConnection::release() -I- */
+void SAL_CALL OConnection::release()
+	throw()
+{
+	OSL_TRACE("OConnection::release");
+	relase_ChildImpl();
+}
+/* }}} */
+
+#ifndef SYSTEM_MYSQL
+    extern "C" { void SAL_CALL thisModule() {} }
+#endif
+
+/* {{{ OConnection::construct() -I- */
+void OConnection::construct(const OUString& url, const Sequence< PropertyValue >& info) 
+	throw(SQLException)
+{
+	OSL_TRACE("OConnection::construct");
+	MutexGuard aGuard(m_aMutex);
+
+	sal_Int32 nIndex;
+	sal_Bool  bEmbedded = sal_False;
+	OUString token;
+	OUString aHostName(RTL_CONSTASCII_USTRINGPARAM("localhost"));
+    sal_Int32 nPort = 3306;
+	OUString aDbName;
+
+	m_settings.encoding = m_rDriver.getDefaultEncoding();
+	m_settings.quoteIdentifier = OUString();
+
+	// parse url. Url has the following format:
+	// external server: sdbc:mysqlc:[hostname]:[port]/[dbname]
+
+	if (!url.compareTo(OUString::createFromAscii(MYSQLC_URI_PREFIX), sizeof(MYSQLC_URI_PREFIX)-1)) {
+		nIndex = 12;
+	} else {
+		bEmbedded = sal_True;
+		nIndex = 20;
+		mysqlc_sdbc_driver::throwFeatureNotImplementedException("OConnection::construct (embedded MySQL)", *this);
+	}
+
+	token = url.getToken(0, '/', nIndex);
+	if (token.getLength()) {
+		sal_Int32 nIndex1 = 0;
+		OUString hostandport = token.getToken(0,':', nIndex1);
+		if (hostandport.getLength()) {
+			aHostName = hostandport;
+			hostandport = token.getToken(0, ':', nIndex1);
+			if (hostandport.getLength() && nIndex1) {
+                nPort = hostandport.toInt32();
+			}
+			token = url.getToken(0, '/', nIndex);
+			if (token.getLength() && nIndex) {
+				aDbName = token;
+			}
+		}
+	}
+
+	// get user and password for mysql connection
+	const PropertyValue *pIter	= info.getConstArray();
+	const PropertyValue *pEnd	= pIter + info.getLength();
+	OUString aUser, aPass, sUnixSocket, sNamedPipe;
+	bool unixSocketPassed = false;
+	bool namedPipePassed = false;
+
+	m_settings.connectionURL = url;
+	for (;pIter != pEnd;++pIter) {
+		if (!pIter->Name.compareToAscii("user")) {
+			OSL_VERIFY( pIter->Value >>= aUser );
+		} else if (!pIter->Name.compareToAscii("password")) {
+			OSL_VERIFY( pIter->Value >>= aPass );
+		} else if (!pIter->Name.compareToAscii("LocalSocket")) {
+			OSL_VERIFY( pIter->Value >>= sUnixSocket );
+			unixSocketPassed = true;
+		} else if (!pIter->Name.compareToAscii("NamedPipe")) {
+			OSL_VERIFY( pIter->Value >>= sNamedPipe );
+			namedPipePassed = true;
+		} else if ( !pIter->Name.compareToAscii("PublicConnectionURL")) {
+			OSL_VERIFY( pIter->Value >>= m_settings.connectionURL );
+		} else if ( !pIter->Name.compareToAscii("NewURL")) {    // legacy name for "PublicConnectionURL"
+			OSL_VERIFY( pIter->Value >>= m_settings.connectionURL );
+        }
+	}
+
+	if (bEmbedded == sal_False) {
+		try {
+            sql::ConnectOptionsMap connProps;
+			std::string host_str = OUStringToOString(aHostName, m_settings.encoding).getStr();
+			std::string user_str = OUStringToOString(aUser, m_settings.encoding).getStr();
+			std::string pass_str = OUStringToOString(aPass, m_settings.encoding).getStr();
+			std::string schema_str = OUStringToOString(aDbName, m_settings.encoding).getStr();
+			connProps["hostName"] = sql::ConnectPropertyVal(host_str);
+			connProps["userName"] = sql::ConnectPropertyVal(user_str);
+			connProps["password"] = sql::ConnectPropertyVal(pass_str);
+			connProps["schema"] = sql::ConnectPropertyVal(schema_str);
+			connProps["port"] = sql::ConnectPropertyVal((int)(nPort));
+			if (unixSocketPassed) {
+				sql::SQLString socket_str = OUStringToOString(sUnixSocket, m_settings.encoding).getStr();
+				connProps["socket"] = socket_str;
+			} else if (namedPipePassed) {
+				sql::SQLString pipe_str = OUStringToOString(sNamedPipe, m_settings.encoding).getStr();
+				connProps["socket"] = pipe_str;
+			}
+
+#ifndef SYSTEM_MYSQL
+            ::rtl::OUString sMySQLClientLib( RTL_CONSTASCII_USTRINGPARAM( MYSQL_LIB ) );
+
+            ::rtl::OUString moduleBase;
+            OSL_VERIFY( ::osl::Module::getUrlFromAddress( &thisModule, moduleBase ) );
+            ::rtl::OUString sMySQLClientLibURL;
+            try
+            {
+                sMySQLClientLibURL = ::rtl::Uri::convertRelToAbs( moduleBase, sMySQLClientLib.pData );
+            }
+            catch ( const ::rtl::MalformedUriException& e )
+            {
+                (void)e; // silence compiler
+            #if OSL_DEBUG_LEVEL > 0
+                ::rtl::OString sMessage( "OConnection::construct: malformed URI: " );
+                sMessage += ::rtl::OUStringToOString( e.getMessage(), osl_getThreadTextEncoding() );
+                OSL_ENSURE( false, sMessage.getStr() );
+            #endif
+            }
+
+            ::rtl::OUString sMySQLClientLibPath;
+            osl_getSystemPathFromFileURL( sMySQLClientLibURL.pData, &sMySQLClientLibPath.pData );
+
+            sql::SQLString mysqlLib = ::rtl::OUStringToOString( sMySQLClientLibPath, osl_getThreadTextEncoding() ).getStr();
+            connProps["clientlib"] = mysqlLib;
+
+            OSL_TRACE("clientlib=%s", mysqlLib.c_str());
+#endif
+
+			OSL_TRACE("hostName=%s", host_str.c_str());
+            OSL_TRACE("port=%i", int(nPort));
+			OSL_TRACE("userName=%s", user_str.c_str());
+			OSL_TRACE("password=%s", pass_str.c_str());
+            OSL_TRACE("schema=%s", schema_str.c_str());
+
+			m_settings.cppConnection.reset(cppDriver->connect(connProps));
+		} catch (sql::SQLException &e) {
+			mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+		}
+	} else {
+		// TODO: support for embedded server
+	}
+
+	m_settings.schema = aDbName;
+	OSL_TRACE(OUStringToOString(m_settings.schema, getConnectionEncoding()).getStr());
+
+	// Check if the server is 4.1 or above
+	if (this->getMysqlVersion() < 40100) {
+		throw SQLException(
+			::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "MySQL Connector/OO.org requires MySQL Server 4.1 or above" ) ),
+			*this,
+			::rtl::OUString(),
+			0,
+			Any());
+	}
+	std::auto_ptr<sql::Statement> stmt(m_settings.cppConnection->createStatement());
+	stmt->executeUpdate("SET session sql_mode='ANSI_QUOTES'");
+	stmt->executeUpdate("SET NAMES utf8");
+}
+/* }}} */
+
+
+// XServiceInfo
+IMPLEMENT_SERVICE_INFO(OConnection, "com.sun.star.sdbc.drivers.mysqlc.OConnection", "com.sun.star.sdbc.Connection")
+
+
+/* {{{ OConnection::createStatement() -I- */
+Reference< XStatement > SAL_CALL OConnection::createStatement()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::createStatement");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	// create a statement
+	Reference< XStatement > xReturn;
+	// the statement can only be executed once
+	try {
+		xReturn = new OStatement(this, m_settings.cppConnection->createStatement());
+		m_aStatements.push_back(WeakReferenceHelper(xReturn));
+		return xReturn;
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+	return xReturn;
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+Reference< XPreparedStatement > SAL_CALL OConnection::prepareStatement(const OUString& _sSql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::prepareStatement");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+	const ::rtl::OUString sSqlStatement = transFormPreparedStatement( _sSql );
+
+	Reference< XPreparedStatement > xStatement;
+	try {
+		// create a statement
+		// the statement can only be executed more than once
+		xStatement = new OPreparedStatement(this,
+					m_settings.cppConnection->prepareStatement(OUStringToOString(sSqlStatement, getConnectionEncoding()).getStr()));
+		m_aStatements.push_back( WeakReferenceHelper( xStatement ) );
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+	return xStatement;
+}
+/* }}} */
+
+
+/* {{{ OConnection::prepareCall() -U- */
+Reference< XPreparedStatement > SAL_CALL OConnection::prepareCall(const OUString& /*_sSql*/ )
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::prepareCall");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	mysqlc_sdbc_driver::throwFeatureNotImplementedException("OConnection::prepareCall", *this);
+	return Reference< XPreparedStatement >();
+}
+/* }}} */
+
+
+/* {{{ OConnection::nativeSQL() -I- */
+OUString SAL_CALL OConnection::nativeSQL(const OUString& _sSql)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::nativeSQL");
+	MutexGuard aGuard(m_aMutex);
+
+	const ::rtl::OUString sSqlStatement = transFormPreparedStatement( _sSql );
+    ::rtl::OUString sNativeSQL;
+	try {
+		sNativeSQL = mysqlc_sdbc_driver::convert(m_settings.cppConnection->nativeSQL(mysqlc_sdbc_driver::convert(sSqlStatement, getConnectionEncoding())),
+																				getConnectionEncoding());
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+    return sNativeSQL;
+}
+/* }}} */
+
+
+/* {{{ OConnection::setAutoCommit() -I- */
+void SAL_CALL OConnection::setAutoCommit(sal_Bool autoCommit)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::setAutoCommit");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+	try {
+		m_settings.cppConnection->setAutoCommit(autoCommit == sal_True? true:false);
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+}
+/* }}} */
+
+
+/* {{{ OConnection::getAutoCommit() -I- */
+sal_Bool SAL_CALL OConnection::getAutoCommit()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getAutoCommit");
+	// you have to distinguish which if you are in autocommit mode or not
+	// at normal case true should be fine here
+
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	sal_Bool autoCommit = sal_False;
+	try {
+		autoCommit = m_settings.cppConnection->getAutoCommit() == true ? sal_True : sal_False;
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+	return autoCommit;
+}
+/* }}} */
+
+
+/* {{{ OConnection::commit() -I- */
+void SAL_CALL OConnection::commit()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::commit");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+	try {
+		m_settings.cppConnection->commit();
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OConnection::rollback() -I- */
+void SAL_CALL OConnection::rollback()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::rollback");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+	try {
+		m_settings.cppConnection->rollback();
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+}
+/* }}} */
+
+
+/* {{{ OConnection::isClosed() -I- */
+sal_Bool SAL_CALL OConnection::isClosed()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::isClosed");
+	MutexGuard aGuard(m_aMutex);
+
+	// just simple -> we are close when we are disposed taht means someone called dispose(); (XComponent)
+	return (OConnection_BASE::rBHelper.bDisposed);
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+Reference< XDatabaseMetaData > SAL_CALL OConnection::getMetaData()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getMetaData");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	Reference< XDatabaseMetaData > xMetaData = m_xMetaData;
+	if (!xMetaData.is()) {
+		try {
+			xMetaData = new ODatabaseMetaData(*this); // need the connection because it can return it
+		} catch (sql::SQLException & e) {
+			mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+		}
+		m_xMetaData = xMetaData;
+	}
+
+	return xMetaData;
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+void SAL_CALL OConnection::setReadOnly(sal_Bool readOnly)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::setReadOnly");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	m_settings.readOnly = readOnly;
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+sal_Bool SAL_CALL OConnection::isReadOnly()
+	throw(SQLException, RuntimeException)
+{	
+	OSL_TRACE("OConnection::isReadOnly");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	// return if your connection to readonly
+	return (m_settings.readOnly);
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+void SAL_CALL OConnection::setCatalog(const OUString& catalog)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::setCatalog");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	try {
+//		m_settings.cppConnection->setCatalog(OUStringToOString(catalog, m_settings.encoding).getStr());
+		m_settings.cppConnection->setSchema(OUStringToOString(catalog, getConnectionEncoding()).getStr());
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}	
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+OUString SAL_CALL OConnection::getCatalog()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getCatalog");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	OUString catalog;
+	try {
+		catalog = mysqlc_sdbc_driver::convert(m_settings.cppConnection->getSchema(), getConnectionEncoding());
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+	return catalog;
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+void SAL_CALL OConnection::setTransactionIsolation(sal_Int32 level)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::setTransactionIsolation");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	sql::enum_transaction_isolation cpplevel = sql::TRANSACTION_SERIALIZABLE;
+
+	switch (level) {
+		case TransactionIsolation::READ_UNCOMMITTED:
+			cpplevel = sql::TRANSACTION_READ_UNCOMMITTED;
+			break;
+		case TransactionIsolation::READ_COMMITTED:
+			cpplevel = sql::TRANSACTION_READ_COMMITTED;
+			break;
+		case TransactionIsolation::REPEATABLE_READ:
+			cpplevel = sql::TRANSACTION_REPEATABLE_READ;
+			break;
+		case TransactionIsolation::SERIALIZABLE:
+			cpplevel = sql::TRANSACTION_SERIALIZABLE;
+			break;
+		case TransactionIsolation::NONE:
+			cpplevel = sql::TRANSACTION_SERIALIZABLE;
+			break;			
+		default:;
+			/* XXX: Exception ?? */
+	}
+	try {
+		m_settings.cppConnection->setTransactionIsolation(cpplevel);
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+}
+/* }}} */
+
+
+/* {{{ OConnection::createStatement() -I- */
+sal_Int32 SAL_CALL OConnection::getTransactionIsolation()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getTransactionIsolation");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	try {
+		switch (m_settings.cppConnection->getTransactionIsolation()) {
+			case sql::TRANSACTION_SERIALIZABLE:		return TransactionIsolation::SERIALIZABLE;
+			case sql::TRANSACTION_REPEATABLE_READ:	return TransactionIsolation::REPEATABLE_READ;
+			case sql::TRANSACTION_READ_COMMITTED:	return TransactionIsolation::READ_COMMITTED;
+			case sql::TRANSACTION_READ_UNCOMMITTED:	return TransactionIsolation::READ_UNCOMMITTED;
+			default:
+				;
+		}
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}	
+	return TransactionIsolation::NONE;
+}
+/* }}} */
+
+
+/* {{{ OConnection::getTypeMap() -I- */
+Reference<XNameAccess> SAL_CALL OConnection::getTypeMap()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getTypeMap");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	Reference<XNameAccess > t;
+	{
+		t = m_typeMap;
+	}
+	return (t);
+}
+/* }}} */
+
+
+/* {{{ OConnection::setTypeMap() -I- */
+void SAL_CALL OConnection::setTypeMap(const Reference<XNameAccess >& typeMap)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::setTypeMap");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	m_typeMap = typeMap;
+}
+/* }}} */
+
+
+// XCloseable
+/* {{{ OConnection::close() -I- */
+void SAL_CALL OConnection::close()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::close");
+	/*
+	  we need block, because the mutex is a local variable,
+	  which will guard the block
+	*/
+	{
+		// we just dispose us
+		MutexGuard aGuard(m_aMutex);
+		checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+	}
+	dispose();
+}
+/* }}} */
+
+
+// XWarningsSupplier
+/* {{{ OConnection::getWarnings() -I- */
+Any SAL_CALL OConnection::getWarnings()
+	throw(SQLException, RuntimeException)
+{
+	Any x = Any();
+	OSL_TRACE("OConnection::getWarnings");
+	// when you collected some warnings -> return it
+	return x;
+}
+/* }}} */
+
+
+/* {{{ OConnection::clearWarnings() -I- */
+void SAL_CALL OConnection::clearWarnings()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::clearWarnings");
+	// you should clear your collected warnings here#
+}
+/* }}} */
+
+
+/* {{{ OConnection::buildTypeInfo() -I- */
+void OConnection::buildTypeInfo()
+	throw(SQLException)
+{
+	OSL_TRACE("OConnection::buildTypeInfo");
+}
+/* }}} */
+
+
+/* {{{ OConnection::disposing() -I- */
+void OConnection::disposing()
+{
+	OSL_TRACE("OConnection::disposing");
+	// we noticed that we should be destroied in near future so we have to dispose our statements
+	MutexGuard aGuard(m_aMutex);
+
+	for (OWeakRefArray::iterator i = m_aStatements.begin(); i != m_aStatements.end() ; ++i) {
+		Reference< XComponent > xComp(i->get(), UNO_QUERY);
+		if (xComp.is()) {
+			xComp->dispose();
+		}
+	}
+	m_aStatements.clear();
+
+	m_bClosed	= sal_True;
+	m_xMetaData	= WeakReference< XDatabaseMetaData >();
+
+	dispose_ChildImpl();
+	OConnection_BASE::disposing();
+}
+/* }}} */
+
+
+/* ToDo - upcast the connection to MySQL_Connection and use ::getSessionVariable() */
+
+/* {{{ OConnection::getMysqlVariable() -I- */
+OUString OConnection::getMysqlVariable(const char *varname)
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getMysqlVariable");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	OUString ret;
+	::rtl::OUStringBuffer aStatement;
+	aStatement.appendAscii( "SHOW SESSION VARIABLES LIKE '" );
+	aStatement.appendAscii( varname );
+	aStatement.append( sal_Unicode( '\'' ) );
+
+	try {
+		XStatement * stmt = new OStatement(this, m_settings.cppConnection->createStatement());
+		Reference< XResultSet > rs = stmt->executeQuery( aStatement.makeStringAndClear() );	
+		if (rs.is() && rs->next()) {
+			Reference< XRow > xRow(rs, UNO_QUERY);
+			ret = xRow->getString(2);
+		}
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}								
+
+	return ret;
+}
+/* }}} */
+
+
+/* {{{ OConnection::getMysqlVersion() -I- */
+sal_Int32 OConnection::getMysqlVersion()
+	throw(SQLException, RuntimeException)
+{
+	OSL_TRACE("OConnection::getMysqlVersion");
+	MutexGuard aGuard(m_aMutex);
+	checkDisposed(OConnection_BASE::rBHelper.bDisposed);
+
+	sal_Int32 version(0);
+	try {
+		version = 10000 * m_settings.cppConnection->getMetaData()->getDatabaseMajorVersion();
+		version += 100 * m_settings.cppConnection->getMetaData()->getDatabaseMinorVersion();
+		version += m_settings.cppConnection->getMetaData()->getDatabasePatchVersion();
+	} catch (sql::SQLException & e) {
+		mysqlc_sdbc_driver::translateAndThrow(e, *this, getConnectionEncoding());
+	}
+	return version;
+}
+/* }}} */
+
+
+/* {{{ OConnection::sdbcColumnType() -I- */
+// TODO: Not used
+//sal_Int32 OConnection::sdbcColumnType(OUString typeName)
+//{
+//	OSL_TRACE("OConnection::sdbcColumnType");
+//	int i = 0;
+//	while (mysqlc_types[i].typeName) {
+//		if (OUString::createFromAscii(mysqlc_types[i].typeName).equals(
+//			typeName.toAsciiUpperCase()))
+//		{
+//			return mysqlc_types[i].dataType;
+//		}
+//		i++;
+//	}
+//	return 0;
+//}
+// -----------------------------------------------------------------------------
+::rtl::OUString OConnection::transFormPreparedStatement(const ::rtl::OUString& _sSQL)
+{
+	::rtl::OUString sSqlStatement = _sSQL;
+	if ( !m_xParameterSubstitution.is() ) {
+		try {
+			Sequence< Any > aArgs(1);
+			Reference< XConnection> xCon = this;
+			aArgs[0] <<= NamedValue(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("ActiveConnection")), makeAny(xCon));
+
+			m_xParameterSubstitution.set(m_rDriver.getFactory()->createInstanceWithArguments(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("org.openoffice.comp.helper.ParameterSubstitution")),aArgs),UNO_QUERY);
+		} catch(const Exception&) {}
+	}
+	if ( m_xParameterSubstitution.is() ) {
+		try	{
+			sSqlStatement = m_xParameterSubstitution->substituteVariables(sSqlStatement,sal_True);
+		} catch(const Exception&) { }
+	}
+	return sSqlStatement;
+}
+
+/* }}} */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_resultset.hxx
===================================================================
--- mysqlc/source/mysqlc_resultset.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_resultset.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,337 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_resultset.hxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef MYSQLC_SRESULTSET_HXX
+#define MYSQLC_SRESULTSET_HXX
+
+#include "mysqlc_preparedstatement.hxx"
+#include "mysqlc_statement.hxx"
+#include "mysqlc_subcomponent.hxx"
+
+#include <com/sun/star/sdbc/XCloseable.hpp>
+#include <com/sun/star/sdbc/XColumnLocate.hpp>
+#include <com/sun/star/sdbc/XResultSet.hpp>
+#include <com/sun/star/sdbc/XResultSetMetaDataSupplier.hpp>
+#include <com/sun/star/sdbc/XResultSetUpdate.hpp>
+#include <com/sun/star/sdbc/XRow.hpp>
+#include <com/sun/star/sdbc/XRowUpdate.hpp>
+#include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+#include <com/sun/star/sdbcx/XDeleteRows.hpp>
+#include <com/sun/star/sdbcx/XRowLocate.hpp>
+#include <com/sun/star/util/XCancellable.hpp>
+
+#include <cppuhelper/compbase12.hxx>
+
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		using ::rtl::OUString;
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::RuntimeException;
+		using ::com::sun::star::uno::Any;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream > my_XInputStreamRef;
+		typedef my_XNameAccessRef my_XNameAccessRef;
+
+		/*
+		**	OResultSet
+		*/
+        typedef ::cppu::WeakComponentImplHelper12<	::com::sun::star::sdbc::XResultSet,
+													::com::sun::star::sdbc::XRow,
+													::com::sun::star::sdbc::XResultSetMetaDataSupplier,
+													::com::sun::star::util::XCancellable,
+													::com::sun::star::sdbc::XWarningsSupplier,
+													::com::sun::star::sdbc::XResultSetUpdate,
+													::com::sun::star::sdbc::XRowUpdate,
+													::com::sun::star::sdbcx::XRowLocate,
+													::com::sun::star::sdbcx::XDeleteRows,
+													::com::sun::star::sdbc::XCloseable,
+													::com::sun::star::sdbc::XColumnLocate,
+													::com::sun::star::lang::XServiceInfo> OResultSet_BASE;
+
+		class OResultSet :	public	OBase_Mutex,
+							public	OResultSet_BASE,
+							public	::cppu::OPropertySetHelper,
+							public	OPropertyArrayUsageHelper<OResultSet>
+		{
+		protected:
+			::com::sun::star::uno::WeakReferenceHelper	m_aStatement;
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData> m_xMetaData;
+			sql::ResultSet		*m_result;
+			unsigned int		fieldCount;
+            rtl_TextEncoding    m_encoding;
+			// OPropertyArrayUsageHelper
+			::cppu::IPropertyArrayHelper* createArrayHelper() const;
+			// OPropertySetHelper
+			::cppu::IPropertyArrayHelper & SAL_CALL getInfoHelper();
+
+			sal_Bool SAL_CALL convertFastPropertyValue(Any & rConvertedValue, Any & rOldValue, sal_Int32 nHandle, const Any& rValue)
+						throw (::com::sun::star::lang::IllegalArgumentException);
+
+			void SAL_CALL setFastPropertyValue_NoBroadcast(sal_Int32 nHandle, const Any& rValue)
+						throw (::com::sun::star::uno::Exception);
+
+			void SAL_CALL getFastPropertyValue(Any& rValue, sal_Int32 nHandle) const;
+
+			// you can't delete objects of this type
+			virtual ~OResultSet();
+
+		public:
+			DECLARE_SERVICE_INFO();
+			
+			OResultSet( OCommonStatement* pStmt, sql::ResultSet *result, rtl_TextEncoding _encoding );
+
+			::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > operator *()
+			{
+				return ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >(*(OResultSet_BASE*)this);
+			}
+
+			// ::cppu::OComponentHelper
+			void SAL_CALL disposing();
+
+			// XInterface
+			Any SAL_CALL queryInterface(const ::com::sun::star::uno::Type & rType)
+																		throw(RuntimeException);
+
+			void SAL_CALL acquire()										throw();
+
+			void SAL_CALL release()										throw();
+
+			//XTypeProvider
+			::com::sun::star::uno::Sequence< ::com::sun::star::uno::Type > SAL_CALL getTypes()
+																		throw(RuntimeException);
+
+			// XPropertySet
+			::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL getPropertySetInfo()
+																		throw(RuntimeException);
+
+			// XResultSet
+			sal_Bool SAL_CALL next()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isBeforeFirst()							throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isAfterLast()								throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isFirst()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isLast()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL beforeFirst()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL afterLast()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL first()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL last()									throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getRow()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL absolute(sal_Int32 row)					throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL relative(sal_Int32 rows)					throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL previous()								throw(SQLException, RuntimeException);
+
+			void SAL_CALL refreshRow()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL rowUpdated()								throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL rowInserted()								throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL rowDeleted()								throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > SAL_CALL getStatement()
+																		throw(SQLException, RuntimeException);
+			// XRow
+			sal_Bool SAL_CALL wasNull() throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getString(sal_Int32 column)		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL getBoolean(sal_Int32 column)				throw(SQLException, RuntimeException);
+
+			sal_Int8 SAL_CALL getByte(sal_Int32 column)					throw(SQLException, RuntimeException);
+
+			sal_Int16 SAL_CALL getShort(sal_Int32 column)				throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getInt(sal_Int32 column)					throw(SQLException, RuntimeException);
+
+			sal_Int64 SAL_CALL getLong(sal_Int32 column)				throw(SQLException, RuntimeException);
+
+			float SAL_CALL getFloat(sal_Int32 column)					throw(SQLException, RuntimeException);
+
+			double SAL_CALL getDouble(sal_Int32 column)					throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Sequence< sal_Int8 > SAL_CALL getBytes(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::util::Date SAL_CALL getDate(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::util::Time SAL_CALL getTime(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::util::DateTime SAL_CALL getTimestamp(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			my_XInputStreamRef SAL_CALL getBinaryStream(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			my_XInputStreamRef SAL_CALL getCharacterStream(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			Any SAL_CALL getObject(sal_Int32 column, const my_XNameAccessRef& typeMap)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XRef > SAL_CALL getRef(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XBlob > SAL_CALL getBlob(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XClob > SAL_CALL getClob(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XArray > SAL_CALL getArray(sal_Int32 column)
+																		throw(SQLException, RuntimeException);
+
+			// XResultSetMetaDataSupplier
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData > SAL_CALL getMetaData()
+																		throw(SQLException, RuntimeException);
+
+			// XCancellable
+			void SAL_CALL cancel()										throw(RuntimeException);
+
+			// XCloseable
+			void SAL_CALL close()										throw(SQLException, RuntimeException);
+
+			// XWarningsSupplier
+			Any SAL_CALL getWarnings()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL clearWarnings()								throw(SQLException, RuntimeException);
+
+			// XResultSetUpdate
+			void SAL_CALL insertRow()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateRow()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL deleteRow()									throw(SQLException, RuntimeException);
+
+			void SAL_CALL cancelRowUpdates()							throw(SQLException, RuntimeException);
+
+			void SAL_CALL moveToInsertRow()								throw(SQLException, RuntimeException);
+
+			void SAL_CALL moveToCurrentRow()							throw(SQLException, RuntimeException);
+
+			// XRowUpdate
+			void SAL_CALL updateNull(sal_Int32 column)					throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateBoolean(sal_Int32 column, sal_Bool x)	throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateByte(sal_Int32 column, sal_Int8 x)		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateShort(sal_Int32 column, sal_Int16 x)	throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateInt(sal_Int32 column, sal_Int32 x)		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateLong(sal_Int32 column, sal_Int64 x)		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateFloat(sal_Int32 column, float x)		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateDouble(sal_Int32 column, double x)		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateString(sal_Int32 column, const OUString& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateBytes(sal_Int32 column, const ::com::sun::star::uno::Sequence< sal_Int8 >& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateDate(sal_Int32 column, const ::com::sun::star::util::Date& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateTime(sal_Int32 column, const ::com::sun::star::util::Time& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateTimestamp(sal_Int32 column, const ::com::sun::star::util::DateTime& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateBinaryStream(sal_Int32 column, const my_XInputStreamRef& x, sal_Int32 length)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateCharacterStream(sal_Int32 column, const my_XInputStreamRef& x, sal_Int32 length)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateObject(sal_Int32 column, const Any& x)
+																		throw(SQLException, RuntimeException);
+
+			void SAL_CALL updateNumericObject(sal_Int32 column, const Any& x, sal_Int32 scale)
+																		throw(SQLException, RuntimeException);
+
+			// XColumnLocate
+			sal_Int32 SAL_CALL findColumn(const OUString& columnName)
+																		throw(SQLException, RuntimeException);
+
+			// XRowLocate
+			Any SAL_CALL getBookmark()									throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL moveToBookmark(const Any& bookmark)
+																		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL moveRelativeToBookmark(const Any& bookmark, sal_Int32 rows)
+																		throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL compareBookmarks(const Any& first, const Any& second)
+																		throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL hasOrderedBookmarks()						throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL hashBookmark(const Any& bookmark)
+																		throw(SQLException, RuntimeException);
+
+			// XDeleteRows
+			::com::sun::star::uno::Sequence< sal_Int32 > SAL_CALL deleteRows(const ::com::sun::star::uno::Sequence< Any >& rows)
+																		throw(SQLException, RuntimeException);
+
+			void checkColumnIndex(sal_Int32 index) throw(SQLException, RuntimeException);
+
+		private:
+			using ::cppu::OPropertySetHelper::getFastPropertyValue;
+		};
+	} /* mysqlc */
+} /* connectivity */
+#endif // CONNECTIVITY_SRESULTSET_HXX
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_driver.hxx
===================================================================
--- mysqlc/source/mysqlc_driver.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_driver.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,118 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_driver.hxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef MYSQLC_SDRIVER_HXX
+#define MYSQLC_SDRIVER_HXX
+
+#include "mysqlc_connection.hxx"
+
+#include <com/sun/star/sdbc/XDriver.hpp>
+#include <com/sun/star/lang/XServiceInfo.hpp>
+
+#include <cppuhelper/compbase2.hxx>
+#include <cppconn/driver.h>
+#include <osl/module.h>
+
+namespace connectivity
+{
+	namespace mysqlc
+	{
+		using ::rtl::OUString;
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::RuntimeException;
+		using ::com::sun::star::uno::Exception;
+		using ::com::sun::star::uno::Reference;
+		using ::com::sun::star::uno::Sequence;
+		Reference< ::com::sun::star::uno::XInterface > SAL_CALL MysqlCDriver_CreateInstance(const Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory) throw(Exception);
+
+		typedef ::cppu::WeakComponentImplHelper2<	::com::sun::star::sdbc::XDriver, 
+													::com::sun::star::lang::XServiceInfo > ODriver_BASE;
+
+		typedef void* (SAL_CALL * OMysqlCConnection_CreateInstanceFunction)(void* _pDriver);
+
+		class MysqlCDriver : public ODriver_BASE
+		{
+		protected:
+            Reference< ::com::sun::star::lang::XMultiServiceFactory > m_xFactory;
+			::osl::Mutex	m_aMutex;		// mutex is need to control member access
+			OWeakRefArray	m_xConnections;	// vector containing a list
+											// of all the Connection objects
+											// for this Driver
+#ifndef SYSTEM_MYSQL_CPPCONN
+            oslModule       m_hCppConnModule;
+            bool            m_bAttemptedLoadCppConn;
+#endif
+
+			sql::Driver * cppDriver;
+
+		public:
+
+			MysqlCDriver(const Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory);
+
+			// OComponentHelper
+			void SAL_CALL disposing(void);
+			// XInterface
+			static OUString getImplementationName_Static()					throw(RuntimeException);
+			static Sequence< OUString > getSupportedServiceNames_Static()	throw(RuntimeException);
+
+			// XServiceInfo
+			OUString SAL_CALL getImplementationName()						throw(RuntimeException);
+			sal_Bool SAL_CALL supportsService(const OUString& ServiceName)	throw(RuntimeException);
+			Sequence< OUString > SAL_CALL getSupportedServiceNames()		throw(RuntimeException);
+
+			// XDriver
+			Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL connect(const OUString& url, const Sequence< ::com::sun::star::beans::PropertyValue >& info)
+																			throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL acceptsURL(const OUString& url) throw(SQLException, RuntimeException);
+			Sequence< ::com::sun::star::sdbc::DriverPropertyInfo > SAL_CALL getPropertyInfo(const OUString& url, const Sequence< ::com::sun::star::beans::PropertyValue >& info)
+																			throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getMajorVersion()							throw(RuntimeException);
+			sal_Int32 SAL_CALL getMinorVersion()							throw(RuntimeException);
+
+            inline Reference< ::com::sun::star::lang::XMultiServiceFactory > getFactory() const { return m_xFactory; }
+
+			rtl_TextEncoding getDefaultEncoding() { return RTL_TEXTENCODING_UTF8; }
+
+        private:
+            void    impl_initCppConn_lck_throw();
+		};
+	} /* mysqlc */
+} /* connectivity */
+
+#endif // MYSQLC_SDRIVER_HXX
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/source/mysqlc_connection.hxx
===================================================================
--- mysqlc/source/mysqlc_connection.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_connection.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,250 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_connection.hxx,v $
+*
+* $Revision: 1.1.2.4 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef MYSQLC_CONNECTION_HXX
+#define MYSQLC_CONNECTION_HXX
+
+#include "mysqlc_subcomponent.hxx"
+#include "mysqlc_types.hxx"
+
+#include <boost/shared_ptr.hpp>
+#include <com/sun/star/beans/PropertyValue.hpp>
+#include <com/sun/star/lang/DisposedException.hpp>
+#include <com/sun/star/lang/XServiceInfo.hpp>
+#include <com/sun/star/lang/XUnoTunnel.hpp>
+#include <com/sun/star/sdbc/ColumnSearch.hpp>
+#include <com/sun/star/sdbc/ColumnValue.hpp>
+#include <com/sun/star/sdbc/DataType.hpp>
+#include <com/sun/star/sdbc/SQLWarning.hpp>
+#include <com/sun/star/sdbc/XConnection.hpp>
+#include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+#include <com/sun/star/util/XStringSubstitution.hpp>
+
+#include <cppconn/driver.h>
+#include <cppuhelper/compbase3.hxx>
+#include <cppuhelper/weakref.hxx>
+#include <rtl/string.hxx>
+
+#include <map>
+
+#define UNUSED_PARAM __attribute__((unused))
+
+namespace sql
+{
+    class SQLException;
+}
+
+namespace connectivity
+{
+	class OMetaConnection;
+	class ODatabaseMetaData;
+
+	namespace mysqlc
+	{
+		using ::rtl::OUString;
+		using ::com::sun::star::sdbc::SQLWarning;
+		using ::com::sun::star::sdbc::SQLException;
+		using ::com::sun::star::uno::RuntimeException;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XStatement > my_XStatementRef;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XPreparedStatement > my_XPreparedStatementRef;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::container::XNameAccess > my_XNameAccessRef;
+		typedef ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData > my_XDatabaseMetaDataRef;
+
+		typedef ::cppu::WeakComponentImplHelper3<	::com::sun::star::sdbc::XConnection,
+													::com::sun::star::sdbc::XWarningsSupplier,
+													::com::sun::star::lang::XServiceInfo
+												> OMetaConnection_BASE;
+		struct ConnectionSettings
+		{
+			rtl_TextEncoding encoding;
+			std::auto_ptr<sql::Connection> cppConnection;
+			OUString schema;
+			OUString quoteIdentifier;
+            OUString connectionURL;
+			sal_Bool readOnly;
+		};
+
+		class MysqlCDriver;
+
+		typedef OMetaConnection_BASE OConnection_BASE;
+
+		typedef std::vector< ::com::sun::star::uno::WeakReferenceHelper > OWeakRefArray;
+
+		class OConnection : public OBase_Mutex,
+							public OConnection_BASE,
+							public connectivity::mysqlc::OSubComponent<OConnection, OConnection_BASE>
+		{
+			friend class connectivity::mysqlc::OSubComponent<OConnection, OConnection_BASE>;
+
+        private:
+			ConnectionSettings  m_settings;
+
+		private:
+			::com::sun::star::uno::Reference< com::sun::star::container::XNameAccess > m_typeMap;
+            ::com::sun::star::uno::Reference< com::sun::star::util::XStringSubstitution > m_xParameterSubstitution;
+		protected:
+			
+			//====================================================================
+			// Data attributes
+			//====================================================================
+			::com::sun::star::uno::WeakReference< ::com::sun::star::sdbc::XDatabaseMetaData > m_xMetaData;
+
+			OWeakRefArray	m_aStatements;	// vector containing a list
+											// of all the Statement objects
+											// for this Connection
+
+			SQLWarning	    m_aLastWarning;	// Last SQLWarning generated by an operation
+			OUString	    m_aURL;			// URL of connection
+			OUString	    m_sUser;		// the user name
+			MysqlCDriver&   m_rDriver;	    // Pointer to the owning driver object
+			sql::Driver*    cppDriver;
+
+			sal_Bool	m_bClosed;
+			sal_Bool	m_bUseCatalog;	// should we use the catalog on filebased databases
+			sal_Bool	m_bUseOldDateFormat;
+
+
+			void		buildTypeInfo() throw(SQLException);
+		public:
+			OUString getMysqlVariable(const char *varname)
+																throw(SQLException, RuntimeException);
+
+			sal_Int32 getMysqlVersion() 
+																throw(SQLException, RuntimeException);
+
+			virtual void construct(const OUString& url,const ::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue >& info)
+																throw(SQLException);
+
+			OConnection(MysqlCDriver& _rDriver, sql::Driver * cppDriver);
+			virtual ~OConnection();
+
+			void closeAllStatements ()							throw(SQLException);
+
+
+			rtl_TextEncoding getConnectionEncoding() { return m_settings.encoding; }
+
+
+			// OComponentHelper
+			virtual void SAL_CALL disposing(void);
+
+			// XInterface
+			virtual void SAL_CALL release()						throw();
+
+			// XServiceInfo
+			DECLARE_SERVICE_INFO();
+			// XConnection
+			my_XStatementRef SAL_CALL createStatement()
+																throw(SQLException, RuntimeException);
+
+			my_XPreparedStatementRef SAL_CALL prepareStatement(const OUString& sql)
+																throw(SQLException, RuntimeException);
+
+			my_XPreparedStatementRef SAL_CALL prepareCall(const OUString& sql)
+																throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL nativeSQL(const OUString& sql)
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL setAutoCommit(sal_Bool autoCommit)
+																throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL getAutoCommit()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL commit()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL rollback()
+																throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isClosed()
+																throw(SQLException, RuntimeException);
+
+			my_XDatabaseMetaDataRef SAL_CALL getMetaData()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL setReadOnly(sal_Bool readOnly)
+																throw(SQLException, RuntimeException);
+
+			sal_Bool SAL_CALL isReadOnly()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL setCatalog(const OUString& catalog)
+																throw(SQLException, RuntimeException);
+
+			OUString SAL_CALL getCatalog()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL setTransactionIsolation(sal_Int32 level)
+																throw(SQLException, RuntimeException);
+
+			sal_Int32 SAL_CALL getTransactionIsolation()
+																throw(SQLException, RuntimeException);
+
+			my_XNameAccessRef SAL_CALL getTypeMap()
+																throw(SQLException, RuntimeException);
+
+			void SAL_CALL setTypeMap(const my_XNameAccessRef& typeMap)
+																throw(SQLException, RuntimeException);
+			// XCloseable
+			void SAL_CALL close()
+																throw(SQLException, RuntimeException);
+			// XWarningsSupplier
+			::com::sun::star::uno::Any SAL_CALL getWarnings()
+																throw(SQLException, RuntimeException);
+			void SAL_CALL clearWarnings()
+																throw(SQLException, RuntimeException);
+
+            // TODO: Not used
+			//sal_Int32 sdbcColumnType(OUString typeName);
+            inline const ConnectionSettings& getConnectionSettings() const { return m_settings; }
+            ::rtl::OUString transFormPreparedStatement(const ::rtl::OUString& _sSQL);
+			
+			// should we use the catalog on filebased databases
+            inline sal_Bool			    isCatalogUsed()     const { return m_bUseCatalog; }
+            inline OUString			    getUserName()       const { return m_sUser; }
+            inline const MysqlCDriver&  getDriver()			const { return m_rDriver;}
+            inline rtl_TextEncoding	    getTextEncoding()	const { return m_settings.encoding; }
+
+		}; /* OConnection */
+        // TODO: Not used.
+		//inline OUString getPattern(OUString p) { return (p.getLength()) ? p : ASC2OU("%"); }
+	} /* mysqlc */
+} /* connectivity */
+#endif // MYSQLC_CONNECTION_HXX
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
+
Index: mysqlc/source/README
===================================================================
--- mysqlc/source/README	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/README	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,65 @@
+---------- Status -------------------------------------------------------------
+
+The code is on a PREVIEW level. PREVIEW means pre-alpha.
+
+---------- Requirements -------------------------------------------------------
+
+The MySQL driver for OpenOffice.org (MySQL Connector/OpenOffice.org - C/OOo)
+requires two external libraries to be build:
+
+ 1) The MySQL Client Library (libmysql)
+ 2) The MySQL Connector/C++ Library (libmysqlcppcon)
+
+At the time of writing neither of the two libraries are part of the CWS!
+Before you can build the MySQL driver for OpenOffice.org you must install
+the two required libraries on your system before you can compile the driver.
+
+You need the two libraries because the MySQL driver for OpenOffice.org
+does not feature an implementation of the MySQL Client Server
+communication protocol. The protocol implementation is part of the MySQL
+Client Library. And the SDBC(X) style OpenOffice.org driver is implemented as a
+wrapper of the MySQL Connector/C++ Library which implements a JDBC interface and
+in turn uses the C based MySQL Client Library.
+
+1) MySQL Client Library (libmysql)
+
+The MySQL Client Library (libmysql) is part of the MySQL Server. You need to
+download and install the MySQL Server. Use a binary distribution of
+MySQL 5.0.x or MySQL 5.1.x. Check the MySQL manual for instructions, e.g.
+for Unix:
+
+ http://dev.mysql.com/doc/refman/5.1/en/installing-binary.html
+
+The typical installation path of the libmysql.so on Unix is
+/usr/local/mysql/lib/mysql/ .
+
+2) MySQL Connector/C++ (libmysqlcppcon)
+
+Download and install the latest version of the MySQL Connector/C++, see
+http://forge.mysql.com/wiki/Connector_C++ . Check out the source
+from the bzr repository.
+
+3) Tweaking library paths
+
+At the time of writing you might have to *manually* tweak library paths and
+library names by patching makefile.mk. This is a temporary hack. The makefile
+will be improved later.
+
+However, for the moment check the makefile.mk if the compilation fails due to
+"missing" libraries (= libraries not found). For example, check the following
+settings:
+
+  MYSQL_INCDIR=/usr/local/include
+  MYSQL_LIBDIR=/usr/local/lib
+  [...]
+  MYSQL_INCDIR=/usr/local/include
+  MYSQL_LIBDIR=/usr/local/lib
+  [...]
+  MYSQL_INC=-I$(MYSQL_INCDIR)
+  MYSQL_LIB=-L$(MYSQL_LIBDIR) -lmysqlclient -rdynamic -lz -lcrypt -lnsl -lm
+  MYSQL_LIBFILE=$(MYSQL_LIBDIR)$/libmysqlclient.so.16
+  MYSQL_CPPCONN_LIBFILE=$(MYSQL_LIBDIR)$/libmysqlcppconn.so
+  [...]
+
+A common issue is libmysqlclient.so.15 vs. libmysqlclient.so.16 .
+
Index: mysqlc/source/exports.dxp
===================================================================
--- mysqlc/source/exports.dxp	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/exports.dxp	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,3 @@
+component_getImplementationEnvironment
+component_writeInfo
+component_getFactory
Index: mysqlc/source/manifest.xml
===================================================================
--- mysqlc/source/manifest.xml	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/manifest.xml	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE manifest:manifest PUBLIC "-//OpenOffice.org//DTD Manifest 1.0//EN" "Manifest.dtd">
+<manifest:manifest xmlns:manifest="http://openoffice.org/2001/manifest">
+  <manifest:file-entry manifest:media-type="application/vnd.sun.star.uno-component;type=native"
+                       manifest:full-path="mysqlc.unoSHARED_EXTENSION"/>
+    <manifest:file-entry manifest:media-type="application/vnd.sun.star.configuration-data"
+                 manifest:full-path="registry/data/org/openoffice/Office/DataAccess/Drivers.xcu"/>
+</manifest:manifest>
Index: mysqlc/source/mysqlc.xml
===================================================================
--- mysqlc/source/mysqlc.xml	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc.xml	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,81 @@
+<?xml version='1.0' encoding="UTF-8"?>
+<!DOCTYPE COMPONENTDESCRIPTION PUBLIC "-//W3C//DTD HTML 3.2//EN" "module-description.dtd">
+<module-description xmlns:xlink="http://www.w3.org/1999/xlink">
+	<module-name>mysqlc</module-name>
+	<component-description>
+		<Author>Georg Richter</Author>
+		<Name>com.sun.star.comp.sdbc.mysqlc</Name>
+		<Description>
+			This is the implementation of the MySQL Connector/OO.org.
+		</Description>
+		<loader-name>com.sun.star.loader.SharedLibrary</loader-name>
+		<language>c++</language>
+		<status value="final"/>
+		<supported-service>	com.sun.star.sdbc.Driver	</supported-service>
+		<service-dependency>	...	</service-dependency>
+	</component-description>	  
+	<project-build-dependency>	cppuhelper	</project-build-dependency>
+	<project-build-dependency>	cppu		</project-build-dependency>
+	<project-build-dependency>	sal			</project-build-dependency>
+	<project-build-dependency>	vos			</project-build-dependency>
+
+	<runtime-module-dependency>	cppuhelper	</runtime-module-dependency>
+	<runtime-module-dependency>	cppu1		</runtime-module-dependency>
+	<runtime-module-dependency>	sal1		</runtime-module-dependency>
+	<runtime-module-dependency>	vos			</runtime-module-dependency>
+
+	<type>	com.sun.star.registry.XRegistryKey			</type>
+	<type>	com.sun.star.util.XCancellable				</type>
+	<type>	com.sun.star.util.XNumberFormatter			</type>
+	<type>	com.sun.star.uno.TypeClass					</type>
+	<type>	com.sun.star.uno.XWeak						</type>
+	<type>	com.sun.star.uno.XAggregation				</type>
+	<type>	com.sun.star.uno.XComponentContext			</type>
+	<type>	com.sun.star.beans.PropertyAttribute		</type>
+	<type>	com.sun.star.beans.XPropertyState			</type>
+	<type>	com.sun.star.beans.XPropertySet				</type>
+	<type>	com.sun.star.beans.PropertyValue			</type>
+	<type>	com.sun.star.beans.XMultiPropertySet		</type>
+	<type>	com.sun.star.beans.XFastPropertySet			</type>
+	<type>	com.sun.star.lang.XSingleServiceFactory		</type>
+	<type>	com.sun.star.lang.XTypeProvider				</type>
+	<type>	com.sun.star.lang.XSingleComponentFactory	</type>
+	<type>	com.sun.star.lang.EventObject				</type>
+	<type>	com.sun.star.lang.XComponent				</type>
+	<type>	com.sun.star.lang.IllegalArgumentException	</type>
+	<type>	com.sun.star.lang.DisposedException			</type>
+	<type>	com.sun.star.lang.XMultiServiceFactory		</type>
+	<type>	com.sun.star.lang.XServiceInfo				</type>
+	<type>	com.sun.star.lang.XUnoTunnel				</type>
+	<type>	com.sun.star.java.XJavaThreadRegister_11	</type>
+	<type>	com.sun.star.java.XJavaVM					</type>	
+	<type>	com.sun.star.sdbc.FetchDirection			</type>
+	<type>	com.sun.star.sdbc.XConnection				</type>
+	<type>	com.sun.star.sdbc.XStatement				</type>
+	<type>	com.sun.star.sdbc.XResultSet				</type>
+	<type>	com.sun.star.sdbc.XResultSetMetaDataSupplier</type>
+	<type>	com.sun.star.sdbc.XColumnLocate				</type>
+	<type>	com.sun.star.sdbc.XResultSetUpdate			</type>
+	<type>	com.sun.star.sdbc.XWarningsSupplier			</type>
+	<type>	com.sun.star.sdbc.XRowUpdate				</type>
+	<type>	com.sun.star.sdbc.XMultipleResults			</type>
+	<type>	com.sun.star.sdbc.XBatchExecution			</type>
+	<type>	com.sun.star.sdbc.XPreparedBatchExecution	</type>
+	<type>	com.sun.star.sdbc.XParameters				</type>
+	<type>	com.sun.star.sdbc.XOutParameters			</type>
+	<type>	com.sun.star.sdbc.DriverPropertyInfo		</type>
+	<type>	com.sun.star.sdbc.SQLWarning				</type>
+	<type>	com.sun.star.sdbc.XRow						</type>
+	<type>	com.sun.star.sdbc.ColumnSearch				</type>
+	<type>	com.sun.star.sdbc.ColumnValue				</type>
+	<type>	com.sun.star.sdbc.DataType					</type>
+	<type>	com.sun.star.sdbc.XDriver					</type>
+	<type>	com.sun.star.sdbc.TransactionIsolation		</type>
+	<type>	com.sun.star.sdbc.ResultSetType				</type>
+	<type>	com.sun.star.sdbc.ResultSetConcurrency		</type>
+	<type>	com.sun.star.sdbcx.XRowLocate				</type>
+	<type>	com.sun.star.sdbcx.XDeleteRows				</type>
+	<type>	com.sun.star.sdbcx.CompareBookmark			</type>
+	<type>	com.sun.star.sdb.XColumnUpdate				</type>
+	<type>	com.sun.star.sdb.XColumn					</type>
+</module-description>
Index: mysqlc/source/registry/data/org/openoffice/Office/DataAccess/Drivers.xcu
===================================================================
--- mysqlc/source/registry/data/org/openoffice/Office/DataAccess/Drivers.xcu	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/registry/data/org/openoffice/Office/DataAccess/Drivers.xcu	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,103 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--***********************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile: DataAccess.xcu,v $
+ * $Revision: 1.27 $
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************ -->
+<oor:component-data oor:name="Drivers" oor:package="org.openoffice.Office.DataAccess" xmlns:oor="http://openoffice.org/2001/registry" xmlns:xs="http://www.w3.org/2001/XMLSchema">
+  <node oor:name="Installed">
+    <node oor:name="sdbc:mysqlc:*" oor:op="replace">
+      <prop oor:name="Driver">
+        <value>com.sun.star.comp.sdbc.mysqlc.MysqlCDriver</value>
+      </prop>
+      <prop oor:name="DriverTypeDisplayName" oor:type="xs:string">
+        <value xml:lang="en-US">MySQL (Connector/OOo)</value>
+      </prop>
+      <node oor:name="Properties">
+        <node oor:name="CharSet" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:string">
+            <value></value>
+          </prop>
+        </node>
+        <node oor:name="LocalSocket" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:string">
+            <value></value>
+          </prop>
+        </node>
+        <node oor:name="NamedPipe" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:string">
+            <value></value>
+          </prop>
+        </node>
+      </node>
+      <node oor:name="Features">
+        <node oor:name="UseKeywordAsBeforeAlias" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="IgnoreDriverPrivileges" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="DisplayVersionColumns" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="UseDOSLineEnds" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="BooleanComparisonMode" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="FormsCheckRequiredFields" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+      </node>
+      <node oor:name="MetaData">
+        <node oor:name="SupportsTableCreation" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:boolean">
+            <value>true</value>
+          </prop>
+        </node>
+        <node oor:name="Authentication" oor:op="replace">
+          <prop oor:name="Value" oor:type="xs:string">
+            <value>UserPassword</value>
+          </prop>
+        </node>
+      </node>
+    </node>
+  </node>
+</oor:component-data>
Index: mysqlc/source/mysqlc_subcomponent.hxx
===================================================================
--- mysqlc/source/mysqlc_subcomponent.hxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_subcomponent.hxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,255 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_subcomponent.hxx,v $
+*
+* $Revision: 1.1.2.2 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef _CONNECTIVITY_OSUBCOMPONENT_HXX_
+#define _CONNECTIVITY_OSUBCOMPONENT_HXX_
+
+#ifndef _CPPUHELPER_WEAK_HXX_
+#include <cppuhelper/weak.hxx>
+#endif
+#ifndef _CPPUHELPER_INTERFACECONTAINER_H_ 
+#include <cppuhelper/interfacecontainer.h>
+#endif
+#ifndef _COM_SUN_STAR_LANG_DISPOSEDEXCEPTION_HPP_
+#include <com/sun/star/lang/DisposedException.hpp>
+#endif
+#ifndef _CPPUHELPER_PROPSHLP_HXX 
+#include <cppuhelper/propshlp.hxx>
+#endif
+#ifndef _OSL_MUTEX_HXX_
+#include <osl/mutex.hxx>
+#endif
+#ifndef _OSL_DIAGNOSE_H_
+#include <osl/diagnose.h>
+#endif
+
+namespace cppu {
+	class IPropertyArrayHelper;
+}
+
+namespace com
+{
+	namespace sun
+	{
+		namespace star
+		{
+			namespace lang
+			{
+				class XComponent;
+			}
+		}
+	}
+}
+namespace connectivity
+{
+
+	namespace mysqlc
+	{
+		void release(oslInterlockedCount& _refCount,
+					 ::cppu::OBroadcastHelper& rBHelper,
+					 ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _xInterface,
+					 ::com::sun::star::lang::XComponent* _pObject);
+
+		void checkDisposed(sal_Bool _bThrow) throw (::com::sun::star::lang::DisposedException);
+		//************************************************************
+		// OSubComponent
+		//************************************************************
+		template <class SELF, class WEAK> class OSubComponent
+		{
+		protected:
+			// the parent must support the tunnel implementation
+			::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > m_xParent;
+			SELF*	m_pDerivedImplementation;
+
+		public:
+			OSubComponent(
+					const ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >& _xParent,
+					SELF* _pDerivedImplementation)
+				:m_xParent(_xParent)
+				,m_pDerivedImplementation(_pDerivedImplementation)
+			{
+			}
+
+		protected:
+			void dispose_ChildImpl()
+			{
+				::osl::MutexGuard aGuard(m_pDerivedImplementation->rBHelper.rMutex);
+				m_xParent = NULL;
+			}
+			void relase_ChildImpl()
+			{
+				release(m_pDerivedImplementation->m_refCount,
+										m_pDerivedImplementation->rBHelper,
+										m_xParent,
+										m_pDerivedImplementation);
+
+				m_pDerivedImplementation->WEAK::release();
+			}
+		};
+
+
+		template <class TYPE>
+		class OPropertyArrayUsageHelper
+		{
+		protected:
+			static sal_Int32						s_nRefCount;
+			static ::cppu::IPropertyArrayHelper*	s_pProps;
+			static ::osl::Mutex						s_aMutex;
+
+		public:
+			OPropertyArrayUsageHelper();
+			virtual ~OPropertyArrayUsageHelper()
+			{	// ARGHHHHHHH ..... would like to implement this in proparrhlp_impl.hxx (as we do with all other methods)
+				// but SUNPRO 5 compiler (linker) doesn't like this
+				::osl::MutexGuard aGuard(s_aMutex);
+				OSL_ENSURE(s_nRefCount > 0, "OPropertyArrayUsageHelper::~OPropertyArrayUsageHelper : suspicious call : have a refcount of 0 !");
+				if (!--s_nRefCount)
+				{
+					delete s_pProps;
+					s_pProps = NULL;
+				}
+			}
+
+			/** call this in the getInfoHelper method of your derived class. The method returns the array helper of the
+				class, which is created if neccessary.
+			*/
+			::cppu::IPropertyArrayHelper*	getArrayHelper();
+
+		protected:
+			/** used to implement the creation of the array helper which is shared amongst all instances of the class.
+				This method needs to be implemented in derived classes.
+				<BR>
+				The method gets called with s_aMutex acquired.
+				<BR>
+				as long as IPropertyArrayHelper has no virtual destructor, the implementation of ~OPropertyArrayUsageHelper
+				assumes that you created an ::cppu::OPropertyArrayHelper when deleting s_pProps.
+				@return							an pointer to the newly created array helper. Must not be NULL.
+			*/
+			virtual ::cppu::IPropertyArrayHelper* createArrayHelper() const = 0;
+		};
+
+		template<class TYPE> 
+		sal_Int32						OPropertyArrayUsageHelper< TYPE >::s_nRefCount	= 0;
+
+		template<class TYPE> 
+		::cppu::IPropertyArrayHelper*	OPropertyArrayUsageHelper< TYPE >::s_pProps	= NULL;
+
+		template<class TYPE> 
+		::osl::Mutex					OPropertyArrayUsageHelper< TYPE >::s_aMutex;
+
+		//------------------------------------------------------------------
+		template <class TYPE>
+		OPropertyArrayUsageHelper<TYPE>::OPropertyArrayUsageHelper()
+		{
+			::osl::MutexGuard aGuard(s_aMutex);
+			++s_nRefCount;
+		}
+
+		//------------------------------------------------------------------
+		template <class TYPE>
+		::cppu::IPropertyArrayHelper* OPropertyArrayUsageHelper<TYPE>::getArrayHelper()
+		{
+			OSL_ENSURE(s_nRefCount, "OPropertyArrayUsageHelper::getArrayHelper : suspicious call : have a refcount of 0 !");
+			if (!s_pProps) {
+				::osl::MutexGuard aGuard(s_aMutex);
+				if (!s_pProps) {
+					s_pProps = createArrayHelper();
+					OSL_ENSURE(s_pProps, "OPropertyArrayUsageHelper::getArrayHelper : createArrayHelper returned nonsense !");
+				}
+			}
+			return s_pProps;
+		}
+
+
+		class OBase_Mutex
+		{
+		public:
+			::osl::Mutex m_aMutex;
+		};
+
+		namespace internal
+		{
+			template <class T>
+			void implCopySequence(const T* _pSource, T*& _pDest, sal_Int32 _nSourceLen)
+			{
+				for (sal_Int32 i=0; i<_nSourceLen; ++i, ++_pSource, ++_pDest)
+					*_pDest = *_pSource;
+			}
+		}
+		//-------------------------------------------------------------------------
+		/// concat two sequences
+		template <class T>
+		::com::sun::star::uno::Sequence<T> concatSequences(const ::com::sun::star::uno::Sequence<T>& _rLeft, const ::com::sun::star::uno::Sequence<T>& _rRight)
+		{
+			sal_Int32 nLeft(_rLeft.getLength()), nRight(_rRight.getLength());
+			const T* pLeft = _rLeft.getConstArray();
+			const T* pRight = _rRight.getConstArray();
+
+			sal_Int32 nReturnLen(nLeft + nRight);
+			::com::sun::star::uno::Sequence<T> aReturn(nReturnLen);
+			T* pReturn = aReturn.getArray();
+
+			internal::implCopySequence(pLeft, pReturn, nLeft);
+			internal::implCopySequence(pRight, pReturn, nRight);
+
+			return aReturn;
+		}
+
+
+#define DECLARE_SERVICE_INFO()	\
+	virtual ::rtl::OUString SAL_CALL getImplementationName() throw (::com::sun::star::uno::RuntimeException);	\
+	virtual sal_Bool SAL_CALL supportsService(const ::rtl::OUString& ServiceName) throw(::com::sun::star::uno::RuntimeException);	\
+	virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames() throw(::com::sun::star::uno::RuntimeException)	\
+
+#define IMPLEMENT_SERVICE_INFO(classname, implasciiname, serviceasciiname)	\
+	::rtl::OUString SAL_CALL classname::getImplementationName() throw (::com::sun::star::uno::RuntimeException)	\
+	{	\
+		return ::rtl::OUString::createFromAscii(implasciiname);	\
+	}	\
+	::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL classname::getSupportedServiceNames() throw(::com::sun::star::uno::RuntimeException)	\
+	{	\
+		::com::sun::star::uno::Sequence< ::rtl::OUString > aSupported(1);	\
+		aSupported[0] = ::rtl::OUString::createFromAscii(serviceasciiname);	\
+		return aSupported;	\
+	}	\
+	sal_Bool SAL_CALL classname::supportsService(const ::rtl::OUString& _rServiceName) throw(::com::sun::star::uno::RuntimeException)	\
+	{	\
+		Sequence< ::rtl::OUString > aSupported(getSupportedServiceNames());				\
+		const ::rtl::OUString* pSupported = aSupported.getConstArray();					\
+		const ::rtl::OUString* pEnd = pSupported + aSupported.getLength();				\
+		for (;pSupported != pEnd && !pSupported->equals(_rServiceName); ++pSupported)	\
+			;																			\
+		return pSupported != pEnd;														\
+	}	\
+
+
+	}
+}
+#endif // _CONNECTIVITY_OSUBCOMPONENT_HXX_
+
Index: mysqlc/source/mysqlc_propertyids.cxx
===================================================================
--- mysqlc/source/mysqlc_propertyids.cxx	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/source/mysqlc_propertyids.cxx	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,210 @@
+/*************************************************************************
+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+* 
+* Copyright 2008 by Sun Microsystems, Inc.
+*
+* OpenOffice.org - a multi-platform office productivity suite
+*
+* $RCSfile: mysqlc_propertyids.cxx,v $
+*
+* $Revision: 1.1.2.2 $
+*
+* This file is part of OpenOffice.org.
+*
+* OpenOffice.org is free software: you can redistribute it and/or modify
+* it under the terms of the GNU Lesser General Public License version 3
+* only, as published by the Free Software Foundation.
+*
+* OpenOffice.org is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+* GNU Lesser General Public License version 3 for more details
+* (a copy is included in the LICENSE file that accompanied this code).
+*
+* You should have received a copy of the GNU Lesser General Public License
+* version 3 along with OpenOffice.org.  If not, see
+* <http://www.openoffice.org/license.html>
+* for a copy of the LGPLv3 License.
+************************************************************************/
+
+#ifndef _OSL_DIAGNOSE_H_
+#include <osl/diagnose.h>
+#endif
+#include "mysqlc_propertyids.hxx"
+
+using ::rtl::OUString;
+
+namespace connectivity
+{
+namespace mysqlc
+{
+const sal_Char* getPROPERTY_QUERYTIMEOUT()			{ return "QueryTimeOut"; }
+const sal_Char* getPROPERTY_MAXFIELDSIZE()			{ return "MaxFieldSize"; }
+const sal_Char* getPROPERTY_MAXROWS()				{ return "MaxRows"; }
+const sal_Char* getPROPERTY_CURSORNAME()			{ return "CursorName"; }
+const sal_Char* getPROPERTY_RESULTSETCONCURRENCY()	{ return "ResultSetConcurrency"; }
+const sal_Char* getPROPERTY_RESULTSETTYPE()			{ return "ResultSetType"; }
+const sal_Char* getPROPERTY_FETCHDIRECTION()		{ return "FetchDirection"; }
+const sal_Char* getPROPERTY_FETCHSIZE()				{ return "FetchSize"; }
+const sal_Char* getPROPERTY_ESCAPEPROCESSING()		{ return "EscapeProcessing"; }
+const sal_Char* getPROPERTY_USEBOOKMARKS()			{ return "UseBookmarks"; }
+
+const sal_Char* getPROPERTY_NAME()					{ return "Name"; }
+const sal_Char* getPROPERTY_TYPE()					{ return "Type"; }
+const sal_Char* getPROPERTY_TYPENAME()				{ return "TypeName"; }
+const sal_Char* getPROPERTY_PRECISION()				{ return "Precision"; }
+const sal_Char* getPROPERTY_SCALE()					{ return "Scale"; }
+const sal_Char* getPROPERTY_ISNULLABLE()			{ return "IsNullable"; }
+const sal_Char* getPROPERTY_ISAUTOINCREMENT()		{ return "IsAutoIncrement"; }
+const sal_Char* getPROPERTY_ISROWVERSION()			{ return "IsRowVersion"; }
+const sal_Char* getPROPERTY_DESCRIPTION()			{ return "Description"; }
+const sal_Char* getPROPERTY_DEFAULTVALUE()			{ return "DefaultValue"; }
+
+const sal_Char* getPROPERTY_REFERENCEDTABLE()		{ return "ReferencedTable"; }
+const sal_Char* getPROPERTY_UPDATERULE()			{ return "UpdateRule"; }
+const sal_Char* getPROPERTY_DELETERULE()			{ return "DeleteRule"; }
+const sal_Char* getPROPERTY_CATALOG()				{ return "Catalog"; }
+const sal_Char* getPROPERTY_ISUNIQUE()				{ return "IsUnique"; }
+const sal_Char* getPROPERTY_ISPRIMARYKEYINDEX()		{ return "IsPrimaryKeyIndex"; }
+const sal_Char* getPROPERTY_ISCLUSTERED()			{ return "IsClustered"; }
+const sal_Char* getPROPERTY_ISASCENDING()			{ return "IsAscending"; }
+const sal_Char* getPROPERTY_SCHEMANAME()			{ return "SchemaName"; }
+const sal_Char* getPROPERTY_CATALOGNAME()			{ return "CatalogName"; }
+const sal_Char* getPROPERTY_COMMAND()				{ return "Command"; }
+const sal_Char* getPROPERTY_CHECKOPTION()			{ return "CheckOption"; }
+const sal_Char* getPROPERTY_PASSWORD()				{ return "Password"; }
+const sal_Char* getPROPERTY_RELATEDCOLUMN()			{ return "RelatedColumn"; }
+
+const sal_Char* getSTAT_INVALID_INDEX()				{ return "Invalid descriptor index"; }
+
+const sal_Char* getPROPERTY_FUNCTION()				{ return "Function"; }
+const sal_Char* getPROPERTY_TABLENAME()				{ return "TableName"; }
+const sal_Char* getPROPERTY_REALNAME()				{ return "RealName"; }
+const sal_Char* getPROPERTY_DBASEPRECISIONCHANGED()	{ return "DbasePrecisionChanged"; }
+const sal_Char* getPROPERTY_ISCURRENCY()			{ return "IsCurrency"; }
+const sal_Char* getPROPERTY_ISBOOKMARKABLE()		{ return "IsBookmarkable"; }
+
+const sal_Char* getPROPERTY_FORMATKEY()				{ return "FormatKey"; }
+const sal_Char* getPROPERTY_LOCALE()				{ return "Locale"; }
+
+const sal_Char* getPROPERTY_AUTOINCREMENTCREATION()	{ return "AutoIncrementCreation"; }
+const sal_Char* getPROPERTY_PRIVILEGES()			{ return "Privileges"; }
+	//============================================================
+	//= error messages
+	//============================================================
+const sal_Char* getERRORMSG_SEQUENCE()				{ return "Function sequence error"; }
+const sal_Char* getSQLSTATE_SEQUENCE()				{ return "HY010"; }
+const sal_Char* getSQLSTATE_GENERAL()				{ return "HY0000"; }
+const sal_Char* getSTR_DELIMITER()					{ return "/"; }
+
+
+
+/* {{{ OPropertyMap::~OPropertyMap() -I- */
+OPropertyMap::~OPropertyMap()
+{
+	::std::map<sal_Int32 , rtl_uString*>::iterator aIter = m_aPropertyMap.begin();
+	for(; aIter != m_aPropertyMap.end(); ++aIter) {
+		if (aIter->second) {
+			rtl_uString_release(aIter->second);
+		}
+	}
+}
+/* }}} */
+
+
+/* {{{ OPropertyMap::getNameByIndex() -I- */
+OUString OPropertyMap::getNameByIndex(sal_Int32 idx) const
+{
+	OUString sRet;
+	::std::map<sal_Int32 , rtl_uString*>::const_iterator aIter = m_aPropertyMap.find(idx);
+	if (aIter == m_aPropertyMap.end()) {
+		sRet = const_cast<OPropertyMap*>(this)->fillValue(idx);
+	} else {
+		sRet = aIter->second;
+	}
+	return sRet;
+}
+/* }}} */
+
+typedef const sal_Char * (*property_callback)();
+
+static const property_callback property_callbacks[PROPERTY_ID_LAST] =
+{
+	NULL, /* PROPERTY_ID_FIRST */
+	getPROPERTY_QUERYTIMEOUT,
+	getPROPERTY_MAXFIELDSIZE,
+	getPROPERTY_MAXROWS,
+	getPROPERTY_CURSORNAME,
+	getPROPERTY_RESULTSETCONCURRENCY,
+	getPROPERTY_RESULTSETTYPE,
+	getPROPERTY_FETCHDIRECTION,
+	getPROPERTY_FETCHSIZE,
+	getPROPERTY_ESCAPEPROCESSING,
+	getPROPERTY_USEBOOKMARKS,
+	// Column
+	getPROPERTY_NAME,
+	getPROPERTY_TYPE,
+	getPROPERTY_TYPENAME,
+	getPROPERTY_PRECISION,
+	getPROPERTY_SCALE,
+	getPROPERTY_ISNULLABLE,
+	getPROPERTY_ISAUTOINCREMENT,
+	getPROPERTY_ISROWVERSION,
+	getPROPERTY_DESCRIPTION,
+	getPROPERTY_DEFAULTVALUE,
+
+	getPROPERTY_REFERENCEDTABLE,
+	getPROPERTY_UPDATERULE,
+	getPROPERTY_DELETERULE,
+	getPROPERTY_CATALOG,
+	getPROPERTY_ISUNIQUE,
+	getPROPERTY_ISPRIMARYKEYINDEX,
+	getPROPERTY_ISCLUSTERED,
+	getPROPERTY_ISASCENDING,
+	getPROPERTY_SCHEMANAME,
+	getPROPERTY_CATALOGNAME,
+
+	getPROPERTY_COMMAND,
+	getPROPERTY_CHECKOPTION,
+	getPROPERTY_PASSWORD,
+	getPROPERTY_RELATEDCOLUMN,
+
+	getPROPERTY_FUNCTION,
+	getPROPERTY_TABLENAME,
+	getPROPERTY_REALNAME,
+	getPROPERTY_DBASEPRECISIONCHANGED,
+	getPROPERTY_ISCURRENCY,
+	getPROPERTY_ISBOOKMARKABLE,
+	getSTAT_INVALID_INDEX,
+	getERRORMSG_SEQUENCE,
+	getSQLSTATE_SEQUENCE,
+	getSQLSTATE_GENERAL,
+	getSTR_DELIMITER,
+	getPROPERTY_FORMATKEY,
+	getPROPERTY_LOCALE,
+	getPROPERTY_AUTOINCREMENTCREATION,
+	getPROPERTY_PRIVILEGES,
+};
+
+
+/* {{{ OPropertyMap::fillValue() -I- */
+OUString OPropertyMap::fillValue(sal_Int32 idx)
+{
+	rtl_uString* pStr = NULL;
+	rtl_uString_newFromAscii(&pStr, property_callbacks[idx]());
+	m_aPropertyMap[idx] = pStr;
+	return pStr;
+}
+/* }}} */
+
+} /* mysqlc */
+} /* connectivity */
+
+/*
+ * Local variables:
+ * tab-width: 4
+ * c-basic-offset: 4
+ * End:
+ * vim600: noet sw=4 ts=4 fdm=marker
+ * vim<600: noet sw=4 ts=4
+ */
Index: mysqlc/prj/build.lst
===================================================================
--- mysqlc/prj/build.lst	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/prj/build.lst	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,3 @@
+mc	mysqlc	:	solenv MYSQLCPPCONN:mysqlcppconn offuh cppu soltools cppuhelper readlicense_oo NULL
+ch	mysqlc              usr1    -	all mc_mkout NULL
+mc	mysqlc\source       nmake   -   all mc_source NULL

Index: mysqlc/prj/d.lst
===================================================================
--- mysqlc/prj/d.lst	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/prj/d.lst	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,4 @@
+# Extensions
+
+..\%__SRC%\bin\*.oxt %_DEST%\bin%_EXT%\*.oxt
+

Index: mysqlc/version.mk
===================================================================
--- mysqlc/version.mk	(.../tags/OOO310_m10)	(Revision 0)
+++ mysqlc/version.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,38 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+MYSQLC_VERSION_MAJOR=1
+MYSQLC_VERSION_MINOR=0
+MYSQLC_VERSION_MICRO=0
+
+# the title, as displayed in the Extension Manager
+MYSQLC_TITLE=MySQL Connector for OpenOffice.org
+
+# the status of the extension
+# if this is different from "final", it will be appended to the title displayed in the Extension Manager
+# and also added to the file name of the resulting .oxt file
+MYSQLC_STATUS=final

Index: configure.in
===================================================================
--- configure.in	(.../tags/OOO310_m10)	(Revision 275542)
+++ configure.in	(.../cws/mysqlnative)	(Revision 275542)
@@ -363,6 +363,23 @@
 [  --with-lucene-analyzers-jar=JARFILE   Specify path to jarfile manually ],
 [ LUCENE_ANALYZERS_JAR="$withval"
 ])
+AC_ARG_ENABLE(mysql-connector,
+[  --enable-mysql-connector     enables the build of the MySQL Connector/OOo extension.
+                                This requires access to the MySQL Connector/C (aka libmysql) to be given, too, with
+                                either the --with-system-mysql or --with-libmysql-path option.
+],,)
+AC_ARG_WITH(system-mysql,
+[  --with-system-mysql          Use MySQL libraries already on system, for building the MySQL Connector/OOo extension.
+                                Requires MYSQLCONFIG to point to the mysql_config executable.
+],,with_system_mysql="no")
+AC_ARG_WITH(libmysql-path,
+[  --with-libmysql-path         Use Connector/C (libmysql) installation for building the MySQL Connector/OOo extension.
+
+                                Usage: --with-libmysql-path=<absolute path to your Connector/C installation>
+],,)
+AC_ARG_WITH(system-mysql-cppconn,
+[  --with-system-mysql-cppconn  Use MySQL C++ Connector libraries already on system
+],,)
 AC_ARG_WITH(system-hsqldb,
 [  --with-system-hsqldb    Use hsqldb already on system
 ],,)
@@ -3704,7 +3721,129 @@
 AC_SUBST(LUCENE_CORE_JAR)
 AC_SUBST(LUCENE_ANALYZERS_JAR)
 
+AC_MSG_CHECKING([whether to build the MySQL Connector extension])
+if test -n "$enable_mysql_connector" -a "$enable_mysql_connector" != "no"; then
+  AC_MSG_RESULT([yes])
+  ENABLE_MYSQLC=YES
+  AC_MSG_CHECKING([for mysqlc module])
+  if test -d mysqlc; then
+   AC_MSG_RESULT([OK])
+  else
+   AC_MSG_ERROR([not existing. get it (did you get the -extensions tarball?)])
+  fi
+  BUILD_TYPE="$BUILD_TYPE MYSQLC"
+else
+  AC_MSG_RESULT([no])
+  ENABLE_MYSQLC=NO
+fi
+AC_SUBST(ENABLE_MYSQLC)
+
+if test "$ENABLE_MYSQLC" = "YES"; then
 dnl ===================================================================
+dnl Check for system MySQL
+dnl ===================================================================
+AC_MSG_CHECKING([for mysql pre-requisites])
+if test -n "$with_system_mysql" -o -n "$with_system_libs" && \
+       test "$with_system_mysql" != "no" && test "$with_system_libs" != "no"; then
+	AC_MSG_RESULT([external MySQL])
+	SYSTEM_MYSQL=YES
+	AC_PATH_PROG( MYSQLCONFIG, mysql_config)
+	AC_MSG_CHECKING([MySQL version])
+	MYSQL_VERSION=`$MYSQLCONFIG --version` 
+	MYSQL_MAJOR=`$MYSQLCONFIG --version | cut -d"." -f1`
+	if test "$MYSQL_MAJOR" -ge "5"; then
+		AC_MSG_RESULT([OK])
+	else
+		AC_MSG_ERROR([too old, use 5.0.x or 5.1.x])
+	fi
+	AC_MSG_CHECKING([for MySQL Client library])
+	MYSQL_INC=`$MYSQLCONFIG --include` 
+	MYSQL_LIB=`$MYSQLCONFIG --libs`
+	MYSQL_DEFINES=`$MYSQLCONFIG --cflags | sed -e s,$MYSQL_INC,,`
+	AC_MSG_RESULT([includes $MYSQL_INC, libraries $MYSQL_LIB])
+else
+    SYSTEM_MYSQL=NO
+    if test -n "$with_libmysql_path"; then
+        AC_MSG_RESULT([external Connector/C (libmysql)])
+        LIBMYSQL=libmysql.so
+        if test "$_os" = "Darwin"; then
+            LIBMYSQL=libmysql.dylib
+        elif test "$_os" = "WINNT"; then
+            LIBMYSQL=libmysql.dll
+        fi
+        AC_MSG_CHECKING([for $LIBMYSQL])
+        if test -e "$with_libmysql_path/lib/$LIBMYSQL"; then
+            AC_MSG_RESULT([found.])
+            LIBMYSQL_PATH=$with_libmysql_path
+        else
+            AC_MSG_ERROR([not found. Please specify proper path in --with-libmysql-path.])
+        fi
+    else
+        AC_MSG_ERROR([not given. Please specify either --with-system-mysql or --with-libmysql-path])
+    fi
+fi
+AC_SUBST(SYSTEM_MYSQL)
+AC_SUBST(MYSQL_INC)
+AC_SUBST(MYSQL_LIB)
+AC_SUBST(MYSQL_DEFINES)
+AC_SUBST(LIBMYSQL_PATH)
+
+AC_LANG_PUSH([C++])
+dnl ===================================================================
+dnl Check for system MySQL C++ Connector
+dnl ===================================================================
+# FIXME!
+# who thought this too-generic cppconn dir was a good idea?
+AC_MSG_CHECKING([MySQL Connector/C++])
+if test -n "$with_system_mysql_cppconn" -o -n "$with_system_libs" && \
+		test "$with_system_mysql_cppconn" != "no" && test "$with_system_libs" != "no"; then
+	AC_MSG_RESULT([external])
+	SYSTEM_MYSQL_CPPCONN=YES
+        AC_LANG_PUSH([C++])
+	AC_CHECK_HEADER(mysql_driver.h, [],
+					[AC_MSG_ERROR(mysql_driver.h not found. install MySQL C++ Connectivity)], [])
+	AC_CHECK_LIB(mysqlcppconn, main, [],
+					[AC_MSG_ERROR(MySQL C++ Connectivity lib not found or functional)], [])
+   AC_MSG_CHECKING([version])
+      AC_TRY_RUN([
+#include <mysql_driver.h>
+
+int main(int argc, char **argv) {
+	sql::Driver *driver;
+	driver = get_driver_instance();
+	if (driver->getMajorVersion() > 1 || \
+	   (driver->getMajorVersion() == 1 && driver->getMinorVersion() > 0) || \
+	   (driver->getMajorVersion() == 1 && driver->getMinorVersion() == 0 && driver->getPatchVersion() >= 6)) 
+        return 0;
+      else
+        return 1;
+}
+      ], [AC_MSG_RESULT(OK)], [AC_MSG_ERROR([not suitable, we need >= 1.0.6])])
+        AC_LANG_POP([C++])
+
+	AC_MSG_CHECKING([STL compatibility])
+	if test "$WITH_STLPORT" != "no"; then
+		AC_MSG_ERROR([to use system mysqlcppconn you need to use --without-stlport])
+	else
+		AC_MSG_RESULT([OK])	
+	fi
+
+else
+	AC_MSG_RESULT([internal])
+        AC_MSG_CHECKING([for mysqlcppconn module])
+        if test -d mysqlcppconn; then
+          AC_MSG_RESULT([OK])
+        else
+          AC_MSG_ERROR([not existing. get it (did you get the -extensions tarball?)])
+        fi
+	BUILD_TYPE="$BUILD_TYPE MYSQLCPPCONN"
+	SYSTEM_MYSQL_CPPCONN=NO
+fi
+AC_LANG_POP([C++])
+AC_SUBST(SYSTEM_MYSQL_CPPCONN)
+fi
+
+dnl ===================================================================
 dnl Check for system hsqldb
 dnl ===================================================================
 AC_MSG_CHECKING([which hsqldb to use])
Index: connectivity/qa/jdbc/makefile.mk
===================================================================
--- connectivity/qa/jdbc/makefile.mk	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/makefile.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,60 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# $RCSfile$
+#
+# $Revision$
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+PRJ	= ..$/..
+PRJNAME = connectivity
+TARGET  = jdbc-sdbc
+PACKAGE = org$/openoffice$/jdbc
+# --- Settings -----------------------------------------------------
+.INCLUDE: settings.mk
+
+#----- compile .java files -----------------------------------------
+JARFILES        = ridl.jar unoil.jar jurt.jar juh.jar jut.jar java_uno.jar OOoRunner.jar
+
+JAVAFILES       := $(shell @$(FIND) . -name "*.java")
+
+JAVACLASSFILES	= $(foreach,i,$(JAVAFILES) $(CLASSDIR)$/$(PACKAGE)$/$(i:s/.java/.class/))
+
+
+		
+#----- make a jar from compiled files ------------------------------
+
+JARCLASSDIRS    = $(PACKAGE)
+JARTARGET       = $(TARGET).jar
+JARCOMPRESS 	= TRUE
+# CUSTOMMANIFESTFILE = Manifest.mf
+
+
+# --- Targets ------------------------------------------------------
+.INCLUDE :  target.mk
+
+run:
+	java -cp jdbc-sdbc.jar$(PATH_SEPERATOR)$(CLASSPATH)$(PATH_SEPERATOR)$(SOLARBINDIR)$/OOoRunner.jar org.openoffice.Runner -TestBase java_complex -o complex.connectivity.OOoDriverTest
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoCallableStatement.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoCallableStatement.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoCallableStatement.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,786 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.sdbc.XOutParameters;
+import com.sun.star.sdbc.XRow;
+import com.sun.star.uno.UnoRuntime;
+import java.io.InputStream;
+import java.io.Reader;
+import java.math.BigDecimal;
+import java.net.URL;
+import java.sql.Array;
+import java.sql.Blob;
+import java.sql.Clob;
+import java.sql.Date;
+import java.sql.NClob;
+import java.sql.Ref;
+import java.sql.RowId;
+import java.sql.SQLException;
+import java.sql.SQLXML;
+import java.sql.Time;
+import java.sql.Timestamp;
+import java.util.Calendar;
+import java.util.Map;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoCallableStatement extends OOoPreparedStatement implements java.sql.CallableStatement
+{
+
+    final private XOutParameters out;
+    final private XRow row;
+
+    OOoCallableStatement(OOoConnection con, Object state) throws SQLException
+    {
+        super(con, state);
+        out = (XOutParameters) UnoRuntime.queryInterface(XOutParameters.class, state);
+        row = (XRow) UnoRuntime.queryInterface(XRow.class, state);
+    }
+
+    public void registerOutParameter(int parameterIndex, int sqlType) throws SQLException
+    {
+        try
+        {
+            out.registerOutParameter(parameterIndex, sqlType, "");
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void registerOutParameter(int parameterIndex, int sqlType, int scale) throws SQLException
+    {
+        try
+        {
+            out.registerNumericOutParameter(parameterIndex, sqlType, scale);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean wasNull() throws SQLException
+    {
+        try
+        {
+            return row.wasNull();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getString(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getString(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean getBoolean(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getBoolean(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public byte getByte(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getByte(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public short getShort(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getShort(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getInt(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getInt(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public long getLong(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getLong(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public float getFloat(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getFloat(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public double getDouble(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getDouble(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public BigDecimal getBigDecimal(int parameterIndex, int scale) throws SQLException
+    {
+        return new BigDecimal(getString(parameterIndex));
+    }
+
+    public byte[] getBytes(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return row.getBytes(parameterIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Date getDate(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return (Date) OOoResultSet.convertToJava(row.getDate(parameterIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Time getTime(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return (Time) OOoResultSet.convertToJava(row.getTime(parameterIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Timestamp getTimestamp(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return (Timestamp) OOoResultSet.convertToJava(row.getTimestamp(parameterIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object getObject(int parameterIndex) throws SQLException
+    {
+        try
+        {
+            return OOoResultSet.convertToJava(row.getObject(parameterIndex, null));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public BigDecimal getBigDecimal(int parameterIndex) throws SQLException
+    {
+        return new BigDecimal(getString(parameterIndex));
+    }
+
+    public Ref getRef(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Blob getBlob(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Clob getClob(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Array getArray(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Date getDate(int parameterIndex, Calendar cal) throws SQLException
+    {
+        return getDate(parameterIndex);
+    }
+
+    public Time getTime(int parameterIndex, Calendar cal) throws SQLException
+    {
+        return getTime(parameterIndex);
+    }
+
+    public Timestamp getTimestamp(int parameterIndex, Calendar cal) throws SQLException
+    {
+        return getTimestamp(parameterIndex);
+    }
+
+    public void registerOutParameter(int parameterIndex, int sqlType, String typeName) throws SQLException
+    {
+        try
+        {
+            out.registerOutParameter(sqlType, sqlType, typeName);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void registerOutParameter(String parameterName, int sqlType) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void registerOutParameter(String parameterName, int sqlType, int scale) throws SQLException
+    {
+        try
+        {
+            out.registerOutParameter(sqlType, scale, parameterName);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            ex.printStackTrace();
+        }
+    }
+
+    public void registerOutParameter(String parameterName, int sqlType, String typeName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public URL getURL(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setURL(String parameterName, URL val) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNull(String parameterName, int sqlType) throws SQLException
+    {
+    }
+
+    public void setBoolean(String parameterName, boolean x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setByte(String parameterName, byte x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setShort(String parameterName, short x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setInt(String parameterName, int x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setLong(String parameterName, long x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setFloat(String parameterName, float x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setDouble(String parameterName, double x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBigDecimal(String parameterName, BigDecimal x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setString(String parameterName, String x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBytes(String parameterName, byte[] x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setDate(String parameterName, Date x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setTime(String parameterName, Time x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setTimestamp(String parameterName, Timestamp x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setAsciiStream(String parameterName, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(String parameterName, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setObject(String parameterName, Object x, int targetSqlType, int scale) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setObject(String parameterName, Object x, int targetSqlType) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setObject(String parameterName, Object x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setCharacterStream(String parameterName, Reader reader, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setDate(String parameterName, Date x, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setTime(String parameterName, Time x, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setTimestamp(String parameterName, Timestamp x, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNull(String parameterName, int sqlType, String typeName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getString(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean getBoolean(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public byte getByte(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public short getShort(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int getInt(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public long getLong(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public float getFloat(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public double getDouble(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public byte[] getBytes(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Date getDate(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Time getTime(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Timestamp getTimestamp(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object getObject(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public BigDecimal getBigDecimal(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Ref getRef(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Blob getBlob(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Clob getClob(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Array getArray(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Date getDate(String parameterName, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Time getTime(String parameterName, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Timestamp getTimestamp(String parameterName, Calendar cal) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public URL getURL(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNString(String parameterName, String value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNCharacterStream(String parameterName, Reader value, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(String parameterName, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(String parameterName, InputStream inputStream, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(String parameterName, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getNString(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getNString(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getNCharacterStream(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getNCharacterStream(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getCharacterStream(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getCharacterStream(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(String parameterName, Blob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(String parameterName, Clob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setAsciiStream(String parameterName, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(String parameterName, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setCharacterStream(String parameterName, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setAsciiStream(String parameterName, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(String parameterName, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setCharacterStream(String parameterName, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNCharacterStream(String parameterName, Reader value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(String parameterName, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(String parameterName, InputStream inputStream) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(String parameterName, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object getObject(int i, Map map) throws SQLException
+    {
+        try
+        {
+            return row.getObject(i, null);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object getObject(String parameterName, Map map) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setRowId(int parameterIndex, RowId x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(int parameterIndex, NClob value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setSQLXML(int parameterIndex, SQLXML xmlObject) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public RowId getRowId(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public RowId getRowId(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setRowId(String parameterName, RowId x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(String parameterName, NClob value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public NClob getNClob(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public NClob getNClob(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setSQLXML(String parameterName, SQLXML xmlObject) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public SQLXML getSQLXML(int parameterIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public SQLXML getSQLXML(String parameterName) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoStatement.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoStatement.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoStatement.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,634 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.beans.PropertyVetoException;
+import com.sun.star.beans.UnknownPropertyException;
+import com.sun.star.beans.XPropertySet;
+import com.sun.star.lang.IllegalArgumentException;
+import com.sun.star.lang.WrappedTargetException;
+import com.sun.star.sdbc.XBatchExecution;
+import com.sun.star.sdbc.XCloseable;
+import com.sun.star.sdbc.XGeneratedResultSet;
+import com.sun.star.sdbc.XMultipleResults;
+import com.sun.star.sdbc.XStatement;
+import com.sun.star.sdbc.XWarningsSupplier;
+import com.sun.star.uno.UnoRuntime;
+import com.sun.star.util.XCancellable;
+import java.sql.Connection;
+import java.sql.ResultSet;
+import java.sql.SQLException;
+import java.sql.SQLWarning;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoStatement implements java.sql.Statement
+{
+
+    final protected OOoConnection con;
+    final protected XStatement statement;
+    final private XCloseable closeable;
+    final private XPropertySet prop;
+    final private XBatchExecution batchExecution;
+    final private XWarningsSupplier warning;
+    final private XCancellable cancel;
+    final private XMultipleResults mulRes;
+    final private XGeneratedResultSet genRes;
+    private boolean closed;
+
+    public OOoStatement(OOoConnection parent, Object state) throws SQLException
+    {
+        con = parent;
+        statement = (XStatement) UnoRuntime.queryInterface(XStatement.class, state);
+        closeable = (XCloseable) UnoRuntime.queryInterface(XCloseable.class, statement);
+        batchExecution = (XBatchExecution) UnoRuntime.queryInterface(XBatchExecution.class, statement);
+        warning = (XWarningsSupplier) UnoRuntime.queryInterface(XWarningsSupplier.class, statement);
+        cancel = (XCancellable) UnoRuntime.queryInterface(XCancellable.class, statement);
+        mulRes = (XMultipleResults) UnoRuntime.queryInterface(XMultipleResults.class, statement);
+        genRes = (XGeneratedResultSet) UnoRuntime.queryInterface(XGeneratedResultSet.class, statement);
+        prop = (XPropertySet) UnoRuntime.queryInterface(XPropertySet.class, statement);
+        closed = false;
+    }
+
+    public ResultSet executeQuery(String sql) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(this, statement.executeQuery(sql));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int executeUpdate(String sql) throws SQLException
+    {
+        try
+        {
+            return statement.executeUpdate(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void close() throws SQLException
+    {
+        try
+        {
+            closeable.close();
+            closed = true;
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxFieldSize() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("MaxFieldSize"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setMaxFieldSize(int max) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("MaxFieldSize", new Integer(max));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getMaxRows() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("MaxRows"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setMaxRows(int max) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("MaxRows", new Integer(max));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setEscapeProcessing(boolean enable) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("EscapeProcessing", Boolean.valueOf(enable));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getQueryTimeout() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("QueryTimeout"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setQueryTimeout(int seconds) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("QueryTimeout", new Integer(seconds));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void cancel() throws SQLException
+    {
+        cancel.cancel();
+    }
+
+    public SQLWarning getWarnings() throws SQLException
+    {
+        try
+        {
+            return (SQLWarning) OOoResultSet.convertToJava(warning.getWarnings());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void clearWarnings() throws SQLException
+    {
+        try
+        {
+            warning.clearWarnings();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setCursorName(String name) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("CursorName", new Integer(name));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public boolean execute(String sql) throws SQLException
+    {
+        try
+        {
+            return statement.execute(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getResultSet() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(this, mulRes.getResultSet());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getUpdateCount() throws SQLException
+    {
+        try
+        {
+            return mulRes.getUpdateCount();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean getMoreResults() throws SQLException
+    {
+        try
+        {
+            return mulRes.getMoreResults();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setFetchDirection(int direction) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("FetchDirection", new Integer(direction));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getFetchDirection() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("FetchDirection"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setFetchSize(int rows) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("FetchSize", new Integer(rows));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getFetchSize() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("FetchSize"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getResultSetConcurrency() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("ResultSetConcurrency"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getResultSetType() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("ResultSetType"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void addBatch(String sql) throws SQLException
+    {
+        try
+        {
+            batchExecution.addBatch(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void clearBatch() throws SQLException
+    {
+        try
+        {
+            batchExecution.clearBatch();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int[] executeBatch() throws SQLException
+    {
+        try
+        {
+            return batchExecution.executeBatch();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Connection getConnection() throws SQLException
+    {
+        return con;
+    }
+
+    public boolean getMoreResults(int current) throws SQLException
+    {
+        try
+        {
+            return mulRes.getMoreResults();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getGeneratedKeys() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(this, genRes.getGeneratedValues());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int executeUpdate(String sql, int autoGeneratedKeys) throws SQLException
+    {
+        try
+        {
+            return statement.executeUpdate(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int executeUpdate(String sql, int[] columnIndexes) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int executeUpdate(String sql, String[] columnNames) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean execute(String sql, int autoGeneratedKeys) throws SQLException
+    {
+        try
+        {
+            return statement.execute(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean execute(String sql, int[] columnIndexes) throws SQLException
+    {
+        try
+        {
+            return statement.execute(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean execute(String sql, String[] columnNames) throws SQLException
+    {
+        try
+        {
+            return statement.execute(sql);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getResultSetHoldability() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isClosed() throws SQLException
+    {
+        return closed;
+    }
+
+    public void setPoolable(boolean poolable) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isPoolable() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoDatabaseMetaData.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoDatabaseMetaData.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoDatabaseMetaData.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,1962 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.sdbc.XDatabaseMetaData;
+import com.sun.star.sdbc.XDatabaseMetaData2;
+import com.sun.star.uno.UnoRuntime;
+import java.sql.Connection;
+import java.sql.ResultSet;
+import java.sql.RowIdLifetime;
+import java.sql.SQLException;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoDatabaseMetaData implements java.sql.DatabaseMetaData
+{
+
+    final private XDatabaseMetaData md;
+    final private XDatabaseMetaData2 md2;
+    final private OOoConnection con;
+
+    OOoDatabaseMetaData(OOoConnection _con, XDatabaseMetaData _md)
+    {
+        con = _con;
+        md = _md;
+        md2 = (XDatabaseMetaData2) UnoRuntime.queryInterface(XDatabaseMetaData2.class, _md);
+    }
+
+    public boolean allProceduresAreCallable() throws SQLException
+    {
+        try
+        {
+            return md.allProceduresAreCallable();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean allTablesAreSelectable() throws SQLException
+    {
+        try
+        {
+            return md.allTablesAreSelectable();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getURL() throws SQLException
+    {
+        try
+        {
+            return md.getURL();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getUserName() throws SQLException
+    {
+        try
+        {
+            return md.getUserName();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isReadOnly() throws SQLException
+    {
+        try
+        {
+            return md.isReadOnly();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean nullsAreSortedHigh() throws SQLException
+    {
+        try
+        {
+            return md.nullsAreSortedHigh();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean nullsAreSortedLow() throws SQLException
+    {
+        try
+        {
+            return md.nullsAreSortedLow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean nullsAreSortedAtStart() throws SQLException
+    {
+        try
+        {
+            return md.nullsAreSortedAtStart();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean nullsAreSortedAtEnd() throws SQLException
+    {
+        try
+        {
+            return md.nullsAreSortedAtEnd();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getDatabaseProductName() throws SQLException
+    {
+        try
+        {
+            return md.getDatabaseProductName();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getDatabaseProductVersion() throws SQLException
+    {
+        try
+        {
+            return md.getDatabaseProductVersion();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getDriverName() throws SQLException
+    {
+        try
+        {
+            return md.getDriverName();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getDriverVersion() throws SQLException
+    {
+        try
+        {
+            return md.getDriverVersion();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getDriverMajorVersion()
+    {
+        return md.getDriverMajorVersion();
+    }
+
+    public int getDriverMinorVersion()
+    {
+        return md.getDriverMinorVersion();
+    }
+
+    public boolean usesLocalFiles() throws SQLException
+    {
+        try
+        {
+            return md.usesLocalFiles();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean usesLocalFilePerTable() throws SQLException
+    {
+        try
+        {
+            return md.usesLocalFilePerTable();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsMixedCaseIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.supportsMixedCaseIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesUpperCaseIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesUpperCaseIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesLowerCaseIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesLowerCaseIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesMixedCaseIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesMixedCaseIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsMixedCaseQuotedIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.supportsMixedCaseQuotedIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesUpperCaseQuotedIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesUpperCaseQuotedIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesLowerCaseQuotedIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesLowerCaseQuotedIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean storesMixedCaseQuotedIdentifiers() throws SQLException
+    {
+        try
+        {
+            return md.storesMixedCaseQuotedIdentifiers();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getIdentifierQuoteString() throws SQLException
+    {
+        try
+        {
+            return md.getIdentifierQuoteString();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getSQLKeywords() throws SQLException
+    {
+        try
+        {
+            return md.getSQLKeywords();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getNumericFunctions() throws SQLException
+    {
+        try
+        {
+            return md.getNumericFunctions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getStringFunctions() throws SQLException
+    {
+        try
+        {
+            return md.getStringFunctions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getSystemFunctions() throws SQLException
+    {
+        try
+        {
+            return md.getSystemFunctions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getTimeDateFunctions() throws SQLException
+    {
+        try
+        {
+            return md.getTimeDateFunctions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getSearchStringEscape() throws SQLException
+    {
+        try
+        {
+            return md.getSearchStringEscape();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getExtraNameCharacters() throws SQLException
+    {
+        try
+        {
+            return md.getExtraNameCharacters();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsAlterTableWithAddColumn() throws SQLException
+    {
+        try
+        {
+            return md.supportsAlterTableWithAddColumn();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsAlterTableWithDropColumn() throws SQLException
+    {
+        try
+        {
+            return md.supportsAlterTableWithDropColumn();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsColumnAliasing() throws SQLException
+    {
+        try
+        {
+            return md.supportsColumnAliasing();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean nullPlusNonNullIsNull() throws SQLException
+    {
+        try
+        {
+            return md.nullPlusNonNullIsNull();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsConvert() throws SQLException
+    {
+        try
+        {
+            return md.supportsConvert(0, 0);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsConvert(int fromType, int toType) throws SQLException
+    {
+        try
+        {
+            return md.supportsConvert(fromType, toType);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsTableCorrelationNames() throws SQLException
+    {
+        try
+        {
+            return md.supportsTableCorrelationNames();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsDifferentTableCorrelationNames() throws SQLException
+    {
+        try
+        {
+            return md.supportsDifferentTableCorrelationNames();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsExpressionsInOrderBy() throws SQLException
+    {
+        try
+        {
+            return md.supportsExpressionsInOrderBy();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOrderByUnrelated() throws SQLException
+    {
+        try
+        {
+            return md.supportsOrderByUnrelated();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsGroupBy() throws SQLException
+    {
+        try
+        {
+            return md.supportsGroupBy();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsGroupByUnrelated() throws SQLException
+    {
+        try
+        {
+            return md.supportsGroupByUnrelated();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsGroupByBeyondSelect() throws SQLException
+    {
+        try
+        {
+            return md.supportsGroupByBeyondSelect();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsLikeEscapeClause() throws SQLException
+    {
+        try
+        {
+            return md.supportsLikeEscapeClause();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsMultipleResultSets() throws SQLException
+    {
+        try
+        {
+            return md.supportsMultipleResultSets();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsMultipleTransactions() throws SQLException
+    {
+        try
+        {
+            return md.supportsMultipleTransactions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsNonNullableColumns() throws SQLException
+    {
+        try
+        {
+            return md.supportsNonNullableColumns();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsMinimumSQLGrammar() throws SQLException
+    {
+        try
+        {
+            return md.supportsMinimumSQLGrammar();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCoreSQLGrammar() throws SQLException
+    {
+        try
+        {
+            return md.supportsCoreSQLGrammar();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsExtendedSQLGrammar() throws SQLException
+    {
+        try
+        {
+            return md.supportsExtendedSQLGrammar();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsANSI92EntryLevelSQL() throws SQLException
+    {
+        try
+        {
+            return md.supportsANSI92EntryLevelSQL();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsANSI92IntermediateSQL() throws SQLException
+    {
+        try
+        {
+            return md.supportsANSI92IntermediateSQL();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsANSI92FullSQL() throws SQLException
+    {
+        try
+        {
+            return md.supportsANSI92FullSQL();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsIntegrityEnhancementFacility() throws SQLException
+    {
+        try
+        {
+            return md.supportsIntegrityEnhancementFacility();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOuterJoins() throws SQLException
+    {
+        try
+        {
+            return md.supportsOuterJoins();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsFullOuterJoins() throws SQLException
+    {
+        try
+        {
+            return md.supportsFullOuterJoins();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsLimitedOuterJoins() throws SQLException
+    {
+        try
+        {
+            return md.supportsLimitedOuterJoins();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getSchemaTerm() throws SQLException
+    {
+        try
+        {
+            return md.getSchemaTerm();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getProcedureTerm() throws SQLException
+    {
+        try
+        {
+            return md.getProcedureTerm();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getCatalogTerm() throws SQLException
+    {
+        try
+        {
+            return md.getCatalogTerm();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isCatalogAtStart() throws SQLException
+    {
+        try
+        {
+            return md.isCatalogAtStart();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getCatalogSeparator() throws SQLException
+    {
+        try
+        {
+            return md.getCatalogSeparator();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSchemasInDataManipulation() throws SQLException
+    {
+        try
+        {
+            return md.supportsSchemasInDataManipulation();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSchemasInProcedureCalls() throws SQLException
+    {
+        try
+        {
+            return md.supportsSchemasInProcedureCalls();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSchemasInTableDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsSchemasInTableDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSchemasInIndexDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsSchemasInIndexDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSchemasInPrivilegeDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsSchemasInPrivilegeDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCatalogsInDataManipulation() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInDataManipulation();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCatalogsInProcedureCalls() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInProcedureCalls();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCatalogsInTableDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInTableDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCatalogsInIndexDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInIndexDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCatalogsInPrivilegeDefinitions() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInPrivilegeDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsPositionedDelete() throws SQLException
+    {
+        try
+        {
+            return md.supportsCatalogsInPrivilegeDefinitions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsPositionedUpdate() throws SQLException
+    {
+        try
+        {
+            return md.supportsPositionedUpdate();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSelectForUpdate() throws SQLException
+    {
+        try
+        {
+            return md.supportsSelectForUpdate();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsStoredProcedures() throws SQLException
+    {
+        try
+        {
+            return md.supportsStoredProcedures();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSubqueriesInComparisons() throws SQLException
+    {
+        try
+        {
+            return md.supportsSubqueriesInComparisons();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSubqueriesInExists() throws SQLException
+    {
+        try
+        {
+            return md.supportsSubqueriesInExists();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSubqueriesInIns() throws SQLException
+    {
+        try
+        {
+            return md.supportsSubqueriesInIns();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsSubqueriesInQuantifieds() throws SQLException
+    {
+        try
+        {
+            return md.supportsSubqueriesInQuantifieds();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsCorrelatedSubqueries() throws SQLException
+    {
+        try
+        {
+            return md.supportsCorrelatedSubqueries();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsUnion() throws SQLException
+    {
+        try
+        {
+            return md.supportsUnion();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsUnionAll() throws SQLException
+    {
+        try
+        {
+            return md.supportsUnionAll();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOpenCursorsAcrossCommit() throws SQLException
+    {
+        try
+        {
+            return md.supportsOpenCursorsAcrossCommit();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOpenCursorsAcrossRollback() throws SQLException
+    {
+        try
+        {
+            return md.supportsOpenCursorsAcrossRollback();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOpenStatementsAcrossCommit() throws SQLException
+    {
+        try
+        {
+            return md.supportsOpenStatementsAcrossCommit();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsOpenStatementsAcrossRollback() throws SQLException
+    {
+        try
+        {
+            return md.supportsOpenStatementsAcrossRollback();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxBinaryLiteralLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxBinaryLiteralLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxCharLiteralLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxCharLiteralLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnsInGroupBy() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnsInGroupBy();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnsInIndex() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnsInIndex();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnsInOrderBy() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnsInOrderBy();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnsInSelect() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnsInSelect();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxColumnsInTable() throws SQLException
+    {
+        try
+        {
+            return md.getMaxColumnsInTable();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxConnections() throws SQLException
+    {
+        try
+        {
+            return md.getMaxConnections();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxCursorNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxCursorNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxIndexLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxIndexLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxSchemaNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxSchemaNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxProcedureNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxProcedureNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxCatalogNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxCatalogNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxRowSize() throws SQLException
+    {
+        try
+        {
+            return md.getMaxRowSize();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean doesMaxRowSizeIncludeBlobs() throws SQLException
+    {
+        try
+        {
+            return md.doesMaxRowSizeIncludeBlobs();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxStatementLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxStatementLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxStatements() throws SQLException
+    {
+        try
+        {
+            return md.getMaxStatements();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxTableNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxTableNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxTablesInSelect() throws SQLException
+    {
+        try
+        {
+            return md.getMaxTablesInSelect();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getMaxUserNameLength() throws SQLException
+    {
+        try
+        {
+            return md.getMaxUserNameLength();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getDefaultTransactionIsolation() throws SQLException
+    {
+        try
+        {
+            return md.getDefaultTransactionIsolation();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsTransactions() throws SQLException
+    {
+        try
+        {
+            return md.supportsTransactions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsTransactionIsolationLevel(int level) throws SQLException
+    {
+        try
+        {
+            return md.supportsTransactionIsolationLevel(level);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsDataDefinitionAndDataManipulationTransactions() throws SQLException
+    {
+        try
+        {
+            return md.supportsDataDefinitionAndDataManipulationTransactions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsDataManipulationTransactionsOnly() throws SQLException
+    {
+        try
+        {
+            return md.supportsDataManipulationTransactionsOnly();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean dataDefinitionCausesTransactionCommit() throws SQLException
+    {
+        try
+        {
+            return md.dataDefinitionCausesTransactionCommit();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean dataDefinitionIgnoredInTransactions() throws SQLException
+    {
+        try
+        {
+            return md.dataDefinitionIgnoredInTransactions();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getProcedures(String catalog, String schemaPattern, String procedureNamePattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getProcedures(catalog, schemaPattern, procedureNamePattern));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getProcedureColumns(String catalog, String schemaPattern, String procedureNamePattern, String columnNamePattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getProcedureColumns(catalog, schemaPattern, procedureNamePattern, columnNamePattern));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getTables(String catalog, String schemaPattern, String tableNamePattern, String[] types) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getTables(catalog, schemaPattern, tableNamePattern, types));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getSchemas() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getSchemas());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getCatalogs() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getCatalogs());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getTableTypes() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getTableTypes());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getColumns(catalog, schemaPattern, tableNamePattern, columnNamePattern));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getColumnPrivileges(String catalog, String schema, String table, String columnNamePattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getColumnPrivileges(catalog, schema, table, columnNamePattern));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getTablePrivileges(String catalog, String schemaPattern, String tableNamePattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getTablePrivileges(catalog, schemaPattern, tableNamePattern));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getBestRowIdentifier(String catalog, String schema, String table, int scope, boolean nullable) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getBestRowIdentifier(catalog, schema, table, scope, nullable));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getVersionColumns(String catalog, String schema, String table) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getVersionColumns(catalog, schema, table));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getPrimaryKeys(String catalog, String schema, String table) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getPrimaryKeys(catalog, schema, table));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getImportedKeys(String catalog, String schema, String table) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getImportedKeys(catalog, schema, table));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getExportedKeys(String catalog, String schema, String table) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getExportedKeys(catalog, schema, table));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getCrossReference(String parentCatalog, String parentSchema, String parentTable, String foreignCatalog, String foreignSchema, String foreignTable) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getCrossReference(parentCatalog, parentSchema, parentTable, foreignCatalog, foreignSchema, foreignTable));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getTypeInfo() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getTypeInfo());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getIndexInfo(String catalog, String schema, String table, boolean unique, boolean approximate) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getIndexInfo(catalog, schema, table, unique, approximate));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsResultSetType(int type) throws SQLException
+    {
+        try
+        {
+            return md.supportsResultSetType(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsResultSetConcurrency(int type, int concurrency) throws SQLException
+    {
+        try
+        {
+            return md.supportsResultSetConcurrency(type, concurrency);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean ownUpdatesAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.ownUpdatesAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean ownDeletesAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.ownDeletesAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean ownInsertsAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.ownInsertsAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean othersUpdatesAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.othersUpdatesAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean othersDeletesAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.othersDeletesAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean othersInsertsAreVisible(int type) throws SQLException
+    {
+        try
+        {
+            return md.othersInsertsAreVisible(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean updatesAreDetected(int type) throws SQLException
+    {
+        try
+        {
+            return md.updatesAreDetected(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean deletesAreDetected(int type) throws SQLException
+    {
+        try
+        {
+            return md.deletesAreDetected(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean insertsAreDetected(int type) throws SQLException
+    {
+        try
+        {
+            return md.insertsAreDetected(type);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsBatchUpdates() throws SQLException
+    {
+        try
+        {
+            return md.supportsBatchUpdates();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public ResultSet getUDTs(String catalog, String schemaPattern, String typeNamePattern, int[] types) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getUDTs(catalog, schemaPattern, typeNamePattern, types));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Connection getConnection() throws SQLException
+    {
+        return con;
+    }
+
+    public boolean supportsSavepoints() throws SQLException
+    {
+        return false;
+    }
+
+    public boolean supportsNamedParameters() throws SQLException
+    {
+        return false;
+    }
+
+    public boolean supportsMultipleOpenResults() throws SQLException
+    {
+        return false;
+    }
+
+    public boolean supportsGetGeneratedKeys() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getSuperTypes(String catalog, String schemaPattern, String typeNamePattern) throws SQLException
+    {
+
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getSuperTables(String catalog, String schemaPattern, String tableNamePattern) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getAttributes(String catalog, String schemaPattern, String typeNamePattern, String attributeNamePattern) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean supportsResultSetHoldability(int holdability) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int getResultSetHoldability() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int getDatabaseMajorVersion() throws SQLException
+    {
+        return 1;
+    }
+
+    public int getDatabaseMinorVersion() throws SQLException
+    {
+        return 0;
+    }
+
+    public int getJDBCMajorVersion() throws SQLException
+    {
+        return 1;
+    }
+
+    public int getJDBCMinorVersion() throws SQLException
+    {
+        return 0;
+    }
+
+    public int getSQLStateType() throws SQLException
+    {
+        return 0;
+    }
+
+    public boolean locatorsUpdateCopy() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean supportsStatementPooling() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getSchemas(String catalog, String schemaPattern) throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(null, md.getSchemas());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean supportsStoredFunctionsUsingCallSyntax() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean autoCommitFailureClosesAllResultSets() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getClientInfoProperties() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getFunctions(String catalog, String schemaPattern, String functionNamePattern) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSet getFunctionColumns(String catalog, String schemaPattern, String functionNamePattern, String columnNamePattern) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public RowIdLifetime getRowIdLifetime() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoPreparedStatement.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoPreparedStatement.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoPreparedStatement.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,600 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.sdbc.XParameters;
+import com.sun.star.sdbc.XPreparedBatchExecution;
+import com.sun.star.sdbc.XPreparedStatement;
+import com.sun.star.sdbc.XResultSetMetaDataSupplier;
+import com.sun.star.uno.UnoRuntime;
+import java.io.InputStream;
+import java.io.Reader;
+import java.math.BigDecimal;
+import java.net.URL;
+import java.sql.Array;
+import java.sql.Blob;
+import java.sql.Clob;
+import java.sql.Date;
+import java.sql.NClob;
+import java.sql.ParameterMetaData;
+import java.sql.Ref;
+import java.sql.ResultSet;
+import java.sql.ResultSetMetaData;
+import java.sql.RowId;
+import java.sql.SQLException;
+import java.sql.SQLXML;
+import java.sql.Time;
+import java.sql.Timestamp;
+import java.util.Calendar;
+import java.util.StringTokenizer;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoPreparedStatement extends OOoStatement implements java.sql.PreparedStatement
+{
+
+    final protected XPreparedStatement prepared;
+    final protected XParameters params;
+    final protected XResultSetMetaDataSupplier sup;
+    final protected XPreparedBatchExecution batch;
+
+    OOoPreparedStatement(OOoConnection con, Object state) throws SQLException
+    {
+        super(con, state);
+
+        prepared = (XPreparedStatement) UnoRuntime.queryInterface(XPreparedStatement.class, state);
+        params = (XParameters) UnoRuntime.queryInterface(XParameters.class, prepared);
+        batch = (XPreparedBatchExecution) UnoRuntime.queryInterface(XPreparedBatchExecution.class, prepared);
+        sup = (XResultSetMetaDataSupplier) UnoRuntime.queryInterface(XResultSetMetaDataSupplier.class, prepared);
+    }
+
+    public ResultSet executeQuery() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSet(this, prepared.executeQuery());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int executeUpdate() throws SQLException
+    {
+        try
+        {
+            return prepared.executeUpdate();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setNull(int parameterIndex, int sqlType) throws SQLException
+    {
+        try
+        {
+            params.setNull(parameterIndex, sqlType);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setBoolean(int parameterIndex, boolean x) throws SQLException
+    {
+        try
+        {
+            params.setBoolean(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setByte(int parameterIndex, byte x) throws SQLException
+    {
+        try
+        {
+            params.setByte(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setShort(int parameterIndex, short x) throws SQLException
+    {
+        try
+        {
+            params.setShort(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setInt(int parameterIndex, int x) throws SQLException
+    {
+        try
+        {
+            params.setInt(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setLong(int parameterIndex, long x) throws SQLException
+    {
+        try
+        {
+            params.setLong(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setFloat(int parameterIndex, float x) throws SQLException
+    {
+        try
+        {
+            params.setFloat(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setDouble(int parameterIndex, double x) throws SQLException
+    {
+        try
+        {
+            params.setDouble(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setBigDecimal(int parameterIndex, BigDecimal x) throws SQLException
+    {
+        setString(parameterIndex, x.toString());
+    }
+
+    public void setString(int parameterIndex, String x) throws SQLException
+    {
+        try
+        {
+            params.setString(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setBytes(int parameterIndex, byte[] x) throws SQLException
+    {
+        try
+        {
+            params.setBytes(parameterIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setDate(int parameterIndex, Date x) throws SQLException
+    {
+        try
+        {
+            params.setDate(parameterIndex, (com.sun.star.util.Date) convertFromJavaObject(x));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setTime(int parameterIndex, Time x) throws SQLException
+    {
+        try
+        {
+            params.setTime(parameterIndex, (com.sun.star.util.Time) convertFromJavaObject(x));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setTimestamp(int parameterIndex, Timestamp x) throws SQLException
+    {
+        try
+        {
+            params.setTimestamp(parameterIndex, (com.sun.star.util.DateTime) convertFromJavaObject(x));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setAsciiStream(int parameterIndex, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setUnicodeStream(int parameterIndex, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(int parameterIndex, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void clearParameters() throws SQLException
+    {
+        try
+        {
+            params.clearParameters();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setObject(int parameterIndex, Object x, int targetSqlType) throws SQLException
+    {
+        try
+        {
+            params.setObjectWithInfo(parameterIndex, convertFromJavaObject(x), targetSqlType, 0);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    static public final Object convertFromJavaObject(Object x)
+    {
+        final Object val;
+        if (x instanceof java.sql.Date)
+        {
+            java.sql.Date d = (java.sql.Date) x;
+            com.sun.star.util.Date d2 = new com.sun.star.util.Date();//(d.getYear(), d.getMonth(), d.getDay());
+            
+            final String s = d.toString();
+            StringTokenizer token = new StringTokenizer(s);
+            d2.Year = Short.valueOf(token.nextToken("-"));
+            d2.Month = Short.valueOf(token.nextToken("-"));
+            d2.Day = Short.valueOf(token.nextToken("-"));
+            val = d2;
+        }
+        else if (x instanceof java.sql.Timestamp)
+        {
+            java.sql.Timestamp d = (java.sql.Timestamp) x;
+            com.sun.star.util.DateTime d2 = new com.sun.star.util.DateTime();//(d.getYear(), d.getMonth(), d.getDay());
+            final String s = d.toString();
+            StringTokenizer token = new StringTokenizer(s);
+            final String date = token.nextToken(" ");
+            final String time = token.nextToken(" ");
+            token = new StringTokenizer(date);
+            d2.Year = Short.valueOf(token.nextToken("-"));
+            d2.Month = Short.valueOf(token.nextToken("-"));
+            d2.Day = Short.valueOf(token.nextToken("-"));
+            token = new StringTokenizer(time);
+            d2.Hours = Short.valueOf(token.nextToken(":"));
+            d2.Minutes = Short.valueOf(token.nextToken(":"));
+            token = new StringTokenizer(token.nextToken(":"));
+            d2.Seconds = Short.valueOf(token.nextToken("."));
+            d2.HundredthSeconds = Short.valueOf(token.nextToken("."));
+            val = d2;
+        }
+        else if (x instanceof java.sql.Time)
+        {
+            java.sql.Time d = (java.sql.Time) x;
+            com.sun.star.util.Time d2 = new com.sun.star.util.Time();//(d.getYear(), d.getMonth(), d.getDay());
+            final String s = d.toString();
+            StringTokenizer token = new StringTokenizer(s);
+            d2.Hours = Short.valueOf(token.nextToken(":"));
+            d2.Minutes = Short.valueOf(token.nextToken(":"));
+            d2.Seconds = Short.valueOf(token.nextToken(":"));
+            val = d2;
+        }
+        else if (x instanceof java.math.BigDecimal)
+        {
+            java.math.BigDecimal d = (java.math.BigDecimal) x;
+            val = d.toString();
+        }
+        else if (x instanceof java.io.InputStream)
+        {
+            val = new com.sun.star.lib.uno.adapter.InputStreamToXInputStreamAdapter((java.io.InputStream) x);
+        }
+        else if (x instanceof Reader)
+        {
+            // val = new com.sun.star.lib.uno.adapter.InputStreamToXInputStreamAdapter(x);
+            val = null;
+        }
+        else
+        {
+            val = x;
+        }
+        return val;
+    }
+
+    public void setObject(int parameterIndex, Object x) throws SQLException
+    {
+        try
+        {
+            final Object val = convertFromJavaObject(x);
+
+            params.setObject(parameterIndex, val);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean execute() throws SQLException
+    {
+        try
+        {
+            return prepared.execute();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void addBatch() throws SQLException
+    {
+        try
+        {
+            batch.addBatch();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setCharacterStream(int parameterIndex, Reader reader, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setRef(int parameterIndex, Ref x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(int parameterIndex, Blob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(int parameterIndex, Clob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setArray(int parameterIndex, Array x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ResultSetMetaData getMetaData() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSetMetaData(sup.getMetaData());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setDate(int parameterIndex, Date x, Calendar cal) throws SQLException
+    {
+        setDate(parameterIndex, x);
+    }
+
+    public void setTime(int parameterIndex, Time x, Calendar cal) throws SQLException
+    {
+        setTime(parameterIndex, x);
+    }
+
+    public void setTimestamp(int parameterIndex, Timestamp x, Calendar cal) throws SQLException
+    {
+        setTimestamp(parameterIndex, x);
+    }
+
+    public void setNull(int parameterIndex, int sqlType, String typeName) throws SQLException
+    {
+        try
+        {
+            params.setNull(parameterIndex, sqlType);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setURL(int parameterIndex, URL x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public ParameterMetaData getParameterMetaData() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNString(int parameterIndex, String value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNCharacterStream(int parameterIndex, Reader value, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(int parameterIndex, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(int parameterIndex, InputStream inputStream, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(int parameterIndex, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setObject(int parameterIndex, Object x, int targetSqlType, int scaleOrLength) throws SQLException
+    {
+        try
+        {
+            final Object val = convertFromJavaObject(x);
+            params.setObjectWithInfo(parameterIndex, val, targetSqlType, scaleOrLength);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setAsciiStream(int parameterIndex, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(int parameterIndex, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setCharacterStream(int parameterIndex, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setAsciiStream(int parameterIndex, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBinaryStream(int parameterIndex, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setCharacterStream(int parameterIndex, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNCharacterStream(int parameterIndex, Reader value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClob(int parameterIndex, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setBlob(int parameterIndex, InputStream inputStream) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(int parameterIndex, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setRowId(int parameterIndex, RowId x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setNClob(int parameterIndex, NClob value) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setSQLXML(int parameterIndex, SQLXML xmlObject) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKeyException.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKeyException.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKeyException.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,54 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile: WinRegKeyException.java,v $
+ * $Revision: 1.1 $
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+
+package org.openoffice.jdbc.loader;
+
+/**
+ * WinRegKeyException is a checked exception.
+ */
+final class WinRegKeyException extends java.lang.Exception {    
+    
+    /**
+     * Constructs a <code>WinRegKeyException</code>.
+     */
+    public WinRegKeyException() {
+        super();
+    }
+
+    /**
+     * Constructs a <code>WinRegKeyException</code> with the specified
+     * detail message.
+     *
+	 * @param  message   the detail message
+     */
+    public WinRegKeyException( String message ) {
+        super( message );
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKey.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKey.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/loader/WinRegKey.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,203 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile: WinRegKey.java,v $
+ * $Revision: 1.1 $
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+
+package org.openoffice.jdbc.loader;
+
+import java.io.BufferedInputStream;
+import java.io.BufferedOutputStream;
+import java.io.File;
+import java.io.FileOutputStream;
+import java.io.InputStream;
+
+
+/**
+ * This class provides functionality for reading string values from the
+ * Windows Registry. It requires the native library unowinreg.dll.
+ */
+final class WinRegKey {
+    
+    private String m_rootKeyName;
+    private String m_subKeyName;
+            
+    // native methods to access the windows registry
+    private static native boolean winreg_RegOpenClassesRoot( long[] hkresult );
+    private static native boolean winreg_RegOpenCurrentConfig(
+        long[] hkresult );
+    private static native boolean winreg_RegOpenCurrentUser( long[] hkresult );
+    private static native boolean winreg_RegOpenLocalMachine( long[] hkresult );
+    private static native boolean winreg_RegOpenUsers( long[] hkresult );
+    private static native boolean winreg_RegOpenKeyEx( long parent, String name,
+        long[] hkresult );
+    private static native boolean winreg_RegCloseKey( long hkey );    
+    private static native boolean winreg_RegQueryValueEx(
+        long hkey, String value, long[] type, 
+        byte[] data, long[] size );
+    private static native boolean winreg_RegQueryInfoKey(
+        long hkey, long[] subkeys, long[] maxSubkeyLen, 
+        long[] values, long[] maxValueNameLen,
+        long[] maxValueLen, long[] secDescriptor );
+    
+    // load the native library unowinreg.dll
+    static {        
+        try {
+            ClassLoader cl = WinRegKey.class.getClassLoader();            
+            InputStream is = cl.getResourceAsStream( "win/unowinreg.dll" );
+            if ( is != null ) {                
+                // generate a temporary name for lib file and write to temp
+                // location
+                BufferedInputStream istream = new BufferedInputStream( is );
+                File libfile = File.createTempFile( "unowinreg", ".dll" );
+                libfile.deleteOnExit(); // ensure deletion
+                BufferedOutputStream ostream = new BufferedOutputStream(
+                    new FileOutputStream( libfile ) );
+                int bsize = 2048; int n = 0;
+                byte[] buffer = new byte[bsize];
+                while ( ( n = istream.read( buffer, 0, bsize ) ) != -1 ) {
+                    ostream.write( buffer, 0, n );
+                }        
+                istream.close();
+                ostream.close();            
+                // load library
+                System.load( libfile.getPath() );
+            } else {
+                // If the library cannot be found as a class loader resource,
+                // try the global System.loadLibrary(). The JVM will look for
+                // it in the java.library.path.            
+                System.loadLibrary( "unowinreg" );
+            }            
+        } catch ( java.lang.Exception e ) {
+            System.err.println( "com.sun.star.lib.loader.WinRegKey: " +
+                "loading of native library failed!" + e );
+        }
+    }
+    
+    /**
+     * Constructs a <code>WinRegKey</code>.
+     */
+    public WinRegKey( String rootKeyName, String subKeyName ) {
+        m_rootKeyName = rootKeyName;
+        m_subKeyName = subKeyName;
+    }
+
+    /**
+     * Reads a string value for the specified value name.
+     */    
+    public String getStringValue( String valueName ) throws WinRegKeyException {
+        byte[] data = getValue( valueName );
+        // remove terminating null character
+        return new String( data, 0, data.length - 1 );
+    }
+
+    /**
+     * Reads a value for the specified value name.
+     */
+    private byte[] getValue( String valueName ) throws WinRegKeyException {
+        
+        byte[] result = null;
+        long[] hkey = {0};
+        
+        // open the specified registry key
+        boolean bRet = false;
+        long[] hroot = {0};
+        if ( m_rootKeyName.equals( "HKEY_CLASSES_ROOT" ) ) {
+            bRet = winreg_RegOpenClassesRoot( hroot );
+        } else if ( m_rootKeyName.equals( "HKEY_CURRENT_CONFIG" ) ) {
+            bRet = winreg_RegOpenCurrentConfig( hroot );
+        } else if ( m_rootKeyName.equals( "HKEY_CURRENT_USER" ) ) {
+            bRet = winreg_RegOpenCurrentUser( hroot );
+        } else if ( m_rootKeyName.equals( "HKEY_LOCAL_MACHINE" ) ) {
+            bRet = winreg_RegOpenLocalMachine( hroot );
+        } else if ( m_rootKeyName.equals( "HKEY_USERS" ) ) {
+            bRet = winreg_RegOpenUsers( hroot );
+        } else {
+            throw new WinRegKeyException( "unknown root registry key!");
+        }
+        if ( !bRet ) {
+            throw new WinRegKeyException( "opening root registry key " +
+                "failed!" );
+        }
+        if ( !winreg_RegOpenKeyEx( hroot[0], m_subKeyName, hkey ) ) {
+            if ( !winreg_RegCloseKey( hroot[0] ) ) {
+                throw new WinRegKeyException( "opening registry key and " +
+                    "releasing root registry key handle failed!" );
+            }            
+            throw new WinRegKeyException( "opening registry key failed!" );
+        }
+            
+        // get the size of the longest data component among the key's values
+        long[] subkeys = {0};
+        long[] maxSubkeyLen = {0};
+        long[] values = {0};
+        long[] maxValueNameLen = {0};
+        long[] maxValueLen = {0};
+        long[] secDescriptor = {0};
+        if ( !winreg_RegQueryInfoKey( hkey[0], subkeys, maxSubkeyLen,
+                 values, maxValueNameLen, maxValueLen, secDescriptor ) ) {
+            if ( !winreg_RegCloseKey( hkey[0] ) ||
+                 !winreg_RegCloseKey( hroot[0] ) ) {
+                throw new WinRegKeyException( "retrieving information about " +
+                    "the registry key and releasing registry key handles " +
+                    "failed!" );
+            }                
+            throw new WinRegKeyException( "retrieving information about " +
+                "the registry key failed!" );
+        }
+        
+        // get the data for the specified value name
+        byte[] buffer = new byte[ (int) maxValueLen[0] ];        
+        long[] size = new long[1];
+        size[0] = buffer.length;
+        long[] type = new long[1];
+        type[0] = 0;
+        if ( !winreg_RegQueryValueEx( hkey[0], valueName, type, buffer,
+                 size ) ) {
+            if ( !winreg_RegCloseKey( hkey[0] ) ||
+                 !winreg_RegCloseKey( hroot[0] ) ) {
+                throw new WinRegKeyException( "retrieving data for the " +
+                    "specified value name and releasing registry key handles " +
+                    "failed!" );
+            }
+            throw new WinRegKeyException( "retrieving data for the " +
+                "specified value name failed!" );
+        }
+        
+        // release registry key handles
+        if ( !winreg_RegCloseKey( hkey[0] ) ||
+             !winreg_RegCloseKey( hroot[0] ) ) {
+            throw new WinRegKeyException( "releasing registry key handles " +
+                "failed!" );
+        }
+        
+        result = new byte[ (int) size[0] ];
+        System.arraycopy( buffer, 0, result, 0, (int)size[0] );
+        
+        return result;
+    } 
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/loader/Loader.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/loader/Loader.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/loader/Loader.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,491 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile: Loader.java,v $
+ * $Revision: 1.1 $
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+package org.openoffice.jdbc.loader;
+
+import java.io.File;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.UnsupportedEncodingException;
+import java.lang.reflect.InvocationTargetException;
+import java.lang.reflect.Method;
+import java.net.JarURLConnection;
+import java.net.MalformedURLException;
+import java.net.URL;
+import java.net.URLClassLoader;
+import java.util.Enumeration;
+import java.util.jar.Attributes;
+import java.util.jar.Manifest;
+import java.util.StringTokenizer;
+import java.util.Vector;
+
+/**
+ * This class can be used as a loader for application classes which use UNO.
+ *
+ * <p>The Loader class detects a UNO installation on the system and adds the
+ * UNO jar files to the search path of a customized class loader, which is used
+ * for loading the application classes.</p>
+ */
+public final class Loader
+{
+
+    private static ClassLoader m_Loader = null;
+
+    /**
+     * do not instantiate
+     */
+    private Loader()
+    {
+    }
+
+    /**
+     * The main method instantiates a customized class loader with the
+     * UNO jar files added to the search path and loads the application class,
+     * which is specified in the Main-Class attribute of the
+     * com/sun/star/lib/Loader.class entry of the manifest file or
+     * as first parameter in the argument list.
+     */
+    public static void main(String[] arguments) throws Exception
+    {
+        // get the name of the class to be loaded from the manifest
+        String className = null;
+        Class clazz = Loader.class;
+        ClassLoader loader = clazz.getClassLoader();
+        Vector<URL> res = new Vector<URL>();
+        try
+        {
+            Enumeration<URL> en = loader.getResources("META-INF/MANIFEST.MF");
+            while (en.hasMoreElements())
+            {
+                res.add(en.nextElement());
+            }
+            // the jarfile with the com/sun/star/lib/loader/Loader.class
+            // per-entry attribute is most probably the last resource in the
+            // list, therefore search backwards
+            for (int i = res.size() - 1; i >= 0; i--)
+            {
+                URL jarurl = (URL) res.elementAt(i);
+                try
+                {
+                    JarURLConnection jarConnection =
+                            (JarURLConnection) jarurl.openConnection();
+                    Manifest mf = jarConnection.getManifest();
+                    Attributes attrs = (Attributes) mf.getAttributes(
+                            "com/sun/star/lib/loader/Loader.class");
+                    if (attrs != null)
+                    {
+                        className = attrs.getValue("Application-Class");
+                        if (className != null)
+                        {
+                            break;
+                        }
+                    }
+                }
+                catch (IOException e)
+                {
+                    // if an I/O error occurs when opening a new
+                    // JarURLConnection, ignore this manifest file
+                    System.err.println("com.sun.star.lib.loader.Loader::" +
+                            "main: bad manifest file: " + e);
+                }
+            }
+        }
+        catch (IOException e)
+        {
+            // if an I/O error occurs when getting the manifest resources,
+            // try to get the name of the class to be loaded from the argument
+            // list
+            System.err.println("com.sun.star.lib.loader.Loader::" +
+                    "main: cannot get manifest resources: " + e);
+        }
+
+        // if no manifest entry was found, check first the system property
+        // Application-Class and if it is not set get the name of the class
+        // to be loaded from the argument list
+        String[] args = arguments;
+        if (className == null)
+        {
+            className = System.getProperty("Application-Class");
+
+            if (className == null)
+            {
+                if (arguments.length > 0)
+                {
+                    className = arguments[0];
+                    args = new String[arguments.length - 1];
+                    System.arraycopy(arguments, 1, args, 0, args.length);
+                    if (arguments.length > 1)
+                        System.setProperty(InstallationFinder.SYSPROP_NAME, arguments[1]);
+                }
+                else
+                {
+                    throw new IllegalArgumentException(
+                            "The name of the class to be loaded must be either " +
+                            "specified in the Main-Class attribute of the " +
+                            "com/sun/star/lib/loader/Loader.class entry of the " +
+                            "manifest file, as the system property Application-Class " +
+                            "or as the first command line argument.");
+                }
+            }
+        }
+
+        // load the class with the customized class loader and
+        // invoke the main method
+        if (className != null)
+        {
+            ClassLoader cl = getCustomLoader();
+            Class c = cl.loadClass(className);
+            Method m = c.getMethod("main", new Class[]
+                    {
+                        String[].class
+                    });
+            m.invoke(null, new Object[]
+                    {
+                        args
+                    });
+        }
+    }
+
+    /**
+     * Gets the customized class loader with the UNO jar files added to the
+     * search path.
+     *
+     * @return the customized class loader       
+     */
+    public static synchronized ClassLoader getCustomLoader()
+    {
+
+        final String CLASSESDIR = "classes";
+        final String JUHJAR = "juh.jar";
+
+        if (m_Loader == null)
+        {
+
+            // get the urls from which to load classes and resources
+            // from the class path
+            Vector<URL> vec = new Vector<URL>();
+            String classpath = null;
+            try
+            {
+                classpath = System.getProperty("java.class.path");
+            }
+            catch (SecurityException e)
+            {
+                // don't add the class path entries to the list of class
+                // loader URLs
+                System.err.println("com.sun.star.lib.loader.Loader::" +
+                        "getCustomLoader: cannot get system property " +
+                        "java.class.path: " + e);
+            }
+            if (classpath != null)
+            {
+                addUrls(vec, classpath, File.pathSeparator);
+            }
+
+            // get the urls from which to load classes and resources       
+            // from the UNO installation
+            String path = InstallationFinder.getPath();
+            if (path != null)
+            {
+                File fClassesDir = new File(path, CLASSESDIR);
+                File fJuh = new File(fClassesDir, JUHJAR);
+                if (fJuh.exists())
+                {
+                    URL[] clurls = new URL[1];
+                    try
+                    {
+                        clurls[0] = fJuh.toURL();
+                        ClassLoader cl = new CustomURLClassLoader(clurls);
+                        Class c = cl.loadClass(
+                                "com.sun.star.comp.helper.UnoInfo");
+                        Method m = c.getMethod("getJars", (Class[]) null);
+                        URL[] jarurls = (URL[]) m.invoke(
+                                null, (Object[]) null);
+                        for (int i = 0; i < jarurls.length; i++)
+                        {
+                            vec.add(jarurls[i]);
+                        }
+                    }
+                    catch (MalformedURLException e)
+                    {
+                        // don't add the UNO jar files to the list of class
+                        // loader URLs
+                        System.err.println("com.sun.star.lib.loader.Loader::" +
+                                "getCustomLoader: cannot add UNO jar files: " + e);
+                    }
+                    catch (ClassNotFoundException e)
+                    {
+                        // don't add the UNO jar files to the list of class
+                        // loader URLs
+                        System.err.println("com.sun.star.lib.loader.Loader::" +
+                                "getCustomLoader: cannot add UNO jar files: " + e);
+                    }
+                    catch (NoSuchMethodException e)
+                    {
+                        // don't add the UNO jar files to the list of class
+                        // loader URLs
+                        System.err.println("com.sun.star.lib.loader.Loader::" +
+                                "getCustomLoader: cannot add UNO jar files: " + e);
+                    }
+                    catch (IllegalAccessException e)
+                    {
+                        // don't add the UNO jar files to the list of class
+                        // loader URLs
+                        System.err.println("com.sun.star.lib.loader.Loader::" +
+                                "getCustomLoader: cannot add UNO jar files: " + e);
+                    }
+                    catch (InvocationTargetException e)
+                    {
+                        // don't add the UNO jar files to the list of class
+                        // loader URLs
+                        System.err.println("com.sun.star.lib.loader.Loader::" +
+                                "getCustomLoader: cannot add UNO jar files: " + e);
+                    }
+                }
+                else
+                {
+                    callUnoinfo(path, vec);
+                }
+            }
+            else
+            {
+                System.err.println("com.sun.star.lib.loader.Loader::" +
+                        "getCustomLoader: no UNO installation found!");
+            }
+
+            // copy urls to array
+            URL[] urls = new URL[vec.size()];
+            vec.toArray(urls);
+
+            // instantiate class loader
+            m_Loader = new CustomURLClassLoader(urls);
+        }
+
+        return m_Loader;
+    }
+
+    private static void addUrls(Vector<URL> urls, String data, String delimiter)
+    {
+        StringTokenizer tokens = new StringTokenizer(data, delimiter);
+        while (tokens.hasMoreTokens())
+        {
+            try
+            {
+                urls.add(new File(tokens.nextToken()).toURL());
+            }
+            catch (MalformedURLException e)
+            {
+                // don't add this class path entry to the list of class loader
+                // URLs
+                System.err.println("com.sun.star.lib.loader.Loader::" +
+                        "getCustomLoader: bad pathname: " + e);
+            }
+        }
+    }
+
+    private static void callUnoinfo(String path, Vector<URL> urls)
+    {
+        Process p;
+        try
+        {
+            p = Runtime.getRuntime().exec(
+                    new String[]
+                    {
+                        new File(path, "unoinfo.exe").getPath(), "java"
+                    });
+        }
+        catch (IOException e)
+        {
+            System.err.println(
+                    "com.sun.star.lib.loader.Loader::getCustomLoader: exec" +
+                    " unoinfo: " + e);
+            return;
+        }
+        new Drain(p.getErrorStream()).start();
+        int code;
+        byte[] buf = new byte[1000];
+        int n = 0;
+        try
+        {
+            InputStream s = p.getInputStream();
+            code = s.read();
+            for (;;)
+            {
+                if (n == buf.length)
+                {
+                    if (n > Integer.MAX_VALUE / 2)
+                    {
+                        System.err.println(
+                                "com.sun.star.lib.loader.Loader::getCustomLoader:" +
+                                " too much unoinfo output");
+                        return;
+                    }
+                    byte[] buf2 = new byte[2 * n];
+                    for (int i = 0; i < n; ++i)
+                    {
+                        buf2[i] = buf[i];
+                    }
+                    buf = buf2;
+                }
+                int k = s.read(buf, n, buf.length - n);
+                if (k == -1)
+                {
+                    break;
+                }
+                n += k;
+            }
+        }
+        catch (IOException e)
+        {
+            System.err.println(
+                    "com.sun.star.lib.loader.Loader::getCustomLoader: reading" +
+                    " unoinfo output: " + e);
+            return;
+        }
+        int ev;
+        try
+        {
+            ev = p.waitFor();
+        }
+        catch (InterruptedException e)
+        {
+            Thread.currentThread().interrupt();
+            System.err.println(
+                    "com.sun.star.lib.loader.Loader::getCustomLoader: waiting for" +
+                    " unoinfo: " + e);
+            return;
+        }
+        if (ev != 0)
+        {
+            System.err.println(
+                    "com.sun.star.lib.loader.Loader::getCustomLoader: unoinfo" + " exit value " + n);
+            return;
+        }
+        String s;
+        if (code == '0')
+        {
+            s = new String(buf);
+        }
+        else if (code == '1')
+        {
+            try
+            {
+                s = new String(buf, "UTF-16LE");
+            }
+            catch (UnsupportedEncodingException e)
+            {
+                System.err.println(
+                        "com.sun.star.lib.loader.Loader::getCustomLoader:" +
+                        " transforming unoinfo output: " + e);
+                return;
+            }
+        }
+        else
+        {
+            System.err.println(
+                    "com.sun.star.lib.loader.Loader::getCustomLoader: bad unoinfo" + " output");
+            return;
+        }
+        addUrls(urls, s, "\0");
+    }
+
+    private static final class Drain extends Thread
+    {
+
+        public Drain(InputStream stream)
+        {
+            super("unoinfo stderr drain");
+            this.stream = stream;
+        }
+
+        public void run()
+        {
+            try
+            {
+                while (stream.read() != -1)
+                {
+                }
+            }
+            catch (IOException e)
+            { /* ignored */ }
+        }
+        private final InputStream stream;
+    }
+
+    /**
+     * A customized class loader which is used to load classes and resources
+     * from a search path of user-defined URLs.
+     */
+    private static final class CustomURLClassLoader extends URLClassLoader
+    {
+
+        public CustomURLClassLoader(URL[] urls)
+        {
+            super(urls);
+        }
+
+        @Override
+        protected Class findClass(String name) throws ClassNotFoundException
+        {
+            // This is only called via this.loadClass -> super.loadClass ->
+            // this.findClass, after this.loadClass has already called
+            // super.findClass, so no need to call super.findClass again:
+            throw new ClassNotFoundException(name);
+        }
+
+        protected Class loadClass(String name, boolean resolve)
+                throws ClassNotFoundException
+        {
+            Class c = findLoadedClass(name);
+            if (c == null)
+            {
+                try
+                {
+                    c = super.findClass(name);
+                }
+                catch (ClassNotFoundException e)
+                {
+                    return super.loadClass(name, resolve);
+                }
+                catch (SecurityException e)
+                {
+                    // A SecurityException "Prohibited package name: java.lang"
+                    // may occur when the user added the JVM's rt.jar to the
+                    // java.class.path:
+                    return super.loadClass(name, resolve);
+                }
+            }
+            if (resolve)
+            {
+                resolveClass(c);
+            }
+            return c;
+        }
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/loader/InstallationFinder.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/loader/InstallationFinder.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/loader/InstallationFinder.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,716 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile: InstallationFinder.java,v $
+ * $Revision: 1.1 $
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+package org.openoffice.jdbc.loader;
+
+import java.io.BufferedReader;
+import java.io.File;
+import java.io.FileInputStream;
+import java.io.InputStream;
+import java.io.InputStreamReader;
+import java.io.IOException;
+import java.io.UnsupportedEncodingException;
+import java.net.MalformedURLException;
+import java.net.URL;
+import java.util.StringTokenizer;
+import java.util.Vector;
+
+/**
+ * This class finds a UNO installation on the system.
+ *
+ * <p>A UNO installation can be specified by the user by either setting the
+ * com.sun.star.lib.loader.unopath system property or by setting the
+ * UNO_PATH environment variable to the program directory of a UNO
+ * installation.
+ * Note, that Java 1.3.1 and Java 1.4 don't support environment variables
+ * (System.getenv() throws java.lang.Error) and therefore setting the UNO_PATH
+ * enviroment variable won't work with those Java versions.
+ * If no UNO installation is specified by the user, the default installation
+ * on the system will be returned.</p>
+ *   
+ * <p>On the Windows platform the default installation is read from the Windows
+ * Registry.</p>
+ *   
+ * <p>On the Unix/Linux platforms the default installation is found from the
+ * PATH environment variable. Note, that for Java 1.3.1 and Java 1.4 the
+ * default installation is found by using the 'which' command, because
+ * environment variables are not supported with those Java versions.
+ * Both methods require that the 'soffice' executable or a symbolic
+ * link is in one of the directories listed in the PATH environment variable.
+ * For older versions than OOo 2.0 the above described methods may fail.
+ * In this case the default installation is taken from the .sversionrc file in
+ * the user's home directory. Note, that the .sversionrc file will be omitted
+ * for OOo 2.0</p>
+ */
+final class InstallationFinder
+{
+
+    public static final String SYSPROP_NAME =
+            "com.sun.star.lib.loader.unopath";
+    private static final String ENVVAR_NAME = "UNO_PATH";
+    private static final String SOFFICE = "soffice"; // Unix/Linux only
+
+    private InstallationFinder()
+    {
+    } // do not instantiate
+
+    /**
+     * Gets the path of a UNO installation.
+     *                                 
+     * @return the installation path or <code>null</code>, if no installation
+     *         was specified or found, or if an error occured     
+     */
+    public static String getPath()
+    {
+
+        String path = null;
+
+        // get the installation path from the Java system property
+        // com.sun.star.lib.loader.unopath
+        // (all platforms)
+        path = getPathFromProperty(SYSPROP_NAME);
+        if (path == null)
+        {
+            // get the installation path from the UNO_PATH environment variable
+            // (all platforms, not working for Java 1.3.1 and Java 1.4)
+            path = getPathFromEnvVar( ENVVAR_NAME );
+            if (path == null)
+            {
+                String osname = null;
+                try
+                {
+                    osname = System.getProperty("os.name");
+                }
+                catch (SecurityException e)
+                {
+                    // if a SecurityException was thrown,
+                    // return <code>null</code>
+                    return null;
+                }
+                if (osname != null)
+                {
+                    if (osname.startsWith("Windows"))
+                    {
+                        // get the installation path from the Windows Registry
+                        // (Windows platform only)
+                        path = getPathFromWindowsRegistry();
+                    }
+                    else
+                    {
+                        // get the installation path from the PATH environment
+                        // variable (Unix/Linux platforms only, not working for
+                        // Java 1.3.1 and Java 1.4)
+                        path = getPathFromPathEnvVar();
+                        if (path == null)
+                        {
+                            // get the installation path from the 'which'
+                            // command (Unix/Linux platforms only)
+                            path = getPathFromWhich();
+                            if (path == null)
+                            {
+                                // get the installation path from the
+                                // .sversionrc file (Unix/Linux platforms only,
+                                // for older versions than OOo 2.0)
+                                path = getPathFromSVersionFile();
+                            }
+                        }
+                    }
+                }
+            }
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from a Java system property.
+     *
+     * <p>This method is called on all platforms.
+     * The Java system property can be passed into the application by using
+     * the -D flag, e.g.
+     * java -D<property name>=<installation path> -jar application.jar.</p>
+     *                          
+     * @return the installation path or <code>null</code>, if no installation
+     *         was specified in the Java system property or if an error occured
+     */
+    private static String getPathFromProperty(String prop)
+    {
+
+        String path = null;
+
+        try
+        {
+            path = System.getProperty(prop);
+        }
+        catch (SecurityException e)
+        {
+            // if a SecurityException was thrown, return <code>null</code>
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from an environment variable.
+     *   
+     * <p>This method is called on all platforms.
+     * Note, that in Java 1.3.1 and Java 1.4 System.getenv() throws 
+     * java.lang.Error and therefore this method returns null for those 
+     * Java versions.</p>
+     *
+     * @return the installation path or <code>null</code>, if no installation
+     *         was specified in the environment variable or if an error occured
+     */
+    private static String getPathFromEnvVar(String var)
+    {
+
+        String path = null;
+
+        try
+        {
+            path = System.getenv(var);
+        }
+        catch (SecurityException e)
+        {
+            // if a SecurityException was thrown, return <code>null</code>
+        }
+        catch (java.lang.Error err)
+        {
+            // System.getenv() throws java.lang.Error in Java 1.3.1 and 
+            // Java 1.4
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from the Windows Registry.
+     *
+     * <p>This method is called on the Windows platform only.</p>
+     *   
+     * @return the installation path or <code>null</code>, if no installation
+     *         was found or if an error occured     
+     */
+    private static String getPathFromWindowsRegistry()
+    {
+
+        final String SUBKEYNAME = "Software\\OpenOffice.org\\UNO\\InstallPath";
+
+        String path = null;
+
+        try
+        {
+            // read the key's default value from HKEY_CURRENT_USER
+            WinRegKey key = new WinRegKey("HKEY_CURRENT_USER", SUBKEYNAME);
+            path = key.getStringValue(""); // default            
+        }
+        catch (WinRegKeyException e)
+        {
+            try
+            {
+                // read the key's default value from HKEY_LOCAL_MACHINE
+                WinRegKey key = new WinRegKey("HKEY_LOCAL_MACHINE",
+                        SUBKEYNAME);
+                path = key.getStringValue(""); // default                
+            }
+            catch (WinRegKeyException we)
+            {
+                System.err.println("com.sun.star.lib.loader." +
+                        "InstallationFinder::getPathFromWindowsRegistry: " +
+                        "reading key from Windows Registry failed: " + we);
+            }
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from the PATH environment variable.
+     *
+     * <p>This method is called on Unix/Linux platforms only.
+     * An installation is found, if the executable 'soffice' or a symbolic link
+     * is in one of the directories listed in the PATH environment variable.
+     * Note, that in Java 1.3.1 and Java 1.4 System.getenv() throws
+     * java.lang.Error and therefore this method returns null for those
+     * Java versions.</p>
+     *
+     * @return the installation path or <code>null</code>, if no installation
+     *         was found or if an error occured
+     */
+    private static String getPathFromPathEnvVar()
+    {
+
+        final String PATH_ENVVAR_NAME = "PATH";
+
+        String path = null;
+        String str = null;
+
+        try
+        {
+            str = System.getenv(PATH_ENVVAR_NAME);
+        }
+        catch (SecurityException e)
+        {
+            // if a SecurityException was thrown, return <code>null</code>
+            return null;
+        }
+        catch (java.lang.Error err)
+        {
+            // System.getenv() throws java.lang.Error in Java 1.3.1 and 
+            // Java 1.4
+            return null;
+        }
+
+        if (str != null)
+        {
+            StringTokenizer tokens = new StringTokenizer(
+                    str, File.pathSeparator);
+            while (tokens.hasMoreTokens())
+            {
+                File file = new File(tokens.nextToken(), SOFFICE);
+                try
+                {
+                    if (file.exists())
+                    {
+                        try
+                        {
+                            // resolve symlink
+                            path = file.getCanonicalFile().getParent();
+                            if (path != null)
+                            {
+                                break;
+                            }
+                        }
+                        catch (IOException e)
+                        {
+                            // if an I/O exception is thrown, ignore this
+                            // path entry and try the next one
+                            System.err.println("com.sun.star.lib.loader." +
+                                    "InstallationFinder::getPathFromEnvVar: " +
+                                    "bad path: " + e);
+                        }
+                    }
+                }
+                catch (SecurityException e)
+                {
+                    // if a SecurityException was thrown, ignore this path
+                    // entry and try the next one
+                }
+            }
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from the 'which' command on Unix/Linux
+     * platforms.
+     *
+     * <p>This method is called on Unix/Linux platforms only.
+     * An installation is found, if the executable 'soffice' or a symbolic link
+     * is in one of the directories listed in the PATH environment variable.</p>
+     *   
+     * @return the installation path or <code>null</code>, if no installation
+     *         was found or if an error occured
+     */
+    private static String getPathFromWhich()
+    {
+
+        final String WHICH = "which";
+
+        String path = null;
+
+        // start the which process
+        String[] cmdArray = new String[2];
+        cmdArray[0] = WHICH;
+        cmdArray[1] = SOFFICE;
+        Process proc = null;
+        Runtime rt = Runtime.getRuntime();
+        try
+        {
+            proc = rt.exec(cmdArray);
+        }
+        catch (SecurityException e)
+        {
+            return null;
+        }
+        catch (IOException e)
+        {
+            // if an I/O exception is thrown, return <code>null</null>
+            System.err.println("com.sun.star.lib.loader." +
+                    "InstallationFinder::getPathFromWhich: " +
+                    "which command failed: " + e);
+            return null;
+        }
+
+        // empty standard error stream in a seperate thread
+        StreamGobbler gobbler = new StreamGobbler(proc.getErrorStream());
+        gobbler.start();
+
+        // read the which output from standard input stream
+        BufferedReader br = new BufferedReader(
+                new InputStreamReader(proc.getInputStream()));
+        String line = null;
+        try
+        {
+            while ((line = br.readLine()) != null)
+            {
+                if (path == null)
+                {
+                    // get the path from the which output
+                    int index = line.lastIndexOf(SOFFICE);
+                    if (index != -1)
+                    {
+                        int end = index + SOFFICE.length();
+                        for (int i = 0; i <= index; i++)
+                        {
+                            File file = new File(line.substring(i, end));
+                            try
+                            {
+                                if (file.exists())
+                                {
+                                    // resolve symlink
+                                    path = file.getCanonicalFile().getParent();
+                                    if (path != null)
+                                    {
+                                        break;
+                                    }
+                                }
+                            }
+                            catch (SecurityException e)
+                            {
+                                return null;
+                            }
+                        }
+                    }
+                }
+            }
+        }
+        catch (IOException e)
+        {
+            // if an I/O exception is thrown, return <code>null</null>
+            System.err.println("com.sun.star.lib.loader." +
+                    "InstallationFinder::getPathFromWhich: " +
+                    "reading which command output failed: " + e);
+            return null;
+        } finally
+        {
+            if (br != null)
+            {
+                try
+                {
+                    br.close();
+                }
+                catch (IOException e)
+                {
+                    // closing standard input stream failed, ignore
+                }
+            }
+        }
+
+        try
+        {
+            // wait until the which process has terminated
+            proc.waitFor();
+        }
+        catch (InterruptedException e)
+        {
+            // the current thread was interrupted by another thread,
+            // kill the which process
+            proc.destroy();
+            // set the interrupted status
+            Thread.currentThread().interrupt();
+        }
+
+        return path;
+    }
+
+    /**
+     * Gets the installation path from the .sverionrc file in the user's home
+     * directory.
+     *
+     * <p>This method is called on Unix/Linux platforms only.
+     * The .sversionrc file is written during setup and will be omitted for
+     * OOo 2.0.</p>
+     *
+     * @return the installation path or <code>null</code>, if no installation
+     *         was found or if an error occured     
+     */
+    private static String getPathFromSVersionFile()
+    {
+
+        final String SVERSION = ".sversionrc"; // Unix/Linux only
+        final String VERSIONS = "[Versions]";
+
+        String path = null;
+
+        try
+        {
+            File fSVersion = new File(
+                    System.getProperty("user.home"), SVERSION);
+            if (fSVersion.exists())
+            {
+                Vector<String> lines = new Vector<String>();
+                BufferedReader br = null;
+                try
+                {
+                    br = new BufferedReader(new InputStreamReader(
+                            new FileInputStream(fSVersion), "UTF-8"));
+                    String line = null;
+                    while ((line = br.readLine()) != null &&
+                            (line.equals(VERSIONS)) != true)
+                    {
+                        // read lines until [Versions] is found
+                    }
+                    while ((line = br.readLine()) != null &&
+                            line.length() != 0)
+                    {
+                        if (!line.startsWith(";"))
+                        {
+                            lines.add(line);
+                        }
+                    }
+                }
+                catch (IOException e)
+                {
+                    // if an I/O exception is thrown, try to analyze the lines
+                    // read so far
+                    System.err.println("com.sun.star.lib.loader." +
+                            "InstallationFinder::getPathFromSVersionFile: " +
+                            "reading .sversionrc file failed: " + e);
+                } finally
+                {
+                    if (br != null)
+                    {
+                        try
+                        {
+                            br.close();
+                        }
+                        catch (IOException e)
+                        {
+                            // closing .sversionrc failed, ignore
+                        }
+                    }
+                }
+                for (int i = lines.size() - 1; i >= 0; i--)
+                {
+                    StringTokenizer tokens = new StringTokenizer(
+                            (String) lines.elementAt(i), "=");
+                    if (tokens.countTokens() != 2)
+                    {
+                        continue;
+                    }
+                    String key = tokens.nextToken();
+                    String url = tokens.nextToken();
+                    path = getCanonicalPathFromFileURL(url);
+                    if (path != null)
+                    {
+                        break;
+                    }
+                }
+            }
+        }
+        catch (SecurityException e)
+        {
+            return null;
+        }
+
+        return path;
+    }
+
+    /**
+     * Translates an OOo-internal absolute file URL reference (encoded using
+     * UTF-8) into a Java canonical pathname.
+     *
+     * @param oooUrl any URL reference; any fragment part is ignored
+     *
+     * @return if the given URL is a valid absolute, local (that is, the host
+     * part is empty or equal to "localhost", ignoring case) file URL, it is
+     * converted into an absolute canonical pathname; otherwise,
+     * <code>null</code> is returned
+     */
+    private static String getCanonicalPathFromFileURL(String oooUrl)
+    {
+
+        String prefix = "file://";
+        if (oooUrl.length() < prefix.length() || !oooUrl.substring(0, prefix.length()).toLowerCase().equals(
+                prefix))
+        {
+            return null;
+        }
+        StringBuffer buf = new StringBuffer(prefix);
+        int n = oooUrl.indexOf('/', prefix.length());
+        if (n < 0)
+        {
+            n = oooUrl.length();
+        }
+        String host = oooUrl.substring(prefix.length(), n);
+        if (host.length() != 0 && !host.toLowerCase().equals("localhost"))
+        {
+            return null;
+        }
+        buf.append(host);
+        if (n == oooUrl.length())
+        {
+            buf.append('/');
+        }
+        else
+        {
+            loop:
+            while (n < oooUrl.length())
+            {
+                buf.append('/');
+                ++n;
+                int n2 = oooUrl.indexOf('/', n);
+                if (n2 < 0)
+                {
+                    n2 = oooUrl.length();
+                }
+                while (n < n2)
+                {
+                    char c = oooUrl.charAt(n);
+                    switch (c)
+                    {
+                        case '%':
+                            byte[] bytes = new byte[(n2 - n) / 3];
+                            int len = 0;
+                            while (oooUrl.length() - n > 2 && oooUrl.charAt(n) == '%')
+                            {
+                                int d1 = Character.digit(oooUrl.charAt(n + 1), 16);
+                                int d2 = Character.digit(oooUrl.charAt(n + 2), 16);
+                                if (d1 < 0 || d2 < 0)
+                                {
+                                    break;
+                                }
+                                int d = 16 * d1 + d2;
+                                if (d == '/')
+                                {
+                                    return null;
+                                }
+                                bytes[len++] = (byte) d;
+                                n += 3;
+                            }
+                            String s;
+                            try
+                            {
+                                s = new String(bytes, 0, len, "UTF-8");
+                            }
+                            catch (UnsupportedEncodingException e)
+                            {
+                                return null;
+                            }
+                            buf.append(s);
+                            break;
+
+                        case '#':
+                            break loop;
+
+                        default:
+                            buf.append(c);
+                            ++n;
+                            break;
+                    }
+                }
+            }
+        }
+        URL url;
+        try
+        {
+            url = new URL(buf.toString());
+        }
+        catch (MalformedURLException e)
+        {
+            return null;
+        }
+        String path = url.getFile();
+        String fragment = url.getRef();
+        if (fragment != null)
+        {
+            path += '#' + fragment;
+        }
+        String ret = null;
+        File file = new File(path, SOFFICE);
+        try
+        {
+            if (file.isAbsolute() && file.exists())
+            {
+                try
+                {
+                    // resolve symlink
+                    ret = file.getCanonicalFile().getParent();
+                }
+                catch (IOException e)
+                {
+                    return null;
+                }
+            }
+        }
+        catch (SecurityException e)
+        {
+            return null;
+        }
+
+        return ret;
+    }
+
+    /**
+    This class is used for emptying any stream which is passed into it in
+    a separate thread.
+     */
+    private static final class StreamGobbler extends Thread
+    {
+
+        InputStream m_istream;
+
+        StreamGobbler(InputStream istream)
+        {
+            m_istream = istream;
+        }
+
+        @Override
+        public void run()
+        {
+            try
+            {
+                BufferedReader br = new BufferedReader(
+                        new InputStreamReader(m_istream));
+                // read from input stream
+                while (br.readLine() != null)
+                {
+                    // don't handle line content
+                }
+                br.close();
+            }
+            catch (IOException e)
+            {
+                // stop reading from input stream
+            }
+        }
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSet.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSet.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSet.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,1981 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.beans.PropertyVetoException;
+import com.sun.star.beans.UnknownPropertyException;
+import com.sun.star.beans.XPropertySet;
+import com.sun.star.io.XInputStream;
+import com.sun.star.lang.IllegalArgumentException;
+import com.sun.star.lang.WrappedTargetException;
+import com.sun.star.sdbc.XCloseable;
+import com.sun.star.sdbc.XColumnLocate;
+import com.sun.star.sdbc.XResultSet;
+import com.sun.star.sdbc.XResultSetMetaDataSupplier;
+import com.sun.star.sdbc.XResultSetUpdate;
+import com.sun.star.sdbc.XRow;
+import com.sun.star.sdbc.XRowUpdate;
+import com.sun.star.sdbc.XWarningsSupplier;
+import com.sun.star.uno.Any;
+import com.sun.star.uno.UnoRuntime;
+import com.sun.star.util.DateTime;
+import java.io.InputStream;
+import java.io.Reader;
+import java.math.BigDecimal;
+import java.net.URL;
+import java.sql.Array;
+import java.sql.Blob;
+import java.sql.Clob;
+import java.sql.Date;
+import java.sql.NClob;
+import java.sql.Ref;
+import java.sql.ResultSetMetaData;
+import java.sql.RowId;
+import java.sql.SQLException;
+import java.sql.SQLWarning;
+import java.sql.SQLXML;
+import java.sql.Statement;
+import java.sql.Time;
+import java.sql.Timestamp;
+import java.util.Calendar;
+import java.util.Map;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoResultSet implements java.sql.ResultSet
+{
+
+    final private XResultSet result;
+    final private XRow row;
+    final private XRowUpdate up;
+    final private XResultSetUpdate resUp;
+    final private XPropertySet prop;
+    final private XColumnLocate col;
+    final private XCloseable closeable;
+    final private XResultSetMetaDataSupplier sup;
+    final private OOoStatement statement;
+    final private XWarningsSupplier warning;
+
+    OOoResultSet(OOoStatement state, XResultSet res)
+    {
+        statement = state;
+        result = res;
+        prop = (XPropertySet) UnoRuntime.queryInterface(XPropertySet.class, res);
+        row = (XRow) UnoRuntime.queryInterface(XRow.class, res);
+        col = (XColumnLocate) UnoRuntime.queryInterface(XColumnLocate.class, res);
+        up = (XRowUpdate) UnoRuntime.queryInterface(XRowUpdate.class, res);
+        resUp = (XResultSetUpdate) UnoRuntime.queryInterface(XResultSetUpdate.class, res);
+        sup = (XResultSetMetaDataSupplier) UnoRuntime.queryInterface(XResultSetMetaDataSupplier.class, res);
+        closeable = (XCloseable) UnoRuntime.queryInterface(XCloseable.class, res);
+        warning = (XWarningsSupplier) UnoRuntime.queryInterface(XWarningsSupplier.class, res);
+    }
+
+    public boolean next() throws SQLException
+    {
+        try
+        {
+            return result.next();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void close() throws SQLException
+    {
+        try
+        {
+            closeable.close();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean wasNull() throws SQLException
+    {
+        try
+        {
+            return row.wasNull();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getString(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getString(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean getBoolean(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getBoolean(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public byte getByte(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getByte(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public short getShort(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getShort(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public int getInt(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getInt(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public long getLong(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getLong(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public float getFloat(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getFloat(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public double getDouble(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getDouble(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public BigDecimal getBigDecimal(int columnIndex, int scale) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public byte[] getBytes(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return row.getBytes(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+    static private java.sql.Date getDate(final Object obj)
+    {
+        final java.sql.Date date;
+        if (obj instanceof com.sun.star.util.Date)
+        {
+            final com.sun.star.util.Date unodate = (com.sun.star.util.Date) obj;
+            date = java.sql.Date.valueOf(getDateString(unodate.Year, unodate.Month, unodate.Day).toString());
+        }
+        else
+        {
+            date = null;
+        }
+        return date;
+    }
+
+    private static StringBuffer getTimeString(final int hours, final int minutes, final int seconds)
+    {
+        final StringBuffer timeString = new StringBuffer();
+        if (hours < 10)
+        {
+            timeString.append('0');
+        }
+        timeString.append(hours);
+        timeString.append(':');
+        if (minutes < 10)
+        {
+            timeString.append('0');
+        }
+        timeString.append(minutes);
+        timeString.append(':');
+        if (seconds < 10)
+        {
+            timeString.append('0');
+        }
+        timeString.append(seconds);
+        return timeString;
+    }
+
+    static private StringBuffer getDateString(final int years, final int months, final int days)
+    {
+        final StringBuffer str = new StringBuffer();
+        str.append(years);
+        final StringBuffer str2 = new StringBuffer("0000");
+        str2.delete(0, str.length());
+        str.insert(0, str2);
+        str.append('-');
+        if (months < 10)
+        {
+            str.append('0');
+        }
+        str.append(months);
+        str.append('-');
+        if (days < 10)
+        {
+            str.append('0');
+        }
+        str.append(days);
+        return str;
+    }
+
+    static private java.sql.Time getTime(final Object obj)
+    {
+        final java.sql.Time time;
+        if (obj instanceof com.sun.star.util.Time)
+        {
+            final com.sun.star.util.Time unoTime = (com.sun.star.util.Time) obj;
+            time = java.sql.Time.valueOf(getTimeString(unoTime.Hours, unoTime.Minutes, unoTime.Seconds).toString());
+        }
+        else
+        {
+            time = null;
+        }
+        return time;
+    }
+
+    static private Timestamp getTimestamp(final Object obj)
+    {
+        final Timestamp ts;
+        if (obj instanceof com.sun.star.util.DateTime)
+        {
+            final com.sun.star.util.DateTime unoTs = (DateTime) obj;
+            final StringBuffer str = getDateString(unoTs.Year, unoTs.Month, unoTs.Day);
+            str.append(' ');
+            str.append(getTimeString(unoTs.Hours, unoTs.Minutes, unoTs.Seconds));
+            str.append('.');
+            str.append(unoTs.HundredthSeconds);
+            ts = java.sql.Timestamp.valueOf(str.toString());
+        }
+        else
+        {
+            ts = null;
+        }
+        return ts;
+    }
+    static public Object convertToJava(final Object x)
+    {
+        final Object val;
+        if ( x == null )
+        {
+            val = null;
+        }
+        else if ( x instanceof com.sun.star.util.Date )
+        {
+            val = getDate(x);
+        }
+        else if ( x instanceof com.sun.star.util.DateTime )
+        {
+            val = getTimestamp(x);
+        }
+        else if (x instanceof com.sun.star.util.Time)
+        {
+            val = getTime(x);
+        }
+        else if (x instanceof XInputStream)
+        {
+            val = new com.sun.star.lib.uno.adapter.XInputStreamToInputStreamAdapter((XInputStream)x);
+        }
+        else if (x instanceof com.sun.star.sdbc.SQLWarning)
+        {
+            final com.sun.star.sdbc.SQLWarning w = (com.sun.star.sdbc.SQLWarning)x;
+            val = new SQLWarning(w.getMessage(),w.SQLState);
+        }
+        else if ( x instanceof Any )
+        {
+            Any a = (Any)x;
+            if ( a.equals(Any.VOID) )
+                val = null;
+            else
+                val = a.getObject();
+        }
+        else
+            val = x;
+        return val;
+    }
+
+    public Date getDate(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (Date)convertToJava(row.getDate(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Time getTime(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (Time)convertToJava(row.getTime(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+
+
+    }
+
+    public Timestamp getTimestamp(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (Timestamp)convertToJava(row.getTimestamp(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public InputStream getAsciiStream(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (InputStream)convertToJava(row.getCharacterStream(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public InputStream getUnicodeStream(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (InputStream)convertToJava(row.getCharacterStream(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public InputStream getBinaryStream(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return (InputStream)convertToJava(row.getBinaryStream(columnIndex));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getString(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getString(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public boolean getBoolean(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getBoolean(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public byte getByte(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getByte(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public short getShort(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getShort(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public int getInt(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getInt(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public long getLong(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getLong(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public float getFloat(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getFloat(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public double getDouble(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getDouble(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public BigDecimal getBigDecimal(String columnLabel, int scale) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public byte[] getBytes(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getBytes(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public Date getDate(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getDate(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public Time getTime(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getTime(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public Timestamp getTimestamp(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getTimestamp(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+
+        }
+    }
+
+    public InputStream getAsciiStream(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getAsciiStream(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public InputStream getUnicodeStream(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getUnicodeStream(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public InputStream getBinaryStream(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getBinaryStream(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public SQLWarning getWarnings() throws SQLException
+    {
+        try
+        {
+            return (SQLWarning) convertToJava(warning.getWarnings());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void clearWarnings() throws SQLException
+    {
+        try
+        {
+            warning.clearWarnings();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getCursorName() throws SQLException
+    {
+        try
+        {
+            return (String) (prop.getPropertyValue("CursorName"));
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public ResultSetMetaData getMetaData() throws SQLException
+    {
+        try
+        {
+            return new OOoResultSetMetaData(sup.getMetaData());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object getObject(int columnIndex) throws SQLException
+    {
+        try
+        {
+            return convertToJava(row.getObject(columnIndex, null));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object getObject(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return getObject(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int findColumn(String columnLabel) throws SQLException
+    {
+        try
+        {
+            return col.findColumn(columnLabel);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Reader getCharacterStream(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getCharacterStream(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public BigDecimal getBigDecimal(int columnIndex) throws SQLException
+    {
+        return new BigDecimal(getString(columnIndex));
+    }
+
+    public BigDecimal getBigDecimal(String columnLabel) throws SQLException
+    {
+        return new BigDecimal(getString(findColumn(columnLabel)));
+    }
+
+    public boolean isBeforeFirst() throws SQLException
+    {
+        try
+        {
+            return result.isBeforeFirst();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isAfterLast() throws SQLException
+    {
+        try
+        {
+            return result.isAfterLast();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isFirst() throws SQLException
+    {
+        try
+        {
+            return result.isFirst();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isLast() throws SQLException
+    {
+        try
+        {
+            return result.isLast();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void beforeFirst() throws SQLException
+    {
+        try
+        {
+            result.beforeFirst();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void afterLast() throws SQLException
+    {
+        try
+        {
+            result.afterLast();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean first() throws SQLException
+    {
+        try
+        {
+            return result.first();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean last() throws SQLException
+    {
+        try
+        {
+            return result.last();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getRow() throws SQLException
+    {
+        try
+        {
+            return result.getRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean absolute(int row) throws SQLException
+    {
+        try
+        {
+            return result.absolute(row);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean relative(int rows) throws SQLException
+    {
+        try
+        {
+            return result.relative(rows);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean previous() throws SQLException
+    {
+        try
+        {
+            return result.previous();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setFetchDirection(int direction) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("FetchDirection", new Integer(direction));
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getFetchDirection() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("FetchDirection"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public void setFetchSize(int rows) throws SQLException
+    {
+        try
+        {
+            prop.setPropertyValue("FetchSize", new Integer(rows));
+        }
+        catch (IllegalArgumentException ex)
+        {
+            throw new SQLException();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (PropertyVetoException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getFetchSize() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("FetchSize"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getType() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("Type"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public int getConcurrency() throws SQLException
+    {
+        try
+        {
+            return ((Integer) (prop.getPropertyValue("Concurrency"))).intValue();
+        }
+        catch (UnknownPropertyException ex)
+        {
+            throw new SQLException();
+        }
+        catch (WrappedTargetException ex)
+        {
+            throw new SQLException();
+        }
+    }
+
+    public boolean rowUpdated() throws SQLException
+    {
+        try
+        {
+            return result.rowUpdated();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean rowInserted() throws SQLException
+    {
+        try
+        {
+            return result.rowInserted();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean rowDeleted() throws SQLException
+    {
+        try
+        {
+            return result.rowDeleted();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateNull(int columnIndex) throws SQLException
+    {
+        try
+        {
+            up.updateNull(columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBoolean(int columnIndex, boolean x) throws SQLException
+    {
+        try
+        {
+            up.updateBoolean(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateByte(int columnIndex, byte x) throws SQLException
+    {
+        try
+        {
+            up.updateByte(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateShort(int columnIndex, short x) throws SQLException
+    {
+        try
+        {
+            up.updateShort(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateInt(int columnIndex, int x) throws SQLException
+    {
+        try
+        {
+            up.updateInt(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateLong(int columnIndex, long x) throws SQLException
+    {
+        try
+        {
+            up.updateLong(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateFloat(int columnIndex, float x) throws SQLException
+    {
+        try
+        {
+            up.updateFloat(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateDouble(int columnIndex, double x) throws SQLException
+    {
+        try
+        {
+            up.updateDouble(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBigDecimal(int columnIndex, BigDecimal x) throws SQLException
+    {
+        updateString(columnIndex,x.toString());
+    }
+
+    public void updateString(int columnIndex, String x) throws SQLException
+    {
+        try
+        {
+            up.updateString(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBytes(int columnIndex, byte[] x) throws SQLException
+    {
+        try
+        {
+            up.updateBytes(columnIndex, x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateDate(int columnIndex, Date x) throws SQLException
+    {
+        try
+        {
+            up.updateDate(columnIndex, null);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateTime(int columnIndex, Time x) throws SQLException
+    {
+        try
+        {
+            up.updateTime(columnIndex, null);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateTimestamp(int columnIndex, Timestamp x) throws SQLException
+    {
+        try
+        {
+            up.updateTimestamp(columnIndex, null);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateAsciiStream(int columnIndex, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(int columnIndex, InputStream x, int length) throws SQLException
+    {
+        try
+        {
+            up.updateBinaryStream(columnIndex, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), length);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateCharacterStream(int columnIndex, Reader x, int length) throws SQLException
+    {
+        try
+        {
+            up.updateCharacterStream(columnIndex, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), length);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateObject(int columnIndex, Object x, int scaleOrLength) throws SQLException
+    {
+        try
+        {
+            up.updateObject(columnIndex, OOoPreparedStatement.convertFromJavaObject(x));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateObject(int columnIndex, Object x) throws SQLException
+    {
+        try
+        {
+            up.updateObject(columnIndex, OOoPreparedStatement.convertFromJavaObject(x));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateNull(String columnLabel) throws SQLException
+    {
+        try
+        {
+            updateNull(col.findColumn(columnLabel));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBoolean(String columnLabel, boolean x) throws SQLException
+    {
+        try
+        {
+            updateBoolean(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateByte(String columnLabel, byte x) throws SQLException
+    {
+        try
+        {
+            updateByte(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateShort(String columnLabel, short x) throws SQLException
+    {
+        try
+        {
+            updateShort(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateInt(String columnLabel, int x) throws SQLException
+    {
+        try
+        {
+            updateInt(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateLong(String columnLabel, long x) throws SQLException
+    {
+        try
+        {
+            updateLong(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateFloat(String columnLabel, float x) throws SQLException
+    {
+        try
+        {
+            updateFloat(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateDouble(String columnLabel, double x) throws SQLException
+    {
+        try
+        {
+            updateDouble(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBigDecimal(String columnLabel, BigDecimal x) throws SQLException
+    {
+        updateString(columnLabel,x.toString());
+    }
+
+    public void updateString(String columnLabel, String x) throws SQLException
+    {
+        try
+        {
+            updateString(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateBytes(String columnLabel, byte[] x) throws SQLException
+    {
+        try
+        {
+            updateBytes(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateDate(String columnLabel, Date x) throws SQLException
+    {
+        try
+        {
+            updateDate(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateTime(String columnLabel, Time x) throws SQLException
+    {
+        try
+        {
+            updateTime(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateTimestamp(String columnLabel, Timestamp x) throws SQLException
+    {
+        try
+        {
+            updateTimestamp(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateAsciiStream(String columnLabel, InputStream x, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(String columnLabel, InputStream x, int length) throws SQLException
+    {
+        try
+        {
+            up.updateBinaryStream(length, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), length);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateCharacterStream(String columnLabel, Reader reader, int length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateObject(String columnLabel, Object x, int scaleOrLength) throws SQLException
+    {
+        updateObject(columnLabel, x);
+    }
+
+    public void updateObject(String columnLabel, Object x) throws SQLException
+    {
+        try
+        {
+            updateObject(col.findColumn(columnLabel), x);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void insertRow() throws SQLException
+    {
+        try
+        {
+            resUp.insertRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateRow() throws SQLException
+    {
+        try
+        {
+            resUp.updateRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void deleteRow() throws SQLException
+    {
+        try
+        {
+            resUp.deleteRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void refreshRow() throws SQLException
+    {
+        try
+        {
+            result.refreshRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void cancelRowUpdates() throws SQLException
+    {
+        try
+        {
+            resUp.cancelRowUpdates();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void moveToInsertRow() throws SQLException
+    {
+        try
+        {
+            resUp.moveToInsertRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void moveToCurrentRow() throws SQLException
+    {
+        try
+        {
+            resUp.moveToCurrentRow();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Statement getStatement() throws SQLException
+    {
+        return statement;
+    }
+
+    public Ref getRef(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Blob getBlob(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Clob getClob(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Array getArray(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Ref getRef(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Blob getBlob(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Clob getClob(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Array getArray(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Date getDate(int columnIndex, Calendar cal) throws SQLException
+    {
+        return getDate(columnIndex);
+    }
+
+    public Date getDate(String columnLabel, Calendar cal) throws SQLException
+    {
+        return getDate(findColumn(columnLabel));
+    }
+
+    public Time getTime(int columnIndex, Calendar cal) throws SQLException
+    {
+        return getTime(columnIndex);
+    }
+
+    public Time getTime(String columnLabel, Calendar cal) throws SQLException
+    {
+        return getTime(findColumn(columnLabel));
+    }
+
+    public Timestamp getTimestamp(int columnIndex, Calendar cal) throws SQLException
+    {
+        return getTimestamp(columnIndex);
+    }
+
+    public Timestamp getTimestamp(String columnLabel, Calendar cal) throws SQLException
+    {
+        return getTimestamp(findColumn(columnLabel));
+    }
+
+    public URL getURL(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public URL getURL(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateRef(int columnIndex, Ref x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateRef(String columnLabel, Ref x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(int columnIndex, Blob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(String columnLabel, Blob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(int columnIndex, Clob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(String columnLabel, Clob x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateArray(int columnIndex, Array x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateArray(String columnLabel, Array x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int getHoldability() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isClosed() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNString(int columnIndex, String nString) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNString(String columnLabel, String nString) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getNString(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getNString(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getNCharacterStream(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Reader getNCharacterStream(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNCharacterStream(int columnIndex, Reader x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNCharacterStream(String columnLabel, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateAsciiStream(int columnIndex, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(int columnIndex, InputStream x, long length) throws SQLException
+    {
+        try
+        {
+            up.updateBinaryStream(columnIndex, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), (int) length);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateCharacterStream(int columnIndex, Reader x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateAsciiStream(String columnLabel, InputStream x, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(String columnLabel, InputStream x, long length) throws SQLException
+    {
+        updateBinaryStream(findColumn(columnLabel), x);
+    }
+
+    public void updateCharacterStream(String columnLabel, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(int columnIndex, InputStream inputStream, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(String columnLabel, InputStream inputStream, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(int columnIndex, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(String columnLabel, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(int columnIndex, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(String columnLabel, Reader reader, long length) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNCharacterStream(int columnIndex, Reader x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNCharacterStream(String columnLabel, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateAsciiStream(int columnIndex, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(int columnIndex, InputStream x) throws SQLException
+    {
+        try
+        {
+            up.updateBinaryStream(columnIndex, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateCharacterStream(int columnIndex, Reader x) throws SQLException
+    {
+        try
+        {
+            up.updateCharacterStream(columnIndex, (XInputStream) OOoPreparedStatement.convertFromJavaObject(x), columnIndex);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void updateAsciiStream(String columnLabel, InputStream x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBinaryStream(String columnLabel, InputStream x) throws SQLException
+    {
+        updateBinaryStream(findColumn(columnLabel),x);
+    }
+
+    public void updateCharacterStream(String columnLabel, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(int columnIndex, InputStream inputStream) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateBlob(String columnLabel, InputStream inputStream) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(int columnIndex, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateClob(String columnLabel, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(int columnIndex, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(String columnLabel, Reader reader) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object getObject(int i, Map map) throws SQLException
+    {
+        try
+        {
+            return convertToJava(row.getObject(i, null));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object getObject(String colName, Map map) throws SQLException
+    {
+        try
+        {
+            return convertToJava(row.getObject(col.findColumn(colName), null));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public RowId getRowId(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public RowId getRowId(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateRowId(int columnIndex, RowId x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateRowId(String columnLabel, RowId x) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(int columnIndex, NClob nClob) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateNClob(String columnLabel, NClob nClob) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public NClob getNClob(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public NClob getNClob(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public SQLXML getSQLXML(int columnIndex) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public SQLXML getSQLXML(String columnLabel) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateSQLXML(int columnIndex, SQLXML xmlObject) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void updateSQLXML(String columnLabel, SQLXML xmlObject) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoDriver.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoDriver.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoDriver.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,164 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile$
+ * $Revision$
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.beans.PropertyValue;
+import com.sun.star.comp.helper.Bootstrap;
+import com.sun.star.comp.helper.BootstrapException;
+import com.sun.star.sdbc.XDriver;
+import com.sun.star.sdbc.XDriverAccess;
+import com.sun.star.sdbc.XDriverManager;
+import com.sun.star.uno.Exception;
+import com.sun.star.uno.UnoRuntime;
+import com.sun.star.uno.XComponentContext;
+import java.sql.Connection;
+import java.sql.DriverManager;
+import java.sql.DriverPropertyInfo;
+import java.sql.SQLException;
+import java.util.ArrayList;
+import java.util.Enumeration;
+import java.util.Properties;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoDriver implements java.sql.Driver
+{
+    private XDriver driver = null;
+    final private XDriverManager manager;
+    final private XDriverAccess access;
+
+    /**
+     * @param args the command line arguments
+     */
+    public static void main(String[] args) {
+        try {
+            // get the remote office component context
+            XComponentContext xContext = Bootstrap.bootstrap();
+            if (xContext == null) {
+                System.err.println("ERROR: Could not bootstrap default Office.");
+            }
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.BatchUpdateTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.CallableStatementTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.ConnectionTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.DatabaseMetaDataTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.EscapeSyntaxTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.PreparedStatementTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.ResultSetMetadataTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.ResultSetTest.class);
+            junit.textui.TestRunner.run(com.mysql.jdbc.compliance.tests.StatementTest.class);
+            
+        }
+        catch (java.lang.Exception e){
+            e.printStackTrace();
+        }
+        finally {
+            System.exit( 0 );
+        }
+    }
+    public OOoDriver() throws BootstrapException, Exception, java.lang.Exception
+    {
+ //       System.setProperty("UNO_PATH", "file://D:/staroffice9_rptfix04/Sun/StarOffice%209");
+//        Loader.getCustomLoader();
+        //XComponentContext context = Bootstrap.createInitialComponentContext(null);
+        XComponentContext context = Bootstrap.bootstrap( );
+        Object obj = context.getServiceManager().createInstanceWithContext("com.sun.star.sdbc.DriverManager",context);
+        manager = (XDriverManager) UnoRuntime.queryInterface(XDriverManager.class, obj);
+        access = (XDriverAccess) UnoRuntime.queryInterface(XDriverAccess.class, obj);
+        DriverManager.registerDriver(this);
+    }
+
+    public static ArrayList convert(final Properties info)
+    {
+        final ArrayList ret = new ArrayList();
+        final Enumeration elem = info.propertyNames();
+        while (elem.hasMoreElements())
+        {
+            final String key = (String) elem.nextElement();
+            final String value = info.getProperty(key);
+            final PropertyValue n = new PropertyValue();
+            n.Name = key;
+            n.Value = value;
+            ret.add(n);
+        }
+
+        return ret;
+    }
+
+    private void loadDriver(String url) throws SQLException
+    {
+        if (driver == null)
+        {
+            driver = access.getDriverByURL(url);
+            if (driver == null)
+                throw new SQLException();
+        }
+    }
+
+    public Connection connect(String url, Properties info) throws SQLException
+    {
+        loadDriver(url);
+        return new OOoConnection(url, info, driver);
+    }
+
+    public boolean acceptsURL(String url) throws SQLException
+    {
+        try
+        {
+            loadDriver(url);
+            return driver.acceptsURL(url);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public DriverPropertyInfo[] getPropertyInfo(String url, Properties info) throws SQLException
+    {
+        return null;// driver.getPropertyInfo(url, info);
+    }
+
+    public int getMajorVersion()
+    {
+        return 0;
+    }
+
+    public int getMinorVersion()
+    {
+        return 1;
+    }
+
+    public boolean jdbcCompliant()
+    {
+        return true;
+    }
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSetMetaData.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSetMetaData.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoResultSetMetaData.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,314 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+package org.openoffice.jdbc;
+
+import com.sun.star.sdbc.XResultSetMetaData;
+import java.sql.SQLException;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoResultSetMetaData implements java.sql.ResultSetMetaData{
+
+    final private XResultSetMetaData meta;
+    public OOoResultSetMetaData(XResultSetMetaData md){
+        meta = md;
+    }
+
+    public int getColumnCount() throws SQLException
+    {
+        try
+        {
+            return meta.getColumnCount();
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isAutoIncrement(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isAutoIncrement(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isCaseSensitive(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isCaseSensitive(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isSearchable(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isSearchable(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isCurrency(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isCurrency(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int isNullable(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isNullable(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isSigned(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isSigned(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getColumnDisplaySize(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnDisplaySize(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getColumnLabel(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnLabel(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getColumnName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getSchemaName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getSchemaName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getPrecision(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getPrecision(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getScale(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getScale(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getTableName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getTableName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getCatalogName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getCatalogName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getColumnType(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnType(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getColumnTypeName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnTypeName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isReadOnly(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isReadOnly(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isWritable(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isWritable(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isDefinitelyWritable(int column) throws SQLException
+    {
+        try
+        {
+            return meta.isDefinitelyWritable(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getColumnClassName(int column) throws SQLException
+    {
+        try
+        {
+            return meta.getColumnServiceName(column);
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+}
Index: connectivity/qa/jdbc/org/openoffice/jdbc/OOoConnection.java
===================================================================
--- connectivity/qa/jdbc/org/openoffice/jdbc/OOoConnection.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/org/openoffice/jdbc/OOoConnection.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,427 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+package org.openoffice.jdbc;
+
+import com.sun.star.beans.PropertyValue;
+import com.sun.star.sdbc.XConnection;
+import com.sun.star.sdbc.XDriver;
+import java.sql.Array;
+import java.sql.Blob;
+import java.sql.CallableStatement;
+import java.sql.Clob;
+import java.sql.DatabaseMetaData;
+import java.sql.NClob;
+import java.sql.PreparedStatement;
+import java.sql.SQLClientInfoException;
+import java.sql.SQLException;
+import java.sql.SQLWarning;
+import java.sql.SQLXML;
+import java.sql.Savepoint;
+import java.sql.Statement;
+import java.sql.Struct;
+import java.util.Map;
+import java.util.Properties;
+
+/**
+ *
+ * @author Ocke Janssen
+ */
+public class OOoConnection implements java.sql.Connection
+{
+
+    private XConnection connection;
+
+    OOoConnection(String url, Properties info, XDriver driver) throws SQLException
+    {
+        try
+        {
+            connection = driver.connect(url, (PropertyValue[]) OOoDriver.convert(info).toArray(new PropertyValue[]{}));        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public Statement createStatement() throws SQLException
+    {
+        try
+        {
+            return new OOoStatement(this, connection.createStatement());
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public PreparedStatement prepareStatement(String sql) throws SQLException
+    {
+        try
+        {
+            return new OOoPreparedStatement(this, connection.prepareStatement(sql));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public CallableStatement prepareCall(String sql) throws SQLException
+    {
+        try
+        {
+            return new OOoCallableStatement(this, connection.prepareCall(sql));
+        }
+        catch (com.sun.star.sdbc.SQLException ex)
+        {
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String nativeSQL(String sql) throws SQLException
+    {
+        try
+        {
+        return connection.nativeSQL(sql);
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setAutoCommit(boolean autoCommit) throws SQLException
+    {
+        try
+        {
+        connection.setAutoCommit(autoCommit);
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean getAutoCommit() throws SQLException
+    {
+        try
+        {
+        return connection.getAutoCommit();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void commit() throws SQLException
+    {
+        try
+        {
+        connection.commit();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void rollback() throws SQLException
+    {
+        try
+        {
+        connection.rollback();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void close() throws SQLException
+    {
+        try
+        {
+        connection.close();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isClosed() throws SQLException
+    {
+        try
+        {
+        return connection.isClosed();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public DatabaseMetaData getMetaData() throws SQLException
+    {
+        try
+        {
+        return new OOoDatabaseMetaData(this, connection.getMetaData());
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setReadOnly(boolean readOnly) throws SQLException
+    {
+        try
+        {
+        connection.setReadOnly(readOnly);
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public boolean isReadOnly() throws SQLException
+    {
+        try
+        {
+        return connection.isReadOnly();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setCatalog(String catalog) throws SQLException
+    {
+        try
+        {
+        connection.setCatalog(catalog);
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public String getCatalog() throws SQLException
+    {
+        try
+        {
+        return connection.getCatalog();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public void setTransactionIsolation(int level) throws SQLException
+    {
+        try
+        {
+        connection.setTransactionIsolation(level);
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public int getTransactionIsolation() throws SQLException
+    {
+        try
+        {
+        return connection.getTransactionIsolation();
+        }
+        catch(com.sun.star.sdbc.SQLException ex){
+            throw new SQLException(ex.getMessage(), ex.SQLState);
+        }
+    }
+
+    public SQLWarning getWarnings() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void clearWarnings() throws SQLException
+    {
+
+    }
+
+    public Statement createStatement(int resultSetType, int resultSetConcurrency) throws SQLException
+    {
+        return createStatement();
+    }
+
+    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency) throws SQLException
+    {
+        return prepareStatement(sql);
+    }
+
+    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency) throws SQLException
+    {
+        return prepareCall(sql);
+    }
+
+    public void setHoldability(int holdability) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public int getHoldability() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Savepoint setSavepoint() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Savepoint setSavepoint(String name) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void rollback(Savepoint savepoint) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void releaseSavepoint(Savepoint savepoint) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Statement createStatement(int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public PreparedStatement prepareStatement(String sql, int autoGeneratedKeys) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public PreparedStatement prepareStatement(String sql, int[] columnIndexes) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public PreparedStatement prepareStatement(String sql, String[] columnNames) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Clob createClob() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Blob createBlob() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+
+    public boolean isValid(int timeout) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public String getClientInfo(String name) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Properties getClientInfo() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Array createArrayOf(String typeName, Object[] elements) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Struct createStruct(String typeName, Object[] attributes) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Map getTypeMap() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setTypeMap(Map map) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public NClob createNClob() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public SQLXML createSQLXML() throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClientInfo(String name, String value) throws SQLClientInfoException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public void setClientInfo(Properties properties) throws SQLClientInfoException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public Object unwrap(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+
+    public boolean isWrapperFor(Class iface) throws SQLException
+    {
+        throw new UnsupportedOperationException("Not supported yet.");
+    }
+}
Index: connectivity/qa/jdbc/OOoDriverTest.java
===================================================================
--- connectivity/qa/jdbc/OOoDriverTest.java	(.../tags/OOO310_m10)	(Revision 0)
+++ connectivity/qa/jdbc/OOoDriverTest.java	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,72 @@
+/*************************************************************************
+ *
+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+ * 
+ * Copyright 2008 by Sun Microsystems, Inc.
+ *
+ * OpenOffice.org - a multi-platform office productivity suite
+ *
+ * $RCSfile$
+ * $Revision$
+ *
+ * This file is part of OpenOffice.org.
+ *
+ * OpenOffice.org is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License version 3
+ * only, as published by the Free Software Foundation.
+ *
+ * OpenOffice.org is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License version 3 for more details
+ * (a copy is included in the LICENSE file that accompanied this code).
+ *
+ * You should have received a copy of the GNU Lesser General Public License
+ * version 3 along with OpenOffice.org.  If not, see
+ * <http://www.openoffice.org/license.html>
+ * for a copy of the LGPLv3 License.
+ *
+ ************************************************************************/
+package complex.connectivity;
+
+import com.sun.star.uno.UnoRuntime;
+import com.sun.star.util.XCloseable;
+import com.sun.star.sdbc.*;
+import com.sun.star.sdb.*;
+import com.sun.star.beans.PropertyValue;
+import com.sun.star.beans.XPropertySet;
+import org.openoffice.jdbc.*;
+import java.sql.Connection;
+
+import com.sun.star.lang.XMultiServiceFactory;
+
+import complexlib.ComplexTestCase;
+
+import java.io.PrintWriter;
+ 
+import util.utils;
+import java.util.*;
+import java.io.*;
+//import complex.connectivity.DBaseStringFunctions;
+
+public class OOoDriverTest  extends ComplexTestCase {
+
+    public String[] getTestMethodNames() {
+        return new String[] { "Functions" };
+    }
+
+    public String getTestObjectName() {
+        return "OOoDriverTest";
+    }
+    
+    public void Functions() throws com.sun.star.uno.Exception,com.sun.star.beans.UnknownPropertyException {
+		try
+		{
+			OOoDriver driver = new OOoDriver((XMultiServiceFactory)param.getMSF());
+			Connection connection = driver.connect("sdbc:mysqlc:TESTDB",new Properties());
+		}
+		catch(Exception e )
+{
+}
+    }
+}

--- solenv/config/sooo320.ini-old	2009-09-06 23:55:08.000000000 +0200
+++ solenv/config/sooo320.ini	2009-09-06 23:59:35.000000000 +0200
@@ -13,7 +13,7 @@
 			BMP_WRITES_FLAG TRUE
 			BTARGET 1
 			BUILD_SPECIAL TRUE
-			BUILD_TYPE SO OOo EXT BINFILTER BITSTREAM_VERA_FONTS BSH CURL DICTIONARIES HSQLDB HUNSPELL JPEG LIBXML2 LIBXMLSEC LPSOLVE MOZ NEON TWAIN PYTHON ZLIB SANE UNIXODBC X11_EXTENSIONS LIBWPD EPM QADEVOOO ODK MSFONTEXTRACT MATHMLDTD BOOST EXPAT CRASHREP BERKELEYDB LIBXSLT SUN AGG GTK ICU SYSTRAY_GTK JAVAINSTALLER2 VIGRA OPENSSL JFREEREPORT APACHE_COMMONS TOMCAT REPORTBUILDER SDEXT SWEXT XPDF LUCENE REDLAND SAXON WRITER2LATEX NSS L10N GRAPHITE
+			BUILD_TYPE SO OOo EXT BINFILTER BITSTREAM_VERA_FONTS BSH CURL DICTIONARIES HSQLDB HUNSPELL JPEG LIBXML2 LIBXMLSEC LPSOLVE MOZ NEON TWAIN PYTHON ZLIB SANE UNIXODBC X11_EXTENSIONS LIBWPD EPM QADEVOOO ODK MSFONTEXTRACT MATHMLDTD BOOST EXPAT CRASHREP BERKELEYDB LIBXSLT SUN AGG GTK ICU SYSTRAY_GTK JAVAINSTALLER2 VIGRA OPENSSL JFREEREPORT APACHE_COMMONS TOMCAT REPORTBUILDER SDEXT SWEXT XPDF LUCENE REDLAND SAXON WRITER2LATEX NSS L10N GRAPHITE MYSQLCPPCONN MYSQL
 			common_build TRUE
 			COMMON_OUTDIR common
 			CONFIG_PROJECT config_office
@@ -28,6 +28,7 @@
 			ENABLE_GTK TRUE
 			ENABLE_MEDIAWIKI YES
 			ENABLE_MINIMIZER YES
+			ENABLE_MYSQLC YES
 			ENABLE_NSS_MODULE YES
 			ENABLE_RANDR TRUE
 			ENABLE_REPORTBUILDER YES
@@ -716,6 +717,7 @@
 			JDK14PATH %SOLAR_JDK14PATH%
 			JDK15PATH %SOLAR_JDK15PATH%
 			KDE_ROOT /so/env/kde/linux/kde-3.2.2
+		LIBMYSQL_PATH %SOLAR_ENV_ROOT%/mysql-connector-c-6.0.2/unxlngi6
 			NO_BSYMBOLIC True
 			OJDK16PATH %SOLAR_OJDK16PATH%
 			OS LINUX
@@ -1042,6 +1044,7 @@
 			JDK14PATH %SOLAR_JDK14PATH%
 			JDK15PATH %SOLAR_JDK15PATH%
 			KDE_ROOT /so/env/kde/linux/kde-3.2.2
+		LIBMYSQL_PATH %SOLAR_ENV_ROOT%/mysql-connector-c-6.0.2/unxlngx6
 			NO_BSYMBOLIC True
 			OJDK16PATH %SOLAR_OJDK16PATH%
 			OS LINUX
@@ -1370,6 +1373,7 @@
 			JDK13PATH %SOLAR_JDK13PATH%
 			JDK14PATH %SOLAR_JDK15PATH%
 			JDK15PATH %SOLAR_JDK15PATH%
+		IBMYSQL_PATH %SOLAR_ENV_ROOT%/mysql-connector-c-6.0.2/unxmacxi
 			NO_BSYMBOLIC True
 			OS MACOSX
 			OUTPATH unxmacxi
@@ -1667,6 +1671,7 @@
 			JDK13PATH %SOLAR_JDK13PATH%
 			JDK14PATH %SOLAR_JDK14PATH%
 			JDK15PATH %SOLAR_JDK15PATH%
+		LIBMYSQL_PATH %SOLAR_ENV_ROOT%/mysql-connector-c-6.0.2/unxsoli4
 			OJDK16PATH %SOLAR_OJDK16PATH%
 			OS SOLARIS
 			OUTPATH unxsoli4
@@ -1974,6 +1979,7 @@
 			JDK13PATH %SOLAR_JDK13PATH%
 			JDK14PATH %SOLAR_JDK14PATH%
 			JDK15PATH %SOLAR_JDK15PATH%
+		LIBMYSQL_PATH %SOLAR_ENV_ROOT%/mysql-connector-c-6.0.2/unxsols4
 			LM_LICENSE_FILE %SOLAR_LICENSE_FILE%
 			OJDK16PATH %SOLAR_OJDK16PATH%
 			OS SOLARIS
@@ -2847,6 +2853,7 @@
 			GUIBASE WIN
 			GVER NT351
 			INPATH wntgcci1%PROEXT%
+		LIBMYSQL_PATH %SOLAR_ENV_ROOT%$/mysql-connector-c-6.0.2$/wntmsci12
 			OS WNT
 			OUTPATH wntgcci1
 			SET_EXEPTIONS TRUE
Index: solenv/bin/transform_description.pl
===================================================================
--- solenv/bin/transform_description.pl	(.../tags/OOO310_m10)	(Revision 0)
+++ solenv/bin/transform_description.pl	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1,138 @@
+#!/usr/bin/perl
+#*************************************************************************
+#*
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+# 
+# Copyright 2009 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#************************************************************************/
+
+parse_args();
+execute_args();
+exit(0);
+
+my $source = undef;
+my $dest = undef;
+my @languages = undef;
+
+sub parse_args
+{
+    # at most two arguments
+    explain(), exit(100) if ( $#ARGV > 1 );
+
+    # destination file is the second argument, if present
+    $dest = $ARGV[1] if ( $#ARGV > 0 );
+
+    # source file is the first argument if present
+    if ( $#ARGV > -1 )
+    {
+        $source = $ARGV[0];
+        if ( ! -f $source )
+        {
+            print STDERR "$source is not a valid file, aborting";
+            exit(101);
+        }
+    }
+
+    # check which languages to use
+    my $languages = $ENV{WITH_LANG};
+    if ( ! defined $languages )
+    {
+        print STDERR "$0: WITH_LANG not set, defaulting to 'en-US'\n";
+        $languages = "en-US";
+    }
+    @languages = split ( ' ', $languages );
+}
+
+sub execute_args
+{
+    my @description = ();
+    if ( defined $source )
+    {
+        open SOURCE, "$source" || die "could not open $source: $?\n";
+        @description = <SOURCE>;
+        close SOURCE;
+    }
+    else
+    {
+        @description = <STDIN>;
+    }
+
+    if ( defined $dest )
+    {
+        open DEST, ">$dest" || die "could not open $dest for writing: $?\n";
+    }
+
+    foreach (@description)
+    {
+        chomp; s/\r//;
+
+        if ( /\#LANG\#/ )
+        {
+            foreach $lang ( @languages )
+            {
+                my $transformed = $_;
+                $transformed =~ s/\#LANG#/$lang/g;
+                if ( defined $dest )
+                {
+                    print DEST "$transformed\n";
+                }
+                else
+                {
+                    print STDOUT "$transformed\n";
+                }
+            }
+        }
+        else
+        {
+            if ( defined $dest )
+            {
+                print DEST "$_\n";
+            }
+            else
+            {
+                print STDOUT "$_\n";
+            }
+        }
+    }
+    
+    close DEST if ( defined $dest );
+}
+
+# explains the program's usage
+sub explain
+{
+    print STDOUT "usage:\n";
+    print STDOUT "  $0 [<description_file> [<output_file>]]\n";
+    print STDOUT "  transforms the given extension description file\n";
+    print STDOUT "\n";
+    print STDOUT "  If <output_file> is not given, STDOUT is used.\n";
+    print STDOUT "  If <description_file> is not given, STDIN is used.\n";
+    print STDOUT "\n";
+    print STDOUT "  The following transformations are done at the moment:\n";
+    print STDOUT "  - duplicate all lines containing #LANG#, for ever token of \$WITH_LANG\n";
+    print STDOUT "    replacing every occurance of \$LANG with a token\n";
+    print STDOUT "\n";
+    print STDOUT "  And yes, the functionality of this script should be\n";
+    print STDOUT "  - moved to solenv/inc/tg_ext.mk\n";
+    print STDOUT "  - implemented as XSLT, to be much less error-prone\n";
+}

Index: solenv/inc/extension_post.mk
===================================================================
--- solenv/inc/extension_post.mk	(.../tags/OOO310_m10)	(Revision 275542)
+++ solenv/inc/extension_post.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -29,6 +29,8 @@
 #
 #*************************************************************************
 
+EXTENSION_TARGET:=$(ZIP9TARGETN)
+
 .SOURCE.xcu : $(MISC)/$(EXTNAME)/merge $(MISC)/$(EXTNAME)/registry/data $(MISC)/$(COMPONENT_SHARED_CONFIG)_in/merge $(MISC)/$(COMPONENT_SHARED_CONFIG)_in/registry/data $(COMPONENT_CONFIGDIR) .
 .SOURCE.xcs : $(MISC)/$(EXTNAME)/registry $(MISC)/$(EXTNAME)/registry/schema .
 
@@ -129,12 +131,18 @@
 .IF "$(DESCRIPTION)"!=""
 $(DESCRIPTION) $(PHONYDESC) : $(DESCRIPTION_SRC)
     @@-$(MKDIRHIER) $(@:d)
-	$(COMMAND_ECHO)$(PERL) $(SOLARENV)/bin/licinserter.pl $(DESCRIPTION_SRC) $(COMPONENT_LIC_TEMPL) $@.$(EXTNAME)
     @echo LAST_WITH_LANG=$(WITH_LANG) > $(MISC)/$(TARGET)_lang_track.mk
-	$(COMMAND_ECHO)$(TYPE) $@.$(EXTNAME) | sed s/UPDATED_IDENTIFIER/$(IMPLEMENTATION_IDENTIFIER)/ >  $(MISC)/desc.tmp.$(EXTNAME)
-    @@-$(RM) $@.$(EXTNAME)
-	$(COMMAND_ECHO)$(TYPE) $(MISC)/desc.tmp.$(EXTNAME) | sed s/UPDATED_SUPPORTED_PLATFORM/$(PLATFORMID)/ > $@
-    @@-$(RM) $(MISC)/desc.tmp.$(EXTNAME)
+
+    $(COMMAND_ECHO)$(PERL) $(SOLARENV)$/bin$/licinserter.pl $(DESCRIPTION_SRC) $(COMPONENT_LIC_TEMPL) $@.1.$(EXTNAME)
+
+    $(COMMAND_ECHO)$(PERL) $(SOLARENV)$/bin$/transform_description.pl $@.1.$(EXTNAME) $@.2.$(EXTNAME)
+    @@-$(RM) $@.1.$(EXTNAME)
+
+    $(COMMAND_ECHO)$(TYPE) $@.2.$(EXTNAME) | sed s/UPDATED_IDENTIFIER/$(IMPLEMENTATION_IDENTIFIER)/ >  $@.3.$(EXTNAME)
+    @@-$(RM) $@.2.$(EXTNAME)
+
+    $(COMMAND_ECHO)$(TYPE) $@.3.$(EXTNAME) | sed s/UPDATED_SUPPORTED_PLATFORM/$(PLATFORMID)/ > $@
+    @@-$(RM) $@.3.$(EXTNAME)
 
 .ENDIF			# "$(DESCRIPTION)"!=""
 # default OOo license text!!!
Index: solenv/inc/unxsoli4.mk
===================================================================
--- solenv/inc/unxsoli4.mk	(.../tags/OOO310_m10)	(Revision 275542)
+++ solenv/inc/unxsoli4.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -33,7 +33,6 @@
 ASM=/usr/ccs/bin/as
 AFLAGS=-P
 
-
 CDEFS+=-D_PTHREADS -DSYSV -DSUN -DSUN4 -D_REENTRANT -D_POSIX_PTHREAD_SEMANTICS -DSTLPORT_VERSION=$(STLPORT_VER)
 
 SOLAR_JAVA*=TRUE
Index: solenv/inc/unxsols4.mk
===================================================================
--- solenv/inc/unxsols4.mk	(.../tags/OOO310_m10)	(Revision 275542)
+++ solenv/inc/unxsols4.mk	(.../cws/mysqlnative)	(Revision 275542)
@@ -34,7 +34,6 @@
 # needs -D__sparcv8plus because it's not defined by the assembler with -xarch=v8plus
 AFLAGS=-P -xarch=v8plus -D__sparcv8plus
 
-
 CDEFS+=-D_PTHREADS -DSYSV -DSUN -DSUN4 -D_REENTRANT -D_POSIX_PTHREAD_SEMANTICS -DSTLPORT_VERSION=$(STLPORT_VER)
 
 SOLAR_JAVA*=TRUE

Index: set_soenv.in
===================================================================
--- set_soenv.in        (.../tags/OOO310_m10)   (Revision 275542)
+++ set_soenv.in        (.../cws/mysqlnative)   (Revision 275542)
@@ -1968,6 +1968,13 @@
 ToFile( "SYSTEM_DB",         "@SYSTEM_DB@",        "e" );
 ToFile( "DB_VERSION",        "@DB_VERSION@",       "e" );
 ToFile( "DB_INCLUDES",       "@DB_INCLUDES@",      "e" );
+ToFile( "ENABLE_MYSQLC",     "@ENABLE_MYSQLC@",    "e" );
+ToFile( "SYSTEM_MYSQL",      "@SYSTEM_MYSQL@",     "e" );
+ToFile( "SYSTEM_MYSQL_CPPCONN","@SYSTEM_MYSQL_CPPCONN@","e" );
+ToFile( "MYSQL_INC",         "@MYSQL_INC@",        "e" );
+ToFile( "MYSQL_LIB",         "@MYSQL_LIB@",        "e" );
+ToFile( "MYSQL_DEFINES",     "@MYSQL_DEFINES@",    "e" );
+ToFile( "LIBMYSQL_PATH",     "@LIBMYSQL_PATH@",    "e" );
 ToFile( "SYSTEM_HSQLDB",     "@SYSTEM_HSQLDB@",    "e" );
 ToFile( "HSQLDB_JAR",        "@HSQLDB_JAR@",       "e" );
 ToFile( "SYSTEM_LUCENE",     "@SYSTEM_LUCENE@",    "e" );
--- postprocess/prj/build.lst	(.../tags/OOO310_m10)	(Revision 275542)
+++ postprocess/prj/build.lst	(.../cws/mysqlnative)	(Revision 275542)
@@ -1,4 +1,4 @@
-po     postprocess     ::      accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker helpcontent2 hwpfilter io JAVAINSTALLER2:javainstaller2 lingucomponent MATHMLDTD:MathMLDTD ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins sccomp scp2 scripting sd setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts AGFA_MONOTYPE_FONTS:agfa_monotype_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools JFREEREPORT:jfreereport REPORTBUILDER:reportbuilder reportdesign SDEXT:sdext SWEXT:swext writerfilter oox NULL
+po     postprocess     ::      accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker helpcontent2 hwpfilter io JAVAINSTALLER2:javainstaller2 lingucomponent MATHMLDTD:MathMLDTD ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins sccomp scp2 scripting sd setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts AGFA_MONOTYPE_FONTS:agfa_monotype_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools JFREEREPORT:jfreereport REPORTBUILDER:reportbuilder reportdesign SDEXT:sdext SWEXT:swext writerfilter MYSQLC:mysqlc oox NULL
 po	postprocess			    	usr1	-	all	po_mkout NULL
 po	postprocess\checkxml		nmake	-	all	po_checkxml NULL
 po	postprocess\packconfig		nmake	-	all	po_packconfig po_checkxml NULL
--- mysqlc/source/delzip	(.../tags/OOO310_m10)	(Revision 275542)
+++ mysqlc/source/delzip	(.../cws/mysqlnative)	(Revision 275542)
@@ -0,0 +1 @@
+
