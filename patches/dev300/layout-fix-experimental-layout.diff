--- cui/source/inc/numfmt.hxx
+++ cui/source/inc/numfmt.hxx
@@ -77,8 +77,12 @@ public:
 };
 
 // -----------------------------------------------------------------------
+#if ENABLE_LAYOUT_EXPERIMENTAL
 #include <sfx2/layout.hxx>
 #include <layout/layout-pre.hxx>
+#else
+#define LocalizedString String
+#endif /* !ENABLE_LAYOUT_EXPERIMENTAL */
 
 class SvxNumberFormatTabPage : public SfxTabPage
 {
@@ -182,7 +186,9 @@ private:
 #endif
 };
 
+#if ENABLE_LAYOUT_EXPERIMENTAL
 #include <layout/layout-post.hxx>
+#endif /* ENABLE_LAYOUT_EXPERIMENTAL */
 
 #endif
 
--- cui/source/tabpages/numfmt.cxx
+++ cui/source/tabpages/numfmt.cxx
@@ -233,19 +229,19 @@ void SvxNumberPreviewImpl::DataChanged( const DataChangedEvent& rDCEvt )
 
 #define HDL(hdl) LINK( this, SvxNumberFormatTabPage, hdl )
 
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
 #include <layout/layout-pre.hxx>
 
-#if ENABLE_LAYOUT
 #undef CUI_RES
 #define CUI_RES(x) #x
 #define CUI_RES_PLAIN(x) ResId (x, CUI_MGR ())
 #define THIS_CUI_RES(x) this, #x
 #undef SfxTabPage
 #define SfxTabPage( parent, id, args ) SfxTabPage( parent, "number-format.xml", id, &args )
-#else /* !ENABLE_LAYOUT */
+#else /* ! ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT */
 #define CUI_RES_PLAIN CUI_RES
 #define THIS_CUI_RES CUI_RES
-#endif /* !ENABLE_LAYOUT */
+#endif /* ! ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT */
 
 SvxNumberFormatTabPage::SvxNumberFormatTabPage( Window*				pParent,
                                                 const SfxItemSet&	rCoreAttrs )
@@ -276,7 +272,7 @@ SvxNumberFormatTabPage::SvxNumberFormatTabPage( Window*				pParent,
         aFtLanguage     ( this, CUI_RES( FT_LANGUAGE ) ),
         aLbLanguage     ( this, CUI_RES( LB_LANGUAGE ), sal_False ),
         aCbSourceFormat ( this, CUI_RES( CB_SOURCEFORMAT ) ),
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
         aWndPreview     ( LAYOUT_THIS_WINDOW(this), CUI_RES_PLAIN( WND_NUMBER_PREVIEW ) ),
 #else
         aWndPreview     ( this, CUI_RES_PLAIN( WND_NUMBER_PREVIEW ) ),
@@ -288,7 +284,7 @@ SvxNumberFormatTabPage::SvxNumberFormatTabPage( Window*				pParent,
         sAutomaticEntry ( THIS_CUI_RES( STR_AUTO_ENTRY)),
         pLastActivWindow( NULL )
 {
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
     aLbFormat.Clear ();
 #endif /* ENABLE_LAYOUT */
 
@@ -1166,7 +1162,7 @@ void SvxNumberFormatTabPage::UpdateFormatListBox_Impl
             aPos.Y()=nStdFormatY;
             aSize.Height()=nStdFormatHeight;
             aLbFormat.SetPosSizePixel(aPos,aSize);
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
             aLbCurrency.Disable();
 #else /* !ENABLE_LAYOUT */
             aLbCurrency.Hide();
@@ -1177,7 +1173,7 @@ void SvxNumberFormatTabPage::UpdateFormatListBox_Impl
             aPos.Y()=nCurFormatY;
             aSize.Height()=nCurFormatHeight;
             aLbFormat.SetPosSizePixel(aPos,aSize);
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
             aLbCurrency.Enable();
 #else /* !ENABLE_LAYOUT */
             aLbCurrency.Show();
@@ -1315,7 +1311,7 @@ IMPL_LINK( SvxNumberFormatTabPage, SelFormatHdl_Impl, void *, pLb )
 
         // Reinit options enable/disable for current selection.
 
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
         if (aLbFormat.GetSelectEntryPos () == LISTBOX_ENTRY_NOTFOUND)
 #else /* !ENABLE_LAYOUT */
         // Current category may be UserDefined with no format entries defined.
--- sc/source/ui/attrdlg/scdlgfact.cxx
+++ sc/source/ui/attrdlg/scdlgfact.cxx
@@ -28,10 +28,6 @@
 // MARKER(update_precomp.py): autogen include statement, do not remove
 #include "precompiled_sc.hxx"
 
-#if ! ENABLE_LAYOUT_EXPERIMENTAL
-#undef ENABLE_LAYOUT
-#endif
-
 #undef SC_DLLIMPLEMENTATION
 
 #include "scdlgfact.hxx"
@@ -149,7 +145,7 @@ String AbstractTabDialog_Impl::GetText() const
     return pDlg->GetText();
 }
 
-#if ENABLE_LAYOUT
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
 namespace layout
 {
 IMPL_ABSTDLG_BASE(AbstractTabDialog_Impl);
@@ -184,7 +180,7 @@ String AbstractTabDialog_Impl::GetText() const
     return pDlg->GetText();
 }
 }
-#endif /* ENABLE_LAYOUT */
+#endif /* ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT */
 
 
 // AbstractScImportAsciiDlg_Impl begin
--- sc/source/ui/attrdlg/scdlgfact.hxx
+++ sc/source/ui/attrdlg/scdlgfact.hxx
@@ -368,7 +368,8 @@ class AbstractTabDialog_Impl : public SfxAbstractTabDialog
     virtual void		SetText( const XubString& rStr );
     virtual String   	GetText() const;
 };
-#if ENABLE_LAYOUT
+
+#if ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT
 namespace layout
 {
 //add for ScAttrDlg , ScHFEditDlg, ScStyleDlg, ScSubTotalDlg, ScCharDlg, ScParagraphDlg, ScValidationDlg, ScSortDlg
@@ -384,7 +385,7 @@ class AbstractTabDialog_Impl : public SfxAbstractTabDialog
     virtual String   	GetText() const;
 };
 } // end namespace layout
-#endif /* ENABLE_LAYOUT */
+#endif /* ENABLE_LAYOUT_EXPERIMENTAL && ENABLE_LAYOUT */
 //------------------------------------------------------------------------
 //AbstractDialogFactory_Impl implementations
 class ScAbstractDialogFactory_Impl : public ScAbstractDialogFactory
