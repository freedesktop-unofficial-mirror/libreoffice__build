--- solenv/bin/modules/installer/setupscript.pm	2008-07-18 17:17:13.000000000 +0100
+++ solenv/bin/modules/installer/setupscript.pm	2008-07-18 17:17:13.000000000 +0100
@@ -66,10 +66,14 @@
 	
 	# and now the complete path for the setup script is needed
 	# The log file cannot be used, because this is the language independent section
-	
-	$scriptnameref = installer::scriptitems::get_sourcepath_from_filename_and_includepath(\$scriptname, $includepatharrayref, 1);
 
-	$installer::globals::setupscriptname = $$scriptnameref;
+	if (defined $ENV{OO_SOLVERDIR}) {
+	    $installer::globals::setupscriptname = "$ENV{OO_SOLVERDIR}/bin/$scriptname";
+	} else {
+	    $scriptnameref = installer::scriptitems::get_sourcepath_from_filename_and_includepath(\$scriptname, $includepatharrayref, 1);
+
+	    $installer::globals::setupscriptname = $$scriptnameref;
+	}
 
 	if ( $installer::globals::setupscriptname eq "" )
 	{
--- /tmp/globals.pm	2008-07-18 17:53:26.000000000 +0100
+++ /usr/lib/ooo-3/solenv/bin/modules/installer/globals.pm	2008-07-18 17:53:17.000000000 +0100
@@ -56,7 +56,8 @@
 
 	$destdir = "";
 	$rootpath = "";
-	
+
+	$split = 0;
 	$productextension = "";
 	@languageproducts = ();
 	$build = "";
@@ -428,6 +429,8 @@
 	if ( $plat =~ /linux/i ) { $islinux = 1; } 
 	if ( $plat =~ /solaris/i ) { $issolaris = 1; } 
 
+	$split = 1 if (defined $ENV{SOLARPIECE});
+
 	# ToDo: Needs to be expanded for additional platforms
 
 }


--- solenv/bin/modules/installer/scriptitems.pm	2008-07-18 17:54:05.000000000 +0100
+++ solenv/bin/modules/installer/scriptitems.pm	2008-07-18 17:54:05.000000000 +0100
@@ -1133,8 +1134,10 @@
 				$infoline = "ERROR: Removing file $filename from file list.\n";
 				push( @installer::globals::logfileinfo, $infoline);
 
-				push(@missingfiles, "ERROR: File not found: $filename\n");	
-				$error_occured = 1;
+				if (! $installer::globals::split) {
+				    push(@missingfiles, "ERROR: File not found: $filename\n");	
+				    $error_occured = 1;
+				}
 
 				next;	# removing this file from list, if sourcepath is empty
 			}

a--- solenv/bin/make_installer.pl	2008-07-18 17:58:25.000000000 +0100
+++ solenv/bin/make_installer.pl	2008-07-18 17:58:25.000000000 +0100
@@ -802,7 +802,8 @@
 			# "regcomp" or "regcomp.exe". Therefore this function can only be executed on the
 			# corresponding platform.
 
-			if ( $installer::globals::servicesrdb_can_be_created )
+			if ( $installer::globals::servicesrdb_can_be_created &&
+			     !$installer::globals::split)
 			{
 				installer::logger::print_message( "... creating preregistered services.rdb ...\n" );
 
