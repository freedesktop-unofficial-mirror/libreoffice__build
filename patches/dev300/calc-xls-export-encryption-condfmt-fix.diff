From e465e1c89c33840ca8bf1da8c9f06b6f1a5a73ac Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:31 +0200
Subject: [PATCH 187/768] calc-xls-export-encryption-condfmt-fix.diff

---
 sc/source/filter/xcl97/xcl97rec.cxx |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git sc/source/filter/xcl97/xcl97rec.cxx sc/source/filter/xcl97/xcl97rec.cxx
index 2fcc2f8..09f9f23 100644
--- sc/source/filter/xcl97/xcl97rec.cxx
+++ sc/source/filter/xcl97/xcl97rec.cxx
@@ -1352,4 +1352,10 @@ void XclExpWriteAccess::WriteBody( XclExpStream& rStrm )
         rStrm << aData[i];
 }
+
+void XclExpInterfaceEnd::WriteBody( XclExpStream& rStrm )
+{
+    // Don't forget to re-enable encryption.
+    rStrm.EnableEncryption();
+}
 
 // ============================================================================
