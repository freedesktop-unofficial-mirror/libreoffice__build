---
 sc/inc/document.hxx                |    2 ++
 sc/inc/table.hxx                   |    2 +-
 sc/source/core/data/documen9.cxx   |    8 ++++++++
 sc/source/core/data/table2.cxx     |    4 ----
 sc/source/core/tool/consoli.cxx    |    2 ++
 sc/source/ui/docshell/olinefun.cxx |    9 ++++++++-
 6 files changed, 21 insertions(+), 6 deletions(-)

diff --git sc/inc/document.hxx sc/inc/document.hxx
index aba7bd6..c9742e4 100644
--- sc/inc/document.hxx
+++ sc/inc/document.hxx
@@ -826,6 +826,8 @@ public:
         @param bForced  True = always create all captions, false = skip when Undo is disabled. */
     void            InitializeAllNoteCaptions( bool bForced = false );
 
+    void            SetDrawPageSize(SCTAB nTab);
+
     BOOL            ExtendMergeSel( SCCOL nStartCol, SCROW nStartRow,
                                 SCCOL& rEndCol, SCROW& rEndRow, const ScMarkData& rMark,
                                 BOOL bRefresh = FALSE, BOOL bAttrs = FALSE );
diff --git sc/inc/table.hxx sc/inc/table.hxx
index e972912..eb48fb5 100644
--- sc/inc/table.hxx
+++ sc/inc/table.hxx
@@ -772,6 +772,7 @@ public:
     BOOL		IsSortCollatorGlobal() const;
     void		InitSortCollator( const ScSortParam& rPar );
     void		DestroySortCollator();
+    void        SetDrawPageSize( bool bResetStreamValid = true, bool bUpdateNoteCaptionPos = true );
 
 private:
     void		FillSeries( SCCOL nCol1, SCROW nRow1, SCCOL nCol2, SCROW nRow2,
@@ -851,7 +852,6 @@ private:
     BOOL 		GetNextSpellingCell(SCCOL& rCol, SCROW& rRow, BOOL bInSel,
                                     const ScMarkData& rMark) const;
     BOOL		GetNextMarkedCell( SCCOL& rCol, SCROW& rRow, const ScMarkData& rMark );
-    void        SetDrawPageSize( bool bResetStreamValid = true, bool bUpdateNoteCaptionPos = true );
     BOOL		TestTabRefAbs(SCTAB nTable);
     void 		CompileDBFormula();
     void 		CompileDBFormula( BOOL bCreateFormulaString );
diff --git sc/source/core/data/documen9.cxx sc/source/core/data/documen9.cxx
index 92b5fb7..80a6cf0 100644
--- sc/source/core/data/documen9.cxx
+++ sc/source/core/data/documen9.cxx
@@ -226,6 +226,14 @@ void ScDocument::UpdateDrawPrinter()
     }
 }
 
+void ScDocument::SetDrawPageSize(SCTAB nTab)
+{
+    if (!ValidTab(nTab) || !pTab[nTab])
+        return;
+
+    pTab[nTab]->SetDrawPageSize();
+}
+
 sal_Bool ScDocument::IsChart( const SdrObject* pObject )
 {
     // #109985#
diff --git sc/source/core/data/table2.cxx sc/source/core/data/table2.cxx
index c003a14..853bbd7 100644
--- sc/source/core/data/table2.cxx
+++ sc/source/core/data/table2.cxx
@@ -2459,8 +2459,6 @@ void ScTable::ShowRow(SCROW nRow, bool bShow)
         bool bWasVis = !RowHidden(nRow);
         if (bWasVis != bShow)
         {
-            IncRecalcLevel();
-            InitializeNoteCaptions();
             ScDrawLayer* pDrawLayer = pDocument->GetDrawLayer();
             if (pDrawLayer)
             {
@@ -2475,8 +2473,6 @@ void ScTable::ShowRow(SCROW nRow, bool bShow)
             SetRowHidden(nRow, nRow, !bShow);
             if (bShow)
                 SetRowFiltered(nRow, nRow, false);
-		DecRecalcLevel();
-
             ScChartListenerCollection* pCharts = pDocument->GetChartListenerCollection();
             if ( pCharts )
                 pCharts->SetRangeDirty(ScRange( 0, nRow, nTab, MAXCOL, nRow, nTab ));
diff --git sc/source/core/tool/consoli.cxx sc/source/core/tool/consoli.cxx
index b1b018c..4fa6d3f 100644
--- sc/source/core/tool/consoli.cxx
+++ sc/source/core/tool/consoli.cxx
@@ -820,8 +820,10 @@ void ScConsData::OutputToDocument( ScDocument* pDestDoc, SCCOL nCol, SCROW nRow,
                 SCROW nOutEnd = nRow+nArrY+nNeeded-1;
                 BOOL bSize = FALSE;
                 pOutArr->Insert( nOutStart, nOutEnd, bSize );
+                pDestDoc->InitializeNoteCaptions(nTab);
                 for (SCROW nOutRow=nOutStart; nOutRow<=nOutEnd; nOutRow++)
                     pDestDoc->ShowRow( nOutRow, nTab, FALSE );
+                pDestDoc->SetDrawPageSize(nTab);
                 pDestDoc->UpdateOutlineRow( nOutStart, nOutEnd, nTab, FALSE );
 
                 //	Zwischentitel
diff --git sc/source/ui/docshell/olinefun.cxx sc/source/ui/docshell/olinefun.cxx
index 265cef4..67298f1 100644
--- sc/source/ui/docshell/olinefun.cxx
+++ sc/source/ui/docshell/olinefun.cxx
@@ -392,6 +392,7 @@ BOOL ScOutlineDocFunc::SelectLevel( SCTAB nTab, BOOL bColumns, USHORT nLevel,
                                     bColumns, nLevel ) );
     }
 
+    pDoc->InitializeNoteCaptions(nTab);
     ScSubOutlineIterator aIter( pArray );					// alle Eintraege
     ScOutlineEntry* pEntry;
     while ((pEntry=aIter.GetNext()) != NULL)
@@ -424,7 +425,7 @@ BOOL ScOutlineDocFunc::SelectLevel( SCTAB nTab, BOOL bColumns, USHORT nLevel,
                     pDoc->ShowRow( i, nTab, bShow );
         }
     }
-
+    pDoc->SetDrawPageSize(nTab);
     pDoc->UpdatePageBreaks( nTab );
 
     if (bPaint)
@@ -505,6 +506,7 @@ BOOL ScOutlineDocFunc::ShowMarkedOutlines( const ScRange& rRange, BOOL bRecord,
         nMax=0;
         pArray = pTable->GetRowArray();
         ScSubOutlineIterator aRowIter( pArray );
+        pDoc->InitializeNoteCaptions(nTab);
         while ((pEntry=aRowIter.GetNext()) != NULL)
         {
             nStart = pEntry->GetStart();
@@ -521,6 +523,7 @@ BOOL ScOutlineDocFunc::ShowMarkedOutlines( const ScRange& rRange, BOOL bRecord,
 			if ( !pDoc->RowFiltered( i,nTab ) )				// weggefilterte nicht einblenden
                 pDoc->ShowRow( i, nTab, TRUE );
 
+        pDoc->SetDrawPageSize(nTab);
         pDoc->UpdatePageBreaks( nTab );
 
         rDocShell.PostPaint( 0,0,nTab, MAXCOL,MAXROW,nTab, PAINT_GRID | PAINT_LEFT | PAINT_TOP );
@@ -671,6 +674,7 @@ BOOL ScOutlineDocFunc::ShowOutline( SCTAB nTab, BOOL bColumns, USHORT nLevel, US
 
 //!	HideCursor();
 
+    pDoc->InitializeNoteCaptions(nTab);
     pEntry->SetHidden(FALSE);
     SCCOLROW i;
     for ( i = nStart; i <= nEnd; i++ )
@@ -701,6 +705,7 @@ BOOL ScOutlineDocFunc::ShowOutline( SCTAB nTab, BOOL bColumns, USHORT nLevel, US
 
     pArray->SetVisibleBelow( nLevel, nEntry, TRUE, TRUE );
 
+    pDoc->SetDrawPageSize(nTab);
     pDoc->InvalidatePageBreaks(nTab);
     pDoc->UpdatePageBreaks( nTab );
 
@@ -755,6 +760,7 @@ BOOL ScOutlineDocFunc::HideOutline( SCTAB nTab, BOOL bColumns, USHORT nLevel, US
 
 //!	HideCursor();
 
+    pDoc->InitializeNoteCaptions(nTab);
     pEntry->SetHidden(TRUE);
     SCCOLROW i;
     for ( i = nStart; i <= nEnd; i++ )
@@ -767,6 +773,7 @@ BOOL ScOutlineDocFunc::HideOutline( SCTAB nTab, BOOL bColumns, USHORT nLevel, US
 
     pArray->SetVisibleBelow( nLevel, nEntry, FALSE );
 
+    pDoc->SetDrawPageSize(nTab);
     pDoc->InvalidatePageBreaks(nTab);
     pDoc->UpdatePageBreaks( nTab );
 
-- 
1.7.0.1

