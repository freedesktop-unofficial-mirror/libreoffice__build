Add OOXML Import / Export filter in the UI

From: CÃ©dric Bosdonnat <cedricbosdo@openoffice.org>


---

 filter/source/config/fragments/fcfg_writer.mk      |   12 +++++++++---
 .../source/config/fragments/filters/OOXML_Text.xcu |   13 +++++++++++++
 .../fragments/filters/OOXML_Text_Template.xcu      |   13 +++++++++++++
 .../fragments/filters/OOXML_Text_Template_ui.xcu   |    6 ++++++
 .../config/fragments/filters/OOXML_Text_ui.xcu     |    6 ++++++
 .../source/config/fragments/types/writer_OOXML.xcu |   12 ++++++++++++
 .../fragments/types/writer_OOXML_Template.xcu      |   12 ++++++++++++
 7 files changed, 71 insertions(+), 3 deletions(-)
 create mode 100644 filter/source/config/fragments/filters/OOXML_Text.xcu
 create mode 100644 filter/source/config/fragments/filters/OOXML_Text_Template.xcu
 create mode 100644 filter/source/config/fragments/filters/OOXML_Text_Template_ui.xcu
 create mode 100644 filter/source/config/fragments/filters/OOXML_Text_ui.xcu
 create mode 100644 filter/source/config/fragments/types/writer_OOXML.xcu
 create mode 100644 filter/source/config/fragments/types/writer_OOXML_Template.xcu


diff --git filter/source/config/fragments/fcfg_writer.mk filter/source/config/fragments/fcfg_writer.mk
index a10cefb..df4b7cf 100644
--- filter/source/config/fragments/fcfg_writer.mk
+++ filter/source/config/fragments/fcfg_writer.mk
@@ -30,7 +30,9 @@ T4_WRITER = \
     writer8 \
     writer_MS_Word_2003_XML \
     writer_MS_Word_2007_XML \
-    writer_MS_Word_2007_XML_Template
+    writer_MS_Word_2007_XML_Template \
+    writer_OOXML \
+    writer_OOXML_Template
 
 # -----------------------------------------------
 # count = 39
@@ -62,7 +64,9 @@ F4_WRITER = \
     writer8_template \
     MS_Word_2003_XML \
     MS_Word_2007_XML \
-    MS_Word_2007_XML_Template
+    MS_Word_2007_XML_Template \
+    OOXML_Text \
+    OOXML_Text_Template
 
 # -----------------------------------------------
 # count = 14
@@ -78,7 +82,9 @@ F4_UI_WRITER = \
     writer8_template_ui \
     MS_Word_2003_XML_ui \
     MS_Word_2007_XML_ui \
-    MS_Word_2007_XML_Template_ui
+    MS_Word_2007_XML_Template_ui \
+    OOXML_Text_ui \
+    OOXML_Text_Template_ui
 
 # -----------------------------------------------
 # count = 0
diff --git filter/source/config/fragments/filters/OOXML_Text.xcu filter/source/config/fragments/filters/OOXML_Text.xcu
new file mode 100644
index 0000000..2518e46
--- /dev/null
+++ filter/source/config/fragments/filters/OOXML_Text.xcu
@@ -0,0 +1,13 @@
+    <node oor:name="Office Open XML Text" oor:op="replace">
+        <prop oor:name="Flags"><value>IMPORT EXPORT ALIEN 3RDPARTYFILTER</value></prop>
+        <prop oor:name="UIComponent"/>
+        <prop oor:name="FilterService"><value>com.sun.star.comp.Writer.WriterFilter</value></prop>
+        <prop oor:name="UserData"><value>OOXML</value></prop>
+        <prop oor:name="UIName">
+            <value xml:lang="x-default">Office Open XML Text</value>
+        </prop>
+        <prop oor:name="FileFormatVersion"><value>0</value></prop>
+        <prop oor:name="Type"><value>writer_OOXML</value></prop>
+        <prop oor:name="TemplateName"/>
+        <prop oor:name="DocumentService"><value>com.sun.star.text.TextDocument</value></prop>
+    </node>
diff --git filter/source/config/fragments/filters/OOXML_Text_Template.xcu filter/source/config/fragments/filters/OOXML_Text_Template.xcu
new file mode 100644
index 0000000..afad41d
--- /dev/null
+++ filter/source/config/fragments/filters/OOXML_Text_Template.xcu
@@ -0,0 +1,13 @@
+    <node oor:name="Office Open XML Text Template" oor:op="replace">
+        <prop oor:name="Flags"><value>IMPORT ALIEN 3RDPARTYFILTER TEMPLATE TEMPLATEPATH</value></prop>
+        <prop oor:name="UIComponent"/>
+        <prop oor:name="FilterService"><value>com.sun.star.comp.Writer.WriterFilter</value></prop>
+        <prop oor:name="UserData"><value>OOXML</value></prop>
+        <prop oor:name="UIName">
+            <value xml:lang="x-default">Office Open XML Text Template</value>
+        </prop>
+        <prop oor:name="FileFormatVersion"><value>0</value></prop>
+        <prop oor:name="Type"><value>writer_OOXML_Template</value></prop>
+        <prop oor:name="TemplateName"/>
+        <prop oor:name="DocumentService"><value>com.sun.star.text.TextDocument</value></prop>
+    </node>
diff --git filter/source/config/fragments/filters/OOXML_Text_Template_ui.xcu filter/source/config/fragments/filters/OOXML_Text_Template_ui.xcu
new file mode 100644
index 0000000..e790fb7
--- /dev/null
+++ filter/source/config/fragments/filters/OOXML_Text_Template_ui.xcu
@@ -0,0 +1,6 @@
+    <node oor:name="Office Open XML Text Template">
+        <prop oor:name="UIName">
+            <value xml:lang="en-US">Office Open XML Text Template</value>
+            <value xml:lang="de">Office Open XML Text Vorlage</value>
+        </prop>
+    </node>
diff --git filter/source/config/fragments/filters/OOXML_Text_ui.xcu filter/source/config/fragments/filters/OOXML_Text_ui.xcu
new file mode 100644
index 0000000..483f23d
--- /dev/null
+++ filter/source/config/fragments/filters/OOXML_Text_ui.xcu
@@ -0,0 +1,6 @@
+    <node oor:name="Office Open XML Text">
+        <prop oor:name="UIName">
+            <value xml:lang="en-US">Office Open XML Text</value>
+            <value xml:lang="de">Office Open XML Text</value>
+        </prop>
+    </node>
diff --git filter/source/config/fragments/types/writer_OOXML.xcu filter/source/config/fragments/types/writer_OOXML.xcu
new file mode 100644
index 0000000..e2342cf
--- /dev/null
+++ filter/source/config/fragments/types/writer_OOXML.xcu
@@ -0,0 +1,12 @@
+    <node oor:name="writer_OOXML" oor:op="replace" >
+    <prop oor:name="DetectService"><value>com.sun.star.comp.oox.FormatDetector</value></prop>
+        <prop oor:name="URLPattern"/>
+        <prop oor:name="Extensions"><value>docx docm</value></prop>
+        <prop oor:name="MediaType"><value>application/vnd.openxmlformats-officedocument.wordprocessingml.document</value></prop>
+        <prop oor:name="Preferred"><value>true</value></prop>
+        <prop oor:name="PreferredFilter"><value>Office Open XML Text Document</value></prop>
+        <prop oor:name="UIName">
+            <value>Office Open XML Text Document</value>
+        </prop>
+        <prop oor:name="ClipboardFormat"><value>MSWordDoc</value></prop>
+    </node>
diff --git filter/source/config/fragments/types/writer_OOXML_Template.xcu filter/source/config/fragments/types/writer_OOXML_Template.xcu
new file mode 100644
index 0000000..566e08d
--- /dev/null
+++ filter/source/config/fragments/types/writer_OOXML_Template.xcu
@@ -0,0 +1,12 @@
+    <node oor:name="writer_OOXML_Text_Template" oor:op="replace" >
+    <prop oor:name="DetectService"><value>com.sun.star.comp.oox.FormatDetector</value></prop>
+        <prop oor:name="URLPattern"/>
+        <prop oor:name="Extensions"><value>dotx dotm</value></prop>
+        <prop oor:name="MediaType"><value>application/vnd.openxmlformats-officedocument.wordprocessingml.template</value></prop>
+        <prop oor:name="Preferred"><value>true</value></prop>
+        <prop oor:name="PreferredFilter"><value>Office Open XML Text Template</value></prop>
+        <prop oor:name="UIName">
+            <value>Office Open XML Text Template</value>
+        </prop>
+        <prop oor:name="ClipboardFormat"><value>MSWordDoc</value></prop>
+    </node>
