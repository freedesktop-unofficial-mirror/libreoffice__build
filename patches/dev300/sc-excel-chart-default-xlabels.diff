From ecb801a41c7b4f9eb36849d5abecc36a92fed24a Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:55:26 +0200
Subject: [PATCH 158/878] sc-excel-chart-default-xlabels.diff

---
 sc/source/ui/unoobj/chart2uno.cxx |   11 +++--------
 1 files changed, 3 insertions(+), 8 deletions(-)

diff --git a/sc/source/ui/unoobj/chart2uno.cxx b/sc/source/ui/unoobj/chart2uno.cxx
index 764c1ba..2f7a89e 100644
--- a/sc/source/ui/unoobj/chart2uno.cxx
+++ b/sc/source/ui/unoobj/chart2uno.cxx
@@ -3971,14 +3971,9 @@ uno::Sequence< rtl::OUString > SAL_CALL ScChart2EmptyDataSequence::getTextualDat
         }
         else
         {
-            for (sal_Int32 nRow = p->aStart.Row(); nRow <= p->aEnd.Row(); ++nRow)
-            {
-                String aString = ScGlobal::GetRscString(STR_ROW);
-                aString += ' ';
-                aString += String::CreateFromInt32( nRow+1 );
-                pArr[nCount] = aString;
-                ++nCount;
-            }
+            sal_Int32 n = p->aEnd.Row() - p->aStart.Row() + 1;
+            for (sal_Int32 i = 0; i < n; ++i)
+                pArr[nCount++] = String::CreateFromInt32( i+1 );
         }
     }
     return aSeq;
-- 
1.7.0.1

