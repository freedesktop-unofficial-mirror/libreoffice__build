From 09b7c3964b93193314d4b382e9345a1b9aae4d1b Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:53:22 +0200
Subject: [PATCH 035/768] sc-cellsuno-avoid-early-destruction.diff

---
 sc/source/ui/unoobj/cellsuno.cxx |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git sc/source/ui/unoobj/cellsuno.cxx sc/source/ui/unoobj/cellsuno.cxx
index 197c562..7c177f1 100644
--- sc/source/ui/unoobj/cellsuno.cxx
+++ sc/source/ui/unoobj/cellsuno.cxx
@@ -1493,9 +1493,10 @@ void ScCellRangesBase::Notify( SfxBroadcaster&, const SfxHint& rHint )
         if ( aRanges.UpdateReference( rRef.GetMode(), pDoc, rRef.GetRange(),
                                     rRef.GetDx(), rRef.GetDy(), rRef.GetDz() ) )
         {
+            uno::Reference<uno::XInterface> xInterface((cppu::OWeakObject*)this, uno::UNO_QUERY);
             if (rRef.GetMode() == URM_INSDEL &&
                 aRanges.Count() == 1 &&
-                ScTableSheetObj::getImplementation( (cppu::OWeakObject*)this ))
+                ScTableSheetObj::getImplementation( xInterface ))
             {
                 // #101755#; the range size of a sheet does not change
                 ScRange* pR = aRanges.First();
-- 
1.7.0.1

