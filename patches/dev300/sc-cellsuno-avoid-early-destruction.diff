From 00e0dff879a5a0dea3027d6ac76f53fa6e4cbd7c Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:53:22 +0200
Subject: [PATCH 049/878] sc-cellsuno-avoid-early-destruction.diff

---
 sc/source/ui/unoobj/cellsuno.cxx |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/sc/source/ui/unoobj/cellsuno.cxx b/sc/source/ui/unoobj/cellsuno.cxx
index 0dea3f8..73c4e0c 100644
--- a/sc/source/ui/unoobj/cellsuno.cxx
+++ b/sc/source/ui/unoobj/cellsuno.cxx
@@ -1493,9 +1493,10 @@ void ScCellRangesBase::Notify( SfxBroadcaster&, const SfxHint& rHint )
         if ( aRanges.UpdateReference( rRef.GetMode(), pDoc, rRef.GetRange(),
                                     rRef.GetDx(), rRef.GetDy(), rRef.GetDz() ) )
         {
+            uno::Reference<uno::XInterface> xInterface((cppu::OWeakObject*)this, uno::UNO_QUERY);
             if (rRef.GetMode() == URM_INSDEL &&
                 aRanges.Count() == 1 &&
-                ScTableSheetObj::getImplementation( (cppu::OWeakObject*)this ))
+                ScTableSheetObj::getImplementation( xInterface ))
             {
                 // #101755#; the range size of a sheet does not change
                 ScRange* pR = aRanges.First();
-- 
1.7.0.1

