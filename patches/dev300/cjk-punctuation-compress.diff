--- vcl-orig/source/gdi/sallayout.cxx	2008-06-16 17:35:42.000000000 +0800
+++ vcl/source/gdi/sallayout.cxx	2008-06-16 17:36:10.000000000 +0800
@@ -798,13 +798,16 @@ int SalLayout::CalcAsianKerning( sal_UCS
         nResult = nTable[ c - 0x3000 ];
     else switch( c )
     {
-        case ':': case ';': case '!':
-            if( !bVertical )
-                nResult = bLeft ? -1 : +1;  // 25% left and right
-            break;
         case 0x30FB:
             nResult = bLeft ? -1 : +1;      // 25% left/right/top/bottom
             break;
+        case 0xFF09 : case 0xFF0C : case 0xFF1A : case 0xFF1B : case 0x2019 : case 0x201D : case 0xFF01 :
+            if ( !bVertical )
+            	nResult = -2;
+            break;
+        case 0xFF08 : case 0x201C : case 0x2018 : 
+            nResult = +2;
+            break;
         default:
             break;
     }
@@ -1231,8 +1234,9 @@ void GenericSalLayout::ApplyAsianKerning
     {
         int n = pG->mnCharPos;
         if( (n < nLength - 1)
-        &&  (0x3000 == (0xFF00 & pStr[n]))
-        &&  (0x3000 == (0xFF00 & pStr[n+1])) )
+        && ((0x3000 == (0xFF00 & pStr[n])) || (0x2010 == (0xFFF0 & pStr[n])) || (0xFF00 == (0xFF00 & pStr[n])))
+        &&  ((0x3000 == (0xFF00 & pStr[n+1])) || (0x2010 == (0xFFF0 & pStr[n+1])) || (0xFF00 == (0xFF00 & pStr[n+1])))
+        )
         {
             const bool bVertical = false;
             long nKernFirst = +CalcAsianKerning( pStr[n], true, bVertical );
@@ -1250,7 +1254,7 @@ void GenericSalLayout::ApplyAsianKerning
         }
 
         if( pG+1 != pGEnd )
-            pG->maLinearPos.X() += nOffset;
+            (pG+1)->maLinearPos.X() += nOffset;
     }
 }
 
--- vcl-orig/source/glyphs/gcach_layout.cxx	2008-06-16 17:35:32.000000000 +0800
+++ vcl/source/glyphs/gcach_layout.cxx	2008-06-16 17:36:10.000000000 +0800
@@ -85,7 +85,7 @@ void ServerFontLayout::AdjustLayout( Imp
     // apply asian kerning if the glyphs are not already formatted
     if( (rArgs.mnFlags & SAL_LAYOUT_KERNING_ASIAN)
     && !(rArgs.mnFlags & SAL_LAYOUT_VERTICAL) )
-        if( (rArgs.mpDXArray != NULL) || (rArgs.mnLayoutWidth != 0) )
+        if( (rArgs.mpDXArray == NULL) || (rArgs.mnLayoutWidth != 0) )
             ApplyAsianKerning( rArgs.mpStr, rArgs.mnLength );
 
     // insert kashidas where requested by the formatting array
--- vcl-orig/win/source/gdi/winlayout.cxx	2008-03-26 14:50:58.000000000 +0800
+++ vcl/win/source/gdi/winlayout.cxx	2008-04-01 12:33:48.000000000 +0800
@@ -320,7 +320,7 @@ bool SimpleWinLayout::LayoutText( ImplLa
     {
         TEXTMETRICA aTextMetricA;
         if( ::GetTextMetricsA( mhDC, &aTextMetricA )
-        && !(aTextMetricA.tmPitchAndFamily & TMPF_FIXED_PITCH) )
+        && !(aTextMetricA.tmPitchAndFamily & TMPF_FIXED_PITCH) && !(aTextMetricA.tmCharSet == 0x86) )
             rArgs.mnFlags &= ~SAL_LAYOUT_KERNING_ASIAN;
     }
 
@@ -523,8 +523,8 @@ bool SimpleWinLayout::LayoutText( ImplLa
             else if( rArgs.mnFlags & SAL_LAYOUT_KERNING_ASIAN )
 #endif // GCP_KERN_HACK
 
-            if( (0x3000 == (0xFF00 & pBidiStr[i-1]))
-            &&  (0x3000 == (0xFF00 & pBidiStr[i])) )
+            if( ( (0x3000 == (0xFF00 & pBidiStr[i-1])) || (0x2010 == (0xFFF0 & pBidiStr[i-1])) || (0xFF00 == (0xFF00 & pBidiStr[i-1])))
+            &&  ( (0x3000 == (0xFF00 & pBidiStr[i])) || (0x2010 == (0xFFF0 & pBidiStr[i])) || (0xFF00 == (0xFF00 & pBidiStr[i])) ) )
             {
                 long nKernFirst = +CalcAsianKerning( pBidiStr[i-1], true, bVertical );
                 long nKernNext  = -CalcAsianKerning( pBidiStr[i], false, bVertical );
