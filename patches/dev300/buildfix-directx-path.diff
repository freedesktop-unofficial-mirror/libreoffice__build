--- config_office/set_soenv.in	2008-09-01 11:17:18.238778500 +0200
+++ config_office/set_soenv.in	2008-09-01 12:22:09.738788000 +0200
@@ -1328,7 +1328,23 @@ elsif ($platform =~ m/cygwin/)
    if (($^O eq "cygwin")) { # Not for ActiveState perl
        my $expandedPATH = $PATH;
        $expandedPATH =~ s/(\$\w+)/$1/eeg;
+
+       # fix situations where PATH may look like /bin:"C:\blah\bleh":/ugh
+       my $fixedPATH = $oldPATH;
+       if ( $oldPATH =~ /"/ ) {
+	   $fixedPATH = "";
+	   foreach my $pathentry ( split( '"',$oldPATH ) ) {
+	       if ( ( $pathentry =~ /^$ps/ ) || ( $pathentry =~ /$ps$/ ) ) {
+		   $fixedPATH .= $pathentry;
+	       } else {
+		   chomp( $pathentry = qx{cygpath -d "$pathentry"} ) ;
+		   chomp( $pathentry = qx{cygpath -u "$pathentry"} ) ;
+		   $fixedPATH .= $pathentry;
+	       }
+	   }
+       }
+
-       foreach my $pathentry (split($ps,$oldPATH)) {
+       foreach my $pathentry (split($ps,$fixedPATH)) {
            if ( ! ( $expandedPATH =~ /(?:$ps|\A)(?:$pathentry)(?:$ps|\Z)/ ) ) {
                $PATH .= $ps.$pathentry;
                $expandedPATH .= $ps.$pathentry;
