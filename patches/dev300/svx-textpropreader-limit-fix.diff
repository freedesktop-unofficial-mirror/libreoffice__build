Limit checking in the text property reader

From: Thorsten Behrens <tbehrens@novell.com>


---

 svx/source/svdraw/svdfppt.cxx |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)


diff --git svx/source/svdraw/svdfppt.cxx svx/source/svdraw/svdfppt.cxx
index c452472..ef047d3 100644
--- svx/source/svdraw/svdfppt.cxx
+++ svx/source/svdraw/svdfppt.cxx
@@ -5336,8 +5336,8 @@ void PPTStyleTextPropReader::Init( SvStream& rIn, SdrPowerPointImport& rMan, con
     DffRecordHeader aTextHd;
     rIn >> aTextHd;
     sal_uInt32 nMaxLen = aTextHd.nRecLen;
-    if ( nMaxLen > 0xFFFF )
-        nMaxLen = 0xFFFF;
+    if ( nMaxLen >= 0xFFFF )
+        nMaxLen = 0xFFFE;
 
     if( aTextHd.nRecType == PPT_PST_TextCharsAtom )
     {
