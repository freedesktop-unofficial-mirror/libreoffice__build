Give additional slot call parameters for SID_INSERT_AVMEDIA

From: Thorsten Behrens <tbehrens@novell.com>


---

 avmedia/source/framework/mediaplayer.cxx |    8 +++++++-
 sc/source/ui/view/tabvwsh9.cxx           |    4 +++-
 sd/source/ui/view/drviews9.cxx           |    4 +++-
 sw/source/ui/shells/basesh.cxx           |    4 +++-
 4 files changed, 16 insertions(+), 4 deletions(-)


diff --git avmedia/source/framework/mediaplayer.cxx avmedia/source/framework/mediaplayer.cxx
index 1042c8e..8f172ff 100644
--- avmedia/source/framework/mediaplayer.cxx
+++ avmedia/source/framework/mediaplayer.cxx
@@ -36,6 +36,7 @@
 #include "helpids.hrc"
 
 #include <svtools/stritem.hxx>
+#include <svtools/eitem.hxx>
 #include <sfx2/app.hxx>
 #include <sfx2/sfxsids.hrc>
 #include <sfx2/bindings.hxx>
@@ -162,7 +163,12 @@ void MediaFloater::dispatchCurrentURL()
     if( pDispatcher )
     {	
         const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, getURL() );
-        pDispatcher->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_RECORD, &aMediaURLItem, 0L );
+        const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
+        pDispatcher->Execute( SID_INSERT_AVMEDIA, 
+                              SFX_CALLMODE_RECORD, 
+                              &aMediaURLItem, 
+                              &aLinkFlagItem, 
+                              0L );
     }
 }
 
diff --git sc/source/ui/view/tabvwsh9.cxx sc/source/ui/view/tabvwsh9.cxx
index 88ebdc9..8ea0417 100644
--- sc/source/ui/view/tabvwsh9.cxx
+++ sc/source/ui/view/tabvwsh9.cxx
@@ -154,7 +154,9 @@ void ScTabViewShell::ExecGallery( SfxRequest& rReq )
                 if ( pGal )
                 {
                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
-                       GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
+                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
+                       GetViewFrame()->GetDispatcher()->Execute( 
+                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
                 }
             }
         }
diff --git sd/source/ui/view/drviews9.cxx sd/source/ui/view/drviews9.cxx
index 57064c6..0f8dd8c 100644
--- sd/source/ui/view/drviews9.cxx
+++ sd/source/ui/view/drviews9.cxx
@@ -220,7 +220,9 @@ void DrawViewShell::ExecGallery(SfxRequest& rReq)
             else if( nFormats & SGA_FORMAT_SOUND )
             {
                 const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
-                   GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
+                const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
+                GetViewFrame()->GetDispatcher()->Execute( 
+                    SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
             }
 
             GetDocSh()->SetWaitCursor( FALSE );
diff --git sw/source/ui/shells/basesh.cxx sw/source/ui/shells/basesh.cxx
index a32d3e1..c891e53 100644
--- sw/source/ui/shells/basesh.cxx
+++ sw/source/ui/shells/basesh.cxx
@@ -776,7 +776,9 @@ void SwBaseShell::Execute(SfxRequest &rReq)
                 else if(!rSh.IsSelFrmMode() && SGA_FORMAT_SOUND & ((SfxUInt32Item*)pItem)->GetValue())
                 {
                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
-                       GetView().GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
+                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
+                       GetView().GetViewFrame()->GetDispatcher()->Execute( 
+                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
 /*
                     String sURL( pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
                     String sLabel( pGal->GetURL().getBase() );
