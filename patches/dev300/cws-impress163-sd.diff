Index: source/core/stlpool.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/core/stlpool.cxx,v
retrieving revision 1.41
retrieving revision 1.41.68.1
diff -u -p -r1.41 -r1.41.68.1
--- sd/source/core/stlpool.cxx	7 Jul 2008 13:32:22 -0000	1.41
+++ sd/source/core/stlpool.cxx	20 Oct 2008 14:56:52 -0000	1.41.68.1
@@ -674,6 +674,8 @@ void SdStyleSheetPool::CopyTableStyles(S
 
 void SdStyleSheetPool::CopySheets(SdStyleSheetPool& rSourcePool, SfxStyleFamily eFamily )
 {
+    String aHelpFile;
+
 	sal_uInt32 nCount = rSourcePool.aStyles.size();
 
 	std::vector< std::pair< rtl::Reference< SfxStyleSheetBase >, String > > aNewStyles;
@@ -696,6 +698,7 @@ void SdStyleSheetPool::CopySheets(SdStyl
                 if( aParent.Len() )
 					aNewStyles.push_back( std::pair< rtl::Reference< SfxStyleSheetBase >, String >( xNewSheet, aParent ) );
 
+                xNewSheet->SetHelpId( aHelpFile, xSheet->GetHelpId( aHelpFile ) );
 				xNewSheet->GetItemSet().Put( xSheet->GetItemSet() );
 			}
 		}
@@ -732,6 +735,7 @@ void SdStyleSheetPool::CopyLayoutSheets(
 
 	List* pNameList = CreateLayoutSheetNames(rLayoutName);
 
+    String sEmpty;
 	String* pName = (String*)pNameList->First();
 	while (pName)
 	{
@@ -744,6 +748,7 @@ void SdStyleSheetPool::CopyLayoutSheets(
 			{
 				// falls einer mit Methusalem-Doks. ankommt
 				SfxStyleSheetBase& rNewSheet = Make(*pName, SD_STYLE_FAMILY_MASTERPAGE);
+                rNewSheet.SetHelpId( sEmpty, pSourceSheet->GetHelpId( sEmpty ) );
 				rNewSheet.GetItemSet().Put(pSourceSheet->GetItemSet());
 				rCreatedSheets.push_back( SdStyleSheetRef( static_cast< SdStyleSheet* >( &rNewSheet ) ) );
 			}
Index: source/ui/framework/configuration/ConfigurationController.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/framework/configuration/ConfigurationController.cxx,v
retrieving revision 1.7
retrieving revision 1.7.68.1
diff -u -p -r1.7 -r1.7.68.1
--- sd/source/ui/framework/configuration/ConfigurationController.cxx	11 Jul 2008 13:35:17 -0000	1.7
+++ sd/source/ui/framework/configuration/ConfigurationController.cxx	21 Oct 2008 15:24:49 -0000	1.7.68.1
@@ -305,7 +305,11 @@ void SAL_CALL ConfigurationController::u
     throw (RuntimeException)
 {
     ::osl::MutexGuard aGuard (maMutex);
-    ThrowIfDisposed();
+
+    // Allow unlocking while the ConfigurationController is being disposed
+    // (but not when that is done and the controller is disposed.)
+    if (rBHelper.bDisposed)
+        ThrowIfDisposed();
 
     OSL_ASSERT(mpImplementation->mnLockCount>0);
     --mpImplementation->mnLockCount;
Index: source/ui/func/fuprlout.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/func/fuprlout.cxx,v
retrieving revision 1.17
retrieving revision 1.17.130.1
diff -u -p -r1.17 -r1.17.130.1
--- sd/source/ui/func/fuprlout.cxx	10 Apr 2008 20:24:19 -0000	1.17
+++ sd/source/ui/func/fuprlout.cxx	20 Oct 2008 14:57:41 -0000	1.17.130.1
@@ -287,32 +287,4 @@ void FuPresentationLayout::DoExecute( Sf
 	}
 }
 
-/*************************************************************************
-|*
-|* Layoutvorlage von einem StyleSheetPool in einen anderen uebertragen
-|*
-\************************************************************************/
-
-void FuPresentationLayout::TransferLayoutTemplate(String aFromName,
-												  String aToName,
-												  SfxStyleSheetBasePool* pFrom,
-												  SfxStyleSheetBasePool* pTo)
-{
-	SfxStyleSheetBase* pHis = pFrom->Find(aFromName,SD_STYLE_FAMILY_MASTERPAGE);
-	SfxStyleSheetBase* pMy	= pTo->Find(aToName, SD_STYLE_FAMILY_MASTERPAGE);
-
-	DBG_ASSERT(pHis, "neue Layoutvorlage nicht gefunden");
-
-	// gibt's noch nicht: neu anlegen
-	if (!pMy)
-	{
-		pMy = &(pTo->Make(aToName, SD_STYLE_FAMILY_MASTERPAGE));
-	}
-
-	// Inhalte neu setzen
-	if (pHis)
-		pMy->GetItemSet().Set(pHis->GetItemSet());
-}
-
-
 } // end of namespace sd
Index: source/ui/inc/fuprlout.hxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/inc/fuprlout.hxx,v
retrieving revision 1.5
retrieving revision 1.5.130.1
diff -u -p -r1.5 -r1.5.130.1
--- sd/source/ui/inc/fuprlout.hxx	10 Apr 2008 21:17:17 -0000	1.5
+++ sd/source/ui/inc/fuprlout.hxx	20 Oct 2008 14:57:31 -0000	1.5.130.1
@@ -59,10 +59,6 @@ private:
         ::sd::View* pView,
         SdDrawDocument* pDoc, 
         SfxRequest& rReq);
-
-	void TransferLayoutTemplate(String aFromName, String aToName,
-								SfxStyleSheetBasePool* pFrom,
-								SfxStyleSheetBasePool* pTo);
 };
 
 } // end of namespace sd
? .gitignore
? unxlngx6
? source/table/localize.sdf
