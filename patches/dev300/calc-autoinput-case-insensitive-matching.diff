From 2b78aa5addb3bbf7c9fab54432364c8127e01110 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:01 +0200
Subject: [PATCH 163/768] calc-autoinput-case-insensitive-matching.diff

---
 sc/source/ui/app/inputhdl.cxx |   12 +++---------
 1 files changed, 3 insertions(+), 9 deletions(-)

diff --git sc/source/ui/app/inputhdl.cxx sc/source/ui/app/inputhdl.cxx
index 9d57d8b..9538ba8 100644
--- sc/source/ui/app/inputhdl.cxx
+++ sc/source/ui/app/inputhdl.cxx
@@ -2579,15 +2579,9 @@ void ScInputHandler::EnterHandler( BYTE nBlockMode )
         }
         else if (bAutoComplete)			// Gross-/Kleinschreibung anpassen
         {
-            if (pColumnData)
-                pColumnData->GetExactMatch( aString );
-
-            //!	effizienter in der Liste suchen (ScUserList, nur einmal ToUpper)
-
-            USHORT nIndex;
-            ScUserListData* pData = ScGlobal::GetUserList()->GetData(aString);
-            if ( pData && pData->GetSubIndex( aString, nIndex ) )
-                aString = pData->GetSubStr( nIndex );
+            // Perform case-matching only when the typed text is partial.
+            if (pColumnData && aAutoSearch.Len() < aString.Len())
+                pColumnData->GetExactMatch(aString);
         }
     }
 
-- 
1.7.0.1

