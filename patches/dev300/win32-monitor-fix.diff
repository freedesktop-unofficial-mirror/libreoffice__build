Fix handling of multiple monitors for win32

From: Thorsten Behrens <tbehrens@novell.com>


---

 vcl/win/source/app/salinfo.cxx |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)


diff --git vcl/win/source/app/salinfo.cxx vcl/win/source/app/salinfo.cxx
index 1450739..63a6ecf 100644
--- vcl/win/source/app/salinfo.cxx
+++ vcl/win/source/app/salinfo.cxx
@@ -163,7 +163,8 @@ bool WinSalSystem::initMonitors()
             std::hash_map< rtl::OUString, int, rtl::OUStringHash > aDeviceStringCount;
             while( EnumDisplayDevicesW( NULL, nDevice++, &aDev, 0 ) )
             {
-                if( (aDev.StateFlags & DISPLAY_DEVICE_MIRRORING_DRIVER) == 0 ) // sort out non monitors
+                if( (aDev.StateFlags & DISPLAY_DEVICE_ACTIVE)
+                    && !(aDev.StateFlags & DISPLAY_DEVICE_MIRRORING_DRIVER) ) // sort out non/disabled monitors
                 {
                     aDev.DeviceName[31] = 0;
                     aDev.DeviceString[127] = 0;
