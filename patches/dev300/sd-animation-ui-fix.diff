From b02f02126528455e13d23c69741749d4be51ad45 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:05:36 +0200
Subject: [PATCH 679/878] sd-animation-ui-fix.diff

---
 sd/source/ui/dlg/docprev.cxx |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/sd/source/ui/dlg/docprev.cxx b/sd/source/ui/dlg/docprev.cxx
index 87190b0..854b666 100644
--- a/sd/source/ui/dlg/docprev.cxx
+++ b/sd/source/ui/dlg/docprev.cxx
@@ -64,7 +64,11 @@ void SdDocPreviewWin::SetObjectShell( SfxObjectShell* pObj, sal_uInt16 nShowPage
 {
     mpObj = pObj;
     mnShowPage = nShowPage;
-    mxSlideShow.clear();
+    if (mxSlideShow.is())
+    {
+        mxSlideShow->end();
+        mxSlideShow.clear();
+    }
     updateViewSettings();
 }
 
-- 
1.7.0.1

