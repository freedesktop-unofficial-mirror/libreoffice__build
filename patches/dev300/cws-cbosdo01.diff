From 41f056085d1b9da9ce81519275065927ceb8b4c1 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:02:34 +0200
Subject: [PATCH 523/878] cws-cbosdo01.diff

---
 .../schema/org/openoffice/Office/Common.xcs        |   18 +-
 .../schema/org/openoffice/Office/Writer.xcs        |   29 +--
 svx/inc/helpid.hrc                                 |    2 +
 svx/inc/svx/svxacorr.hxx                           |   12 +-
 svx/inc/svx/swafopt.hxx                            |    3 +-
 svx/source/cui/autocdlg.cxx                        |  189 +++++++++++++++-----
 svx/source/cui/autocdlg.hrc                        |    2 +-
 svx/source/cui/autocdlg.hxx                        |   19 ++-
 svx/source/cui/autocdlg.src                        |   79 +++++----
 svx/source/dialog/simptabl.cxx                     |    2 +-
 svx/source/editeng/acorrcfg.cxx                    |  185 ++++++++++----------
 svx/source/editeng/editeng.cxx                     |    4 +-
 svx/source/editeng/svxacorr.cxx                    |  144 ++++++++++-----
 svx/source/editeng/swafopt.cxx                     |    6 +-
 svx/util/hidother.src                              |    6 +-
 sw/inc/comcore.hrc                                 |    3 +-
 sw/source/core/edit/autofmt.cxx                    |   46 ++++--
 sw/source/ui/docvw/edtwin.cxx                      |    4 +-
 sw/source/ui/shells/textsh.cxx                     |    2 +-
 sw/source/ui/utlui/utlui.src                       |    4 +
 sw/source/ui/wrtsh/wrtsh1.cxx                      |    2 +-
 21 files changed, 471 insertions(+), 290 deletions(-)

diff --git a/officecfg/registry/schema/org/openoffice/Office/Common.xcs b/officecfg/registry/schema/org/openoffice/Office/Common.xcs
index bcbf61d..4011321 100644
--- a/officecfg/registry/schema/org/openoffice/Office/Common.xcs
+++ b/officecfg/registry/schema/org/openoffice/Office/Common.xcs
@@ -1295,25 +1295,25 @@ Dymamic border coloring means that when the mouse is hovered over a control, and
 				</info>
 				<value>true</value>
 			</prop>
-			<prop oor:name="ChangeFraction" oor:type="xs:boolean">
+            <prop oor:name="ChangeDash" oor:type="xs:boolean">
 				<!-- OldPath: AutoCorrect/Options/All -->
 				<!-- OldLocation: Soffice.cfg -->
-				<!-- UIHints: Tools  AutoCorrect/AutoFormat  Options  Replace 1/2... -->
+                <!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Replace dashes -->
 				<info>
 					<author>OS</author>
-					<desc>Specifies if character combinations for fractions should be replaced with a corresponding single character.</desc>
-					<label>Replace fractions</label>
+                    <desc>Specifies if minus signs should be replaced by dashes automatically.</desc>
+                    <label>Replace dashes</label>
 				</info>
 				<value>true</value>
 			</prop>
-			<prop oor:name="ChangeDash" oor:type="xs:boolean">
+            <prop oor:name="AddNonBreakingSpace" oor:type="xs:boolean">
 				<!-- OldPath: AutoCorrect/Options/All -->
 				<!-- OldLocation: Soffice.cfg -->
-				<!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Replace dashes -->
+                <!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Add non-breaking space -->
 				<info>
-					<author>OS</author>
-					<desc>Specifies if minus signs should be replaced by dashes automatically.</desc>
-					<label>Replace dashes</label>
+                    <author>cedricbosdo</author>
+                    <desc>Adds a non-breaking space before the characters :;!? in french.</desc>
+                    <label>Add non-breaking space</label>
 				</info>
 				<value>true</value>
 			</prop>
diff --git a/officecfg/registry/schema/org/openoffice/Office/Writer.xcs b/officecfg/registry/schema/org/openoffice/Office/Writer.xcs
index a504cf1..7244490 100644
--- a/officecfg/registry/schema/org/openoffice/Office/Writer.xcs
+++ b/officecfg/registry/schema/org/openoffice/Office/Writer.xcs
@@ -4412,25 +4412,25 @@
 						</info>
 						<value>true</value>
 					</prop>
-					<prop oor:name="ChangeFraction" oor:type="xs:boolean">
+                    <prop oor:name="ChangeDash" oor:type="xs:boolean">
 						<!-- OldPath: Writer/AutoFormat/Options -->
 						<!-- OldLocation: Soffice.cfg -->
-						<!-- UIHints: Tools  AutoCorrect/AutoFormat  Options  Replace 1/2... -->
+                        <!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Replace dashes -->
 						<info>
 							<author>OS</author>
-							<desc>Specifies if character combinations for fractions are replaced with a corresponding single character.</desc>
-							<label>Replace fractions</label>
+                            <desc>Specifies if dashes are replaced automatically.</desc>
+                            <label>Replace dashes</label>
 						</info>
 						<value>true</value>
 					</prop>
-					<prop oor:name="ChangeDash" oor:type="xs:boolean">
+                    <prop oor:name="AddNonBreakingSpace" oor:type="xs:boolean">
 						<!-- OldPath: Writer/AutoFormat/Options -->
 						<!-- OldLocation: Soffice.cfg -->
-						<!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Replace dashes -->
+                        <!-- UIHints: Tools  AutoCorrect/AutoFormat  Options - Add non-breaking space -->
 						<info>
-							<author>OS</author>
-							<desc>Specifies if dashes are replaced automatically.</desc>
-							<label>Replace dashes</label>
+                            <author>cedricbosdo</author>
+                            <desc>Adds a non-breaking space before the characters :!;? in french.</desc>
+                            <label>Add non-breaking space</label>
 						</info>
 						<value>true</value>
 					</prop>
@@ -4456,17 +4456,6 @@
 						</info>
 						<value>true</value>
 					</prop>
-					<prop oor:name="ReplaceQuote" oor:type="xs:boolean">
-						<!-- OldPath: Writer/AutoFormat/Options -->
-						<!-- OldLocation: Soffice.cfg -->
-						<!-- UIHints: Tools  AutoCorrect/AutoFormat  Options  Replace Standard Quotes... -->
-						<info>
-							<author>OS</author>
-							<desc>Specifies if standard quotes are replaced with custom quotes.</desc>
-							<label>Replace standard quotes with custom quotes</label>
-						</info>
-						<value>true</value>
-					</prop>
 					<prop oor:name="CombineParagraphs" oor:type="xs:boolean">
 						<!-- OldPath: Writer/AutoFormat/Options -->
 						<!-- OldLocation: Soffice.cfg -->
diff --git a/svx/inc/helpid.hrc b/svx/inc/helpid.hrc
index 8291f3e..0c27bc4 100644
--- a/svx/inc/helpid.hrc
+++ b/svx/inc/helpid.hrc
@@ -604,6 +604,8 @@
 #define HID_DBPATH_CTL_PATH					(HID_OFA_START + 125)
 #define HID_DBPATH_HEADERBAR				(HID_OFA_START + 126)
 #define HID_OFAPAGE_SMARTTAG_OPTIONS	    (HID_OFA_START + 127)
+#define HID_OFAPAGE_QUOTE_SW_CLB            (HID_OFA_START + 128)
+#define HID_OFAPAGE_QUOTE_CLB               (HID_OFA_START + 129)
 
 #define HID_OPTIONS_DICT_EDIT_ENTRIES_LIST      (HID_SVX_EXT0_START + 28)
 
diff --git a/svx/inc/svx/svxacorr.hxx b/svx/inc/svx/svxacorr.hxx
index b222876..14089bc 100644
--- a/svx/inc/svx/svxacorr.hxx
+++ b/svx/inc/svx/svxacorr.hxx
@@ -52,7 +52,7 @@ class Window;
 // Flags fuer die AutoKorrekt-Flags
 const long CptlSttSntnc		= 0x00000001;	// Gross-Buchstaben am SatzAnfang
 const long CptlSttWrd		= 0x00000002;	// keine 2 Gr.-Buchst. am WordAnfang
-const long ChgFractionSymbol= 0x00000004;	// 1/2, 1/4, .. ersetzen
+const long AddNonBrkSpace   = 0x00000004;	// Add non breaking space before :;?!
 const long ChgOrdinalNumber = 0x00000008;	// Ordinal-Number 1st, 2nd,..
 const long ChgToEnEmDash    = 0x00000010;	// - -> Endash/Emdash
 const long ChgWeightUnderl  = 0x00000020;	// * -> Fett, _ -> unterstreichen
@@ -61,7 +61,7 @@ const long Autocorrect 		= 0x00000080;	// Autokorrektur aufrufen
 const long ChgQuotes		= 0x00000100;	// doppelte Quotes ersetzen
 const long SaveWordCplSttLst= 0x00000200;	// GrB. am SatzAnf. auto. aufnehmen
 const long SaveWordWrdSttLst= 0x00000400;	// 2 GrB. am WortAnf. auto. aufnehmen
-const long IngnoreDoubleSpace= 0x00000800;	// 2 Spaces ignorieren
+const long IgnoreDoubleSpace= 0x00000800;	// 2 Spaces ignorieren
 const long ChgSglQuotes		= 0x00001000;	// einfache Quotes ersetzen
 const long CorrectCapsLock  = 0x00002000;   // Correct accidental use of cAPS LOCK key
 
@@ -215,7 +215,6 @@ class SVX_DLLPUBLIC SvxAutoCorrect
 
     long nFlags;
     sal_Unicode cStartDQuote, cEndDQuote, cStartSQuote, cEndSQuote,
-                c1Div2, c1Div4, c3Div4,
                 cEmDash, cEnDash;
 
 
@@ -358,14 +357,15 @@ public:
     BOOL FnCptlSttWrd( SvxAutoCorrDoc&, const String&,
                                 xub_StrLen nSttPos, xub_StrLen nEndPos,
                                 LanguageType eLang = LANGUAGE_SYSTEM );
-    BOOL FnChgFractionSymbol( SvxAutoCorrDoc&, const String&,
-                                xub_StrLen nSttPos, xub_StrLen nEndPos );
     BOOL FnChgOrdinalNumber( SvxAutoCorrDoc&, const String&,
                                 xub_StrLen nSttPos, xub_StrLen nEndPos,
                                 LanguageType eLang = LANGUAGE_SYSTEM );
     BOOL FnChgToEnEmDash( SvxAutoCorrDoc&, const String&,
                                 xub_StrLen nSttPos, xub_StrLen nEndPos,
                                 LanguageType eLang = LANGUAGE_SYSTEM );
+    BOOL FnAddNonBrkSpace( SvxAutoCorrDoc&, const String&,
+                                xub_StrLen nSttPos, xub_StrLen nEndPos,
+                                LanguageType eLang = LANGUAGE_SYSTEM );
     BOOL FnSetINetAttr( SvxAutoCorrDoc&, const String&,
                                 xub_StrLen nSttPos, xub_StrLen nEndPos,
                                 LanguageType eLang = LANGUAGE_SYSTEM );
@@ -387,6 +387,8 @@ public:
 // (used to avoid occasional 'collisions' with (Thai) input-sequence-checking)
     static sal_Bool		IsAutoCorrectChar( sal_Unicode cChar );
 
+    sal_Bool NeedsHardspaceAutocorr( sal_Unicode cChar );
+
     CharClass& GetCharClass( LanguageType eLang )
     {
         if( !pCharClass || eLang != eCharClassLang )
diff --git a/svx/inc/svx/swafopt.hxx b/svx/inc/svx/swafopt.hxx
index 7d50775..d4c47eb 100644
--- a/svx/inc/svx/swafopt.hxx
+++ b/svx/inc/svx/swafopt.hxx
@@ -49,7 +49,6 @@ struct SVX_DLLPUBLIC SvxSwAutoFmtFlags
 
     BYTE nRightMargin;
 
-    BOOL bReplaceQuote : 1;
     BOOL bAutoCorrect : 1;
     BOOL bCptlSttSntnc : 1;
     BOOL bCptlSttWrd : 1;
@@ -62,9 +61,9 @@ struct SVX_DLLPUBLIC SvxSwAutoFmtFlags
     BOOL bDelEmptyNode : 1;
     BOOL bSetNumRule : 1;
 
-    BOOL bChgFracionSymbol : 1;
     BOOL bChgOrdinalNumber : 1;
     BOOL bChgToEnEmDash : 1;
+    BOOL bAddNonBrkSpace : 1;
     BOOL bChgWeightUnderl : 1;
     BOOL bSetINetAttr : 1;
 
diff --git a/svx/source/cui/autocdlg.cxx b/svx/source/cui/autocdlg.cxx
index f143570..20e8ed7 100644
--- a/svx/source/cui/autocdlg.cxx
+++ b/svx/source/cui/autocdlg.cxx
@@ -228,9 +228,7 @@ OfaAutocorrOptionsPage::OfaAutocorrOptionsPage( Window* pParent,
     sBoldUnderline      (SVX_RES(ST_BOLD_UNDER        )),
     sURL                (SVX_RES(ST_DETECT_URL        )),
     sNoDblSpaces        (SVX_RES(STR_NO_DBL_SPACES    )),
-    sHalf               (SVX_RES(ST_FRACTION          )),
     sDash    			(SVX_RES(ST_DASH	         	)),
-    sFirst              (SVX_RES(ST_ORDINAL           )),
     sAccidentalCaps     (SVX_RES(ST_CORRECT_ACCIDENTAL_CAPS_LOCK))
 {
     FreeResource();
@@ -273,10 +271,8 @@ BOOL OfaAutocorrOptionsPage::FillItemSet( SfxItemSet& )
     pAutoCorrect->SetAutoCorrFlag(CptlSttSntnc, 		aCheckLB.IsChecked(nPos++));
     pAutoCorrect->SetAutoCorrFlag(ChgWeightUnderl,		aCheckLB.IsChecked(nPos++));
     pAutoCorrect->SetAutoCorrFlag(SetINetAttr, 			aCheckLB.IsChecked(nPos++));
-    pAutoCorrect->SetAutoCorrFlag(ChgOrdinalNumber,		aCheckLB.IsChecked(nPos++));
-    pAutoCorrect->SetAutoCorrFlag(ChgFractionSymbol,	aCheckLB.IsChecked(nPos++));
     pAutoCorrect->SetAutoCorrFlag(ChgToEnEmDash,		aCheckLB.IsChecked(nPos++));
-    pAutoCorrect->SetAutoCorrFlag(IngnoreDoubleSpace,	aCheckLB.IsChecked(nPos++));
+    pAutoCorrect->SetAutoCorrFlag(IgnoreDoubleSpace,	aCheckLB.IsChecked(nPos++));
     pAutoCorrect->SetAutoCorrFlag(CorrectCapsLock,      aCheckLB.IsChecked(nPos++));
 
     BOOL bReturn = nFlags != pAutoCorrect->GetFlags();
@@ -315,8 +311,6 @@ void OfaAutocorrOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.InsertEntry(sStartCap);
     aCheckLB.InsertEntry(sBoldUnderline);
     aCheckLB.InsertEntry(sURL);
-    aCheckLB.InsertEntry(sFirst);
-    aCheckLB.InsertEntry(sHalf);
     aCheckLB.InsertEntry(sDash);
     aCheckLB.InsertEntry(sNoDblSpaces);
     aCheckLB.InsertEntry(sAccidentalCaps);
@@ -327,10 +321,8 @@ void OfaAutocorrOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & CptlSttSntnc) );
     aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & ChgWeightUnderl) );
     aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & SetINetAttr) );
-    aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & ChgOrdinalNumber) );
-    aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & ChgFractionSymbol) );
     aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & ChgToEnEmDash) );
-    aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & IngnoreDoubleSpace) );
+    aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & IgnoreDoubleSpace) );
     aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & CorrectCapsLock) );
 
     aCheckLB.SetUpdateMode(TRUE);
@@ -458,8 +450,6 @@ enum OfaAutoFmtOptions
     BEGIN_UPPER,
     BOLD_UNDERLINE,
     DETECT_URL,
-    REPLACE_1ST,
-    REPLACE_HALF,
     REPLACE_DASHES,
     DEL_SPACES_AT_STT_END,
     DEL_SPACES_BETWEEN_LINES,
@@ -472,7 +462,6 @@ enum OfaAutoFmtOptions
     DEL_EMPTY_NODE,
     REPLACE_USER_COLL,
     REPLACE_BULLETS,
-    REPLACE_QUOTATION,
     MERGE_SINGLE_LINE_PARA
 };
 
@@ -489,16 +478,13 @@ OfaSwAutoFmtOptionsPage::OfaSwAutoFmtOptionsPage( Window* pParent,
     sUseReplaceTbl		(SVX_RES(	ST_USE_REPLACE  )),
     sCptlSttWord		(SVX_RES(	ST_CPTL_STT_WORD)),
     sCptlSttSent		(SVX_RES(	ST_CPTL_STT_SENT)),
-    sTypo				(SVX_RES(	ST_TYPO         )),
     sUserStyle			(SVX_RES(	ST_USER_STYLE   )),
     sBullet				(SVX_RES(	ST_BULLET       )),
     sBoldUnder			(SVX_RES(	ST_BOLD_UNDER   )),
     sNoDblSpaces		(SVX_RES(	STR_NO_DBL_SPACES)),
     sCorrectCapsLock    (SVX_RES(   ST_CORRECT_ACCIDENTAL_CAPS_LOCK)),
-    sFraction			(SVX_RES(	ST_FRACTION     )),
     sDetectURL			(SVX_RES(	ST_DETECT_URL   )),
     sDash				(SVX_RES(	ST_DASH         )),
-    sOrdinal			(SVX_RES(	ST_ORDINAL      )),
     sRightMargin		(SVX_RES(	ST_RIGHT_MARGIN	)),
     sNum				(SVX_RES(	STR_NUM			)),
     sBorder				(SVX_RES(	STR_BORDER		)),
@@ -516,10 +502,6 @@ OfaSwAutoFmtOptionsPage::OfaSwAutoFmtOptionsPage( Window* pParent,
     //typ. Anfuehrungszeichen einsetzen
     SvtSysLocale aSysLcl;
     const LocaleDataWrapper& rLcl = aSysLcl.GetLocaleData();
-    sTypo.SearchAndReplace( String::CreateFromAscii("%1"),
-                                        rLcl.getDoubleQuotationMarkStart());
-    sTypo.SearchAndReplace( String::CreateFromAscii("%2"),
-                                        rLcl.getDoubleQuotationMarkEnd());
 
     aCheckLB.SetHelpId(HID_OFAPAGE_AUTOFORMAT_CLB);
     aCheckLB.SetWindowBits(WB_HSCROLL| WB_VSCROLL);
@@ -632,7 +614,7 @@ BOOL OfaSwAutoFmtOptionsPage::FillItemSet( SfxItemSet&  )
     pAutoCorrect->SetAutoCorrFlag(ChgWeightUnderl,
                         aCheckLB.IsChecked(BOLD_UNDERLINE, CBCOL_SECOND));
 
-    pAutoCorrect->SetAutoCorrFlag(IngnoreDoubleSpace,
+    pAutoCorrect->SetAutoCorrFlag(IgnoreDoubleSpace,
                         aCheckLB.IsChecked(IGNORE_DBLSPACE, CBCOL_SECOND));
 
     pAutoCorrect->SetAutoCorrFlag(CorrectCapsLock,
@@ -644,20 +626,10 @@ BOOL OfaSwAutoFmtOptionsPage::FillItemSet( SfxItemSet&  )
     pAutoCorrect->SetAutoCorrFlag(SetINetAttr,
                         aCheckLB.IsChecked(DETECT_URL, CBCOL_SECOND));
 
-    bCheck = aCheckLB.IsChecked(REPLACE_1ST, CBCOL_FIRST);
-    bModified |= pOpt->bChgOrdinalNumber != bCheck;
-    pOpt->bChgOrdinalNumber = bCheck;
-    pAutoCorrect->SetAutoCorrFlag(ChgOrdinalNumber,
-                        aCheckLB.IsChecked(REPLACE_1ST, CBCOL_SECOND));
-
     bCheck = aCheckLB.IsChecked(DEL_EMPTY_NODE, CBCOL_FIRST);
     bModified |= pOpt->bDelEmptyNode != bCheck;
     pOpt->bDelEmptyNode = bCheck;
 
-    bCheck = aCheckLB.IsChecked(REPLACE_QUOTATION, CBCOL_FIRST);
-    bModified |= pOpt->bReplaceQuote != bCheck;
-    pOpt->bReplaceQuote = bCheck;
-
     bCheck = aCheckLB.IsChecked(REPLACE_USER_COLL, CBCOL_FIRST);
     bModified |= pOpt->bChgUserColl != bCheck;
     pOpt->bChgUserColl = bCheck;
@@ -697,12 +669,6 @@ BOOL OfaSwAutoFmtOptionsPage::FillItemSet( SfxItemSet&  )
     bModified |= pOpt->bReplaceStyles != bCheck;
     pOpt->bReplaceStyles = bCheck;
 
-    bCheck = aCheckLB.IsChecked(REPLACE_HALF, CBCOL_FIRST);
-    bModified |= pOpt->bChgFracionSymbol != bCheck;
-    pOpt->bChgFracionSymbol = bCheck;
-    pAutoCorrect->SetAutoCorrFlag(ChgFractionSymbol,
-                        aCheckLB.IsChecked(REPLACE_HALF, CBCOL_SECOND));
-
     bCheck = aCheckLB.IsChecked(REPLACE_DASHES, CBCOL_FIRST);
     bModified |= pOpt->bChgToEnEmDash != bCheck;
     pOpt->bChgToEnEmDash = bCheck;
@@ -762,8 +728,6 @@ void OfaSwAutoFmtOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.GetModel()->Insert(CreateEntry(sCptlSttSent,		CBCOL_BOTH	));
     aCheckLB.GetModel()->Insert(CreateEntry(sBoldUnder,			CBCOL_BOTH	));
     aCheckLB.GetModel()->Insert(CreateEntry(sDetectURL,			CBCOL_BOTH	));
-    aCheckLB.GetModel()->Insert(CreateEntry(sOrdinal,			CBCOL_BOTH	));
-    aCheckLB.GetModel()->Insert(CreateEntry(sFraction,			CBCOL_BOTH  ));
     aCheckLB.GetModel()->Insert(CreateEntry(sDash,				CBCOL_BOTH  ));
     aCheckLB.GetModel()->Insert(CreateEntry(sDelSpaceAtSttEnd,	CBCOL_BOTH  ));
     aCheckLB.GetModel()->Insert(CreateEntry(sDelSpaceBetweenLines, CBCOL_BOTH  ));
@@ -777,7 +741,6 @@ void OfaSwAutoFmtOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.GetModel()->Insert(CreateEntry(sDeleteEmptyPara,	CBCOL_FIRST	));
     aCheckLB.GetModel()->Insert(CreateEntry(sUserStyle,			CBCOL_FIRST	));
     aCheckLB.GetModel()->Insert(CreateEntry(sBullet,			CBCOL_FIRST	));
-    aCheckLB.GetModel()->Insert(CreateEntry(sTypo,				CBCOL_FIRST	));
     aCheckLB.GetModel()->Insert(CreateEntry(sRightMargin,		CBCOL_FIRST	));
 
     aCheckLB.CheckEntryPos( USE_REPLACE_TABLE, 	CBCOL_FIRST,	pOpt->bAutoCorrect );
@@ -788,14 +751,10 @@ void OfaSwAutoFmtOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.CheckEntryPos( BEGIN_UPPER,		CBCOL_SECOND,	0 != (nFlags & CptlSttSntnc) );
     aCheckLB.CheckEntryPos( BOLD_UNDERLINE,		CBCOL_FIRST,	pOpt->bChgWeightUnderl );
     aCheckLB.CheckEntryPos( BOLD_UNDERLINE,		CBCOL_SECOND,	0 != (nFlags & ChgWeightUnderl) );
-    aCheckLB.CheckEntryPos( IGNORE_DBLSPACE,	CBCOL_SECOND,	0 != (nFlags & IngnoreDoubleSpace) );
+    aCheckLB.CheckEntryPos( IGNORE_DBLSPACE,	CBCOL_SECOND,	0 != (nFlags & IgnoreDoubleSpace) );
     aCheckLB.CheckEntryPos( CORRECT_CAPS_LOCK,  CBCOL_SECOND,   0 != (nFlags & CorrectCapsLock) );
     aCheckLB.CheckEntryPos( DETECT_URL,			CBCOL_FIRST,	pOpt->bSetINetAttr );
     aCheckLB.CheckEntryPos( DETECT_URL,			CBCOL_SECOND,	0 != (nFlags & SetINetAttr) );
-    aCheckLB.CheckEntryPos( REPLACE_1ST,		CBCOL_FIRST,	pOpt->bChgOrdinalNumber );
-    aCheckLB.CheckEntryPos( REPLACE_1ST,		CBCOL_SECOND,	0 != (nFlags & ChgOrdinalNumber) );
-    aCheckLB.CheckEntryPos( REPLACE_HALF,		CBCOL_FIRST,	pOpt->bChgFracionSymbol );
-    aCheckLB.CheckEntryPos( REPLACE_HALF,		CBCOL_SECOND,	0 != (nFlags & ChgFractionSymbol) );
     aCheckLB.CheckEntryPos( REPLACE_DASHES,		CBCOL_FIRST,	pOpt->bChgToEnEmDash );
     aCheckLB.CheckEntryPos( REPLACE_DASHES,		CBCOL_SECOND,	0 != (nFlags & ChgToEnEmDash) );
     aCheckLB.CheckEntryPos( DEL_SPACES_AT_STT_END,		CBCOL_FIRST,	pOpt->bAFmtDelSpacesAtSttEnd );
@@ -803,7 +762,6 @@ void OfaSwAutoFmtOptionsPage::Reset( const SfxItemSet& )
     aCheckLB.CheckEntryPos( DEL_SPACES_BETWEEN_LINES,	CBCOL_FIRST,	pOpt->bAFmtDelSpacesBetweenLines );
     aCheckLB.CheckEntryPos( DEL_SPACES_BETWEEN_LINES,	CBCOL_SECOND,	pOpt->bAFmtByInpDelSpacesBetweenLines );
     aCheckLB.CheckEntryPos( DEL_EMPTY_NODE,		CBCOL_FIRST,	pOpt->bDelEmptyNode );
-    aCheckLB.CheckEntryPos( REPLACE_QUOTATION,	CBCOL_FIRST,	pOpt->bReplaceQuote );
     aCheckLB.CheckEntryPos( REPLACE_USER_COLL,	CBCOL_FIRST,	pOpt->bChgUserColl );
     aCheckLB.CheckEntryPos( REPLACE_BULLETS,	CBCOL_FIRST,	pOpt->bChgEnumNum );
 
@@ -2047,8 +2005,50 @@ void AutoCorrEdit::KeyInput( const KeyEvent& rKEvt )
 
 --------------------------------------------------*/
 
+enum OfaQuoteOptions
+{
+    ADD_NONBRK_SPACE,
+    REPLACE_1ST
+};
+
+SvLBoxEntry* OfaQuoteTabPage::CreateEntry(String& rTxt, USHORT nCol)
+{
+    SvLBoxEntry* pEntry = new SvLBoxEntry;
+
+    if ( !pCheckButtonData )
+    {
+        pCheckButtonData = new SvLBoxButtonData( &aSwCheckLB );
+        aSwCheckLB.SetCheckButtonData( pCheckButtonData );
+    }
+
+    pEntry->AddItem( new SvLBoxContextBmp( pEntry, 0, Image(), Image(), 0));	// Sonst Puff!
+
+    String sEmpty;
+    if (nCol == CBCOL_SECOND)
+        pEntry->AddItem( new SvLBoxString( pEntry, 0, sEmpty) );	// Leerspalte
+    else
+        pEntry->AddItem( new SvLBoxButton( pEntry, SvLBoxButtonKind_enabledCheckbox, 0, pCheckButtonData ) );
+
+    if (nCol == CBCOL_FIRST)
+        pEntry->AddItem( new SvLBoxString( pEntry, 0, sEmpty) );	// Leerspalte
+    else
+        pEntry->AddItem( new SvLBoxButton( pEntry, SvLBoxButtonKind_enabledCheckbox, 0, pCheckButtonData ) );
+
+    pEntry->AddItem( new OfaImpBrwString( pEntry, 0, rTxt ) );
+
+    return pEntry;
+}
+
 OfaQuoteTabPage::OfaQuoteTabPage( Window* pParent, const SfxItemSet& rSet ) :
     SfxTabPage(pParent, SVX_RES( RID_OFAPAGE_AUTOCORR_QUOTE ), rSet),
+    aCheckLB			(this, SVX_RES(CLB_SETTINGS     )),
+    aSwCheckLB			(this, SVX_RES(CLB_SETTINGS     )),
+    sHeader1			(SVX_RES( STR_HEADER1		    )),
+    sHeader2			(SVX_RES( STR_HEADER2		    )),
+    sNonBrkSpace		(SVX_RES( ST_NON_BREAK_SPACE    )),
+    sOrdinal			(SVX_RES( ST_ORDINAL            )),
+    pCheckButtonData    ( NULL ),
+
     aSingleFL           (this, SVX_RES(FL_SINGLE		 )),
     aSingleTypoCB       (this, SVX_RES(CB_SGL_TYPO     )),
     aSglStartQuoteFT    (this, SVX_RES(FT_SGL_STARTQUOTE )),
@@ -2076,6 +2076,38 @@ OfaQuoteTabPage::OfaQuoteTabPage( Window* pParent, const SfxItemSet& rSet ) :
 {
     FreeResource();
 
+    BOOL bShowSWOptions = FALSE;
+
+    aCheckLB.SetHelpId( HID_OFAPAGE_QUOTE_CLB );
+    aSwCheckLB.SetHelpId( HID_OFAPAGE_QUOTE_SW_CLB );
+
+    SFX_ITEMSET_ARG( &rSet, pItem, SfxBoolItem, SID_AUTO_CORRECT_DLG, FALSE );
+    if ( pItem && pItem->GetValue() )
+        bShowSWOptions = TRUE;
+
+    if ( bShowSWOptions )
+    {
+        static long aStaticTabs[]=
+        {
+            3, 0, 20, 40
+        };
+
+        aSwCheckLB.SetWindowBits(WB_HSCROLL| WB_VSCROLL);
+
+        aSwCheckLB.SvxSimpleTable::SetTabs(aStaticTabs);
+        String sHeader( sHeader1 );
+        sHeader += '\t';
+        sHeader += sHeader2;
+        sHeader += '\t';
+        aSwCheckLB.InsertHeaderEntry( sHeader, HEADERBAR_APPEND,
+                        HIB_CENTER | HIB_VCENTER | HIB_FIXEDPOS | HIB_FIXED);
+        aCheckLB.Hide( TRUE );
+    }
+    else
+    {
+        aSwCheckLB.HideTable( );
+    }
+
     aStartQuotePB.SetClickHdl(LINK(this, 	OfaQuoteTabPage, QuoteHdl));
     aEndQuotePB.SetClickHdl(LINK(this, 		OfaQuoteTabPage, QuoteHdl));
     aSglStartQuotePB.SetClickHdl(LINK(this, OfaQuoteTabPage, QuoteHdl));
@@ -2089,6 +2121,7 @@ OfaQuoteTabPage::OfaQuoteTabPage( Window* pParent, const SfxItemSet& rSet ) :
 --------------------------------------------------*/
 OfaQuoteTabPage::~OfaQuoteTabPage()
 {
+    delete( pCheckButtonData );
 }
 /*-----------------03.07.97 13:17-------------------
 
@@ -2106,6 +2139,32 @@ BOOL OfaQuoteTabPage::FillItemSet( SfxItemSet&  )
     SvxAutoCorrect* pAutoCorrect = SvxAutoCorrCfg::Get()->GetAutoCorrect();
 
     long nFlags = pAutoCorrect->GetFlags();
+
+    if ( aCheckLB.IsVisible( ) )
+    {
+        USHORT nPos = 0;
+        pAutoCorrect->SetAutoCorrFlag(AddNonBrkSpace,		aCheckLB.IsChecked(nPos++));
+        pAutoCorrect->SetAutoCorrFlag(ChgOrdinalNumber,		aCheckLB.IsChecked(nPos++));
+    }
+
+    BOOL bModified = FALSE;
+    if ( aSwCheckLB.IsVisible( ) )
+    {
+        SvxSwAutoFmtFlags *pOpt = &pAutoCorrect->GetSwFlags();
+
+        BOOL bCheck = aSwCheckLB.IsChecked(ADD_NONBRK_SPACE, CBCOL_FIRST);
+        bModified |= pOpt->bAddNonBrkSpace != bCheck;
+        pOpt->bAddNonBrkSpace = bCheck;
+        pAutoCorrect->SetAutoCorrFlag(AddNonBrkSpace,
+                            aSwCheckLB.IsChecked(ADD_NONBRK_SPACE, CBCOL_SECOND));
+
+        bCheck = aSwCheckLB.IsChecked(REPLACE_1ST, CBCOL_FIRST);
+        bModified |= pOpt->bChgOrdinalNumber != bCheck;
+        pOpt->bChgOrdinalNumber = bCheck;
+        pAutoCorrect->SetAutoCorrFlag(ChgOrdinalNumber,
+                        aSwCheckLB.IsChecked(REPLACE_1ST, CBCOL_SECOND));
+    }
+
     pAutoCorrect->SetAutoCorrFlag(ChgQuotes, 		aTypoCB.IsChecked());
     pAutoCorrect->SetAutoCorrFlag(ChgSglQuotes, 	aSingleTypoCB.IsChecked());
     BOOL bReturn = nFlags != pAutoCorrect->GetFlags();
@@ -2134,7 +2193,7 @@ BOOL OfaQuoteTabPage::FillItemSet( SfxItemSet&  )
         pAutoCorrect->SetEndSingleQuote(cUCS2);
     }
 
-    if(bReturn )
+    if( bModified || bReturn )
     {
         SvxAutoCorrCfg* pCfg = SvxAutoCorrCfg::Get();
         pCfg->SetModified();
@@ -2157,6 +2216,42 @@ void OfaQuoteTabPage::Reset( const SfxItemSet& )
     SvxAutoCorrect* pAutoCorrect = SvxAutoCorrCfg::Get()->GetAutoCorrect();
     const long nFlags = pAutoCorrect->GetFlags();
 
+    // Initialize the Sw options
+    if ( aSwCheckLB.IsVisible( ) )
+    {
+        SvxSwAutoFmtFlags *pOpt = &pAutoCorrect->GetSwFlags();
+
+        aSwCheckLB.SetUpdateMode( FALSE );
+        aSwCheckLB.Clear();
+
+        aSwCheckLB.GetModel()->Insert(CreateEntry(sNonBrkSpace,       CBCOL_BOTH ));
+        aSwCheckLB.GetModel()->Insert(CreateEntry(sOrdinal,           CBCOL_BOTH ));
+
+        aSwCheckLB.CheckEntryPos( ADD_NONBRK_SPACE, CBCOL_FIRST,	pOpt->bAddNonBrkSpace );
+        aSwCheckLB.CheckEntryPos( ADD_NONBRK_SPACE,	CBCOL_SECOND,	0 != (nFlags & AddNonBrkSpace) );
+        aSwCheckLB.CheckEntryPos( REPLACE_1ST,		CBCOL_FIRST,	pOpt->bChgOrdinalNumber );
+        aSwCheckLB.CheckEntryPos( REPLACE_1ST,		CBCOL_SECOND,	0 != (nFlags & ChgOrdinalNumber) );
+
+        aSwCheckLB.SetUpdateMode( TRUE );
+    }
+
+    // Initialize the non Sw options
+    if ( aCheckLB.IsVisible( ) )
+    {
+        aCheckLB.SetUpdateMode( FALSE );
+        aCheckLB.Clear( );
+
+        aCheckLB.InsertEntry( sNonBrkSpace );
+        aCheckLB.InsertEntry( sOrdinal );
+
+        USHORT nPos = 0;
+        aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & AddNonBrkSpace) );
+        aCheckLB.CheckEntryPos( nPos++, 0 != (nFlags & ChgOrdinalNumber) );
+
+        aCheckLB.SetUpdateMode( TRUE );
+    }
+
+    // Initialize the quote stuffs
     aTypoCB    			.Check(0 != (nFlags & ChgQuotes));
     aSingleTypoCB    	.Check(0 != (nFlags & ChgSglQuotes));
     aTypoCB    			.SaveValue();
diff --git a/svx/source/cui/autocdlg.hrc b/svx/source/cui/autocdlg.hrc
index 1054f2f..b4e8cbc 100644
--- a/svx/source/cui/autocdlg.hrc
+++ b/svx/source/cui/autocdlg.hrc
@@ -145,7 +145,7 @@
 #define STR_NO_DBL_SPACES               204
 #define ST_DETECT_URL                   205
 #define ST_ORDINAL                      206
-#define ST_FRACTION                     207
+#define ST_NON_BREAK_SPACE              207
 #define ST_DASH                         208
 #define FT_LANG                         209
 #define LB_LANG                         210
diff --git a/svx/source/cui/autocdlg.hxx b/svx/source/cui/autocdlg.hxx
index 33412d9..9ea616d 100644
--- a/svx/source/cui/autocdlg.hxx
+++ b/svx/source/cui/autocdlg.hxx
@@ -113,8 +113,8 @@ private:
     String		sBoldUnderline;
     String		sURL;
     String		sNoDblSpaces;
-    String		sHalf;
     String		sDash;
+    String      sNonBrkSpace;
     String		sFirst;
     String      sAccidentalCaps;
 
@@ -149,16 +149,15 @@ class OfaSwAutoFmtOptionsPage : public SfxTabPage
     String			sUseReplaceTbl;
     String			sCptlSttWord;
     String			sCptlSttSent;
-    String			sTypo;
     String			sUserStyle;
     String			sBullet;
     String			sByInputBullet;
     String			sBoldUnder;
     String			sNoDblSpaces;
     String          sCorrectCapsLock;
-    String			sFraction;
     String			sDetectURL;
     String          sDash;
+    String          sNonBrkSpace;
     String			sOrdinal;
     String			sRightMargin;
     String			sNum;
@@ -333,6 +332,18 @@ class OfaQuoteTabPage : public SfxTabPage
     using TabPage::ActivatePage;
 
 private:
+    // For anything but writer
+    SvxCheckListBox	aCheckLB;
+
+    // Just for writer
+    OfaACorrCheckListBox	aSwCheckLB;
+    String			sHeader1;
+    String			sHeader2;
+
+    String          sNonBrkSpace;
+    String          sOrdinal;
+
+    SvLBoxButtonData*	pCheckButtonData;
 
     FixedLine	aSingleFL;
     CheckBox    aSingleTypoCB;
@@ -371,6 +382,8 @@ private:
 
     String 				ChangeStringExt_Impl( sal_UCS4 );
 
+    SvLBoxEntry* CreateEntry(String& rTxt, USHORT nCol);
+
                         OfaQuoteTabPage( Window* pParent, const SfxItemSet& rSet );
 public:
                         ~OfaQuoteTabPage();
diff --git a/svx/source/cui/autocdlg.src b/svx/source/cui/autocdlg.src
index ca5be01..52a7dcb 100644
--- a/svx/source/cui/autocdlg.src
+++ b/svx/source/cui/autocdlg.src
@@ -70,7 +70,7 @@ TabDialog RID_OFA_AUTOCORR_DLG
             PageItem
             {
                 Identifier = RID_OFAPAGE_AUTOCORR_QUOTE ;
-                Text [ en-US ] = "Custom Quotes" ;
+                Text [ en-US ] = "Localized Options" ;
             };
             PageItem
             {
@@ -126,14 +126,6 @@ TabDialog RID_OFA_AUTOCORR_DLG
     { \
         Text [ en-US ] = "URL Recognition" ; \
     }; \
-    String ST_ORDINAL \
-    { \
-        Text [ en-US ] = "Replace 1st... with 1^st..." ; \
-    }; \
-    String ST_FRACTION \
-    { \
-        Text [ en-US ] = "Replace 1/2 ... with Â½ ..." ; \
-    }; \
     String ST_DASH \
     { \
         Text [ en-US ] = "Replace dashes" ; \
@@ -216,10 +208,6 @@ TabPage RID_OFAPAGE_AUTOFMT_APPLY
         /* ### ACHTUNG: Neuer Text in Resource? Leere Absätze entfernen : Leere Absõtze entfernen */
         Text [ en-US ] = "Remove blank paragraphs" ;
     };
-    String ST_TYPO
-    {
-        Text [ en-US ] = "Replace \"standard\" quotes with %1custom%2 quotes" ;
-    };
     String ST_USER_STYLE
     {
         Text [ en-US ] = "Replace Custom Styles" ;
@@ -495,114 +483,137 @@ TabPage RID_OFAPAGE_AUTOCORR_QUOTE
     Size = MAP_APPFONT ( 260 , 185 ) ;
     SVLook = TRUE ;
     Hide = TRUE ;
-    Text [ en-US ] = "Custom Quotes" ;
-    FixedLine FL_SINGLE
+    Text [ en-US ] = "Localized Options" ;
+    Control CLB_SETTINGS
     {
         Pos = MAP_APPFONT ( 4 , 3 ) ;
-        Size = MAP_APPFONT ( 252 , 8 ) ;
+        Size = MAP_APPFONT ( 252 , 85 ) ;
+        Border = TRUE ;
+        TabStop = TRUE ;
+    };
+    String STR_HEADER1
+    {
+        Text [ en-US ] = "[M]" ;
+    };
+    String STR_HEADER2
+    {
+        Text [ en-US ] = "[T]" ;
+    };
+    String ST_NON_BREAK_SPACE
+    {
+       Text [ en-US ] = "Add non breaking space before specific punctuation marks in french text" ;
+    };
+    String ST_ORDINAL
+    {
+        Text [ en-US ] = "Format ordinal numbers suffixes (1st -> 1^st)" ;
+    };
+    FixedLine FL_SINGLE
+    {
+        Pos = MAP_APPFONT ( 4 , 90 ) ;
+        Size = MAP_APPFONT ( 122 , 8 ) ;
         Text [ en-US ] = "Single quotes" ;
     };
     Checkbox CB_SGL_TYPO
     {
-        Pos = MAP_APPFONT ( 7 , 14 ) ;
+        Pos = MAP_APPFONT ( 7 , 101 ) ;
         Size = MAP_APPFONT ( 86 , 10 ) ;
         Text [ en-US ] = "Repla~ce" ;
     };
     FixedText FT_SGL_STARTQUOTE
     {
-        Pos = MAP_APPFONT ( 7 , 30 ) ;
+        Pos = MAP_APPFONT ( 7 , 114 ) ;
         Size = MAP_APPFONT ( 86 , 8 ) ;
         Text [ en-US ] = "~Start quote:" ;
     };
     PushButton PB_SGL_STARTQUOTE
     {
-        Pos = MAP_APPFONT ( 105 , 28 ) ;
+        Pos = MAP_APPFONT ( 10 , 125 ) ;
         Size = MAP_APPFONT ( 12 , 12 ) ;
         Text = "\'" ;
         TabStop = TRUE ;
     };
     FixedText FT_SGSTEX
     {
-        Pos = MAP_APPFONT ( 124 , 30 ) ;
+        Pos = MAP_APPFONT ( 26 , 127 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
     };
     FixedText FT_SGL_ENDQUOTE
     {
-        Pos = MAP_APPFONT ( 7 , 46 ) ;
+        Pos = MAP_APPFONT ( 7 , 139 ) ;
         Size = MAP_APPFONT ( 86 , 8 ) ;
         Text [ en-US ] = "~End quote:" ;
     };
     PushButton PB_SGL_ENDQUOTE
     {
-        Pos = MAP_APPFONT ( 105 , 44 ) ;
+        Pos = MAP_APPFONT ( 10 , 151 ) ;
         Size = MAP_APPFONT ( 12 , 12 ) ;
         Text = "\'" ;
         TabStop = TRUE ;
     };
     FixedText FT_SGENEX
     {
-        Pos = MAP_APPFONT ( 124 , 46 ) ;
+        Pos = MAP_APPFONT ( 26 , 153 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
     };
     PushButton PB_SGL_STD
     {
-        Pos = MAP_APPFONT ( 198 , 63 ) ;
+        Pos = MAP_APPFONT ( 7 , 167 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "~Default" ;
     };
     FixedLine FL_DOUBLE
     {
-        Pos = MAP_APPFONT ( 4 , 83 ) ;
-        Size = MAP_APPFONT ( 252 , 8 ) ;
+        Pos = MAP_APPFONT ( 134 , 90 ) ;
+        Size = MAP_APPFONT ( 122 , 8 ) ;
         Text [ en-US ] = "Double quotes" ;
     };
     CheckBox CB_TYPO
     {
-        Pos = MAP_APPFONT ( 7 , 94 ) ;
+        Pos = MAP_APPFONT ( 137 , 101 ) ;
         Size = MAP_APPFONT ( 86 , 10 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "Repl~ace" ;
     };
     FixedText FT_STARTQUOTE
     {
-        Pos = MAP_APPFONT ( 7 , 110 ) ;
+        Pos = MAP_APPFONT ( 137 , 114 ) ;
         Size = MAP_APPFONT ( 86 , 8 ) ;
         Text [ en-US ] = "Start q~uote:" ;
     };
     PushButton PB_STARTQUOTE
     {
-        Pos = MAP_APPFONT ( 105 , 108 ) ;
+        Pos = MAP_APPFONT ( 140 , 125 ) ;
         Size = MAP_APPFONT ( 12 , 12 ) ;
         Text = "\"" ;
         TabStop = TRUE ;
     };
     FixedText FT_DBSTEX
     {
-        Pos = MAP_APPFONT ( 124 , 110 ) ;
+        Pos = MAP_APPFONT ( 156 , 127 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
     };
     FixedText FT_ENDQUOTE
     {
-        Pos = MAP_APPFONT ( 7 , 126 ) ;
+        Pos = MAP_APPFONT ( 137 , 139 ) ;
         Size = MAP_APPFONT ( 86 , 10 ) ;
         Text [ en-US ] = "E~nd quote:" ;
     };
     PushButton PB_ENDQUOTE
     {
-        Pos = MAP_APPFONT ( 105 , 124 ) ;
+        Pos = MAP_APPFONT ( 140 , 151 ) ;
         Size = MAP_APPFONT ( 12 , 12 ) ;
         Text = "\"" ;
         TabStop = TRUE ;
     };
     FixedText FT_DBECEX
     {
-        Pos = MAP_APPFONT ( 124 , 126 ) ;
+        Pos = MAP_APPFONT ( 156 , 153 ) ;
         Size = MAP_APPFONT ( 50 , 8 ) ;
     };
     PushButton PB_DBL_STD
     {
-        Pos = MAP_APPFONT ( 195 , 143 ) ;
+        Pos = MAP_APPFONT ( 137 , 167 ) ;
         Size = MAP_APPFONT ( 50 , 14 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "De~fault" ;
diff --git a/svx/source/dialog/simptabl.cxx b/svx/source/dialog/simptabl.cxx
index d49f7ce..8f59151 100644
--- a/svx/source/dialog/simptabl.cxx
+++ b/svx/source/dialog/simptabl.cxx
@@ -288,7 +288,7 @@ void SvxSimpleTable::ShowTable()
 
 void SvxSimpleTable::HideTable()
 {
-    aPrivContainer.Show();
+    aPrivContainer.Hide();
 }
 
 BOOL SvxSimpleTable::IsVisible() const
diff --git a/svx/source/editeng/acorrcfg.cxx b/svx/source/editeng/acorrcfg.cxx
index 8b3008f..a9e51a5 100644
--- a/svx/source/editeng/acorrcfg.cxx
+++ b/svx/source/editeng/acorrcfg.cxx
@@ -116,7 +116,7 @@ Sequence<OUString> 	SvxBaseAutoCorrCfg::GetPropertyNames()
         "ChangeUnderlineWeight",				//  5
         "SetInetAttribute",						//  6
         "ChangeOrdinalNumber",					//  7
-        "ChangeFraction",						//  8
+        "AddNonBreakingSpace",                  //  8
         "ChangeDash",							//  9
         "RemoveDoubleSpaces",					// 10
         "ReplaceSingleQuote",					// 11
@@ -187,17 +187,17 @@ void SvxBaseAutoCorrCfg::Load(sal_Bool bInit)
                         if(*(sal_Bool*)pValues[nProp].getValue())
                             nFlags |= ChgOrdinalNumber;
                     break;//"ChangeOrdinalNumber",
-                    case  8:
+                    case 8:
                         if(*(sal_Bool*)pValues[nProp].getValue())
-                            nFlags |= ChgFractionSymbol;
-                    break;//"ChangeFraction",
+                             nFlags |= AddNonBrkSpace;
+                    break;//"AddNonBreakingSpace"
                     case  9:
                         if(*(sal_Bool*)pValues[nProp].getValue())
                             nFlags |= ChgToEnEmDash;
                     break;//"ChangeDash",
                     case 10:
                         if(*(sal_Bool*)pValues[nProp].getValue())
-                            nFlags |= IngnoreDoubleSpace;
+                            nFlags |= IgnoreDoubleSpace;
                     break;//"RemoveDoubleSpaces",
                     case 11:
                         if(*(sal_Bool*)pValues[nProp].getValue())
@@ -303,16 +303,16 @@ void SvxBaseAutoCorrCfg::Commit()
                 bVal = 0 != (nFlags & ChgOrdinalNumber);
                 pValues[nProp].setValue(&bVal, rType);
             break;//"ChangeOrdinalNumber",
-            case  8:
-                bVal = 0 != (nFlags & ChgFractionSymbol);
+            case 8:
+                bVal = 0 != (nFlags & AddNonBrkSpace);
                 pValues[nProp].setValue(&bVal, rType);
-            break;//"ChangeFraction",
+            break;//"AddNonBreakingSpace"
             case  9:
                 bVal = 0 != (nFlags & ChgToEnEmDash);
                 pValues[nProp].setValue(&bVal, rType);
             break;//"ChangeDash",
             case 10:
-                bVal = 0 != (nFlags & IngnoreDoubleSpace);
+                bVal = 0 != (nFlags & IgnoreDoubleSpace);
                 pValues[nProp].setValue(&bVal, rType);
             break;//"RemoveDoubleSpaces",
             case 11:
@@ -368,7 +368,7 @@ Sequence<OUString> 	SvxSwAutoCorrCfg::GetPropertyNames()
         "Format/Option/ChangeUnderlineWeight",                          // 8
         "Format/Option/SetInetAttribute",                               // 9
         "Format/Option/ChangeOrdinalNumber",                            //10
-        "Format/Option/ChangeFraction",                                 //11
+        "Format/Option/AddNonBreakingSpace",                            //11
         "Format/Option/ChangeDash",                                     //12
         "Format/Option/DelEmptyParagraphs",                             //13
         "Format/Option/ReplaceUserStyle",                               //14
@@ -378,35 +378,34 @@ Sequence<OUString> 	SvxSwAutoCorrCfg::GetPropertyNames()
         "Format/Option/ChangeToBullets/SpecialCharacter/FontFamily",    //18  
         "Format/Option/ChangeToBullets/SpecialCharacter/FontCharset",   //19
         "Format/Option/ChangeToBullets/SpecialCharacter/FontPitch",     //20
-        "Format/Option/ReplaceQuote",                                   //21
-        "Format/Option/CombineParagraphs",                              //22
-        "Format/Option/CombineValue",                                   //23
-        "Format/Option/DelSpacesAtStartEnd",                            //24
-        "Format/Option/DelSpacesBetween",                               //25
-        "Format/ByInput/Enable",                                        //26
-        "Format/ByInput/ChangeDash",                                    //27
-        "Format/ByInput/ApplyNumbering/Enable",                         //28
-        "Format/ByInput/ChangeToBorders",                               //29
-        "Format/ByInput/ChangeToTable",                                 //30
-        "Format/ByInput/ReplaceStyle",                                  //31
-        "Format/ByInput/DelSpacesAtStartEnd",                           //32
-        "Format/ByInput/DelSpacesBetween",                              //33
-        "Completion/Enable",                                            //34
-        "Completion/MinWordLen",                                        //35
-        "Completion/MaxListLen",                                        //36
-        "Completion/CollectWords",                                      //37
-        "Completion/EndlessList",                                       //38
-        "Completion/AppendBlank",                                       //39
-        "Completion/ShowAsTip",                                         //40
-        "Completion/AcceptKey",                                         //41
-        "Completion/KeepList",                                          //42
-        "Format/ByInput/ApplyNumbering/SpecialCharacter/Char",          //43
-        "Format/ByInput/ApplyNumbering/SpecialCharacter/Font",          //44
-        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontFamily",    //45
-        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontCharset",   //46
-        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontPitch",     //47
+        "Format/Option/CombineParagraphs",                              //21
+        "Format/Option/CombineValue",                                   //22
+        "Format/Option/DelSpacesAtStartEnd",                            //23
+        "Format/Option/DelSpacesBetween",                               //24
+        "Format/ByInput/Enable",                                        //25
+        "Format/ByInput/ChangeDash",                                    //26
+        "Format/ByInput/ApplyNumbering/Enable",                         //27
+        "Format/ByInput/ChangeToBorders",                               //28
+        "Format/ByInput/ChangeToTable",                                 //29
+        "Format/ByInput/ReplaceStyle",                                  //30
+        "Format/ByInput/DelSpacesAtStartEnd",                           //31
+        "Format/ByInput/DelSpacesBetween",                              //32
+        "Completion/Enable",                                            //33
+        "Completion/MinWordLen",                                        //34
+        "Completion/MaxListLen",                                        //35
+        "Completion/CollectWords",                                      //36
+        "Completion/EndlessList",                                       //37
+        "Completion/AppendBlank",                                       //38
+        "Completion/ShowAsTip",                                         //39
+        "Completion/AcceptKey",                                         //40
+        "Completion/KeepList",                                          //41
+        "Format/ByInput/ApplyNumbering/SpecialCharacter/Char",          //42
+        "Format/ByInput/ApplyNumbering/SpecialCharacter/Font",          //43
+        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontFamily",    //44
+        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontCharset",   //45
+        "Format/ByInput/ApplyNumbering/SpecialCharacter/FontPitch"      //46
     };
-    const int nCount = 48;
+    const int nCount = 47;
     Sequence<OUString> aNames(nCount);
     OUString* pNames = aNames.getArray();
     for(int i = 0; i < nCount; i++)
@@ -444,7 +443,7 @@ void SvxSwAutoCorrCfg::Load(sal_Bool bInit)
                     case   8: rSwFlags.bChgWeightUnderl = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/ChangeUnderlineWeight",
                     case   9: rSwFlags.bSetINetAttr = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/SetInetAttribute",
                     case  10: rSwFlags.bChgOrdinalNumber = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/ChangeOrdinalNumber",
-                    case  11: rSwFlags.bChgFracionSymbol = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/ChangeFraction",
+                    case  11: rSwFlags.bAddNonBrkSpace = *(sal_Bool*)pValues[nProp].getValue( ); break; // "Format/Option/AddNonBreakingSpace",
 // it doesn't exist here - the common flags are used for that -> LM
 //                  case  12: rSwFlags.bChgToEnEmDash = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/ChangeDash",
                     case  13: rSwFlags.bDelEmptyNode = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/DelEmptyParagraphs",
@@ -481,78 +480,77 @@ void SvxSwAutoCorrCfg::Load(sal_Bool bInit)
                         rSwFlags.aBulletFont.SetPitch(FontPitch(nVal));
                     }
                     break; // "Format/Option/ChangeToBullets/SpecialCharacter/FontPitch",
-                    case  21: rSwFlags.bReplaceQuote = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/ReplaceQuote",
-                    case  22: rSwFlags.bRightMargin = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/CombineParagraphs",
-                    case  23:
+                    case  21: rSwFlags.bRightMargin = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/CombineParagraphs",
+                    case  22:
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.nRightMargin =
                             sal::static_int_cast< BYTE >(nVal);
                     }
                     break; // "Format/Option/CombineValue",
-                    case  24: rSwFlags.bAFmtDelSpacesAtSttEnd =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/DelSpacesAtStartEnd",
-                    case  25: rSwFlags.bAFmtDelSpacesBetweenLines = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/DelSpacesBetween",
-                    case  26: rParent.bAutoFmtByInput = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/Enable",
-                    case  27: rSwFlags.bChgToEnEmDash = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeDash",
-                    case  28: rSwFlags.bSetNumRule = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ApplyNumbering/Enable",
-                    case  29: rSwFlags.bSetBorder = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeToBorders",
-                    case  30: rSwFlags.bCreateTable = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeToTable",
-                    case  31: rSwFlags.bReplaceStyles =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ReplaceStyle",
-                    case  32: rSwFlags.bAFmtByInpDelSpacesAtSttEnd =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/DelSpacesAtStartEnd",
-                    case  33: rSwFlags.bAFmtByInpDelSpacesBetweenLines = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/DelSpacesBetween",
-                    case  34: rSwFlags.bAutoCompleteWords = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/Enable",
-                    case  35:
+                    case  23: rSwFlags.bAFmtDelSpacesAtSttEnd =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/DelSpacesAtStartEnd",
+                    case  24: rSwFlags.bAFmtDelSpacesBetweenLines = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/Option/DelSpacesBetween",
+                    case  25: rParent.bAutoFmtByInput = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/Enable",
+                    case  26: rSwFlags.bChgToEnEmDash = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeDash",
+                    case  27: rSwFlags.bSetNumRule = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ApplyNumbering/Enable",
+                    case  28: rSwFlags.bSetBorder = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeToBorders",
+                    case  29: rSwFlags.bCreateTable = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ChangeToTable",
+                    case  30: rSwFlags.bReplaceStyles =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/ReplaceStyle",
+                    case  31: rSwFlags.bAFmtByInpDelSpacesAtSttEnd =  *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/DelSpacesAtStartEnd",
+                    case  32: rSwFlags.bAFmtByInpDelSpacesBetweenLines = *(sal_Bool*)pValues[nProp].getValue(); break; // "Format/ByInput/DelSpacesBetween",
+                    case  33: rSwFlags.bAutoCompleteWords = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/Enable",
+                    case  34:
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.nAutoCmpltWordLen =
                             sal::static_int_cast< USHORT >(nVal);
                     }
                     break; // "Completion/MinWordLen",
-                    case  36:
+                    case  35:
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.nAutoCmpltListLen =
                             sal::static_int_cast< USHORT >(nVal);
                     }
                     break; // "Completion/MaxListLen",
-                    case  37: rSwFlags.bAutoCmpltCollectWords = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/CollectWords",
-                    case  38: rSwFlags.bAutoCmpltEndless = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/EndlessList",
-                    case  39: rSwFlags.bAutoCmpltAppendBlanc = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/AppendBlank",
-                    case  40: rSwFlags.bAutoCmpltShowAsTip = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/ShowAsTip",
-                    case  41:
+                    case  36: rSwFlags.bAutoCmpltCollectWords = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/CollectWords",
+                    case  37: rSwFlags.bAutoCmpltEndless = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/EndlessList",
+                    case  38: rSwFlags.bAutoCmpltAppendBlanc = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/AppendBlank",
+                    case  39: rSwFlags.bAutoCmpltShowAsTip = *(sal_Bool*)pValues[nProp].getValue(); break; // "Completion/ShowAsTip",
+                    case  40:
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.nAutoCmpltExpandKey =
                             sal::static_int_cast< USHORT >(nVal);
                     }
                     break; // "Completion/AcceptKey"
-                    case 42 :rSwFlags.bAutoCmpltKeepList = *(sal_Bool*)pValues[nProp].getValue(); break;//"Completion/KeepList"
-                    case 43 :
+                    case 41 :rSwFlags.bAutoCmpltKeepList = *(sal_Bool*)pValues[nProp].getValue(); break;//"Completion/KeepList"
+                    case 42 :
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.cByInputBullet =
                             sal::static_int_cast< sal_Unicode >(nVal);
                     }
                     break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/Char",
-                    case 44 :
+                    case 43 :
                     {
                         OUString sTemp; pValues[nProp] >>= sTemp;
                         rSwFlags.aByInputBulletFont.SetName(sTemp);
                     }
                     break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/Font",
-                    case 45 :
+                    case 44 :
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.aByInputBulletFont.SetFamily(FontFamily(nVal));
                     }
                     break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/FontFamily",
-                    case 46 :
+                    case 45 :
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.aByInputBulletFont.SetCharSet(CharSet(nVal));
                     }
                     break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/FontCharset",
-                    case 47 :
+                    case 46 :
                     {
                         sal_Int32 nVal = 0; pValues[nProp] >>= nVal;
                         rSwFlags.aByInputBulletFont.SetPitch(FontPitch(nVal));
@@ -605,7 +603,7 @@ void SvxSwAutoCorrCfg::Commit()
             case   8: bVal = rSwFlags.bChgWeightUnderl; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/ChangeUnderlineWeight",
             case   9: bVal = rSwFlags.bSetINetAttr; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/SetInetAttribute",
             case  10: bVal = rSwFlags.bChgOrdinalNumber; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/ChangeOrdinalNumber",
-            case  11: bVal = rSwFlags.bChgFracionSymbol; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/ChangeFraction",
+            case  11: bVal = rSwFlags.bAddNonBrkSpace;  pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/AddNonBreakingSpace",
 // it doesn't exist here - the common flags are used for that -> LM
             case  12:
                 bVal = sal_True;  pValues[nProp].setValue(&bVal, rType);
@@ -628,49 +626,48 @@ void SvxSwAutoCorrCfg::Commit()
             case  20:
                 pValues[nProp] <<= (sal_Int32)rSwFlags.aBulletFont.GetPitch();
             break; // "Format/Option/ChangeToBullets/SpecialCharacter/FontPitch",
-            case  21: bVal = rSwFlags.bReplaceQuote; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/ReplaceQuote",
-            case  22: bVal = rSwFlags.bRightMargin; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/CombineParagraphs",
-            case  23:
+            case  21: bVal = rSwFlags.bRightMargin; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/CombineParagraphs",
+            case  22:
                 pValues[nProp] <<= (sal_Int32)rSwFlags.nRightMargin;
             break; // "Format/Option/CombineValue",
-            case  24: bVal = rSwFlags.bAFmtDelSpacesAtSttEnd; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/DelSpacesAtStartEnd",
-            case  25: bVal = rSwFlags.bAFmtDelSpacesBetweenLines; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/DelSpacesBetween",
-            case  26: bVal = rParent.bAutoFmtByInput; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/Enable",
-            case  27: bVal = rSwFlags.bChgToEnEmDash; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeDash",
-            case  28: bVal = rSwFlags.bSetNumRule; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ApplyNumbering/Enable",
-            case  29: bVal = rSwFlags.bSetBorder; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeToBorders",
-            case  30: bVal = rSwFlags.bCreateTable; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeToTable",
-            case  31: bVal = rSwFlags.bReplaceStyles; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ReplaceStyle",
-            case  32: bVal = rSwFlags.bAFmtByInpDelSpacesAtSttEnd; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/DelSpacesAtStartEnd",
-            case  33: bVal = rSwFlags.bAFmtByInpDelSpacesBetweenLines; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/DelSpacesBetween",
-            case  34: bVal = rSwFlags.bAutoCompleteWords; pValues[nProp].setValue(&bVal, rType); break; // "Completion/Enable",
-            case  35:
+            case  23: bVal = rSwFlags.bAFmtDelSpacesAtSttEnd; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/DelSpacesAtStartEnd",
+            case  24: bVal = rSwFlags.bAFmtDelSpacesBetweenLines; pValues[nProp].setValue(&bVal, rType); break; // "Format/Option/DelSpacesBetween",
+            case  25: bVal = rParent.bAutoFmtByInput; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/Enable",
+            case  26: bVal = rSwFlags.bChgToEnEmDash; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeDash",
+            case  27: bVal = rSwFlags.bSetNumRule; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ApplyNumbering/Enable",
+            case  28: bVal = rSwFlags.bSetBorder; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeToBorders",
+            case  29: bVal = rSwFlags.bCreateTable; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ChangeToTable",
+            case  30: bVal = rSwFlags.bReplaceStyles; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/ReplaceStyle",
+            case  31: bVal = rSwFlags.bAFmtByInpDelSpacesAtSttEnd; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/DelSpacesAtStartEnd",
+            case  32: bVal = rSwFlags.bAFmtByInpDelSpacesBetweenLines; pValues[nProp].setValue(&bVal, rType); break; // "Format/ByInput/DelSpacesBetween",
+            case  33: bVal = rSwFlags.bAutoCompleteWords; pValues[nProp].setValue(&bVal, rType); break; // "Completion/Enable",
+            case  34:
                 pValues[nProp] <<= (sal_Int32)rSwFlags.nAutoCmpltWordLen;
             break; // "Completion/MinWordLen",
-            case  36:
+            case  35:
                 pValues[nProp] <<= (sal_Int32)rSwFlags.nAutoCmpltListLen;
             break; // "Completion/MaxListLen",
-            case  37: bVal = rSwFlags.bAutoCmpltCollectWords; pValues[nProp].setValue(&bVal, rType); break; // "Completion/CollectWords",
-            case  38: bVal = rSwFlags.bAutoCmpltEndless; pValues[nProp].setValue(&bVal, rType); break; // "Completion/EndlessList",
-            case  39: bVal = rSwFlags.bAutoCmpltAppendBlanc; pValues[nProp].setValue(&bVal, rType); break; // "Completion/AppendBlank",
-            case  40: bVal = rSwFlags.bAutoCmpltShowAsTip; pValues[nProp].setValue(&bVal, rType); break; // "Completion/ShowAsTip",
-            case  41:
+            case  36: bVal = rSwFlags.bAutoCmpltCollectWords; pValues[nProp].setValue(&bVal, rType); break; // "Completion/CollectWords",
+            case  37: bVal = rSwFlags.bAutoCmpltEndless; pValues[nProp].setValue(&bVal, rType); break; // "Completion/EndlessList",
+            case  38: bVal = rSwFlags.bAutoCmpltAppendBlanc; pValues[nProp].setValue(&bVal, rType); break; // "Completion/AppendBlank",
+            case  39: bVal = rSwFlags.bAutoCmpltShowAsTip; pValues[nProp].setValue(&bVal, rType); break; // "Completion/ShowAsTip",
+            case  40:
                 pValues[nProp] <<= (sal_Int32)rSwFlags.nAutoCmpltExpandKey;
             break; // "Completion/AcceptKey"
-            case 42 :bVal = rSwFlags.bAutoCmpltKeepList; pValues[nProp].setValue(&bVal, rType); break;// "Completion/KeepList"
-            case 43 :
+            case 41 :bVal = rSwFlags.bAutoCmpltKeepList; pValues[nProp].setValue(&bVal, rType); break;// "Completion/KeepList"
+            case 42 :
                 pValues[nProp] <<= (sal_Int32)rSwFlags.cByInputBullet;
             break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/Char",
-            case 44 :
+            case 43 :
                 pValues[nProp] <<= OUString(rSwFlags.aByInputBulletFont.GetName());
             break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/Font",
-            case 45 :
+            case 44 :
                 pValues[nProp] <<= (sal_Int32)rSwFlags.aByInputBulletFont.GetFamily();
             break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/FontFamily",
-            case 46 :
+            case 45 :
                 pValues[nProp] <<= (sal_Int32)rSwFlags.aByInputBulletFont.GetCharSet();
             break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/FontCharset",
-            case 47 :
+            case 46 :
                 pValues[nProp] <<= (sal_Int32)rSwFlags.aByInputBulletFont.GetPitch();
             break;// "Format/ByInput/ApplyNumbering/SpecialCharacter/FontPitch",
         }
diff --git a/svx/source/editeng/editeng.cxx b/svx/source/editeng/editeng.cxx
index 9ac3067..337d1ee 100644
--- a/svx/source/editeng/editeng.cxx
+++ b/svx/source/editeng/editeng.cxx
@@ -1143,9 +1143,7 @@ sal_Bool EditEngine::PostKeyEvent( const KeyEvent& rKeyEvent, EditView* pEditVie
                     pEditView->pImpEditView->DrawSelection();
                     // Autokorrektur ?
                     if ( ( pImpEditEngine->GetStatus().DoAutoCorrect() ) &&
-                         (  ( nCharCode == ' ' ) || ( nCharCode == '*' ) ||
-                             ( nCharCode == '\"' ) || ( nCharCode == '\'' ) ||
-                            ( nCharCode == '_' )  ))
+                        SvxAutoCorrect::IsAutoCorrectChar( nCharCode ) )
                     {
                         aCurSel = pImpEditEngine->AutoCorrect(
                             aCurSel, nCharCode, !pEditView->IsInsertMode(), pFrameWin );
diff --git a/svx/source/editeng/svxacorr.cxx b/svx/source/editeng/svxacorr.cxx
index 4f00b1b..13d9268 100644
--- a/svx/source/editeng/svxacorr.cxx
+++ b/svx/source/editeng/svxacorr.cxx
@@ -30,6 +30,7 @@
 
 
 #include <com/sun/star/io/XStream.hpp>
+#include <com/sun/star/lang/Locale.hpp>
 #include <tools/urlobj.hxx>
 #include <tools/table.hxx>
 #include <i18npool/mslangid.hxx>
@@ -95,6 +96,8 @@
 #include <com/sun/star/ucb/NameClash.hpp>
 #include <xmloff/xmltoken.hxx>
 
+#define CHAR_HARDBLANK		((sal_Unicode)0x00A0)
+
 using namespace ::com::sun::star::ucb;
 using namespace ::com::sun::star::uno;
 using namespace ::com::sun::star;
@@ -331,7 +334,13 @@ sal_Bool SvxAutoCorrect::IsAutoCorrectChar( sal_Unicode cChar )
             cChar == ' '  || cChar == '\'' || cChar == '\"' ||
             cChar == '*'  || cChar == '_'  ||
             cChar == '.'  || cChar == ','  || cChar == ';' ||
-            cChar == ':'  || cChar == '?' || cChar == '!';
+            cChar == ':'  || cChar == '?' || cChar == '!' || cChar == '/';
+}
+
+sal_Bool SvxAutoCorrect::NeedsHardspaceAutocorr( sal_Unicode cChar )
+{
+    return cChar == ';' || cChar == ':'  || cChar == '?' || cChar == '!' ||
+        cChar == '/' /*case for the urls exception*/;
 }
 
 /* -----------------19.11.98 10:15-------------------
@@ -342,9 +351,9 @@ long SvxAutoCorrect::GetDefaultFlags()
     long nRet = Autocorrect
                     | CptlSttSntnc
                     | CptlSttWrd
-                    | ChgFractionSymbol
                     | ChgOrdinalNumber
                     | ChgToEnEmDash
+                    | AddNonBrkSpace
                     | ChgWeightUnderl
                     | SetINetAttr
                     | ChgQuotes
@@ -382,9 +391,6 @@ SvxAutoCorrect::SvxAutoCorrect( const String& rShareAutocorrFile,
 {
     nFlags = SvxAutoCorrect::GetDefaultFlags();
 
-    c1Div2 = ByteString::ConvertToUnicode( '\xBD', RTL_TEXTENCODING_MS_1252 );
-    c1Div4 = ByteString::ConvertToUnicode( '\xBC', RTL_TEXTENCODING_MS_1252 );
-    c3Div4 = ByteString::ConvertToUnicode( '\xBE', RTL_TEXTENCODING_MS_1252 );
     cEmDash = ByteString::ConvertToUnicode( '\x97', RTL_TEXTENCODING_MS_1252 );
     cEnDash = ByteString::ConvertToUnicode( '\x96', RTL_TEXTENCODING_MS_1252 );
 }
@@ -402,7 +408,6 @@ SvxAutoCorrect::SvxAutoCorrect( const SvxAutoCorrect& rCpy )
     nFlags( rCpy.nFlags & ~(ChgWordLstLoad|CplSttLstLoad|WrdSttLstLoad)),
     cStartDQuote( rCpy.cStartDQuote ), cEndDQuote( rCpy.cEndDQuote ),
     cStartSQuote( rCpy.cStartSQuote ), cEndSQuote( rCpy.cEndSQuote ),
-    c1Div2( rCpy.c1Div2 ), c1Div4( rCpy.c1Div4 ), c3Div4( rCpy.c3Div4 ),
     cEmDash( rCpy.cEmDash ), cEnDash( rCpy.cEnDash )
 {
 }
@@ -486,40 +491,6 @@ BOOL SvxAutoCorrect::FnCptlSttWrd( SvxAutoCorrDoc& rDoc, const String& rTxt,
 }
 
 
-BOOL SvxAutoCorrect::FnChgFractionSymbol(
-                                SvxAutoCorrDoc& rDoc, const String& rTxt,
-                                xub_StrLen nSttPos, xub_StrLen nEndPos )
-{
-    sal_Unicode cChar = 0;
-
-    for( ; nSttPos < nEndPos; ++nSttPos )
-        if( !lcl_IsInAsciiArr( sImplSttSkipChars, rTxt.GetChar( nSttPos ) ))
-            break;
-    for( ; nSttPos < nEndPos; --nEndPos )
-        if( !lcl_IsInAsciiArr( sImplEndSkipChars, rTxt.GetChar( nEndPos - 1 ) ))
-            break;
-
-    // 1/2, 1/4, ... ersetzen durch das entsprechende Zeichen vom Font
-    if( 3 == nEndPos - nSttPos && '/' == rTxt.GetChar( nSttPos+1 ))
-    {
-        switch( ( rTxt.GetChar( nSttPos )) * 256 + rTxt.GetChar( nEndPos-1 ))
-        {
-        case '1' * 256 + '2':		cChar = c1Div2;		break;
-        case '1' * 256 + '4':		cChar = c1Div4;		break;
-        case '3' * 256 + '4':		cChar = c3Div4;		break;
-        }
-
-        if( cChar )
-        {
-            // also austauschen:
-            rDoc.Delete( nSttPos+1, nEndPos );
-            rDoc.Replace( nSttPos, cChar );
-        }
-    }
-    return 0 != cChar;
-}
-
-
 BOOL SvxAutoCorrect::FnChgOrdinalNumber(
                                 SvxAutoCorrDoc& rDoc, const String& rTxt,
                                 xub_StrLen nSttPos, xub_StrLen nEndPos,
@@ -691,6 +662,80 @@ BOOL SvxAutoCorrect::FnChgToEnEmDash(
     return bRet;
 }
 
+BOOL SvxAutoCorrect::FnAddNonBrkSpace(
+                                SvxAutoCorrDoc& rDoc, const String& rTxt,
+                                xub_StrLen, xub_StrLen nEndPos,
+                                LanguageType eLang )
+{
+    bool bRet = false;
+
+    CharClass& rCC = GetCharClass( eLang );
+    const lang::Locale rLocale = rCC.getLocale( );
+
+    if ( rLocale.Language == OUString::createFromAscii( "fr" ) )
+    {
+        bool bFrCA = rLocale.Country == OUString::createFromAscii( "CA" );
+        OUString allChars = OUString::createFromAscii( ":;!?" );
+        OUString chars( allChars );
+        if ( bFrCA )
+            chars = OUString::createFromAscii( ":" );
+
+        sal_Unicode cChar = rTxt.GetChar( nEndPos );
+        bool bHasSpace = chars.indexOf( sal_Unicode( cChar ) ) != -1;
+        bool bIsSpecial = allChars.indexOf( sal_Unicode( cChar ) ) != -1;
+        if ( bIsSpecial )
+        {
+            // Get the last word delimiter position
+            xub_StrLen nSttWdPos = nEndPos;
+            while( nSttWdPos && !IsWordDelim( rTxt.GetChar( --nSttWdPos )))
+                ;
+
+            // Check the presence of "://" in the word
+            xub_StrLen nStrPos = rTxt.Search( String::CreateFromAscii( "://" ), nSttWdPos + 1 );
+            if ( STRING_NOTFOUND == nStrPos )
+            {
+                // Check the previous char
+                sal_Unicode cPrevChar = rTxt.GetChar( nEndPos - 1 );
+                if ( ( chars.indexOf( sal_Unicode( cPrevChar ) ) == -1 ) && cPrevChar != '\t' )
+                {
+                    // Remove any previous normal space
+                    xub_StrLen nPos = nEndPos - 1;
+                    while ( cPrevChar == ' ' || cPrevChar == CHAR_HARDBLANK )
+                    {
+                        if ( nPos == 0 ) break;
+                        nPos--;
+                        cPrevChar = rTxt.GetChar( nPos );
+                    }
+
+                    if ( nPos != 0 )
+                    {
+                        nPos++;
+                        if ( nEndPos - nPos > 0 )
+                            rDoc.Delete( nPos, nEndPos );
+
+                        // Add the non-breaking space at the end pos
+                        if ( bHasSpace )
+                            rDoc.Insert( nPos, CHAR_HARDBLANK );
+                        bRet = true;
+                    }
+                }
+            }
+        }
+        else if ( cChar == '/' )
+        {
+            // Remove the hardspace right before to avoid formatting URLs
+            sal_Unicode cPrevChar = rTxt.GetChar( nEndPos - 1 );
+            sal_Unicode cMaybeSpaceChar = rTxt.GetChar( nEndPos - 2 );
+            if ( cPrevChar == ':' && cMaybeSpaceChar == CHAR_HARDBLANK )
+            {
+                rDoc.Delete( nEndPos - 2, nEndPos - 1 );
+                bRet = true;
+            }
+        }
+    }
+
+    return bRet;
+}
 
 BOOL SvxAutoCorrect::FnSetINetAttr( SvxAutoCorrDoc& rDoc, const String& rTxt,
                                     xub_StrLen nSttPos, xub_StrLen nEndPos,
@@ -1215,10 +1260,10 @@ ULONG SvxAutoCorrect::AutoCorrect( SvxAutoCorrDoc& rDoc, const String& rTxt,
         {
             //JP 10.02.97: doppelte Spaces verhindern
             if( nInsPos && ' ' == cChar &&
-                IsAutoCorrFlag( IngnoreDoubleSpace ) &&
+                IsAutoCorrFlag( IgnoreDoubleSpace ) &&
                 ' ' == rTxt.GetChar( nInsPos - 1 ) )
             {
-                nRet = IngnoreDoubleSpace;
+                nRet = IgnoreDoubleSpace;
                 break;
             }
 
@@ -1246,6 +1291,13 @@ ULONG SvxAutoCorrect::AutoCorrect( SvxAutoCorrDoc& rDoc, const String& rTxt,
                 rDoc.Insert( nInsPos, cChar );
             else
                 rDoc.Replace( nInsPos, cChar );
+
+            // Hardspaces autocorrection
+            if ( NeedsHardspaceAutocorr( cChar ) && IsAutoCorrFlag( AddNonBrkSpace ) &&
+                FnAddNonBrkSpace( rDoc, rTxt, 0, nInsPos, rDoc.GetLanguage( nInsPos, FALSE ) ) )
+            {
+                nRet = AddNonBrkSpace;
+            }
         }
 
         if( !nInsPos )
@@ -1340,9 +1392,7 @@ ULONG SvxAutoCorrect::AutoCorrect( SvxAutoCorrDoc& rDoc, const String& rTxt,
             }
         }
 
-        if( ( IsAutoCorrFlag( nRet = ChgFractionSymbol ) &&
-                FnChgFractionSymbol( rDoc, rTxt, nCapLttrPos, nInsPos ) ) ||
-            ( IsAutoCorrFlag( nRet = ChgOrdinalNumber ) &&
+        if( ( IsAutoCorrFlag( nRet = ChgOrdinalNumber ) &&
                 FnChgOrdinalNumber( rDoc, rTxt, nCapLttrPos, nInsPos, eLang ) ) ||
             ( IsAutoCorrFlag( nRet = SetINetAttr ) &&
                 ( ' ' == cChar || '\t' == cChar || 0x0a == cChar || !cChar ) &&
@@ -1402,9 +1452,9 @@ ULONG SvxAutoCorrect::AutoCorrect( SvxAutoCorrDoc& rDoc, const String& rTxt,
                  if( nRet & ChgQuotes) 			nHelpId = 16;
             else if( nRet & ChgSglQuotes) 		nHelpId = 17;
             else if( nRet & SetINetAttr) 		nHelpId = 18;
-            else if( nRet & IngnoreDoubleSpace) nHelpId = 19;
+            else if( nRet & IgnoreDoubleSpace)  nHelpId = 19;
             else if( nRet & ChgWeightUnderl) 	nHelpId = 20;
-            else if( nRet & ChgFractionSymbol ) nHelpId = 21;
+            else if( nRet & AddNonBrkSpace)     nHelpId = 21;
             else if( nRet & ChgOrdinalNumber)	nHelpId = 22;
         }
 
diff --git a/svx/source/editeng/swafopt.cxx b/svx/source/editeng/swafopt.cxx
index 0a5ae16..c6956c2 100644
--- a/svx/source/editeng/swafopt.cxx
+++ b/svx/source/editeng/swafopt.cxx
@@ -41,14 +41,13 @@ SvxSwAutoFmtFlags::SvxSwAutoFmtFlags()
                         RTL_CONSTASCII_STRINGPARAM( "StarSymbol" )),
                     Size( 0, 14 ) )
 {
-    bReplaceQuote =
     bAutoCorrect =
     bCptlSttSntnc =
     bCptlSttWrd =
     bChkFontAttr =
     bChgUserColl =
     bChgEnumNum =
-    bChgFracionSymbol =
+    bAddNonBrkSpace =
     bChgOrdinalNumber =
     bChgToEnEmDash =
     bChgWeightUnderl =
@@ -101,7 +100,6 @@ SvxSwAutoFmtFlags::SvxSwAutoFmtFlags()
 SvxSwAutoFmtFlags& SvxSwAutoFmtFlags::operator=( const SvxSwAutoFmtFlags& rAFFlags )
 {
     bAutoCorrect = rAFFlags.bAutoCorrect;
-    bReplaceQuote = rAFFlags.bReplaceQuote;
     bCptlSttSntnc = rAFFlags.bCptlSttSntnc;
     bCptlSttWrd = rAFFlags.bCptlSttWrd;
     bChkFontAttr = rAFFlags.bChkFontAttr;
@@ -112,7 +110,7 @@ SvxSwAutoFmtFlags& SvxSwAutoFmtFlags::operator=( const SvxSwAutoFmtFlags& rAFFla
     bSetNumRule = rAFFlags.bSetNumRule;
     bAFmtByInput = rAFFlags.bAFmtByInput;
 
-    bChgFracionSymbol = rAFFlags.bChgFracionSymbol;
+    bAddNonBrkSpace = rAFFlags.bAddNonBrkSpace;
     bChgOrdinalNumber = rAFFlags.bChgOrdinalNumber;
     bChgToEnEmDash = rAFFlags.bChgToEnEmDash;
     bChgWeightUnderl = rAFFlags.bChgWeightUnderl;
diff --git a/svx/util/hidother.src b/svx/util/hidother.src
index 7c60a51..5509b7c 100644
--- a/svx/util/hidother.src
+++ b/svx/util/hidother.src
@@ -130,7 +130,7 @@ hidspecial HID_HYPERDLG_DOC_PATH			{ HelpID = HID_HYPERDLG_DOC_PATH ;};
 #define HID_AUTOCORR_HELP_SETINETATTR			HID_AUTOCORR_HELP_START+17
 #define HID_AUTOCORR_HELP_INGNOREDOUBLESPACE	HID_AUTOCORR_HELP_START+18
 #define HID_AUTOCORR_HELP_CHGWEIGHTUNDERL		HID_AUTOCORR_HELP_START+19
-#define HID_AUTOCORR_HELP_CHGFRACTIONSYMBOL  	HID_AUTOCORR_HELP_START+20
+#define HID_AUTOCORR_HELP_CHGNONBRKSPACE      	HID_AUTOCORR_HELP_START+20
 #define HID_AUTOCORR_HELP_CHGORDINALNUMBER		HID_AUTOCORR_HELP_START+21
 
 hidspecial HID_AUTOCORR_HELP_WORD			{ HelpID =  HID_AUTOCORR_HELP_WORD;};
@@ -153,7 +153,7 @@ hidspecial HID_AUTOCORR_HELP_CHGSGLQUOTES		{ HelpID =  HID_AUTOCORR_HELP_CHGSGLQ
 hidspecial HID_AUTOCORR_HELP_SETINETATTR		{ HelpID =  HID_AUTOCORR_HELP_SETINETATTR;};
 hidspecial HID_AUTOCORR_HELP_INGNOREDOUBLESPACE	{ HelpID =  HID_AUTOCORR_HELP_INGNOREDOUBLESPACE;};
 hidspecial HID_AUTOCORR_HELP_CHGWEIGHTUNDERL	{ HelpID =  HID_AUTOCORR_HELP_CHGWEIGHTUNDERL;};
-hidspecial HID_AUTOCORR_HELP_CHGFRACTIONSYMBOL  { HelpID =  HID_AUTOCORR_HELP_CHGFRACTIONSYMBOL;};
+hidspecial HID_AUTOCORR_HELP_CHGNONBRKSPACE     { HelpID =  HID_AUTOCORR_HELP_CHGNONBRKSPACE;};
 hidspecial HID_AUTOCORR_HELP_CHGORDINALNUMBER	{ HelpID =  HID_AUTOCORR_HELP_CHGORDINALNUMBER;};
 
 hidspecial HID_CLB_EDIT_MODULES_DICS			{ HelpID =  HID_CLB_EDIT_MODULES_DICS	    ;};
@@ -335,6 +335,8 @@ hidspecial HID_OFADLG_TREE_DRAWING        			{ HelpId = HID_OFADLG_TREE_DRAWING
 hidspecial HID_OFADLG_TREE_IMAGE          			{ HelpId = HID_OFADLG_TREE_IMAGE				; };
 hidspecial HID_OFADLG_TREE_FORMULA        			{ HelpId = HID_OFADLG_TREE_FORMULA				; };
 hidspecial HID_OFAPAGE_MSFLTR2_CLB                   { HelpId = HID_OFAPAGE_MSFLTR2_CLB             ; };
+hidspecial HID_OFAPAGE_QUOTE_CLB                    { HelpId = HID_OFAPAGE_QUOTE_CLB; };
+hidspecial HID_OFAPAGE_QUOTE_SW_CLB                 { HelpId = HID_OFAPAGE_QUOTE_SW_CLB; };
 
 hidspecial UID_OFA_CONNPOOL_DRIVERLIST_BACK			{ HelpId = UID_OFA_CONNPOOL_DRIVERLIST_BACK; };
 hidspecial HID_OFA_CONNPOOL_DRIVERLIST				{ HelpId = HID_OFA_CONNPOOL_DRIVERLIST; };
diff --git a/sw/inc/comcore.hrc b/sw/inc/comcore.hrc
index c94aeec..0e715c7 100644
--- a/sw/inc/comcore.hrc
+++ b/sw/inc/comcore.hrc
@@ -112,8 +112,9 @@
 #define STR_AUTOFMTREDL_SET_TMPL_HEADLINE		18
 #define STR_AUTOFMTREDL_SET_NUMBULET			19
 #define STR_AUTOFMTREDL_DEL_MORELINES			20
+#define STR_AUTOFMTREDL_NON_BREAK_SPACE         21
 // !!!!!!!!!!!!!!!!!!!!!!!!!!  das Ende immer richtig setzen !!!!!!!!!!!!
-#define STR_AUTOFMTREDL_END						21
+#define STR_AUTOFMTREDL_END						22
 
 
 #endif
diff --git a/sw/source/core/edit/autofmt.cxx b/sw/source/core/edit/autofmt.cxx
index 59ea756..24d4400 100644
--- a/sw/source/core/edit/autofmt.cxx
+++ b/sw/source/core/edit/autofmt.cxx
@@ -313,6 +313,7 @@ void SwAutoFormat::_SetRedlineTxt( USHORT nActionId )
         case STR_AUTOFMTREDL_FRACTION:
         case STR_AUTOFMTREDL_DASH:
         case STR_AUTOFMTREDL_ORDINAL:
+        case STR_AUTOFMTREDL_NON_BREAK_SPACE:
             nSeqNo = ++nRedlAutoFmtSeqId;
             break;
         }
@@ -1888,12 +1889,17 @@ void SwAutoFormat::BuildHeadLine( USHORT nLvl )
         // dann lasse doch mal das AutoCorrect auf den akt. TextNode los
 void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
 {
+    SvxAutoCorrect* pATst = SvxAutoCorrCfg::Get()->GetAutoCorrect();
+    long aSvxFlags = pATst->GetFlags( );
+    bool bReplaceQuote = ( aSvxFlags & ChgQuotes ) > 0;
+    bool bReplaceSglQuote = ( aSvxFlags & ChgSglQuotes ) > 0;
+
     if( aFlags.bAFmtByInput ||
-        (!aFlags.bAutoCorrect && !aFlags.bReplaceQuote &&
+        (!aFlags.bAutoCorrect && !bReplaceQuote && !bReplaceSglQuote &&
         !aFlags.bCptlSttSntnc && !aFlags.bCptlSttWrd &&
-        !aFlags.bChgFracionSymbol && !aFlags.bChgOrdinalNumber &&
+        !aFlags.bChgOrdinalNumber &&
         !aFlags.bChgToEnEmDash && !aFlags.bSetINetAttr &&
-        !aFlags.bChgWeightUnderl) )
+        !aFlags.bChgWeightUnderl && !aFlags.bAddNonBrkSpace) )
         return;
 
     const String* pTxt = &pAktTxtNd->GetTxt();
@@ -1902,7 +1908,8 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
 
     BOOL bGetLanguage = aFlags.bChgOrdinalNumber ||
                         aFlags.bChgToEnEmDash || aFlags.bSetINetAttr ||
-                        aFlags.bCptlSttWrd || aFlags.bCptlSttSntnc;
+                        aFlags.bCptlSttWrd || aFlags.bCptlSttSntnc ||
+                        aFlags.bAddNonBrkSpace;
 
 
     aDelPam.DeleteMark();
@@ -1910,7 +1917,6 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
     aDelPam.GetPoint()->nContent.Assign( pAktTxtNd, 0 );
 
     SwAutoCorrDoc aACorrDoc( *pEditShell, aDelPam );
-    SvxAutoCorrect* pATst = SvxAutoCorrCfg::Get()->GetAutoCorrect();
 
     SwTxtFrmInfo aFInfo( 0 );
 
@@ -1926,8 +1932,8 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
         if( nPos == pTxt->Len() )
             break;		// das wars
 
-        if( aFlags.bReplaceQuote &&
-            ( '\"' == cChar || '\'' == cChar ) &&
+        if( ( ( bReplaceQuote && '\"' == cChar ) ||
+              ( bReplaceSglQuote && '\'' == cChar ) ) &&
             ( !nPos || ' ' == pTxt->GetChar( nPos-1 ) ) )
         {
             // --------------------------------------
@@ -1980,7 +1986,7 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
             {
             case '\"':
             case '\'':
-                if( aFlags.bReplaceQuote )
+                if( ( cChar == '\"' && bReplaceQuote ) || ( cChar == '\'' && bReplaceSglQuote ) )
                 {
                     // --------------------------------------
                     // beachte: Sonderfall Symbolfonts !!!
@@ -2065,6 +2071,18 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
                     }
                 }
                 break;
+            case '/':
+                if ( aFlags.bAddNonBrkSpace )
+                {
+                    LanguageType eLang = (bGetLanguage && pAktTxtNd)
+                                           ? pAktTxtNd->GetLang( nSttPos )
+                                           : LANGUAGE_SYSTEM;
+
+                    SetRedlineTxt( STR_AUTOFMTREDL_NON_BREAK_SPACE );
+                    if ( pATst->FnAddNonBrkSpace( aACorrDoc, *pTxt, nSttPos, nPos, eLang ) )
+                        --nPos;
+                }
+                break;
 
             case '.':
             case '!':
@@ -2073,7 +2091,6 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
                     bFirstSent = TRUE;
 //alle Wortrenner loesen die Autokorrektur aus!
 //				break;
-
             default:
 //alle Wortrenner loesen die Autokorrektur aus!
 //			case ' ':
@@ -2122,10 +2139,13 @@ void SwAutoFormat::AutoCorrect( xub_StrLen nPos )
                                            ? pAktTxtNd->GetLang( nSttPos )
                                            : LANGUAGE_SYSTEM;
 
-            if( ( aFlags.bChgFracionSymbol &&
-                    SetRedlineTxt( STR_AUTOFMTREDL_FRACTION ) &&
-                    pATst->FnChgFractionSymbol( aACorrDoc, *pTxt, nSttPos, nPos ) ) ||
-                ( aFlags.bChgOrdinalNumber &&
+            if ( aFlags.bAddNonBrkSpace )
+            {
+                SetRedlineTxt( STR_AUTOFMTREDL_NON_BREAK_SPACE );
+                pATst->FnAddNonBrkSpace( aACorrDoc, *pTxt, nSttPos, nPos, eLang );
+            }
+
+            if( ( aFlags.bChgOrdinalNumber &&
                     SetRedlineTxt( STR_AUTOFMTREDL_ORDINAL ) &&
                     pATst->FnChgOrdinalNumber( aACorrDoc, *pTxt, nSttPos, nPos, eLang ) ) ||
                 ( aFlags.bChgToEnEmDash &&
diff --git a/sw/source/ui/docvw/edtwin.cxx b/sw/source/ui/docvw/edtwin.cxx
index 72805d7..1cd6e6a 100644
--- a/sw/source/ui/docvw/edtwin.cxx
+++ b/sw/source/ui/docvw/edtwin.cxx
@@ -2282,7 +2282,7 @@ KEYINPUT_CHECKTABLE_INSDEL:
                 else if( !aKeyEvent.GetRepeat() && pACorr && bIsAutoCorrectChar &&
                         pACfg->IsAutoFmtByInput() &&
                     pACorr->IsAutoCorrFlag( CptlSttSntnc | CptlSttWrd |
-                                            ChgFractionSymbol | ChgOrdinalNumber |
+                                            ChgOrdinalNumber |
                                             ChgToEnEmDash | SetINetAttr |
                                             Autocorrect ) &&
                     '\"' != aCh && '\'' != aCh && '*' != aCh && '_' != aCh &&
@@ -2314,7 +2314,7 @@ KEYINPUT_CHECKTABLE_INSDEL:
         {
             if( pACorr && pACfg->IsAutoFmtByInput() &&
                 pACorr->IsAutoCorrFlag( CptlSttSntnc | CptlSttWrd |
-                                        ChgFractionSymbol | ChgOrdinalNumber |
+                                        ChgOrdinalNumber |
                                         ChgToEnEmDash | SetINetAttr |
                                         Autocorrect ) &&
                 !rSh.HasReadonlySel() )
diff --git a/sw/source/ui/shells/textsh.cxx b/sw/source/ui/shells/textsh.cxx
index 0d2540f..300c6ed 100644
--- a/sw/source/ui/shells/textsh.cxx
+++ b/sw/source/ui/shells/textsh.cxx
@@ -199,7 +199,7 @@ void SwTextShell::ExecInsert(SfxRequest &rReq)
             SvxAutoCorrect* pACorr = pACfg->GetAutoCorrect();
             if( pACorr && pACfg->IsAutoFmtByInput() &&
                     pACorr->IsAutoCorrFlag( CptlSttSntnc | CptlSttWrd |
-                                ChgFractionSymbol | ChgOrdinalNumber |
+                                AddNonBrkSpace | ChgOrdinalNumber |
                                 ChgToEnEmDash | SetINetAttr | Autocorrect ))
                 rSh.AutoCorrect( *pACorr, cIns );
             else
diff --git a/sw/source/ui/utlui/utlui.src b/sw/source/ui/utlui/utlui.src
index 0351aa6..e410011 100644
--- a/sw/source/ui/utlui/utlui.src
+++ b/sw/source/ui/utlui/utlui.src
@@ -119,6 +119,10 @@ Resource RID_SHELLRES_AUTOFMTSTRS
     {
         Text [ en-US ] = "Combine paragraphs";
     };
+    String STR_AUTOFMTREDL_NON_BREAK_SPACE +1
+    {
+        Text [ en-US ] = "Add non breaking space";
+    };
 
 };
 
diff --git a/sw/source/ui/wrtsh/wrtsh1.cxx b/sw/source/ui/wrtsh/wrtsh1.cxx
index 370fd49..8d251c0 100644
--- a/sw/source/ui/wrtsh/wrtsh1.cxx
+++ b/sw/source/ui/wrtsh/wrtsh1.cxx
@@ -157,7 +157,7 @@ SvxAutoCorrect* lcl_IsAutoCorr()
 {
        SvxAutoCorrect* pACorr = SvxAutoCorrCfg::Get()->GetAutoCorrect();
     if( pACorr && !pACorr->IsAutoCorrFlag( CptlSttSntnc | CptlSttWrd |
-                            ChgFractionSymbol | ChgOrdinalNumber |
+                            AddNonBrkSpace | ChgOrdinalNumber |
                             ChgToEnEmDash | SetINetAttr | Autocorrect ))
         pACorr = 0;
     return pACorr;
-- 
1.7.0.1

