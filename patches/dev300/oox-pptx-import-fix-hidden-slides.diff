From cd9e2ebe89d4fabb4ce22ddb71f03a493c4ea67d Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:00:53 +0200
Subject: [PATCH 430/878] oox-pptx-import-fix-hidden-slides.diff

---
 oox/source/ppt/slidefragmenthandler.cxx |   13 +++++++++++++
 oox/source/token/properties.txt         |    1 +
 2 files changed, 14 insertions(+), 0 deletions(-)

diff --git a/oox/source/ppt/slidefragmenthandler.cxx b/oox/source/ppt/slidefragmenthandler.cxx
index 59cb4c9..0a8f72b 100644
--- a/oox/source/ppt/slidefragmenthandler.cxx
+++ b/oox/source/ppt/slidefragmenthandler.cxx
@@ -32,6 +32,7 @@
 #include <com/sun/star/container/XNamed.hpp>
 
 #include "tokens.hxx"
+#include "properties.hxx"
 #include "oox/helper/propertyset.hxx"
 #include "oox/core/namespaces.hxx"
 #include "oox/core/xmlfilterbase.hxx"
@@ -86,6 +87,18 @@ Reference< XFastContextHandler > SlideFragmentHandler::createFastChildContext( s
     case NMSP_PPT|XML_sldMaster:		// CT_SlideMaster
     case NMSP_PPT|XML_handoutMaster:	// CT_HandoutMaster
     case NMSP_PPT|XML_sld:				// CT_CommonSlideData
+    {
+        AttributeList attribs( xAttribs );
+
+        Reference< XDrawPage > xSlide( mpSlidePersistPtr->getPage() );
+        PropertyMap aPropMap;
+        PropertySet aSlideProp( xSlide );
+
+        aPropMap[ PROP_Visible ] = Any( attribs.getBool( XML_show, sal_True ) );
+        aSlideProp.setProperties( aPropMap );
+
+        break;
+    }
     case NMSP_PPT|XML_notes:			// CT_NotesSlide
     case NMSP_PPT|XML_notesMaster:		// CT_NotesMaster
         break;
diff --git a/oox/source/token/properties.txt b/oox/source/token/properties.txt
index f9966bf..63f53a7 100644
--- a/oox/source/token/properties.txt
+++ b/oox/source/token/properties.txt
@@ -401,6 +401,7 @@ VertJustify
 VerticalAlign
 VerticalSplitMode
 VerticalSplitPositionTwips
+Visible
 VisibleSize
 VisualArea
 VisualEffect
-- 
1.7.0.1

