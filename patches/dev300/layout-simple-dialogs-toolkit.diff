diff --git a/toolkit/doc/layout/TODO b/toolkit/doc/layout/TODO
index abd717c..35ba8e8 100644
--- toolkit/doc/layout/TODO
+++ toolkit/doc/layout/TODO
@@ -4,6 +4,11 @@
 ** Move everything & development into new layout-dialogs CWS
 
 ** cleanups
+*** Add XRadioButton2 and layout::VCLXRadioButton with
+    {get,set}RadioGroup.  Remove import.cxx RadioGroups::RadioGroup,
+    VCLXRadioButton::getFirstActionListener () and [actionListener
+    juggling in] layout::RadioButton_impl::SetClickHdl() and
+    EnableRadioCheck() layout::RadioButton_impl::Check.
 *** layout/import.hxx: what's this generator stuff?
 #if 0
 // generator
@@ -87,7 +92,6 @@ but keep using yes/no on Windows, eg?
 *** remove -DTEST_LAYOUT=1 from util/makefile.mk?
 
 ** fixes
-*** mpRadioGroup HACK --> use radiogroup property
 *** missing properties
 	'title' -> 'Set Zoom'
 Missing prop Title
@@ -109,6 +113,9 @@ grep zoom.src svx/source/dialog/localize.sdf | awk -F'\t' '{printf "%s\t%s\t%s\t
 grep wordcountdialog.src sw/source/ui/dialog/localize.sdf | awk -F'\t' '{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "janneke\\vc\\layout-cws\\toolkit\\workben\\layout\\workben.xml", $3, "layout", $6 "_label", "", "", $8, "0", $10, $11, $12, "", $14, $15}' | sed -e 's/FL_\([A-Z]*\)_label/FL_\1_text/' -e 's/\t_label/\tDLG_WORDCOUNT_title/'s
 *** sortdlg
 grep sortdlg.src ../../../sc/source/ui/src/localize.sdf | awk -F'\t' '{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "janneke\\vc\\layout-cws\\toolkit\\workben\\layout\\sort-options.xml", $3, "layout", $6 "_label", "", "", $8, "0", $10, $11, $12, "", $14, $15}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\t_label/\tRID_SCDLG_SORT_title/' | grep -E '	(nl|de|en-US)	' > localize-str.sdf
+grep sortdlg.src sc/source/ui/src/localize.sdf | awk -F'\t' '{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "sc\\uiconfig\\layout\\sort-options.xml", $3, "layout", $6 "_label", "", "", $8, "0", $10, $11, $12, "", $14, $15}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\t_label/\tRID_SCDLG_SORT_title/' > sc/uiconfig/layout/localize-sort-options.sdf
+*** insert-sheet
+grep instbdlg.src sc/source/ui/miscdlgs/localize.sdf | awk -F'\t' '{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "sc\\uiconfig\\layout\\insert-sheet.xml", $3, "layout", $6 "_label", "", "", $8, "0", $10, $11, $12, "", $14, $15}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\t_label/\tRID_SCDLG_INSERT_TABLE_title/' > sc/uiconfig/layout/localize-insert-sheet.sdf
 
 
 * i18n
diff --git a/toolkit/inc/layout/layout-post.hxx b/toolkit/inc/layout/layout-post.hxx
index 09f90bf..b8c86cf 100644
--- toolkit/inc/layout/layout-post.hxx
+++ toolkit/inc/layout/layout-post.hxx
@@ -38,6 +38,9 @@
 
 #if ENABLE_LAYOUT
 
+/* Allow re-inclusion for cxx file. */
+#undef _LAYOUT_PRE_HXX
+
 #undef AdvancedButton
 #undef ApplyButton
 #undef Box
@@ -61,6 +64,7 @@
 #undef MetricFormatter
 #undef MoreButton
 #undef MultiLineEdit
+#undef MultiListBox
 #undef NoButton
 #undef NumericField
 #undef NumericFormatter
@@ -77,6 +81,7 @@
 #undef VBox
 #undef YesButton
 
+#undef ScExpandedFixedText
 #undef ModalDialog
 #undef ModelessDialog
 #undef SfxModalDialog
@@ -86,18 +91,6 @@
 
 #undef Window
 
-
-#undef SVX_RES
-#define SVX_RES(i)        ResId(i,DIALOG_MGR())
-
-#undef SvtResId
-
-#undef SW_RES
-#define SW_RES(i)               ResId(i,SWDIALOG_MGR())
-
-/* Allow re-inclusion for cxx file. */
-#undef _LAYOUT_PRE_HXX
-
 #endif /* ENABLE_LAYOUT */
 
 #endif /* _LAYOUT_POST_HXX */
diff --git a/toolkit/inc/layout/layout-pre.hxx b/toolkit/inc/layout/layout-pre.hxx
index 327da0b..3c9cf87 100644
--- toolkit/inc/layout/layout-pre.hxx
+++ toolkit/inc/layout/layout-pre.hxx
@@ -38,15 +38,8 @@
 
 #if ENABLE_LAYOUT
 
-//#if !LAYOUT
-//#define LAYOUT 1
-//#endif
-//#define LAYOUT_NS layout
-
-// TWBN, but find that SfxModalDialog and FixedLine are already defined, eg compiling
-// dlgfact.cxx
-//typedef layout::Dialog SfxModalDialog;
-//typedef layout::FixedLine FixedLine;
+///* Allow re-inclusion for next hxx file. */
+#undef _LAYOUT_POST_HXX
 
 #define AdvancedButton layout::AdvancedButton
 #define ApplyButton layout::ApplyButton
@@ -71,6 +64,7 @@
 #define MetricFormatter layout::MetricFormatter
 #define MoreButton layout::MoreButton
 #define MultiLineEdit layout::MultiLineEdit
+#define MultiListBox layout::MultiListBox
 #define NoButton layout::NoButton
 #define NumericField layout::NumericField
 #define NumericFormatter layout::NumericFormatter
@@ -87,6 +81,7 @@
 #define VBox layout::VBox
 #define YesButton layout::YesButton
 
+#define ScExpandedFixedText FixedText
 #define ModalDialog Dialog
 #define ModelessDialog Dialog
 #define SfxModalDialog Dialog
@@ -99,43 +94,8 @@
 #define LAYOUT_DIALOG_PARENT\
     VCLXWindow::GetImplementation( uno::Reference <awt::XWindow> ( GetPeer(), uno::UNO_QUERY ) )->GetWindow()
 
-#undef SVX_RES
-#define SVX_RES(x) #x
-#undef SvtResId
-#define SvtResId(x) #x
-#undef SW_RES
-#define SW_RES(x) #x
-
-/* Hmm.  These hacks make zoom.cxx, wordcountdialog.cxx, ... diffs
- * smaller but 'tis not really scalable. */
-#ifdef _LAYOUT_POST_HXX
-
-#ifdef _SVX_RECOVER_CXX
-#undef SfxModalDialog
-// 3rd parameter must match ID in <modaldialog> "RID_SVXDLG_RECOVER", localize.sdf
-#define SfxModalDialog( pParent, SVX_RES_RID ) Dialog( pParent, "recover.xml", "RID_SVXDLG_RECOVER" )
-#endif /* _SVX_RECOVER_CXX */
-
-#ifdef SW_WORDCOUNTDIALOG_HXX
-#undef SfxModalDialog
-// 3rd parameter must match ID in <modaldialog> "DLG_WORDCOUNT", localize.sdf
-#define SfxModalDialog( pParent, SW_RES_RID ) Dialog( pParent, "wordcount.xml", "DLG_WORDCOUNT" )
-#define SW_WORDCOUNTDIALOG_HRC
-#endif /* SW_WORDCOUNTDIALOG_HXX */
-
-#ifdef _SVX_ZOOM_CXX
-#undef SfxModalDialog
-// 3rd parameter must match ID in <modaldialog> "RID_SVXDLG_ZOOM", localize.sdf
-#define SfxModalDialog( pParent, SVX_RES_RID ) Dialog( pParent, "zoom.xml", "RID_SVXDLG_ZOOM" )
-#define _SVX_ZOOM_HRC
-#endif /* _SVX_ZOOM_CXX */
-
-#endif /* _LAYOUT_POST_HXX */
-
-#else /* !ENABLE_LAYOUT */
-
-#define LAYOUT_PRE_POST 1
+#define LAYOUT_THIS_WINDOW( this ) this->GetWindow ()
 
-#endif /* !ENABLE_LAYOUT */
+#endif /* ENABLE_LAYOUT */
 
 #endif /* _LAYOUT_PRE_HXX */
diff --git a/toolkit/inc/layout/layout.hxx b/toolkit/inc/layout/layout.hxx
index ff223e7..03ee55a 100644
--- toolkit/inc/layout/layout.hxx
+++ toolkit/inc/layout/layout.hxx
@@ -46,6 +46,7 @@
 
 // FIXME: eventually wrap FieldUnit
 #include <vcl/fldunit.hxx>
+#include <vcl/smartid.hxx>
 // FIXME: eventually wrap this too ...
 #include <vcl/wintypes.hxx>
 
@@ -53,11 +54,14 @@
 
 class Control;
 class Image;
-class SfxPoolItem;
+class MultiListBox;
+class Pointer;
+class RadioButton;
 class SfxItemSet;
+class SfxPoolItem;
+class TabPage;
 class VCLXWindow;
 class Window;
-class TabPage;
 
 namespace com { namespace sun { namespace star { namespace awt { class XWindow; } } } }
 
@@ -92,6 +96,9 @@ public:
 #define DECL_GET_IMPL(t) \
         inline t##Impl &getImpl() const
 
+#define DECL_GET_WINDOW( cls ) ::cls* Get##cls()
+#define IMPL_GET_WINDOW( cls ) ::cls* cls::Get##cls() { return reinterpret_cast< ::cls*>( GetWindow() ); }
+
 // follows the VCL inheritance hierarchy ...
 
 class WindowImpl;
@@ -106,27 +113,35 @@ public:
     explicit Window( WindowImpl *pImpl );
     virtual ~Window();
 
-    PeerHandle GetPeer();
+    PeerHandle GetPeer() const;
     Context *getContext();
 
     void Enable( bool bEnable = true );
     inline void Disable() { Enable( false ); }
-    void Show( BOOL bVisible = TRUE );
-    inline void Hide() { Show( FALSE ); }
+    void Show( bool bVisible = true );
+    inline void Hide() { Show( false ); }
     void GrabFocus();
     void FreeResource() {}
 
     void SetParent( Window *pParent );
     void SetParent( ::Window *pParent );
 
-    css::uno::Reference<css::awt::XWindow> GetRef();
-    VCLXWindow* GetVCLXWindow();
-    ::Window* GetWindow();
-    ::Window* GetParent();
+    css::uno::Reference<css::awt::XWindow> GetRef() const;
+    VCLXWindow* GetVCLXWindow() const;
+    ::Window* GetWindow() const;
+    ::Window* GetParent() const;
 
+    void SetPointer( Pointer const& pointer );
+    Pointer const& GetPointer() const;
     WinBits GetStyle();
-    void SetStyle( WinBits nStyle );
-    void SetUpdateMode( bool /*bUpdate*/ ) { }
+    void SetText( String const& str );
+    String GetText() const;
+    void SetStyle( WinBits style );
+    void SetUpdateMode( bool mode );
+    void SetHelpId( ULONG id );
+    ULONG GetHelpId() const;
+    void SetSmartHelpId( SmartId const&, SmartIdUpdateMode mode=SMART_SET_SMART );
+    SmartId GetSmartHelpId() const;
 };
 
 class ControlImpl;
@@ -189,7 +204,7 @@ class TOOLKIT_DLLPUBLIC Button : public Control
     DECL_CONSTRUCTORS( Button, Control, 0 );
 public:
     void SetText( String const& rStr );
-    BOOL SetModeImage( const Image& rImage );
+    bool SetModeImage( const Image& rImage );
     void SetImageAlign( ImageAlign eAlign );
 
     void SetClickHdl( Link const& rLink );
@@ -202,8 +217,8 @@ class TOOLKIT_DLLPUBLIC PushButton : public Button
     DECL_GET_IMPL( PushButton );
     DECL_CONSTRUCTORS( PushButton, Button, 0 );
 public:
-    void Check( BOOL bCheck = TRUE );
-    BOOL IsChecked() const;
+    void Check( bool bCheck = true );
+    bool IsChecked() const;
 
     void Toggle();
     void SetToggleHdl( Link const& rLink );
@@ -272,9 +287,10 @@ class TOOLKIT_DLLPUBLIC RadioButton : public Button
 {
     DECL_GET_IMPL( RadioButton );
     DECL_CONSTRUCTORS( RadioButton, Button, 0 );
+    DECL_GET_WINDOW( RadioButton );
 public:
-    void Check( BOOL bCheck = TRUE );
-    BOOL IsChecked() const;
+    void Check( bool bCheck = true );
+    bool IsChecked() const;
 
     void Toggle();
     void SetToggleHdl( Link const& rLink );
@@ -286,8 +302,8 @@ class TOOLKIT_DLLPUBLIC CheckBox : public Button
     DECL_GET_IMPL( CheckBox );
     DECL_CONSTRUCTORS( CheckBox, Button, 0 );
 public:
-    void Check( BOOL bCheck = TRUE );
-    BOOL IsChecked() const;
+    void Check( bool bCheck = true );
+    bool IsChecked() const;
 
     void Toggle();
     void SetToggleHdl( Link const& rLink );
@@ -421,8 +437,8 @@ public:
     XubString GetEntry( USHORT nPos ) const;
     USHORT GetEntryCount() const;
 
-    void SelectEntry( XubString const& rStr, BOOL bSelect = TRUE );
-    void SelectEntryPos( USHORT nPos, BOOL bSelect = TRUE );
+    void SelectEntry( XubString const& rStr, bool bSelect = true );
+    void SelectEntryPos( USHORT nPos, bool bSelect = true );
 
     USHORT GetSelectEntryCount() const;
     XubString GetSelectEntry( USHORT nSelIndex = 0 ) const;
@@ -445,6 +461,14 @@ public:
     bool IsLanguageSelected( const LanguageType/*eLangType*/) const { return true; }
 };
 
+class MultiListBoxImpl;
+class TOOLKIT_DLLPUBLIC MultiListBox : public ListBox
+{
+    DECL_GET_IMPL( MultiListBox );
+    DECL_CONSTRUCTORS( MultiListBox, ListBox, 0 );
+    DECL_GET_WINDOW( MultiListBox );
+};
+
 class DialogImpl;
 class TOOLKIT_DLLPUBLIC Dialog : public Context, public Window
 {
@@ -457,8 +481,6 @@ public:
     void SetText( String const& rStr );
 };
 
-#define DECL_GET_WINDOW( cls ) ::cls* Get##cls()
-#define IMPL_GET_WINDOW( cls ) ::cls* cls::Get##cls() { return reinterpret_cast< ::cls*>( GetWindow() ); }
 class TabPageImpl;
 class TOOLKIT_DLLPUBLIC TabPage : public Context, public Window
 {
@@ -469,8 +491,7 @@ public:
     TabPage( Window *pOptParent, char const* pXMLPath, char const* pId, sal_uInt32 nId = 0, SfxItemSet const* set = 0 );
     TabPage( ::Window *pOptParent, char const* pXMLPath, char const* pId, sal_uInt32 nId = 0, SfxItemSet const* set = 0 );
     ~TabPage();
-    //DECL_GET_WINDOW( TabPage );
-    ::TabPage* GetTabPage();
+    DECL_GET_WINDOW( TabPage );
     virtual void ActivatePage();
     virtual void DeactivatePage();
 #if 0
diff --git a/toolkit/inc/toolkit/awt/vclxwindows.hxx b/toolkit/inc/toolkit/awt/vclxwindows.hxx
index 4c250ba..41176fc 100644
--- toolkit/inc/toolkit/awt/vclxwindows.hxx
+++ toolkit/inc/toolkit/awt/vclxwindows.hxx
@@ -346,6 +346,8 @@ public:
 
     static void     ImplGetPropertyIds( std::list< sal_uInt16 > &aIds );
     virtual void    GetPropertyIds( std::list< sal_uInt16 > &aIds ) { return ImplGetPropertyIds( aIds ); }
+
+    ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > getFirstActionListener ();
 };
 
 //	----------------------------------------------------
diff --git a/toolkit/source/awt/vclxdialog.cxx b/toolkit/source/awt/vclxdialog.cxx
index f54996b..f72500c 100644
--- toolkit/source/awt/vclxdialog.cxx
+++ toolkit/source/awt/vclxdialog.cxx
@@ -215,6 +215,15 @@ void VCLXDialog::setTitle( const ::rtl::OUString& Title ) throw(::com::sun::star
         pWindow->SetText( Title );
 }
 
+void VCLXDialog::setHelpId( sal_Int32 id ) throw(::com::sun::star::uno::RuntimeException)
+{
+    ::vos::OGuard aGuard( GetMutex() );
+
+    Window* pWindow = GetWindow();
+    if ( pWindow )
+        pWindow->SetHelpId( id );
+}
+
 ::rtl::OUString VCLXDialog::getTitle() throw(::com::sun::star::uno::RuntimeException)
 {
     ::vos::OGuard aGuard( GetMutex() );
diff --git a/toolkit/source/awt/vclxdialog.hxx b/toolkit/source/awt/vclxdialog.hxx
index c270e63..64a90f6 100644
--- toolkit/source/awt/vclxdialog.hxx
+++ toolkit/source/awt/vclxdialog.hxx
@@ -106,6 +106,7 @@ public:
 
     // ::com::sun::star::awt::XDialog2
     void SAL_CALL endDialog( sal_Int32 nResult ) throw(::com::sun::star::uno::RuntimeException);
+    void SAL_CALL setHelpId( sal_Int32 id ) throw(::com::sun::star::uno::RuntimeException);
 
 };
 
diff --git a/toolkit/source/awt/vclxwindows.cxx b/toolkit/source/awt/vclxwindows.cxx
index ec4c268..e9ae5d8 100644
--- toolkit/source/awt/vclxwindows.cxx
+++ toolkit/source/awt/vclxwindows.cxx
@@ -1336,6 +1336,13 @@ void VCLXRadioButton::ImplClickedOrToggled( BOOL bToggled )
 	}
 }
 
+::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > VCLXRadioButton::getFirstActionListener ()
+{
+    if (!maItemListeners.getLength ())
+        return ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > ();
+    return maActionListeners.getElements()[0];
+}
+
 //	----------------------------------------------------
 //	class VCLXSpinField
 //	----------------------------------------------------
diff --git a/toolkit/source/layout/import.cxx b/toolkit/source/layout/import.cxx
index 87b3a32..104dd06 100644
--- toolkit/source/layout/import.cxx
+++ toolkit/source/layout/import.cxx
@@ -103,7 +103,16 @@ SAL_THROW (())
     {
         OUString aTitle;
         if ( findAndRemove( "title", aProps, aTitle ) )
+        {
+            OSL_TRACE("Setting title: %s", OUSTRING_CSTR( aTitle ) );
             xDialog->setTitle( aTitle );
+        }
+        OUString aHelpId;
+        if ( findAndRemove( "help-id", aProps, aHelpId ) )
+        {
+            OSL_TRACE("Setting help-id: %s", OUSTRING_CSTR( aHelpId ) );
+            xDialog->setHelpId( aHelpId.toInt32 () );
+        }
     } // DEBUG:
     else if ( pParent == NULL )
     {
@@ -126,13 +135,11 @@ SAL_THROW (())
         if ( DialogButtonHBox *b = dynamic_cast<DialogButtonHBox *> ( mpWidget->getPeer().get() ) )
             b->setOrdering ( aOrdering );
 
-#ifdef IMPORT_RADIOGROUP
-    bool bSetRadioGroup, bSetTitle;
-    OUString aRadioGroup, aTitle;
+    bool bSetRadioGroup;
+    OUString aRadioGroup;
     bSetRadioGroup = findAndRemove( "radiogroup", aProps, aRadioGroup );
-    bSetTitle = findAndRemove( "title", aProps, aTitle );
 
-    setProperties( mxPeer, aProps );
+    mpWidget->setProperties( aProps );
 
     // we need to add radio buttons to the group after their properties are
     // set, so we can check if they should be the one selected by default or not.
@@ -141,17 +148,10 @@ SAL_THROW (())
     {
         static int i = 0;
         i++;
-        uno::Reference< awt::XRadioButton > xRadio( mxPeer, uno::UNO_QUERY );
+        uno::Reference< awt::XRadioButton > xRadio( mpWidget->getPeer(), uno::UNO_QUERY );
         if ( xRadio.is() )
             pImport->mxRadioGroups.addItem( aRadioGroup, xRadio );
     }
-    if ( bSetTitle )
-    {
-        uno::Reference< awt::XDialog2 > xDialog( mxPeer, uno::UNO_QUERY );
-        if ( xDialog.is() )
-            xDialog->setTitle( aTitle );
-    }
-#endif
 }
 
 WidgetElement::~WidgetElement()
@@ -185,7 +185,7 @@ WidgetElement::startChildElement ( sal_Int32 nUid, OUString const &name,
 // transex3 hack.
 void SAL_CALL
 WidgetElement::characters( OUString const& rChars )
-    throw (css::xml::sax::SAXException, css::uno::RuntimeException)
+    throw (xml::sax::SAXException, uno::RuntimeException)
 {
     if ( mpWidget && rChars.trim().getLength() )
     {
@@ -250,4 +250,97 @@ uno::Reference< xml::input::XElement > ImportContext::startRootElement(
         return new ToplevelElement( rLocalName, xAttributes, this );
 }
 
+RadioGroups::RadioGroups()
+{
+}
+
+void RadioGroups::addItem( rtl::OUString id, uno::Reference< awt::XRadioButton > xRadio )
+    throw (uno::RuntimeException)
+{
+    if ( ! xRadio.is() )
+        throw uno::RuntimeException();
+    
+    uno::Reference< RadioGroup > group;
+    RadioGroupsMap::iterator it = mxRadioGroups.find( id );
+    if ( it == mxRadioGroups.end() )
+    {
+        group = uno::Reference< RadioGroup > ( new RadioGroup() );
+        mxRadioGroups [id] = group;
+    }
+    else
+        group = it->second;
+    group->addItem( xRadio );
+}
+
+RadioGroups::RadioGroup::RadioGroup()
+{
+}
+
+void RadioGroups::RadioGroup::addItem( uno::Reference< awt::XRadioButton > xRadio )
+{
+    if ( ! mxSelectedRadio.is() )
+    {
+        xRadio->setState( true );
+        mxSelectedRadio = xRadio;
+    }
+    else if ( xRadio->getState() )
+    {
+#if 1
+        xRadio->setState( false );
+#else // huh, why select last added?
+      mxSelectedRadio->setState( false );
+      mxSelectedRadio = xRadio;
+#endif
+    }
+
+    // TOO late: actionPerformed is called before itemStateChanged.
+    // If client code (wrongly?) uses actionPerformed, it will see
+    // the previous RadioButtons' state.
+    xRadio->addItemListener( this );
+
+    uno::Reference< awt::XButton > xButton = uno::Reference< awt::XButton > ( xRadio, uno::UNO_QUERY );
+    xButton->addActionListener( this );
+
+    mxRadios.push_back (xRadio);
+}
+
+void RadioGroups::RadioGroup::handleSelected ()
+    throw (uno::RuntimeException)
+{
+    for ( RadioButtonsList::iterator it = mxRadios.begin();
+          it != mxRadios.end(); it++ )
+        if ( *it != mxSelectedRadio && (*it)->getState() )
+        {
+            mxSelectedRadio->setState( false );
+            mxSelectedRadio = *it;
+            break;
+        }
+}
+
+// awt::XItemListener
+void RadioGroups::RadioGroup::itemStateChanged( const awt::ItemEvent& e )
+    throw (uno::RuntimeException)
+{
+    // TOO late: actionPerformed is called before itemStateChanged.
+    // If client code (wrongly?) uses actionPerformed, it will see
+    // the previous RadioButtons' state.
+
+    // Need this for initialization, though.
+    if ( e.Selected )
+        handleSelected ();
+}
+
+// awt::XActionListener
+void RadioGroups::RadioGroup::actionPerformed( const awt::ActionEvent& e )
+    throw (uno::RuntimeException)
+{
+    handleSelected ();
+}
+
+// lang::XEventListener
+void SAL_CALL RadioGroups::RadioGroup::disposing( const lang::EventObject& )
+    throw (uno::RuntimeException)
+{
+}
+
 } // namespace layoutimpl
diff --git a/toolkit/source/layout/import.hxx b/toolkit/source/layout/import.hxx
index 3026e15..dc36710 100644
--- toolkit/source/layout/import.hxx
+++ toolkit/source/layout/import.hxx
@@ -41,8 +41,11 @@
 #define _BACKWARD_BACKWARD_WARNING_H 1
 #include <hash_map>
 
+
 #include <com/sun/star/xml/input/XRoot.hpp>
 #include <cppuhelper/implbase1.hxx>
+#include <com/sun/star/awt/XButton.hpp>
+#include <com/sun/star/awt/XRadioButton.hpp>
 
 namespace layoutimpl
 {
@@ -50,94 +53,41 @@ class LayoutRoot;
 class LayoutWidget;
 namespace css = ::com::sun::star;
 
-/* blocks under IMPORT_RADIOGROUP are marked for deletion.
-   The use of it is to synchronize radio buttons into groups.
-   But toolkit doesn't fire toggle events when toggled from the code.
-   Another approach is to implement our own XRadioButton from our
-   internal toolkit. We could have some singleton where they would
-   register... We would need to add another attribute...
-*/
-
-#ifdef IMPORT_RADIOGROUP
-#include <com/sun/star/awt/XRadioButton.hpp>
 class RadioGroups
 {
 public:
-    RadioGroups()
-    {
-    }
+    RadioGroups();
 
     void addItem( rtl::OUString id, css::uno::Reference< css::awt::XRadioButton > xRadio )
-        throw (css::uno::RuntimeException)
-    {
-        if ( ! xRadio.is() )
-            throw css::uno::RuntimeException();
-
-        css::uno::Reference< RadioGroup > group;
-        RadioGroupsMap::iterator it = mxRadioGroups.find( id );
-        if ( it == mxRadioGroups.end() )
-        {
-            group = css::uno::Reference< RadioGroup > ( new RadioGroup() );
-            mxRadioGroups [id] = group;
-        }
-        else
-            group = it->second;
-        group->addItem( xRadio );
-    }
+        throw (css::uno::RuntimeException);
 
 private:
     class RadioGroup : public ::cppu::WeakImplHelper1< css::awt::XItemListener >
+        , public ::cppu::WeakImplHelper1< css::awt::XActionListener >
     {
     public:
-        RadioGroup()
-        {
-        }
-
-        void addItem( css::uno::Reference< css::awt::XRadioButton > xRadio )
-        {
-            if ( ! mxSelectedRadio.is() )
-            {
-                xRadio->setState( true );
-                mxSelectedRadio = xRadio;
-            }
-            else if ( xRadio->getState() )
-            {
-                mxSelectedRadio->setState( false );
-                mxSelectedRadio = xRadio;
-            }
-
-            xRadio->addItemListener( this );
-            mxRadios.push_back (xRadio);
-        }
+        RadioGroup();
+        void addItem( css::uno::Reference< css::awt::XRadioButton > xRadio );
 
     private:
         typedef std::list< css::uno::Reference< css::awt::XRadioButton > > RadioButtonsList;
         RadioButtonsList mxRadios;
         css::uno::Reference< css::awt::XRadioButton > mxSelectedRadio;
 
+        void handleSelected ()
+            throw (css::uno::RuntimeException);
+
         // awt::XItemListener
-        void itemStateChanged( const com::sun::star::awt::ItemEvent& e)
-            throw (css::uno::RuntimeException)
-        {
-            if ( e.Selected )
-            {
-                mxSelectedRadio->setState( false );
-                // the only radio button selected would be the one that fired the event
-                for ( RadioButtonsList::iterator it = mxRadios.begin();
-                      it != mxRadios.end(); it++ )
-                    if ( (*it)->getState() )
-                    {
-                        mxSelectedRadio = *it;
-                        break;
-                    }
-            }
-        }
+        void itemStateChanged( const css::awt::ItemEvent& e )
+            throw (css::uno::RuntimeException);
+
+        // awt::XActionListener
+        void actionPerformed( const css::awt::ActionEvent& e )
+            throw (css::uno::RuntimeException);
 
         // lang::XEventListener
         void SAL_CALL disposing( const css::lang::EventObject& )
-            throw (css::uno::RuntimeException)
-        {
-        }
+            throw (css::uno::RuntimeException);
     };
 
     // each RadioGroup will stay alive after RadioGroups die with the ImportContext
@@ -145,7 +95,6 @@ private:
     typedef std::map< rtl::OUString, css::uno::Reference< RadioGroup > > RadioGroupsMap;
     RadioGroupsMap mxRadioGroups;
 };
-#endif
 
 #if 0
 // generator
@@ -201,9 +150,7 @@ class ImportContext : public ::cppu::WeakImplHelper1< css::xml::input::XRoot >
 public:
     sal_Int32 XMLNS_LAYOUT_UID, XMLNS_CONTAINER_UID;
     LayoutRoot &mrRoot; // switch to XNameContainer ref ?
-#ifdef IMPORT_RADIOGROUP
     RadioGroups mxRadioGroups;
-#endif
 
     inline ImportContext( LayoutRoot &rRoot ) SAL_THROW( () )
         : mrRoot( rRoot ) {}
diff --git a/toolkit/source/layout/proplist.cxx b/toolkit/source/layout/proplist.cxx
index 02b510a..a3fe1f4 100644
--- toolkit/source/layout/proplist.cxx
+++ toolkit/source/layout/proplist.cxx
@@ -408,7 +408,8 @@ findAndRemove( const char *pAttr, PropList &rProps, OUString &rValue )
 
     for ( it = rProps.begin(); it != rProps.end(); it++ )
     {
-        if ( it->first.equalsIgnoreAsciiCase( aName ) )
+        if ( it->first.equalsIgnoreAsciiCase( aName )
+             || it->first.equalsIgnoreAsciiCase( OUString::createFromAscii ("_") + aName ) )
         {
             rValue = it->second;
             rProps.erase( it );
diff --git a/toolkit/source/vclcompat/wbutton.cxx b/toolkit/source/vclcompat/wbutton.cxx
index 5300e70..b6e54be 100644
--- toolkit/source/vclcompat/wbutton.cxx
+++ toolkit/source/vclcompat/wbutton.cxx
@@ -43,6 +43,7 @@
 #include <com/sun/star/graphic/XGraphic.hpp>
 #include <cppuhelper/implbase1.hxx>
 #include <toolkit/awt/vclxwindow.hxx>
+#include <toolkit/awt/vclxwindows.hxx>
 #include <toolkit/helper/convert.hxx>
 #include <vcl/button.hxx>
 #include <vcl/event.hxx>
@@ -53,6 +54,7 @@
 #include <list>
 
 #include "layout/layoutcore.hxx"
+#include "layout/proplist.hxx"
 
 using namespace ::com::sun::star;
 
@@ -88,10 +90,10 @@ class ButtonImpl : public ControlImpl
                  , public ::cppu::WeakImplHelper1< awt::XItemListener >
 {
     Link maClickHdl;
-  protected:
+protected:
     // we add toggle hooks here to cut on code
     Link maToggleHdl;
-  public:
+public:
     uno::Reference< awt::XButton > mxButton;
     ButtonImpl( Context *pCtx, const PeerHandle &xPeer, Window *pWindow )
         : ControlImpl( pCtx, xPeer, pWindow )
@@ -106,7 +108,7 @@ class ButtonImpl : public ControlImpl
 
     virtual void Click() { /* make me pure virtual? */ };
 
-    void SetClickHdl( const Link& rLink )
+    virtual void SetClickHdl( const Link& rLink )
     {
         maClickHdl = rLink;
         if ( !rLink )
@@ -117,9 +119,11 @@ class ButtonImpl : public ControlImpl
 
     virtual void SAL_CALL disposing( const css::lang::EventObject& /* Source */ )
         throw (css::uno::RuntimeException)
-    { mxButton.clear(); }
+    {
+        mxButton.clear();
+    }
 
-    virtual void SAL_CALL actionPerformed( const css::awt::ActionEvent& /* rEvent */ )
+    virtual void SAL_CALL actionPerformed( const css::awt::ActionEvent& e )
         throw (css::uno::RuntimeException)
     {
         if ( !maClickHdl )
@@ -128,14 +132,14 @@ class ButtonImpl : public ControlImpl
             maClickHdl.Call( static_cast<Window *>( mpWindow ) );
     }
 
-    virtual  // HACK: doesn't need to be virtual... remove in future...
+    virtual
     void SAL_CALL itemStateChanged( const css::awt::ItemEvent& /* rEvent */ )
         throw (css::uno::RuntimeException)
     {
         maToggleHdl.Call( static_cast<Window *>( mpWindow ) );
     }
 
-    BOOL SetModeImage( css::uno::Reference< css::graphic::XGraphic > xGraph )
+    bool SetModeImage( css::uno::Reference< css::graphic::XGraphic > xGraph )
     {
         setProperty( "Graphic", uno::Any( xGraph ) );
         return true;
@@ -154,7 +158,7 @@ void Button::SetClickHdl( const Link& rLink )
     getImpl().SetClickHdl( rLink );
 }
 
-BOOL Button::SetModeImage( const Image& rImage )
+bool Button::SetModeImage( const Image& rImage )
 {
     return getImpl().SetModeImage( rImage.getImpl().mxGraphic );
 }
@@ -201,14 +205,14 @@ class PushButtonImpl : public ButtonImpl
     }
 };
 
-void PushButton::Check( BOOL bCheck )
+void PushButton::Check( bool bCheck )
 {
     getImpl().setProperty( "State", uno::Any( (sal_Int16) !!bCheck ) );
     // XButton doesn't have explicit toggle event
     getImpl().fireToggle();
 }
 
-BOOL PushButton::IsChecked() const
+bool PushButton::IsChecked() const
 {
     return !!( getImpl().getProperty( "State" ).get< sal_Int16 >() );
 }
@@ -226,9 +230,6 @@ void PushButton::SetToggleHdl( const Link& rLink )
 IMPL_GET_IMPL( PushButton );
 IMPL_CONSTRUCTORS( PushButton, Button, "pushbutton" );
 
- // HACK: put every radio button into a group :/
-static std::list< RadioButtonImpl*> mpRadioGroup;
-
 class RadioButtonImpl : public ButtonImpl
 {
 public:
@@ -237,55 +238,41 @@ public:
         : ButtonImpl( pCtx, xPeer, pWindow )
         , mxRadioButton( xPeer, uno::UNO_QUERY )
     {
-        // TEMP:
-        mpRadioGroup.push_back( this );
-        mxRadioButton->addItemListener( this );
-    }
-
-    ~RadioButtonImpl()
-    {
-        //mxRadioButton->removeItemListener( this );
-        mpRadioGroup.pop_front();
     }
 
-    void Check( BOOL bCheck )
+    void Check( bool bCheck )
     {
         if ( !mxRadioButton.is() )
             return;
+
+#if 1
+        // Have setState fire item event for
+        // RadioGroups::RadioGroup::itemStateChanged ()
+        ::RadioButton *r = static_cast<RadioButton*>(mpWindow)->GetRadioButton ();
+        bool state = r->IsRadioCheckEnabled ();
+        r->EnableRadioCheck();
+        mxRadioButton->setState( !!bCheck );
+        r->EnableRadioCheck (state);
+#else
         mxRadioButton->setState( !!bCheck );
+#endif
         fireToggle();
-
-        if ( bCheck )
-            unsetOthersGroup( this );
     }
 
-    BOOL IsChecked()
+    bool IsChecked()
     {
         if ( !mxRadioButton.is() )
-            return FALSE;
+            return false;
         return mxRadioButton->getState();
     }
 
-    static void unsetOthersGroup( RadioButtonImpl* current )
-    {
-        // set all others to false
-        for ( std::list< RadioButtonImpl*>::iterator i = mpRadioGroup.begin();
-              i != mpRadioGroup.end(); i++ )
-            {
-            if ( *i != current )
-                ( *i )->Check( false );
-        }
-    }
-
     void SetToggleHdl( const Link& rLink )
     {
         maToggleHdl = rLink;
-#if 0
         if ( !rLink )
             mxRadioButton->removeItemListener( this );
         else
             mxRadioButton->addItemListener( this );
-#endif
     }
 
     inline void fireToggle()
@@ -293,24 +280,37 @@ public:
         maToggleHdl.Call(  static_cast<Window *>( mpWindow ) );
     }
 
-//HACK: temp
-    virtual void SAL_CALL itemStateChanged( const css::awt::ItemEvent& rEvent )
-        throw (css::uno::RuntimeException)
+    virtual void SetClickHdl( const Link& rLink )
     {
-        if ( !!maToggleHdl )
-        ButtonImpl::itemStateChanged( rEvent );
+        // Keep RadioGroups::RadioGroup's actionListener at HEAD
+        // of list.  This way, it can handle RadioGroup's button
+        // states before all other callbacks and make sure the
+        // client code has the right state.
+
+        // IWBN to add an XRadioButton2 and layout::VCLXRadioButton
+        // with {get,set}RadioGroup() (and a "radiogroup" property
+        // even) and handle the grouping here in RadioButtonImpl.
+        uno::Reference< uno::XInterface > x = static_cast<VCLXRadioButton*> (mpWindow->GetVCLXWindow ())->getFirstActionListener ();
+        uno::Reference< awt::XActionListener > a = uno::Reference< awt::XActionListener> (x ,uno::UNO_QUERY );
+        mxButton->removeActionListener (a);
+        ButtonImpl::SetClickHdl (rLink);
+        mxButton->addActionListener (a);
+    }
 
-        if ( IsChecked() )
-            unsetOthersGroup( this );
+    virtual
+    void SAL_CALL itemStateChanged( const css::awt::ItemEvent& e )
+        throw (css::uno::RuntimeException)
+    {
+        maToggleHdl.Call( static_cast<Window *>( mpWindow ) );
     }
 };
 
-void RadioButton::Check( BOOL bCheck )
+void RadioButton::Check( bool bCheck )
 {
     getImpl().Check( bCheck );
 }
 
-BOOL RadioButton::IsChecked() const
+bool RadioButton::IsChecked() const
 {
     return getImpl().IsChecked();
 }
@@ -321,20 +321,8 @@ void RadioButton::SetToggleHdl( const Link& rLink )
 }
 
 IMPL_GET_IMPL( RadioButton );
-#if 1
+IMPL_GET_WINDOW( RadioButton );
 IMPL_CONSTRUCTORS( RadioButton, Button, "radiobutton" );
-#else //debugging aid
-RadioButton::RadioButton( Context *pCtx, const char *pId, sal_uInt32 nId )
-    : Button( new RadioButtonImpl( pCtx, pCtx->GetPeerHandle( pId, nId ), this ) )
-{
-    printf( "%s: name=%s\n", __PRETTY_FUNCTION__, pId );
-}
-
-RadioButton::RadioButton( Window *pParent, WinBits nBits )
-    : Button( new RadioButtonImpl( pParent->getContext(), Window::CreatePeer( pParent, nBits, "radiobutton" ), this ) )
-{
-}
-#endif
 
 class CheckBoxImpl : public ButtonImpl
 {
@@ -354,17 +342,17 @@ class CheckBoxImpl : public ButtonImpl
     }
 };
 
-void CheckBox::Check( BOOL bCheck )
+void CheckBox::Check( bool bCheck )
 {
     if ( !getImpl().mxCheckBox.is() )
         return;
     getImpl().mxCheckBox->setState( !!bCheck );
 }
 
-BOOL CheckBox::IsChecked() const
+bool CheckBox::IsChecked() const
 {
     if ( !getImpl().mxCheckBox.is() )
-        return FALSE;
+        return false;
     return getImpl().mxCheckBox->getState() != 0;
 }
 
diff --git a/toolkit/source/vclcompat/wfield.cxx b/toolkit/source/vclcompat/wfield.cxx
index 8d9ab13..fb7bb4d 100644
--- toolkit/source/vclcompat/wfield.cxx
+++ toolkit/source/vclcompat/wfield.cxx
@@ -44,6 +44,7 @@
 #include <cppuhelper/implbase1.hxx>
 #include <com/sun/star/awt/XActionListener.hpp>
 #include <com/sun/star/awt/XItemListener.hpp>
+#include <vcl/lstbox.hxx>
 
 using namespace ::com::sun::star;
 
@@ -498,7 +499,7 @@ public:
         return mxListBox->getItemCount();
     }
 
-    void SelectEntryPos( USHORT nPos, BOOL bSelect )
+    void SelectEntryPos( USHORT nPos, bool bSelect )
     {
         mxListBox->selectItemPos( nPos, bSelect );
     }
@@ -537,8 +538,7 @@ public:
         if ( !rLink )
             mxListBox->removeItemListener( this );
         else
-            mxListBox->addItemListener( this );
-    }
+            mxListBox->addItemListener( this );    }
 
     virtual void SAL_CALL disposing( const css::lang::EventObject& /* Source */ )
         throw (css::uno::RuntimeException)
@@ -598,12 +598,12 @@ USHORT ListBox::GetEntryCount() const
     return getImpl().GetEntryCount();
 }
 
-void ListBox::SelectEntryPos( USHORT nPos, BOOL bSelect )
+void ListBox::SelectEntryPos( USHORT nPos, bool bSelect )
 {
     getImpl().SelectEntryPos( nPos, bSelect );
 }
 
-void ListBox::SelectEntry( const XubString& rStr, BOOL bSelect )
+void ListBox::SelectEntry( const XubString& rStr, bool bSelect )
 {
     SelectEntryPos( GetEntryPos( rStr ), bSelect );
 }
@@ -636,4 +636,18 @@ void ListBox::SetClickHdl( const Link& rLink )
 IMPL_CONSTRUCTORS( ListBox, Control, "listbox" );
 IMPL_GET_IMPL( ListBox );
 
+// Window/Control/List/MultiListBox
+class MultiListBoxImpl : public ListBoxImpl
+{
+public:
+    MultiListBoxImpl( Context *pCtx, const PeerHandle &xPeer, Window *pWindow )
+        : ListBoxImpl( pCtx, xPeer, pWindow )
+    {
+    }
+};
+
+IMPL_CONSTRUCTORS_BODY( MultiListBox, ListBox, "multilistbox", GetMultiListBox()->EnableMultiSelection( true ); );
+IMPL_GET_IMPL( MultiListBox );
+IMPL_GET_WINDOW( MultiListBox );
+
 } // namespace layout
diff --git a/toolkit/source/vclcompat/wrapper.cxx b/toolkit/source/vclcompat/wrapper.cxx
index 95bc106..c765f5e 100644
--- toolkit/source/vclcompat/wrapper.cxx
+++ toolkit/source/vclcompat/wrapper.cxx
@@ -188,33 +188,53 @@ Context *Window::getContext()
     return this && mpImpl ? mpImpl->mpCtx : NULL;
 }
 
-PeerHandle Window::GetPeer()
+PeerHandle Window::GetPeer() const
 {
     if ( !mpImpl )
         return PeerHandle();
     return mpImpl->mxWindow;
 }
 
-uno::Reference<awt::XWindow> Window::GetRef()
+uno::Reference<awt::XWindow> Window::GetRef() const
 {
     return uno::Reference <awt::XWindow> ( GetPeer(), uno::UNO_QUERY );
 }
 
-VCLXWindow* Window::GetVCLXWindow()
+VCLXWindow* Window::GetVCLXWindow() const
 {
     return VCLXWindow::GetImplementation( GetRef() );
 }
 
-::Window* Window::GetWindow()
+::Window* Window::GetWindow() const
 {
     return GetVCLXWindow()->GetWindow();
 }
 
-::Window* Window::GetParent()
+::Window* Window::GetParent() const
 {
     return GetWindow()->GetParent();
 }
 
+void Window::SetHelpId( ULONG id )
+{
+    GetWindow()->SetHelpId( id );
+}
+
+ULONG Window::GetHelpId() const
+{
+    return GetWindow()->GetHelpId();
+}
+
+void Window::SetSmartHelpId( SmartId const& id, SmartIdUpdateMode mode )
+{
+    GetWindow()->SetSmartHelpId( id, mode );
+}
+
+SmartId Window::GetSmartHelpId() const
+{
+    return GetWindow()->GetSmartHelpId();
+}
+
 struct ToolkitVclPropsMap
 {
     WinBits vclStyle;
@@ -364,7 +384,7 @@ void Window::Enable( bool bEnable )
     getImpl().mxWindow->setEnable( bEnable );
 }
 
-void Window::Show( BOOL bVisible )
+void Window::Show( bool bVisible )
 {
     if ( !getImpl().mxWindow.is() )
         return;
@@ -378,6 +398,31 @@ void Window::GrabFocus()
     getImpl().mxWindow->setFocus();
 }
 
+void Window::SetUpdateMode(bool mode)
+{
+    GetWindow()->SetUpdateMode( mode );
+}
+
+void Window::SetPointer( Pointer const& pointer )
+{
+    GetWindow()->SetPointer( pointer );
+}
+
+Pointer const& Window::GetPointer() const
+{
+    return GetWindow()->GetPointer();
+}
+
+void Window::SetText( String const& str )
+{
+    GetWindow()->SetText( str );
+}
+
+String Window::GetText() const
+{
+    return GetWindow()->GetText();
+}
+
 class DialogImpl : public WindowImpl
 {
 public:
diff --git a/toolkit/source/vclcompat/wrapper.hxx b/toolkit/source/vclcompat/wrapper.hxx
index 5df64bc..e5332de 100644
--- toolkit/source/vclcompat/wrapper.hxx
+++ toolkit/source/vclcompat/wrapper.hxx
@@ -116,15 +116,18 @@ inline WindowImpl &Window::getImpl() const
     { \
         return *(static_cast<t##Impl *>(mpImpl)); \
     }
-#define IMPL_CONSTRUCTORS(t,par,unoName) \
+#define IMPL_CONSTRUCTORS_BODY(t,par,unoName,body) \
     t::t( Context *pCtx, const char *pId, sal_uInt32 nId ) \
         : par( new t##Impl( pCtx, pCtx->GetPeerHandle( pId, nId ), this ) ) \
     { \
+      body\
     } \
     t::t( Window *pParent, WinBits nBits) \
         : par( new t##Impl( pParent->getContext(), Window::CreatePeer( pParent, nBits, unoName ), this ) ) \
     { \
+      body\
     }
+#define IMPL_CONSTRUCTORS(t,par,unoName) IMPL_CONSTRUCTORS_BODY(t, par, unoName, )
 #define IMPL_CONSTRUCTORS_2(t,win_par,other_par,unoName) \
     t::t( Context *pCtx, const char *pId, sal_uInt32 nId ) \
         : win_par( new t##Impl( pCtx, pCtx->GetPeerHandle( pId, nId ), this ) ) \
diff --git a/toolkit/util/makefile.pmk b/toolkit/util/makefile.pmk
index f88a240..acf6ba4 100644
--- toolkit/util/makefile.pmk
+++ toolkit/util/makefile.pmk
@@ -41,7 +41,5 @@ CFLAGS += -xldscope=hidden
 
 CFLAGS+=-I$(PRJ)/inc/layout
 .IF "$(ENABLE_LAYOUT)" == "TRUE"
-CFLAGS+=-DENABLE_LAYOUT=1 -DTEST_LAYOUT=1
-.ELSE
-CFLAGS+=-DENABLE_LAYOUT=0
+CFLAGS+=-DTEST_LAYOUT=1
 .ENDIF # ENABLE_LAYOUT == TRUE
diff --git a/toolkit/workben/layout/insert-sheet.xml b/toolkit/workben/layout/insert-sheet.xml
new file mode 100644
index 0000000..0ce5843
--- /dev/null
+++ toolkit/workben/layout/insert-sheet.xml
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This is a template.  i18n translation is not performed in-place;
+     i18n translated XML files are generated from this template by
+     transex3/layout/tralay.  !-->
+
+<modaldialog sizeable="true" closeable="true" moveable="true" output-size="true" id="RID_SCDLG_INSERT_TABLE" sv-look="true" _title="Insert Sheet" xmlns="http://openoffice.org/2007/layout" xmlns:cnt="http://openoffice.org/2007/layout/container">
+    <vbox spacing="5" border="5">
+        <fixedline id="FL_POSITION" _text="Position"/>
+	<hbox>
+	    <vbox cnt:padding="13" spacing="5">
+		<radiobutton radiogroup="insert-sheet-position" id="RB_BEFORE" tabstop="true" _label="B~efore current sheet"/>
+		<radiobutton radiogroup="insert-sheet-position" id="RB_BEHIND" tabstop="true" _label="~After current sheet"/>
+	    </vbox>
+	</hbox>
+        <fixedline id="FL_TABLE" _text="Sheet"/>
+	<hbox>
+	    <vbox cnt:padding="13" spacing="5">
+		<radiobutton radiogroup="insert-sheet-source" id="RB_NEW" _label="~New sheet"/>
+		<hbox>
+		    <vbox cnt:padding="13" spacing="5" cnt:fill="false" cnt:expand="false">
+			<fixedtext id="FT_COUNT" _label="N~o. of sheets"/>
+			<fixedtext id="FT_NAME" _label="Na~me"/>
+		    </vbox>
+		    <vbox>
+			<hbox>
+			    <numericfield has_border="true" maximum="256" minimum="1" repeat="true" id="NF_COUNT" spin="true" spin-size="1" tabstop="true" value="1" cnt:fill="true" cnt:expand="false"/>
+			</hbox>
+			<edit has_border="true" id="ED_TABNAME"  cnt:fill="true" cnt:expand="true"/>
+		    </vbox>
+		</hbox>
+	    </vbox>
+	</hbox>
+	<hbox>
+	    <vbox cnt:padding="13" spacing="5">
+		<radiobutton radiogroup="insert-sheet-source" id="RB_FROMFILE" _label="~From file"/>
+		<hbox>
+		    <vbox cnt:padding="13" spacing="5">
+			<hbox>
+			    <multilistbox auto-hscroll="true" has_border="true" id="LB_TABLES" simple-mode="true" string-item-list=" : : : : " cnt:fill="true" cnt:expand="true"/>
+			    <vbox cnt:fill="false" cnt:expand="false" spacing="5">
+				<pushbutton id="BTN_BROWSE" _label="~Browse..." cnt:expand="false"/>
+			    <checkbox id="CB_LINK" _label="Lin~k" cnt:expand="false"/>
+			    <flow/>
+			    </vbox>
+			</hbox>
+			<fixedtext id="FT_PATH" label="FT-PATH"/>
+		    </vbox>
+		</hbox>
+	    </vbox>
+	</hbox>
+	<dialogbuttonhbox border="5" spacing="5">
+            <okbutton default="true" id="BTN_OK"/>
+            <cancelbutton id="BTN_CANCEL"/>
+            <helpbutton id="BTN_HELP"/>
+	</dialogbuttonhbox>
+    </vbox>
+</modaldialog>
diff --git a/toolkit/workben/layout/makefile.mk b/toolkit/workben/layout/makefile.mk
index 2b2609c..3afebd5 100644
--- toolkit/workben/layout/makefile.mk
+++ toolkit/workben/layout/makefile.mk
@@ -47,12 +47,10 @@ ENABLE_EXCEPTIONS=TRUE
 CFLAGS += -I$(PRJ)/source/layout
 
 # Allow zoom and wordcount to be built without depending on svx,sv,sfx2
-CFLAGS += -I../$(PRJ)/svx/inc -I../$(PRJ)/svtools/inc -I../$(PRJ)/sfx2/inc -I../$(PRJ)/sc/inc -I../$(PRJ)/sc/source/ui/inc
+CFLAGS += -I../$(PRJ)/svx/inc -I../$(PRJ)/svtools/inc -I../$(PRJ)/sfx2/inc -I../$(PRJ)/sc/inc -I../$(PRJ)/sc/source/ui/inc -I../$(PRJ)/sw/inc
 
 .INCLUDE : $(PRJ)$/util$/makefile.pmk
 
-CFLAGS += -DENABLE_LAYOUT=1 -DTEST_LAYOUT=1
-
 .IF "$(COMNAME)" == "gcc3"
 CFLAGS+=-Wall -Wno-non-virtual-dtor
 .ENDIF
@@ -96,6 +94,7 @@ default: ALLTAR
 .INCLUDE : target.mk
 
 XML_FILES=\
+	insert-sheet.xml\
 	recover.xml\
 	sort-options.xml\
 	wordcount.xml\
@@ -126,9 +125,11 @@ dist .PHONY :
 	$(SHELL) ./un-test.sh zoom.cxx > ../$(PRJ)/svx/source/dialog/zoom.cxx
 	$(SHELL) ./un-test.sh zoom.hxx > ../$(PRJ)/svx/source/dialog/zoom.hxx
 	touch ../$(PRJ)/svx/source/dialog/dlgfact.cxx
+	cp -pv zoom.xml ../$(PRJ)/svx/uiconfig/layout
 	$(SHELL) ./un-test.sh wordcountdialog.cxx > ../$(PRJ)/sw/source/ui/dialog/wordcountdialog.cxx
 	$(SHELL) ./un-test.sh wordcountdialog.hxx > ../$(PRJ)/sw/source/ui/inc/wordcountdialog.hxx
 	touch ../$(PRJ)/sw/source/ui/dialog/swdlgfact.cxx
+	cp -pv wordcount.xml ../$(PRJ)/sw/uiconfig/layout
 	# FIXME: broken setup
 	ln -sf ../inc/wordcountdialog.hxx ../$(PRJ)/sw/source/ui/dialog/wordcountdialog.hxx 
 	$(SHELL) ./un-test.sh tpsort.cxx > ../$(PRJ)/sc/source/ui/dbgui/tpsort.cxx
@@ -137,6 +138,8 @@ dist .PHONY :
 	$(SHELL) ./un-test.sh sortdlg.hxx > ../$(PRJ)/sc/source/ui/inc/sortdlg.hxx
 	touch ../$(PRJ)/sc/source/ui/attrdlg/scdlgfact.cxx
 	touch ../$(PRJ)/sc/source/ui/view/cellsh2.cxx
+	cp -pv sort-options.xml ../$(PRJ)/sc/uiconfig/layout
+	cp -pv insert-sheet.xml ../$(PRJ)/sc/uiconfig/layout
 
 .ELSE # ENABLE_LAYOUT != TRUE
 all .PHONY:
diff --git a/toolkit/workben/layout/recover.cxx b/toolkit/workben/layout/recover.cxx
index 76eec92..45cf261 100644
--- toolkit/workben/layout/recover.cxx
+++ toolkit/workben/layout/recover.cxx
@@ -59,6 +59,13 @@ using namespace com::sun::star;
 
 #include <layout/layout-pre.hxx>
 
+#if ENABLE_LAYOUT
+#undef SVX_RES
+#define SVX_RES(x) #x
+#undef SfxModalDialog
+#define SfxModalDialog( parent, id ) Dialog( parent, "recover.xml", id )
+#endif /* ENABLE_LAYOUT */
+
 #if TEST_LAYOUT
 SvxRecoverDialog::SvxRecoverDialog( Window* pParent )
 #else /* !TEST_LAYOUT */
diff --git a/toolkit/workben/layout/tpsort.cxx b/toolkit/workben/layout/tpsort.cxx
index 9468c5d..4d4dfd1 100644
--- toolkit/workben/layout/tpsort.cxx
+++ toolkit/workben/layout/tpsort.cxx
@@ -7,7 +7,7 @@
  * OpenOffice.org - a multi-platform office productivity suite
  *
  * $RCSfile: tpsort.cxx,v $
- * $Revision: 1.13 $
+ * $Revision: 1.14 $
  *
  * This file is part of OpenOffice.org.
  *
diff --git a/toolkit/workben/layout/wordcountdialog.cxx b/toolkit/workben/layout/wordcountdialog.cxx
index 64f1836..1eebbe5 100644
--- toolkit/workben/layout/wordcountdialog.cxx
+++ toolkit/workben/layout/wordcountdialog.cxx
@@ -7,7 +7,7 @@
  * OpenOffice.org - a multi-platform office productivity suite
  *
  * $RCSfile: wordcountdialog.cxx,v $
- * $Revision: 1.3 $
+ * $Revision: 1.10 $
  *
  * This file is part of OpenOffice.org.
  *
@@ -47,6 +47,15 @@
 #include <wordcountdialog.hrc>
 #endif /* !TEST_LAYOUT */
 
+#if ENABLE_LAYOUT
+#undef SW_RES
+#define SW_RES(x) #x
+#undef SfxModalDialog
+#define SfxModalDialog( parent, id ) Dialog( parent, "wordcount.xml", id )
+#define SW_WORDCOUNTDIALOG_HRC
+#include <helpid.h>
+#endif /* ENABLE_LAYOUT */
+
 /*-- 06.04.2004 16:05:55---------------------------------------------------
 
   -----------------------------------------------------------------------*/
@@ -73,6 +82,9 @@ SwWordCountDialog::SwWordCountDialog(Window* pParent) :
 #pragma warning (default : 4355)
 #endif
 {
+#if ENABLE_LAYOUT
+    SetHelpId (HID_DLG_WORDCOUNT);
+#endif /* ENABLE_LAYOUT */
     FreeResource();
 }
 /*-- 06.04.2004 16:05:56---------------------------------------------------
diff --git a/toolkit/workben/layout/wordcountdialog.hxx b/toolkit/workben/layout/wordcountdialog.hxx
index 62e97bb..b0674e2 100644
--- toolkit/workben/layout/wordcountdialog.hxx
+++ toolkit/workben/layout/wordcountdialog.hxx
@@ -7,7 +7,7 @@
  * OpenOffice.org - a multi-platform office productivity suite
  *
  * $RCSfile: wordcountdialog.hxx,v $
- * $Revision: 1.3 $
+ * $Revision: 1.5 $
  *
  * This file is part of OpenOffice.org.
  *
diff --git a/toolkit/workben/layout/zoom.cxx b/toolkit/workben/layout/zoom.cxx
index 3185c96..6d7ade8 100644
--- toolkit/workben/layout/zoom.cxx
+++ toolkit/workben/layout/zoom.cxx
@@ -7,7 +7,7 @@
  * OpenOffice.org - a multi-platform office productivity suite
  *
  * $RCSfile: zoom.cxx,v $
- * $Revision: 1.3 $
+ * $Revision: 1.12 $
  *
  * This file is part of OpenOffice.org.
  *
@@ -51,7 +51,9 @@
 #define _SVX_ZOOM_CXX
 
 #include <svx/dialogs.hrc>
+#if !TEST_LAYOUT
 #include "zoom.hrc"
+#endif /* !TEST_LAYOUT */
 
 #include "zoom.hxx"
 #if TEST_LAYOUT
@@ -112,6 +114,13 @@ struct SvxViewLayoutItem : public LAYOUT_SfxPoolItem
 
 #include <layout/layout-pre.hxx>
 
+#if ENABLE_LAYOUT
+#undef SVX_RES
+#define SVX_RES(x) #x
+#undef SfxModalDialog
+#define SfxModalDialog( parent, id ) Dialog( parent, "zoom.xml", id )
+#endif /* ENABLE_LAYOUT */
+
 // static ----------------------------------------------------------------
 
 static USHORT pRanges[] =
@@ -282,6 +291,9 @@ SvxZoomDialog::SvxZoomDialog( Window* pParent, const SfxItemSet& rCoreSet ) :
 	bModified	( FALSE )
 
 {
+#if ENABLE_LAYOUT
+    SetHelpId (SID_ATTR_ZOOM);
+#endif /* ENABLE_LAYOUT */
 	Link aLink = LINK( this, SvxZoomDialog, UserHdl );
     a100Btn.SetClickHdl( aLink );
     aOptimalBtn.SetClickHdl( aLink );
diff --git a/toolkit/workben/layout/zoom.hxx b/toolkit/workben/layout/zoom.hxx
index 7dc09dc..461cd5a 100644
--- toolkit/workben/layout/zoom.hxx
+++ toolkit/workben/layout/zoom.hxx
@@ -7,7 +7,7 @@
  * OpenOffice.org - a multi-platform office productivity suite
  *
  * $RCSfile: zoom.hxx,v $
- * $Revision: 1.3 $
+ * $Revision: 1.6 $
  *
  * This file is part of OpenOffice.org.
  *
diff --git a/toolkit/workben/layout/zoom.xml b/toolkit/workben/layout/zoom.xml
index 5ad8fcf..f6a76a4 100644
--- toolkit/workben/layout/zoom.xml
+++ toolkit/workben/layout/zoom.xml
@@ -11,30 +11,30 @@
     <vbox spacing="5" border="5">
 	<hbox spacing="0" border="0">
 	    <vbox spacing="5" border="5">
-	<fixedline id="FL_ZOOM" _text="Zoom factor" cnt:expand="true"/>
-		<radiobutton radiogroup="zoom" id="BTN_OPTIMAL"   _label="Optimal"/>
-	<radiobutton radiogroup="zoom" id="BTN_WHOLE_PAGE" _label="Whole Page"/>
-	<radiobutton radiogroup="zoom" id="BTN_PAGE_WIDTH" _label="Page Width"/>
-	<radiobutton radiogroup="zoom" id="BTN_100"   _label="100 %"/>
-	<hbox cnt:expand="false" cnt:fill="true">
-	    <align cnt:expand="false" cnt:fill="true">
-		<radiobutton cnt:v-align="0.5" cnt:v-fill="0" radiogroup="zoom" id="BTN_USER" _label="Variable"/>
-	    </align>
-	    <flow cnt:padding="10" cnt:expand="false"/>
-	    <metricfield id="ED_USER" value-step="1"
-			 repeat="true" has_border="true" spin="true"
-			 _text="100%" unit="11" custom-unit-text="%"
-			 right="true"
-			 cnt:expand="false"/>
-	</hbox>
+		<fixedline id="FL_ZOOM" _text="Zoom factor" cnt:expand="true"/>
+		<radiobutton radiogroup="zoom-factor" id="BTN_OPTIMAL"   _label="Optimal"/>
+		<radiobutton radiogroup="zoom-factor" id="BTN_WHOLE_PAGE" _label="Whole Page"/>
+		<radiobutton radiogroup="zoom-factor" id="BTN_PAGE_WIDTH" _label="Page Width"/>
+		<radiobutton radiogroup="zoom-factor" id="BTN_100"   _label="100 %"/>
+		<hbox cnt:expand="false" cnt:fill="true">
+		    <align cnt:expand="false" cnt:fill="true">
+			<radiobutton cnt:v-align="0.5" cnt:v-fill="0" radiogroup="zoom-factor" id="BTN_USER" _label="Variable"/>
+		    </align>
+		    <flow cnt:padding="10" cnt:expand="false"/>
+		    <metricfield id="ED_USER" value-step="1"
+				 repeat="true" has_border="true" spin="true"
+				 _text="100%" unit="11" custom-unit-text="%"
+				 right="true"
+				 cnt:expand="false"/>
+		</hbox>
 	    </vbox>
 	    <vbox spacing="5" border="5">
 		<fixedline id="FL_VIEWLAYOUT" _text="View layout" cnt:expand="true"/>
-		<radiobutton radiogroup="zoom" id="BTN_AUTOMATIC" _label="~Automatic"/>
-		<radiobutton radiogroup="zoom" id="BTN_SINGLE"    _label="~Single page"/>
+		<radiobutton radiogroup="zoom-layout" id="BTN_AUTOMATIC" _label="~Automatic"/>
+		<radiobutton radiogroup="zoom-layout" id="BTN_SINGLE"    _label="~Single page"/>
 		<hbox cnt:expand="false" cnt:fill="true">
 		    <align cnt:expand="false" cnt:fill="true">
-			<radiobutton cnt:v-align="0.5" cnt:v-fill="0" radiogroup="zoom" id="BTN_COLUMNS" _label="~Columns"/>
+			<radiobutton cnt:v-align="0.5" cnt:v-fill="0" radiogroup="zoom-layout" id="BTN_COLUMNS" _label="~Columns"/>
 		    </align>
 		    <flow cnt:padding="10" cnt:expand="false"/>
 		    <metricfield id="ED_COLUMNS" value-step="1"
