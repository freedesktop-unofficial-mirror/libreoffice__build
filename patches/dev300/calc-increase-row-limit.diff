From 5ce407cbdbb818d1f4ef5b84403ed4f2ecf37b3a Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:44 +0200
Subject: [PATCH 196/768] calc-increase-row-limit.diff

---
 sc/inc/address.hxx            |    2 +-
 sc/source/ui/view/hdrcont.cxx |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git sc/inc/address.hxx sc/inc/address.hxx
index 67cb480..6bd785e 100644
--- sc/inc/address.hxx
+++ sc/inc/address.hxx
@@ -84,7 +84,7 @@ const SCSIZE   SCSIZE_MAX   = ::std::numeric_limits<SCSIZE>::max();
 
 // The maximum values. Defines are needed for preprocessor checks in
 // bcaslot.cxx, otherwise type safe constants are preferred.
-#define MAXROWCOUNT_DEFINE 65536
+#define MAXROWCOUNT_DEFINE 1048576
 #define MAXCOLCOUNT_DEFINE 1024
 
 // Count values
diff --git sc/source/ui/view/hdrcont.cxx sc/source/ui/view/hdrcont.cxx
index 830dfa3..ce69872 100644
--- sc/source/ui/view/hdrcont.cxx
+++ sc/source/ui/view/hdrcont.cxx
@@ -102,7 +102,7 @@ ScHeaderControl::ScHeaderControl( Window* pParent, SelectionEngine* pSelectionEn
 
     nWidth = nSmallWidth = aSize.Width();
     nBigWidth = LogicToPixel( Size( GetTextWidth(
-        String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("88888")) ), 0 ) ).Width() + 4;
+        String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("8888888")) ), 0 ) ).Width() + 5;
 
     SetBackground();	// sonst Probleme auf OS/2 !?!?!
 }
-- 
1.7.0.1

