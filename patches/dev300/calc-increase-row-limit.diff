From 5e9b8c3a124bb6bc1a22e3d161370f97a8fc1f90 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:44 +0200
Subject: [PATCH 225/878] calc-increase-row-limit.diff

---
 sc/inc/address.hxx            |    2 +-
 sc/source/ui/view/hdrcont.cxx |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/sc/inc/address.hxx b/sc/inc/address.hxx
index 4759025..3bac688 100644
--- a/sc/inc/address.hxx
+++ b/sc/inc/address.hxx
@@ -84,7 +84,7 @@ const SCSIZE   SCSIZE_MAX   = ::std::numeric_limits<SCSIZE>::max();
 
 // The maximum values. Defines are needed for preprocessor checks in
 // bcaslot.cxx, otherwise type safe constants are preferred.
-#define MAXROWCOUNT_DEFINE 65536
+#define MAXROWCOUNT_DEFINE 1048576
 #define MAXCOLCOUNT_DEFINE 1024
 
 // Count values
diff --git a/sc/source/ui/view/hdrcont.cxx b/sc/source/ui/view/hdrcont.cxx
index ad14aed..9132f6d 100644
--- a/sc/source/ui/view/hdrcont.cxx
+++ b/sc/source/ui/view/hdrcont.cxx
@@ -102,7 +102,7 @@ ScHeaderControl::ScHeaderControl( Window* pParent, SelectionEngine* pSelectionEn
 
     nWidth = nSmallWidth = aSize.Width();
     nBigWidth = LogicToPixel( Size( GetTextWidth(
-        String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("88888")) ), 0 ) ).Width() + 4;
+        String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("8888888")) ), 0 ) ).Width() + 5;
 
     SetBackground();	// sonst Probleme auf OS/2 !?!?!
 }
-- 
1.7.0.1

