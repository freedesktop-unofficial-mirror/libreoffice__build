From 365ce432dfd6f1148eb444b3cd0d33162fd5c563 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:02:05 +0200
Subject: [PATCH 496/878] svg-import-eh-fix.diff

---
 filter/source/svg/svgfilter.cxx |    9 ++++++++-
 filter/source/svg/svgreader.cxx |    4 ++--
 2 files changed, 10 insertions(+), 3 deletions(-)

diff --git a/filter/source/svg/svgfilter.cxx b/filter/source/svg/svgfilter.cxx
index 9cf8752..8e202c6 100644
--- a/filter/source/svg/svgfilter.cxx
+++ b/filter/source/svg/svgfilter.cxx
@@ -208,7 +208,14 @@ rtl::OUString SAL_CALL SVGFilter::detect( Sequence< PropertyValue >& io_rDescrip
 class FilterConfigItem;
 extern "C" SAL_DLLPUBLIC_EXPORT BOOL __LOADONCALLAPI GraphicImport(SvStream & rStream, Graphic & rGraphic, FilterConfigItem*, BOOL )
 {
-    return importSvg( rStream, rGraphic );
+    BOOL bRet = FALSE;
+    try
+    {
+        bRet = importSvg( rStream, rGraphic );
+    }
+    catch (const uno::Exception&) {
+    }
+    return bRet;
 }
 
 // -----------------------------------------------------------------------------
diff --git a/filter/source/svg/svgreader.cxx b/filter/source/svg/svgreader.cxx
index b674c0c..ce061a7 100644
--- a/filter/source/svg/svgreader.cxx
+++ b/filter/source/svg/svgreader.cxx
@@ -1803,7 +1803,7 @@ sal_Bool SVGReader::parseAndConvert()
 {
     uno::Reference<xml::dom::XDocumentBuilder> xDomBuilder(
         m_xServiceFactory->createInstance(
-            rtl::OUString::createFromAscii("com.sun.star.xml.dom.DocumentBuilder")), uno::UNO_QUERY );
+            rtl::OUString::createFromAscii("com.sun.star.xml.dom.DocumentBuilder")), uno::UNO_QUERY_THROW );
 
     uno::Reference<xml::dom::XDocument> xDom(
         xDomBuilder->parse(m_xInputStream),
@@ -2710,7 +2710,7 @@ bool importSvg(SvStream & rStream, Graphic & rGraphic )
     uno::Reference<xml::dom::XDocumentBuilder> xDomBuilder(
         xServiceFactory->createInstance(
             rtl::OUString::createFromAscii("com.sun.star.xml.dom.DocumentBuilder")),
-        uno::UNO_QUERY );
+        uno::UNO_QUERY_THROW );
 
     uno::Reference<io::XInputStream> xStream(
         new utl::OInputStreamWrapper(rStream) );
-- 
1.7.0.1

