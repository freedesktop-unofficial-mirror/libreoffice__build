 sc/source/ui/unoobj/docuno.cxx |   12 +++++++++++-
 1 files changed, 11 insertions(+), 1 deletions(-)

diff --git sc/source/ui/unoobj/docuno.cxx sc/source/ui/unoobj/docuno.cxx
index fd60fdf..35092fd 100644
--- sc/source/ui/unoobj/docuno.cxx
+++ sc/source/ui/unoobj/docuno.cxx
@@ -52,6 +52,7 @@
 #include <ctype.h>
 #include <float.h>	// DBL_MAX
 
+#include <com/sun/star/task/ErrorCodeIOException.hpp>
 #include <com/sun/star/util/Date.hpp>
 #include <com/sun/star/sheet/XNamedRanges.hpp>
 #include <com/sun/star/sheet/XLabelRanges.hpp>
@@ -106,6 +107,9 @@
 #include "scresid.hxx"

 using namespace com::sun::star;
+using ::rtl::OUString;
+using ::com::sun::star::uno::Reference;
+
 #define SC_UNO_VBADOCOBJ "ThisVBADocObj" // perhaps we want to actually make this ThisWorkbook ?

 //------------------------------------------------------------------------
@@ -929,7 +933,13 @@ sal_Int32 SAL_CALL ScModelObj::getRendererCount( const uno::Any& aSelection,
     ScPrintSelectionStatus aStatus;
     String aPagesStr;
     if ( !FillRenderMarkData( aSelection, rOptions, aMark, aStatus, aPagesStr ) )
-        return 0;
+    {
+        // TODO: Right now this error code is not reaching where it's supposed
+        // to.  Find out why and figure out how to send correct error code to
+        // the framework code.
+        throw task::ErrorCodeIOException(
+            OUString(), Reference<XInterface>(), ERRCODE_IO_NOTSUPPORTED);
+    }
 
     //	The same ScPrintFuncCache object in pPrintFuncCache is used as long as
     //	the same selection is used (aStatus) and the document isn't changed
