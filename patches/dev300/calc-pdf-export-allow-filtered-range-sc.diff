From 83ab364cba8ead4b770d56d47991503a29990c96 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:08:21 +0200
Subject: [PATCH 810/878] calc-pdf-export-allow-filtered-range-sc.diff

---
 sc/source/ui/unoobj/docuno.cxx |   11 ++++++++++-
 1 files changed, 10 insertions(+), 1 deletions(-)

diff --git a/sc/source/ui/unoobj/docuno.cxx b/sc/source/ui/unoobj/docuno.cxx
index 49bc6f0..addbfc4 100644
--- a/sc/source/ui/unoobj/docuno.cxx
+++ b/sc/source/ui/unoobj/docuno.cxx
@@ -50,6 +50,7 @@
 #include <ctype.h>
 #include <float.h>	// DBL_MAX
 
+#include <com/sun/star/task/ErrorCodeIOException.hpp>
 #include <com/sun/star/util/Date.hpp>
 #include <com/sun/star/sheet/XNamedRanges.hpp>
 #include <com/sun/star/sheet/XLabelRanges.hpp>
@@ -101,6 +102,8 @@
 #include <com/sun/star/document/VbaEventId.hpp>
 using namespace com::sun::star;
 using namespace com::sun::star::document::VbaEventId;
+using ::rtl::OUString;
+using ::com::sun::star::uno::Reference;
 
 #define SC_UNO_VBADOCOBJ "ThisVBADocObj" // perhaps we want to actually make this ThisWorkbook ?
 
@@ -705,7 +708,13 @@ sal_Int32 SAL_CALL ScModelObj::getRendererCount( const uno::Any& aSelection,
     ScMarkData aMark;
     ScPrintSelectionStatus aStatus;
     if ( !FillRenderMarkData( aSelection, aMark, aStatus ) )
-        return 0;
+    {
+        // TODO: Right now this error code is not reaching where it's supposed
+        // to.  Find out why and figure out how to send correct error code to
+        // the framework code.
+        throw task::ErrorCodeIOException(
+            OUString(), Reference<XInterface>(), ERRCODE_IO_NOTSUPPORTED);
+    }
 
     //	The same ScPrintFuncCache object in pPrintFuncCache is used as long as
     //	the same selection is used (aStatus) and the document isn't changed
-- 
1.7.0.1

