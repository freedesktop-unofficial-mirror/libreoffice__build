From 5ddb444677dc0289300ac2bded8b5b395bce707b Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:54:26 +0200
Subject: [PATCH 105/878] desktop-application-octet-stream-mime-type.diff

---
 .../deployment/registry/package/dp_package.cxx     |   16 +++++++++++++++-
 1 files changed, 15 insertions(+), 1 deletions(-)

diff --git a/desktop/source/deployment/registry/package/dp_package.cxx b/desktop/source/deployment/registry/package/dp_package.cxx
index 8dd4ff6..e762cc8 100644
--- a/desktop/source/deployment/registry/package/dp_package.cxx
+++ b/desktop/source/deployment/registry/package/dp_package.cxx
@@ -1357,7 +1357,21 @@ void BackendImpl::PackageImpl::scanBundle(
         if (param != 0 && !platform_fits( param->m_sValue ))
             continue;
         const OUString url( makeURL( packageRootURL, fullPath ) );
-        
+
+    INetContentTypeParameter const * execParam = params.find(
+            ByteString("executable") );
+    if (execParam!=0 && execParam->m_sValue.CompareIgnoreCaseToAscii("true")==COMPARE_EQUAL) {
+        ::rtl::OUString expandedUrl=expandUnoRcUrl(url);
+        oslFileError err=osl_setFileAttributes( expandedUrl.pData, osl_File_Attribute_OwnRead | osl_File_Attribute_OwnExe);
+    }
+
+        if (type.EqualsIgnoreCaseAscii("application") &&
+            subType.EqualsIgnoreCaseAscii(
+                "octet-stream"))
+        {
+        continue;
+    }
+
         // check for bundle description:
         if (type.EqualsIgnoreCaseAscii("application") &&
             subType.EqualsIgnoreCaseAscii(
-- 
1.7.0.1

