diff -r a230682fb6d7 extensions/prj/build.lst
--- extensions/prj/build.lst	Sat Feb 20 01:07:32 2010 +0100
+++ extensions/prj/build.lst	Tue Feb 23 15:33:37 2010 +0100
@@ -6,8 +6,6 @@
 ex  extensions\source\plugin\workben            get     -   all ex_plwkb ex_inc NULL
 ex  extensions\source\plugin\inc\plugin\win     get     -   all ex_piwi ex_inc NULL
 ex  extensions\source\plugin\inc\plugin\unx     get     -   all ex_piux ex_inc NULL
-ex  extensions\source\activex\msidl             nmake   -   w   ex_axmsidl ex_inc NULL
-ex  extensions\source\activex\main              nmake   -   w   ex_axmain ex_axmsidl.w ex_inc NULL
 ex  extensions\source\ole                       nmake   -   w   ex_ole ex_xmlextr ex_inc NULL
 ex  extensions\source\resource                  nmake   -   all ex_resrc ex_inc NULL
 ex  extensions\source\plugin\aqua               nmake   -   u   ex_plaqua ex_plbase NULL
diff -r a230682fb6d7 fpicker/source/win32/filepicker/FPentry.cxx
--- fpicker/source/win32/filepicker/FPentry.cxx	Sat Feb 20 01:07:32 2010 +0100
+++ fpicker/source/win32/filepicker/FPentry.cxx	Tue Feb 23 15:33:37 2010 +0100
@@ -41,7 +41,7 @@
 #include "FPServiceInfo.hxx"
 
 #pragma warning (disable:4917)
-#include "VistaFilePicker.hxx"
+//#include "VistaFilePicker.hxx"
 #include "..\misc\WinImplHelper.hxx"
 #include <stdio.h>
 
@@ -68,6 +68,7 @@
 	Reference< XInterface > xDlg;
 	bool					bVistaOrNewer = IsWindowsVistaOrNewer();
 
+#if 0
 	if (bVistaOrNewer)
 	{
         fprintf(stdout, "use special (vista) system file picker ...\n");
@@ -76,6 +77,7 @@
 				new ::fpicker::win32::vista::VistaFilePicker( rServiceManager ) ) );
 	}
 	else
+#endif
 	{
         fprintf(stdout, "use normal system file picker ...\n");
 		xDlg.set( 
diff -r a230682fb6d7 fpicker/source/win32/filepicker/makefile.mk
--- fpicker/source/win32/filepicker/makefile.mk	Sat Feb 20 01:07:32 2010 +0100
+++ fpicker/source/win32/filepicker/makefile.mk	Tue Feb 23 15:33:37 2010 +0100
@@ -77,9 +77,6 @@
 		 $(SLO)$/customcontrolfactory.obj\
 		 $(SLO)$/dialogcustomcontrols.obj\
 		 $(SLO)$/asyncrequests.obj\
-		 $(SLO)$/VistaFilePickerEventHandler.obj\
-		 $(SLO)$/VistaFilePickerImpl.obj\
-		 $(SLO)$/VistaFilePicker.obj\
 		 $(SLO)$/SolarMutex.obj
 
 # --- Targets ------------------------------------------------------
diff -r a230682fb6d7 scp2/source/activex/makefile.mk
--- scp2/source/activex/makefile.mk	Sat Feb 20 01:07:32 2010 +0100
+++ scp2/source/activex/makefile.mk	Tue Feb 23 15:33:37 2010 +0100
@@ -47,12 +47,6 @@
 
 SCP_PRODUCT_TYPE=osl
 
-.IF "$(GUI)"=="WNT"
-PARFILES= \
-        module_activex.par        \
-        file_activex.par
-.ENDIF
-
 ULFFILES= \
         module_activex.ulf
 
diff -r a230682fb6d7 vcl/win/source/gdi/salnativewidgets-luna.cxx
--- vcl/win/source/gdi/salnativewidgets-luna.cxx	Sat Feb 20 01:07:32 2010 +0100
+++ vcl/win/source/gdi/salnativewidgets-luna.cxx	Tue Feb 23 15:33:37 2010 +0100
@@ -1109,7 +1109,9 @@
                 bRet = TRUE;
         }
     }
-    
+
+// building with vista sdk?
+#if defined(EP_BACKGROUNDWITHBORDER)
     if( (nType == CTRL_LISTBOX || nType == CTRL_COMBOBOX ) && nPart == PART_ENTIRE_CONTROL )
     {
         HTHEME hTheme = getThemeHandle( mhWnd, L"Combobox");
@@ -1165,6 +1167,7 @@
             }
         }
     }
+#endif
 
     ReleaseDC( mhWnd, hDC );
 	return( bRet );
