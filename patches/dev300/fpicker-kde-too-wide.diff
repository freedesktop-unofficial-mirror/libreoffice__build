From 97c6b97f73d9e026ac691e6dec3a7111fbc85456 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:59:03 +0200
Subject: [PATCH 351/878] fpicker-kde-too-wide.diff

---
 fpicker/source/unx/kde/kdefilepicker.cxx |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/fpicker/source/unx/kde/kdefilepicker.cxx b/fpicker/source/unx/kde/kdefilepicker.cxx
index 7953d40..3135aa9 100644
--- a/fpicker/source/unx/kde/kdefilepicker.cxx
+++ b/fpicker/source/unx/kde/kdefilepicker.cxx
@@ -70,6 +70,7 @@
 #include <qlayout.h>
 #include <qobjectlist.h>
 #include <qpushbutton.h>
+#include <qregexp.h>
 #include <qvbox.h>
 
 #ifdef QT_NO_EMIT
@@ -551,7 +552,11 @@ void FileDialog::appendFilter( const QString &rTitle, const QString &rFilter )
     QString qFilter( rFilter );
     qFilter.replace( QChar( ';' ), QChar( ' ' ) ).replace( "*.*", "*" );
 
-    m_aFilters.push_back( qMakePair( rTitle, qFilter ) );
+    // Workaround for too wide <All formats> (*.bmp;...) entry
+    QString qTitle( rTitle );
+    qTitle.replace( QRegExp( "^<([^>]*)> \\(.*" ), "<\\1>" );
+
+    m_aFilters.push_back( qMakePair( qTitle, qFilter ) );
 }
 
 QString FileDialog::filters() const
-- 
1.7.0.1

