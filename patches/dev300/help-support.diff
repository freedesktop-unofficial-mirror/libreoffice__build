From 4e92b1b4920f66902c193d59539ac5824ac0394b Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:57:34 +0200
Subject: [PATCH 269/878] help-support.diff

---
 sfx2/source/appl/appserv.cxx |   19 ++++++++++++++++++-
 1 files changed, 18 insertions(+), 1 deletions(-)

diff --git a/sfx2/source/appl/appserv.cxx b/sfx2/source/appl/appserv.cxx
index 7ab5160..752d3d1 100644
--- a/sfx2/source/appl/appserv.cxx
+++ b/sfx2/source/appl/appserv.cxx
@@ -68,6 +68,8 @@
 #include <tools/config.hxx>
 #include <tools/diagnose_ex.h>
 #include <vcl/msgbox.hxx>
+#include <com/sun/star/system/XSystemShellExecute.hpp>
+#include <com/sun/star/system/SystemShellExecuteFlags.hpp>
 #include <svtools/cancel.hxx>
 #include <svtools/intitem.hxx>
 #include <svtools/eitem.hxx>
@@ -342,9 +344,24 @@ void SfxApplication::MiscExec_Impl( SfxRequest& rReq )
             break;
         }
 
+        case SID_HELP_SUPPORTPAGE:
+        {
+            try {
+                Reference< com::sun::star::system::XSystemShellExecute > xSystemShell
+                    ( ::comphelper::getProcessServiceFactory()->createInstance( DEFINE_CONST_UNICODE("com.sun.star.system.SystemShellExecute" ) ), UNO_QUERY );
+                if ( xSystemShell.is()) {
+                    rtl::OUString aURI( DEFINE_CONST_UNICODE( "http://www.novell.com/support" ) );
+                    xSystemShell->execute( aURI, ::rtl::OUString(), com::sun::star::system::SystemShellExecuteFlags::DEFAULTS );
+                }
+
+                break;
+            } catch (const ::com::sun::star::uno::Exception &) {
+            }
+            /* drop through on exception */
+        }
+
         // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
         case SID_HELPINDEX:
-        case SID_HELP_SUPPORTPAGE:
         {
             Help* pHelp = Application::GetHelp();
             if ( pHelp )
-- 
1.7.0.1

