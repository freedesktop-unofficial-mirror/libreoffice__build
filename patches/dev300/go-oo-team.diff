From 57856ecee7ecc8523eb8f6058d80217173a6458c Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:57:24 +0200
Subject: [PATCH 231/768] go-oo-team.diff

---
 sw/inc/dochdl.hrc               |    5 ++++-
 sw/source/ui/dochdl/dochdl.src  |    9 +++++++++
 sw/source/ui/dochdl/gloshdl.cxx |   35 +++++++++++++++++++++++++++++++++++
 3 files changed, 48 insertions(+), 1 deletions(-)

diff --git sw/inc/dochdl.hrc sw/inc/dochdl.hrc
index b423351..adb0bd0 100644
--- sw/inc/dochdl.hrc
+++ sw/inc/dochdl.hrc
@@ -46,7 +46,10 @@
 #define BMP_SW_TEAM_MUGSHOT			(RC_DOCHDL_BEGIN + 12)
 #define STR_SW_TEAM_NAMES			(RC_DOCHDL_BEGIN + 13)
 
-#define DOCHDL_ACT_END              STR_SW_TEAM_NAMES
+#define BMP_GO_OO_TEAM_MUGSHOT			(RC_DOCHDL_BEGIN + 14)
+#define STR_GO_OO_TEAM_NAMES			(RC_DOCHDL_BEGIN + 25)
+
+#define DOCHDL_ACT_END              STR_GO_OO_TEAM_NAMES
 
 #if DOCHDL_ACT_END > RC_DOCHDL_END
 #error Resource-Id Ueberlauf in #file, #line
diff --git sw/source/ui/dochdl/dochdl.src sw/source/ui/dochdl/dochdl.src
index fb4db99..de1ba39 100644
--- sw/source/ui/dochdl/dochdl.src
+++ sw/source/ui/dochdl/dochdl.src
@@ -83,3 +83,12 @@ String STR_SW_TEAM_NAMES
     Text = "Back row: Aidan Butler, Hans-Peter Burow, Caolan McNamara, Michael Brauer, Martin Maher, Gunnar Timm\nFront row: Thomas Lange, Oliver-Rainer Duesterhoeft, Henning Brinkmann, Andreas Martens, Oliver Specht, Frank Meies, Daniel Vogelheim";
 };
 
+Bitmap BMP_GO_OO_TEAM_MUGSHOT
+{
+    File ="go-oo-team.bmp";
+};
+
+String STR_GO_OO_TEAM_NAMES
+{
+    TEXT = "From top left: Andreas, Bernhard, David, Dhananjay, Eric, Federico, Fong\nFridrich, Giuseppe, Hubert, Jakub, Jan, Jan, Jiao\nJody, Kai, Kalman, Kohei, Martin, Matthias, Michael\nMike, Miklos, Noel, Petr, Radek, Rene, Silvan\nThorsten, Tor, Volker, Yin, ZhangYun.\n";
+};
diff --git sw/source/ui/dochdl/gloshdl.cxx sw/source/ui/dochdl/gloshdl.cxx
index f51cfde..ff47cf2 100644
--- sw/source/ui/dochdl/gloshdl.cxx
+++ sw/source/ui/dochdl/gloshdl.cxx
@@ -642,6 +642,41 @@ BOOL SwGlossaryHdl::Expand( const String& rShortName,
                 pWrtShell->EndAllAction();
                 pWrtShell->EndUndo( UNDO_INSGLOSSARY );
             }
+                else if ( aShortName.EqualsAscii ( "GoOOTeam", 0, 14 ) )
+                {
+                    String sGraphicName ( RTL_CONSTASCII_USTRINGPARAM ( "Go-oo Team photo" ) );
+                    String sTeamCredits ( RTL_CONSTASCII_USTRINGPARAM ( "go-oo team credits" ) );
+                    pWrtShell->StartUndo ( UNDO_INSGLOSSARY );
+                    pWrtShell->StartAllAction();
+                    if(pWrtShell->HasSelection())
+                        pWrtShell->DelLeft();
+                    Bitmap aBitmap ( SW_RES ( BMP_GO_OO_TEAM_MUGSHOT ) );
+                    pWrtShell->Insert ( aEmptyStr, aEmptyStr, aBitmap);
+                    pWrtShell->SetFlyName ( sGraphicName );
+                    SwTxtFmtColl* pColl = pWrtShell->GetTxtCollFromPool ( RES_POOLCOLL_LABEL_ABB );
+                    const IDocumentFieldsAccess* pIDFA = pWrtShell->getIDocumentFieldsAccess();
+                    SwFieldType* pType = pIDFA->GetFldType( RES_SETEXPFLD, pColl->GetName(), false );
+                    sal_uInt16 nId = pIDFA->GetFldTypes()->GetPos( pType );
+                    pWrtShell->InsertLabel( LTYPE_OBJECT, aEmptyStr, aEmptyStr, aEmptyStr, FALSE, nId, aEmptyStr );
+                    pWrtShell->SwFEShell::SetFlyName( sTeamCredits );
+                    pWrtShell->SwFEShell::SelectObj ( Point ( ULONG_MAX, ULONG_MAX ) );
+                    pWrtShell->EnterStdMode();
+                    pWrtShell->EndPara ( TRUE );
+                    String aTmp ( SW_RES ( STR_GO_OO_TEAM_NAMES ) );
+                    pWrtShell->Insert ( aTmp );
+                    SvxAdjustItem aAdjustItem( SVX_ADJUST_CENTER, RES_PARATR_ADJUST );
+                    pWrtShell->SetAttr( aAdjustItem );
+                    pWrtShell->SttPara ();
+                    pWrtShell->SplitNode();
+                    pWrtShell->Left(CRSR_SKIP_CHARS, FALSE, 1, FALSE );
+                    SvxWeightItem aWeightItem ( WEIGHT_BOLD, RES_CHRATR_WEIGHT );
+                    pWrtShell->Insert ( String ( RTL_CONSTASCII_USTRINGPARAM ( "The go-oo.org team!" ) ) );
+                    pWrtShell->SttPara ( TRUE );
+                    pWrtShell->SetAttr( aWeightItem);
+                    pWrtShell->GotoFly ( sTeamCredits);
+                    pWrtShell->EndAllAction();
+                    pWrtShell->EndUndo( UNDO_INSGLOSSARY );
+                }
             else
             {
                 String aTmp( SW_RES(STR_NOGLOS));
-- 
1.7.0.1

