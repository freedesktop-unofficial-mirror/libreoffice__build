From 363145ce82c8ba8614a627b8e075d021160f2050 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:55:35 +0200
Subject: [PATCH 141/768] sc-print-lines.diff

---
 sc/source/core/data/column2.cxx |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git sc/source/core/data/column2.cxx sc/source/core/data/column2.cxx
index 39a22ac..a16cb77 100644
--- sc/source/core/data/column2.cxx
+++ sc/source/core/data/column2.cxx
@@ -1316,6 +1316,10 @@ BOOL ScColumn::IsEmpty() const
 
 BOOL ScColumn::IsEmptyBlock(SCROW nStartRow, SCROW nEndRow, bool bIgnoreNotes) const
 {
+    Rectangle aRect;
+    if (pAttrArray->HasLines(nStartRow, nEndRow, aRect, TRUE, TRUE))
+        return FALSE;
+
     if ( nCount == 0 || !pItems )
         return TRUE;
 
-- 
1.7.0.1

