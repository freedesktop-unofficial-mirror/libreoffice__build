From cb0ec35b0539074474f60e65f46c93d85bb2d682 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:55:35 +0200
Subject: [PATCH 165/878] sc-print-lines.diff

---
 sc/source/core/data/column2.cxx |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/sc/source/core/data/column2.cxx b/sc/source/core/data/column2.cxx
index 0c0a124..4ca26bc 100644
--- a/sc/source/core/data/column2.cxx
+++ b/sc/source/core/data/column2.cxx
@@ -1316,6 +1316,10 @@ BOOL ScColumn::IsEmpty() const
 
 BOOL ScColumn::IsEmptyBlock(SCROW nStartRow, SCROW nEndRow, bool bIgnoreNotes) const
 {
+    Rectangle aRect;
+    if (pAttrArray->HasLines(nStartRow, nEndRow, aRect, TRUE, TRUE))
+        return FALSE;
+
     if ( nCount == 0 || !pItems )
         return TRUE;
 
-- 
1.7.0.1

