From 3095108b5207f9e464230b0f2734b88677c095e1 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:07:15 +0200
Subject: [PATCH 754/878] toolkit-proper-erase-fix.diff

---
 toolkit/source/layout/core/box-base.cxx |    5 +++--
 toolkit/source/layout/core/box-base.hxx |    2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/toolkit/source/layout/core/box-base.cxx b/toolkit/source/layout/core/box-base.cxx
index 48619c8..ec54089 100644
--- a/toolkit/source/layout/core/box-base.cxx
+++ b/toolkit/source/layout/core/box-base.cxx
@@ -104,15 +104,16 @@ Box_Base::addChild (uno::Reference <awt::XLayoutConstrains> const& xChild)
 }
 
 Box_Base::ChildData*
-Box_Base::removeChildData( std::list< ChildData* > lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
+Box_Base::removeChildData( std::list< ChildData* >& lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
 {
     for ( std::list< ChildData* >::iterator it = lst.begin();
           it != lst.end(); it++ )
     {
         if ( (*it)->mxChild == xChild )
         {
+            ChildData* pRet = *it;
             lst.erase( it );
-            return *it;
+            return pRet;
         }
     }
     return 0;
diff --git a/toolkit/source/layout/core/box-base.hxx b/toolkit/source/layout/core/box-base.hxx
index eb70474..78b75fa 100644
--- a/toolkit/source/layout/core/box-base.hxx
+++ b/toolkit/source/layout/core/box-base.hxx
@@ -62,7 +62,7 @@ protected:
     virtual ChildData *createChild( css::uno::Reference< css::awt::XLayoutConstrains > const& xChild ) = 0;
     virtual ChildProps *createChildProps( ChildData* pData ) = 0;
     
-    ChildData *removeChildData( std::list< ChildData *>, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
+    ChildData *removeChildData( std::list< ChildData *>&, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
     
 public:
     void AddChild( const css::uno::Reference< css::awt::XLayoutConstrains >& Child);
-- 
1.7.0.1

