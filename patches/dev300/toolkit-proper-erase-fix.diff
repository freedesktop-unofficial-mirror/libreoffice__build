From 3e6d1d8ae6f682e4fffb2f2dc1e461e733a0b2f7 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:07:15 +0200
Subject: [PATCH 663/768] toolkit-proper-erase-fix.diff

---
 toolkit/source/layout/core/box-base.cxx |    5 +++--
 toolkit/source/layout/core/box-base.hxx |    2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git toolkit/source/layout/core/box-base.cxx toolkit/source/layout/core/box-base.cxx
index 4b8155a..a174f54 100644
--- toolkit/source/layout/core/box-base.cxx
+++ toolkit/source/layout/core/box-base.cxx
@@ -104,15 +104,16 @@ Box_Base::addChild (uno::Reference <awt::XLayoutConstrains> const& xChild)
 }
 
 Box_Base::ChildData*
-Box_Base::removeChildData( std::list< ChildData* > lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
+Box_Base::removeChildData( std::list< ChildData* >& lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
 {
     for ( std::list< ChildData* >::iterator it = lst.begin();
           it != lst.end(); it++ )
     {
         if ( (*it)->mxChild == xChild )
         {
+            ChildData* pRet = *it;
             lst.erase( it );
-            return *it;
+            return pRet;
         }
     }
     return 0;
diff --git toolkit/source/layout/core/box-base.hxx toolkit/source/layout/core/box-base.hxx
index 4399a84..894a24d 100644
--- toolkit/source/layout/core/box-base.hxx
+++ toolkit/source/layout/core/box-base.hxx
@@ -62,7 +62,7 @@ protected:
     virtual ChildData *createChild( css::uno::Reference< css::awt::XLayoutConstrains > const& xChild ) = 0;
     virtual ChildProps *createChildProps( ChildData* pData ) = 0;
     
-    ChildData *removeChildData( std::list< ChildData *>, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
+    ChildData *removeChildData( std::list< ChildData *>&, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
     
 public:
     void AddChild( const css::uno::Reference< css::awt::XLayoutConstrains >& Child);
-- 
1.7.0.1

