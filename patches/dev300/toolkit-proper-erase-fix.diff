Backup ptr before erasing from list fix

From: dcb314@openoffice.org


---

 toolkit/source/layout/core/box-base.cxx |    5 +++--
 toolkit/source/layout/core/box-base.hxx |    2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)


diff --git toolkit/source/layout/core/box-base.cxx toolkit/source/layout/core/box-base.cxx
index f03cd5c..37b02b2 100644
--- toolkit/source/layout/core/box-base.cxx
+++ toolkit/source/layout/core/box-base.cxx
@@ -108,15 +108,16 @@ Box_Base::addChild (uno::Reference <awt::XLayoutConstrains> const& xChild)
 }
 
 Box_Base::ChildData*
-Box_Base::removeChildData( std::list< ChildData* > lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
+Box_Base::removeChildData( std::list< ChildData* >& lst, css::uno::Reference< css::awt::XLayoutConstrains > const& xChild )
 {
     for ( std::list< ChildData* >::iterator it = lst.begin();
           it != lst.end(); it++ )
     {
         if ( (*it)->mxChild == xChild )
         {
+            ChildData* pRet = *it;
             lst.erase( it );
-            return *it;
+            return pRet;
         }
     }
     return 0;
diff --git toolkit/source/layout/core/box-base.hxx toolkit/source/layout/core/box-base.hxx
index 67365a3..f6d84c5 100644
--- toolkit/source/layout/core/box-base.hxx
+++ toolkit/source/layout/core/box-base.hxx
@@ -66,7 +66,7 @@ protected:
     virtual ChildData *createChild( css::uno::Reference< css::awt::XLayoutConstrains > const& xChild ) = 0;
     virtual ChildProps *createChildProps( ChildData* pData ) = 0;
     
-    ChildData *removeChildData( std::list< ChildData *>, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
+    ChildData *removeChildData( std::list< ChildData *>&, css::uno::Reference< css::awt::XLayoutConstrains > const& Child );
     
 public:
     void AddChild( const css::uno::Reference< css::awt::XLayoutConstrains >& Child);
