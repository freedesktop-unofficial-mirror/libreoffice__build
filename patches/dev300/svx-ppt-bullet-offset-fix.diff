---
 filter/source/msfilter/msdffimp.cxx |   15 +++++++++++----
 filter/source/msfilter/svdfppt.cxx  |   15 +++++++++++++++
 2 files changed, 26 insertions(+), 4 deletions(-)

diff --git filter/source/msfilter/msdffimp.cxx filter/source/msfilter/msdffimp.cxx
index ca3a353..ff1ce87 100644
--- filter/source/msfilter/msdffimp.cxx
+++ filter/source/msfilter/msdffimp.cxx
@@ -4161,18 +4161,25 @@ FASTBOOL SvxMSDffManager::ReadObjText(SvStream& rSt, SdrObject* pObj) const
                             UINT16 nLen = (UINT16)aHd.nRecLen;
                             if(nLen)
                             {
+                UINT32 nMask;
                                 UINT16 nVal1, nVal2, nVal3;
                                 UINT16 nDefaultTab = 2540; // PPT def: 1 Inch //rOutliner.GetDefTab();
                                 UINT16 nMostrightTab = 0;
                                 SfxItemSet aSet(rOutliner.GetEmptyItemSet());
                                 SvxTabStopItem aTabItem(0, 0, SVX_TAB_ADJUST_DEFAULT, EE_PARA_TABS);
 
-                                rSt >> nVal1;
-                                rSt >> nVal2;
+                                rSt >> nMask;
                                 nLen -= 4;
 
+                                if(nLen && (nMask & 0x0002))
+                {
+                    // number of indent levels
+                    rSt >> nVal3;
+                                    nLen -= 2;
+                }
+
                                 // Allg. TAB verstellt auf Wert in nVal3
-                                if(nLen && (nVal1 & 0x0001))
+                                if(nLen && (nMask & 0x0001))
                                 {
                                     rSt >> nVal3;
                                     nLen -= 2;
@@ -4180,7 +4187,7 @@ FASTBOOL SvxMSDffManager::ReadObjText(SvStream& rSt, SdrObject* pObj) const
                                 }
 
                                 // Weitere, frei gesetzte TABs
-                                if(nLen && (nVal1 & 0x0004))
+                                if(nLen && (nMask & 0x0004))
                                 {
                                     rSt >> nVal1;
                                     nLen -= 2;
diff --git filter/source/msfilter/svdfppt.cxx filter/source/msfilter/svdfppt.cxx
index 0224cdc..c27e196 100644
--- filter/source/msfilter/svdfppt.cxx
+++ filter/source/msfilter/svdfppt.cxx
@@ -4775,6 +4775,10 @@ PPTTextRulerInterpreter::PPTTextRulerInterpreter( UINT32 nFileOfs, SdrPowerPoint
             sal_Int16	nTCount;
             sal_Int32	i;
             rIn >> mpImplRuler->nFlags;
+
+        // number of indent levels, unused now
+            if ( mpImplRuler->nFlags & 2 )
+                rIn >> nTCount;
             if ( mpImplRuler->nFlags & 1 )
                 rIn >> mpImplRuler->nDefaultTab;
             if ( mpImplRuler->nFlags & 4 )
@@ -4797,6 +4801,17 @@ PPTTextRulerInterpreter::PPTTextRulerInterpreter( UINT32 nFileOfs, SdrPowerPoint
                     rIn >> mpImplRuler->nTextOfs[ i ];
                 if ( mpImplRuler->nFlags & ( 256 << i ) )
                     rIn >> mpImplRuler->nBulletOfs[ i ];
+        if( mpImplRuler->nBulletOfs[ i ] > 0x7fff) {
+            // workaround
+            // when bullet offset is > 0x7fff, the paragraph should look like
+            // *    first line text
+            // second line text
+            //
+            // we add to bullet para indent 0xffff - bullet offset. it looks like
+            // best we can do for now
+            mpImplRuler->nTextOfs[ i ] += 0xffff - mpImplRuler->nBulletOfs[ i ];
+            mpImplRuler->nBulletOfs[ i ] = 0;
+        }
             }
         }
         rIn.Seek( nOldPos );
-- 
1.7.0.1

