From d3d84b7428831c7414b323991177936d90dba8d2 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:53:38 +0200
Subject: [PATCH 046/768] wpsimport-filter.diff

---
 filter/source/config/fragments/fcfg_writer.mk      |    2 ++
 .../source/config/fragments/filters/MS_Works.xcu   |   13 +++++++++++++
 .../fragments/types/writer_MS_Works_Document.xcu   |   12 ++++++++++++
 3 files changed, 27 insertions(+), 0 deletions(-)
 create mode 100644 filter/source/config/fragments/filters/MS_Works.xcu
 create mode 100644 filter/source/config/fragments/types/writer_MS_Works_Document.xcu

diff --git filter/source/config/fragments/fcfg_writer.mk filter/source/config/fragments/fcfg_writer.mk
index 2207880..005a970 100644
--- filter/source/config/fragments/fcfg_writer.mk
+++ filter/source/config/fragments/fcfg_writer.mk
@@ -18,6 +18,7 @@ T4_WRITER = \
     writer_Rich_Text_Format \
     writer_StarOffice_XML_Writer \
     writer_WordPerfect_Document \
+    writer_MS_Works_Document \
     writer_T602_Document \
     writer_Text \
     writer_Text_encoded \
@@ -48,6 +49,7 @@ F4_WRITER = \
     Rich_Text_Format \
     StarOffice_XML__Writer_ \
     WordPerfect \
+    MS_Works \
     T602Document \
     Text \
     Text__encoded_ \
diff --git filter/source/config/fragments/filters/MS_Works.xcu filter/source/config/fragments/filters/MS_Works.xcu
new file mode 100644
index 0000000..29d11f7
--- /dev/null
+++ filter/source/config/fragments/filters/MS_Works.xcu
@@ -0,0 +1,13 @@
+    <node oor:name="MS_Works" oor:op="replace">
+        <prop oor:name="Flags"><value>IMPORT ALIEN USESOPTIONS 3RDPARTYFILTER</value></prop>
+        <prop oor:name="UIComponent"/>
+        <prop oor:name="FilterService"><value>com.sun.star.comp.Writer.MSWorksImportFilter</value></prop>
+        <prop oor:name="UserData"><value>WPS</value></prop>
+        <prop oor:name="UIName">
+            <value xml:lang="x-default">Microsoft Works Document</value>
+        </prop>
+        <prop oor:name="FileFormatVersion"><value>0</value></prop>
+        <prop oor:name="Type"><value>writer_MS_Works_Document</value></prop>
+        <prop oor:name="TemplateName"/>
+        <prop oor:name="DocumentService"><value>com.sun.star.text.TextDocument</value></prop>
+    </node>
diff --git filter/source/config/fragments/types/writer_MS_Works_Document.xcu filter/source/config/fragments/types/writer_MS_Works_Document.xcu
new file mode 100644
index 0000000..0b074d8
--- /dev/null
+++ filter/source/config/fragments/types/writer_MS_Works_Document.xcu
@@ -0,0 +1,12 @@
+    <node oor:name="writer_MS_Works_Document" oor:op="replace" >
+        <prop oor:name="DetectService"><value>com.sun.star.comp.Writer.MSWorksImportFilter</value></prop>
+        <prop oor:name="URLPattern"/>
+        <prop oor:name="Extensions"><value>wps</value></prop>
+        <prop oor:name="MediaType"/>
+        <prop oor:name="Preferred"><value>true</value></prop>
+        <prop oor:name="PreferredFilter"><value>MS_Works</value></prop>
+        <prop oor:name="UIName">
+            <value>Microsoft Works Document</value>
+        </prop>
+        <prop oor:name="ClipboardFormat"/>
+    </node>
-- 
1.7.0.1

