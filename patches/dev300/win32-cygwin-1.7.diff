From bad82aee1ea0b3c48a60961a78c3de7bd3ff0a53 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:05:24 +0200
Subject: [PATCH 669/878] win32-cygwin-1.7.diff

---
 packimages/pack/makefile.mk             |    2 +-
 solenv/bin/modules/installer/control.pm |    7 ++++++-
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/packimages/pack/makefile.mk b/packimages/pack/makefile.mk
index 0f0036b..f63450d 100644
--- a/packimages/pack/makefile.mk
+++ b/packimages/pack/makefile.mk
@@ -96,7 +96,7 @@ $(MISC)$/oxygen.flag : $(OXYGEN_TARBALL)
 
 # unpack the classic icon set
 $(MISC)$/classic.flag : $(CLASSIC_TARBALL)
-    cd $(MISC) && gunzip -c $(CLASSIC_TARBALL) | ( tar -xf - ) && $(TOUCH) $(@:f)
+    cd $(MISC) && gunzip -d -c $(CLASSIC_TARBALL) | ( tar -xf - ) && $(TOUCH) $(@:f)
 .IF "$(GUI)"=="UNX"
     chmod -R g+w $(MISC)$/classic
 .ENDIF
diff --git a/solenv/bin/modules/installer/control.pm b/solenv/bin/modules/installer/control.pm
index ab7a0db..28f72bf 100644
--- a/solenv/bin/modules/installer/control.pm
+++ b/solenv/bin/modules/installer/control.pm
@@ -87,9 +87,14 @@ sub check_system_path
     
     if( $^O =~ /cygwin/i )
     {	# When using cygwin's perl the PATH variable is POSIX style and ...
-        $pathvariable = qx{cygpath -mp "$pathvariable"} ;
+        my $temparrayref = installer::converter::convert_stringlist_into_array_without_newline(\$pathvariable, $local_pathseparator);
+        foreach $i (0..$#$temparrayref) {
+            $$temparrayref[$i] = qx{cygpath -m "$$temparrayref[$i]"};
+            chomp($$temparrayref[$i]);
+        }
         # has to be converted to DOS style for further use.
         $local_pathseparator = ';';
+        $pathvariable = join($local_pathseparator, @$temparrayref);
     }
     my $patharrayref = installer::converter::convert_stringlist_into_array(\$pathvariable, $local_pathseparator);
     
-- 
1.7.0.1

