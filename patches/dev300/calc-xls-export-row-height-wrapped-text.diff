From fef86be0aed964eec1d20780c793de51d5ace3f6 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:57:03 +0200
Subject: [PATCH 241/878] calc-xls-export-row-height-wrapped-text.diff

---
 sc/source/filter/excel/xetable.cxx |    9 +++------
 1 files changed, 3 insertions(+), 6 deletions(-)

diff --git a/sc/source/filter/excel/xetable.cxx b/sc/source/filter/excel/xetable.cxx
index fcd4fb0..a998e1d 100644
--- a/sc/source/filter/excel/xetable.cxx
+++ b/sc/source/filter/excel/xetable.cxx
@@ -1832,13 +1832,10 @@ XclExpRow::XclExpRow( const XclExpRoot& rRoot, sal_uInt16 nXclRow,
 
     // *** Row height *** -----------------------------------------------------
 
-    if (bUserHeight)
-        mnHeight = GetDoc().GetRowHeight(nScRow, nScTab, false);
-    else
-        mnHeight = EXC_ROW_DEFAULTHEIGHT;
+    // Always get the actual row height even if the manual size flag is not set,
+    // to correctly export the heights of rows with wrapped texts.
 
-    // #76250# not usable in Applix
-//    ::set_flag( mnHeight, EXC_ROW_FLAGDEFHEIGHT, !bUserHeight );
+    mnHeight = GetDoc().GetRowHeight(nScRow, nScTab, false);
 
     // *** Outline data *** ---------------------------------------------------
 
-- 
1.7.0.1

