From ae7d178bb66f341bb0af237fa134b0a9de8344ba Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:01:00 +0200
Subject: [PATCH 437/878] kde4-oxygen-icons.diff

---
 .../schema/org/openoffice/Office/Common.xcs        |    5 +++++
 packimages/pack/makefile.mk                        |   12 +++++++++++-
 scp2/source/ooo/file_ooo.scp                       |    7 +++++++
 scp2/source/ooo/module_hidden_ooo.scp              |    1 +
 svtools/inc/imgdef.hxx                             |    3 ++-
 svtools/source/config/miscopt.cxx                  |    2 ++
 svx/source/cui/optgdlg.cxx                         |    3 +++
 svx/source/cui/optgdlg.src                         |    1 +
 vcl/inc/vcl/settings.hxx                           |    3 ++-
 vcl/source/app/settings.cxx                        |    5 +++++
 10 files changed, 39 insertions(+), 3 deletions(-)

diff --git a/officecfg/registry/schema/org/openoffice/Office/Common.xcs b/officecfg/registry/schema/org/openoffice/Office/Common.xcs
index 865ab6b..578575a 100644
--- a/officecfg/registry/schema/org/openoffice/Office/Common.xcs
+++ b/officecfg/registry/schema/org/openoffice/Office/Common.xcs
@@ -5787,6 +5787,11 @@ Dymamic border coloring means that when the mouse is hovered over a control, and
 							<desc>Classic - the OpenOffice.org 2.0 default theme</desc>
 						</info>
 					</enumeration>
+                    <enumeration oor:value="oxygen">
+                        <info>
+                            <desc>Oxygen - the KDE4 default theme</desc>
+                        </info>
+                    </enumeration>
 				</constraints>
 				<value>auto</value>
 			</prop>
diff --git a/packimages/pack/makefile.mk b/packimages/pack/makefile.mk
index b88f63e..0f0036b 100644
--- a/packimages/pack/makefile.mk
+++ b/packimages/pack/makefile.mk
@@ -37,13 +37,14 @@ RSCCUSTOMIMG*=$(PRJ)
 IMAGES := $(COMMONBIN)$/images.zip
 SORTED_LIST=$(RES)$/img$/sorted.lst
 # Custom sets, at 24x24 & 16x16 fall-back to industrial preferentially
-CUSTOM_IMAGE_SETS=hicontrast industrial crystal tango classic
+CUSTOM_IMAGE_SETS=hicontrast industrial crystal tango classic oxygen
 CUSTOM_IMAGES+=$(foreach,i,$(CUSTOM_IMAGE_SETS) images_$i)
 CUSTOM_PREFERRED_FALLBACK_1*=-c $(SOLARSRC)$/ooo_custom_images$/tango
 CUSTOM_PREFERRED_FALLBACK_2*=-c $(SOLARSRC)$/ooo_custom_images$/industrial
 
 CRYSTAL_TARBALL=$(SOLARSRC)$/external_images$/ooo_crystal_images-1.tar.gz
 CLASSIC_TARBALL=$(SOLARSRC)$/ooo_custom_images$/classic/classic_images.tar.gz
+OXYGEN_TARBALL=$(SOLARSRC)$/external_images$/ooo_oxygen_images.tar.gz
 
 ALLTAR : $(IMAGES) $(CUSTOM_IMAGES) $(COMMONBIN)$/images_brand.zip
 
@@ -85,6 +86,14 @@ $(MISC)$/crystal.flag : $(CRYSTAL_TARBALL)
 .ENDIF
     @$(TYPE) $@ || echo "ERROR: unpacking $(CRYSTAL_TARBALL) failed"
 
+# unpack the Oxygen icon set
+$(MISC)$/oxygen.flag : $(OXYGEN_TARBALL)
+    cd $(MISC) && gzip -d -c $(OXYGEN_TARBALL) | ( tar -xf - ) && $(TOUCH) $(@:f)
+.IF "$(GUI)"=="UNX"
+    chmod -R g+w $(MISC)$/oxygen
+.ENDIF
+    @$(TYPE) $@ || echo "ERROR: unpacking $(OXYGEN_TARBALL) failed"
+
 # unpack the classic icon set
 $(MISC)$/classic.flag : $(CLASSIC_TARBALL)
     cd $(MISC) && gunzip -c $(CLASSIC_TARBALL) | ( tar -xf - ) && $(TOUCH) $(@:f)
@@ -100,3 +109,4 @@ images_crystal : $(MISC)$/crystal.flag $(RES)$/img$/commandimagelist.ilst
 
 images_classic : $(MISC)$/classic.flag $(RES)$/img$/commandimagelist.ilst
 
+images_oxygen : $(MISC)$/oxygen.flag $(RES)$/img$/commandimagelist.ilst
diff --git a/scp2/source/ooo/file_ooo.scp b/scp2/source/ooo/file_ooo.scp
index 3284cdc..3b42c83 100755
--- a/scp2/source/ooo/file_ooo.scp
+++ b/scp2/source/ooo/file_ooo.scp
@@ -2900,6 +2900,13 @@ File gid_File_ImagesCrystal_Zip
     Styles = (PACKED);
 End
 
+File gid_File_ImagesOxygen_Zip
+    TXT_FILE_BODY;
+    Dir = gid_Dir_Share_Config;
+    Name = "images_oxygen.zip";
+    Styles = (PACKED);
+End
+
 File gid_File_ImagesHicontrast_Zip
     TXT_FILE_BODY;
     Dir = gid_Dir_Share_Config;
diff --git a/scp2/source/ooo/module_hidden_ooo.scp b/scp2/source/ooo/module_hidden_ooo.scp
index 487687c..dcdc97c 100644
--- a/scp2/source/ooo/module_hidden_ooo.scp
+++ b/scp2/source/ooo/module_hidden_ooo.scp
@@ -864,6 +864,7 @@ Module gid_Module_Root_Files_Images
 	Styles = (HIDDEN_ROOT);
 	Files = (gid_File_Images_Zip,
              gid_File_ImagesCrystal_Zip,
+             gid_File_ImagesOxygen_Zip,
              gid_File_ImagesHicontrast_Zip,
              gid_File_ImagesIndustrial_Zip,
              gid_File_ImagesTango_Zip,
diff --git a/svtools/inc/imgdef.hxx b/svtools/inc/imgdef.hxx
index bd54ce4..d05e7d5 100644
--- a/svtools/inc/imgdef.hxx
+++ b/svtools/inc/imgdef.hxx
@@ -43,7 +43,8 @@ enum SfxSymbolsStyle
     SFX_SYMBOLS_STYLE_INDUSTRIAL,
     SFX_SYMBOLS_STYLE_CRYSTAL,
     SFX_SYMBOLS_STYLE_TANGO,
-    SFX_SYMBOLS_STYLE_CLASSIC
+    SFX_SYMBOLS_STYLE_CLASSIC,
+    SFX_SYMBOLS_STYLE_OXYGEN
 };
 
 #define SFX_TOOLBOX_CHANGESYMBOLSET		0x0001
diff --git a/svtools/source/config/miscopt.cxx b/svtools/source/config/miscopt.cxx
index e894269..a8efee3 100644
--- a/svtools/source/config/miscopt.cxx
+++ b/svtools/source/config/miscopt.cxx
@@ -272,6 +272,7 @@ static sal_Int16 implSymbolsStyleFromVCL( ULONG nStyle )
         case STYLE_SYMBOLS_CRYSTAL:    return SFX_SYMBOLS_STYLE_CRYSTAL;
         case STYLE_SYMBOLS_TANGO:      return SFX_SYMBOLS_STYLE_TANGO;
         case STYLE_SYMBOLS_CLASSIC:    return SFX_SYMBOLS_STYLE_CLASSIC;
+        case STYLE_SYMBOLS_OXYGEN:     return SFX_SYMBOLS_STYLE_OXYGEN;
     }
 
     return SFX_SYMBOLS_STYLE_AUTO;
@@ -288,6 +289,7 @@ static ULONG implSymbolsStyleToVCL( sal_Int16 nStyle )
         case SFX_SYMBOLS_STYLE_CRYSTAL:    return STYLE_SYMBOLS_CRYSTAL;
         case SFX_SYMBOLS_STYLE_TANGO:      return STYLE_SYMBOLS_TANGO;
         case SFX_SYMBOLS_STYLE_CLASSIC:    return STYLE_SYMBOLS_CLASSIC;
+        case SFX_SYMBOLS_STYLE_OXYGEN:     return STYLE_SYMBOLS_OXYGEN;
     }
 
     return STYLE_SYMBOLS_AUTO;
diff --git a/svx/source/cui/optgdlg.cxx b/svx/source/cui/optgdlg.cxx
index e6c18ee..fe09556 100644
--- a/svx/source/cui/optgdlg.cxx
+++ b/svx/source/cui/optgdlg.cxx
@@ -794,6 +794,7 @@ OfaViewTabPage::OfaViewTabPage(Window* pParent, const SfxItemSet& rSet ) :
             case STYLE_SYMBOLS_TANGO:       aAutoStr += aIconStyleLB.GetEntry( 4 ); break;
             case STYLE_SYMBOLS_CLASSIC:     aAutoStr += aIconStyleLB.GetEntry( 5 ); break;
             case STYLE_SYMBOLS_HICONTRAST:  aAutoStr += aIconStyleLB.GetEntry( 6 ); break;
+            case STYLE_SYMBOLS_OXYGEN:      aAutoStr += aIconStyleLB.GetEntry( 7 ); break;
         }
 
         aIconStyleLB.RemoveEntry( 0 );
@@ -887,6 +888,7 @@ BOOL OfaViewTabPage::FillItemSet( SfxItemSet& )
             case 4: eSet = SFX_SYMBOLS_STYLE_CRYSTAL;    break;
             case 5: eSet = SFX_SYMBOLS_STYLE_TANGO;      break;
             case 6: eSet = SFX_SYMBOLS_STYLE_CLASSIC;    break;
+            case 7: eSet = SFX_SYMBOLS_STYLE_OXYGEN;     break;
             default:
                 DBG_ERROR( "OfaViewTabPage::FillItemSet(): This state of aIconStyleLB should not be possible!" );
         }
@@ -1071,6 +1073,7 @@ void OfaViewTabPage::Reset( const SfxItemSet& )
             case SFX_SYMBOLS_STYLE_CRYSTAL:    nStyleLB_InitialSelection = 4; break;
             case SFX_SYMBOLS_STYLE_TANGO:      nStyleLB_InitialSelection = 5; break;
             case SFX_SYMBOLS_STYLE_CLASSIC:    nStyleLB_InitialSelection = 6; break;
+            case SFX_SYMBOLS_STYLE_OXYGEN:     nStyleLB_InitialSelection = 7; break;
             default:                           nStyleLB_InitialSelection = 0; break;
         }
     }
diff --git a/svx/source/cui/optgdlg.src b/svx/source/cui/optgdlg.src
index 077a349..575e38d 100644
--- a/svx/source/cui/optgdlg.src
+++ b/svx/source/cui/optgdlg.src
@@ -248,6 +248,7 @@ TabPage OFA_TP_VIEW
             < "Crystal" ; > ;
             < "Tango" ; > ;
             < "Classic" ; > ;
+            < "Oxygen" ; > ;
         };
     };
     CheckBox CB_SYSTEM_FONT
diff --git a/vcl/inc/vcl/settings.hxx b/vcl/inc/vcl/settings.hxx
index 70120d0..d537be5 100644
--- a/vcl/inc/vcl/settings.hxx
+++ b/vcl/inc/vcl/settings.hxx
@@ -520,7 +520,8 @@ private:
 #define STYLE_SYMBOLS_CRYSTAL		((ULONG)4)
 #define STYLE_SYMBOLS_TANGO		((ULONG)5)
 #define STYLE_SYMBOLS_CLASSIC		((ULONG)6)
-#define STYLE_SYMBOLS_THEMES_MAX	((ULONG)6)
+#define STYLE_SYMBOLS_OXYGEN		((ULONG)7)
+#define STYLE_SYMBOLS_THEMES_MAX	((ULONG)7)
 
 #define STYLE_CURSOR_NOBLINKTIME    ((ULONG)0xFFFFFFFF)
 
diff --git a/vcl/source/app/settings.cxx b/vcl/source/app/settings.cxx
index 92fb0cc..e5c3593 100644
--- a/vcl/source/app/settings.cxx
+++ b/vcl/source/app/settings.cxx
@@ -704,6 +704,7 @@ void StyleSettings::Set3DColors( const Color& rColor )
         case STYLE_SYMBOLS_CRYSTAL:    return ::rtl::OUString::createFromAscii( "crystal" );
         case STYLE_SYMBOLS_TANGO:      return ::rtl::OUString::createFromAscii( "tango" );
         case STYLE_SYMBOLS_CLASSIC:    return ::rtl::OUString::createFromAscii( "classic" );
+        case STYLE_SYMBOLS_OXYGEN:     return ::rtl::OUString::createFromAscii( "oxygen" );
     }
 
     return ::rtl::OUString::createFromAscii( "auto" );
@@ -725,6 +726,8 @@ ULONG StyleSettings::ImplNameToSymbolsStyle( const ::rtl::OUString &rName ) cons
         return STYLE_SYMBOLS_TANGO;
     else if ( rName == ::rtl::OUString::createFromAscii( "classic" ) )
         return STYLE_SYMBOLS_CLASSIC;
+    else if ( rName == ::rtl::OUString::createFromAscii( "oxygen" ) )
+        return STYLE_SYMBOLS_OXYGEN;
 
     return STYLE_SYMBOLS_AUTO;
 }
@@ -820,6 +823,8 @@ ULONG StyleSettings::GetAutoSymbolsStyle() const
             nRet = STYLE_SYMBOLS_TANGO;
         else if( rDesktopEnvironment.equalsIgnoreAsciiCaseAscii( "kde" ) )
             nRet = STYLE_SYMBOLS_CRYSTAL;
+        else if( rDesktopEnvironment.equalsIgnoreAsciiCaseAscii( "kde4" ) )
+            nRet = STYLE_SYMBOLS_OXYGEN;
     }
 
     return nRet;
-- 
1.7.0.1

