--- config_office/configure.in	2008-03-17 12:31:19.000000000 +0100
+++ config_office/configure.in	2008-03-17 12:38:18.000000000 +0100
@@ -440,6 +440,9 @@
 AC_ARG_WITH(system-xrender,
 [  --with-system-xrender-headers  Use XRender headers already on system
 ],,)
+AC_ARG_WITH(system-mesa-headers,
+[  --with-system-mesa-headers     Use Mesa headers already on system
+],,)
 AC_ARG_WITH(system-curl,
 [  --with-system-curl      Use curl already on system
 ],,)
@@ -4472,6 +4475,20 @@
 AC_SUBST(XRENDER_LINK)
 
 dnl ===================================================================
+dnl Check for system Mesa
+dnl ===================================================================
+AC_MSG_CHECKING([which Mesa headers to use])
+if test "$with_system_mesa_headers" == "no"; then
+   AC_MSG_RESULT([internal])
+   SYSTEM_MESA_HEADERS=NO
+   BUILD_TYPE="$BUILD_TYPE MESA"
+else
+   AC_MSG_RESULT([external])
+   SYSTEM_MESA_HEADERS=YES
+fi
+AC_SUBST(SYSTEM_MESA_HEADERS)
+
+dnl ===================================================================
 dnl Check for building neon
 dnl ===================================================================
 AC_MSG_CHECKING([whether to use neon])
--- config_office/set_soenv.in	2008-03-17 12:31:19.000000000 +0100
+++ config_office/set_soenv.in	2008-03-17 12:38:55.000000000 +0100
@@ -2043,6 +2043,7 @@
 ToFile( "LIBXSLT_LIBS",      "@LIBXSLT_LIBS@",     "e" );
 ToFile( "SYSTEM_SANE_HEADER","@SYSTEM_SANE_HEADER@","e" );
 ToFile( "SYSTEM_XRENDER_HEADERS","@SYSTEM_XRENDER_HEADERS@","e" );
+ToFile( "SYSTEM_MESA_HEADERS","@SYSTEM_MESA_HEADERS@","e" );
 ToFile( "SYSTEM_CURL",       "@SYSTEM_CURL@",      "e" );
 ToFile( "CURL_CFLAGS",       "@CURL_CFLAGS@",      "e" );
 ToFile( "CURL_LIBS",         "@CURL_LIBS@",        "e" );
