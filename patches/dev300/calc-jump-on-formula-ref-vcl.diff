From e60e1a1949782b0a0fe537e307aff44b9774d8e6 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:07 +0200
Subject: [PATCH 192/878] calc-jump-on-formula-ref-vcl.diff

---
 vcl/inc/vcl/keycodes.hxx        |    2 ++
 vcl/unx/gtk/window/gtkframe.cxx |    2 ++
 vcl/unx/source/app/saldisp.cxx  |   14 ++++++++++++++
 vcl/win/source/app/salinst.cxx  |    2 ++
 4 files changed, 20 insertions(+), 0 deletions(-)

diff --git a/vcl/inc/vcl/keycodes.hxx b/vcl/inc/vcl/keycodes.hxx
index f8b9ef1..7ea7a43 100644
--- a/vcl/inc/vcl/keycodes.hxx
+++ b/vcl/inc/vcl/keycodes.hxx
@@ -155,6 +155,8 @@
 #define KEY_DECIMAL     ((USHORT)::com::sun::star::awt::Key::DECIMAL)
 #define KEY_TILDE       ((USHORT)::com::sun::star::awt::Key::TILDE)
 #define KEY_QUOTELEFT   ((USHORT)::com::sun::star::awt::Key::QUOTELEFT)
+#define KEY_BRACKETLEFT ((USHORT)::com::sun::star::awt::Key::BRACKETLEFT)
+#define KEY_BRACKETRIGHT ((USHORT)::com::sun::star::awt::Key::BRACKETRIGHT)
 
 #define KEY_CODE		((USHORT)0x0FFF)
 
diff --git a/vcl/unx/gtk/window/gtkframe.cxx b/vcl/unx/gtk/window/gtkframe.cxx
index a88493a..55c6107 100644
--- a/vcl/unx/gtk/window/gtkframe.cxx
+++ b/vcl/unx/gtk/window/gtkframe.cxx
@@ -211,6 +211,8 @@ static USHORT GetKeyCode( guint keyval )
             case GDK_asciitilde:	nCode = KEY_TILDE;		break;
             case GDK_leftsinglequotemark:
             case GDK_quoteleft:	nCode = KEY_QUOTELEFT;		break;           
+            case GDK_bracketleft:  nCode = KEY_BRACKETLEFT;  break;
+            case GDK_bracketright: nCode = KEY_BRACKETRIGHT; break;
             // some special cases, also see saldisp.cxx
             // - - - - - - - - - - - - -  Apollo - - - - - - - - - - - - - 0x1000
             case 0x1000FF02: // apXK_Copy
diff --git a/vcl/unx/source/app/saldisp.cxx b/vcl/unx/source/app/saldisp.cxx
index 4b75a5e..e3548ee 100644
--- a/vcl/unx/source/app/saldisp.cxx
+++ b/vcl/unx/source/app/saldisp.cxx
@@ -1264,6 +1264,12 @@ XubString SalDisplay::GetKeyName( USHORT nKeyCode ) const
         case KEY_QUOTELEFT:
             nKeySym = XK_grave;
             break;
+        case KEY_BRACKETLEFT:
+            nKeySym = XK_bracketleft;
+            break;
+        case KEY_BRACKETRIGHT:
+            nKeySym = XK_bracketright;
+            break;
 
         default:
             nKeySym = 0;
@@ -1594,6 +1600,14 @@ USHORT SalDisplay::GetKeyCode( KeySym keysym, char*pcPrintable ) const
             nKey = KEY_QUOTELEFT;
             *pcPrintable = '`';
             break;
+        case XK_bracketleft:
+            nKey = KEY_BRACKETLEFT;
+            *pcPrintable = '[';
+            break;
+         case XK_bracketright:
+             nKey = KEY_BRACKETRIGHT;
+             *pcPrintable = ']';
+             break;
 //      case XK_Linefeed:
 //          *pcPrintable = '\n';
 //          break;
diff --git a/vcl/win/source/app/salinst.cxx b/vcl/win/source/app/salinst.cxx
index 05b6b7e..0c4376b 100644
--- a/vcl/win/source/app/salinst.cxx
+++ b/vcl/win/source/app/salinst.cxx
@@ -375,6 +375,8 @@ void SalData::initKeyCodeMap()
     initKey( '=', KEY_EQUAL );
     initKey( '~', KEY_TILDE );
     initKey( '`', KEY_QUOTELEFT );
+    initKey( '[', KEY_BRACKETLEFT );
+    initKey( ']', KEY_BRACKETRIGHT );
 }
 
 // =======================================================================
-- 
1.7.0.1

