Fix for n#485645 - make .pps files auto-start the presentation

From: Thorsten Behrens <thb@openoffice.org>


---

 sd/source/ui/docshell/docshel4.cxx |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)


diff --git sd/source/ui/docshell/docshel4.cxx sd/source/ui/docshell/docshel4.cxx
index 6e91127..97d8b29 100644
--- sd/source/ui/docshell/docshel4.cxx
+++ sd/source/ui/docshell/docshel4.cxx
@@ -503,6 +503,11 @@ BOOL DrawDocShell::ConvertFrom( SfxMedium& rMedium )
 	{
 		mpDoc->StopWorkStartupDelay();
         bRet = SdPPTFilter( rMedium, *this, sal_True ).Import();
+        if (rMedium.GetURLObject().getExtension().equalsIgnoreAsciiCaseAscii("pps"))
+        {
+			bStartPresentation = true;
+			mpDoc->SetStartWithPresentation( true );
+        }
 	}
 	else if (aFilterName.SearchAscii("impress8" )  != STRING_NOTFOUND ||
 		     aFilterName.SearchAscii("draw8")  != STRING_NOTFOUND )
