From 36814dfe483c5b7bf402ca1163c3b35628227fd9 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:58:44 +0200
Subject: [PATCH 333/878] vcl-better-fallback.diff

---
 vcl/unx/source/plugadapt/salplug.cxx |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/vcl/unx/source/plugadapt/salplug.cxx b/vcl/unx/source/plugadapt/salplug.cxx
index 872d136..bae9c22 100644
--- a/vcl/unx/source/plugadapt/salplug.cxx
+++ b/vcl/unx/source/plugadapt/salplug.cxx
@@ -213,9 +213,11 @@ SalInstance *CreateSalInstance()
     if( ! pInst )
         pInst = autodetect_plugin();
     
-    // fallback to gen
-    if( ! pInst )
-        pInst = tryInstance( OUString( RTL_CONSTASCII_USTRINGPARAM( "gen" ) ) );
+    // fallback, try everything
+    const char* pPlugin[] = { "gtk", "kde", "gen", 0 };
+
+    for ( int i = 0; !pInst && pPlugin[ i ]; ++i )
+        pInst = tryInstance( OUString::createFromAscii( pPlugin[ i ] ) );
 
     if( ! pInst )
     {
-- 
1.7.0.1

