diff --git a/sc/inc/dpobject.hxx b/sc/inc/dpobject.hxx
index af87cbe..282db21 100644
--- sc/inc/dpobject.hxx
+++ sc/inc/dpobject.hxx
@@ -106,6 +106,7 @@ private:
 	ScDPOutput*				pOutput;
 	BOOL					bSettingsChanged;
 	BOOL					bAlive;			// FALSE if only used to hold settings
+	USHORT                                  nAutoFormatIndex;
 	BOOL					bAllowMove;
 	BOOL					bInfoValid;		// affects: nHeaderRows
 	long					nHeaderRows;	// page fields plus filter button
@@ -137,6 +138,9 @@ public:
 	void				SetOutRange(const ScRange& rRange);
 	const ScRange&		GetOutRange() const		{ return aOutRange; }
 
+	void 			SetAutoFormatIndex (const USHORT nIndex);
+	const USHORT		GetAutoFormatIndex ()	{ if (this == NULL) return 65535; else return nAutoFormatIndex; }
+
 	void				SetSheetDesc(const ScSheetSourceDesc& rDesc);
 	void				SetImportDesc(const ScImportSourceDesc& rDesc);
 	void				SetServiceData(const ScDPServiceDesc& rDesc);
diff --git a/sc/inc/sc.hrc b/sc/inc/sc.hrc
index 9f58a25..a17e56d 100644
--- sc/inc/sc.hrc
+++ sc/inc/sc.hrc
@@ -1646,6 +1646,8 @@
 #define SID_DATAFORM                (SC_OOO_BUILD_START + 2) // menu (in Data menu)
 #define RID_SCDLG_DATAFORM          (SC_OOO_BUILD_START + 3) // dialog
 
+// Autoformat for DataPilot
+#define SID_PIVOT_AFMT              (SC_OOO_BUILD_START + 4)
 
 
 
diff --git a/sc/sdi/pivotsh.sdi b/sc/sdi/pivotsh.sdi
index fed3a6a..7e2f418 100644
--- sc/sdi/pivotsh.sdi
+++ sc/sdi/pivotsh.sdi
@@ -34,6 +34,7 @@ interface Pivot
 	SID_PIVOT_RECALC	[ ExecMethod = Execute; StateMethod = GetState; Export = FALSE; ]
 	SID_PIVOT_KILL		[ ExecMethod = Execute; StateMethod = GetState; Export = FALSE; ]
         SID_DP_FILTER           [ ExecMethod = Execute; StateMethod = GetState; Export = FALSE; ]
+	SID_PIVOT_AFMT		[ ExecMethod = Execute; StateMethod = GetState; Export = FALSE; ]
 }
 
 shell ScPivotShell
diff --git a/sc/sdi/scalc.sdi b/sc/sdi/scalc.sdi
index f6cc119..b728021 100644
--- sc/sdi/scalc.sdi
+++ sc/sdi/scalc.sdi
@@ -1900,6 +1900,31 @@ SfxVoidItem DeletePivotTable SID_PIVOT_KILL
 	GroupId = GID_DATA;
 ]
 
+SfxVoidItem AutoFormatPivotTable SID_PIVOT_AFMT
+()
+[
+        /* flags: */
+        AutoUpdate = FALSE,
+        Cachable = Cachable,
+        FastCall = FALSE,
+        HasCoreId = FALSE,
+        HasDialog = FALSE,
+        ReadOnlyDoc = TRUE,
+        Toggle = FALSE,
+        Container = FALSE,
+        RecordAbsolute = FALSE,
+        RecordPerSet;
+        Synchron;
+                                                                                                                             
+        /* config: */
+        AccelConfig = FALSE,
+        MenuConfig = TRUE,
+        StatusBarConfig = FALSE,
+        ToolBoxConfig = FALSE,
+        GroupId = GID_DATA;
+]
+
+
 //--------------------------------------------------------------------------
 SfxVoidItem DeletePrintArea SID_DELETE_PRINTAREA
 ()
diff --git a/sc/source/core/data/dpobject.cxx b/sc/source/core/data/dpobject.cxx
index d534160..67edc4d 100644
--- sc/source/core/data/dpobject.cxx
+++ sc/source/core/data/dpobject.cxx
@@ -160,6 +160,7 @@ ScDPObject::ScDPObject( ScDocument* pD ) :
 	pImpDesc( NULL ),
 	pServDesc( NULL ),
 	pOutput( NULL ),
+	nAutoFormatIndex( 65535 ),
 	bSettingsChanged( FALSE ),
 	bAlive( FALSE ),
 	bAllowMove( FALSE ),
@@ -175,6 +176,7 @@ ScDPObject::ScDPObject(const ScDPObject& r) :
 	aTableName( r.aTableName ),
 	aTableTag( r.aTableTag ),
 	aOutRange( r.aOutRange ),
+	nAutoFormatIndex( r.nAutoFormatIndex ),
 	pSheetDesc( NULL ),
 	pImpDesc( NULL ),
 	pServDesc( NULL ),
@@ -231,6 +233,11 @@ void ScDPObject::SetSaveData(const ScDPSaveData& rData)
 	InvalidateData();		// re-init source from SaveData
 }
 
+void ScDPObject::SetAutoFormatIndex(const USHORT nIndex)
+{
+	nAutoFormatIndex	= nIndex;
+}
+
 void ScDPObject::SetOutRange(const ScRange& rRange)
 {
 	aOutRange = rRange;
diff --git a/sc/source/ui/docshell/dbdocfun.cxx b/sc/source/ui/docshell/dbdocfun.cxx
index e9e1b7e..78d6e28 100644
--- sc/source/ui/docshell/dbdocfun.cxx
+++ sc/source/ui/docshell/dbdocfun.cxx
@@ -1369,6 +1369,36 @@ BOOL ScDBDocFunc::DataPilotUpdate( ScDPObject* pOldObj, const ScDPObject* pNewOb
 	delete pNewUndoDoc;
 	delete pUndoDPObj;
 
+	if (const_cast<ScDPObject *>(pNewObj)->GetAutoFormatIndex() != 65535)
+	{
+		ScViewData* pViewData = rDocShell.GetViewData();
+  		ScDocument* pDoc = pViewData->GetDocument();
+		rDocShell.GetViewData()->GetViewShell()->GetDBData( TRUE, SC_DB_OLD );
+		const ScMarkData& rMark1 = pViewData->GetMarkData();
+		SCCOL nStartCol;
+		SCROW nStartRow;
+		SCTAB nStartTab;
+		SCCOL nEndCol;
+		SCROW nEndRow;
+		SCTAB nEndTab;
+
+		rDocShell.GetViewData()->GetSimpleArea( nStartCol,nStartRow,nStartTab,nEndCol,nEndRow,nEndTab );
+		ScRange Outrange = pNewObj->GetOutRange();
+		if (( (Outrange.aStart.Col() <= nStartCol) && (nStartCol <= Outrange.aEnd.Col() )&& (nStartTab == Outrange.aStart.Tab()))
+			&& ( (Outrange.aStart.Row() <= nStartRow) && (nStartRow <= Outrange.aEnd.Row() )) )
+			{
+		
+			if ( !rMark1.IsMarked() && !rMark1.IsMultiMarked() )
+				rDocShell.GetViewData()->GetViewShell()->MarkDataArea( TRUE );
+			//FIXME: Autoformat even when clicked from a non-dp cell.
+			pViewData->MoveNextRow();		
+			rDocShell.GetViewData()->GetViewShell()->AutoFormat( const_cast<ScDPObject *>(pNewObj)->GetAutoFormatIndex());
+			rDocShell.GetViewData()->GetViewShell()->AutoFormatPivotTable( const_cast<ScDPObject *>(pNewObj), const_cast<ScDPObject *>(pNewObj)->GetAutoFormatIndex() );		
+			pViewData->MovePrevRow();
+			}
+	}
+
+
 	if (bDone)
 		aModificator.SetDocumentModified();
 
diff --git a/sc/source/ui/inc/dbfunc.hxx b/sc/source/ui/inc/dbfunc.hxx
index 0e46f3f..2e4bf9f 100644
--- sc/source/ui/inc/dbfunc.hxx
+++ sc/source/ui/inc/dbfunc.hxx
@@ -90,6 +90,8 @@ public:
 									const ScDPObject& rSource, BOOL bApi = FALSE );
 	void			DeletePivotTable();
 	void			RecalcPivotTable();
+        void                    AutoFormatPivotTable(USHORT nIndex);
+        void            	AutoFormatPivotTable(ScDPObject*        pDPObj, USHORT nIndex);
 
     BOOL            HasSelectionForDateGroup( ScDPNumGroupInfo& rOldInfo, sal_Int32& rParts );
     BOOL            HasSelectionForNumGroup( ScDPNumGroupInfo& rOldInfo );
diff --git a/sc/source/ui/inc/viewdata.hxx b/sc/source/ui/inc/viewdata.hxx
index 12e59bd..3e48121 100644
--- sc/source/ui/inc/viewdata.hxx
+++ sc/source/ui/inc/viewdata.hxx
@@ -331,6 +331,10 @@ public:
 
 	ScMarkType      GetSimpleArea( SCCOL& rStartCol, SCROW& rStartRow, SCTAB& rStartTab,
 									SCCOL& rEndCol, SCROW& rEndRow, SCTAB& rEndTab ) const;
+
+    void            MoveNextRow();
+    void            MovePrevRow();
+
 	ScMarkType      GetSimpleArea( ScRange& rRange ) const;
                     /// May modify rNewMark using MarkToSimple().
     ScMarkType      GetSimpleArea( ScRange & rRange, ScMarkData & rNewMark ) const;
diff --git a/sc/source/ui/miscdlgs/makefile.mk b/sc/source/ui/miscdlgs/makefile.mk
index 3569ccf..bb81bba 100644
--- sc/source/ui/miscdlgs/makefile.mk
+++ sc/source/ui/miscdlgs/makefile.mk
@@ -117,7 +117,9 @@ LIB1OBJFILES =  \
 	$(SLO)$/redcom.obj			\
 	$(SLO)$/warnbox.obj         \
 	$(SLO)$/conflictsdlg.obj    \
-	$(SLO)$/sharedocdlg.obj
+	$(SLO)$/sharedocdlg.obj     \
+	$(SLO)$/scuiautofmt.obj			\
+	$(SLO)$/strindlg.obj            
 
 # --- Tagets -------------------------------------------------------
 
diff --git a/sc/source/ui/src/popup.src b/sc/source/ui/src/popup.src
index ba9508c..b576003 100644
--- sc/source/ui/src/popup.src
+++ sc/source/ui/src/popup.src
@@ -206,6 +206,84 @@ Menu RID_POPUP_PIVOT
 			Text [ en-US ] = "~Start..." ;
 		};
 		MenuItem
+                {
+                        Identifier = SID_PIVOT_AFMT ;
+                        HelpId = SID_PIVOT_AFMT ;
+			Text [ en-US ] = "~AutoFormat..." ; 
+                        Text [ de ] = "A~utoFormat" ;
+			Text [ af ] = "OutoFormateer..." ;
+			Text [ ar ] = "تنسيق تلقائي..." ;
+			Text [ as-IN ] = "স্বয়ংক্ৰিয় ফৰমেট ..." ;
+			Text [ be-BY ] = "Аўта-фармат..." ;
+			Text [ bg ] = "Автоформат..." ;
+			Text [ br ] = "EmVentrezhañ..." ;
+			Text [ bs ] = "AutoFormat..." ;
+			Text [ ca ] = "Formatació automàtica..." ;
+			Text [ cs ] = "Automatický formát..." ;
+			Text [ cy ] = "AwtoFformat..." ;
+			Text [ da ] = "Autoformat..." ;
+			Text [ el ] = "Αυτόματη μορφοποίηση..." ;
+			Text [ en-GB ] = "AutoFormat..." ;
+			Text [ en-ZA ] = "AutoFormat..." ;
+			Text [ eo ] = "Aŭtomate Formati..." ;
+			Text [ es ] = "Formateado automático..." ;
+			Text [ et ] = "Automaatvormindus..." ;
+			Text [ fa ] = "قالب‌بندی خودکار..." ;
+			Text [ fi ] = "Automaattinen muotoilu..." ;
+			Text [ fr ] = "AutoFormat..." ;
+			Text [ ga ] = "UathFhormáidigh..." ;
+			Text [ gu ] = "આપોઆપબંધારણ..." ;
+			Text [ gu-IN ] = "આપોઆપબંધારણ..." ;
+			Text [ hi-IN ] = "स्वचालित ढंग से रचना..." ;
+			Text [ hr ] = "SamoOblikovanje..." ;
+			Text [ hu ] = "Automatikus formázás..." ;
+			Text [ it ] = "Formattazione automatica..." ;
+			Text [ ja ] = "オートフォーマット..." ;
+			Text [ ka ] = "ავტო-ფორმატირება..." ;
+			Text [ km ] = "ទ្រង់ទ្រាយ​ស្វ័យប្រវត្តិ..." ;
+			Text [ ko ] = "자동 서식..." ;
+			Text [ ku ] = "TeşekirinaBixweber..." ;
+			Text [ lt ] = "Automatinis formatavimas..." ;
+			Text [ mk ] = "Автоматско форматирање..." ;
+			Text [ ml-IN ] = "സ്വയം രൂപപ്പെടുത്തുക..." ;
+			Text [ mr-IN ] = "स्वंयचलित रचना..." ;
+			Text [ nb ] = "Autoformatering..." ;
+			Text [ nl ] = "AutoOpmaak..." ;
+			Text [ nn ] = "Autoformatering..." ;
+			Text [ nr ] = "Fometha ngokuzenzakalela..." ;
+			Text [ ns ] = "Fomate ye e Itiragalelago..." ;
+			Text [ or-IN ] = "ସ୍ବଯଂଚାଳିତଫର୍ମାଟ..." ;
+			Text [ pa-IN ] = "ਸਵੈ-ਫਾਰਮਿਟ..." ;
+			Text [ pl ] = "Autoformatowanie..." ;
+			Text [ pt ] = "Formatação automática..." ;
+			Text [ pt-BR ] = "AutoFormatar..." ;
+			Text [ ru ] = "Автоформат..." ;
+			Text [ rw ] = "Nyamwihamiterere..." ;
+			Text [ sh-YU ] = "Automatsko formatiranje..." ;
+			Text [ sk ] = "Automatický formát..." ;
+			Text [ sl ] = "Samooblikovanje..." ;
+			Text [ sr-CS ] = "Аутоматско форматирање..." ;
+			Text [ ss ] = "Kutifomethekela..." ;
+			Text [ st ] = "Fomate e iketsahallang..." ;
+			Text [ sv ] = "Autoformat..." ;
+			Text [ sw-TZ ] = "AutoFormat..." ;
+			Text [ ta ] = "தானியக்க வடிவம்..." ;
+			Text [ ta-IN ] = "தானியக்க வடிவம்..." ;
+			Text [ te-IN ] = "స్వయంరూపలావణ్యం..." ;
+			Text [ tg ] = "Автоформат..." ;
+			Text [ th ] = "AutoFormat..." ;
+			Text [ tr ] = "Otomatik Biçimlendirme..." ;
+			Text [ ts ] = "Fomati yo tiendlekela hi yoxe..." ;
+			Text [ uk ] = "Автоформат..." ;
+			Text [ ur-IN ] = "خودکارطریقہ..." ;
+			Text [ ve ] = "OthoFomathi..." ;
+			Text [ vi ] = "Tự định dạng..." ;
+			Text [ xh ] = "Ulungiselelo Oluzenzekelayo..." ;
+			Text [ zh-CN ] = "自动格式..." ;
+			Text [ zh-TW ] = "自動格式..." ;
+			Text [ zu ] = "Isakhiwo esizenzekelayo..." ;
+		};
+		MenuItem
 		{
 			Identifier = SID_PIVOT_RECALC ;
 			HelpId = SID_PIVOT_RECALC ;
diff --git a/sc/source/ui/view/dbfunc3.cxx b/sc/source/ui/view/dbfunc3.cxx
index 9ac2287..05a7fbe 100644
--- sc/source/ui/view/dbfunc3.cxx
+++ sc/source/ui/view/dbfunc3.cxx
@@ -1968,7 +1968,29 @@ void ScDBFunc::RepeatDB( BOOL bRecord )
 	else		// "Keine Operationen auszufuehren"
 		ErrorMessage(STR_MSSG_REPEATDB_0);
 }
+void ScDBFunc::AutoFormatPivotTable(USHORT nIndex)
+{
+	ScDocShell* pDocSh  = GetViewData()->GetDocShell();
+	ScDocument* pDoc	= GetViewData()->GetDocument();
+
+	//	old pivot not used any more
+
+	ScDPObject*	pDPObj	= pDoc->GetDPAtCursor( GetViewData()->GetCurX(),
+												  GetViewData()->GetCurY(),
+												  GetViewData()->GetTabNo() );
+	if ( pDPObj )
+	{
+		pDPObj->SetAutoFormatIndex(nIndex);
+	}
+	else
+		ErrorMessage(STR_PIVOT_NOTFOUND);
 
+}
+
+void ScDBFunc::AutoFormatPivotTable(ScDPObject*	pDPObj, USHORT nIndex)
+{
+	pDPObj->SetAutoFormatIndex(nIndex);
+}
 
 
 
diff --git a/sc/source/ui/view/pivotsh.cxx b/sc/source/ui/view/pivotsh.cxx
index 19b694f..ccfa022 100644
--- sc/source/ui/view/pivotsh.cxx
+++ sc/source/ui/view/pivotsh.cxx
@@ -56,6 +56,12 @@
 #include "uiitems.hxx"
 //CHINA001 #include "pfiltdlg.hxx"
 #include "scabstdlg.hxx" //CHINA001
+
+#include "autoform.hxx"
+#include "scuiautofmt.hxx"
+#include "editable.hxx"
+
+
 //------------------------------------------------------------------------
 
 #define ScPivotShell
@@ -99,13 +105,56 @@ void ScPivotShell::Execute( SfxRequest& rReq )
 {
 	switch ( rReq.GetSlot() )
 	{
-		case SID_PIVOT_RECALC:
-			pViewShell->RecalcPivotTable();
-			break;
+		case SID_PIVOT_AFMT:
+			{
+			ScViewData* pViewData = pViewShell->GetViewData();
+
+			pViewShell->GetDBData( TRUE, SC_DB_OLD );
+			const ScMarkData& rMark1 = pViewData->GetMarkData();
+			if ( !rMark1.IsMarked() && !rMark1.IsMultiMarked() )
+				pViewShell->MarkDataArea( TRUE );
+			
+			Window* pDlgParent = pViewShell->GetDialogParent();
+			
+			pViewData->MoveNextRow();
+				
+			ScGlobal::ClearAutoFormat();
+			ScAutoFormatData* pNewEntry = pViewShell->CreateAutoFormatData();
+			ScAutoFormatDlg*  pDlg		= new ScAutoFormatDlg(
+													pDlgParent,
+													ScGlobal::GetAutoFormat(),
+				                                                               pNewEntry,
+                            				                                   pViewShell->GetViewData()->GetDocument() );
 
+			if ( pDlg->Execute() == RET_OK )
+			{
+				ScEditableTester aTester( pViewShell );
+				if ( !aTester.IsEditable() )
+				{
+					pViewShell->ErrorMessage(aTester.GetMessageId());
+				}
+				else
+				{
+					/* AutoFormat and Store the index */
+					pViewShell->AutoFormat( pDlg->GetIndex() );
+					pViewShell->AutoFormatPivotTable( pDlg->GetIndex() );
+				}
+			}
+			delete pDlg;
+			delete pNewEntry;
+
+
+			//pViewShell->DeletePivotTable();
+			//pViewShell->RecalcPivotTable();
+			break;
+			}
 		case SID_PIVOT_KILL:
 			pViewShell->DeletePivotTable();
 			break;
+		case SID_PIVOT_RECALC:
+			//pViewShell->DeletePivotTable();
+			pViewShell->RecalcPivotTable();
+			break;
 
         case SID_DP_FILTER:
         {
diff --git a/sc/source/ui/view/viewdata.cxx b/sc/source/ui/view/viewdata.cxx
index 21d548e..d1e4463 100644
--- sc/source/ui/view/viewdata.cxx
+++ sc/source/ui/view/viewdata.cxx
@@ -670,6 +670,22 @@ void ScViewData::RefreshZoom()
 	aLogicMode.SetScaleY( GetZoomY() );
 }
 
+void ScViewData::MoveNextRow()
+{
+      ScRange aMarkRange;
+      aMarkData.GetMarkArea(aMarkRange);
+      aMarkRange.aStart.Set(aMarkRange.aStart.Col(), aMarkRange.aStart.Row() +1, aMarkRange.aStart.Tab());
+      aMarkData.SetMarkArea(aMarkRange);
+}
+
+void ScViewData::MovePrevRow()
+{
+      ScRange aMarkRange;
+      aMarkData.GetMarkArea(aMarkRange);
+      aMarkRange.aStart.Set(aMarkRange.aStart.Col(), aMarkRange.aStart.Row() -1, aMarkRange.aStart.Tab());
+      aMarkData.SetMarkArea(aMarkRange);
+}
+
 void ScViewData::SetPagebreakMode( BOOL bSet )
 {
 	bPagebreak = bSet;
