diff --git sc/source/ui/view/cellsh2.cxx sc/source/ui/view/cellsh2.cxx
index d2e5e61..554cdf9 100644
--- sc/source/ui/view/cellsh2.cxx
+++ sc/source/ui/view/cellsh2.cxx
@@ -737,7 +737,8 @@ void ScCellShell::ExecuteDB( SfxRequest& rReq )
 						{
 							//!	use database ranges (select before type dialog?)
 							ScRange aRange;
-							if ( GetViewData()->GetSimpleArea( aRange ) == SC_MARK_SIMPLE )
+                            ScMarkType eType = GetViewData()->GetSimpleArea(aRange);
+                            if ( (eType & SC_MARK_SIMPLE) == SC_MARK_SIMPLE )
 							{
 								BOOL bOK = TRUE;
 								if ( pDoc->HasSubTotalCells( aRange ) )
