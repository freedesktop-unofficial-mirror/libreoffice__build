From 4b09a9ae74d6b1112feef6ac9f56a5cb022eb7bb Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:01:18 +0200
Subject: [PATCH 386/768] ooo73201.sw.a11yloadcrash.diff

---
 sw/source/core/layout/ssfrm.cxx |    9 +++++++++
 1 files changed, 9 insertions(+), 0 deletions(-)

diff --git sw/source/core/layout/ssfrm.cxx sw/source/core/layout/ssfrm.cxx
index b9a6365..1dad118 100644
--- sw/source/core/layout/ssfrm.cxx
+++ sw/source/core/layout/ssfrm.cxx
@@ -516,7 +516,16 @@ SwLayoutFrm::~SwLayoutFrm()
                 // --> OD 2004-06-30 #i28701#
                 SwAnchoredObject* pAnchoredObj = (*pFrm->GetDrawObjs())[0];
                 if ( pAnchoredObj->ISA(SwFlyFrm) )
+                {
+
+                    //cmc: flush any accessible events that might be related to
+                    //this object
+                    if (ViewShell *pSh = GetShell())
+                        if (SwViewImp *pImp = pSh ? pSh->Imp() : 0)
+                            pImp->FireAccessibleEvents();
+
                     delete pAnchoredObj;
+                }
                 else
                 {
                     SdrObject* pSdrObj = pAnchoredObj->DrawObj();
-- 
1.7.0.1

