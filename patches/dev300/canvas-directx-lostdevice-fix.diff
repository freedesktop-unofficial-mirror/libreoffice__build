diff -u -p -r1.5 dx_9rm.cxx
--- canvas/source/directx/dx_9rm.cxx	24 Jun 2008 10:30:05 -0000	1.5
+++ canvas/source/directx/dx_9rm.cxx	4 Dec 2008 00:20:35 -0000
@@ -956,11 +956,32 @@ namespace dxcanvas
 			{
 				if(hr != D3DERR_DEVICELOST)
 					return false;
+
+                mpVertexBuffer.reset();
 				hr = mpDevice->Reset(&mad3dpp);
 				if(SUCCEEDED(hr))
+                {
+                    IDirect3DVertexBuffer9 *pVB(NULL);
+                    DWORD aFVF(D3DFVF_XYZRHW|D3DFVF_DIFFUSE|D3DFVF_TEX1);
+                    if( FAILED(mpDevice->CreateVertexBuffer(sizeof(dxvertex)*maNumVertices,
+                                                            D3DUSAGE_DYNAMIC|D3DUSAGE_WRITEONLY,
+                                                            aFVF,
+                                                            D3DPOOL_DEFAULT,
+                                                            &pVB,
+                                                            NULL)) )
+                    {
+                        throw lang::NoSupportException(
+                            ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM(
+                                                 "Could not create DirectX device - out of memory!")),NULL);
+                    }
+                    mpVertexBuffer=COMReference<IDirect3DVertexBuffer9>(pVB);
+
 					return true;
+                }
+
 				if(hr == D3DERR_DEVICELOST)
 					return true;
+
 				return false;
 			}
 
