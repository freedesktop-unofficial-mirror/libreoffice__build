---
 sc/source/ui/view/gridwin.cxx |   19 ++++++++++++++++++-
 1 files changed, 18 insertions(+), 1 deletions(-)

diff --git sc/source/ui/view/gridwin.cxx sc/source/ui/view/gridwin.cxx
index 41cbc01..02fa9c8 100644
--- sc/source/ui/view/gridwin.cxx
+++ sc/source/ui/view/gridwin.cxx
@@ -140,6 +140,8 @@ const BYTE SC_NESTEDBUTTON_UP   = 2;
 #define SC_AUTOFILTER_ALL		0
 #define	SC_AUTOFILTER_TOP10     1
 #define	SC_AUTOFILTER_CUSTOM    2
+#define        SC_AUTOFILTER_EMPTY     3
+#define        SC_AUTOFILTER_NOTEMPTY  4
 
 //	Modi fuer die FilterListBox
 enum ScFilterBoxMode
@@ -915,7 +917,7 @@ void ScGridWindow::DoAutoFilterMenue( SCCOL nCol, SCROW nRow, BOOL bDataSelect )
         long nMaxText = 0;
 
         //	default entries
-        static const USHORT nDefIDs[] = { SCSTR_ALLFILTER, SCSTR_TOP10FILTER, SCSTR_STDFILTER };
+        static const USHORT nDefIDs[] = { SCSTR_ALLFILTER, SCSTR_TOP10FILTER, SCSTR_STDFILTER, SCSTR_EMPTY, SCSTR_NOTEMPTY };
         const USHORT nDefCount = sizeof(nDefIDs) / sizeof(USHORT);
         for (i=0; i<nDefCount; i++)
         {
@@ -1251,6 +1253,21 @@ void ScGridWindow::ExecFilter( ULONG nSel,
                         rNewEntry.eOp	= SC_TOPVAL;
                         *rNewEntry.pStr	= String::CreateFromAscii(RTL_CONSTASCII_STRINGPARAM("10"));
                     }
+                    else if (nSel == SC_AUTOFILTER_EMPTY)
+                    {
+                        rNewEntry.pStr->Erase();
+                        rNewEntry.bQueryByString = FALSE;
+                        rNewEntry.eOp	= SC_EQUAL;
+                        rNewEntry.nVal	= SC_EMPTYFIELDS;
+
+                    }
+                    else if (nSel == SC_AUTOFILTER_NOTEMPTY)
+                    {
+                        rNewEntry.pStr->Erase();
+                        rNewEntry.bQueryByString = FALSE;
+                        rNewEntry.eOp	= SC_EQUAL;
+                        rNewEntry.nVal	= SC_NONEMPTYFIELDS;
+                    }
                     else
                     {
                         rNewEntry.eOp	= SC_EQUAL;
-- 
1.7.0.1

