From 10079e29496cd0c6f3aa0e6689ab7d014344d0d7 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:08:02 +0200
Subject: [PATCH 794/878] calc-distributed-cell-text-xmloff.diff

---
 xmloff/inc/xmlnmspe.hxx         |    1 +
 xmloff/inc/xmloff/xmltoken.hxx  |    7 +++++++
 xmloff/source/core/xmlexp.cxx   |    6 ++++++
 xmloff/source/core/xmlimp.cxx   |    4 ++++
 xmloff/source/core/xmltoken.cxx |    6 ++++++
 5 files changed, 24 insertions(+), 0 deletions(-)

diff --git a/xmloff/inc/xmlnmspe.hxx b/xmloff/inc/xmlnmspe.hxx
index 1f175e3..a97a7ad 100644
--- a/xmloff/inc/xmlnmspe.hxx
+++ b/xmloff/inc/xmlnmspe.hxx
@@ -103,6 +103,7 @@ XML_OLD_NAMESPACE( META,	6U )
 // experimental namespaces
 XML_NAMESPACE( FIELD,			100U )
 XML_NAMESPACE( FORMX,           101U )      // form interop extensions
+XML_NAMESPACE( CSS3TEXT,        103U )      // CSS Text Level 3
 
 
 #endif	//  _XMLOFF_XMLNMSPE_HXX
diff --git a/xmloff/inc/xmloff/xmltoken.hxx b/xmloff/inc/xmloff/xmltoken.hxx
index 942c749..509da91 100644
--- a/xmloff/inc/xmloff/xmltoken.hxx
+++ b/xmloff/inc/xmloff/xmltoken.hxx
@@ -152,6 +152,10 @@ namespace xmloff { namespace token {
         XML_NP_FORMX,
         XML_N_FORMX,
 
+        // css text level 3
+        XML_NP_CSS3TEXT,
+        XML_N_CSS3TEXT,
+
         // units
         XML_UNIT_MM,
         XML_UNIT_M,
@@ -607,6 +611,7 @@ namespace xmloff { namespace token {
         XML_DISTANCE,
         XML_DISTANCE_AFTER_SEP,
         XML_DISTANCE_BEFORE_SEP,
+        XML_DISTRIBUTE,
         XML_DISTRIBUTE_LETTER,
         XML_DISTRIBUTE_SPACE,
         XML_DIVIDE,
@@ -1780,6 +1785,7 @@ namespace xmloff { namespace token {
         XML_TEXT_GLOBAL,
         XML_TEXT_INDENT,
         XML_TEXT_INPUT,
+        XML_TEXT_JUSTIFY,
         XML_TEXT_OUTLINE,
         XML_TEXT_POSITION,
         XML_TEXT_ROTATION_ANGLE,
@@ -1913,6 +1919,7 @@ namespace xmloff { namespace token {
         XML_VERSION_LIST,
         XML_VERTICAL,
         XML_VERTICAL_ALIGN,
+        XML_VERTICAL_JUSTIFY,
         XML_VERTICAL_LINES,
         XML_VERTICAL_POS,
         XML_VERTICAL_REL,
diff --git a/xmloff/source/core/xmlexp.cxx b/xmloff/source/core/xmlexp.cxx
index 961a65e..c39f089 100644
--- a/xmloff/source/core/xmlexp.cxx
+++ b/xmloff/source/core/xmlexp.cxx
@@ -356,6 +356,12 @@ void SvXMLExport::_InitCtor()
         mpNamespaceMap->Add( GetXMLToken(XML_NP_GRDDL),
             GetXMLToken(XML_N_GRDDL), XML_NAMESPACE_GRDDL );
     }
+    // CSS Text Level 3 for distributed text justification.
+    if ( (getExportFlags() & (EXPORT_STYLES|EXPORT_AUTOSTYLES|EXPORT_MASTERSTYLES)) != 0 )
+    {
+        mpNamespaceMap->Add(
+            GetXMLToken(XML_NP_CSS3TEXT), GetXMLToken(XML_N_CSS3TEXT), XML_NAMESPACE_CSS3TEXT );
+    }
 
     mxAttrList = (xml::sax::XAttributeList*)mpAttrList;
 
diff --git a/xmloff/source/core/xmlimp.cxx b/xmloff/source/core/xmlimp.cxx
index 096cae1..48deddf 100644
--- a/xmloff/source/core/xmlimp.cxx
+++ b/xmloff/source/core/xmlimp.cxx
@@ -119,6 +119,7 @@ sal_Char __READONLY_DATA sXML_np__xsd[] = "_xsd";
 sal_Char __READONLY_DATA sXML_np__xsi[] = "_xsi";
 sal_Char __READONLY_DATA sXML_np__field[] = "_field";
 sal_Char __READONLY_DATA sXML_np__xhtml[] = "_xhtml";
+sal_Char __READONLY_DATA sXML_np__css3text[] = "_css3text";
 
 sal_Char __READONLY_DATA sXML_np__fo_old[] = "__fo";
 sal_Char __READONLY_DATA sXML_np__xlink_old[] = "__xlink";
@@ -323,6 +324,9 @@ void SvXMLImport::_InitCtor()
         mpNamespaceMap->Add(
             OUString( RTL_CONSTASCII_USTRINGPARAM ( sXML_np__xhtml ) ),
             GetXMLToken(XML_N_XHTML), XML_NAMESPACE_XHTML );
+        mpNamespaceMap->Add(
+            OUString( RTL_CONSTASCII_USTRINGPARAM( sXML_np__css3text ) ),
+            GetXMLToken(XML_N_CSS3TEXT), XML_NAMESPACE_CSS3TEXT );
     }
 
     msPackageProtocol = OUString( RTL_CONSTASCII_USTRINGPARAM( "vnd.sun.star.Package:" ) );
diff --git a/xmloff/source/core/xmltoken.cxx b/xmloff/source/core/xmltoken.cxx
index e3b55cf..62478fd 100644
--- a/xmloff/source/core/xmltoken.cxx
+++ b/xmloff/source/core/xmltoken.cxx
@@ -160,6 +160,9 @@ namespace xmloff { namespace token {
         TOKEN( "formx",                           XML_NP_FORMX ),
         TOKEN( "urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0", XML_N_FORMX ),
 
+        TOKEN( "css3t",                        XML_NP_CSS3TEXT ),
+        TOKEN( "http://www.w3.org/TR/css3-text/", XML_N_CSS3TEXT ),
+
         // units
         TOKEN( "mm",                              XML_UNIT_MM ),
         TOKEN( "m",                               XML_UNIT_M ),
@@ -615,6 +618,7 @@ namespace xmloff { namespace token {
         TOKEN( "distance",                        XML_DISTANCE ),
         TOKEN( "distance-after-sep",              XML_DISTANCE_AFTER_SEP ),
         TOKEN( "distance-before-sep",             XML_DISTANCE_BEFORE_SEP ),
+        TOKEN( "distribute",                      XML_DISTRIBUTE ),
         TOKEN( "distribute-letter",               XML_DISTRIBUTE_LETTER ),
         TOKEN( "distribute-space",                XML_DISTRIBUTE_SPACE ),
         TOKEN( "divide",                          XML_DIVIDE ),
@@ -1788,6 +1792,7 @@ namespace xmloff { namespace token {
         TOKEN( "text-global",                     XML_TEXT_GLOBAL ),
         TOKEN( "text-indent",                     XML_TEXT_INDENT ),
         TOKEN( "text-input",                      XML_TEXT_INPUT ),
+        TOKEN( "text-justify",                    XML_TEXT_JUSTIFY ),
         TOKEN( "text-outline",                    XML_TEXT_OUTLINE ),
         TOKEN( "text-position",                   XML_TEXT_POSITION ),
         TOKEN( "text-rotation-angle",             XML_TEXT_ROTATION_ANGLE ),
@@ -1921,6 +1926,7 @@ namespace xmloff { namespace token {
         TOKEN( "version-list",                    XML_VERSION_LIST ),
         TOKEN( "vertical",                        XML_VERTICAL ),
         TOKEN( "vertical-align",                  XML_VERTICAL_ALIGN ),
+        TOKEN( "vertical-justify",                XML_VERTICAL_JUSTIFY ),
         TOKEN( "vertical-lines",                  XML_VERTICAL_LINES ),
         TOKEN( "vertical-pos",                    XML_VERTICAL_POS ),
         TOKEN( "vertical-rel",                    XML_VERTICAL_REL ),
-- 
1.7.0.1

