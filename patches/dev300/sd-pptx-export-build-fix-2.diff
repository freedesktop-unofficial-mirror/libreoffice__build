---
 sd/source/filter/pptx/pptx-eppt.cxx |    2 +-
 sd/util/makefile.mk                 |    1 +
 sd/util/pptx.map                    |    2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git sd/source/filter/pptx/pptx-eppt.cxx sd/source/filter/pptx/pptx-eppt.cxx
index 2ea5d57..061db2c 100644
--- sd/source/filter/pptx/pptx-eppt.cxx
+++ sd/source/filter/pptx/pptx-eppt.cxx
@@ -121,7 +121,7 @@ void PPTWriter::exportPPTPre()
     if ( !mpPicStrm )
         mpPicStrm = mrStg->OpenSotStream( String( RTL_CONSTASCII_USTRINGPARAM( "Pictures" ) ) );
 
-    mpPptEscherEx = new PptEscherEx( *mpStrm, mnDrawings );
+    mpPptEscherEx = new PptEscherEx( *mpStrm );
 };
 
 void PPTWriter::exportPPTPost()
diff --git sd/util/makefile.mk sd/util/makefile.mk
index 4483706..ed1396a 100755
--- sd/util/makefile.mk
+++ sd/util/makefile.mk
@@ -283,6 +283,7 @@ SHL6STDLIBS = $(ISDLIB) \
               $(SOTLIB)           \
               $(GOODIESLIB)       \
               $(VCLLIB)           \
+              $(MSFILTERLIB)      \
               $(SVLLIB)           \
               $(SOTLIB)           \
               $(UNOTOOLSLIB)      \
diff --git sd/util/pptx.map sd/util/pptx.map
index e72a8e3..f9d5960 100644
--- sd/util/pptx.map
+++ sd/util/pptx.map
@@ -1,4 +1,4 @@
-PPTX_1_0 {
+UDK_3_0_0 {
         global:
                 component_getImplementationEnvironment;
                 component_writeInfo;
-- 
1.7.0.1

