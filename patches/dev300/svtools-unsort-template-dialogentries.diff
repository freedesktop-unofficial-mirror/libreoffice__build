--- svtools/inc/fileview.hxx.old	2010-07-22 13:49:22.000000000 +0200
+++ svtools/inc/fileview.hxx	2010-07-29 16:28:07.000000000 +0200
@@ -48,6 +48,7 @@
 #define FILEVIEW_SHOW_SIZE			0x0020
 #define FILEVIEW_SHOW_DATE			0x0040
 #define FILEVIEW_SHOW_ALL			0x0070
+#define FILEVIEW_SHOW_NONE			0x00A0
 
 class ViewTabListBox_Impl;
 class SvtFileView_Impl;
@@ -81,6 +82,7 @@ class SVT_DLLPUBLIC SvtFileView : public
 {
 private:
     SvtFileView_Impl*       mpImp;
+    sal_Bool 				bSortColumn;
     
     ::com::sun::star::uno::Sequence< ::rtl::OUString > mpBlackList;
 
@@ -109,6 +111,8 @@ public:
     void					SetSizePixel( const Size& rNewSize );
     using Window::SetPosSizePixel;
     virtual void			SetPosSizePixel( const Point& rNewPos, const Size& rNewSize );
+    void					SetSortColumn( sal_Bool bValue ) { bSortColumn = bValue; }
+    sal_Bool				GetSortColumn() { return bSortColumn; }
 
     /** initialize the view with the content of a folder given by URL, and aply an immediate filter
 
--- svtools/source/contnr/fileview.cxx.old	2010-07-22 13:49:22.000000000 +0200
+++ svtools/source/contnr/fileview.cxx	2010-07-29 16:28:07.000000000 +0200
@@ -103,6 +103,8 @@ using ::rtl::OUString;
 
 DECLARE_LIST( StringList_Impl, OUString* )
 
+#define aSeparatorStr  "----------------------------------"
+
 #define ROW_HEIGHT                17    // the height of a row has to be a little higher than the bitmap
 #define QUICK_SEARCH_TIMEOUT    1500    // time in mSec before the quicksearch string will be reseted
 
@@ -755,6 +757,7 @@ ViewTabListBox_Impl::ViewTabListBox_Impl
     mbEnableRename      ( sal_True )
 
 {
+    sal_Bool bViewHeader = true;
     Size aBoxSize = pParentWin->GetSizePixel();
     mpHeaderBar = new HeaderBar( pParentWin, WB_BUTTONSTYLE | WB_BOTTOMBORDER );
     mpHeaderBar->SetPosSizePixel( Point( 0, 0 ), mpHeaderBar->CalcWindowSizePixel() );
@@ -767,6 +770,8 @@ ViewTabListBox_Impl::ViewTabListBox_Impl
         mpHeaderBar->InsertItem( COLUMN_SIZE, String( SvtResId( STR_SVT_FILEVIEW_COLUMN_SIZE ) ), 80, nBits );
         mpHeaderBar->InsertItem( COLUMN_DATE, String( SvtResId( STR_SVT_FILEVIEW_COLUMN_DATE ) ), 500, nBits );
     }
+    if( ( nFlags & FILEVIEW_SHOW_NONE ) == FILEVIEW_SHOW_NONE )
+        bViewHeader = false;
     else
         mpHeaderBar->InsertItem( COLUMN_TITLE, String( SvtResId( STR_SVT_FILEVIEW_COLUMN_TITLE ) ), 600, nBits );
 
@@ -778,7 +783,8 @@ ViewTabListBox_Impl::ViewTabListBox_Impl
     SetEntryHeight( ROW_HEIGHT );
 
     Show();
-    mpHeaderBar->Show();
+    if( bViewHeader )
+        mpHeaderBar->Show();
 
     maResetQuickSearch.SetTimeout( QUICK_SEARCH_TIMEOUT );
     maResetQuickSearch.SetTimeoutHdl( LINK( this, ViewTabListBox_Impl, ResetQuickSearch_Impl ) );
@@ -1252,6 +1258,7 @@ SvtFileView::SvtFileView( Window* pParen
 
     mpImp = new SvtFileView_Impl( this, xCmdEnv, nFlags, bOnlyFolder );
     mpImp->mpView->ForbidEmptyText();
+    SetSortColumn( true );
 
     long pTabs[] = { 5, 20, 180, 320, 400, 600 };
     mpImp->mpView->SetTabs( &pTabs[0], MAP_PIXEL );
@@ -1274,6 +1281,7 @@ SvtFileView::SvtFileView( Window* pParen
     Reference < XCommandEnvironment > xCmdEnv = new ::ucbhelper::CommandEnvironment( xInteractionHandler, Reference< XProgressHandler >() );
     mpImp = new SvtFileView_Impl( this, xCmdEnv, nFlags,
                                   ( nFlags & FILEVIEW_ONLYFOLDER ) == FILEVIEW_ONLYFOLDER );
+    SetSortColumn( true );
 
     if ( ( nFlags & FILEVIEW_SHOW_ALL ) == FILEVIEW_SHOW_ALL )
     {
@@ -1287,7 +1295,8 @@ SvtFileView::SvtFileView( Window* pParen
         long pTabs[] = { 2, 20, 600 };
         mpImp->mpView->SetTabs( &pTabs[0], MAP_PIXEL );
     }
-
+    if ( ( nFlags & FILEVIEW_SHOW_NONE ) == FILEVIEW_SHOW_NONE )
+        SetSortColumn( false );
     if ( ( nFlags & FILEVIEW_MULTISELECTION ) == FILEVIEW_MULTISELECTION )
         mpImp->mpView->SetSelectionMode( MULTIPLE_SELECTION );
 
@@ -1545,7 +1554,8 @@ sal_Bool SvtFileView::Initialize( const
 
     mpImp->Clear();
     mpImp->CreateVector_Impl( aContents );
-    mpImp->SortFolderContent_Impl();
+    if( GetSortColumn() )
+        mpImp->SortFolderContent_Impl();
 
     mpImp->OpenFolder_Impl();
 
@@ -2449,9 +2459,11 @@ void SvtFileView_Impl::CreateVector_Impl
         pEntry->maDisplayText = aDisplayText;
 
         // detect the image
-        INetURLObject aObj( pEntry->maImageURL.getLength() ? pEntry->maImageURL : pEntry->maTargetURL );
-        pEntry->maImage = SvFileInformationManager::GetImage( aObj, FALSE, isHighContrast( mpView ) );
-
+        if( aValue != rtl::OUString( RTL_CONSTASCII_USTRINGPARAM(aSeparatorStr) ) )
+        {
+            INetURLObject aObj( pEntry->maImageURL.getLength() ? pEntry->maImageURL : pEntry->maTargetURL );
+            pEntry->maImage = SvFileInformationManager::GetImage( aObj, FALSE, isHighContrast( mpView ) );
+        }
         maContent.push_back( pEntry );
     }
 }
--- svtools/source/contnr/templwin.cxx.old	2010-07-29 16:27:36.000000000 +0200
+++ svtools/source/contnr/templwin.cxx	2010-07-29 16:28:07.000000000 +0200
@@ -106,6 +106,7 @@ using namespace ::com::sun::star::view;
 using namespace svtools;
 
 extern ::rtl::OUString CreateExactSizeText_Impl( sal_Int64 nSize ); // fileview.cxx
+#define aSeparatorStr   "----------------------------------"
 
 #define SPLITSET_ID			0
 #define COLSET_ID			1
@@ -604,7 +605,7 @@ SvtFileViewWindow_Impl::SvtFileViewWindo
     Window( pParent, WB_DIALOGCONTROL | WB_TABSTOP | WB_BORDER | WB_3DLOOK ),
 
     rParent				( *pParent ),
-    aFileView			( this, SvtResId( CTRL_FILEVIEW ), FILEVIEW_SHOW_TITLE ),
+    aFileView			( this, SvtResId( CTRL_FILEVIEW ), FILEVIEW_SHOW_NONE ),
     bIsTemplateFolder	( sal_False )
 
 {
@@ -660,9 +661,14 @@ Sequence< ::rtl::OUString > SvtFileViewW
     for ( i = 0; i < nCount; ++i )
     {
         GetMenuEntry_Impl( aDynamicMenuEntries[i], aTitle, aURL, aTargetFrame, aImageURL );
-
-        if ( aURL == sSeparator || aURL == sSlotURL )
+        if( aURL == sSlotURL )
             continue;
+        if( aURL == sSeparator )
+        {
+            String aSeparator( ASCII_STR( aSeparatorStr ) );
+            ::rtl::OUString* pSeparator = new ::rtl::OUString( aSeparator );
+            aNewDocs.Insert( pSeparator, LIST_APPEND );
+        }
         else
         {
             // title
