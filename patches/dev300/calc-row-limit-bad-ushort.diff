From 02f9657460e27e46c1d7842171e7b6d9163d544d Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:56:48 +0200
Subject: [PATCH 200/768] calc-row-limit-bad-ushort.diff

---
 sc/source/core/data/dpobject.cxx |    2 +-
 sc/source/ui/view/gridwin.cxx    |    4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git sc/source/core/data/dpobject.cxx sc/source/core/data/dpobject.cxx
index 7eb7e95..ff2d9bf 100755
--- sc/source/core/data/dpobject.cxx
+++ sc/source/core/data/dpobject.cxx
@@ -410,7 +410,7 @@ void ScDPObject::CreateOutput()
                 nNewRow = 0;
 
             ScAddress aStart( aOutRange.aStart );
-            aStart.SetRow( (USHORT) nNewRow );
+            aStart.SetRow(nNewRow);
             pOutput->SetPosition( aStart );
 
             //!	modify aOutRange?
diff --git sc/source/ui/view/gridwin.cxx sc/source/ui/view/gridwin.cxx
index db15c2d..567a51a 100644
--- sc/source/ui/view/gridwin.cxx
+++ sc/source/ui/view/gridwin.cxx
@@ -2964,7 +2964,7 @@ void ScGridWindow::SelectForContextMenu( const Point& rPosPixel, SCsCOL nCellX,
         //  clicked on selected object -> don't change anything
         bHitSelected = TRUE;
     }
-    else if ( pViewData->GetMarkData().IsCellMarked( (USHORT) nCellX, (USHORT) nCellY ) )
+    else if ( pViewData->GetMarkData().IsCellMarked(nCellX, nCellY) )
     {
         //  clicked on selected cell -> don't change anything
         bHitSelected = TRUE;
@@ -2988,7 +2988,7 @@ void ScGridWindow::SelectForContextMenu( const Point& rPosPixel, SCsCOL nCellX,
         if ( !bHitDraw )
         {
             pView->Unmark();
-            pView->SetCursor( (USHORT) nCellX, (USHORT) nCellY );
+            pView->SetCursor(nCellX, nCellY);
             if ( bWasDraw )
                 pViewData->GetViewShell()->SetDrawShell( FALSE );   // switch shells
         }
-- 
1.7.0.1

