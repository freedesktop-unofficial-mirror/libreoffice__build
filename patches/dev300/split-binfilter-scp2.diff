--- scp2/prj/build.lst.old	2006-12-12 17:17:06.000000000 +0100
+++ scp2/prj/build.lst	2007-07-19 13:12:54.000000000 +0200
@@ -3,6 +3,7 @@
 cp    scp2\macros                 nmake    -    all    cp_langmacros NULL
 cp    scp2\source\templates       nmake    -    all    cp_langtemplates NULL
 cp    scp2\source\activex         nmake    -    all    cp_activex cp_langmacros cp_langtemplates NULL
+cp    scp2\source\binfilter       nmake    -    all    cp_binfilter cp_langmacros NULL
 cp    scp2\source\calc            nmake    -    all    cp_calc cp_langmacros cp_langtemplates NULL
 cp    scp2\source\canvas          nmake    -    all    cp_canvas cp_langmacros cp_langtemplates NULL
 cp    scp2\source\crashrep        nmake    -    all    cp_crashrep cp_langmacros cp_langtemplates NULL
@@ -27,4 +28,4 @@
 cp    scp2\source\ure             nmake    -    all    cp_ure cp_langmacros cp_langtemplates NULL
 cp    scp2\source\onlineupdate    nmake    -    all    cp_update cp_langmacros cp_langtemplates NULL
 cp    scp2\source\ooo_wo_ure      nmake    -    all    cp_ooo_wo_ure cp_langmacros cp_langtemplates NULL
-cp    scp2\util                   nmake    -    all    cp_util cp_activex cp_calc cp_canvas cp_crashrep cp_draw cp_gnome cp_graphicfilter cp_impress cp_javafilter cp_kde cp_layout cp_lingu cp_math cp_ooo cp_python cp_quickstart cp_testtool cp_writer cp_base cp_xsltfilter cp_winexplorerext cp_ure cp_sdkoo cp_update cp_ooo_wo_ure NULL
+cp    scp2\util                   nmake    -    all    cp_util cp_activex cp_binfilter cp_calc cp_canvas cp_crashrep cp_draw cp_gnome cp_graphicfilter cp_impress cp_javafilter cp_kde cp_layout cp_lingu cp_math cp_ooo cp_python cp_quickstart cp_testtool cp_writer cp_base cp_xsltfilter cp_winexplorerext cp_ure cp_sdkoo cp_update cp_ooo_wo_ure NULL
--- scp2/source/binfilter/file_binfilter.scp.old	2007-07-19 13:12:54.000000000 +0200
+++ scp2/source/binfilter/file_binfilter.scp	2007-07-19 13:12:54.000000000 +0200
@@ -0,0 +1,193 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Chart_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_chart_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Chart_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_chart_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Calc_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_calc_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Calc_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_calc_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Draw_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_draw_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Draw_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_draw_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Global_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_global_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Global_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_global_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Impress_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_impress_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Impress_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_impress_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Math_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_math_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Math_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_math_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Web_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_web_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Web_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_web_bf_filters.xcu";
+End
+
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Writer_Bf_Types_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Types;
+    Name = "/registry/spool/fcfg_writer_bf_types.xcu";
+End
+
+File gid_File_Registry_Spool_Oo_TypeDetection_Writer_Bf_Filters_Xcu
+    TXT_FILE_BODY;
+    Styles = (PACKED, PATCH);
+    Dir = gid_Dir_Share_Registry_Modules_Oo_TypeDetection_Filter;
+    Name = "/registry/spool/fcfg_writer_bf_filters.xcu";
+End
+
+
+File gid_Starregistry_Legacy_Binfilters_Rdb
+    TXT_FILE_BODY;
+    Name = "legacy_binfilters.rdb";
+    Dir = gid_Dir_Program;
+    Styles = (PACKED, STARREGISTRY, PATCH);
+End
+
+
+
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Go, bf_go)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sch, bf_sch)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Xo, bf_xo)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Svx, bf_svx)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Frm, bf_frm)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Ofa, bf_ofa)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sb, bf_sb)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sc, bf_sc)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sd, bf_sd)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sm, bf_sm)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sw, bf_sw)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Wrapper, bf_wrapper)
+STD_LIB_FILE_PATCH( gid_File_Lib_Legacy_Binfilters, legacy_binfilters)
+
+STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Bf_Migratefilter, bf_migratefilter)
+STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Bindet, bindet)
+
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Sch, bf_sch )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Svx, bf_svx )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Frm, bf_frm )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Ofa, bf_ofa )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Sc, bf_sc )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Sd, bf_sd )
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Sm, bf_sm)
+STD_LIB_FILE_PATCH( gid_File_Lib_Bf_So, bf_so)
+STD_RES_FILE_PATCH( gid_File_Res_Bf_Sw, bf_sw )
--- scp2/source/binfilter/localize.sdf.old	2007-07-19 13:12:54.000000000 +0200
+++ scp2/source/binfilter/localize.sdf	2007-07-19 13:12:54.000000000 +0200
@@ -0,0 +1,43 @@
+#
+#    ####    ###     #   #   ###   #####    #####  ####   #####  #####  
+#    #   #  #   #    ##  #  #   #    #      #      #   #    #      #    
+#    #   #  #   #    # # #  #   #    #      ###    #   #    #      #    
+#    #   #  #   #    #  ##  #   #    #      #      #   #    #      #    
+#    ####    ###     #   #   ###     #      #####  ####   #####    #    
+#
+#    DO NOT EDIT! This file will be overwritten by localisation process
+#
+#*************************************************************************
+#
+#   OpenOffice.org - a multi-platform office productivity suite
+#
+#   $RCSfile$
+#
+#   $Revision$
+#
+#   last change: $Author$ $Date$
+#
+#   The Contents of this file are made available subject to
+#   the terms of GNU Lesser General Public License Version 2.1.
+#
+#
+#     GNU Lesser General Public License Version 2.1
+#     =============================================
+#     Copyright 2005 by Sun Microsystems, Inc.
+#     901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#     This library is free software; you can redistribute it and/or
+#     modify it under the terms of the GNU Lesser General Public
+#     License version 2.1, as published by the Free Software Foundation.
+#
+#     This library is distributed in the hope that it will be useful,
+#     but WITHOUT ANY WARRANTY; without even the implied warranty of
+#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#     Lesser General Public License for more details.
+#
+#     You should have received a copy of the GNU Lesser General Public
+#     License along with this library; if not, write to the Free Software
+#     Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#     MA  02111-1307  USA
+#
+#*************************************************************************
--- scp2/source/binfilter/makefile.mk.old	2007-07-19 13:12:54.000000000 +0200
+++ scp2/source/binfilter/makefile.mk	2007-07-19 13:12:54.000000000 +0200
@@ -0,0 +1,58 @@
+#*************************************************************************
+#
+#   OpenOffice.org - a multi-platform office productivity suite
+#
+#   $RCSfile$
+#
+#   $Revision$
+#
+#   last change: $Author$ $Date$
+#
+#   The Contents of this file are made available subject to
+#   the terms of GNU Lesser General Public License Version 2.1.
+#
+#
+#     GNU Lesser General Public License Version 2.1
+#     =============================================
+#     Copyright 2005 by Sun Microsystems, Inc.
+#     901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#     This library is free software; you can redistribute it and/or
+#     modify it under the terms of the GNU Lesser General Public
+#     License version 2.1, as published by the Free Software Foundation.
+#
+#     This library is distributed in the hope that it will be useful,
+#     but WITHOUT ANY WARRANTY; without even the implied warranty of
+#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#     Lesser General Public License for more details.
+#
+#     You should have received a copy of the GNU Lesser General Public
+#     License along with this library; if not, write to the Free Software
+#     Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#     MA  02111-1307  USA
+#
+#*************************************************************************
+
+PRJ=..$/..
+
+PRJPCH=
+
+PRJNAME=scp2
+TARGET=binfilter
+TARGETTYPE=CUI
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  settings.mk
+
+SCP_PRODUCT_TYPE=osl
+
+PARFILES= \
+        module_binfilter.par            \
+        file_binfilter.par
+
+ULFFILES= \
+        module_binfilter.ulf
+
+# --- File ---------------------------------------------------------
+.INCLUDE :  target.mk
--- /dev/null	2006-06-16 15:54:00.000000000 +0200
+++ scp2/source/binfilter/module_binfilter.scp	2008-01-16 21:04:35.000000000 +0100
@@ -0,0 +1,87 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Optional_Binfilter
+    PackageInfo = "packinfo_office.txt";
+    MOD_NAME_DESC ( MODULE_OPTIONAL_BINFILTER );
+    Sortkey = "700";
+    ParentID = gid_Module_Optional;
+    Default = YES;
+    Files = (gid_File_Registry_Spool_Oo_TypeDetection_Chart_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Chart_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Calc_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Calc_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Draw_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Draw_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Global_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Global_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Impress_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Impress_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Math_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Math_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Web_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Web_Bf_Filters_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Writer_Bf_Types_Xcu,
+    gid_File_Registry_Spool_Oo_TypeDetection_Writer_Bf_Filters_Xcu,
+    gid_Starregistry_Legacy_Binfilters_Rdb,
+    gid_File_Lib_Bf_Go,
+    gid_File_Lib_Bf_Sch,
+    gid_File_Lib_Bf_Lng,
+    gid_File_Lib_Bf_Xo,
+    gid_File_Lib_Bf_Svx,
+    gid_File_Lib_Bf_Frm,
+    gid_File_Lib_Bf_Ofa,
+    gid_File_Lib_Bf_Sb,
+    gid_File_Lib_Bf_Sc,
+    gid_File_Lib_Bf_Sd,
+    gid_File_Lib_Bf_Sm,
+    gid_File_Lib_Bf_So,
+    gid_File_Lib_Bf_Sw,
+    gid_File_Lib_Bf_Wrapper,
+    gid_File_Lib_Legacy_Binfilters,
+    gid_File_Lib_Bf_Migratefilter,
+    gid_File_Lib_Bindet,
+    gid_File_Res_Bf_Sch,
+    gid_File_Res_Bf_Svx,
+    gid_File_Res_Bf_Frm,
+    gid_File_Res_Bf_Ofa,
+    gid_File_Res_Bf_Sc,
+    gid_File_Res_Bf_Sd,
+    gid_File_Res_Bf_Sm,
+    gid_File_Res_Bf_Sw,
+    gid_File_Res_Bf_Sfx);
+End
--- scp2/source/binfilter/module_binfilter.ulf.old	2007-07-19 13:12:54.000000000 +0200
+++ scp2/source/binfilter/module_binfilter.ulf	2007-07-19 13:12:54.000000000 +0200
@@ -0,0 +1,40 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+[STR_NAME_MODULE_OPTIONAL_BINFILTER]
+en-US = "Legacy Filters"
+
+[STR_DESC_MODULE_OPTIONAL_BINFILTER]
+en-US = "Legacy filters, e.g. StarOffice 5.2 binary file formats."
--- scp2/source/calc/file_calc.scp.old	2007-07-17 21:12:03.000000000 +0200
+++ scp2/source/calc/file_calc.scp	2007-07-19 13:12:54.000000000 +0200
@@ -82,19 +82,6 @@ STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Scd
 
 STD_LIB_FILE_PATCH( gid_File_Lib_Tfu, tfu)
 
-//
-// start binfilter #110743#
-//
-
-#ifndef WITHOUT_BINFILTER
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sc, bf_sc)
-STD_RES_FILE( gid_File_Res_Bf_Sc, bf_sc)
-#endif
-
-//
-// end binfilter #110743#
-//
-
 STD_RES_FILE( gid_File_Res_Analysis, analysis)
 
 STD_RES_FILE_PATCH( gid_File_Res_Date, date)
--- scp2/source/calc/makefile.mk.old	2007-07-17 21:12:03.000000000 +0200
+++ scp2/source/calc/makefile.mk	2007-07-19 13:12:54.000000000 +0200
@@ -45,10 +45,6 @@ TARGETTYPE=CUI
 
 .INCLUDE :	settings.mk
 
-.IF "$(WITH_BINFILTER)" == "NO"
-SCPDEFS+=-DWITHOUT_BINFILTER
-.ENDIF
-
 .IF "$(SYSTEM_LPSOLVE)" == "YES"
 SCPDEFS+=-DSYSTEM_LPSOLVE
 .ENDIF
--- scp2/source/calc/module_calc.scp.old	2008-01-15 20:44:19.000000000 +0100
+++ scp2/source/calc/module_calc.scp	2008-01-16 20:06:26.000000000 +0100
@@ -42,7 +42,6 @@
     Sortkey = "200";
 End
 
-// #110743# Added gid_File_Lib_Bf_Sc and gid_File_Res_Bf_Sc for binfilter
 Module gid_Module_Prg_Calc_Bin
     MOD_NAME_DESC ( MODULE_PRG_CALC_BIN );
     ParentID = gid_Module_Prg_Calc;
@@ -52,7 +51,7 @@
     Files = (gid_File_Lib_Calc,gid_File_Exe_Scalc,gid_File_Lib_Sc,gid_File_Lib_Scui,gid_File_Lib_Scd,gid_File_Extra_Urldesktop_Calc,gid_File_Extra_Urlnew_Calc,gid_File_Extra_Urlstart_Calc,gid_File_Extra_Urltasks_Calc,gid_File_Oo_Office_Filter_Calc_Pkg,gid_File_Share_Config_Sofficecfg_Calc_Menubar_Xml,
     gid_File_Oo_Office_Ui_Calccommands_Xcs,gid_File_Oo_Office_Ui_Calccommands_Xcu,gid_File_Oo_Office_Ui_Calcwindowstate_Xcs,
     gid_File_Registry_Spool_Oo_Common_Calc_Xcu,gid_File_Registry_Spool_Oo_Setup_Calc_Xcu, gid_File_Xdg_Calc, gid_File_Registry_Spool_Oo_Office_Embedding_Calc_Xcu,
-    gid_File_Lib_Bf_Sc,gid_File_Oo_Office_Ui_Calcwindowstate_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Filters_Xcu, gid_File_Tmp_Userinstall_Calc_Inf);
+    gid_File_Oo_Office_Ui_Calcwindowstate_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Filters_Xcu, gid_File_Tmp_Userinstall_Calc_Inf);
 End
 
 // Module gid_Module_Prg_Calc_Help

--- scp2/source/math/file_math.scp.old	2007-08-02 19:20:28.000000000 +0200
+++ scp2/source/math/file_math.scp	2008-01-16 20:03:03.000000000 +0100
@@ -57,19 +57,6 @@ STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Smd
 
 STD_RES_FILE_PATCH( gid_File_Res_Sm, sm )
 
-//
-// start binfilter #110743#
-//
-
-#ifndef WITHOUT_BINFILTER
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sm, bf_sm)
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Sm, bf_sm)
-#endif
-
-//
-// end binfilter #110743#
-//
-
 File gid_File_Registry_Spool_Oo_Office_Embedding_Math_Xcu
     TXT_FILE_BODY;
     Styles = (PACKED, PATCH);
--- scp2/source/math/makefile.mk.old	2007-07-17 21:12:01.000000000 +0200
+++ scp2/source/math/makefile.mk	2007-07-19 13:12:54.000000000 +0200
@@ -45,10 +45,6 @@ TARGETTYPE=CUI
 
 .INCLUDE :	settings.mk
 
-.IF "$(WITH_BINFILTER)" == "NO"
-SCPDEFS+=-DWITHOUT_BINFILTER
-.ENDIF
-
 SCP_PRODUCT_TYPE=osl
 PARFILES= \
         module_math.par              \
--- scp2/source/math/module_math.scp.old	2007-07-17 21:12:01.000000000 +0200
+++ scp2/source/math/module_math.scp	2007-07-19 13:12:54.000000000 +0200
@@ -42,7 +42,6 @@
     Sortkey = "600";
 End
 
-// #110743# Added gid_File_Lib_Bf_Sm, gid_File_Res_Bf_Sm
 Module gid_Module_Prg_Math_Bin
     MOD_NAME_DESC ( MODULE_PRG_MATH_BIN );
     ParentID = gid_Module_Prg_Math;
@@ -51,7 +50,7 @@
     Default = YES;
     Files = (gid_File_Html_W3c_Ipr,gid_File_Dtd_Math,gid_File_Exe_Smath,gid_File_Lib_Sm,gid_File_Lib_Smd,gid_File_Extra_Urlmore_Math,gid_File_Extra_Urlnew_Math,gid_File_Extra_Urltasks_Math,
     gid_File_Oo_Office_Ui_Mathcommands_Xcs,gid_File_Oo_Office_Ui_Mathcommands_Xcu,gid_File_Oo_Office_Ui_Mathwindowstate_Xcs
-    gid_File_Lib_Bf_Sm, gid_File_Registry_Spool_Oo_Common_Math_Xcu, gid_File_Registry_Spool_Oo_Setup_Math_Xcu,
+    gid_File_Registry_Spool_Oo_Common_Math_Xcu, gid_File_Registry_Spool_Oo_Setup_Math_Xcu,
 	gid_File_Oo_Office_Ui_Mathwindowstate_Xcu, gid_File_Share_Xdg_Math, gid_File_Registry_Spool_Oo_Office_Embedding_Math_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Math_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Math_Filters_Xcu, gid_File_Tmp_Userinstall_Math_Inf);
 End
--- scp2/source/ooo/file_library_ooo.scp.old	2008-01-15 20:44:17.000000000 +0100
+++ scp2/source/ooo/file_library_ooo.scp	2008-01-16 19:42:08.000000000 +0100
@@ -2013,31 +2013,6 @@ STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Oox
 
 STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Sb , sb)
 
-//
-// start binfilter #110743#
-//
-
-#ifndef WITHOUT_BINFILTER
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Go, bf_go)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sch, bf_sch)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Xo, bf_xo)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Svx, bf_svx)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Frm, bf_frm)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Ofa, bf_ofa)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sb, bf_sb)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_So, bf_so)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sd, bf_sd)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Sw, bf_sw)
-STD_LIB_FILE_PATCH( gid_File_Lib_Bf_Wrapper, bf_wrapper)
-STD_LIB_FILE_PATCH( gid_File_Lib_Legacy_Binfilters, legacy_binfilters)
-STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Bf_Migratefilter, bf_migratefilter)
-STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Bindet, bindet)
-#endif
-
-//
-// end binfilter #110743#
-//
-
 STD_UNO_LIB_FILE_PATCH( gid_File_Lib_Scn, scn)
 
 File gid_File_Lib_Scriptframe
--- scp2/source/ooo/file_ooo.scp.old	2007-07-17 21:12:01.000000000 +0200
+++ scp2/source/ooo/file_ooo.scp	2007-07-19 13:12:54.000000000 +0200
@@ -3193,15 +3193,6 @@ File gid_File_Txt_Patchfiles
 End
 #endif
 
-#ifndef WITHOUT_BINFILTER
-File gid_Starregistry_Legacy_Binfilters_Rdb
-    TXT_FILE_BODY;
-    Name = "legacy_binfilters.rdb";
-    Dir = gid_Dir_Program;
-    Styles = (PACKED, STARREGISTRY, PATCH);
-End
-#endif
-
 File gid_Starregistry_Services_Rdb
     TXT_FILE_BODY;
     Name = "services.rdb";
--- scp2/source/ooo/file_resource_ooo.scp.old	2007-07-17 21:11:57.000000000 +0200
+++ scp2/source/ooo/file_resource_ooo.scp	2007-07-19 13:12:54.000000000 +0200
@@ -90,23 +90,6 @@ STD_RES_FILE( gid_File_Res_San, san )
 
 #endif
 
-//
-// start binfilter #110743#
-//
-
-#ifndef WITHOUT_BINFILTER
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Sch, bf_sch )
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Svx, bf_svx )
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Frm, bf_frm )
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Ofa, bf_ofa )
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Sd, bf_sd )
-STD_RES_FILE_PATCH( gid_File_Res_Bf_Sw, bf_sw )
-#endif
-
-//
-// end binfilter #110743#
-//
-
 STD_RES_FILE_PATCH( gid_File_Res_Sd, sd )
 
 STD_RES_FILE_PATCH( gid_File_Res_Sfx, sfx )
--- scp2/source/ooo/makefile.mk.old	2007-07-17 21:12:03.000000000 +0200
+++ scp2/source/ooo/makefile.mk	2007-07-19 13:12:54.000000000 +0200
@@ -143,10 +143,6 @@ SCPDEFS+=-DSYSTEM_CURL
 SCPDEFS+=-DSYSTEM_CURL
 .ENDIF
 
-.IF "$(WITH_BINFILTER)" == "NO"
-SCPDEFS+=-DWITHOUT_BINFILTER
-.ENDIF
-
 .IF "$(SYSTEM_STDLIBS)" == "YES"
 SCPDEFS+=-DSYSTEM_STDLIBS
 .ENDIF
--- scp2/source/ooo/module_hidden_ooo.scp.old	2008-01-15 20:44:16.000000000 +0100
+++ scp2/source/ooo/module_hidden_ooo.scp	2008-01-16 19:46:03.000000000 +0100
@@ -162,7 +162,6 @@ Module gid_Module_Root_Files_3
 	gid_File_Jar_Xmergebridge,
 	gid_File_Jar_Unoloader,
 	gid_File_Rdb_Types,
-	gid_Starregistry_Legacy_Binfilters_Rdb,
 	gid_Starregistry_Services_Rdb);
 End
 
@@ -227,7 +226,6 @@ Module gid_Module_Root_Files_4
 	gid_File_Lib_Lnth,
 	gid_File_Lib_Offacc,
 	gid_File_Lib_Oox,
-	gid_File_Lib_Bindet,
 	gid_File_Lib_Pcr,
 	gid_File_Lib_Pdffilter,
 	gid_File_Lib_Pk,
@@ -377,21 +375,6 @@ Module gid_Module_Root_Files_5
 	gid_File_Lib_Officebean,
 	gid_File_Lib_Openssl,
 	gid_File_Lib_Package2,
-	gid_File_Lib_Bf_Sch,
-	gid_File_Lib_Bf_Lng,
-	gid_File_Lib_Bf_Go,
-	gid_File_Lib_Bf_Xo,
-	gid_File_Lib_Bf_Svx,
-	gid_File_Lib_Bf_Frm,
-	gid_File_Lib_Bf_Ofa,
-	gid_File_Lib_Bf_Sd,
-	gid_File_Lib_Bf_Sb,
-	gid_File_Lib_Bf_So,
-	gid_File_Lib_Bf_Sm,
-	gid_File_Lib_Bf_Sw,
-	gid_File_Lib_Bf_Wrapper,
-	gid_File_Lib_Legacy_Binfilters,
-	gid_File_Lib_Bf_Migratefilter,
 	gid_File_Lib_Deployment,
 	gid_File_Lib_DeploymentGui,
 	gid_File_Lib_Sal,
--- scp2/util/makefile.mk.old	2007-07-17 21:12:01.000000000 +0200
+++ scp2/util/makefile.mk	2007-07-19 13:12:54.000000000 +0200
@@ -92,6 +92,12 @@ SCP1FILES  = installation_ooo.par       
              profileitem_python.par        \
              shortcut_python.par
 
+.IF "$(WITH_BINFILTER)" != "NO"
+SCP1FILES +=                               \
+             module_binfilter.par         \
+             file_binfilter.par
+.ENDIF
+
 .IF "$(SOLAR_JAVA)"!=""
 SCP1FILES +=                               \
              module_javafilter.par         \
@@ -225,6 +231,12 @@ SCP2FILES  = installation_ooo.par       
              file_python.par               \
              profileitem_python.par
 
+.IF "$(WITH_BINFILTER)" != "NO"
+SCP2FILES +=                               \
+             module_binfilter.par         \
+             file_binfilter.par
+.ENDIF
+
 .IF "$(SOLAR_JAVA)"!=""
 SCP2FILES +=                               \
              module_javafilter.par         \
