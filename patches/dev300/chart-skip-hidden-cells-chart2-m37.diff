Index: source/model/main/Diagram.cxx
===================================================================
--- chart2/source/model/main/Diagram.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/model/main/Diagram.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -78,6 +78,7 @@
     PROP_DIAGRAM_SORT_BY_X_VALUES,
     PROP_DIAGRAM_CONNECT_BARS,
     PROP_DIAGRAM_GROUP_BARS_PER_AXIS,
+    PROP_DIAGRAM_INCLUDE_HIDDEN_CELLS,
     PROP_DIAGRAM_STARTING_ANGLE,
     PROP_DIAGRAM_RIGHT_ANGLED_AXES,
     PROP_DIAGRAM_PERSPECTIVE,
@@ -125,6 +126,13 @@
                   | beans::PropertyAttribute::MAYBEDEFAULT ));
 
     rOutProperties.push_back(
+        Property( C2U("IncludeHiddenCells"),
+                  PROP_DIAGRAM_INCLUDE_HIDDEN_CELLS,
+                  ::getBooleanCppuType(),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
+
+    rOutProperties.push_back(
         Property( C2U( "StartingAngle" ),
                   PROP_DIAGRAM_STARTING_ANGLE,
                   ::getCppuType( reinterpret_cast< const sal_Int32 * >(0) ),
@@ -170,6 +178,7 @@
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_SORT_BY_X_VALUES, false );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_CONNECT_BARS, false );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_GROUP_BARS_PER_AXIS, true );
+    ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_INCLUDE_HIDDEN_CELLS, true );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_RIGHT_ANGLED_AXES, false );
     ::chart::PropertyHelper::setPropertyValueDefault< sal_Int32 >( rOutMap, PROP_DIAGRAM_STARTING_ANGLE, 90 );
 }
Index: source/tools/ExplicitCategoriesProvider.cxx
===================================================================
--- chart2/source/tools/ExplicitCategoriesProvider.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/tools/ExplicitCategoriesProvider.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -34,7 +34,11 @@
 #include "ExplicitCategoriesProvider.hxx"
 #include "DiagramHelper.hxx"
 #include "CommonConverters.hxx"
+#include "macros.hxx"
 
+#include <hash_set>
+#include <vector>
+
 //.............................................................................
 namespace chart
 {
@@ -45,9 +49,12 @@
 using ::com::sun::star::uno::Reference;
 using ::com::sun::star::uno::Sequence;
 using rtl::OUString;
+using ::std::hash_set;
+using ::std::vector;
 
 ExplicitCategoriesProvider::ExplicitCategoriesProvider( const Reference< chart2::XCoordinateSystem >& xCooSysModel )
     : m_bDirty(true)
+    , m_bIncludeHiddelCells(true)
     , m_xCooSysModel( xCooSysModel )
     , m_xCategories()
 {
@@ -63,20 +70,75 @@
 {
 }
 
+static void lcl_removeHiddenIndices(Sequence<OUString>& rCategories, const Sequence<sal_Int32>& rHiddenValues)
+{
+    hash_set<sal_Int32> aIndices;
+    sal_Int32 n = rHiddenValues.getLength();
+    for (sal_Int32 i = 0; i < n; ++i)
+        aIndices.insert(rHiddenValues[i]);
+
+    vector<OUString> aNewCatsVector;
+    n = rCategories.getLength();
+    aNewCatsVector.reserve(n);
+    for (sal_Int32 i = 0; i < n; ++i)
+    {
+        if (aIndices.count(i))
+            // skip this value.
+            continue;
+
+        aNewCatsVector.push_back(rCategories[i]);
+    }
+
+    n = aNewCatsVector.size();
+    rCategories.realloc(n);
+    for (size_t i = 0; i < n; ++i)
+        rCategories[i] = aNewCatsVector[i];
+}
+
 //XTextualDataSequence
 Sequence< ::rtl::OUString > SAL_CALL ExplicitCategoriesProvider::getTextualData() throw( uno::RuntimeException)
 {
     if( m_bDirty )
     {
-        if( m_xCategories.is() )
-            m_aExplicitCategories = DataSequenceToStringSequence(m_xCategories->getValues());
-        if(!m_aExplicitCategories.getLength())
-            m_aExplicitCategories = DiagramHelper::generateAutomaticCategories( uno::Reference< chart2::XCoordinateSystem >( m_xCooSysModel.get(), uno::UNO_QUERY ) );
+        if (!m_xCategories.is())
+            return m_aExplicitCategories;
+
+        uno::Reference< data::XDataSequence > xValues = m_xCategories->getValues();
+        uno::Reference< beans::XPropertySet > xProp(xValues, uno::UNO_QUERY);
+        bool bIsHidden = false;
+        Sequence<sal_Int32> aHiddenValues;
+        if (xProp.is())
+        {
+            xProp->getPropertyValue( C2U( "IsHidden" ) ) >>= bIsHidden;
+            xProp->getPropertyValue( C2U( "HiddenValues" ) ) >>= aHiddenValues;
+        }
+
+        if (!bIsHidden || m_bIncludeHiddelCells)
+        {
+            m_aExplicitCategories = DataSequenceToStringSequence(xValues);
+            if (!m_bIncludeHiddelCells)
+                lcl_removeHiddenIndices(m_aExplicitCategories, aHiddenValues);
+
+            if(!m_aExplicitCategories.getLength())
+                m_aExplicitCategories = DiagramHelper::generateAutomaticCategories(
+                    uno::Reference< chart2::XCoordinateSystem >( m_xCooSysModel.get(), uno::UNO_QUERY ) );
+        }
+
         m_bDirty = false;
     }
     return m_aExplicitCategories;
 }
 
+void ExplicitCategoriesProvider::setIncludeHiddenCells(bool b)
+{
+    m_bIncludeHiddelCells = b;
+}
+
+bool ExplicitCategoriesProvider::getIncludeHiddenCells() const
+{
+    return m_bIncludeHiddelCells;
+}
+
 // static
 OUString ExplicitCategoriesProvider::getCategoryByIndex(
         const Reference< XCoordinateSystem >& xCooSysModel,
Index: source/tools/UncachedDataSequence.cxx
===================================================================
--- chart2/source/tools/UncachedDataSequence.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/tools/UncachedDataSequence.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -79,7 +79,7 @@
     const OUString & rRangeRepresentation )
         : OPropertyContainer( GetBroadcastHelper()),
           UncachedDataSequence_Base( GetMutex()),
-          m_bIsHidden( true ),
+          m_bIsHidden( false ),
           m_xDataProvider( xIntDataProv ),
           m_aSourceRepresentation( rRangeRepresentation ),
           m_xModifyEventForwarder( new ModifyListenerHelper::ModifyEventForwarder())
@@ -93,7 +93,7 @@
     const OUString & rRole )
         : OPropertyContainer( GetBroadcastHelper()),
           UncachedDataSequence_Base( GetMutex()),
-          m_bIsHidden( true ),
+          m_bIsHidden( false ),
           m_xDataProvider( xIntDataProv ),
           m_aSourceRepresentation( rRangeRepresentation ),
           m_xModifyEventForwarder( new ModifyListenerHelper::ModifyEventForwarder())
Index: source/controller/dialogs/tp_PolarOptions.src
===================================================================
--- chart2/source/controller/dialogs/tp_PolarOptions.src	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_PolarOptions.src	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -47,8 +47,8 @@
     };
     FixedLine FL_STARTING_ANGLE
     {
-        Pos = MAP_APPFONT ( 12 , 21  ) ;
-        Size = MAP_APPFONT ( 242 , 12 ) ;
+        Pos = MAP_APPFONT ( 6 , 21  ) ;
+        Size = MAP_APPFONT ( 248 , 12 ) ;
         Text [ en-US ] = "Starting angle" ;
     };
     Control CT_ANGLE_DIAL
@@ -75,4 +75,17 @@
         Maximum = 359 ;
         SpinSize = 5 ;
     };
+    FixedLine FL_PLOT_OPTIONS
+    {
+        Pos = MAP_APPFONT ( 6 , 90  ) ;
+        Size = MAP_APPFONT ( 248 , 8 ) ;
+        Text [ en-US ] = "Plot options";
+    };
+    CheckBox CB_INCLUDE_HIDDEN_CELLS
+    {
+        Pos = MAP_APPFONT ( 12 , 104 ) ;
+        Size = MAP_APPFONT ( 200 , 10 ) ;
+        TabStop = TRUE ;
+        Text [ en-US ] = "Plot ~values from hidden cells";
+    };
 };
Index: source/controller/dialogs/tp_SeriesToAxis.hxx
===================================================================
--- chart2/source/controller/dialogs/tp_SeriesToAxis.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_SeriesToAxis.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -74,11 +74,14 @@
     CheckBox	aCBConnect;
     CheckBox    aCBAxisSideBySide;
 
-    FixedLine   m_aFL_EmptyCells;
+    FixedLine   m_aFL_PlotOptions;
+    FixedText   m_aFT_MissingValues;
     RadioButton m_aRB_DontPaint;
     RadioButton m_aRB_AssumeZero;
     RadioButton m_aRB_ContinueLine;
 
+    CheckBox    m_aCBIncludeHiddenCells;
+
     DECL_LINK(EnableHdl, RadioButton * );
 
     sal_Int32   m_nAllSeriesAxisIndex;
Index: source/controller/dialogs/tp_PolarOptions.hxx
===================================================================
--- chart2/source/controller/dialogs/tp_PolarOptions.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_PolarOptions.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -58,6 +58,9 @@
     svx::DialControl m_aAngleDial;
     FixedText        m_aFT_Degrees;
     NumericField     m_aNF_StartingAngle;
+
+    FixedLine        m_aFL_PlotOptions;
+    CheckBox         m_aCB_IncludeHiddenCells;
 };
 
 //.............................................................................
Index: source/controller/dialogs/TabPages.hrc
===================================================================
--- chart2/source/controller/dialogs/TabPages.hrc	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/TabPages.hrc	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -89,10 +89,12 @@
 #define GB_BAR						8
 #define CB_CONNECTOR				9
 #define CB_BARS_SIDE_BY_SIDE       10
-#define FL_PLOT_MISSING_VALUES     11
-#define RB_DONT_PAINT              12
-#define RB_ASSUME_ZERO             13
-#define RB_CONTINUE_LINE           14
+#define CB_INCLUDE_HIDDEN_CELLS    11
+#define FL_PLOT_OPTIONS            12
+#define RB_DONT_PAINT              13
+#define RB_ASSUME_ZERO             14
+#define RB_CONTINUE_LINE           15
+#define FT_MISSING_VALUES          16
 
 //------------
 //from old chart tplabel.hrc
Index: source/controller/dialogs/tp_SeriesToAxis.cxx
===================================================================
--- chart2/source/controller/dialogs/tp_SeriesToAxis.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_SeriesToAxis.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -63,10 +63,12 @@
 	aMTOverlap(this,SchResId(MT_OVERLAP)),
 	aCBConnect(this,SchResId(CB_CONNECTOR)),
     aCBAxisSideBySide(this,SchResId(CB_BARS_SIDE_BY_SIDE)),
-    m_aFL_EmptyCells(this,SchResId(FL_PLOT_MISSING_VALUES)),
+    m_aFL_PlotOptions(this,SchResId(FL_PLOT_OPTIONS)),
+    m_aFT_MissingValues(this,SchResId(FT_MISSING_VALUES)), 
     m_aRB_DontPaint(this,SchResId(RB_DONT_PAINT)),
     m_aRB_AssumeZero(this,SchResId(RB_ASSUME_ZERO)),
     m_aRB_ContinueLine(this,SchResId(RB_CONTINUE_LINE)),
+    m_aCBIncludeHiddenCells(this,SchResId(CB_INCLUDE_HIDDEN_CELLS)), 
     m_bProvidesSecondaryYAxis(true),
     m_bProvidesOverlapAndGapWidth(false)
 {
@@ -123,6 +125,9 @@
     else if(m_aRB_ContinueLine.IsChecked())
         rOutAttrs.Put(SfxInt32Item(SCHATTR_MISSING_VALUE_TREATMENT,::com::sun::star::chart::MissingValueTreatment::CONTINUE));
 
+    if (m_aCBIncludeHiddenCells.IsVisible())
+        rOutAttrs.Put(SfxBoolItem(SCHATTR_INCLUDE_HIDDEN_CELLS, m_aCBIncludeHiddenCells.IsChecked()));
+
 	return TRUE;
 }
 
@@ -215,10 +220,17 @@
             m_aRB_DontPaint.Show(FALSE);
             m_aRB_AssumeZero.Show(FALSE);
             m_aRB_ContinueLine.Show(FALSE);
-		    m_aFL_EmptyCells.Show(FALSE);
+		    m_aFL_PlotOptions.Show(FALSE);
         }
     }
 
+    // Include hidden cells
+    if (rInAttrs.GetItemState(SCHATTR_INCLUDE_HIDDEN_CELLS, TRUE, &pPoolItem) == SFX_ITEM_SET)
+    {
+        bool bVal = static_cast<const SfxBoolItem*>(pPoolItem)->GetValue();
+        m_aCBIncludeHiddenCells.Check(bVal);
+    }
+
     AdaptControlPositionsAndVisibility();
 }
 
@@ -231,6 +243,12 @@
     AdaptControlPositionsAndVisibility();
 }
 
+static void lcl_offsetControl(Control& rCtrl, long nYOffset)
+{
+    Point aPos = rCtrl.GetPosPixel();
+    rCtrl.SetPosPixel( Point(aPos.getX(), aPos.getY() + nYOffset) );
+}
+
 void SchOptionTabPage::AdaptControlPositionsAndVisibility()
 {
     aRbtAxis1.Show(m_bProvidesSecondaryYAxis);
@@ -254,14 +272,13 @@
 	    else
             aPos = aGrpBar.GetPosPixel();
 
-        long nDiffX = aRbtAxis1.GetPosPixel().getX() - aGrpAxis.GetPosPixel().getX();
-        long nDiffY = aRbtAxis1.GetPosPixel().getY() - aGrpAxis.GetPosPixel().getY();
-        long nDiffY1 = aRbtAxis2.GetPosPixel().getY() - aRbtAxis1.GetPosPixel().getY();
-
-        m_aFL_EmptyCells.SetPosPixel( aPos );
-        m_aRB_DontPaint.SetPosPixel( Point( aPos.getX() + nDiffX, aPos.getY() + nDiffY ) );
-        m_aRB_AssumeZero.SetPosPixel( Point( aPos.getX() + nDiffX, aPos.getY() + nDiffY + nDiffY1  ) );
-        m_aRB_ContinueLine.SetPosPixel( Point( aPos.getX() + nDiffX, aPos.getY() + nDiffY + nDiffY1 * 2 ) );
+        long nYOffset = aPos.getY() - m_aFL_PlotOptions.GetPosPixel().getY();
+        lcl_offsetControl(m_aFL_PlotOptions,       nYOffset);
+        lcl_offsetControl(m_aFT_MissingValues,     nYOffset);
+        lcl_offsetControl(m_aRB_DontPaint,         nYOffset);
+        lcl_offsetControl(m_aRB_AssumeZero,        nYOffset);
+        lcl_offsetControl(m_aRB_ContinueLine,      nYOffset);
+        lcl_offsetControl(m_aCBIncludeHiddenCells, nYOffset);
     }
 
     if( !m_aRB_DontPaint.IsVisible() )
Index: source/controller/dialogs/tp_PolarOptions.cxx
===================================================================
--- chart2/source/controller/dialogs/tp_PolarOptions.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_PolarOptions.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -51,7 +51,9 @@
     m_aFL_StartingAngle( this, SchResId( FL_STARTING_ANGLE ) ),
     m_aAngleDial( this, SchResId( CT_ANGLE_DIAL ) ),
     m_aFT_Degrees( this, SchResId( FT_ROTATION_DEGREES ) ),
-    m_aNF_StartingAngle( this, SchResId( NF_STARTING_ANGLE ) )
+    m_aNF_StartingAngle( this, SchResId( NF_STARTING_ANGLE ) ),
+    m_aFL_PlotOptions( this, SchResId( FL_PLOT_OPTIONS ) ),
+    m_aCB_IncludeHiddenCells( this, SchResId( CB_INCLUDE_HIDDEN_CELLS ) )
 {
     FreeResource();
 
@@ -78,6 +80,9 @@
     if( m_aCB_Clockwise.IsVisible() )
         rOutAttrs.Put(SfxInt32Item(SCHATTR_CLOCKWISE,m_aCB_Clockwise.IsChecked()));
 
+    if (m_aCB_IncludeHiddenCells.IsVisible())
+        rOutAttrs.Put(SfxBoolItem(SCHATTR_INCLUDE_HIDDEN_CELLS, m_aCB_IncludeHiddenCells.IsChecked()));
+
     return TRUE;
 }
 
@@ -108,6 +113,11 @@
     {
         m_aCB_Clockwise.Show(FALSE);
     }
+    if (rInAttrs.GetItemState(SCHATTR_INCLUDE_HIDDEN_CELLS, TRUE, &pPoolItem) == SFX_ITEM_SET)
+    {
+        bool bVal = static_cast<const SfxBoolItem*>(pPoolItem)->GetValue();
+        m_aCB_IncludeHiddenCells.Check(bVal);
+    }
 }
 
 //.............................................................................
Index: source/controller/dialogs/tp_SeriesToAxis.src
===================================================================
--- chart2/source/controller/dialogs/tp_SeriesToAxis.src	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/dialogs/tp_SeriesToAxis.src	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -120,7 +120,7 @@
         Pos = MAP_APPFONT ( 12 , 97 ) ;
 		Size = MAP_APPFONT ( 200 , 10 ) ;
 		TabStop = TRUE ;
-		Text [ en-US ] = "Connection Lines";
+		Text [ en-US ] = "Connection lines";
 	};
 
     CheckBox CB_BARS_SIDE_BY_SIDE
@@ -131,16 +131,23 @@
         Text [ en-US ] = "Show ~bars side by side";
     };
     
-    FixedLine FL_PLOT_MISSING_VALUES
+    FixedLine FL_PLOT_OPTIONS
     {
         Pos = MAP_APPFONT ( 6 , 113  ) ;
         Size = MAP_APPFONT ( 248 , 8 ) ;
+        Text [ en-US ] = "Plot options";
+    };
+
+    FixedText FT_MISSING_VALUES
+    {
+        Pos = MAP_APPFONT ( 12 , 127  ) ;
+        Size = MAP_APPFONT ( 248 , 8 ) ;
         Text [ en-US ] = "Plot missing values";
     };
     
     RadioButton RB_DONT_PAINT
     {
-        Pos = MAP_APPFONT ( 12 , 127  ) ;
+        Pos = MAP_APPFONT ( 82 , 127  ) ;
         Size = MAP_APPFONT ( 80 , 10 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "~Leave gap";  
@@ -148,7 +155,7 @@
     
     RadioButton RB_ASSUME_ZERO
     {
-        Pos = MAP_APPFONT ( 12 , 141  ) ;
+        Pos = MAP_APPFONT ( 82 , 141  ) ;
         Size = MAP_APPFONT ( 80 , 10 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "~Assume zero";  
@@ -156,9 +163,17 @@
     
     RadioButton RB_CONTINUE_LINE
     {
-        Pos = MAP_APPFONT ( 12 , 155  ) ;
+        Pos = MAP_APPFONT ( 82 , 155  ) ;
         Size = MAP_APPFONT ( 80 , 10 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "~Continue line";  
-    };  
+    };
+      
+    CheckBox CB_INCLUDE_HIDDEN_CELLS
+    {
+        Pos = MAP_APPFONT ( 12 , 172 ) ;
+        Size = MAP_APPFONT ( 200 , 10 ) ;
+        TabStop = TRUE ;
+        Text [ en-US ] = "Plot ~values from hidden cells";
+    };
 };
Index: source/controller/inc/SeriesOptionsItemConverter.hxx
===================================================================
--- chart2/source/controller/inc/SeriesOptionsItemConverter.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/inc/SeriesOptionsItemConverter.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -93,6 +93,8 @@
 
     ::com::sun::star::uno::Sequence< sal_Int32 > m_aSupportedMissingValueTreatments;
     sal_Int32 m_nMissingValueTreatment;
+
+    bool m_bIncludeHiddenCells;
 };
 
 } //  namespace wrapper
Index: source/controller/itemsetwrapper/SchWhichPairs.hxx
===================================================================
--- chart2/source/controller/itemsetwrapper/SchWhichPairs.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/itemsetwrapper/SchWhichPairs.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -163,7 +163,8 @@
     SCHATTR_STARTING_ANGLE,SCHATTR_STARTING_ANGLE, \
     SCHATTR_CLOCKWISE,SCHATTR_CLOCKWISE, \
     SCHATTR_MISSING_VALUE_TREATMENT,SCHATTR_MISSING_VALUE_TREATMENT, \
-    SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS,SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS
+    SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS,SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS, \
+    SCHATTR_INCLUDE_HIDDEN_CELLS,SCHATTR_INCLUDE_HIDDEN_CELLS
 
 const USHORT nSeriesOptionsWhichPairs[] =
 {
Index: source/controller/itemsetwrapper/SeriesOptionsItemConverter.cxx
===================================================================
--- chart2/source/controller/itemsetwrapper/SeriesOptionsItemConverter.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/itemsetwrapper/SeriesOptionsItemConverter.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -93,6 +93,7 @@
         , m_bClockwise(false)
         , m_aSupportedMissingValueTreatments()
         , m_nMissingValueTreatment(0)
+        , m_bIncludeHiddenCells(true)
 {
     try
     {
@@ -159,6 +160,8 @@
         m_aSupportedMissingValueTreatments = ChartTypeHelper::getSupportedMissingValueTreatments( xChartType );
         m_nMissingValueTreatment = DiagramHelper::getCorrectedMissingValueTreatment(
             ChartModelHelper::findDiagram(m_xChartModel), xChartType );
+
+        xDiagramProperties->getPropertyValue( C2U("IncludeHiddenCells") ) >>= m_bIncludeHiddenCells;
     }
     catch( uno::Exception ex )
     {
@@ -341,6 +344,27 @@
             }
         }
         break;
+        case SCHATTR_INCLUDE_HIDDEN_CELLS:
+        {
+            bool bIncludeHiddenCells = static_cast<const SfxBoolItem &>(rItemSet.Get(nWhichId)).GetValue();
+            if (bIncludeHiddenCells != m_bIncludeHiddenCells)
+            {
+                try
+                {
+                    uno::Reference< beans::XPropertySet > xDiagramProperties( ChartModelHelper::findDiagram(m_xChartModel), uno::UNO_QUERY );
+                    if (xDiagramProperties.is())
+                    {
+                        xDiagramProperties->setPropertyValue( C2U("IncludeHiddenCells"), uno::makeAny(bIncludeHiddenCells));
+                        bChanged = true;
+                    }
+                }
+                catch (uno::Exception& e)
+                {
+                    ASSERT_EXCEPTION(e);
+                }
+            }
+        }
+        break;
     }
     return bChanged;
 }
@@ -412,6 +436,11 @@
             rOutItemSet.Put( SfxIntegerListItem( nWhichId, aList ) );
             break;
         }
+        case SCHATTR_INCLUDE_HIDDEN_CELLS:
+        {
+            rOutItemSet.Put( SfxBoolItem(nWhichId, m_bIncludeHiddenCells) );
+            break;
+        }
         default:
             break;
    }
Index: source/controller/chartapiwrapper/DiagramWrapper.cxx
===================================================================
--- chart2/source/controller/chartapiwrapper/DiagramWrapper.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/controller/chartapiwrapper/DiagramWrapper.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -112,6 +112,7 @@
     PROP_DIAGRAM_DATAROW_SOURCE,
 
     PROP_DIAGRAM_GROUP_BARS_PER_AXIS,
+    PROP_DIAGRAM_INCLUDE_HIDDEN_CELLS,
 
     PROP_DIAGRAM_SORT_BY_X_VALUES,
 
@@ -233,6 +234,13 @@
                   beans::PropertyAttribute::BOUND
                   | beans::PropertyAttribute::MAYBEDEFAULT ));
 
+    rOutProperties.push_back(
+        Property( C2U( "IncludeHiddenCells" ),
+                  PROP_DIAGRAM_INCLUDE_HIDDEN_CELLS,
+                  ::getBooleanCppuType(),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
+
     //new for XY charts
     rOutProperties.push_back(
         Property( C2U( "SortByXValues" ),
Index: source/inc/chartview/ChartSfxItemIds.hxx
===================================================================
--- chart2/source/inc/chartview/ChartSfxItemIds.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/inc/chartview/ChartSfxItemIds.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -200,10 +200,11 @@
 #define SCHATTR_DIAGRAM_STYLE           (SCHATTR_CHARTTYPE_START + 6)
 #define SCHATTR_TEXTBREAK               (SCHATTR_CHARTTYPE_START + 7)
 #define SCHATTR_GROUP_BARS_PER_AXIS     (SCHATTR_CHARTTYPE_START + 8)
-#define SCHATTR_STARTING_ANGLE          (SCHATTR_CHARTTYPE_START + 9)
-#define SCHATTR_CLOCKWISE               (SCHATTR_CHARTTYPE_START + 10)
-#define SCHATTR_MISSING_VALUE_TREATMENT     (SCHATTR_CHARTTYPE_START + 11)
-#define SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS (SCHATTR_CHARTTYPE_START + 12)
+#define SCHATTR_INCLUDE_HIDDEN_CELLS    (SCHATTR_CHARTTYPE_START + 9)
+#define SCHATTR_STARTING_ANGLE          (SCHATTR_CHARTTYPE_START + 10)
+#define SCHATTR_CLOCKWISE               (SCHATTR_CHARTTYPE_START + 11)
+#define SCHATTR_MISSING_VALUE_TREATMENT     (SCHATTR_CHARTTYPE_START + 12)
+#define SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS (SCHATTR_CHARTTYPE_START + 13)
 
 #define SCHATTR_CHARTTYPE_END           SCHATTR_AVAILABLE_MISSING_VALUE_TREATMENTS
 
Index: source/inc/ExplicitCategoriesProvider.hxx
===================================================================
--- chart2/source/inc/ExplicitCategoriesProvider.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/inc/ExplicitCategoriesProvider.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -58,9 +58,13 @@
             ::com::sun::star::chart2::XCoordinateSystem >& xCooSysModel,
         sal_Int32 nIndex );
 
+    void setIncludeHiddenCells(bool b);
+    bool getIncludeHiddenCells() const;
+
 private: //member
     ::com::sun::star::uno::Sequence< ::rtl::OUString > m_aExplicitCategories;
     bool volatile m_bDirty;
+    bool m_bIncludeHiddelCells;
 
     ::com::sun::star::uno::WeakReference<
         ::com::sun::star::chart2::XCoordinateSystem > m_xCooSysModel;
Index: source/view/axes/VCoordinateSystem.cxx
===================================================================
--- chart2/source/view/axes/VCoordinateSystem.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/axes/VCoordinateSystem.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -581,6 +581,16 @@
     m_aSeriesNamesForZAxis = rSeriesNames;
 }
 
+void VCoordinateSystem::setIncludeHiddenCells(bool b)
+{
+    m_aExplicitCategoriesProvider->setIncludeHiddenCells(b);
+}
+
+bool VCoordinateSystem::getIncludeHiddenCells() const
+{
+    return m_aExplicitCategoriesProvider->getIncludeHiddenCells();
+}
+
 sal_Int32 VCoordinateSystem::getNumberFormatKeyForAxis(
         const Reference< chart2::XAxis >& xAxis
         , const Reference< util::XNumberFormatsSupplier >& xNumberFormatsSupplier )
Index: source/view/axes/ScaleAutomatism.cxx
===================================================================
--- chart2/source/view/axes/ScaleAutomatism.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/axes/ScaleAutomatism.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -134,7 +134,7 @@
         if( m_aSourceScale.AxisType==AxisType::PERCENT )
             rExplicitScale.Minimum = 0.0;
         else if( ::rtl::math::isNan( m_fValueMinimum ) )
-            rExplicitScale.Minimum = 0.0;   //@todo get Minimum from scsaling or from plotter????
+            rExplicitScale.Minimum = 0.0;   //@todo get Minimum from scaling or from plotter????
         else
             rExplicitScale.Minimum = m_fValueMinimum;
     }
@@ -143,7 +143,7 @@
     if( bAutoMaximum )
     {
         if( m_aSourceScale.AxisType==AxisType::PERCENT )
-            rExplicitScale.Minimum = 1.0;
+            rExplicitScale.Maximum = 1.0;
         else if( ::rtl::math::isNan( m_fValueMaximum ) )
             rExplicitScale.Maximum = 10.0;  //@todo get Maximum from scaling or from plotter????
         else
Index: source/view/main/ChartView.cxx
===================================================================
--- chart2/source/view/main/ChartView.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/main/ChartView.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -623,6 +623,7 @@
     sal_Bool bSortByXValues = sal_False;
     sal_Bool bConnectBars = sal_False;
     sal_Bool bGroupBarsPerAxis = sal_True;
+    sal_Bool bIncludeHiddenCells = sal_True;
     sal_Int32 nStartingAngle = 90;
     try
     {
@@ -630,6 +631,7 @@
         xDiaProp->getPropertyValue( C2U( "SortByXValues" ) ) >>= bSortByXValues;
         xDiaProp->getPropertyValue( C2U( "ConnectBars" ) ) >>= bConnectBars;
         xDiaProp->getPropertyValue( C2U( "GroupBarsPerAxis" ) ) >>= bGroupBarsPerAxis;
+        xDiaProp->getPropertyValue( C2U( "IncludeHiddenCells" ) ) >>= bIncludeHiddenCells;
         xDiaProp->getPropertyValue( C2U( "StartingAngle" ) ) >>= nStartingAngle;
     }
     catch( const uno::Exception & ex )
@@ -655,6 +657,7 @@
     {
         uno::Reference< XCoordinateSystem > xCooSys( aCooSysList[nCS] );
         VCoordinateSystem* pVCooSys = addCooSysToList(m_rVCooSysList,xCooSys,xChartModel);
+        pVCooSys->setIncludeHiddenCells(bIncludeHiddenCells);
 
         //iterate through all chart types in the current coordinate system
         uno::Reference< XChartTypeContainer > xChartTypeContainer( xCooSys, uno::UNO_QUERY );
@@ -695,7 +698,7 @@
                 uno::Reference< XDataSeries > xDataSeries( aSeriesList[nS], uno::UNO_QUERY );
 		        if(!xDataSeries.is())
 			        continue;
-		        VDataSeries* pSeries = new VDataSeries( xDataSeries );
+		        VDataSeries* pSeries = new VDataSeries( xDataSeries, bIncludeHiddenCells );
 
                 pSeries->setGlobalSeriesIndex(nGlobalSeriesIndex);
                 nGlobalSeriesIndex++;
Index: source/view/main/ChartItemPool.cxx
===================================================================
--- chart2/source/view/main/ChartItemPool.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/main/ChartItemPool.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -197,6 +197,7 @@
     ppPoolDefaults[SCHATTR_DIAGRAM_STYLE        - SCHATTR_START] = new SvxChartStyleItem( CHSTYLE_2D_COLUMN, SCHATTR_DIAGRAM_STYLE );
     ppPoolDefaults[SCHATTR_TEXTBREAK            - SCHATTR_START] = new SfxBoolItem( SCHATTR_TEXTBREAK, FALSE );
     ppPoolDefaults[SCHATTR_GROUP_BARS_PER_AXIS  - SCHATTR_START] = new SfxBoolItem(SCHATTR_GROUP_BARS_PER_AXIS, FALSE);
+    ppPoolDefaults[SCHATTR_INCLUDE_HIDDEN_CELLS - SCHATTR_START] = new SfxBoolItem(SCHATTR_INCLUDE_HIDDEN_CELLS, TRUE);
     ppPoolDefaults[SCHATTR_STARTING_ANGLE       - SCHATTR_START] = new SfxInt32Item( SCHATTR_STARTING_ANGLE, 90 );
     ppPoolDefaults[SCHATTR_CLOCKWISE            - SCHATTR_START] = new SfxBoolItem( SCHATTR_CLOCKWISE, FALSE );
 
Index: source/view/main/VDataSeries.cxx
===================================================================
--- chart2/source/view/main/VDataSeries.cxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/main/VDataSeries.cxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -109,12 +109,11 @@
     }
 }
 
-void VDataSequence::init( const uno::Reference< data::XDataSequence >& xModel )
+void VDataSequence::init( const uno::Reference< data::XDataSequence >& xModel, bool bIncludeHiddenCells )
 {
-    bool bDisplayHiddenCells = true; //todo: make this configurable in future
     bool bIsHidden = false;
     uno::Sequence< sal_Int32 > aHiddenValues;
-    if( !bDisplayHiddenCells )
+    if( !bIncludeHiddenCells )
     {
         uno::Reference<beans::XPropertySet> xProp(xModel, uno::UNO_QUERY );
         if( xProp.is())
@@ -132,10 +131,10 @@
     }
 
     Model = xModel;
-    if( bDisplayHiddenCells || !bIsHidden )
+    if( bIncludeHiddenCells || !bIsHidden )
         Doubles = DataSequenceToDoubleSequence( xModel );
 
-    if( !bDisplayHiddenCells )
+    if( !bIncludeHiddenCells )
     {
         if( bIsHidden )
             Doubles.realloc(0);
@@ -206,7 +205,7 @@
     DBG_ERROR("not implemented");
 }
 
-VDataSeries::VDataSeries( const uno::Reference< XDataSeries >& xDataSeries )
+VDataSeries::VDataSeries( const uno::Reference< XDataSeries >& xDataSeries, bool bIncludeHiddenCells )
     : m_nPolygonIndex(0)
     , m_fLogicMinX(0.0)
     , m_fLogicMaxX(0.0)
@@ -236,6 +235,7 @@
     , m_nAxisIndex(0)
     , m_bConnectBars(sal_False)
     , m_bGroupBarsPerAxis(sal_True)
+    , m_bIncludeHiddenCells(bIncludeHiddenCells)
     , m_nStartingAngle(90)
 
     , m_aSeriesParticle()
@@ -280,17 +280,17 @@
                 aARole >>= aRole;
 
                 if( aRole.equals(C2U("values-x")) )
-                    m_aValues_X.init( xDataSequence );
+                    m_aValues_X.init( xDataSequence, bIncludeHiddenCells );
                 else if( aRole.equals(C2U("values-y")) )
-                    m_aValues_Y.init( xDataSequence );
+                    m_aValues_Y.init( xDataSequence, bIncludeHiddenCells );
                 else if( aRole.equals(C2U("values-min")) )
-                    m_aValues_Y_Min.init( xDataSequence );
+                    m_aValues_Y_Min.init( xDataSequence, bIncludeHiddenCells );
                 else if( aRole.equals(C2U("values-max")) )
-                    m_aValues_Y_Max.init( xDataSequence );
+                    m_aValues_Y_Max.init( xDataSequence, bIncludeHiddenCells );
                 else if( aRole.equals(C2U("values-first")) )
-                    m_aValues_Y_First.init( xDataSequence );
+                    m_aValues_Y_First.init( xDataSequence, bIncludeHiddenCells );
                 else if( aRole.equals(C2U("values-last")) )
-                    m_aValues_Y_Last.init( xDataSequence );
+                    m_aValues_Y_Last.init( xDataSequence, bIncludeHiddenCells );
                 //@todo assign the other roles (+ error for unknown?)
             }
             catch( uno::Exception& e )
@@ -485,6 +485,16 @@
     return m_bGroupBarsPerAxis;
 }
 
+void VDataSeries::setIncludeHiddenCells( sal_Bool bIncludeHiddenCells )
+{
+    m_bIncludeHiddenCells = bIncludeHiddenCells;
+}
+
+sal_Bool VDataSeries::getIncludeHiddenCells() const
+{
+    return m_bIncludeHiddenCells;
+}
+
 void VDataSeries::setStartingAngle( sal_Int32 nStartingAngle )
 {
     m_nStartingAngle = nStartingAngle;
Index: source/view/inc/VDataSeries.hxx
===================================================================
--- chart2/source/view/inc/VDataSeries.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/inc/VDataSeries.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -59,7 +59,7 @@
 {
 public:
     void init( const ::com::sun::star::uno::Reference<
-        ::com::sun::star::chart2::data::XDataSequence >& xModel);
+        ::com::sun::star::chart2::data::XDataSequence >& xModel, bool bIncludeHiddenCells );
     bool is() const;
     void clear();
     double getValue( sal_Int32 index ) const;
@@ -77,7 +77,7 @@
 {
 public:
     VDataSeries( const ::com::sun::star::uno::Reference<
-        ::com::sun::star::chart2::XDataSeries >& xDataSeries );
+        ::com::sun::star::chart2::XDataSeries >& xDataSeries, bool bIncludeHiddenCells );
     virtual ~VDataSeries();
 
     ::com::sun::star::uno::Reference< ::com::sun::star::chart2::XDataSeries >
@@ -138,6 +138,9 @@
     void setGroupBarsPerAxis( sal_Bool bGroupBarsPerAxis );
     sal_Bool getGroupBarsPerAxis() const;
 
+    void setIncludeHiddenCells( sal_Bool bIncludeHiddenCells );
+    sal_Bool getIncludeHiddenCells() const;
+
     void setStartingAngle( sal_Int32 nStartingAngle );
     sal_Int32 getStartingAngle() const;
     
@@ -220,6 +223,8 @@
 
     sal_Bool                m_bGroupBarsPerAxis;
 
+    sal_Bool                m_bIncludeHiddenCells;
+
     sal_Int32               m_nStartingAngle;
 
     rtl::OUString           m_aSeriesParticle;
Index: source/view/inc/VCoordinateSystem.hxx
===================================================================
--- chart2/source/view/inc/VCoordinateSystem.hxx	(.../tags/DEV300_m35/chart2)	(revision 264806)
+++ chart2/source/view/inc/VCoordinateSystem.hxx	(.../cws/koheichart01/chart2)	(revision 264806)
@@ -133,6 +133,9 @@
     virtual bool needSeriesNamesForAxis() const;
     void setSeriesNamesForAxis( const ::com::sun::star::uno::Sequence< rtl::OUString >& rSeriesNames );
 
+    void setIncludeHiddenCells(bool b);
+    bool getIncludeHiddenCells() const;
+
 protected: //methods
     VCoordinateSystem( const ::com::sun::star::uno::Reference<
         ::com::sun::star::chart2::XCoordinateSystem >& xCooSys );
