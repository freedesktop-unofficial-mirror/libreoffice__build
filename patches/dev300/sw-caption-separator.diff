From d5f721add4774601277d9d749da6f7f00cea35bd Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:09:11 +0200
Subject: [PATCH 855/878] sw-caption-separator.diff

---
 sw/source/core/doc/doclay.cxx  |    5 ++++-
 sw/source/ui/frmdlg/cption.cxx |    8 ++++++--
 2 files changed, 10 insertions(+), 3 deletions(-)

diff --git a/sw/source/core/doc/doclay.cxx b/sw/source/core/doc/doclay.cxx
index d47a7a1..99567d1 100644
--- a/sw/source/core/doc/doclay.cxx
+++ b/sw/source/core/doc/doclay.cxx
@@ -1471,7 +1471,10 @@ SwFlyFrmFmt* SwDoc::InsertLabel( const SwLabelType eType, const String &rTxt, co
                 aTxt += ' ';
         }
         xub_StrLen nIdx = aTxt.Len();
-        aTxt += rSeparator;
+        if ( rTxt.Len() > 0 )
+        {
+            aTxt += rSeparator;
+        }
         xub_StrLen nSepIdx = aTxt.Len();
         aTxt += rTxt;
 
diff --git a/sw/source/ui/frmdlg/cption.cxx b/sw/source/ui/frmdlg/cption.cxx
index 10640e4..3c1815c 100644
--- a/sw/source/ui/frmdlg/cption.cxx
+++ b/sw/source/ui/frmdlg/cption.cxx
@@ -382,6 +382,7 @@ IMPL_LINK(SwCaptionDialog, CaptionHdl, PushButton*, EMPTYARG)
 void SwCaptionDialog::DrawSample()
 {
     String aStr;
+    String sCaption = aTextEdit.GetText();
 
     // Nummer
     String sFldTypeName = aCategoryBox.GetText();
@@ -436,9 +437,12 @@ void SwCaptionDialog::DrawSample()
             }
 
         }
-        aStr += aSepEdit.GetText();
+        if( sCaption.Len() > 0 )
+        {
+            aStr += aSepEdit.GetText();
+        }
     }
-    aStr += aTextEdit.GetText();
+    aStr += sCaption;
     // do preview!
     aPrevWin.SetPreviewText( aStr );
 }
-- 
1.7.0.1

