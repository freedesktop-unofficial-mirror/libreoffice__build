From 6f9354c1832b3607a15837b5f8bd7568f618c57e Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:58:59 +0200
Subject: [PATCH 347/878] fpicker-kde-filter-name.diff

---
 fpicker/source/unx/kde/kdefilepicker.cxx |   14 ++++++++++++++
 1 files changed, 14 insertions(+), 0 deletions(-)

diff --git a/fpicker/source/unx/kde/kdefilepicker.cxx b/fpicker/source/unx/kde/kdefilepicker.cxx
index a7314ce..ea16051 100644
--- a/fpicker/source/unx/kde/kdefilepicker.cxx
+++ b/fpicker/source/unx/kde/kdefilepicker.cxx
@@ -715,4 +715,18 @@ void FileFilterComboHack::setCurrentFilter( const QString& filter )
 {
     setCurrentText( filter );
     filterChanged();
+
+    // Workaround for 'Filter name (*.blah)' vs. 'Filter name'
+    if ( currentText() != text( currentItem() ) )
+    {
+        int nItem = 0;
+        for ( ; nItem < count() && !text( nItem ).startsWith( filter ); ++nItem );
+
+        if ( nItem < count() )
+            setCurrentItem( nItem );
+        else
+            setCurrentItem( 0 );
+
+        filterChanged();
+    }
 }
-- 
1.7.0.1

