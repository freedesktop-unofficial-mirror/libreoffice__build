From cf3dcd5704b4898fcf9ab47b7453470327fa0ae8 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:04:25 +0200
Subject: [PATCH 547/768] sw-section-import-fix.diff

---
 sw/source/filter/ww8/ww8par.cxx |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

diff --git sw/source/filter/ww8/ww8par.cxx sw/source/filter/ww8/ww8par.cxx
index 58257ba..85d8f1d 100644
--- sw/source/filter/ww8/ww8par.cxx
+++ sw/source/filter/ww8/ww8par.cxx
@@ -2651,9 +2651,10 @@ bool SwWW8ImplReader::ReadChar(long nPosCp, long nCpOfs)
             else if (!nInTable)
             {
                 // Always insert a txtnode for a column break, e.g. ##
-                AppendTxtNode(*pPaM->GetPoint());
-                rDoc.InsertPoolItem(*pPaM,
-                    SvxFmtBreakItem(SVX_BREAK_COLUMN_BEFORE, RES_BREAK), 0);
+                SwCntntNode *pCntNd=pPaM->GetCntntNode();
+                if (pCntNd!=NULL && pCntNd->Len()>0) // if par is empty not break is needed
+                    AppendTxtNode(*pPaM->GetPoint());
+                rDoc.InsertPoolItem(*pPaM, SvxFmtBreakItem(SVX_BREAK_COLUMN_BEFORE, RES_BREAK), 0);
             }
             break;
         case 0x7:
-- 
1.7.0.1

