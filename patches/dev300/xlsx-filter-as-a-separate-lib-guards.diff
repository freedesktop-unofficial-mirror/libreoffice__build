From 21b748eb586b6aed39541729d193b8ad2e402382 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:05:54 +0200
Subject: [PATCH 693/878] xlsx-filter-as-a-separate-lib-guards.diff

---
 sc/source/filter/inc/XclExpChangeTrack.hxx |    4 ++++
 sc/source/filter/inc/excdoc.hxx            |    4 ++++
 sc/source/filter/inc/excrecds.hxx          |    4 ++++
 sc/source/filter/inc/exp_op.hxx            |    4 ++++
 sc/source/filter/inc/imp_op.hxx            |    4 ++++
 sc/source/filter/inc/xcl97esc.hxx          |    4 ++++
 sc/source/filter/inc/xcl97rec.hxx          |    4 ++++
 sc/source/filter/inc/xechart.hxx           |    4 ++++
 sc/source/filter/inc/xecontent.hxx         |    4 ++++
 sc/source/filter/inc/xeescher.hxx          |    4 ++++
 sc/source/filter/inc/xehelper.hxx          |    4 ++++
 sc/source/filter/inc/xelink.hxx            |    4 ++++
 sc/source/filter/inc/xename.hxx            |    4 ++++
 sc/source/filter/inc/xepage.hxx            |    4 ++++
 sc/source/filter/inc/xepivot.hxx           |    4 ++++
 sc/source/filter/inc/xerecord.hxx          |    4 ++++
 sc/source/filter/inc/xeroot.hxx            |    4 ++++
 sc/source/filter/inc/xestream.hxx          |    4 ++++
 sc/source/filter/inc/xestyle.hxx           |    4 ++++
 sc/source/filter/inc/xetable.hxx           |    4 ++++
 sc/source/filter/inc/xeview.hxx            |    4 ++++
 sc/source/filter/inc/xistyle.hxx           |    4 ++++
 sc/source/filter/inc/xladdress.hxx         |    4 ++++
 sc/source/filter/inc/xlescher.hxx          |    4 ++++
 sc/source/filter/inc/xlpivot.hxx           |    4 ++++
 sc/source/filter/inc/xlview.hxx            |    4 ++++
 sc/source/filter/xlsx/makefile.mk          |    2 ++
 27 files changed, 106 insertions(+), 0 deletions(-)

diff --git a/sc/source/filter/inc/XclExpChangeTrack.hxx b/sc/source/filter/inc/XclExpChangeTrack.hxx
index eb9bf75..6f6350c 100644
--- a/sc/source/filter/inc/XclExpChangeTrack.hxx
+++ b/sc/source/filter/inc/XclExpChangeTrack.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XCLEXPCHANGETRACK_HXX
 #define SC_XCLEXPCHANGETRACK_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <tools/debug.hxx>
 #include <tools/datetime.hxx>
 #include <rtl/uuid.h>
diff --git a/sc/source/filter/inc/excdoc.hxx b/sc/source/filter/inc/excdoc.hxx
index 44cbf14..795c813 100644
--- a/sc/source/filter/inc/excdoc.hxx
+++ b/sc/source/filter/inc/excdoc.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_EXCDOC_HXX
 #define SC_EXCDOC_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <tools/solar.h>
 #include "excrecds.hxx"
 #include "xeroot.hxx"
diff --git a/sc/source/filter/inc/excrecds.hxx b/sc/source/filter/inc/excrecds.hxx
index cae7a21..f5cb465 100644
--- a/sc/source/filter/inc/excrecds.hxx
+++ b/sc/source/filter/inc/excrecds.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_EXCRECDS_HXX
 #define SC_EXCRECDS_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <tools/solar.h>
 #include <svtools/zforlist.hxx>
 #include <tools/string.hxx>
diff --git a/sc/source/filter/inc/exp_op.hxx b/sc/source/filter/inc/exp_op.hxx
index 29e4ec8..d59d355 100644
--- a/sc/source/filter/inc/exp_op.hxx
+++ b/sc/source/filter/inc/exp_op.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_EXP_OP_HXX
 #define SC_EXP_OP_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "filter.hxx"
 #include "root.hxx"
 #include "xeroot.hxx"
diff --git a/sc/source/filter/inc/imp_op.hxx b/sc/source/filter/inc/imp_op.hxx
index d21e554..a3bef76 100644
--- a/sc/source/filter/inc/imp_op.hxx
+++ b/sc/source/filter/inc/imp_op.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_IMP_OP_HXX
 #define SC_IMP_OP_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <tools/gen.hxx>
 #include "xiroot.hxx"
 #include "xistream.hxx"
diff --git a/sc/source/filter/inc/xcl97esc.hxx b/sc/source/filter/inc/xcl97esc.hxx
index c29c161..6977cc0 100644
--- a/sc/source/filter/inc/xcl97esc.hxx
+++ b/sc/source/filter/inc/xcl97esc.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XCL97ESC_HXX
 #define SC_XCL97ESC_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <svx/escherex.hxx>
 #include <tools/table.hxx>
 #include <tools/stack.hxx>
diff --git a/sc/source/filter/inc/xcl97rec.hxx b/sc/source/filter/inc/xcl97rec.hxx
index b1bee6b..5221366 100644
--- a/sc/source/filter/inc/xcl97rec.hxx
+++ b/sc/source/filter/inc/xcl97rec.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XCL97REC_HXX
 #define SC_XCL97REC_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "excrecds.hxx"
 #include "xcl97esc.hxx"
 #include "xlstyle.hxx"
diff --git a/sc/source/filter/inc/xechart.hxx b/sc/source/filter/inc/xechart.hxx
index 8c8a1e2..fd8859a 100644
--- a/sc/source/filter/inc/xechart.hxx
+++ b/sc/source/filter/inc/xechart.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XECHART_HXX
 #define SC_XECHART_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xerecord.hxx"
 #include "xlchart.hxx"
 #include "xlformula.hxx"
diff --git a/sc/source/filter/inc/xecontent.hxx b/sc/source/filter/inc/xecontent.hxx
index a999d97..e62d933 100644
--- a/sc/source/filter/inc/xecontent.hxx
+++ b/sc/source/filter/inc/xecontent.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XECONTENT_HXX
 #define SC_XECONTENT_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "rangelst.hxx"
 #include "xlcontent.hxx"
 #include "xladdress.hxx"
diff --git a/sc/source/filter/inc/xeescher.hxx b/sc/source/filter/inc/xeescher.hxx
index fdd79f0..1463ced 100644
--- a/sc/source/filter/inc/xeescher.hxx
+++ b/sc/source/filter/inc/xeescher.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEESCHER_HXX
 #define SC_XEESCHER_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <vcl/graph.hxx>
 #include "xcl97rec.hxx"
 #include "xlescher.hxx"
diff --git a/sc/source/filter/inc/xehelper.hxx b/sc/source/filter/inc/xehelper.hxx
index 606ce51..66c30cc 100644
--- a/sc/source/filter/inc/xehelper.hxx
+++ b/sc/source/filter/inc/xehelper.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEHELPER_HXX
 #define SC_XEHELPER_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xladdress.hxx"
 #include "xeroot.hxx"
 #include "xestring.hxx"
diff --git a/sc/source/filter/inc/xelink.hxx b/sc/source/filter/inc/xelink.hxx
index ba5d70a..f910e3a 100644
--- a/sc/source/filter/inc/xelink.hxx
+++ b/sc/source/filter/inc/xelink.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XELINK_HXX
 #define SC_XELINK_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "markdata.hxx"
 #include "xllink.hxx"
 #include "xerecord.hxx"
diff --git a/sc/source/filter/inc/xename.hxx b/sc/source/filter/inc/xename.hxx
index f074073..2d01ed5 100644
--- a/sc/source/filter/inc/xename.hxx
+++ b/sc/source/filter/inc/xename.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XENAME_HXX
 #define SC_XENAME_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xerecord.hxx"
 #include "xlname.hxx"
 #include "xlformula.hxx"
diff --git a/sc/source/filter/inc/xepage.hxx b/sc/source/filter/inc/xepage.hxx
index b9454a3..3accd43 100644
--- a/sc/source/filter/inc/xepage.hxx
+++ b/sc/source/filter/inc/xepage.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEPAGE_HXX
 #define SC_XEPAGE_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xerecord.hxx"
 #include "xlpage.hxx"
 #include "xeroot.hxx"
diff --git a/sc/source/filter/inc/xepivot.hxx b/sc/source/filter/inc/xepivot.hxx
index 0c73095..118e0d5 100644
--- a/sc/source/filter/inc/xepivot.hxx
+++ b/sc/source/filter/inc/xepivot.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEPIVOT_HXX
 #define SC_XEPIVOT_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <map>
 #include "xerecord.hxx"
 #include "xlpivot.hxx"
diff --git a/sc/source/filter/inc/xerecord.hxx b/sc/source/filter/inc/xerecord.hxx
index fa3810c..d302722 100644
--- a/sc/source/filter/inc/xerecord.hxx
+++ b/sc/source/filter/inc/xerecord.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XERECORD_HXX
 #define SC_XERECORD_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xlconst.hxx"
 #include "xestream.hxx"
 
diff --git a/sc/source/filter/inc/xeroot.hxx b/sc/source/filter/inc/xeroot.hxx
index ce32a46..0fe11ac 100644
--- a/sc/source/filter/inc/xeroot.hxx
+++ b/sc/source/filter/inc/xeroot.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEROOT_HXX
 #define SC_XEROOT_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xlroot.hxx"
 
 // Forward declarations of objects in public use ==============================
diff --git a/sc/source/filter/inc/xestream.hxx b/sc/source/filter/inc/xestream.hxx
index df284e2..2416473 100644
--- a/sc/source/filter/inc/xestream.hxx
+++ b/sc/source/filter/inc/xestream.hxx
@@ -30,6 +30,10 @@
 #ifndef SC_XESTREAM_HXX
 #define SC_XESTREAM_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <map>
 #include <stack>
 #include <string>
diff --git a/sc/source/filter/inc/xestyle.hxx b/sc/source/filter/inc/xestyle.hxx
index f88d0c4..81b959a 100644
--- a/sc/source/filter/inc/xestyle.hxx
+++ b/sc/source/filter/inc/xestyle.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XESTYLE_HXX
 #define SC_XESTYLE_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <map>
 #include <tools/mempool.hxx>
 #include <tools/string.hxx>
diff --git a/sc/source/filter/inc/xetable.hxx b/sc/source/filter/inc/xetable.hxx
index ea330b3..678c21f 100644
--- a/sc/source/filter/inc/xetable.hxx
+++ b/sc/source/filter/inc/xetable.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XETABLE_HXX
 #define SC_XETABLE_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xltable.hxx"
 
 #include <deque>
diff --git a/sc/source/filter/inc/xeview.hxx b/sc/source/filter/inc/xeview.hxx
index 61e349a..548f691 100644
--- a/sc/source/filter/inc/xeview.hxx
+++ b/sc/source/filter/inc/xeview.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XEVIEW_HXX
 #define SC_XEVIEW_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include "xerecord.hxx"
 #include "xlview.hxx"
 #include "xeroot.hxx"
diff --git a/sc/source/filter/inc/xistyle.hxx b/sc/source/filter/inc/xistyle.hxx
index 009a2fd..396a12f 100644
--- a/sc/source/filter/inc/xistyle.hxx
+++ b/sc/source/filter/inc/xistyle.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XISTYLE_HXX
 #define SC_XISTYLE_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <list>
 #include <tools/mempool.hxx>
 #include "rangelst.hxx"
diff --git a/sc/source/filter/inc/xladdress.hxx b/sc/source/filter/inc/xladdress.hxx
index 0ac5ca3..f132503 100644
--- a/sc/source/filter/inc/xladdress.hxx
+++ b/sc/source/filter/inc/xladdress.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XLADDRESS_HXX
 #define SC_XLADDRESS_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <vector>
 #include "address.hxx"
 
diff --git a/sc/source/filter/inc/xlescher.hxx b/sc/source/filter/inc/xlescher.hxx
index 962eb41..4569134 100644
--- a/sc/source/filter/inc/xlescher.hxx
+++ b/sc/source/filter/inc/xlescher.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XLESCHER_HXX
 #define SC_XLESCHER_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <vcl/mapunit.hxx>
 #include "fapihelper.hxx"
 #include "xladdress.hxx"
diff --git a/sc/source/filter/inc/xlpivot.hxx b/sc/source/filter/inc/xlpivot.hxx
index d11006e..c7d8fb1 100644
--- a/sc/source/filter/inc/xlpivot.hxx
+++ b/sc/source/filter/inc/xlpivot.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XLPIVOT_HXX
 #define SC_XLPIVOT_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <com/sun/star/sheet/GeneralFunction.hpp>
 #include <com/sun/star/sheet/DataPilotFieldOrientation.hpp>
 #include <com/sun/star/sheet/DataPilotFieldSortMode.hpp>
diff --git a/sc/source/filter/inc/xlview.hxx b/sc/source/filter/inc/xlview.hxx
index ba32294..3a1f55f 100644
--- a/sc/source/filter/inc/xlview.hxx
+++ b/sc/source/filter/inc/xlview.hxx
@@ -28,6 +28,10 @@
 #ifndef SC_XLVIEW_HXX
 #define SC_XLVIEW_HXX
 
+#ifdef XLSX_GUARD
+#error Should not include this from sc/source/filter/xlsx code
+#endif
+
 #include <map>
 #include <tools/color.hxx>
 #include "ftools.hxx"
diff --git a/sc/source/filter/xlsx/makefile.mk b/sc/source/filter/xlsx/makefile.mk
index c59deea..68f1ddd 100644
--- a/sc/source/filter/xlsx/makefile.mk
+++ b/sc/source/filter/xlsx/makefile.mk
@@ -48,6 +48,8 @@ PROJECTPCHSOURCE=..\pch\filt_pch
 
 # --- Files --------------------------------------------------------
 
+CDEFS+=-DXLSX_GUARD
+
 SLOFILES =	\
         $(SLO)$/xlsx-excdoc.obj					\
         $(SLO)$/xlsx-excrecds.obj				\
-- 
1.7.0.1

