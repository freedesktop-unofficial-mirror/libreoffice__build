From dca5534343aad0b24d31ebdb2fa42e93c18a47c6 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:06:21 +0200
Subject: [PATCH 708/878] sd-create-table-height-fix.diff

---
 sd/source/ui/table/tablefunction.cxx |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/sd/source/ui/table/tablefunction.cxx b/sd/source/ui/table/tablefunction.cxx
index 5f2ca45..fac0f47 100644
--- a/sd/source/ui/table/tablefunction.cxx
+++ b/sd/source/ui/table/tablefunction.cxx
@@ -67,6 +67,7 @@
 #include "DrawViewShell.hxx"
 #include "drawdoc.hxx"
 #include "DrawDocShell.hxx"
+#include "Outliner.hxx"
 #include "Window.hxx"
 #include "drawview.hxx"
 #include "sdresid.hxx"
@@ -147,7 +148,11 @@ void DrawViewShell::FuTable(SfxRequest& rReq)
             nRows = pDlg->getRows();
         }
 
-        Size aSize( 14100, 200 );
+        Size aSize( 14100, 3000 );
+
+        ::sd::Outliner* pSdOutliner = GetDoc()->GetOutliner();
+        const long nTextHeight = pSdOutliner->GetTextHeight();
+        aSize.Height() = std::max(aSize.Height(),nRows*nTextHeight);
 
         Point aPos;
         Rectangle aWinRect(aPos, GetActiveWindow()->GetOutputSizePixel() );
-- 
1.7.0.1

