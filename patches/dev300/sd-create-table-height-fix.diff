Make initial table row height default to font height

From: Thorsten Behrens <thb@openoffice.org>


---

 sd/source/ui/table/tablefunction.cxx |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)


diff --git sd/source/ui/table/tablefunction.cxx sd/source/ui/table/tablefunction.cxx
index 3485f09..6123080 100755
--- sd/source/ui/table/tablefunction.cxx
+++ sd/source/ui/table/tablefunction.cxx
@@ -67,6 +67,7 @@
 #include "DrawViewShell.hxx"
 #include "drawdoc.hxx"
 #include "DrawDocShell.hxx"
+#include "Outliner.hxx"
 #include "Window.hxx"
 #include "drawview.hxx"
 #include "sdresid.hxx"
@@ -158,8 +159,12 @@ void DrawViewShell::FuTable(SfxRequest& rReq)
         }
         else
         {
-            Size aSize( 14100, 200 );
+            Size aSize( 14100, 3000 );
 
+            ::sd::Outliner* pSdOutliner = GetDoc()->GetOutliner();
+            const long nTextHeight = pSdOutliner->GetTextHeight();
+            aSize.Height() = std::max(aSize.Height(),nRows*nTextHeight);
+            
             Point aPos;
             Rectangle aWinRect(aPos, GetActiveWindow()->GetOutputSizePixel() );
             aPos = aWinRect.Center();
