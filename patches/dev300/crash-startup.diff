From bfb4737ebdb2dbf38c74f15c6029e70aabe33e08 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 16:58:42 +0200
Subject: [PATCH 331/878] crash-startup.diff

---
 vcl/source/gdi/makefile.mk      |    1 +
 vcl/unx/gtk/window/gtkframe.cxx |    8 +++++++-
 2 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/vcl/source/gdi/makefile.mk b/vcl/source/gdi/makefile.mk
index e67e8f1..1e07783 100644
--- a/vcl/source/gdi/makefile.mk
+++ b/vcl/source/gdi/makefile.mk
@@ -114,6 +114,7 @@ SLOFILES=	$(SLO)$/salmisc.obj 	\
             $(SLO)$/graphictools.obj
 
 EXCEPTIONSFILES=	$(SLO)$/salmisc.obj 	\
+            $(SLO)$/bitmapex.obj	\
                     $(SLO)$/outdev.obj		\
                     $(SLO)$/outdev3.obj 	\
                     $(SLO)$/gfxlink.obj		\
diff --git a/vcl/unx/gtk/window/gtkframe.cxx b/vcl/unx/gtk/window/gtkframe.cxx
index 55c6107..3b4a2ae 100644
--- a/vcl/unx/gtk/window/gtkframe.cxx
+++ b/vcl/unx/gtk/window/gtkframe.cxx
@@ -1141,7 +1141,13 @@ void GtkSalFrame::SetIcon( USHORT nIcon )
     {
         // #i44723# workaround gcc temporary problem
         ResId aResId( nOffsets[nIndex] + nIcon, *ImplGetResMgr() );
-        BitmapEx aIcon( aResId );
+        BitmapEx aIcon;
+        try {
+            aIcon = BitmapEx( aResId );
+        } catch (com::sun::star::uno::RuntimeException &) {
+            // UCB not initialized for splash screen creation; very exceptional.
+            continue;
+        }
 
         // #i81083# convert to 24bit/8bit alpha bitmap
         Bitmap aBmp = aIcon.GetBitmap();
-- 
1.7.0.1

