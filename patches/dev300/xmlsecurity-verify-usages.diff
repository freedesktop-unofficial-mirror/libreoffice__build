--- xmlsecurity/source/xmlsec/nss/securityenvironment_nssimpl.cxx~	2007-03-15 15:37:47.000000000 -0400
+++ xmlsecurity/source/xmlsec/nss/securityenvironment_nssimpl.cxx	2007-03-19 11:14:07.000000000 -0400
@@ -796,10 +828,12 @@ sal_Int32 SecurityEnvironment_NssImpl ::
             //The expression  if ( flags & CERTDB_TRUSTED ) fails. This occurred with openssl 
             //generated certificates, when the trust settings of the root certificate had only the 
             //item "This certificate can identify web sites" checked.
-            if (usage & certificateUsageEmailSigner
-                || usage & certificateUsageEmailRecipient
-                || usage & certificateUsageSSLCA
-                /*|| usage & certificateUsageSSLClient*/)
+	    if (usage & (certificateUsageEmailSigner
+			 | certificateUsageEmailRecipient
+			 | certificateUsageSSLCA
+			 | certificateUsageProtectedObjectSigner
+			 | certificateUsageObjectSigner
+			 /* | certificateUsageSSLClient*/))
                 validity = csss::CertificateValidity::VALID;
             else
                 validity = csss::CertificateValidity::INVALID;
