--- sc/prj/build.lst
+++ sc/prj/build.lst
@@ -35,6 +35,7 @@ sc	sc\source\ui\unoobj					nmake	-	all	sc_unobj sc_sdi sc_inc NULL
 sc	sc\source\ui\vba					nmake	-	all	sc_vba sc_sdi sc_inc NULL
 sc	sc\source\ui\view					nmake	-	all	sc_view sc_sdi sc_inc NULL
 sc	sc\source\filter\excel					nmake	-	all	sc_excel sc_vba sc_sdi sc_inc NULL
+sc	sc\source\filter\xlsx					nmake	-	all	sc_xlsx sc_vba sc_sdi sc_inc NULL
 sc	sc\source\filter\ftools					nmake	-	all	sc_ftools sc_sdi sc_inc NULL
 sc	sc\source\filter\lotus					nmake	-	all	sc_lotus sc_sdi sc_inc NULL
 sc	sc\source\filter\qpro					nmake	-	all	sc_qpro sc_sdi sc_inc NULL
@@ -48,4 +49,4 @@ sc	sc\addin						nmake	-	all	sc_add sc_sdi sc_inc NULL
 sc	sc\addin\datefunc					nmake	-	all	sc_addfu sc_add sc_sdi sc_inc NULL
 sc	sc\addin\rot13						nmake	-	all	sc_adrot sc_add sc_sdi sc_inc NULL
 sc	sc\addin\util						nmake	-	all	sc_adutil sc_addfu sc_adrot sc_sdi sc_inc NULL
-sc	sc\util							nmake	-	all	sc_util sc_addfu sc_adrot sc_adutil sc_app sc_attr sc_cctrl sc_cosrc sc_data sc_dbgui sc_dif sc_docsh sc_drfnc sc_excel sc_form sc_html sc_lotus sc_qpro sc_misc sc_name sc_nvipi sc_opt sc_page sc_rtf sc_scalc sc_style sc_tool sc_uisrc sc_undo sc_unobj sc_view sc_xcl97 sc_xml sc_acc sc_ftools sc_inc sc_vba NULL
+sc	sc\util							nmake	-	all	sc_util sc_addfu sc_adrot sc_adutil sc_app sc_attr sc_cctrl sc_cosrc sc_data sc_dbgui sc_dif sc_docsh sc_drfnc sc_excel sc_xlsx sc_form sc_html sc_lotus sc_qpro sc_misc sc_name sc_nvipi sc_opt sc_page sc_rtf sc_scalc sc_style sc_tool sc_uisrc sc_undo sc_unobj sc_view sc_xcl97 sc_xml sc_acc sc_ftools sc_inc sc_vba NULL
--- sc/prj/d.lst
+++ sc/prj/d.lst
@@ -22,6 +22,7 @@ mkdir: %_DEST%\xml%_EXT%\uiconfig\modules\scalc\statusbar
 ..\%__SRC%\bin\scui?????.dll %_DEST%\bin%_EXT%\scui?????.dll
 ..\%__SRC%\bin\dfa?????.dll %_DEST%\bin%_EXT%\dfa?????.dll
 ..\%__SRC%\bin\rot?????.dll %_DEST%\bin%_EXT%\rot?????.dll
+..\%__SRC%\bin\xlsx*.dll %_DEST%\bin%_EXT%\xlsx*.dll
 ..\%__SRC%\bin\vba*.* %_DEST%\bin%_EXT%\vba*.*
 ..\%__SRC%\bin\addin.zip %_DEST%\bin%_EXT%\addin.zip
 ..\%__SRC%\misc\*.map %_DEST%\bin%_EXT%\*.map
--- /dev/null
+++ sc/source/filter/xlsx/makefile.mk
@@ -0,0 +1,130 @@
+#*************************************************************************
+#
+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+#
+# Copyright 2008 by Sun Microsystems, Inc.
+#
+# OpenOffice.org - a multi-platform office productivity suite
+#
+# $RCSfile: makefile.mk,v $
+#
+# $Revision: 1.42.90.3 $
+#
+# This file is part of OpenOffice.org.
+#
+# OpenOffice.org is free software: you can redistribute it and/or modify
+# it under the terms of the GNU Lesser General Public License version 3
+# only, as published by the Free Software Foundation.
+#
+# OpenOffice.org is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Lesser General Public License version 3 for more details
+# (a copy is included in the LICENSE file that accompanied this code).
+#
+# You should have received a copy of the GNU Lesser General Public License
+# version 3 along with OpenOffice.org.  If not, see
+# <http://www.openoffice.org/license.html>
+# for a copy of the LGPLv3 License.
+#
+#*************************************************************************
+
+PRJ=..$/..$/..
+
+PRJNAME=sc
+TARGET=xlsx
+
+AUTOSEG=true
+
+PROJECTPCH4DLL=TRUE
+PROJECTPCH=filt_pch
+PROJECTPCHSOURCE=..\pch\filt_pch
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  scpre.mk
+.INCLUDE :  settings.mk
+.INCLUDE :  sc.mk
+
+# --- Files --------------------------------------------------------
+
+SLOFILES =	\
+		$(SLO)$/xlsx-excdoc.obj					\
+		$(SLO)$/xlsx-excrecds.obj				\
+		$(SLO)$/xlsx-exctools.obj				\
+		$(SLO)$/xlsx-expop2.obj					\
+		$(SLO)$/xlsx-fontbuff.obj				\
+		$(SLO)$/xlsx-frmbase.obj					\
+		$(SLO)$/xlsx-namebuff.obj				\
+		$(SLO)$/xlsx-tokstack.obj				\
+		$(SLO)$/xlsx-xechart.obj					\
+		$(SLO)$/xlsx-xecontent.obj				\
+		$(SLO)$/xlsx-xeescher.obj				\
+		$(SLO)$/xlsx-xeformula.obj				\
+		$(SLO)$/xlsx-xehelper.obj				\
+		$(SLO)$/xlsx-xelink.obj					\
+		$(SLO)$/xlsx-xename.obj					\
+		$(SLO)$/xlsx-xepage.obj					\
+		$(SLO)$/xlsx-xepivot.obj					\
+		$(SLO)$/xlsx-xerecord.obj				\
+		$(SLO)$/xlsx-xeroot.obj					\
+		$(SLO)$/xlsx-xestream.obj				\
+		$(SLO)$/xlsx-xestring.obj				\
+		$(SLO)$/xlsx-xestyle.obj					\
+		$(SLO)$/xlsx-xetable.obj					\
+		$(SLO)$/xlsx-xeview.obj					\
+		$(SLO)$/xlsx-xladdress.obj				\
+		$(SLO)$/xlsx-xlchart.obj					\
+		$(SLO)$/xlsx-xlescher.obj				\
+		$(SLO)$/xlsx-xlformula.obj				\
+		$(SLO)$/xlsx-xlpage.obj					\
+		$(SLO)$/xlsx-xlpivot.obj					\
+		$(SLO)$/xlsx-xlroot.obj					\
+		$(SLO)$/xlsx-xlstyle.obj					\
+		$(SLO)$/xlsx-xltools.obj					\
+		$(SLO)$/xlsx-xltoolbar.obj					\
+		$(SLO)$/xlsx-xltracer.obj				\
+		$(SLO)$/xlsx-XclExpChangeTrack.obj				\
+		$(SLO)$/xlsx-xcl97esc.obj				\
+		$(SLO)$/xlsx-xcl97rec.obj				\
+		$(SLO)$/xlsx-xlview.obj
+
+.IF "$(OS)$(COM)$(CPUNAME)"=="LINUXGCCSPARC"
+NOOPTFILES = \
+		$(SLO)$/xlsx-xiescher.obj
+.ENDIF
+
+EXCEPTIONSFILES = \
+		$(SLO)$/xlsx-excdoc.obj					\
+		$(SLO)$/xlsx-excrecds.obj				\
+		$(SLO)$/xlsx-expop2.obj					\
+		$(SLO)$/xlsx-namebuff.obj				\
+		$(SLO)$/xlsx-tokstack.obj				\
+		$(SLO)$/xlsx-xecontent.obj				\
+		$(SLO)$/xlsx-xeescher.obj				\
+		$(SLO)$/xlsx-xeformula.obj				\
+		$(SLO)$/xlsx-xehelper.obj				\
+		$(SLO)$/xlsx-xelink.obj					\
+		$(SLO)$/xlsx-xename.obj					\
+		$(SLO)$/xlsx-xepage.obj					\
+		$(SLO)$/xlsx-xepivot.obj					\
+		$(SLO)$/xlsx-xechart.obj					\
+		$(SLO)$/xlsx-xestream.obj				\
+		$(SLO)$/xlsx-xestring.obj				\
+		$(SLO)$/xlsx-xestyle.obj					\
+		$(SLO)$/xlsx-xetable.obj					\
+		$(SLO)$/xlsx-xeview.obj					\
+		$(SLO)$/xlsx-xladdress.obj				\
+		$(SLO)$/xlsx-xlchart.obj					\
+		$(SLO)$/xlsx-xlformula.obj				\
+		$(SLO)$/xlsx-xlpivot.obj					\
+		$(SLO)$/xlsx-xlstyle.obj					\
+		$(SLO)$/xlsx-xltoolbar.obj					\
+		$(SLO)$/xlsx-xcl97esc.obj				\
+		$(SLO)$/xlsx-xcl97rec.obj				\
+		$(SLO)$/xlsx-xlview.obj
+
+# --- Targets -------------------------------------------------------
+
+.INCLUDE :  target.mk
+
--- sc/util/makefile.mk
+++ sc/util/makefile.mk
@@ -214,6 +214,52 @@ SHL6STDLIBS= \
 	$(SAXLIB) \
     $(FORLIB)
 
+# xlsx filter
+LIB7TARGET = $(SLB)$/xlsx2.lib
+LIB7OBJFILES = \
+		$(SLO)$/fapihelper.obj				\
+		$(SLO)$/fprogressbar.obj			\
+		$(SLO)$/ftools.obj
+
+SHL7TARGET= xlsx$(DLLPOSTFIX)
+SHL7IMPLIB= xlsximp
+SHL7LIBS= \
+	$(LIB7TARGET) \
+	$(SLB)$/xlsx.lib
+SHL7VERSIONMAP= xlsx.map
+SHL7DEF=$(MISC)$/$(SHL7TARGET).def
+DEF7NAME= $(SHL7TARGET)
+SHL7DEPN=$(SHL1TARGETN) $(LIB7TARGETN)
+SHL7STDLIBS= \
+	$(ISCLIB) \
+	$(BASICLIB)	\
+	$(SFXLIB)		\
+	$(SVTOOLLIB)	\
+	$(SVLLIB)		\
+	$(SVXCORELIB)		\
+	$(SVXMSFILTERLIB)		\
+	$(SVXLIB)		\
+	$(GOODIESLIB)	\
+    $(BASEGFXLIB) \
+	$(VCLLIB)		\
+	$(CPPULIB)		\
+	$(CPPUHELPERLIB)	\
+	$(COMPHELPERLIB)	\
+	$(UCBHELPERLIB)	\
+	$(TKLIB)		\
+	$(VOSLIB)		\
+	$(SALLIB)		\
+	$(TOOLSLIB)	\
+	$(I18NISOLANGLIB) \
+	$(UNOTOOLSLIB) \
+	$(SOTLIB)		\
+	$(XMLOFFLIB)	\
+	$(DBTOOLSLIB)	\
+	$(AVMEDIALIB)   \
+	$(OOXLIB)       \
+	$(SAXLIB) \
+    $(FORLIB)
+
 # add for scui
 SHL8TARGET= scui$(DLLPOSTFIX)
 SHL8IMPLIB= scuiimp
--- /dev/null
+++ sc/util/xlsx.map
@@ -0,0 +1,9 @@
+XLSX_1_0 {
+        global:
+                component_getImplementationEnvironment;
+                component_writeInfo;
+                component_getFactory;
+
+        local:
+                *;
+};
--- sc/source/filter/excel/excel.cxx
+++ sc/source/filter/excel/excel.cxx
@@ -250,25 +250,10 @@ static FltError lcl_ExportExcelBiff( SfxMedium& rMedium, ScDocument *pDocument,
     return eRet;
 }
 
-static FltError lcl_ExportExcel2007Xml( SfxMedium& rMedium, ScDocument *pDocument,
-        SvStream* pMedStrm, CharSet eNach )
-{
-    SotStorageRef xRootStrg = (SotStorage*) 0;
-
-    XclExpRootData aExpData( EXC_BIFF8, rMedium, xRootStrg, *pDocument, eNach );
-    aExpData.meOutput = EXC_OUTPUT_XML_2007;
-
-    ExportXml2007 aFilter( aExpData, *pMedStrm );
-
-    FltError eRet = aFilter.Write();
-
-    return eRet;
-}
-
 FltError ScFormatFilterPluginImpl::ScExportExcel5( SfxMedium& rMedium, ScDocument *pDocument,
     ExportFormatExcel eFormat, CharSet eNach )
 {
-    if( eFormat != ExpBiff5 && eFormat != ExpBiff8 && eFormat != Exp2007Xml )
+    if( eFormat != ExpBiff5 && eFormat != ExpBiff8 )
         return eERR_NI;
 
     // check the passed Calc document
@@ -283,8 +268,6 @@ FltError ScFormatFilterPluginImpl::ScExportExcel5( SfxMedium& rMedium, ScDocumen
     FltError eRet = eERR_UNKN_BIFF;
     if( eFormat == ExpBiff5 || eFormat == ExpBiff8 )
         eRet = lcl_ExportExcelBiff( rMedium, pDocument, pMedStrm, eFormat == ExpBiff8, eNach );
-    else if( eFormat == Exp2007Xml )
-        eRet = lcl_ExportExcel2007Xml( rMedium, pDocument, pMedStrm, eNach );
 
 	return eRet;
 }
--- /dev/null	2009-02-23 19:06:18.000000000 +0100
+++ sc/source/filter/ftools/filterplugin.cxx	2009-04-30 16:19:19.000000000 +0200
@@ -0,0 +1,15 @@
+#include "ftools.hxx"
+
+// ============================================================================
+
+ScFormatFilterPluginImpl::ScFormatFilterPluginImpl()
+{
+}
+
+ScFormatFilterPlugin * SAL_CALL ScFilterCreate(void)
+{
+    return new ScFormatFilterPluginImpl();
+}
+
+// implementation class inside the filters
+
--- sc/source/filter/ftools/ftools.cxx	2009-04-30 16:20:32.000000000 +0200
+++ sc/source/filter/ftools/ftools.cxx	2009-04-30 16:21:12.000000000 +0200
@@ -390,16 +390,3 @@ bool ScfTools::GetHTMLNameFromName( cons
     return rName.Len() > 0;
 }
 
-// ============================================================================
-
-ScFormatFilterPluginImpl::ScFormatFilterPluginImpl()
-{
-}
-
-ScFormatFilterPlugin * SAL_CALL ScFilterCreate(void)
-{
-    return new ScFormatFilterPluginImpl();
-}
-
-// implementation class inside the filters
-
--- sc/source/filter/ftools/makefile.mk	2009-04-30 16:20:44.000000000 +0200
+++ sc/source/filter/ftools/makefile.mk	2009-04-30 16:21:09.000000000 +0200
@@ -51,6 +51,7 @@ PROJECTPCHSOURCE=..\pch\filt_pch
 SLOFILES =	\
 		$(SLO)$/fapihelper.obj				\
 		$(SLO)$/fprogressbar.obj			\
+		$(SLO)$/filterplugin.obj			\
 		$(SLO)$/ftools.obj
 
 EXCEPTIONSFILES = \
