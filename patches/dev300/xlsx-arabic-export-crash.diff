From 4bbd85c4b34faa866a8eea75282478030e3c4459 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:05:58 +0200
Subject: [PATCH 611/768] xlsx-arabic-export-crash.diff

---
 sc/source/filter/xlsx/xlsx-xetable.cxx |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git sc/source/filter/xlsx/xlsx-xetable.cxx sc/source/filter/xlsx/xlsx-xetable.cxx
index 0e169bf..b52b5c0 100644
--- sc/source/filter/xlsx/xlsx-xetable.cxx
+++ sc/source/filter/xlsx/xlsx-xetable.cxx
@@ -894,7 +894,7 @@ XclExpFormulaCell::XclExpFormulaCell(
         mxAddRec = rShrfmlaBfr.CreateOrExtendShrfmla( rScTokArr, aScPos );
 
     // no shared formula found - create a simple cell formula
-    if( !mxAddRec )
+    if( !mxAddRec || ! mxTokArr )
         mxTokArr = rRoot.GetFormulaCompiler().CreateFormula( EXC_FMLATYPE_CELL, rScTokArr, &aScPos );
 }
 
-- 
1.7.0.1

