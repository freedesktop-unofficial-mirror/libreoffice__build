From 0f99bce1c06a47ba9677a35a13ec68903282d247 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:05:58 +0200
Subject: [PATCH 694/878] xlsx-arabic-export-crash.diff

---
 sc/source/filter/xlsx/xlsx-xetable.cxx |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/sc/source/filter/xlsx/xlsx-xetable.cxx b/sc/source/filter/xlsx/xlsx-xetable.cxx
index 0e169bf..b52b5c0 100644
--- a/sc/source/filter/xlsx/xlsx-xetable.cxx
+++ b/sc/source/filter/xlsx/xlsx-xetable.cxx
@@ -894,7 +894,7 @@ XclExpFormulaCell::XclExpFormulaCell(
         mxAddRec = rShrfmlaBfr.CreateOrExtendShrfmla( rScTokArr, aScPos );
 
     // no shared formula found - create a simple cell formula
-    if( !mxAddRec )
+    if( !mxAddRec || ! mxTokArr )
         mxTokArr = rRoot.GetFormulaCompiler().CreateFormula( EXC_FMLATYPE_CELL, rScTokArr, &aScPos );
 }
 
-- 
1.7.0.1

