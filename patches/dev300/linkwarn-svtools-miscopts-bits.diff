From 3bf5ca832a1e98db4bedcd283fe1ea131c2caf95 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:04:19 +0200
Subject: [PATCH 615/878] linkwarn-svtools-miscopts-bits.diff

---
 svtools/inc/svtools/miscopt.hxx   |    4 ++
 svtools/source/config/miscopt.cxx |   59 +++++++++++++++++++++++++++++++++++-
 2 files changed, 61 insertions(+), 2 deletions(-)

diff --git a/svtools/inc/svtools/miscopt.hxx b/svtools/inc/svtools/miscopt.hxx
index 7db48d8..ed84a2d 100644
--- a/svtools/inc/svtools/miscopt.hxx
+++ b/svtools/inc/svtools/miscopt.hxx
@@ -140,6 +140,10 @@ class SVT_DLLPUBLIC SvtMiscOptions: public svt::detail::Options
         sal_Bool    UseSystemPrintDialog() const;
         void        SetUseSystemPrintDialog( sal_Bool bSet );
         
+        sal_Bool    ShowLinkWarningDialog() const;
+        void        SetShowLinkWarningDialog( sal_Bool bSet );
+        sal_Bool    IsShowLinkWarningDialogReadOnly() const;
+
     //-------------------------------------------------------------------------------------------------------------
     //	private methods
     //-------------------------------------------------------------------------------------------------------------
diff --git a/svtools/source/config/miscopt.cxx b/svtools/source/config/miscopt.cxx
index f62bb97..784461c 100644
--- a/svtools/source/config/miscopt.cxx
+++ b/svtools/source/config/miscopt.cxx
@@ -84,8 +84,10 @@ using namespace ::com::sun::star;
 #define PROPERTYHANDLE_USESYSTEMPRINTDIALOG	5
 #define PROPERTYNAME_TRYODMADIALOG	ASCII_STR("TryODMADialog")
 #define PROPERTYHANDLE_TRYODMADIALOG	6
+#define PROPERTYNAME_SHOWLINKWARNINGDIALOG	ASCII_STR("ShowLinkWarningDialog")
+#define PROPERTYHANDLE_SHOWLINKWARNINGDIALOG 7
 
-#define PROPERTYCOUNT						7
+#define PROPERTYCOUNT						8
 
 #define VCL_TOOLBOX_STYLE_FLAT				((USHORT)0x0004) // from <vcl/toolbox.hxx>
 
@@ -116,6 +118,8 @@ class SvtMiscOptions_Impl : public ConfigItem
     sal_Bool    m_bIsToolboxStyleRO;
     sal_Bool    m_bUseSystemPrintDialog;
     sal_Bool    m_bIsUseSystemPrintDialogRO;
+    sal_Bool    m_bShowLinkWarningDialog;
+    sal_Bool    m_bIsShowLinkWarningDialogRO;
 
     //-------------------------------------------------------------------------------------------------------------
     //	public methods
@@ -241,6 +245,15 @@ class SvtMiscOptions_Impl : public ConfigItem
         inline sal_Bool IsUseSystemPrintDialogReadOnly() const
         { return m_bIsUseSystemPrintDialogRO; }
 
+        inline sal_Bool ShowLinkWarningDialog() const
+        { return m_bShowLinkWarningDialog; }
+
+        void SetShowLinkWarningDialog( sal_Bool bSet )
+        {  m_bShowLinkWarningDialog = bSet; SetModified(); }
+
+        sal_Bool IsShowLinkWarningDialogReadOnly() const
+        { return m_bIsShowLinkWarningDialogRO; }
+
         void AddListener( const Link& rLink );
         void RemoveListener( const Link& rLink );
         void CallListeners();
@@ -328,6 +341,8 @@ SvtMiscOptions_Impl::SvtMiscOptions_Impl()
     , m_bIsToolboxStyleRO( sal_False )
     , m_bUseSystemPrintDialog( sal_False )
     , m_bIsUseSystemPrintDialogRO( sal_False )
+    , m_bShowLinkWarningDialog( sal_True )
+    , m_bIsShowLinkWarningDialogRO( sal_False )
 
 {
     // Use our static list of configuration keys to get his values.
@@ -410,6 +425,16 @@ SvtMiscOptions_Impl::SvtMiscOptions_Impl()
                 break;
             }
 
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG :
+            {
+                if( !(seqValues[nProperty] >>= m_bShowLinkWarningDialog) )
+                {
+                    DBG_ERROR("Wrong type of \"Misc\\ShowLinkWarningDialog\"!" );
+                }
+                m_bIsShowLinkWarningDialogRO = seqRO[nProperty];
+                break;
+            }
+
             case PROPERTYHANDLE_SYMBOLSTYLE :
             {
                 ::rtl::OUString aSymbolsStyle;
@@ -520,6 +545,13 @@ void SvtMiscOptions_Impl::Load( const Sequence< OUString >& rPropertyNames )
                                                             }
                                                         }
                                                     break;
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG     :   {
+                                                            if( !(seqValues[nProperty] >>= m_bShowLinkWarningDialog) )
+                                                            {
+                                                                DBG_ERROR("Wrong type of \"Misc\\ShowLinkWarningDialog\"!" );
+                                                            }
+                                                        }
+                                                    break;
             case PROPERTYHANDLE_SYMBOLSTYLE         :   {
                                                             ::rtl::OUString aSymbolsStyle;
                                                             if( seqValues[nProperty] >>= aSymbolsStyle )
@@ -686,6 +718,13 @@ void SvtMiscOptions_Impl::Commit()
                     seqValues[nProperty] <<= m_bUseSystemPrintDialog;
                 break;
             }
+
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG :
+            {
+                if ( !m_bIsShowLinkWarningDialogRO )
+                    seqValues[nProperty] <<= m_bShowLinkWarningDialog;
+                break;
+            }
         }
     }
     // Set properties in configuration.
@@ -706,7 +745,8 @@ Sequence< OUString > SvtMiscOptions_Impl::GetPropertyNames()
         PROPERTYNAME_USESYSTEMFILEDIALOG,
         PROPERTYNAME_SYMBOLSTYLE,
         PROPERTYNAME_USESYSTEMPRINTDIALOG,
-        PROPERTYNAME_TRYODMADIALOG
+        PROPERTYNAME_TRYODMADIALOG,
+        PROPERTYNAME_SHOWLINKWARNINGDIALOG
     };
 
     // Initialize return sequence with these list ...
@@ -892,6 +932,21 @@ void SvtMiscOptions::SetUseSystemPrintDialog( sal_Bool bEnable )
     m_pDataContainer->SetUseSystemPrintDialog( bEnable );
 }
 
+sal_Bool SvtMiscOptions::ShowLinkWarningDialog() const
+{
+    return m_pDataContainer->ShowLinkWarningDialog();
+}
+
+void SvtMiscOptions::SetShowLinkWarningDialog( sal_Bool bSet )
+{
+    m_pDataContainer->SetShowLinkWarningDialog( bSet );
+}
+
+sal_Bool SvtMiscOptions::IsShowLinkWarningDialogReadOnly() const
+{
+    return m_pDataContainer->IsShowLinkWarningDialogReadOnly();
+}
+
 //*****************************************************************************************************************
 //	private method
 //*****************************************************************************************************************
-- 
1.7.0.1

