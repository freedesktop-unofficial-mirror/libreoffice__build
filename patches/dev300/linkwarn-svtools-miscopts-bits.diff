From 3a7982a0daadcdb00b0f3f41d2b43aa489ebcbe0 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:04:19 +0200
Subject: [PATCH 542/768] linkwarn-svtools-miscopts-bits.diff

---
 svtools/inc/svtools/miscopt.hxx   |    4 ++
 svtools/source/config/miscopt.cxx |   59 +++++++++++++++++++++++++++++++++++-
 2 files changed, 61 insertions(+), 2 deletions(-)

diff --git svtools/inc/svtools/miscopt.hxx svtools/inc/svtools/miscopt.hxx
index c810068..a316429 100644
--- svtools/inc/svtools/miscopt.hxx
+++ svtools/inc/svtools/miscopt.hxx
@@ -139,6 +139,10 @@ class SVT_DLLPUBLIC SvtMiscOptions: public utl::detail::Options
 
         sal_Bool    UseSystemPrintDialog() const;
         void        SetUseSystemPrintDialog( sal_Bool bSet );
+        
+        sal_Bool    ShowLinkWarningDialog() const;
+        void        SetShowLinkWarningDialog( sal_Bool bSet );
+        sal_Bool    IsShowLinkWarningDialogReadOnly() const;
 
     //-------------------------------------------------------------------------------------------------------------
     //	private methods
diff --git svtools/source/config/miscopt.cxx svtools/source/config/miscopt.cxx
index 10b2574..cb7885a 100644
--- svtools/source/config/miscopt.cxx
+++ svtools/source/config/miscopt.cxx
@@ -80,8 +80,10 @@ using namespace ::com::sun::star;
 #define PROPERTYHANDLE_USESYSTEMPRINTDIALOG	5
 #define PROPERTYNAME_TRYODMADIALOG	ASCII_STR("TryODMADialog")
 #define PROPERTYHANDLE_TRYODMADIALOG	6
+#define PROPERTYNAME_SHOWLINKWARNINGDIALOG	ASCII_STR("ShowLinkWarningDialog")
+#define PROPERTYHANDLE_SHOWLINKWARNINGDIALOG 7
 
-#define PROPERTYCOUNT						7
+#define PROPERTYCOUNT						8
 
 #define VCL_TOOLBOX_STYLE_FLAT				((USHORT)0x0004) // from <vcl/toolbox.hxx>
 
@@ -112,6 +114,8 @@ class SvtMiscOptions_Impl : public ConfigItem
     sal_Bool    m_bIsToolboxStyleRO;
     sal_Bool    m_bUseSystemPrintDialog;
     sal_Bool    m_bIsUseSystemPrintDialogRO;
+    sal_Bool    m_bShowLinkWarningDialog;
+    sal_Bool    m_bIsShowLinkWarningDialogRO;
 
     //-------------------------------------------------------------------------------------------------------------
     //	public methods
@@ -237,6 +241,15 @@ class SvtMiscOptions_Impl : public ConfigItem
         inline sal_Bool IsUseSystemPrintDialogReadOnly() const
         { return m_bIsUseSystemPrintDialogRO; }
 
+        inline sal_Bool ShowLinkWarningDialog() const
+        { return m_bShowLinkWarningDialog; }
+
+        void SetShowLinkWarningDialog( sal_Bool bSet )
+        {  m_bShowLinkWarningDialog = bSet; SetModified(); }
+
+        sal_Bool IsShowLinkWarningDialogReadOnly() const
+        { return m_bIsShowLinkWarningDialogRO; }
+
         void AddListenerLink( const Link& rLink );
         void RemoveListenerLink( const Link& rLink );
         void CallListeners();
@@ -286,6 +299,8 @@ SvtMiscOptions_Impl::SvtMiscOptions_Impl()
     , m_bIsToolboxStyleRO( sal_False )
     , m_bUseSystemPrintDialog( sal_False )
     , m_bIsUseSystemPrintDialogRO( sal_False )
+    , m_bShowLinkWarningDialog( sal_True )
+    , m_bIsShowLinkWarningDialogRO( sal_False )
 
 {
     // Use our static list of configuration keys to get his values.
@@ -368,6 +383,16 @@ SvtMiscOptions_Impl::SvtMiscOptions_Impl()
                 break;
             }
 
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG :
+            {
+                if( !(seqValues[nProperty] >>= m_bShowLinkWarningDialog) )
+                {
+                    DBG_ERROR("Wrong type of \"Misc\\ShowLinkWarningDialog\"!" );
+                }
+                m_bIsShowLinkWarningDialogRO = seqRO[nProperty];
+                break;
+            }
+
             case PROPERTYHANDLE_SYMBOLSTYLE :
             {
                 ::rtl::OUString aSymbolsStyle;
@@ -478,6 +503,13 @@ void SvtMiscOptions_Impl::Load( const Sequence< OUString >& rPropertyNames )
                                                             }
                                                         }
                                                     break;
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG     :   {
+                                                            if( !(seqValues[nProperty] >>= m_bShowLinkWarningDialog) )
+                                                            {
+                                                                DBG_ERROR("Wrong type of \"Misc\\ShowLinkWarningDialog\"!" );
+                                                            }
+                                                        }
+                                                    break;
             case PROPERTYHANDLE_SYMBOLSTYLE         :   {
                                                             ::rtl::OUString aSymbolsStyle;
                                                             if( seqValues[nProperty] >>= aSymbolsStyle )
@@ -644,6 +676,13 @@ void SvtMiscOptions_Impl::Commit()
                     seqValues[nProperty] <<= m_bUseSystemPrintDialog;
                 break;
             }
+
+            case PROPERTYHANDLE_SHOWLINKWARNINGDIALOG :
+            {
+                if ( !m_bIsShowLinkWarningDialogRO )
+                    seqValues[nProperty] <<= m_bShowLinkWarningDialog;
+                break;
+            }
         }
     }
     // Set properties in configuration.
@@ -664,7 +703,8 @@ Sequence< OUString > SvtMiscOptions_Impl::GetPropertyNames()
         PROPERTYNAME_USESYSTEMFILEDIALOG,
         PROPERTYNAME_SYMBOLSTYLE,
         PROPERTYNAME_USESYSTEMPRINTDIALOG,
-        PROPERTYNAME_TRYODMADIALOG
+        PROPERTYNAME_TRYODMADIALOG,
+        PROPERTYNAME_SHOWLINKWARNINGDIALOG
     };
 
     // Initialize return sequence with these list ...
@@ -850,6 +890,21 @@ void SvtMiscOptions::SetUseSystemPrintDialog( sal_Bool bEnable )
     m_pDataContainer->SetUseSystemPrintDialog( bEnable );
 }
 
+sal_Bool SvtMiscOptions::ShowLinkWarningDialog() const
+{
+    return m_pDataContainer->ShowLinkWarningDialog();
+}
+
+void SvtMiscOptions::SetShowLinkWarningDialog( sal_Bool bSet )
+{
+    m_pDataContainer->SetShowLinkWarningDialog( bSet );
+}
+
+sal_Bool SvtMiscOptions::IsShowLinkWarningDialogReadOnly() const
+{
+    return m_pDataContainer->IsShowLinkWarningDialogReadOnly();
+}
+
 //*****************************************************************************************************************
 //	private method
 //*****************************************************************************************************************
-- 
1.7.0.1

