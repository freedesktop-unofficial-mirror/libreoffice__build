From 5b19e1218d249232b0b4cba7bf5516050c1ab246 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:06:14 +0200
Subject: [PATCH 702/878] border-types-dotted-dashed-xlsx-part.diff

---
 sc/source/filter/xlsx/xlsx-xestyle.cxx |   20 ++++++++++++++++++++
 1 files changed, 20 insertions(+), 0 deletions(-)

diff --git a/sc/source/filter/xlsx/xlsx-xestyle.cxx b/sc/source/filter/xlsx/xlsx-xestyle.cxx
index 60108b1..6aa10f3 100644
--- a/sc/source/filter/xlsx/xlsx-xestyle.cxx
+++ b/sc/source/filter/xlsx/xlsx-xestyle.cxx
@@ -1541,9 +1541,26 @@ void lclGetBorderLine(
         else if( nOuterWidth > DEF_LINE_WIDTH_2 )
             rnXclLine = EXC_LINE_THICK;
         else if( nOuterWidth > DEF_LINE_WIDTH_1 )
+        {
             rnXclLine = EXC_LINE_MEDIUM;
+            if ( pLine->GetStyle( ) == EXC_LINE_DASHED )
+                rnXclLine = EXC_LINE_MEDIUMDASHED;
+        }
         else if( nOuterWidth > DEF_LINE_WIDTH_0 )
+        {
             rnXclLine = EXC_LINE_THIN;
+            switch ( pLine->GetStyle( ) )
+            {
+                case DOTTED:
+                    rnXclLine = EXC_LINE_DOTTED;
+                    break;
+                case DASHED:
+                    rnXclLine = EXC_LINE_DASHED;
+                    break;
+                default:
+                    break;
+            }
+        }
         else if( nOuterWidth > 0 )
             rnXclLine = EXC_LINE_HAIR;
         else
@@ -1709,6 +1726,9 @@ static const char* ToLineStyle( sal_uInt8 nLineStyle )
         case EXC_LINE_THICK:    return "thick";
         case EXC_LINE_DOUBLE:   return "double";
         case EXC_LINE_HAIR:     return "hair";
+        case EXC_LINE_DOTTED:   return "dotted";
+        case EXC_LINE_DASHED:   return "dashed";
+        case EXC_LINE_MEDIUMDASHED:   return "mediumdashed";
     }
     return "*unknown*";
 }
-- 
1.7.0.1

