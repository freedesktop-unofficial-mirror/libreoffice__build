From 027b95f2d0acb0fc17a570211730fddeefa4eb74 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:08:52 +0200
Subject: [PATCH 838/878] cws-impressmedia01-crash-fix.diff

---
 sc/source/ui/drawfunc/fuins1.cxx |    2 +-
 sw/source/ui/shells/grfshex.cxx  |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/sc/source/ui/drawfunc/fuins1.cxx b/sc/source/ui/drawfunc/fuins1.cxx
index 175039d..9dd1957 100644
--- a/sc/source/ui/drawfunc/fuins1.cxx
+++ b/sc/source/ui/drawfunc/fuins1.cxx
@@ -235,9 +235,9 @@ void lcl_InsertMedia( const ::rtl::OUString& rMediaURL, bool bApi,
 
     SdrMediaObj* pObj = new SdrMediaObj( Rectangle( aInsertPos, aSize ) );
     
-    pObj->setURL( rMediaURL ); 
     pView->InsertObjectAtView( pObj, *pPV, bApi ? SDRINSERT_DONTMARK : 0 );
 
+    pObj->setURL( rMediaURL );
     if( !bLinked )
         pObj->breakLink();
 }
diff --git a/sw/source/ui/shells/grfshex.cxx b/sw/source/ui/shells/grfshex.cxx
index 63131f4..2d7ae4e 100644
--- a/sw/source/ui/shells/grfshex.cxx
+++ b/sw/source/ui/shells/grfshex.cxx
@@ -163,10 +163,10 @@ bool SwTextShell::InsertMediaDlg( SfxRequest& rReq )
 
             SdrMediaObj* pObj = new SdrMediaObj( Rectangle( aPos, aSize ) );
 
-            pObj->setURL( aURL );
             rSh.EnterStdMode();
             rSh.SwFEShell::Insert( *pObj, 0, 0, &aPos );
 
+            pObj->setURL( aURL );
             if( !bLinked )
                 pObj->breakLink();
             bRet = true;
-- 
1.7.0.1

