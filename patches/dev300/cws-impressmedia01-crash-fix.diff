Fix crash in writer/calc for new media embedding

From: Thorsten Behrens <tbehrens@novell.com>


---

 sc/source/ui/drawfunc/fuins1.cxx |    2 +-
 sw/source/ui/shells/grfshex.cxx  |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)


diff --git sc/source/ui/drawfunc/fuins1.cxx sc/source/ui/drawfunc/fuins1.cxx
index c3592f5..c1073c1 100644
--- sc/source/ui/drawfunc/fuins1.cxx
+++ sc/source/ui/drawfunc/fuins1.cxx
@@ -238,9 +238,9 @@ void lcl_InsertMedia( const ::rtl::OUString& rMediaURL, bool bApi,
 
     SdrMediaObj* pObj = new SdrMediaObj( Rectangle( aInsertPos, aSize ) );
     
-    pObj->setURL( rMediaURL ); 
     pView->InsertObjectAtView( pObj, *pPV, bApi ? SDRINSERT_DONTMARK : 0 );
 	
+    pObj->setURL( rMediaURL ); 
 	if( !bLinked )
 	    pObj->breakLink();
 }
diff --git sw/source/ui/shells/grfshex.cxx sw/source/ui/shells/grfshex.cxx
index a5722e8..71b7fc3 100644
--- sw/source/ui/shells/grfshex.cxx
+++ sw/source/ui/shells/grfshex.cxx
@@ -166,10 +166,10 @@ bool SwTextShell::InsertMediaDlg( SfxRequest& rReq )
 
             SdrMediaObj* pObj = new SdrMediaObj( Rectangle( aPos, aSize ) );
 
-            pObj->setURL( aURL );
             rSh.EnterStdMode();
             rSh.SwFEShell::Insert( *pObj, 0, 0, &aPos );
 			
+            pObj->setURL( aURL );
 			if( !bLinked )
 			    pObj->breakLink();
             bRet = true;
