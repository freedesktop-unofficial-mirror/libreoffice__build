From e7fe95fe7fec4a4768b2355e8ec44867de94bc49 Mon Sep 17 00:00:00 2001
From: Jan Holesovsky <kendy@suse.cz>
Date: Fri, 14 May 2010 17:06:17 +0200
Subject: [PATCH 620/768] oox-pptx-export-fix-hidden-slides.diff

---
 sd/source/filter/pptx/pptx-epptooxml.cxx |   12 +++++++++++-
 1 files changed, 11 insertions(+), 1 deletions(-)

diff --git sd/source/filter/pptx/pptx-epptooxml.cxx sd/source/filter/pptx/pptx-epptooxml.cxx
index 7987f7e..8c2fedb 100644
--- sd/source/filter/pptx/pptx-epptooxml.cxx
+++ sd/source/filter/pptx/pptx-epptooxml.cxx
@@ -1114,7 +1114,17 @@ void PowerPointExport::ImplWriteSlide( sal_uInt32 nPageNum, sal_uInt32 nMasterNu
     mpSlidesFSArray.resize( mnPages );
     mpSlidesFSArray[ nPageNum ] = pFS;
 
-    pFS->startElementNS( XML_p, XML_sld, PNMSS, FSEND );
+    const char* pShow = NULL;
+
+    if( GETA( Visible ) ) {
+    sal_Bool bShow;
+    if( ( mAny >>= bShow ) && !bShow )
+        pShow = "0";
+    }
+
+    pFS->startElementNS( XML_p, XML_sld, PNMSS,
+             XML_show, pShow,
+             FSEND );
 
     pFS->startElementNS( XML_p, XML_cSld, FSEND );
 
-- 
1.7.0.1

