Index: configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.271
diff -u -u -r1.271 configure.in
--- config_office/configure.in	13 Jun 2008 14:10:42 -0000	1.271
+++ config_office/configure.in	25 Jun 2008 12:44:33 -0000
@@ -6013,6 +6017,53 @@
 AC_SUBST(ANT_LIB)
 fi
 
+if test "$ENABLE_MEDIAWIKI" = "YES"; then
+AC_MSG_CHECKING([for whether ant supports mapper type="regexp"])
+rm -rf confdir
+mkdir confdir
+cat > conftest.java << EOF
+    public class conftest {
+	int testmethod(int a, int b) {
+            return a + b;
+	}
+    }
+EOF
+
+cat > conftest.xml << EOF
+    <project name="conftest" default="conftest">
+	<target name="conftest" depends="copytest">
+            <javac srcdir="." includes="conftest.java">
+	    </javac>
+	</target>
+        <target name="copytest">
+             <copy todir="confdir">
+                 <fileset dir="confdir" includes="**/*.abc" casesensitive="yes"/>
+                 <filterset/>
+                 <mapper type="regexp" from="^(.*[/\\])foo([/\\].*)" to="\1baa\2"/>
+             </copy>
+        </target>
+    </project>
+EOF
+  if test "$JAVACISGCJ" = "yes"; then
+    JAVA_HOME=; export JAVA_HOME
+    ant_cmd="$ANT -Dbuild.compiler=gcj -buildfile conftest.xml 1>&2"
+  else
+    ant_cmd="$ANT -buildfile conftest.xml 1>&2"
+  fi
+  AC_TRY_EVAL(ant_cmd)
+  if test $? = 0 && test -f ./conftest.class ; then
+    AC_MSG_RESULT([yes]) 
+    rm -rf confdir
+  else
+    echo "configure: Ant test failed" >&5
+    cat conftest.java >&5
+    cat conftest.xml >&5
+    rm -rf confdir
+    AC_MSG_ERROR([no. Did you install ant-apache-regexp?])
+  fi
+fi
+rm -f conftest* core core.* *.core
+
 AC_MSG_CHECKING([which languages to be built])
 WITH_LANG="$with_lang"
 if test -z "$WITH_LANG"; then
