Index: sc/inc/sc.hrc
===================================================================
RCS file: /cvs/sc/sc/inc/sc.hrc,v
retrieving revision 1.35
diff -u -r1.35 sc.hrc
--- sc/inc/sc.hrc	3 Dec 2002 15:26:06 -0000	1.35
+++ sc/inc/sc.hrc	18 Aug 2004 12:30:17 -0000
@@ -946,6 +946,7 @@
 #define SID_CURSORENTERDOWN		(SID_KEYFUNC_START + 38)
 
 #define SID_MARKARRAYFORMULA    (SID_KEYFUNC_START + 39)
+#define FID_MERGE_CENTER		(SID_KEYFUNC_START + 40)
 
 #define SID_KEYFUNC_END			(SID_KEYFUNC_START + 50)
 

Index: sc/sdi/cellsh.sdi
===================================================================
RCS file: /cvs/sc/sc/sdi/cellsh.sdi,v
retrieving revision 1.11
diff -u -r1.11 cellsh.sdi
--- sc/sdi/cellsh.sdi	28 Nov 2002 14:56:06 -0000	1.11
+++ sc/sdi/cellsh.sdi	17 Aug 2004 15:15:42 -0000
@@ -138,6 +138,7 @@
 	SID_GET_CLPBRD_FORMAT_NAME		[ ExecMethod = ExecuteEdit; ]
 	SID_EXTERNAL_SOURCE	[ ExecMethod = ExecuteEdit; StateMethod = GetBlockState; ]
 	FID_MERGE_ON	[ ExecMethod = Execute; StateMethod = GetState; ]
+	FID_MERGE_CENTER	[ ExecMethod = Execute; StateMethod = GetState; ]
 	FID_MERGE_OFF	[ ExecMethod = Execute; StateMethod = GetState; ]
 	SID_OUTLINE_HIDE	[ ExecMethod = ExecuteEdit; StateMethod = GetState; ]
 	SID_OUTLINE_SHOW	[ ExecMethod = ExecuteEdit; StateMethod = GetState; ]
Index: sc/sdi/scalc.sdi
===================================================================
RCS file: /cvs/sc/sc/sdi/scalc.sdi,v
retrieving revision 1.24
diff -u -r1.24 scalc.sdi
--- sc/sdi/scalc.sdi	28 Nov 2002 14:56:05 -0000	1.24
+++ sc/sdi/scalc.sdi	17 Aug 2004 15:15:42 -0000
@@ -4084,6 +4084,31 @@
 ]
 
 //--------------------------------------------------------------------------
+SfxVoidItem MergeAndCenter FID_MERGE_CENTER
+(SfxBoolItem MoveContents FID_MERGE_CENTER)
+[
+	/* flags: */
+	AutoUpdate = FALSE,
+	Cachable = Cachable,
+	FastCall = FALSE,
+	HasCoreId = FALSE,
+	HasDialog = FALSE,
+	ReadOnlyDoc = TRUE,
+	Toggle = FALSE,
+	Container = FALSE,
+	RecordAbsolute = FALSE,
+	RecordPerSet;
+	Synchron;
+
+	/* config: */
+	AccelConfig = TRUE,
+	MenuConfig = TRUE,
+	StatusBarConfig = FALSE,
+	ToolBoxConfig = TRUE,
+	GroupId = GID_FORMAT;
+]
+
+//--------------------------------------------------------------------------
 SfxBoolItem Mirror SID_OBJECT_MIRROR
 ()
 [
Index: sc/sdi/scslots.src
===================================================================
RCS file: /cvs/sc/sc/sdi/scslots.src,v
retrieving revision 1.59.28.5
diff -u -r1.59.28.5 scslots.src
--- sc/sdi/scslots.src	27 Apr 2004 16:54:55 -0000	1.59.28.5
+++ sc/sdi/scslots.src	17 Aug 2004 15:15:48 -0000
@@ -1866,6 +1866,12 @@
 	SlotName[ zulu ] = "Hlanganisa Amagumbi";
 	SlotName[ norwegian_nynorsk ] = "Slå saman celler";
 };
+SfxSlotInfo FID_MERGE_CENTER
+{
+	SlotName = "Merge and Center";
+	SlotName [ english ] =  "Merge and Center";
+	SlotName [ english_us ] =  "Merge and Center";
+};
 SfxSlotInfo FID_NOTE_VISIBLE
 {
 	SlotName = "Notiz anzeigen";
Index: sc/source/ui/docshell/docfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docfunc.cxx,v
retrieving revision 1.44.98.1
diff -u -r1.44.98.1 docfunc.cxx
--- sc/source/ui/docshell/docfunc.cxx	18 Mar 2004 11:39:23 -0000	1.44.98.1
+++ sc/source/ui/docshell/docfunc.cxx	17 Aug 2004 16:02:46 -0000
@@ -3427,6 +3424,7 @@
 	if (pBindings)
 	{
 		pBindings->Invalidate( FID_MERGE_ON );
+		pBindings->Invalidate( FID_MERGE_CENTER );
 		pBindings->Invalidate( FID_MERGE_OFF );
 	}
 
Index: sc/source/ui/view/cellsh.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/cellsh.cxx,v
retrieving revision 1.20
diff -u -r1.20 cellsh.cxx
--- sc/source/ui/view/cellsh.cxx	8 Apr 2003 16:32:11 -0000	1.20
+++ sc/source/ui/view/cellsh.cxx	17 Aug 2004 16:04:25 -0000
@@ -701,6 +701,7 @@
 				break;
 
 			case FID_MERGE_ON:
+			case FID_MERGE_CENTER:
 				if ( pDoc->GetChangeTrack() || !pTabViewShell->TestMergeCells() )
 					rSet.DisableItem( nWhich );
 				break;
Index: sc/source/ui/view/tabview3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview3.cxx,v
retrieving revision 1.33
diff -u -r1.33 tabview3.cxx
--- sc/source/ui/view/tabview3.cxx	24 Apr 2003 14:06:09 -0000	1.33
+++ sc/source/ui/view/tabview3.cxx	17 Aug 2004 16:11:29 -0000
@@ -463,6 +463,7 @@
 	rBindings.Invalidate( FID_DEL_ROWBRK );
 	rBindings.Invalidate( FID_DEL_COLBRK );
 	rBindings.Invalidate( FID_MERGE_ON );
+	rBindings.Invalidate( FID_MERGE_CENTER );
 	rBindings.Invalidate( FID_MERGE_OFF );
 	rBindings.Invalidate( SID_AUTOFILTER_HIDE );
 	rBindings.Invalidate( SID_UNFILTER );
Index: sc/source/ui/src/toolbox.src
===================================================================
RCS file: /cvs/sc/sc/source/ui/src/toolbox.src,v
retrieving revision 1.57.28.6
diff -u -r1.57.28.6 toolbox.src
--- sc/source/ui/src/toolbox.src	3 May 2004 15:35:34 -0000	1.57.28.6
+++ sc/source/ui/src/toolbox.src	18 Aug 2004 01:57:55 -0000
@@ -556,6 +556,11 @@
 			RadioCheck = TRUE ;
 			AutoCheck = TRUE ;
 		};
+		ToolBoxItem
+		{
+			Identifier = FID_MERGE_CENTER ;
+			HelpId = FID_MERGE_CENTER ;
+		};
          //--------------------------------------------------------------------
         ToolBoxItem { Type = TOOLBOXITEM_SEPARATOR ; };
          //--------------------------------------------------------------------
Index: sc/source/ui/view/cellsh3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/cellsh3.cxx,v
retrieving revision 1.10
diff -u -r1.10 cellsh3.cxx
--- sc/source/ui/view/cellsh3.cxx	20 Nov 2002 14:34:34 -0000	1.10
+++ sc/source/ui/view/cellsh3.cxx	18 Aug 2004 01:59:15 -0000
@@ -745,6 +745,7 @@
 			}
 			break;
 
+		case FID_MERGE_CENTER:
 		case FID_MERGE_ON:
 			{
 				if ( !GetViewData()->GetDocument()->GetChangeTrack() )
@@ -759,14 +760,36 @@
 						bMoveContents = ((const SfxBoolItem*)pItem)->GetValue();
 					}
 
+					if (nSlot == FID_MERGE_CENTER && GetViewData()->GetDocShell())
+					{
+						String aUndo = ScGlobal::GetRscString( STR_UNDO_MERGE );
+						GetViewData()->GetDocShell()->GetUndoManager()->EnterListAction( aUndo, aUndo );
+					}
+
 					if (pTabViewShell->MergeCells( bApi, bMoveContents ))
 					{
+						if (nSlot == FID_MERGE_CENTER)
+						{
+							const SvxHorJustifyItem* pHorJustify = NULL;
+							SvxCellHorJustify        eHorJustify = SVX_HOR_JUSTIFY_STANDARD;
+
+							rReq.SetSlot( SID_H_ALIGNCELL );
+							rReq.AppendItem( SvxHorJustifyItem(
+													 !pHorJustify || (eHorJustify != SVX_HOR_JUSTIFY_CENTER) ?
+													 SVX_HOR_JUSTIFY_CENTER : SVX_HOR_JUSTIFY_STANDARD, SID_H_ALIGNCELL ) );
+							ExecuteSlot( rReq, GetInterface() );
+						}
+
 						if (!bApi && bMoveContents)				// "ja" im Dialog geklickt
 						{
 							rReq.AppendItem( SfxBoolItem( FID_MERGE_ON, bMoveContents ) );
 						}
+						
 						rReq.Done();
 					}
+
+					if (nSlot == FID_MERGE_CENTER && GetViewData()->GetDocShell())
+						GetViewData()->GetDocShell()->GetUndoManager()->LeaveListAction();
 				}
 			}
 			break;
