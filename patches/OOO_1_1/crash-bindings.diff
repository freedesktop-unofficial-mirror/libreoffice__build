Index: sfx2/source/control/bindings.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/control/bindings.cxx,v
retrieving revision 1.25
retrieving revision 1.25.78.1
diff -u -p -u -r1.25 -r1.25.78.1
--- sfx2/source/control/bindings.cxx	28 May 2003 13:25:06 -0000	1.25
+++ sfx2/source/control/bindings.cxx	17 Oct 2003 13:07:05 -0000	1.25.78.1
@@ -2626,13 +2626,21 @@ SfxItemState SfxBindings::QueryState( sa
 
             if ( !pDisp || pDisp->IsInterceptDispatch() )
 			{
+			    if ( !pCache )
+			    {
+			        pCache = new SfxStateCache( nSlot );
+			        pCache->GetSlotServer( *GetDispatcher_Impl(), pImp->xProv );
+			    }
+
             	SfxItemState eState = SFX_ITEM_SET;
             	SfxPoolItem *pItem=NULL;
-            	BindDispatch_Impl *pBind = new BindDispatch_Impl( xDisp, aURL, NULL );
+            	BindDispatch_Impl *pBind = new BindDispatch_Impl( xDisp, aURL, pCache );
             	pBind->acquire();
             	xDisp->addStatusListener( pBind, aURL );
             	if ( !pBind->GetStatus().IsEnabled )
+				{
                 	eState = SFX_ITEM_DISABLED;
+				}
             	else
             	{
                 	::com::sun::star::uno::Any aAny = pBind->GetStatus().State;
@@ -2666,8 +2674,10 @@ SfxItemState SfxBindings::QueryState( sa
                     	pItem = new SfxVoidItem( nSlot );
             	}
 
+            	xDisp->removeStatusListener( pBind, aURL );
             	pBind->Release();
             	rpState = pItem;
+				DELETEZ( pCache );
             	return eState;
 			}
         }
