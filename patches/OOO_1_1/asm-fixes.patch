--- bridges/source/c_uno/intelx86.cxx.asmfixes	Wed Apr 18 13:05:48 2001
+++ bridges/source/c_uno/intelx86.cxx	Thu May 30 11:37:26 2002
@@ -95,24 +95,21 @@ Lcopy:	sub		eax, 4
 		add		esp, eax
 	}
 #elif GCC
+	int ecx, edx;
+
 	__asm__
 	(
-		"mov %2, %%eax\n\t"
-		"mov %%eax, %%ecx\n\t"
-		"shl $2, %%eax\n\t"
-		"add %1, %%eax\n"
-		"Lcopy:\n\t"
-		"sub $4, %%eax\n\t"
-		"pushl (%%eax)\n\t"
-		"dec %%ecx\n\t"
-		"jne Lcopy\n\t"
-		"mov %0, %%eax\n\t"
-		"call *%%eax\n\t"
-		"mov %%eax, %3\n"
-		"mov %2, %%eax\n\t"
-		"shl $2, %%eax\n\t"
-		"add %%eax, %%esp\n\t"
-		: : "m"(fptr), "m"(pParams), "m"(nParams), "m"(retVal)
+		"1:\n\t"
+		"subl $4, %0\n\t"
+		"pushl (%0)\n\t"
+		"decl %1\n\t"
+		"jne 1b\n\t"
+		"call *%2\n\t"
+		"leal 0(%%esp,%3,4), %%esp\n\t"
+		: "=a"(retVal), "=c"(ecx), "=d"(edx)
+		: "S"(nParams),
+		  "0" (((int *) pParams) + nParams), "1" (nParams), "2"(fptr)
+		: "memory", "cc"
 	);
 #else
 #error "### unsupported x86 compiler!"
