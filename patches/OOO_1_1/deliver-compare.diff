Index: solenv/bin/deliver.pl
===================================================================
RCS file: /cvs/tools/solenv/bin/deliver.pl,v
retrieving revision 1.50
diff -u -3 -r1.50 deliver.pl
--- solenv/bin/deliver.pl	16 Jul 2003 18:19:10 -0000	1.50
+++ solenv/bin/deliver.pl	18 Aug 2003 08:48:01 -0000
@@ -888,6 +888,21 @@
     }
 }
 
+sub slurp {
+    my $from = shift;
+    my $save = $/;
+    my $FROM;
+
+    undef $/;
+    open ($FROM, "<$from");
+    # slurp whole file in one big string
+    my $content = <$FROM>;
+    close ($FROM);
+    $/ = $save;
+
+    return $content;
+}
+
 sub hedabu_if_newer 
 {
     my $from = shift;
@@ -909,13 +924,7 @@
         
         return 1 if $opt_check;
 
-        my $save = $/;
-        undef $/;
-        open(FROM, "<$from");
-        # slurp whole file in one big string
-        my $content = <FROM>;
-        close(FROM);
-        $/ = $save;
+        my $content = slurp ($from);
 
         # strip any carriage returns
         $content =~ tr/\r//d;
@@ -930,6 +939,18 @@
 
         # __SOLAR_PRIVATE hack
         $content =~ s/#if _SOLAR__PRIVATE/#if 0 \/\/ _SOLAR__PRIVATE/g;
+
+        if( -f $to) {
+            my $to_content = slurp ("$to");
+
+            if (length ($content) == length ($to_content) &&
+                   $content eq $to_content) {
+                   print "HEDABU: skipping identical header $to\n";
+                   return 1;
+            } else {
+                   print "Header content different $a $b\n";
+            }
+        }
 
         open(TO, ">$to");
         print TO $content;
