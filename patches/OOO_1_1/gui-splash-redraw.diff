--- vcl/inc/salframe.hxx	2004-07-14 18:20:25.000000000 +0100
+++ vcl/inc/salframe.hxx	2004-07-15 15:45:12.224017392 +0100
@@ -252,7 +252,9 @@
 
     virtual void				Beep( SoundType eSoundType ) = 0;
 
+	virtual void                SetFrameBackground( SalBitmap *pBmp ) = 0;
+
     // returns system data (most prominent: window handle)
     virtual const SystemEnvData*	GetSystemData() const = 0;
 

--- vcl/inc/introwin.hxx	2004-07-15 16:07:50.939461248 +0100
+++ vcl/inc/introwin.hxx	2004-07-15 04:20:21.000000000 +0100
@@ -82,7 +82,9 @@
 public:
     IntroWindow();
     ~IntroWindow();
+    void IntroWindow::SetBackgroundBitmap( const Bitmap &rBitmap );
+	virtual void Paint( const Rectangle& );
 };
 
 #endif // _SV_INTROWIN_HXX

--- vcl/source/window/introwin.cxx	2004-07-15 16:07:50.937461552 +0100
+++ vcl/source/window/introwin.cxx	2004-07-15 16:03:32.653726648 +0100
@@ -91,6 +91,18 @@
 #ifndef _SV_OPENGL_HXX
 #include <opengl.hxx>
 #endif
+#ifndef _SV_BITMAP_HXX
+#include <bitmap.hxx>
+#endif
+#ifndef _SV_BITMAPEX_HXX
+#include <bitmapex.hxx>
+#endif
+#ifndef _SV_IMPBMP_HXX
+#include <impbmp.hxx>
+#endif
+#ifndef _SV_SALBMP_HXX
+#include <salbmp.hxx>
+#endif
 
 #include <introwin.hxx>
 
@@ -123,4 +135,19 @@
         pSVData->mpIntroWindow = NULL;
 }
 
+void
+IntroWindow::SetBackgroundBitmap( const Bitmap &rBitmap )
+{
+    SetBackground( Wallpaper( BitmapEx( rBitmap ) ) );
+}
+
+void
+IntroWindow::Paint( const Rectangle &rRect )
+{
+    Bitmap aBmp( GetBackground().GetBitmap().GetBitmap() );
 
+	DrawBitmap( Point(), aBmp );
+	ImpBitmap *pImpBmp = aBmp.ImplGetImpBitmap();
+	if( pImpBmp )
+		ImplGetFrame()->SetFrameBackground( pImpBmp->ImplGetSalBitmap () );
+}
Index: desktop/source/splash/splash.cxx
===================================================================
RCS file: /cvs/framework/desktop/source/splash/splash.cxx,v
retrieving revision 1.4
diff -u -p -u -r1.4 splash.cxx
--- desktop/source/splash/splash.cxx	15 Jul 2003 14:06:11 -0000	1.4
+++ desktop/source/splash/splash.cxx	16 Sep 2003 12:51:51 -0000
@@ -235,16 +235,17 @@ void SplashScreen::initBitmap()
 			_aIntroBmp = Bitmap( aIntroBmpRes );
 			delete pLabelResMgr;
 		}
+		SetBackgroundBitmap( _aIntroBmp );
 	}
 }
 
-void SplashScreen::Paint( const Rectangle& )
+void SplashScreen::Paint( const Rectangle& rRect )
 {
 	if(!_bVisible) return;
 	// draw bitmap
 	if (_bPaintBitmap)
-		DrawBitmap( Point(), _aIntroBmp );
+        IntroWindow::Paint( rRect );
 
 	if (_bPaintProgress) {
 		// draw progress...

--- vcl/unx/inc/salbmp.h	2004-07-15 16:07:50.998452280 +0100
+++ vcl/unx/inc/salbmp.h	2004-07-15 15:59:26.342171696 +0100
@@ -80,6 +80,9 @@
 class	SalGraphics;
 class	ImplSalDDB;
 class	ImplSalBitmapCache;
+class   SalFrame;
+class   GtkSalFrame;
+class   X11SalFrame;
 
 // -------------
 // - SalBitmap -
@@ -87,7 +90,9 @@
 
 class X11SalBitmap : public SalBitmap
 {
+	friend class   GtkSalFrame;
+	friend class   X11SalFrame;
 private:
 
 	static BitmapBuffer*		ImplCreateDIB( const Size& rSize,

--- vcl/unx/source/window/salframe.cxx	2004-07-14 20:31:39.000000000 +0100
+++ vcl/unx/source/window/salframe.cxx	2004-07-15 15:59:51.514344944 +0100
@@ -2218,7 +2218,20 @@
     }
 }
 
+void X11SalFrame::SetFrameBackground( SalBitmap *pSalBmp )
+{
+	Pixmap pPixmap;
+	X11SalBitmap *pBmp = (X11SalBitmap *) pSalBmp;
+
+	if( !pBmp || !pBmp->mpDDB || !GetWindow() )
+		return;
+
+	pPixmap = pBmp->mpDDB->ImplGetPixmap();
+	XSetWindowBackgroundPixmap( GetXDisplay(), GetWindow(),
+								pBmp->mpDDB->ImplGetPixmap () );
+}
+
 // Event Handling
 // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 static USHORT sal_GetCode( int state )

--- vcl/unx/inc/salframe.h	2004-07-14 20:28:20.000000000 +0100
+++ vcl/unx/inc/salframe.h	2004-07-15 15:58:54.690983408 +0100
@@ -294,7 +294,8 @@
     virtual SalBitmap*			SnapShot();
     virtual void				UpdateSettings( AllSettings& rSettings );
     virtual void				Beep( SoundType eSoundType );
+	virtual void                SetFrameBackground( SalBitmap *pBmp );
     virtual const SystemEnvData*	GetSystemData() const;
     virtual ULONG				GetCurrentModButtons();
     virtual void				SetParent( SalFrame* pNewParent );


--- vcl/unx/inc/plugins/gtk/gtkframe.hxx	2004-07-15 14:19:33.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkframe.hxx	2004-07-15 15:59:39.486173504 +0100
@@ -244,7 +244,9 @@
 
     virtual void				Beep( SoundType eSoundType );
 
+	virtual void                SetFrameBackground( SalBitmap *pBmp );
+
     // returns system data (most prominent: window handle)
     virtual const SystemEnvData*	GetSystemData() const;
 

--- vcl/unx/gtk/window/gtkframe.cxx	2004-07-14 20:35:05.000000000 +0100
+++ vcl/unx/gtk/window/gtkframe.cxx	2004-07-15 15:57:01.751152872 +0100
@@ -1798,3 +1798,17 @@
 
     return FALSE;
 }
+
+void GtkSalFrame::SetFrameBackground( SalBitmap *pSalBmp )
+{
+	Pixmap pPixmap;
+	X11SalBitmap *pBmp = (X11SalBitmap *) pSalBmp;
+
+	if( !pBmp || !pBmp->mpDDB || !m_pWindow )
+		return;
+
+	pPixmap = pBmp->mpDDB->ImplGetPixmap();
+	XSetWindowBackgroundPixmap( getDisplay()->GetDisplay(),
+								GDK_WINDOW_XWINDOW(GTK_WIDGET(m_pWindow)->window),
+								pBmp->mpDDB->ImplGetPixmap ());
+}
