Index: vcl/unx/inc/XIM.h
===================================================================
--- vcl/unx/inc/XIM.h.orig	2000-09-18 19:05:40.000000000 +0200
+++ vcl/unx/inc/XIM.h	2004-10-06 16:20:54.713291328 +0200
@@ -155,6 +155,8 @@ typedef	struct	_XIMSwitchIMNotifyCallbac
 /* XIM attributes for multilingual IM extension */
 #define XNMultiLingualInput "multiLingualInput"
 #define XNQueryUnicodeCharacterSubset "unicodeCharacterSubset"
+#define XNQueryExtensionVersion "queryExtensionersion"
+#define XIIIMP_MULTILINGUAL_EXTENSION_VERSION 2
 
 /* XIC attributes for multilingual IM extension */
 
Index: vcl/unx/source/app/i18n_ic.cxx
===================================================================
--- vcl/unx/source/app/i18n_ic.cxx.orig	2004-10-06 16:12:46.417523568 +0200
+++ vcl/unx/source/app/i18n_ic.cxx	2004-10-06 16:20:54.714291176 +0200
@@ -212,11 +212,9 @@ SalI18N_InputContext::SalI18N_InputConte
         mpPreeditAttributes( NULL ),
         mpFocusFrame( NULL )
 {
-#ifdef SOLARIS
     static const char* pIIIMPEnable = getenv( "SAL_DISABLE_OWN_IM_STATUS" );
     if( pIIIMPEnable && *pIIIMPEnable )
         mnSupportedStatusStyle &= ~XIMStatusCallbacks;
-#endif
 
     maClientData.aText.pUnicodeBuffer = NULL;
     maClientData.aText.pCharStyle     = NULL;
Index: vcl/unx/source/app/i18n_im.cxx
===================================================================
--- vcl/unx/source/app/i18n_im.cxx.orig	2004-10-06 16:12:46.447519008 +0200
+++ vcl/unx/source/app/i18n_im.cxx	2004-10-06 16:21:07.651324448 +0200
@@ -416,11 +416,16 @@ SalI18N_InputMethod::CreateMethod ( Disp
 			if ( maMethod == (XIM)NULL )
 				mbMultiLingual = False;
 
-#if !defined(LINUX)
 			else
-			if ( XGetIMValues(maMethod,
-					XNMultiLingualInput, &mbMultiLingual, NULL ) != NULL )
+			{
+			    int xiiimp_version = 1;
+			    if ( XGetIMValues(maMethod,
+					      XNQueryExtensionVersion, &xiiimp_version, NULL) != NULL || xiiimp_version < XIIIMP_MULTILINGUAL_EXTENSION_VERSION)
 				mbMultiLingual = False;
+			    if ( XGetIMValues(maMethod,
+					      XNMultiLingualInput, &mbMultiLingual, NULL ) != NULL )
+				mbMultiLingual = False;
+			}
 
              #if defined(MACOSX) &&  (BUILD_OS_MAJOR == 10) && (BUILD_OS_MINOR == 2)
                 // [ed] 6/12/04 Reapply multilingual patch for MACOSX Jaguar 
@@ -459,9 +464,6 @@ SalI18N_InputMethod::CreateMethod ( Disp
                     fprintf( stderr, "query subsets failed\n" );
 #endif
             }
-#else
-            mbMultiLingual = False;
-#endif
 		}
 		else
 	    {
