Index: berkeleydb/makefile.mk
===================================================================
RCS file: /cvs/external/berkeleydb/makefile.mk,v
retrieving revision 1.13
diff -u -p -u -r1.13 makefile.mk
--- berkeleydb/makefile.mk	12 Jun 2003 09:50:38 -0000	1.13
+++ berkeleydb/makefile.mk	11 Mar 2004 14:06:25 -0000
@@ -101,6 +125,13 @@ OUT2BIN=java$/classes$/db.jar
 EXT_USE_STLPORT=TRUE
 
 BUILD_DIR=build_win32
+.IF "$(SOLAR_JAVA)" != ""
+BUILD_JAVA_DEVENV= /build Release /project db_java /useenv
+BUILD_JAVA_MSDEV= /MAKE "db_java - RELEASE"
+BUILD_JAVA_BIN=java$/classes$/db.jar \
+		$(BUILD_DIR)$/Release$/libdb_java32.dll
+BUILD_JAVA_LIB=$(BUILD_DIR)$/Release$/libdb_java32.lib
+.ENDIF
 .IF "$(COMEX)"=="8"
 CONFIGURE_DIR=build_win32
 CONFIGURE_ACTION=wdevenv Berkeley_DB Release
@@ -109,17 +140,16 @@ BUILD_ACTION_SEP=;
 .ELSE # "$(USE_SHELL)"!="4nt"
 BUILD_ACTION_SEP=^
 .ENDIF # "$(USE_SHELL)"!="4nt"
-BUILD_ACTION=devenv Berkeley_DB.sln /build Release /project db_buildall /useenv $(BUILD_ACTION_SEP) devenv Berkeley_DB.sln /build Release /project db_java /useenv
+BUILD_ACTION=devenv Berkeley_DB.sln /build Release /project db_buildall /useenv $(BUILD_ACTION_SEP) devenv Berkeley_DB.sln  $(BUILD_JAVA_DEVENV)
 .ELSE
-BUILD_ACTION=msdev Berkeley_DB.dsw /useenv /MAKE "db_buildall - RELEASE" /MAKE "db_java - RELEASE"
+BUILD_ACTION=msdev Berkeley_DB.dsw /useenv /MAKE "db_buildall - RELEASE" $(BUILD_JAVA_MSDEV)
 .ENDIF
 
-OUT2BIN=java$/classes$/db.jar \
-	$(BUILD_DIR)$/Release$/libdb_java32.dll \
-	$(BUILD_DIR)$/Release$/libdb32.dll
+OUT2BIN= $(BUILD_JAVA_BIN) \
+	 $(BUILD_DIR)$/Release$/libdb32.dll
 
 OUT2LIB= \
-	$(BUILD_DIR)$/Release$/libdb_java32.lib \
+	$(BUILD_JAVA_LIB) \
 	$(BUILD_DIR)$/Release$/libdb32.lib
 
 .ENDIF			# "$(GUI)"=="WNT"
