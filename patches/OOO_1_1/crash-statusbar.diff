Index: sfx2/source/statbar/stbmgr.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/statbar/stbmgr.cxx,v
retrieving revision 1.5
diff -u -p -u -r1.5 stbmgr.cxx
--- sfx2/source/statbar/stbmgr.cxx	27 Mar 2003 11:28:54 -0000	1.5
+++ sfx2/source/statbar/stbmgr.cxx	21 Jul 2004 11:26:19 -0000
@@ -143,6 +143,7 @@ friend class SfxStatusBarManager;
 
 private:
 	SfxStatusBarControl* GetItemAt( const MouseEvent &rEvt );
+    DECL_LINK( ItemRemoved_Impl, void* );
 
 protected:
 	virtual void    Click();
@@ -157,6 +158,7 @@ protected:
 public:
 					SfxStatusBar_Impl( Window* pParent,
 									   SfxStatusBarManager& rMgr );
+					~SfxStatusBar_Impl();
 	void			Init( SfxStatusBarManager* rMgr );
 
 	void			CaptureMouse( SfxStatusBarControl &rCtrl );
@@ -182,6 +184,29 @@ SfxStatusBar_Impl::SfxStatusBar_Impl( Wi
 	pLastFocusWin(0)
 {
 	SetUniqueId( HID_STATUSBAR );
+
+	AddEventListener( LINK( this, SfxStatusBar_Impl, ItemRemoved_Impl ) );
+}
+
+SfxStatusBar_Impl::~SfxStatusBar_Impl()
+{
+	RemoveEventListener( LINK( this, SfxStatusBar_Impl, ItemRemoved_Impl ) );
+}
+
+IMPL_LINK( SfxStatusBar_Impl, ItemRemoved_Impl, void*, pVoid )
+{
+	VclWindowEvent *pEvent = (VclWindowEvent *) pVoid;
+
+	if (pEvent)
+	{
+		if( pEvent->GetId() == VCLEVENT_STATUSBAR_ITEMREMOVED ||
+			pEvent->GetId() == VCLEVENT_STATUSBAR_ALLITEMSREMOVED )
+		{
+			pLastControl = 0;
+		}
+	}
+
+    return 0L;
 }
 
 void SfxStatusBar_Impl::Init( SfxStatusBarManager* p  )
