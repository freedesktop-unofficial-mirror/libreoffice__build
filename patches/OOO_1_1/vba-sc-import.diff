Index: sc/source/filter/excel/xilink.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xilink.cxx,v
retrieving revision 1.4
diff -u -r1.4 xilink.cxx
--- sc/source/filter/excel/xilink.cxx	21 May 2003 07:58:57 -0000	1.4
+++ sc/source/filter/excel/xilink.cxx	8 Sep 2004 10:00:15 -0000
@@ -126,7 +126,9 @@
     rStrm >> nFlags >> mnStorageId >> nLen;
     rStrm.AppendUniString( maName, nLen );
 
-    if( ::get_flag( nFlags, EXC_EXTN_BUILTIN ) || !::get_flag( nFlags, EXC_EXTN_OLE_OR_DDE ) )
+    bool bVBName = ::get_flag( nFlags, EXC_NAME_VB);
+	
+    if( (::get_flag( nFlags, EXC_EXTN_BUILTIN ) || !::get_flag( nFlags, EXC_EXTN_OLE_OR_DDE )) && !bVBName )
     {
         meType = xlExtName;
         maAddInName = rStrm.GetRoot().GetScAddInName( maName );
@@ -141,7 +143,7 @@
 
 const XclImpExtName* XclImpExtNameList::GetName( sal_uInt16 nXclIndex ) const
 {
-    DBG_ASSERT( nXclIndex, "XclImpExtNameList::GetName - index must be >0" );
+    DBG_ASSERT( nXclIndex > 0, "XclImpExtNameList::GetName - index must be >0" );
     return GetObject( nXclIndex - 1 );
 }
