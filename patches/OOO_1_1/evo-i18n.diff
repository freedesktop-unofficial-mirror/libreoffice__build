Index: connectivity/source/drivers/evoab/LConnection.cxx
===================================================================
RCS file: /cvs/dba/connectivity/source/drivers/evoab/LConnection.cxx,v
retrieving revision 1.2
diff -u -p -u -r1.2 LConnection.cxx
--- connectivity/source/drivers/evoab/LConnection.cxx	2 Jun 2003 07:55:26 -0000	1.2
+++ connectivity/source/drivers/evoab/LConnection.cxx	8 Oct 2003 16:00:48 -0000
@@ -89,6 +89,9 @@
 #ifndef _COMPHELPER_EXTRACT_HXX_
 #include <comphelper/extract.hxx>
 #endif
+#ifndef _DBHELPER_DBCHARSET_HXX_
+#include <connectivity/dbcharset.hxx>
+#endif
 #ifndef _DBHELPER_DBEXCEPTION_HXX_
 #include <connectivity/dbexception.hxx>
 #endif
@@ -194,8 +197,11 @@ void OEvoabConnection::construct(const :
 	::std::vector<PropertyValue> aParam;
 
 	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("EnableSQL92Check"), 0, Any(), PropertyState_DIRECT_VALUE));
-	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("CharSet"), 0, Any(), PropertyState_DIRECT_VALUE));
+	::dbtools::OCharsetMap aLookupIanaName;
+	::dbtools::OCharsetMap::const_iterator aLookup = aLookupIanaName.find(RTL_TEXTENCODING_UTF8);
+	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("CharSet"), 0,
+								   makeAny((*aLookup).getIanaName()), PropertyState_DIRECT_VALUE));
 	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("Extension"), 0, makeAny(getDriver()->getFileExt()), PropertyState_DIRECT_VALUE));
 	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("HeaderLine"), 0, makeAny(m_bHeaderLine), PropertyState_DIRECT_VALUE));
 	aParam.push_back(PropertyValue(::rtl::OUString::createFromAscii("FieldDelimiter"), 0, makeAny(::rtl::OUString(&m_cFieldDelimiter,1)), PropertyState_DIRECT_VALUE));

--- connectivity/source/drivers/evoab/LTable.cxx.~1.2.~	2003-06-02 09:58:17.000000000 +0200
+++ connectivity/source/drivers/evoab/LTable.cxx	2003-10-09 12:06:01.000000000 +0200
@@ -794,7 +800,7 @@ sal_Bool OEvoabTable::setColumnAliases()
 		}
 		if(!bFound)
 			aColumnFinalName = aColumnReadName;
-		sColumnFinalName = String::CreateFromAscii(::rtl::OUStringToOString(aColumnFinalName, RTL_TEXTENCODING_ASCII_US).getStr());
+		sColumnFinalName = String::CreateFromAscii(::rtl::OUStringToOString(aColumnFinalName, RTL_TEXTENCODING_DONTKNOW ).getStr());
 		
 		sal_Bool bCase = getConnection()->getMetaData()->storesMixedCaseQuotedIdentifiers();
 		::rtl::OUString aTypeName;
