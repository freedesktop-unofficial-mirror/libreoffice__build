Index: sc/source/ui/inc/impex.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/impex.hxx,v
retrieving revision 1.7
diff -u -r1.7 impex.hxx
--- sc/source/ui/inc/impex.hxx	14 Nov 2001 20:27:07 -0000	1.7
+++ sc/source/ui/inc/impex.hxx	13 Aug 2004 12:56:10 -0000
@@ -138,6 +138,7 @@
 	static	void	WriteUnicodeOrByteString( SvStream& rStrm, const String& rString, BOOL bZero = FALSE );
 	static	void	WriteUnicodeOrByteEndl( SvStream& rStrm );
 	static	inline	BOOL	IsEndianSwap( const SvStream& rStrm );
+	static  void    ReadCSVLine (SvStream& rStrm, String &aLine, sal_Unicode cStr, BOOL bFixed);
 
 	sal_Unicode GetSeparator() const { return cSep; }
 	void SetSeparator( sal_Unicode c ) { cSep = c; }
Index: sc/source/ui/docshell/impex.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/impex.cxx,v
retrieving revision 1.25
diff -u -r1.25 impex.cxx
--- sc/source/ui/docshell/impex.cxx	4 Jun 2003 12:37:09 -0000	1.25
+++ sc/source/ui/docshell/impex.cxx	13 Aug 2004 12:56:54 -0000
@@ -815,7 +814,7 @@
 
 	if ( nColFormat == SC_COL_TEXT )
 	{
-		pDoc->PutCell( nCol, nRow, nTab, new ScStringCell( rStr ) );
+		pDoc->PutCell( nCol, nRow, nTab, ScBaseCell::CreateTextCell( rStr, pDoc ) );
 		return;
 	}
 
@@ -999,9 +998,10 @@
 		}
 	}
 
-	//	Standard oder Datum nicht erkannt -> SetString
-
-	pDoc->SetString( nCol, nRow, nTab, rStr );
+	if( rStr.Search( _LF ) != STRING_NOTFOUND )
+		pDoc->PutCell( nCol, nRow, nTab, new ScEditCell( rStr, pDoc ) );
+	else //	Standard oder Datum nicht erkannt -> SetString
+		pDoc->SetString( nCol, nRow, nTab, rStr );
 }
 
 
@@ -1022,6 +1022,38 @@
 	return rLine.Copy( nStart, nSpace-nStart );
 }
 
+void ScImportExport::ReadCSVLine (SvStream& rStrm, String &aLine, sal_Unicode cStr, BOOL bFixed)
+{
+	xub_StrLen nLastOffset = 0;
+	xub_StrLen nQuotes = 0;
+
+	rStrm.ReadUniOrByteStringLine (aLine);
+
+	if (!bFixed) // Seek quoted newlines
+	{
+		while (!rStrm.IsEof())
+		{
+		    const sal_Unicode* p = aLine.GetBuffer();
+			p += nLastOffset;
+			while (*p)
+			{
+			    if (*p++ == cStr)
+					nQuotes++;
+				nLastOffset++;
+			}
+
+			if (nQuotes % 2 == 0)
+				break;
+			else
+			{
+				String aNext;
+				rStrm.ReadUniOrByteStringLine (aNext);
+				aLine += String(_LF);
+				aLine += aNext;
+			}
+		}
+	}
+}
 
 BOOL ScImportExport::ExtText2Doc( SvStream& rStrm )
 {
@@ -1080,13 +1112,13 @@
 
 	while(--nSkipLines>0)
 	{
-		rStrm.ReadUniOrByteStringLine( aLine );		// content is ignored
+		ReadCSVLine( rStrm, aLine, cStr, bFixed ); // content is ignored
 		if ( rStrm.IsEof() )
 			break;
 	}
 	for( ;; )
 	{
-		rStrm.ReadUniOrByteStringLine( aLine );
+		ReadCSVLine( rStrm, aLine, cStr, bFixed );
 		if ( rStrm.IsEof() )
 			break;
 
