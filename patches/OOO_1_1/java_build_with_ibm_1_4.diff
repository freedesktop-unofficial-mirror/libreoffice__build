--- config_office/configure.in
+++ config_office/configure.in
@@ -1335,6 +1335,14 @@
         AC_MSG_RESULT([checked (JDK $_jdk)])
       fi
       JAVA_HOME=`echo $JAVAC | $SED -n "s,//*bin//*javac,,p"`
+
+      dnl test for the jar archive with core classes
+      dnl IBM Java, verison 1.4 uses core.jar instead of rt.jar
+      if test -f "$JAVA_HOME/jre/lib/core.jar" ; then
+        CORECLASS="core.jar"
+      else
+        CORECLASS="rt.jar"
+      fi
    else
       AC_MSG_ERROR([JAVA not found. You need at least jdk-1.3])
    fi
@@ -1351,6 +1359,7 @@
 fi
 AC_SUBST(JAVA_HOME)
 AC_SUBST(JDK)
+AC_SUBST(CORECLASS)
 AC_SUBST(XSLTPROC)
 
 dnl ===================================================================
--- config_office/set_soenv.in
+++ config_office/set_soenv.in
@@ -374,9 +374,15 @@
       $CPU            = "I";
       $CPUNAME        = "INTEL";
       $DLLSUFFIX      = "li";
-      $JRELIBDIR      = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386";
-      $JRETOOLKITDIR  = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386".$ds."client";
-      $JRETHREADDIR   = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386".$ds."native_threads";
+      if ( '@JDK@' eq 'IBM') {
+         $JRELIBDIR      = '$JAVA_HOME'.$ds."jre".$ds."bin";
+         $JRETOOLKITDIR  = '$JAVA_HOME'.$ds."jre".$ds."bin".$ds."classic";
+         $JRETHREADDIR   = '$JAVA_HOME'.$ds."jre".$ds."bin";
+      } else {
+         $JRELIBDIR      = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386";
+         $JRETOOLKITDIR  = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386".$ds."client";
+         $JRETHREADDIR   = '$JAVA_HOME'.$ds."jre".$ds."lib".$ds."i386".$ds."native_threads";
+      }
    }
    elsif (($machine_type eq "sparc") or ($machine_type eq "sparc64"))
  
@@ -868,10 +874,11 @@
 $DMAKEROOT            = '$SOLARENVINC'.$ds."startup";
 # Location of JDK classes .zip file.
 # but in jdk 1.2 it is called rt.jar and it lives in jre/lib
-$CLASSPATH            = '$JAVA_HOME'.$ds.'jre'.$LIB.$ds."rt.jar".$ps.'.';
+# and IBM Java, version 1.4 uses core.jar instead of rt.jar
+$CLASSPATH            = '$JAVA_HOME'.$ds.'jre'.$LIB.$ds.'@CORECLASS@'.$ps.'.';
 # Location of the JDK supported standard classes.zip file.
 # see above for why the change
-$XCLASSPATH           = '$JAVA_HOME'.$ds.'jre'.$LIB.$ds."rt.jar".$ps.'.';
+$XCLASSPATH           = '$JAVA_HOME'.$ds.'jre'.$LIB.$ds.'@CORECLASS@'.$ps.'.';
 
 # Paths to run time shared libraries.
 if ($platform eq "$Solaris") 
