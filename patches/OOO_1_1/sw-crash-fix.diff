Index: sw/source/core/layout/layact.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/layact.cxx,v
retrieving revision 1.32.54.1
diff -u -r1.32.54.1 layact.cxx
--- sw/source/core/layout/layact.cxx	9 Jan 2004 14:31:40 -0000	1.32.54.1
+++ sw/source/core/layout/layact.cxx	23 Aug 2004 10:13:13 -0000
@@ -1342,6 +1342,8 @@
 
 			if ( bTstCnt )
 			{
+			        bool bPageChg = false;
+			  
 				if ( pCntnt->IsInSct() )
 				{
 					const SwSectionFrm *pSct = ((SwFrm*)pCntnt)->ImplFindSctFrm();
@@ -1351,15 +1353,19 @@
 						pSct->SetCompletePaint();
 						if ( IsAgain() )
 							return FALSE;
+						bPageChg = pCntnt->FindPageFrm() != p2ndPage && prPage->GetPrev();
 					}
 				}
-				if ( !pCntnt->IsValid() )
-				{	pCntnt->Calc();
-					pCntnt->SetCompletePaint();
+								
+				if ( !bPageChg && !pCntnt->IsValid() )
+				{
+				        pCntnt->Calc();
+                                        pCntnt->SetCompletePaint();
 					if ( IsAgain() )
 						return FALSE;
+					bPageChg = pCntnt->FindPageFrm() != p2ndPage && prPage->GetPrev();
 				}
-				if ( pCntnt->IsInTab() )
+				if ( !bPageChg && pCntnt->IsInTab() )
 				{
 					const SwTabFrm *pTab = ((SwFrm*)pCntnt)->ImplFindTabFrm();
 					if ( !pTab->IsValid() )
@@ -1368,9 +1374,10 @@
 						pTab->SetCompletePaint();
 						if ( IsAgain() )
 							return FALSE;
+						bPageChg = pCntnt->FindPageFrm() != p2ndPage && prPage->GetPrev();
 					}
 				}
-				if ( pCntnt->IsInSct() )
+				if ( !bPageChg && pCntnt->IsInSct() )
 				{
 					const SwSectionFrm *pSct = ((SwFrm*)pCntnt)->ImplFindSctFrm();
 					if ( !pSct->IsValid() )
@@ -1379,27 +1386,20 @@
 						pSct->SetCompletePaint();
 						if ( IsAgain() )
 							return FALSE;
+						bPageChg = pCntnt->FindPageFrm() != p2ndPage && prPage->GetPrev();  
 					}
 				}
-#ifdef USED
-				if ( (pCntnt->FindPageFrm() != p2ndPage) &&
-					 prPage->GetPrev() )
-				{
-					prPage = (SwPageFrm*)prPage->GetPrev();
-					bRet = FALSE;
-				}
-#else
-				const SwPageFrm* pTmp = pCntnt->FindPageFrm();
-				if ( pTmp != p2ndPage && prPage->GetPrev() )
+				
+				if ( bPageChg )
 				{
 					bRet = FALSE;
+					const SwPageFrm* pTmp = pCntnt->FindPageFrm();
 					if( pTmp->GetPhyPageNum() < prPage->GetPhyPageNum()
 						&& pTmp->IsInvalid() )
 						prPage = (SwPageFrm*)pTmp;
 					else
 						prPage = (SwPageFrm*)prPage->GetPrev();
 				}
-#endif
 			}
 		}
 	}

