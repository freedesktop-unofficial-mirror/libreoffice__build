diff -u -p -u -r1.55.6.7 -r1.63
--- config_office/configure.in	19 Feb 2004 10:59:25 -0000	1.55.6.7
+++ config_office/configure.in	17 Mar 2004 09:33:26 -0000	1.63
@@ -139,7 +139,7 @@ AC_ARG_WITH(mspdb-path,
 [  --with-mspdb-path       For Microsoft C/C++ compiler users, please supply the path
                           pointing to the mspdb60.dll (MSVC 6) or mspdb60.dll (.NET). 
  
-                          Usage: --with-mspdb-path=<absolute path to mspdb60.dll/mspdb70.dll>
+                          Usage: --with-mspdb-path=<absolute path to mspdb60.dll/mspdb7x.dll>
 ],,)
 AC_ARG_WITH(midl-path,
 [  --with-midl-path        For Microsoft C/C++ .NET compiler users, please supply the path
@@ -720,6 +734,19 @@ if test "$_os" = "WINNT"; then
    			if test -e "$with_mspdb_path/mspdb60.dll"; then
 				MSPDB_PATH="$with_mspdb_path"
             fi
+      if test -z "$MSPDB_PATH"; then
+		dnl  Check for .Net 2003 Compiler
+			AC_PATH_PROG(MSPDB_PATH, mspdb71.dll)
+			if test -n "$MSPDB_PATH";then
+				MSPDB_PATH=`dirname "$MSPDB_PATH"`
+			fi
+   			if test -e "$with_mspdb_path/mspdb71.dll"; then
+				MSPDB_PATH="$with_mspdb_path"
+            fi
+			if test -z "$MSPDB_PATH" -a -e "$with_cl_home/../Common7/IDE/mspdb71.dll"; then
+				MSPDB_PATH="$with_cl_home/../Common7/IDE"
+			fi
+		fi
 			if test -z "$MSPDB_PATH" -a -e "$with_cl_home/../Common/msdev98/mspdb60.dll"; then
 				MSPDB_PATH="$with_cl_home/../Common/msdev98"
 			fi
@@ -760,17 +787,13 @@ if test "$_os" = "WINNT"; then
 							}
 							}"`
 			AC_MSG_RESULT([found Compiler version $CCNUMVER.])
-			if test $CCNUMVER -ge "001300000000"; then
-				COMEX=8
+			if test "$CCNUMVER" -ge "001300102240"; then
+				COMEX=10
 			else
-				if test $CCNUMVER -ge "001200000000"; then
-					if test "$with_old_psdk" != "yes"; then
-						COMEX=9
-					else
-						COMEX=7
-					fi
+				if test "$CCNUMVER" -ge "001300000000"; then
+					COMEX=8
 				else
-					AC_MSG_ERROR([Compiler too old.])
+					AC_MSG_ERROR([Compiler too old. Use Microsoft C/C++ .NET 2002 compiler.])
 				fi
 			fi
 		else
@@ -791,7 +814,7 @@ AC_SUBST(MSPDB_PATH)
 dnl ===================================================================
 dnl  .NET needs special treatment
 dnl ===================================================================
-if test "$COMEX" = "8"; then
+if test "$COMEX" = "8" -o "$COMEX" = "10"; then
 	dnl Check midl.exe
 	AC_PATH_PROG(MIDL_PATH, midl.exe)
 	if test -n "$MIDL_PATH";then
@@ -1644,6 +1722,22 @@ Please copy the files to external/msvcp7
 fi
 
 dnl ===================================================================
+dnl Windows builds with .NET 2003 needs msvcp71.dll/msvcr71.dll in external/msvcp71
+dnl ===================================================================
+if test "$_os" = "WINNT" -a "$COMEX" = "10"; then
+   AC_MSG_CHECKING([msvcp71.dll])
+   if test -f ../external/msvcp71/msvcp71.dll -a -f ../external/msvcp71/msvcr71.dll; then
+      AC_MSG_RESULT([found])
+   else
+      AC_MSG_ERROR([msvcp71.dll and/or msvcr71.dll are/is missing in external/msvcp71/.
+These dlls are part of the .NET installation and can be found in a directory
+similar to:
+"c:\\Program Files\\Microsoft Visual Studio .NET\\Visual C++ .NET Professional - English\\"
+Please copy the files to external/msvcp71.])
+   fi
+fi
+
+dnl ===================================================================
 dnl Test for the presence of the right polygon clipping code
 dnl ===================================================================
 
