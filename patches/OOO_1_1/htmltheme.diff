--- /dev/null	2003-01-30 10:24:37.000000000 +0000
+++ sd/source/filter/html/htmltheme.cxx	2003-08-15 15:29:23.000000000 +0100
@@ -0,0 +1,160 @@
+#ifndef _COM_SUN_STAR_BEANS_PROPERTYVALUE_HPP_
+#include <com/sun/star/beans/PropertyValue.hpp>
+#endif
+#ifndef _UNTOOLS_UCBSTREAMHELPER_HXX 
+#include <unotools/ucbstreamhelper.hxx>
+#endif
+#ifndef _SV_LSTBOX_HXX
+#include <vcl/lstbox.hxx>
+#endif
+#ifndef _FILTER_CONFIG_ITEM_HXX_
+#include <svtools/FilterConfigItem.hxx>
+#endif
+#ifndef _SV_BUTTON_HXX
+#include <vcl/button.hxx>
+#endif
+#ifndef _SV_FIXED_HXX
+#include <vcl/fixed.hxx>
+#endif
+#ifndef _SV_COMBOBOX_HXX
+#include <vcl/combobox.hxx>
+#endif
+#ifndef _SVEDIT_HXX
+#include <svtools/svmedit.hxx>
+#endif
+#ifndef _SFXINTITEM_HXX
+#include <svtools/intitem.hxx>
+#endif
+#ifndef _AEITEM_HXX
+#include <svtools/aeitem.hxx>
+#endif
+#ifndef _SFXITEMSET_HXX
+#include <svtools/itemset.hxx>
+#endif
+#ifndef _SFXSTRITEM_HXX
+#include <svtools/stritem.hxx>
+#endif
+#ifndef _SV_MSGBOX_HXX
+#include <vcl/msgbox.hxx>
+#endif
+#ifndef _VALUESET_HXX
+#include <svtools/valueset.hxx>
+#endif
+#ifndef _GALLERY_HXX_
+#include <svx/gallery.hxx>
+#endif
+#ifndef _SV_GRAPH_HXX
+#include <vcl/graph.hxx>
+#endif
+#ifndef _SFXENUMITEM_HXX
+#include <svtools/eitem.hxx>
+#endif
+#include <svx/impgrf.hxx>
+#ifndef _SV_COLRDLG_HXX
+#include <svtools/colrdlg.hxx>
+#endif
+#ifndef _EEITEMID_HXX
+#include <svx/eeitemid.hxx>
+#endif
+#ifndef _SVX_COLRITEM_HXX
+#include <svx/colritem.hxx>
+#endif
+#ifndef _SVX_ADRITEM_HXX //autogen
+#include <svx/adritem.hxx>
+#endif
+#ifndef _LIST_HXX
+#include <tools/list.hxx>
+#endif
+#ifndef _SD_SDIOCMPT_HXX
+#include <sdiocmpt.hxx>
+#endif
+#ifndef _SFXDOCFILE_HXX //autogen
+#include <sfx2/docfile.hxx>
+#endif
+#ifndef _SFXAPP_HXX
+#include <sfx2/app.hxx>
+#endif
+#ifndef _PRESENTATION_HXX
+#include <pres.hxx>
+#endif
+#ifndef INCLUDED_SVTOOLS_USEROPTIONS_HXX
+#include <svtools/useroptions.hxx>
+#endif
+#include <svtools/pathoptions.hxx>
+
+#include "htmltheme.hxx"
+
+const SdHtmlTheme &
+SdHtmlTheme::getTheme()
+{
+	/* FIXME: could do with some fun locking action */
+	static SdHtmlTheme aTheme;
+
+	return aTheme;
+}
+
+SdHtmlTheme::SdHtmlTheme()
+{
+	/* foo */
+}
+
+SdHtmlTheme::~SdHtmlTheme()
+{
+	/* foo */
+}
+
+int
+SdHtmlTheme::getThemeCount() const
+{
+	UINT16 nFavCount = (UINT16) GalleryExplorer::GetObjCount( GALLERY_THEME_HTMLBUTTONS );
+	return nFavCount / nButtonsPerTheme;
+}
+
+Bitmap
+SdHtmlTheme::getThumbnail( int nThemeId ) const
+{
+	USHORT nItem = 1;
+	Graphic	aThumb;
+	Size aSize( (8*40) - 8, 32 );
+	Point aOrigin( 0,0 );
+	Size aDestSize( 32, 32 );
+
+	int nBase = nThemeId * nButtonsPerTheme + 1;
+
+	VirtualDevice aVDev;
+	aVDev.SetMapMode(MapMode(MAP_PIXEL));
+	aVDev.SetOutputSizePixel( aSize );
+
+	static int nPreviewBitmapOffests[] = { 1,3,5,7,8,9,10,11 };
+
+	for( int nImage = 0; nImage < 8; nImage++ )
+	{
+		if(!GalleryExplorer::GetGraphicObj( GALLERY_THEME_HTMLBUTTONS,
+						    nBase + nPreviewBitmapOffests[nImage], &aThumb ) )
+			continue;
+
+		// ValueSet fuellen
+		Bitmap aBitmap( aThumb.GetBitmap() );
+		
+		Point aDestPt( nImage * 40, 0 );
+		aVDev.DrawBitmap( aDestPt, aDestSize, aBitmap );
+	}
+
+	Bitmap aBitmap( aVDev.GetBitmap( aOrigin, aSize ) );
+	
+	return aBitmap;
+}
+
+long
+SdHtmlTheme::getBitmap( int nThemeId, int nImage, BitmapEx &rBitmap ) const
+{
+	int nBase = nThemeId * nButtonsPerTheme + 1;
+	long nErr;
+
+	Graphic aGraphic;
+	nErr = GalleryExplorer::GetGraphicObj( GALLERY_THEME_HTMLBUTTONS,
+					       nBase + nImage, &aGraphic )?0:1;
+	rBitmap = aGraphic.GetBitmapEx();
+
+	return nErr;
+}
--- /dev/null	2003-01-30 10:24:37.000000000 +0000
+++ sd/source/filter/html/htmltheme.hxx	2003-08-15 15:28:08.000000000 +0100
@@ -0,0 +1,18 @@
+#ifndef _SD_HTML_THEME_HXX
+#define _SD_HTML_THEME_HXX
+
+class SdHtmlTheme {
+private:
+	/* list */
+public:
+	static const SdHtmlTheme &getTheme();
+public:
+	SdHtmlTheme();
+	~SdHtmlTheme();
+	static const int nButtonsPerTheme = 12;
+	int      getThemeCount() const;
+	Bitmap   getThumbnail( int nThemeId ) const;
+	long      getBitmap( int nThemeId, int nImage, BitmapEx &rBitmap ) const;
+};
+
+#endif // _SD_SIMPLE_THEME_HXX
