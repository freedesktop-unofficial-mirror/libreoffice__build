Index: sc/source/ui/app/sclib.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/Attic/sclib.cxx,v
retrieving revision 1.25
diff -u -p -u -r1.25 sclib.cxx
--- sc/source/ui/app/sclib.cxx	26 Mar 2003 18:05:47 -0000	1.25
+++ sc/source/ui/app/sclib.cxx	27 May 2004 12:55:29 -0000
@@ -548,6 +554,12 @@ ULONG __EXPORT ScDLL::DetectFilter( SfxM
 			  0x0004, 0x0000,					// File Revision Subcode
 			  M_ENDE };
 
+		const UINT16 pLotus97[] =		        // Lotus > 97
+			{ 0x0000, 0x0000, M_DC, 0x0000,	    // Rec# + Len (0x1a)
+			  0x0003, 0x0010, 0x0004,			// File Revision Code
+			  0x0000, 0x0000,
+			  M_ENDE };
+
 		const UINT16 pDIF1[] =			// DIF mit CR-LF
 			{
 			'T', 'A', 'B', 'L', 'E',
@@ -572,7 +584,7 @@ ULONG __EXPORT ScDLL::DetectFilter( SfxM
 			M_ENDE };
 
 #ifdef SINIX
-		const UINT16 nAnzMuster = 9;	// sollte fuer indiz. Zugriff stimmen...
+		const UINT16 nAnzMuster = 10;	// sollte fuer indiz. Zugriff stimmen...
 		UINT16 *ppMuster[ nAnzMuster ];			// Arrays mit Suchmustern
 		ppMuster[ 0 ] = pLotus;
 		ppMuster[ 1 ] = pExcel1;
@@ -582,7 +594,8 @@ ULONG __EXPORT ScDLL::DetectFilter( SfxM
 		ppMuster[ 5 ] = pDIF1;
 		ppMuster[ 6 ] = pDIF2;
 		ppMuster[ 7 ] = pSylk;
-		ppMuster[ 8 ] = pLotus2;				// Lotus immer ganz hinten wegen Ini-Eintrag
+		ppMuster[ 8 ] = pLotus97;
+		ppMuster[ 9 ] = pLotus2;				// Lotus immer ganz hinten wegen Ini-Eintrag
 #else
 		const UINT16 *ppMuster[] =		// Arrays mit Suchmustern
 			{
@@ -594,6 +607,7 @@ ULONG __EXPORT ScDLL::DetectFilter( SfxM
 			pDIF1,
 			pDIF2,
 			pSylk,
+			pLotus97,
 			pLotus2
 			};
 		const UINT16 nAnzMuster = sizeof(ppMuster) / sizeof(ppMuster[0]);
@@ -609,6 +623,7 @@ ULONG __EXPORT ScDLL::DetectFilter( SfxM
 			pFilterDif,
 			pFilterDif,
 			pFilterSylk,
+			pFilterLotus,
 			pFilterLotus
 			};
 
Index: officecfg/registry/data/org/openoffice/Office/TypeDetection.xcu
===================================================================
RCS file: /cvs/util/officecfg/registry/data/org/openoffice/Office/TypeDetection.xcu,v
retrieving revision 1.44.8.4
diff -u -p -u -r1.44.8.4 TypeDetection.xcu
--- officecfg/registry/data/org/openoffice/Office/TypeDetection.xcu	10 Feb 2004 20:10:09 -0000	1.44.8.4
+++ officecfg/registry/data/org/openoffice/Office/TypeDetection.xcu	27 May 2004 13:06:58 -0000
@@ -210,7 +210,7 @@
         <value xml:lang="en-US">Lotus</value>
       </prop>
       <prop oor:name="Data">
-        <value>1,,,,wk1;wks,0,</value>
+        <value>1,,,,wk1;wks;123,0,</value>
       </prop>
     </node>
     <node oor:name="calc_MS_Excel_40" oor:op="replace">
