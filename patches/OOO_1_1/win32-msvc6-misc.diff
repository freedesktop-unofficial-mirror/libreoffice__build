Index: config_office/configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.55.6.7
diff -u -p -u -p -r1.55.6.7 configure.in
--- config_office/configure.in	19 Feb 2004 10:59:25 -0000	1.55.6.7
+++ config_office/configure.in	15 Apr 2004 06:46:06 -0000
@@ -760,17 +869,17 @@ if test "$_os" = "WINNT"; then
 							}
 							}"`
 			AC_MSG_RESULT([found Compiler version $CCNUMVER.])
-			if test $CCNUMVER -ge "001300000000"; then
-				COMEX=8
+			if test "$CCNUMVER" -ge "001300102240"; then
+				COMEX=10
 			else
-				if test $CCNUMVER -ge "001200000000"; then
-					if test "$with_old_psdk" != "yes"; then
+				if test "$CCNUMVER" -ge "001300000000"; then
+					COMEX=8
+				else
+					if test "$CCNUMVER" -ge "001200000000"; then
 						COMEX=9
 					else
-						COMEX=7
+						AC_MSG_ERROR([Compiler too old. Use Microsoft C/C++ .NET 2002 compiler.])
 					fi
-				else
-					AC_MSG_ERROR([Compiler too old.])
 				fi
 			fi
 		else
Index: config_office/set_soenv.in
===================================================================
RCS file: /cvs/tools/config_office/set_soenv.in,v
retrieving revision 1.10.6.6
diff -u -p -u -p -r1.10.6.6 set_soenv.in
--- config_office/set_soenv.in	13 Feb 2004 14:20:17 -0000	1.10.6.6
+++ config_office/set_soenv.in	15 Apr 2004 06:54:44 -0000
@@ -575,13 +576,14 @@ elsif ( $platform eq "$Winnt" ) 
       $INPATH         = $OUTPATH.$PROEXT;
       $GVERDIR        = $INPATH;
       $COMEX          = '@COMEX@';
-      if ( "@COMEX@" eq "8" )
-      {  # .NET needs M1300
-         $CVER        = "M1300";
-      }
-      else
-      {  # keep the historical value for MSVC 6
-         $CVER        = "MI200";
+      if ( "@COMEX@" eq "10" ) { # .NET 2003 needs M1310
+          $CVER        = "M1310";
+      } elsif ( "@COMEX@" eq "8" ) { # .NET 2002 needs M1300
+          $CVER        = "M1300";
+      } elsif ( "@COMEX@" eq "9" ) { # VC 6
+          $CVER        = "MI200";
+      } else {                   # Unsupported
+          die "Unsupported value for COMEX variable.\n";
       }
 
   if ( "@USE_SHELL@" ne "4nt" )
