diff -r --new-file -u /tmp/empty/gtk/gtkdata.hxx vcl/unx/inc/plugins/gtk/gtkdata.hxx
--- /tmp/empty/gtk/gtkdata.hxx	1970-01-01 01:00:00.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkdata.hxx	2004-05-10 16:54:49.000000000 +0100
@@ -0,0 +1,117 @@
+/*************************************************************************
+ *
+ *  
+ *
+ *  
+ *
+ *  
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKDATA_HXX
+#define _VCL_GTKDATA_HXX
+
+#include <prex.h>
+#include <gdk/gdk.h>
+#include <gdk/gdkx.h>
+#include <gtk/gtk.h>
+#include <postx.h>
+
+#include <saldisp.hxx>
+#include <saldata.hxx>
+#include <ptrstyle.hxx>
+
+#include <list>
+
+class GtkData : public SalData
+{
+public:
+    GtkData() {}
+    virtual ~GtkData();
+    
+    virtual void Init();
+    
+    virtual void initNWF();
+    virtual void deInitNWF();
+};
+
+class GtkSalFrame;
+
+class GtkSalDisplay : public SalDisplay
+{
+    GdkDisplay*						m_pGdkDisplay;
+	GdkCursor                      *m_aCursors[ POINTER_COUNT ];
+	GdkCursor* getFromXPM( const char *pBitmap, const char *pMask,
+						   int nWidth, int nHeight, int nXHot, int nYHot );
+public:
+			 GtkSalDisplay( GdkDisplay* pDisplay, Visual* pVis, Colormap aCol );
+    virtual ~GtkSalDisplay();
+
+    GdkDisplay* GetGdkDisplay() const { return m_pGdkDisplay; }
+
+    virtual void deregisterFrame( SalFrame* pFrame );
+	GdkCursor *getCursor( PointerStyle ePointerStyle );
+	virtual int CaptureMouse( SalFrame* pFrame );
+    virtual long Dispatch( XEvent *pEvent );
+
+    static GdkFilterReturn filterGdkEvent( GdkXEvent* sys_event,
+                                           GdkEvent* event,
+                                           gpointer data );
+	inline bool HasMoreEvents()     { return m_aUserEvents.size() > 1; }
+	inline void EventGuardAcquire() { osl_acquireMutex( hEventGuard_ ); }
+	inline void EventGuardRelease() { osl_releaseMutex( hEventGuard_ ); }
+};
+
+
+#endif // _VCL_GTKDATA_HXX
diff -r --new-file -u /tmp/empty/gtk/gtkframe.hxx vcl/unx/inc/plugins/gtk/gtkframe.hxx
--- /tmp/empty/gtk/gtkframe.hxx	1970-01-01 01:00:00.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkframe.hxx	2004-05-10 16:55:02.000000000 +0100
@@ -0,0 +1,264 @@
+/*************************************************************************
+ *
+ *  
+ *
+ *  
+ *
+ *  
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKFRAME_HXX
+#define _VCL_GTKFRAME_HXX
+
+#include <prex.h>
+#include <gtk/gtk.h>
+#include <gdk/gdk.h>
+#include <gdk/gdkx.h>
+#include <gdk/gdkkeysyms.h>
+#include <postx.h>
+
+#ifndef _SV_SALFRAME_HXX
+#include <salframe.hxx>
+#endif
+#ifndef _SV_SYSDATA_HXX
+#include <sysdata.hxx>
+#endif
+
+class X11SalGraphics;
+class GtkSalDisplay;
+
+class GtkSalFrame : public SalFrame
+{
+    static const int nMaxGraphics = 2;
+
+    struct GraphicsHolder
+    {
+        X11SalGraphics*		pGraphics;
+        bool				bInUse;
+        GraphicsHolder() 
+                : pGraphics( NULL ),
+                  bInUse( false )
+        {}
+        ~GraphicsHolder();
+    };
+
+    GtkWindow*				m_pWindow;
+    GdkWindow*				m_pForeignParent;
+    GdkWindow*				m_pForeignTopLevel;
+    ULONG					m_nStyle;
+    GtkFixed*				m_pFixedContainer;
+    GtkSalFrame*			m_pParent;
+    GdkWindowState			m_nState;
+    GtkIMContext*			m_pIMContext;
+    SystemEnvData			m_aSystemData;
+    GraphicsHolder			m_aGraphics[ nMaxGraphics ];
+	USHORT                  m_nKeyModifiers;
+	GdkCursor              *m_pCurrentCursor;
+    GdkVisibilityState		m_nVisibility;
+	int						m_nSavedScreenSaverTimeout;
+    bool					m_bResizeable;
+	bool					m_bSingleAltPress;
+    bool					m_bDefaultPos;
+    bool					m_bDefaultSize;
+    bool					m_bSendModChangeOnRelease;
+    bool					m_bWasPreedit;
+
+    void Init( SalFrame* pParent, ULONG nStyle );
+    void Init( SystemParentData* pSysData );
+    void InitCommon();    
+
+    // signals
+    static gboolean		signalButton( GtkWidget*, GdkEventButton*, gpointer );
+    static void			signalStyleSet( GtkWidget*, GtkStyle* pPrevious, gpointer );
+    static gboolean		signalExpose( GtkWidget*, GdkEventExpose*, gpointer );
+    static gboolean		signalFocus( GtkWidget*, GdkEventFocus*, gpointer );
+    static gboolean		signalMap( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalUnmap( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalConfigure( GtkWidget*, GdkEventConfigure*, gpointer );
+    static gboolean		signalMotion( GtkWidget*, GdkEventMotion*, gpointer );
+    static gboolean		signalKey( GtkWidget*, GdkEventKey*, gpointer );
+    static gboolean		signalDelete( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalState( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalScroll( GtkWidget*, GdkEvent*, gpointer );
+    static gboolean		signalCrossing( GtkWidget*, GdkEventCrossing*, gpointer );
+    static gboolean		signalVisibility( GtkWidget*, GdkEventVisibility*, gpointer );
+    static void			signalIMCommit( GtkIMContext*, gchar*, gpointer );
+    static gboolean		signalIMDeleteSurrounding( GtkIMContext*, gint, gint, gpointer );
+    static void			signalIMPreeditChanged( GtkIMContext*, gpointer );
+    static void			signalIMPreeditEnd( GtkIMContext*, gpointer );
+    static void			signalIMPreeditStart( GtkIMContext*, gpointer );
+    static gboolean		signalIMRetrieveSurrounding( GtkIMContext*, gpointer );
+    
+
+	GtkSalDisplay*	getDisplay();
+	GdkDisplay*		getGdkDisplay();
+    void			Center();
+    void			SetDefaultSize();
+	void			setAutoLock( bool bLock );
+	void			setScreenSaverTimeout( int nTimeout );
+
+    GdkNativeWindow findTopLevelSystemWindow( GdkNativeWindow aWindow );
+
+    static int m_nFloats;
+
+    bool isFloatGrabWindow() const
+    {
+        return
+            (m_nStyle & SAL_FRAME_STYLE_FLOAT) &&		// only a float can be floatgrab
+            !(m_nStyle & SAL_FRAME_STYLE_TOOLTIP);		// tool tips are not
+    }
+
+    Size calcDefaultSize();
+
+public:
+    GtkSalFrame( SalFrame* pParent, ULONG nStyle );
+    GtkSalFrame( SystemParentData* pSysData );
+
+    // dispatches an event, returns true if dispatched
+    // and false else; if true was returned the event should
+    // be swallowed
+    bool Dispatch( const XEvent* pEvent );
+	void grabPointer( BOOL bGrab, BOOL bOwnerEvents = FALSE );
+
+    GtkWindow*	getWindow() const { return m_pWindow; }
+    GtkFixed*	getFixedContainer() const { return m_pFixedContainer; }
+    GdkWindow*	getForeignParent() const { return m_pForeignParent; }
+    GdkWindow*	getForeignTopLevel() const { return m_pForeignTopLevel; }
+    GdkVisibilityState getVisibilityState() const 
+    { return m_nVisibility; }
+
+    virtual ~GtkSalFrame();
+
+    // SalGraphics or NULL, but two Graphics for all SalFrames
+    // must be returned
+    virtual SalGraphics*		GetGraphics();
+    virtual void				ReleaseGraphics( SalGraphics* pGraphics );
+
+    // Event must be destroyed, when Frame is destroyed
+    // When Event is called, SalInstance::Yield() must be returned
+    virtual BOOL				PostEvent( void* pData );
+
+    virtual void				SetTitle( const XubString& rTitle );
+    virtual void				SetIcon( USHORT nIcon );
+    virtual void              SetMenu( SalMenu *pSalMenu );
+    virtual void              DrawMenuBar();
+
+    // Before the window is visible, a resize event
+    // must be sent with the correct size
+    virtual void				Show( BOOL bVisible, BOOL bNoActivate = FALSE );
+    virtual void				Enable( BOOL bEnable );
+    // Set ClientSize and Center the Window to the desktop
+    // and send/post a resize message
+    virtual void              SetMinClientSize( long nWidth, long nHeight );
+    virtual void				SetPosSize( long nX, long nY, long nWidth, long nHeight, USHORT nFlags );
+    virtual void				GetClientSize( long& rWidth, long& rHeight );
+    virtual void				GetWorkArea( Rectangle& rRect );
+    virtual SalFrame*			GetParent() const;
+    virtual void				SetWindowState( const SalFrameState* pState );
+    virtual BOOL				GetWindowState( SalFrameState* pState );
+    virtual void				ShowFullScreen( BOOL bFullScreen );
+    // Enable/Disable ScreenSaver, SystemAgents, ...
+    virtual void				StartPresentation( BOOL bStart );
+    // Show Window over all other Windows
+    virtual void				SetAlwaysOnTop( BOOL bOnTop );
+
+    // Window to top and grab focus
+    virtual void				ToTop( USHORT nFlags );
+
+    // this function can call with the same
+    // pointer style
+    virtual void				SetPointer( PointerStyle ePointerStyle );
+    virtual void				CaptureMouse( BOOL bMouse );
+    virtual void				SetPointerPos( long nX, long nY );
+
+    // flush output buffer
+    virtual void				Flush();
+    // flush output buffer, wait till outstanding operations are done
+    virtual void				Sync();
+
+    virtual void				SetInputContext( SalInputContext* pContext );
+    virtual void				EndExtTextInput( USHORT nFlags );
+
+    virtual String				GetKeyName( USHORT nKeyCode );
+    virtual String				GetSymbolKeyName( const XubString& rFontName, USHORT nKeyCode );
+
+    // returns the input language used for the last key stroke
+    // may be LANGUAGE_DONTKNOW if not supported by the OS
+    virtual LanguageType		GetInputLanguage();
+
+    virtual SalBitmap*			SnapShot();
+
+    virtual void				UpdateSettings( AllSettings& rSettings );
+
+    virtual void				Beep( SoundType eSoundType );
+
+    // returns system data (most prominent: window handle)
+    virtual const SystemEnvData*	GetSystemData() const;
+
+
+    // get current modifier and button mask
+    virtual ULONG				GetCurrentModButtons();
+
+    // set new parent window
+    virtual void				SetParent( SalFrame* pNewParent );
+    // reparent window to act as a plugin; implementation
+    // may choose to use a new system window internally
+    // return false to indicate failure
+    virtual bool				SetPluginParent( SystemParentData* pNewParent );
+
+};
+
+
+#endif //_VCL_GTKFRAME_HXX
diff -r --new-file -u /tmp/empty/gtk/gtkgdi.hxx vcl/unx/inc/plugins/gtk/gtkgdi.hxx
--- /tmp/empty/gtk/gtkgdi.hxx	1970-01-01 01:00:00.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkgdi.hxx	2004-05-10 16:55:11.000000000 +0100
@@ -0,0 +1,144 @@
+/*************************************************************************
+ *
+ *  
+ *
+ *  
+ *
+ *  
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKGDI_HXX
+#define _VCL_GTKGDI_HXX
+
+#include <prex.h>
+#include <gtk/gtk.h>
+#include <gdk/gdkx.h>
+#include <gdk/gdkkeysyms.h>
+#include <postx.h>
+ 
+
+#ifndef _SV_SALGDI_H
+#include <salgdi.h>
+#endif
+
+class GtkSalGraphics : public X11SalGraphics
+{
+    GtkWidget           *m_pWindow;
+public:
+                        GtkSalGraphics( GtkWidget *window ) { m_pWindow = window; }
+    virtual             ~GtkSalGraphics();
+    
+    inline GtkWidget*  GetGtkWidget() const { return m_pWindow; }
+    inline GdkWindow*  GetGdkWindow() const { return m_pWindow->window; }
+    inline GtkSalFrame* GetGtkFrame() const { return static_cast<GtkSalFrame*>(m_pFrame); }
+    
+    
+    // will be set when UI theme was changed
+    static  BOOL        bThemeChanged;  
+    
+    // native widget methods
+    virtual BOOL        IsNativeControlSupported( ControlType nType, ControlPart nPart );
+    virtual BOOL        hitTestNativeControl( ControlType nType, ControlPart nPart, const Region& rControlRegion,
+                                              const Point& aPos, SalControlHandle& rControlHandle, BOOL& rIsInside );
+    virtual BOOL        drawNativeControl( ControlType nType, ControlPart nPart, const Region& rControlRegion,
+                                           ControlState nState, const ImplControlValue& aValue, SalControlHandle& rControlHandle,
+                                           rtl::OUString aCaption );
+    virtual BOOL        drawNativeControlText( ControlType nType, ControlPart nPart, const Region& rControlRegion,
+                                               ControlState nState, const ImplControlValue& aValue,
+                                               SalControlHandle& rControlHandle, rtl::OUString aCaption );
+    virtual BOOL        getNativeControlRegion( ControlType nType, ControlPart nPart, const Region& rControlRegion, ControlState nState,
+                                                const ImplControlValue& aValue, SalControlHandle& rControlHandle, rtl::OUString aCaption,
+                                                Region &rNativeBoundingRegion, Region &rNativeContentRegion );
+
+protected:
+    GdkPixmap* NWGetPixmapFromScreen( Rectangle srcRect );
+    BOOL NWRenderPixmapToScreen( GdkPixmap*	pPixmap, Rectangle dstRect );
+
+    BOOL NWPaintGTKButton( ControlType nType, ControlPart nPart,
+                           const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+                           SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKRadio( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKCheck( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKScrollbar( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKEditBox( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKSpinBox( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKComboBox( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKTabItem( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+    BOOL NWPaintGTKListBox( ControlType nType, ControlPart nPart,
+							const Region& rControlRegion, ControlState nState, const ImplControlValue& aValue,
+							SalControlHandle& rControlHandle, OUString aCaption );
+
+
+
+
+
+
+};
+
+#endif // _VCL_GTKGDI_HXX
diff -r --new-file -u /tmp/empty/gtk/gtkinst.hxx vcl/unx/inc/plugins/gtk/gtkinst.hxx
--- /tmp/empty/gtk/gtkinst.hxx	1970-01-01 01:00:00.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkinst.hxx	2004-05-10 16:55:23.000000000 +0100
@@ -0,0 +1,137 @@
+/*************************************************************************
+ *
+ *  
+ *
+ *  
+ *
+ *  
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKINST_HXX
+#define _VCL_GTKINST_HXX
+
+#include <salinst.h>
+#include <salsys.h>
+
+class GtkYieldMutex : public SalYieldMutex
+{
+public:
+												GtkYieldMutex();
+	virtual void								acquire();
+	virtual void								release();
+	virtual sal_Bool 							tryToAcquire();
+
+    virtual int Grab();
+    virtual void Ungrab( int );
+
+    class GtkYieldGuard
+    {
+        GtkYieldMutex*	m_pMutex;
+        int				m_nGrab;
+    public:
+        GtkYieldGuard( GtkYieldMutex* pMutex ) 
+                : m_pMutex( pMutex )
+        {
+            m_nGrab = m_pMutex->Grab();
+        }
+        ~GtkYieldGuard()
+        {
+            m_pMutex->Ungrab( m_nGrab );
+        }
+    };
+};
+
+class GtkHookedYieldMutex : public GtkYieldMutex
+{
+	virtual int		 Grab()				{ return 0; };
+	virtual void	 Ungrab(int )		{};
+	std::list<ULONG> aYieldStack;
+public:
+	GtkHookedYieldMutex();
+	virtual void      acquire();
+	virtual void      release();
+	virtual sal_Bool  tryToAcquire() { return SalYieldMutex::tryToAcquire(); }
+	void ThreadsEnter();
+	void ThreadsLeave();
+};
+
+
+#define GTK_YIELD_GRAB() GtkYieldMutex::GtkYieldGuard aLocalGtkYieldGuard( static_cast<GtkYieldMutex*>(GetSalData()->pInstance_->GetYieldMutex()) )
+
+class GtkInstance : public X11SalInstance
+{
+public:
+    GtkInstance( SalYieldMutex* pMutex ) 
+            : X11SalInstance( pMutex )
+    {}
+    virtual ~GtkInstance();
+
+    virtual SalFrame*			CreateFrame( SalFrame* pParent, ULONG nStyle );
+    virtual SalObject*			CreateObject( SalFrame* pParent );
+    virtual SalSystem*			CreateSalSystem();
+};
+
+class GtkSalSystem : public X11SalSystem
+{
+public:
+	GtkSalSystem() : X11SalSystem() {}
+    virtual ~GtkSalSystem();
+    virtual int ShowNativeDialog( const String& rTitle,
+                                  const String& rMessage,
+                                  const std::list< String >& rButtons,
+                                  int nDefButton );
+};
+
+#endif // _VCL_GTKINST_HXX
diff -r --new-file -u /tmp/empty/gtk/gtkobject.hxx vcl/unx/inc/plugins/gtk/gtkobject.hxx
--- /tmp/empty/gtk/gtkobject.hxx	1970-01-01 01:00:00.000000000 +0100
+++ vcl/unx/inc/plugins/gtk/gtkobject.hxx	2004-02-20 08:57:43.000000000 +0000
@@ -0,0 +1,110 @@
+/*************************************************************************
+ *
+ *  
+ *
+ *  
+ *
+ *  
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _VCL_GTKOBJECT_HXX
+#define _VCL_GTKOBJECT_HXX
+
+#ifndef _SV_SV_H
+#include <sv.h>
+#endif
+#ifndef _SV_SYSDATA_HXX
+#include <sysdata.hxx>
+#endif
+#ifndef _SV_SALOBJ_HXX
+#include <salobj.hxx>
+#endif
+#ifndef _VCL_GTKFRAME_HXX
+#include <plugins/gtk/gtkframe.hxx>
+#endif
+
+class GtkSalObject : public SalObject
+{
+	SystemChildData		m_aSystemData;
+    GtkWidget*			m_pSocket;
+    GdkRegion*			m_pRegion;
+
+    // signals
+    static gboolean		signalButton( GtkWidget*, GdkEventButton*, gpointer );
+    static gboolean		signalFocus( GtkWidget*, GdkEventFocus*, gpointer );
+public:
+    GtkSalObject( GtkSalFrame* pParent );
+    virtual ~GtkSalObject();
+
+    // overload all pure virtual methods
+ 	virtual void					ResetClipRegion();
+	virtual USHORT					GetClipRegionType();
+	virtual void					BeginSetClipRegion( ULONG nRects );
+	virtual void					UnionClipRegion( long nX, long nY, long nWidth, long nHeight );
+	virtual void					EndSetClipRegion();
+
+	virtual void					SetPosSize( long nX, long nY, long nWidth, long nHeight );
+	virtual void					Show( BOOL bVisible );
+	virtual void					Enable( BOOL nEnable );
+	virtual void					GrabFocus();
+
+	virtual void					SetBackground();
+	virtual void					SetBackground( SalColor nSalColor );
+
+	virtual const SystemEnvData*	GetSystemData() const;
+   
+};
+
+#endif // _SV_SALOBJ_H
