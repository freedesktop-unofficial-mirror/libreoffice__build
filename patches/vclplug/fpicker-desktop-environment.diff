--- desktop/source/app/javainteractionhandler.cxx	2002-09-20 10:01:10.000000000 +0200
+++ desktop/source/app/javainteractionhandler.cxx	2004-08-11 19:17:05.521192952 +0200
@@ -367,11 +367,17 @@ JavaContext::JavaContext( const Referenc
 {
 }
 
+#define DESKTOP_ENVIRONMENT_NAME "system.desktop-environment"
+
 Any SAL_CALL JavaContext::getValueByName( const OUString& Name) throw (RuntimeException)
 {
     Any retVal;
 
-    if ( 0 == Name.compareToAscii( JAVA_INTERACTION_HANDLER_NAME ))
+    if ( 0 == Name.compareToAscii( DESKTOP_ENVIRONMENT_NAME ) )
+    {
+        retVal = makeAny( Application::GetDesktopEnvironment() );
+    }
+    else if ( 0 == Name.compareToAscii( JAVA_INTERACTION_HANDLER_NAME ))
     {
         retVal = makeAny( Reference< XInteractionHandler >( new JavaInteractionHandler()) );
     }
