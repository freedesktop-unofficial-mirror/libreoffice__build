--- vcl/unx/source/app/sm.cxx
+++ vcl/unx/source/app/sm.cxx
@@ -417,6 +417,11 @@
     }
 }
 
+static bool bUseSMExtension = true;
+void SessionManagerClient::disableSM()
+{
+	bUseSMExtension = false;
+}
 
 void SessionManagerClient::open()
 {
@@ -424,8 +429,9 @@
 
 #ifdef USE_SM_EXTENSION
 	// this is the way Xt does it, so we can too
-	if( ! aSmcConnection && getenv( "SESSION_MANAGER" ) )
+	if( ! bUseSMExtension && ! aSmcConnection &&
+		getenv( "SESSION_MANAGER" ) )
 	{
 		char aErrBuf[1024];
 		ICEConnectionObserver::activate();

--- vcl/unx/inc/sm.hxx
+++ vcl/unx/inc/sm.hxx	2004-07-16 19:33:15.439574224 +0100
@@ -101,6 +101,7 @@
     static bool queryInteraction();
     static void saveDone();
     static void interactionDone();
+	static void disableSM();
 
 	static String getExecName();
 	static const ByteString&  getSessionID() { return aClientID; }
