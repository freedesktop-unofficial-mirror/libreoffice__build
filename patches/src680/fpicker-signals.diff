RCS file: /cvs/gsl/fpicker/source/unx/gnome/SalGtkFilePicker.cxx,v
retrieving revision 1.5
diff -u -p -u -r1.5 SalGtkFilePicker.cxx
--- fpicker/source/unx/gnome/SalGtkFilePicker.cxx	18 Mar 2005 09:48:46 -0000	1.5
+++ fpicker/source/unx/gnome/SalGtkFilePicker.cxx	11 Apr 2005 13:28:32 -0000
@@ -302,8 +306,15 @@ SalGtkFilePicker::SalGtkFilePicker( cons
         gtk_box_pack_end( GTK_BOX( m_pVBox ), m_pHBoxs[i], FALSE, FALSE, 0 );
 	}
 
 	gtk_file_chooser_set_extra_widget( GTK_FILE_CHOOSER( m_pDialog ), m_pVBox );
 
+	g_signal_connect( G_OBJECT( m_pToggles[PREVIEW] ), "toggled",
+					  G_CALLBACK( preview_toggled_cb ), this );
+	g_signal_connect( G_OBJECT( m_pFilterComboBox ), "changed",
+					  G_CALLBACK( filter_changed_atsave_cb ), this );
+	g_signal_connect( G_OBJECT( m_pDialog ), "notify::filter",
+					  G_CALLBACK( filter_changed_cb ), this );
+
     gtk_widget_show( m_pVBox );
 }
 
@@ -1411,6 +1469,14 @@ void SalGtkFilePicker::filter_changed_cb
 	pobjFP->controlStateChanged( evt );
 }
 
+void SalGtkFilePicker::filter_changed_atsave_cb( GtkComboBox *widget, SalGtkFilePicker *pobjFP )
+{
+	FilePickerEvent evt;
+	evt.ElementId = LISTBOX_FILTER;
+	OSL_TRACE( "filter_changed, isn't it great %x\n", pobjFP );
+	pobjFP->controlStateChanged( evt );
+}
+
 void SalGtkFilePicker::folder_changed_cb( GtkFileChooser *file_chooser, SalGtkFilePicker *pobjFP )
 {
 	FilePickerEvent evt;
@@ -1660,20 +1725,12 @@ void SAL_CALL SalGtkFilePicker::initiali
 			gtk_widget_show( m_pHBoxs[ nTVIndex ] );
         }
 	}
-
-	// if Preview check is visible, connect the signal handler
-	if( mbToggleVisibility[PREVIEW] )
-		gtk_signal_connect( GTK_OBJECT( m_pToggles[PREVIEW] ), "toggled",
-			GTK_SIGNAL_FUNC( preview_toggled_cb ), ( gpointer )this );
-
-	//Be informed when a filter changes
-	g_signal_connect( GTK_OBJECT( m_pDialog ), "notify::filter",
-			G_CALLBACK( filter_changed_cb ), this );
 }
 
 void SalGtkFilePicker::preview_toggled_cb( GtkObject *cb, SalGtkFilePicker* pobjFP )
 {
-	pobjFP->setShowState( gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON( cb ) ) );
+	if( pobjFP->mbToggleVisibility[PREVIEW] )
+		pobjFP->setShowState( gtk_toggle_button_get_active( GTK_TOGGLE_BUTTON( cb ) ) );
 }
 
 //------------------------------------------------------------------------------------


RCS file: /cvs/gsl/fpicker/source/unx/gnome/SalGtkFilePicker.hxx,v
retrieving revision 1.3
diff -u -p -u -r1.3 SalGtkFilePicker.hxx
--- fpicker/source/unx/gnome/SalGtkFilePicker.hxx	18 Jan 2005 13:24:57 -0000	1.3
+++ fpicker/source/unx/gnome/SalGtkFilePicker.hxx	11 Apr 2005 13:28:32 -0000
@@ -388,6 +392,7 @@ class SalGtkFilePicker : 
 
 		static void preview_toggled_cb (GtkObject *cb, SalGtkFilePicker *pobjFP);
 		static void filter_changed_cb (GtkFileChooser *file_chooser, GParamSpec *pspec, SalGtkFilePicker *pobjFP);
+        static void filter_changed_atsave_cb (GtkComboBox* widget, SalGtkFilePicker *pobjFP);
 		static void folder_changed_cb (GtkFileChooser *file_chooser, SalGtkFilePicker *pobjFP);
 		static void selection_changed_cb (GtkFileChooser *file_chooser, SalGtkFilePicker *pobjFP);
 		static void update_preview_cb (GtkFileChooser *file_chooser, SalGtkFilePicker *pobjFP);
