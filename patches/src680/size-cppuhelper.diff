Index: cppuhelper/inc/cppuhelper/interfacecontainer.h
===================================================================
RCS file: /cvs/udk/cppuhelper/inc/cppuhelper/interfacecontainer.h,v
retrieving revision 1.18
diff -u -p -u -r1.18 interfacecontainer.h
--- cppuhelper/inc/cppuhelper/interfacecontainer.h	21 Dec 2005 13:19:23 -0000	1.18
+++ cppuhelper/inc/cppuhelper/interfacecontainer.h	20 Dec 2006 16:08:07 -0000
@@ -35,8 +35,7 @@
 #ifndef _CPPUHELPER_INTERFACECONTAINER_H_
 #define _CPPUHELPER_INTERFACECONTAINER_H_
 
-#include <hash_map>
-#include <functional>
+#include <vector>
 
 #ifndef _OSL_MUTEX_HXX_
 #include <osl/mutex.hxx>
@@ -406,9 +405,25 @@ public:
 
 	typedef key keyType;
 private:
-	::std::hash_map< key , void* , hashImpl , equalImpl > *m_pMap;
+    typedef ::std::vector< std::pair < key , void* > > InterfaceMap;
+    InterfaceMap *m_pMap;
 	::osl::Mutex &	rMutex;
 
+    inline typename InterfaceMap::iterator find(const key &rKey) const
+    {
+        typename InterfaceMap::iterator iter = m_pMap->begin();
+        typename InterfaceMap::iterator end = m_pMap->end();
+
+    	while( iter != end )
+        {
+            equalImpl equal;
+            if( equal( iter->first, rKey ) )
+                break;
+            iter++;
+        }
+        return iter;
+    }
+    
 	inline OMultiTypeInterfaceContainerHelperVar( const OMultiTypeInterfaceContainerHelperVar & ) SAL_THROW( () );
 	inline OMultiTypeInterfaceContainerHelperVar & operator = ( const OMultiTypeInterfaceContainerHelperVar & ) SAL_THROW( () );
 };
Index: cppuhelper/inc/cppuhelper/interfacecontainer.hxx
===================================================================
RCS file: /cvs/udk/cppuhelper/inc/cppuhelper/interfacecontainer.hxx,v
retrieving revision 1.6
diff -u -p -u -r1.6 interfacecontainer.hxx
--- cppuhelper/inc/cppuhelper/interfacecontainer.hxx	19 Jun 2006 10:31:01 -0000	1.6
+++ cppuhelper/inc/cppuhelper/interfacecontainer.hxx	20 Dec 2006 16:08:07 -0000
@@ -38,8 +38,6 @@
 #include <cppuhelper/interfacecontainer.h>
 
 
-#define CONT_HASHMAP ::std::hash_map< key , void* , hashImpl , equalImpl >
-
 namespace cppu
 {     
 
@@ -48,7 +46,7 @@ inline OMultiTypeInterfaceContainerHelpe
 	SAL_THROW( () )
 	: rMutex( rMutex_ )
 {
-	m_pMap = new CONT_HASHMAP;
+	m_pMap = new InterfaceMap;
 }
 
 //===================================================================
@@ -56,8 +54,8 @@ template< class key , class hashImpl , c
 inline OMultiTypeInterfaceContainerHelperVar< key , hashImpl , equalImpl >::~OMultiTypeInterfaceContainerHelperVar()
 	SAL_THROW( () )
 {
-	typename CONT_HASHMAP::iterator iter = m_pMap->begin();
-	typename CONT_HASHMAP::iterator end = m_pMap->end();
+	typename InterfaceMap::iterator iter = m_pMap->begin();
+	typename InterfaceMap::iterator end = m_pMap->end();
 
 	while( iter != end )
 	{
@@ -74,14 +72,14 @@ inline ::com::sun::star::uno::Sequence< 
 	SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
-	typename CONT_HASHMAP::size_type nSize = m_pMap->size();
+	typename InterfaceMap::size_type nSize = m_pMap->size();
 	if( nSize != 0 )
 	{
 		::com::sun::star::uno::Sequence< key > aInterfaceTypes( nSize );
 		key * pArray = aInterfaceTypes.getArray();
 
-		typename CONT_HASHMAP::iterator iter = m_pMap->begin();
-		typename CONT_HASHMAP::iterator end = m_pMap->end();
+		typename InterfaceMap::iterator iter = m_pMap->begin();
+		typename InterfaceMap::iterator end = m_pMap->end();
 
 		sal_uInt32 i = 0;
 		while( iter != end )
@@ -108,7 +106,7 @@ OInterfaceContainerHelper * OMultiTypeIn
 {
 	::osl::MutexGuard aGuard( rMutex );
 
- 	typename CONT_HASHMAP::iterator iter = m_pMap->find( rKey );
+ 	typename InterfaceMap::iterator iter = find( rKey );
 	if( iter != m_pMap->end() )
 			return (OInterfaceContainerHelper*) (*iter).second;
 	return 0;
@@ -122,11 +120,11 @@ sal_Int32 OMultiTypeInterfaceContainerHe
 	SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
-	typename CONT_HASHMAP::iterator iter = m_pMap->find( rKey );
+	typename InterfaceMap::iterator iter = find( rKey );
 	if( iter == m_pMap->end() )
 	{
 		OInterfaceContainerHelper * pLC = new OInterfaceContainerHelper( rMutex );
-		(*m_pMap)[rKey] = pLC;
+        m_pMap->push_back(std::pair<key, void*>(rKey, pLC));
 		return pLC->addInterface( rListener );
 	}
 	else
@@ -143,7 +141,7 @@ inline sal_Int32 OMultiTypeInterfaceCont
 	::osl::MutexGuard aGuard( rMutex );
 
 	// search container with id nUik
-	typename CONT_HASHMAP::iterator iter = m_pMap->find( rKey );
+	typename InterfaceMap::iterator iter = find( rKey );
     // container found?
 	if( iter != m_pMap->end() )
         return ((OInterfaceContainerHelper*)(*iter).second)->removeInterface( rListener );
@@ -158,7 +156,7 @@ void OMultiTypeInterfaceContainerHelperV
 	const ::com::sun::star::lang::EventObject & rEvt )
 	SAL_THROW( () )
 {
-	typename CONT_HASHMAP::size_type nSize = 0;
+	typename InterfaceMap::size_type nSize = 0;
 	OInterfaceContainerHelper ** ppListenerContainers = NULL;
 	{
 		::osl::MutexGuard aGuard( rMutex );
@@ -169,10 +167,10 @@ void OMultiTypeInterfaceContainerHelperV
 			ppListenerContainers = new ppp[nSize];
 			//ppListenerContainers = new (ListenerContainer*)[nSize];
 	
-			typename CONT_HASHMAP::iterator iter = m_pMap->begin();
-			typename CONT_HASHMAP::iterator end = m_pMap->end();
+			typename InterfaceMap::iterator iter = m_pMap->begin();
+			typename InterfaceMap::iterator end = m_pMap->end();
 	
-			typename CONT_HASHMAP::size_type i = 0;
+			typename InterfaceMap::size_type i = 0;
 			while( iter != end )
 			{
 				ppListenerContainers[i++] = (OInterfaceContainerHelper*)(*iter).second;
@@ -182,7 +180,7 @@ void OMultiTypeInterfaceContainerHelperV
 	}
 
 	// create a copy, because do not fire event in a guarded section
-	for( typename CONT_HASHMAP::size_type i = 0; i < nSize; i++ )
+	for( typename InterfaceMap::size_type i = 0; i < nSize; i++ )
 	{
 		if( ppListenerContainers[i] )
 			ppListenerContainers[i]->disposeAndClear( rEvt );
@@ -196,8 +194,8 @@ template< class key , class hashImpl , c
 void OMultiTypeInterfaceContainerHelperVar< key , hashImpl , equalImpl >::clear() SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
-	typename CONT_HASHMAP::iterator iter = m_pMap->begin();
-	typename CONT_HASHMAP::iterator end = m_pMap->end();
+	typename InterfaceMap::iterator iter = m_pMap->begin();
+	typename InterfaceMap::iterator end = m_pMap->end();
 
 	while( iter != end )
 	{
Index: cppuhelper/source/interfacecontainer.cxx
===================================================================
RCS file: /cvs/udk/cppuhelper/source/interfacecontainer.cxx,v
retrieving revision 1.16
diff -u -p -u -r1.16 interfacecontainer.cxx
--- cppuhelper/source/interfacecontainer.cxx	16 Sep 2006 12:41:22 -0000	1.16
+++ cppuhelper/source/interfacecontainer.cxx	20 Dec 2006 16:08:07 -0000
@@ -389,7 +390,7 @@ void OInterfaceContainerHelper::clear() 
 
 // specialized class for type
 
-typedef ::std::hash_map< Type , void* , hashType_Impl , ::std::equal_to< Type > > t_type2ptr;
+typedef ::std::vector< std::pair < Type , void* > > t_type2ptr;
 
 OMultiTypeInterfaceContainerHelper::OMultiTypeInterfaceContainerHelper( Mutex & rMutex_ )
     SAL_THROW( () )
@@ -445,13 +446,28 @@ Sequence< Type > OMultiTypeInterfaceCont
 	}
 	return ::com::sun::star::uno::Sequence< Type >();
 }
+
+static t_type2ptr::iterator findType(t_type2ptr *pMap, const Type & rKey )
+{
+	t_type2ptr::iterator iter = pMap->begin();
+	t_type2ptr::iterator end = pMap->end();
+
+	while( iter != end )
+    {
+        if (iter->first == rKey)
+            break;
+        iter++;
+    }
+    return iter;
+}
+
 OInterfaceContainerHelper * OMultiTypeInterfaceContainerHelper::getContainer( const Type & rKey ) const
     SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
 
     t_type2ptr * pMap = (t_type2ptr *)m_pMap;
- 	t_type2ptr::iterator iter = pMap->find( rKey );
+ 	t_type2ptr::iterator iter = findType( pMap, rKey );
 	if( iter != pMap->end() )
 			return (OInterfaceContainerHelper*) (*iter).second;
 	return 0;
@@ -462,11 +478,11 @@ sal_Int32 OMultiTypeInterfaceContainerHe
 {
 	::osl::MutexGuard aGuard( rMutex );
     t_type2ptr * pMap = (t_type2ptr *)m_pMap;
-	t_type2ptr::iterator iter = pMap->find( rKey );
+	t_type2ptr::iterator iter = findType( pMap, rKey );
 	if( iter == pMap->end() )
 	{
 		OInterfaceContainerHelper * pLC = new OInterfaceContainerHelper( rMutex );
-		(*pMap)[rKey] = pLC;
+        pMap->push_back(std::pair<Type, void*>(rKey, pLC));
 		return pLC->addInterface( rListener );
 	}
 	else
@@ -480,7 +496,7 @@ sal_Int32 OMultiTypeInterfaceContainerHe
 
 	// search container with id nUik
     t_type2ptr * pMap = (t_type2ptr *)m_pMap;
-	t_type2ptr::iterator iter = pMap->find( rKey );
+	t_type2ptr::iterator iter = findType( pMap, rKey );
 		// container found?
 	if( iter != pMap->end() )
         return ((OInterfaceContainerHelper*)(*iter).second)->removeInterface( rListener );
@@ -547,17 +563,35 @@ void OMultiTypeInterfaceContainerHelper:
 
 // specialized class for long
 
-typedef ::std::hash_map< sal_Int32 , void* , hashInt32_Impl , equalInt32_Impl > t_long2ptr;
+typedef ::std::vector< std::pair < sal_Int32 , void* > > t_long2ptr;
+
+static t_long2ptr::iterator findLong(t_long2ptr *pMap, sal_Int32 nKey )
+{
+	t_long2ptr::iterator iter = pMap->begin();
+	t_long2ptr::iterator end = pMap->end();
+
+	while( iter != end )
+    {
+        if (iter->first == nKey)
+            break;
+        iter++;
+    }
+    return iter;
+}
 
 OMultiTypeInterfaceContainerHelperInt32::OMultiTypeInterfaceContainerHelperInt32( Mutex & rMutex_ )
     SAL_THROW( () )
-    : rMutex( rMutex_ )
+    : m_pMap( NULL )
+    , rMutex( rMutex_ )
 {
-	m_pMap = new t_long2ptr();
+    // delay pMap allocation until necessary.
 }
 OMultiTypeInterfaceContainerHelperInt32::~OMultiTypeInterfaceContainerHelperInt32()
     SAL_THROW( () )
 {
+    if (!m_pMap)
+        return;
+
     t_long2ptr * pMap = (t_long2ptr *)m_pMap;
 	t_long2ptr::iterator iter = pMap->begin();
 	t_long2ptr::iterator end = pMap->end();
@@ -577,7 +611,7 @@ Sequence< sal_Int32 > OMultiTypeInterfac
 	t_long2ptr::size_type nSize;
 
 	::osl::MutexGuard aGuard( rMutex );
-	nSize = pMap->size();
+	nSize = pMap ? pMap->size() : 0;
 	if( nSize )
 	{
 		::com::sun::star::uno::Sequence< sal_Int32 > aInterfaceTypes( nSize );
@@ -608,8 +642,10 @@ OInterfaceContainerHelper * OMultiTypeIn
 {
 	::osl::MutexGuard aGuard( rMutex );
 
+    if (!m_pMap)
+        return 0;
     t_long2ptr * pMap = (t_long2ptr *)m_pMap;
- 	t_long2ptr::iterator iter = pMap->find( rKey );
+ 	t_long2ptr::iterator iter = findLong( pMap, rKey );
 	if( iter != pMap->end() )
 			return (OInterfaceContainerHelper*) (*iter).second;
 	return 0;
@@ -619,12 +655,14 @@ sal_Int32 OMultiTypeInterfaceContainerHe
     SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
+    if (!m_pMap)
+    	m_pMap = new t_long2ptr();
     t_long2ptr * pMap = (t_long2ptr *)m_pMap;
-	t_long2ptr::iterator iter = pMap->find( rKey );
-	if( iter == pMap->end() )
+	t_long2ptr::iterator iter = findLong( pMap, rKey );
+ 	if( iter == pMap->end() )
 	{
 		OInterfaceContainerHelper * pLC = new OInterfaceContainerHelper( rMutex );
-		(*pMap)[rKey] = pLC;
+        pMap->push_back(std::pair< sal_Int32, void* >(rKey, pLC));
 		return pLC->addInterface( rListener );
 	}
 	else
@@ -636,9 +674,11 @@ sal_Int32 OMultiTypeInterfaceContainerHe
 {
 	::osl::MutexGuard aGuard( rMutex );
 
+    if (!m_pMap)
+        return 0;
 	// search container with id nUik
     t_long2ptr * pMap = (t_long2ptr *)m_pMap;
-	t_long2ptr::iterator iter = pMap->find( rKey );
+	t_long2ptr::iterator iter = findLong( pMap, rKey );
 		// container found?
 	if( iter != pMap->end() )
         return ((OInterfaceContainerHelper*)(*iter).second)->removeInterface( rListener );
@@ -653,6 +693,9 @@ void OMultiTypeInterfaceContainerHelperI
 	OInterfaceContainerHelper ** ppListenerContainers = NULL;
 	{
 		::osl::MutexGuard aGuard( rMutex );
+        if (!m_pMap)
+            return;
+
         t_long2ptr * pMap = (t_long2ptr *)m_pMap;
 		nSize = pMap->size();
 		if( nSize )
@@ -687,6 +730,8 @@ void OMultiTypeInterfaceContainerHelperI
     SAL_THROW( () )
 {
 	::osl::MutexGuard aGuard( rMutex );
+    if (!m_pMap)
+        return;
     t_long2ptr * pMap = (t_long2ptr *)m_pMap;
 	t_long2ptr::iterator iter = pMap->begin();
 	t_long2ptr::iterator end = pMap->end();

--- vcl/source/helper/canvastools.cxx   17 Sep 2006 12:13:47 -0000      1.9
+++ vcl/source/helper/canvastools.cxx   20 Dec 2006 17:45:32 -0000
@@ -115,6 +115,7 @@
 
 #include <canvasbitmap.hxx>
 #include <canvastools.hxx>
+#include <hash_map>
 
 
 using namespace ::com::sun::star;
Index: toolkit/inc/toolkit/controls/eventcontainer.hxx
===================================================================
RCS file: /cvs/gsl/toolkit/inc/toolkit/controls/eventcontainer.hxx,v
retrieving revision 1.5
diff -u -p -u -r1.5 eventcontainer.hxx
--- toolkit/inc/toolkit/controls/eventcontainer.hxx	19 Jun 2006 22:56:00 -0000	1.5
+++ toolkit/inc/toolkit/controls/eventcontainer.hxx	21 Dec 2006 09:41:54 -0000
@@ -44,6 +44,7 @@
 
 #include <toolkit/helper/listenermultiplexer.hxx>
 
+#include <hash_map>
 #include <cppuhelper/implbase2.hxx>
 typedef ::cppu::WeakImplHelper2< ::com::sun::star::container::XNameContainer,
 								 ::com::sun::star::container::XContainer > NameContainerHelper;
Index: framework/inc/stdtypes.h
===================================================================
RCS file: /cvs/framework/framework/inc/stdtypes.h,v
retrieving revision 1.8
diff -u -p -u -r1.8 stdtypes.h
--- framework/inc/stdtypes.h	9 Sep 2005 00:00:37 -0000	1.8
+++ framework/inc/stdtypes.h	21 Dec 2006 10:47:13 -0000
@@ -38,6 +38,7 @@
 
 #include <vector>
 #include <queue>
+#include <hash_map>
 
 //_________________________________________________________________________________________________________________
 // own includes
Index: sfx2/source/appl/imagemgr.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/imagemgr.cxx,v
retrieving revision 1.17
diff -u -p -u -r1.17 imagemgr.cxx
--- sfx2/source/appl/imagemgr.cxx	17 Sep 2006 16:18:03 -0000	1.17
+++ sfx2/source/appl/imagemgr.cxx	21 Dec 2006 10:56:31 -0000
@@ -75,6 +75,8 @@
 #include "objsh.hxx"
 #include "docfac.hxx"
 
+#include <hash_map>
+
 using namespace ::com::sun::star::uno;
 using namespace ::com::sun::star::frame;
 using namespace ::com::sun::star::lang;
Index: sfx2/source/view/sfxbasecontroller.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/view/sfxbasecontroller.cxx,v
retrieving revision 1.68
diff -u -p -u -r1.68 sfxbasecontroller.cxx
--- sfx2/source/view/sfxbasecontroller.cxx	12 Oct 2006 15:59:29 -0000	1.68
+++ sfx2/source/view/sfxbasecontroller.cxx	21 Dec 2006 11:03:30 -0000
@@ -167,6 +167,8 @@
 #include <rtl/ustrbuf.hxx>
 #include <toolkit/helper/convert.hxx>
 
+#include <hash_map>
+
 #include "event.hxx"
 
 #define	OMULTITYPEINTERFACECONTAINERHELPER		::cppu::OMultiTypeInterfaceContainerHelper
Index: extensions/source/bibliography/framectr.cxx
===================================================================
RCS file: /cvs/util/extensions/source/bibliography/framectr.cxx,v
retrieving revision 1.32
diff -u -p -u -r1.32 framectr.cxx
--- extensions/source/bibliography/framectr.cxx	16 Sep 2006 12:56:16 -0000	1.32
+++ extensions/source/bibliography/framectr.cxx	21 Dec 2006 11:42:45 -0000
@@ -132,6 +132,8 @@
 #include <vos/mutex.hxx>
 #endif
 
+#include <hash_map>
+
 using namespace osl;
 using namespace cppu;
 using namespace rtl;
