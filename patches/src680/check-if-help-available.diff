Index: source/appl/newhelp.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/newhelp.cxx,v
retrieving revision 1.110
retrieving revision 1.110.50.1
diff -u -u -r1.110 -r1.110.50.1
--- sfx2/source/appl/newhelp.cxx	1 Apr 2005 16:15:47 -0000	1.110
+++ sfx2/source/appl/newhelp.cxx	3 Jun 2005 08:26:13 -0000	1.110.50.1
@@ -1710,7 +1710,9 @@
 	pCPage				( NULL ),
 	pIPage				( NULL ),
 	pSPage				( NULL ),
-	pBPage				( NULL )
+    pBPage              ( NULL ),
+
+    bIsInitDone         ( false )
 
 {
 	FreeResource();
@@ -1784,7 +1786,7 @@
 void SfxHelpIndexWindow_Impl::SetActiveFactory()
 {
 	DBG_ASSERT( pIPage, "index page not initialized" );
-    if ( !aActiveLB.GetEntryCount() )
+    if ( !bIsInitDone && !aActiveLB.GetEntryCount() )
     {
         aTimer.Stop();
         InitHdl( NULL );
@@ -1867,6 +1869,7 @@
 
 IMPL_LINK( SfxHelpIndexWindow_Impl, InitHdl, Timer *, EMPTYARG )
 {
+    bIsInitDone = true;
 	Initialize();
 
 	// now use the timer for selection
Index: source/appl/newhelp.hxx
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/newhelp.hxx,v
retrieving revision 1.54
retrieving revision 1.54.66.1
diff -u -u -r1.54 -r1.54.66.1
--- sfx2/source/appl/newhelp.hxx	15 Mar 2005 13:05:00 -0000	1.54
+++ sfx2/source/appl/newhelp.hxx	3 Jun 2005 08:25:07 -0000	1.54.66.1
@@ -370,6 +370,7 @@
 
 	long				nMinWidth;
 	bool				bWasCursorLeftOrRight;
+    bool                bIsInitDone;
 
 	void				Initialize();
     void                SetActiveFactory();
Index: source/appl/sfxhelp.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/sfxhelp.cxx,v
retrieving revision 1.63
retrieving revision 1.63.34.1
diff -u -u -r1.63 -r1.63.34.1
--- sfx2/source/appl/sfxhelp.cxx	13 Apr 2005 12:37:46 -0000	1.63
+++ sfx2/source/appl/sfxhelp.cxx	3 Jun 2005 08:19:26 -0000	1.63.34.1
@@ -136,6 +136,9 @@
 #include <rtl/ustring.hxx>
 #include <osl/process.h>
 #include <rtl/uri.hxx>
+#include <vcl/msgbox.hxx>
+#include <svtools/ehdl.hxx>
+#include <svtools/sfxecode.hxx>
 
 #define _SVSTDARR_STRINGSDTOR
 #define _SVSTDARR_ULONGSSORT
@@ -761,7 +764,20 @@
 
 BOOL SfxHelp::Start( const String& rURL, const Window* pWindow )
 {
-    // check if its an URL or a jump mark!
+    // check if help is available
+    String aHelpRootURL( DEFINE_CONST_OUSTRING("vnd.sun.star.help://") );
+    AppendConfigToken_Impl( aHelpRootURL, sal_True );
+    Sequence< ::rtl::OUString > aFactories = SfxContentHelper::GetResultSet( aHelpRootURL );
+    if ( 0 == aFactories.getLength() )
+    {
+        // no factories -> no help -> error message and return
+        ErrorBox aErrBox(   const_cast< Window* >( pWindow ),
+                            WB_OK, String( SfxResId( RID_STR_HLPAPPNOTSTARTED ) ) );
+        aErrBox.Execute();
+        return FALSE;
+    }
+
+    // check if it's an URL or a jump mark!
 	String          aHelpURL(rURL    );
 	INetURLObject   aParser (aHelpURL);
 	::rtl::OUString sKeyword;
@@ -785,7 +801,7 @@
     // to the internal sub frame, which shows the help content.
 
     // Note further: We search for this sub frame here directly instead of
-    // the real top level help task ... Its needed to have the same
+    // the real top level help task ... It's needed to have the same
     // sub frame available - so we can use it for loading (which is done
     // in both cases)!
 
