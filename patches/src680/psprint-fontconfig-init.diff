Index: psprint/source/fontmanager/fontconfig.cxx
===================================================================
RCS file: /cvs/gsl/psprint/source/fontmanager/fontconfig.cxx,v
retrieving revision 1.7
diff -u -r1.7 fontconfig.cxx
--- psprint/source/fontmanager/fontconfig.cxx	13 Oct 2004 08:22:03 -0000	1.7
+++ psprint/source/fontmanager/fontconfig.cxx	21 Jun 2005 10:28:17 -0000
@@ -107,7 +107,8 @@
     void*			m_pLib;
     FcConfig*		m_pDefConfig;
 
-    FcConfig*		(*m_pFcInitLoadConfigAndFonts)();
+	FcBool          (*m_pFcInit)();
+    FcConfig*		(*m_pFcConfigGetCurrent)();
     FcObjectSet*	(*m_pFcObjectSetVaBuild)(const char*,va_list);
     void			(*m_pFcObjectSetDestroy)(FcObjectSet* pSet);
     FcPattern*		(*m_pFcPatternCreate)();
@@ -142,7 +143,11 @@
 
 
     FcConfig* FcInitLoadConfigAndFonts()
-    { return m_pFcInitLoadConfigAndFonts(); }
+    {
+		if( !m_pFcInit() )
+			return NULL;
+		return m_pFcConfigGetCurrent();
+	}
 
     FcObjectSet* FcObjectSetBuild( const char* first, ... )
     {
@@ -227,8 +232,10 @@
         return;
     }
 
-    m_pFcInitLoadConfigAndFonts = (FcConfig*(*)())
-        loadSymbol( "FcInitLoadConfigAndFonts" );
+    m_pFcInit = (FcBool(*)())
+        loadSymbol( "FcInit" );
+    m_pFcConfigGetCurrent = (FcConfig *(*)())
+        loadSymbol( "FcConfigGetCurrent" );
     m_pFcObjectSetVaBuild = (FcObjectSet*(*)(const char*,va_list))
         loadSymbol( "FcObjectSetVaBuild" );
     m_pFcObjectSetDestroy = (void(*)(FcObjectSet*))
@@ -265,7 +272,8 @@
         loadSymbol( "FcPatternAddString" );
 
     if( ! (
-            m_pFcInitLoadConfigAndFonts		&&
+            m_pFcInit						&&
+            m_pFcConfigGetCurrent			&&
             m_pFcObjectSetVaBuild			&&
             m_pFcObjectSetDestroy			&&
             m_pFcPatternCreate				&&
