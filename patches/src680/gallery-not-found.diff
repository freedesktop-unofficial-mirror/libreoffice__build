--- svx/source/gallery2/gallery1.cxx.orig	2006-01-06 21:04:31.000000000 +0100
+++ svx/source/gallery2/gallery1.cxx	2006-01-09 20:04:52.000000000 +0100
@@ -396,7 +396,8 @@
 
 			if( xContentAccess.is() )
 			{
-				while( xResultSet->next() )
+				xResultSet->first();
+				do
 				{
 					INetURLObject aThmURL( xContentAccess->queryContentIdentifierString() );
 					
@@ -519,6 +520,7 @@
 	                    }
 					}
 				}
+				while( xResultSet->next() );
 			}
 		}
 	}
@@ -695,10 +697,14 @@
 
 	if( !HasTheme( rThemeName ) && ( GetUserURL().GetProtocol() != INET_PROT_NOT_VALID ) )
 	{
-		nLastFileNumber=nNumFrom > nLastFileNumber ? nNumFrom : ++nLastFileNumber;
+		if (nNumFrom > nLastFileNumber)
+			nLastFileNumber=nNumFrom;
+		else
+			nLastFileNumber++;
+		    
 		GalleryThemeEntry* pNewEntry = new GalleryThemeEntry( GetUserURL(), rThemeName,
-															  nLastFileNumber,
-															  FALSE, FALSE, TRUE, 0, FALSE );
+								      nLastFileNumber,
+								      FALSE, FALSE, TRUE, 0, FALSE );
 
 		aThemeList.Insert( pNewEntry, LIST_APPEND );
 		delete( new GalleryTheme( this, pNewEntry ) );
