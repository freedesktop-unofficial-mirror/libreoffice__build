--- config_office/configure.in.before	2008-04-28 10:31:26.000000000 +0200
+++ config_office/configure.in	2008-04-28 10:32:01.000000000 +0200
@@ -274,6 +274,9 @@
 AC_ARG_ENABLE(xrender-link,
 [  --enable-xrender-link   link with libXrender instead of dynamically open it
 ],,)
+AC_ARG_ENABLE(randr,
+[  --disable-randr          disable RandR support in the vcl project
+],,enable_randr=yes)
 AC_ARG_WITH(myspell-dicts,
 [  --without-myspell-dicts Removes myspell dictionaries from openoffice.org
                           installation set, for people building for specific
@@ -838,6 +841,7 @@
 		build_gstreamer=yes
 		test_kde=yes
 		test_cups=yes
+        test_randr=yes
 		_os=SunOS
 
 		dnl ===========================================================
@@ -865,6 +869,7 @@
 		build_gstreamer=yes
 		test_kde=yes
 		test_cups=yes
+        test_randr=yes
 		if getconf GNU_LIBPTHREAD_VERSION |grep -q NPTL; then
 			PTHREAD_CFLAGS="-DNPTL"
 		fi
@@ -884,6 +889,7 @@
 		test_gtk=yes
 		build_cairo=no
 		build_gstreamer=no
+        test_randr=no
 		_os=Darwin
       if test "$enable_systray" = "yes" && test "$enable_gtk" != "no"; then
          AC_MSG_WARN([Disabling gtk-quickstarter - not supported on Mac. Use --disable-systray])
@@ -894,6 +900,7 @@
 	os2*)
 		test_x=no
 		test_cups=no
+        test_randr=no
 		test_gtk=no
 		_os=OS2
 		;;
@@ -903,6 +910,7 @@
 		build_gstreamer=yes
 		test_kde=yes
 		test_cups=yes
+        test_randr=yes
 		AC_MSG_CHECKING([the FreeBSD operating system release])
 		if test -n "$with_os_version"; then
 			OSVERSION="$with_os_version"
@@ -926,6 +934,7 @@
 		;;
 	osf)
 		test_cups=no
+        test_randr=no
 		_os=OSF1
 		;;
 	netbsd)
@@ -934,16 +943,19 @@
 		build_gstreamer=yes
 		test_kde=yes
 		test_cups=no
+        test_randr=yes
 		PTHREAD_CFLAGS="-pthread"
 		PTHREAD_LIBS="-pthread -lpthread"
 		_os=NetBSD
 		;;
 	irix*)
 		test_cups=no
+        test_randr=no
 		_os=IRIX
 		;;
 	aix*)
 		test_cups=no
+        test_randr=no
 	   PTHREAD_LIBS=-pthread
 		echo "AIX is an alpha port --- Use at own risk" >> warn
 		_os=AIX
@@ -1123,6 +1135,19 @@
 AC_SUBST(ENABLE_FONTCONFIG)
 
 dnl ===================================================================
+dnl Build options
+dnl ===================================================================
+AC_MSG_CHECKING([whether to enable RandR support])
+if test "$test_randr" = "yes" -a \( "$enable_randr" = "yes" -o "$enable_randr" = "TRUE" \) ; then
+   ENABLE_RANDR="TRUE"
+   AC_MSG_RESULT([yes])
+else
+   ENABLE_RANDR=""
+   AC_MSG_RESULT([no])
+fi
+AC_SUBST(ENABLE_RANDR)
+
+dnl ===================================================================
 dnl Disable legacy binary file formats filters
 dnl ===================================================================
 AC_MSG_CHECKING([whether to enable filters for legacy binary file formats (StarOffice 5.2)])
@@ -1915,7 +1940,15 @@
 fi
 
 dnl ===================================================================
+dnl Check if X11/extensions/Xrandr.h is available 
+dnl ===================================================================
+if test "$test_randr" = "yes" -a "$ENABLE_RANDR" = "TRUE" ; then
+    AC_CHECK_HEADER(X11/extensions/Xrandr.h, [],
+                    [AC_MSG_ERROR([X11/extensions/Xrandr.h could not be found. X11 dev missing?])], [])
+fi
+
+dnl ===================================================================
 dnl Check if PAM/pam_appl.h is available on Linux or FreeBSD
 dnl ===================================================================
 if test "$_os" = "Linux" -o "$_os" = "FreeBSD" -o "$_os" = "GNU"; then

--- config_office/set_soenv.in.old	2008-05-26 12:32:20.000000000 +0200
+++ config_office/set_soenv.in	2008-05-26 13:45:46.000000000 +0200
@@ -1949,6 +1949,7 @@ ToFile( "LFS_CFLAGS",        "@LFS_CFLAG
 ToFile( "ENABLE_CRASHDUMP",  "@ENABLE_CRASHDUMP@",  "e" );
 ToFile( "ENABLE_CUPS",       "@ENABLE_CUPS@",       "e" );
 ToFile( "ENABLE_FONTCONFIG", "@ENABLE_FONTCONFIG@", "e" );
+ToFile( "ENABLE_RANDR",      "@ENABLE_RANDR@",      "e" );
 ToFile( "ENABLE_DIRECTX",    "@ENABLE_DIRECTX@",    "e" );
 ToFile( "ENABLE_LAYOUT",     "@ENABLE_LAYOUT@",     "e" );
 ToFile( "ENABLE_PCH",        "@ENABLE_PCH@",       "e" );
--- vcl/unx/source/app/saldisp.cxx	29 Jan 2008 16:22:34 -0000	1.93
+++ vcl/unx/source/app/saldisp.cxx	31 Mar 2008 16:44:44 -0000	1.93.16.2
@@ -70,7 +70,7 @@
 
 #ifdef USE_XINERAMA
 #ifdef USE_XINERAMA_XORG
-#if defined(X86) || defined(MACOSX)
+#if defined(X86) || defined(X86_64) || defined(MACOSX)
 #include <X11/extensions/Xinerama.h>
 #endif
 #elif defined USE_XINERAMA_XSUN
@@ -2688,7 +2833,7 @@ void SalDisplay::InitXinerama()
         }
     }
 #elif defined(USE_XINERAMA_XORG)
-#if defined( X86 ) || defined( MACOSX )
+#if defined(X86) || defined(X86_64) || defined(MACOSX)
 if( XineramaIsActive( pDisp_ ) )
 {
     int nFramebuffers = 1;
