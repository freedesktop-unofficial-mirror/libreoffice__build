Index: vcl/source/gdi/image.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/gdi/image.cxx,v
retrieving revision 1.19
diff -u -r1.19 image.cxx
--- vcl/source/gdi/image.cxx	3 Jan 2005 17:41:23 -0000	1.19
+++ vcl/source/gdi/image.cxx	28 Jan 2005 12:52:24 -0000
@@ -573,7 +573,10 @@
 					if( !bInit )
 					{
 						aItemSizePixel = aWorkSizePixel;
-						aBmpEx = Bitmap( Size( aWorkSizePixel.Width() * nCount, aWorkSizePixel.Height() ), 24 ); 
+						Size aTotalSize( aWorkSizePixel.Width() * nCount, aWorkSizePixel.Height() );
+						BYTE nTransparent = 255;
+						aBmpEx = BitmapEx( Bitmap( aTotalSize, 24 ),
+										   AlphaMask( aTotalSize, &nTransparent ) );
 						bInit = true;
 					}
 					
@@ -596,8 +599,12 @@
                     }
 #endif
 					
-					const Rectangle aRectDst( Point( aItemSizePixel.Width() * i, 0 ), aItemSizePixel );
+					Rectangle aRectDst( Point( aItemSizePixel.Width() * i, 0 ), aItemSizePixel );
 					const Rectangle aRectSrc( Point( 0, 0 ), aWorkSizePixel );
+
+					if( aItemSizePixel != aWorkSizePixel )
+						aRectDst.Move( aItemSizePixel.Width() - aWorkSizePixel.Width(),
+									   aItemSizePixel.Height() - aWorkSizePixel.Height() );
 					
 					aBmpEx.CopyPixel( aRectDst, aRectSrc, &aWorkBmpEx );			
 				}
@@ -666,7 +673,10 @@
 				if( !bInit )
 				{
 					aItemSizePixel = aWorkSizePixel;
-					aBmpEx = Bitmap( Size( aWorkSizePixel.Width() * rNameVector.size(), aWorkSizePixel.Height() ), 24 ); 
+					Size aTotalSize( aWorkSizePixel.Width() * rNameVector.size(), aWorkSizePixel.Height() );
+					BYTE nTransparent = 255;
+					aBmpEx = BitmapEx( Bitmap( aTotalSize, 24 ),
+									   AlphaMask( aTotalSize, &nTransparent ) );
 					bInit = true;
 				}
 	
@@ -689,8 +699,12 @@
 				}
 #endif
 			
-				const Rectangle aRectDst( Point( aItemSizePixel.Width() * i, 0 ), aItemSizePixel );
+				Rectangle aRectDst( Point( aItemSizePixel.Width() * i, 0 ), aItemSizePixel );
 				const Rectangle aRectSrc( Point( 0, 0 ), aWorkSizePixel );
+
+				if( aItemSizePixel != aWorkSizePixel )
+					aRectDst.Move( aItemSizePixel.Width() - aWorkSizePixel.Width(),
+								   aItemSizePixel.Height() - aWorkSizePixel.Height() );
 				
 				aBmpEx.CopyPixel( aRectDst, aRectSrc, &aWorkBmpEx );			
 			}
