Index: configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.216.2.6
diff -u -u -r1.216.2.6 configure.in
--- config_office/configure.in	2 Nov 2007 08:25:07 -0000	1.216.2.6
+++ config_office/configure.in	10 Dec 2007 00:48:43 -0000
@@ -315,6 +315,52 @@
 [  --with-beanshell-jar=JARFILE   Specify path to jarfile manually ],
 [ BSH_JAR="$withval"
 ])
+AC_ARG_ENABLE(reportdesign,
+[  --disable-reportdesign  disables the build of the Report Builder extension
+],,)
+AC_ARG_WITH(system-jfreereport,
+[  --with-system-jfreereport      Use JFreeReport already on system
+],,)
+AC_ARG_WITH(jcommon-jar,
+[  --with-jcommon-jar=JARFILE   Specify path to jarfile manually ],
+[ JCOMMON_JAR="$withval"
+])
+AC_ARG_WITH(sac-jar,
+[  --with-sac-jar=JARFILE   Specify path to jarfile manually ],
+[ SAC_JAR="$withval"
+])
+AC_ARG_WITH(libxml-jar,
+[  --with-libxml-jar=JARFILE   Specify path to jarfile manually ],
+[ LIBXML_JAR="$withval"
+])
+AC_ARG_WITH(flute-jar,
+[  --with-flute-jar=JARFILE   Specify path to jarfile manually ],
+[ FLUTE_JAR="$withval"
+])
+AC_ARG_WITH(jfreereport-jar,
+[  --with-jfreereport-jar=JARFILE   Specify path to jarfile manually ],
+[ JFREEREPORT_JAR="$withval"
+])
+AC_ARG_WITH(liblayout-jar,
+[  --with-liblayout-jar=JARFILE   Specify path to jarfile manually ],
+[ LIBLAYOUT_JAR="$withval"
+])
+AC_ARG_WITH(libformula-jar,
+[  --with-libformula-jar=JARFILE   Specify path to jarfile manually ],
+[ LIBFORMULA_JAR="$withval"
+])
+AC_ARG_WITH(librepository-jar,
+[  --with-librepository-jar=JARFILE   Specify path to jarfile manually ],
+[ LIBREPOSITORY_JAR="$withval"
+])
+AC_ARG_WITH(libfonts-java-jar,
+[  --with-libfonts-jar=JARFILE   Specify path to jarfile manually ],
+[ LIBFONTS_JAR="$withval"
+])
+AC_ARG_WITH(jcommon-serializer-jar,
+[  --with-jcommon-serializer-jar=JARFILE   Specify path to jarfile manually ],
+[ JCOMMON_SERIALIZER_JAR="$withval"
+])
 AC_ARG_WITH(system-xml-apis,
 [  --with-system-xml-apis  Use xml-apis already on system
 ],,)
@@ -4782,6 +4828,94 @@
 AC_SUBST(CAIRO_CFLAGS)
 AC_SUBST(CAIRO_LIBS)
 
+AC_MSG_CHECKING([whether to build the Report Builder extension])
+if test -z "$enable_reportdesign" -a "$enable_reportdesign" != "no" && test "$WITH_JAVA" != "no"; then
+  AC_MSG_RESULT([yes])
+  ENABLE_REPORTDESIGN=YES
+  AC_MSG_CHECKING([which jfreereport libs to use])
+  if test "$with_system_jfreereport" == "yes"; then
+       SYSTEM_JFREEREPORT=YES
+       AC_MSG_RESULT([external])
+        if test -z $JCOMMON_JAR; then
+               JCOMMON_JAR=/usr/share/java/jcommon-1.0.10.jar
+        fi
+        AC_CHECK_FILE($JCOMMON_JAR, [],
+               [AC_MSG_ERROR(jcommon.jar not found.)], [])
+        if test -z $SAC_JAR; then
+               SAC_JAR=/usr/share/java/sac.jar
+        fi
+        AC_CHECK_FILE($SAC_JAR, [],
+               [AC_MSG_ERROR(sac.jar not found.)], [])
+        if test -z $LIBXML_JAR; then
+               LIBXML_JAR=/usr/share/java/libxml-0.9.5.jar
+        fi
+        AC_CHECK_FILE($LIBXML_JAR, [],
+               [AC_MSG_ERROR(libxml.jar not found.)], [])
+        if test -z $FLUTE_JAR; then
+               FLUTE_JAR=/usr/share/java/flute-1.3-jfree-20061107.jar
+        fi
+        AC_CHECK_FILE($FLUTE_JAR, [],
+               [AC_MSG_ERROR(flute-1.3-jfree.jar not found.)], [])
+        if test -z $JFREEREPORT_JAR; then
+               JFREEREPORT_JAR=/usr/share/java/jfreereport-0.9.0-05.jar
+        fi
+        AC_CHECK_FILE($JFREEREPORT_JAR, [],
+               [AC_MSG_ERROR(jfreereport.jar not found.)], [])
+        if test -z $LIBLAYOUT_JAR; then
+               LIBLAYOUT_JAR=/usr/share/java/liblayout-0.2.6.jar
+        fi
+        AC_CHECK_FILE($LIBLAYOUT_JAR, [],
+               [AC_MSG_ERROR(liblayout.jar not found.)], [])
+        if test -z $LIBLOADER_JAR; then
+               LIBLOADER_JAR=/usr/share/java/libloader-0.3.4.jar
+        fi
+        AC_CHECK_FILE($LIBLOADER_JAR, [],
+               [AC_MSG_ERROR(libloader.jar not found.)], [])
+        if test -z $LIBFORMULA_JAR; then
+               LIBFORMULA_JAR=/usr/share/java/libformula-0.1.8.jar
+        fi
+        AC_CHECK_FILE($LIBFORMULA_JAR, [],
+               [AC_MSG_ERROR(libformula.jar not found.)], [])
+        if test -z $LIBREPOSITORY_JAR; then
+               LIBREPOSITORY_JAR=/usr/share/java/librepository-0.1.1.jar
+        fi
+        AC_CHECK_FILE($LIBREPOSITORY_JAR, [],
+               [AC_MSG_ERROR(librepository.jar not found.)], [])
+        if test -z $LIBFONTS_JAR; then
+               LIBFONTS_JAR=/usr/share/java/libfonts-0.2.6.jar
+        fi
+        AC_CHECK_FILE($LIBFONTS_JAR, [],
+               [AC_MSG_ERROR(libfonts.jar not found.)], [])
+        if test -z $JCOMMON_SERIALIZER_JAR; then
+               JCOMMON_SERIALIZER_JAR=/usr/share/java/jcommon-serializer-0.1.0.jar
+        fi
+        AC_CHECK_FILE($JCOMMON_SERIALIZER_JAR, [],
+               [AC_MSG_ERROR(jcommon-serializer.jar not found.)], [])
+  else
+     AC_MSG_RESULT([internal])
+     SYSTEM_JFREEREPORT=NO
+     BUILD_TYPE="$BUILD_TYPE JFREEREPORT"
+  fi
+  BUILD_TYPE="$BUILD_TYPE REPORTDESIGN"
+else
+  AC_MSG_RESULT([no])
+  ENABLE_REPORTDESIGN=NO
+  SYSTEM_JFREEREPORT=NO
+fi
+AC_SUBST(ENABLE_REPORTDESIGN)
+AC_SUBST(SYSTEM_JFREEREPORT)
+AC_SUBST(JCOMMON_JAR)
+AC_SUBST(SAC_JAR)
+AC_SUBST(LIBXML_JAR)
+AC_SUBST(FLUTE_JAR)
+AC_SUBST(JFREEREPORT_JAR)
+AC_SUBST(LIBLAYOUT_JAR)
+AC_SUBST(LIBLOADER_JAR)
+AC_SUBST(LIBFORMULA_JAR)
+AC_SUBST(LIBREPOSITORY_JAR)
+AC_SUBST(LIBFONTS_JAR)
+AC_SUBST(JCOMMON_SERIALIZER_JAR)
+
 dnl ===================================================================
 dnl Check whether the Qt and KDE libraries are available.
 dnl ===================================================================
Index: set_soenv.in
===================================================================
RCS file: /cvs/tools/config_office/set_soenv.in,v
retrieving revision 1.156.2.1
diff -u -u -r1.156.2.1 set_soenv.in
--- config_office/set_soenv.in	25 Oct 2007 14:02:54 -0000	1.156.2.1
+++ config_office/set_soenv.in	10 Dec 2007 00:48:44 -0000
@@ -1546,6 +1546,19 @@
 ToFile( "ENABLE_SYSTRAY_GTK", "@ENABLE_SYSTRAY_GTK@", "e" );
 ToFile( "ENABLE_STATIC_GTK", "@ENABLE_STATIC_GTK@", "e" );
 ToFile( "ENABLE_CAIRO",      "@ENABLE_CAIRO@",     "e" );
+ToFile( "ENABLE_REPORTDESIGN","@ENABLE_REPORTDESIGN@","e" );
+ToFile( "SYSTEM_JFREEREPORT","@SYSTEM_JFREEREPORT@","e" );
+ToFile( "JCOMMON_JAR",       "@JCOMMON_JAR@",      "e" );
+ToFile( "SAC_JAR",           "@SAC_JAR@",          "e" );
+ToFile( "LIBXML_JAR",        "@LIBXML_JAR@",       "e" );
+ToFile( "FLUTE_JAR",         "@FLUTE_JAR@",        "e" );
+ToFile( "JFREEREPORT_JAR",   "@JFREEREPORT_JAR@",  "e" );
+ToFile( "LIBLAYOUT_JAR",     "@LIBLAYOUT_JAR@",    "e" );
+ToFile( "LIBLOADER_JAR",     "@LIBLOADER_JAR@",    "e" );
+ToFile( "LIBFORMULA_JAR",    "@LIBFORMULA_JAR@",   "e" );
+ToFile( "LIBREPOSITORY_JAR", "@LIBREPOSITORY_JAR@","e" );
+ToFile( "LIBFONTS_JAR",      "@LIBFONTS_JAR@",     "e" );
+ToFile( "JCOMMON_SERIALIZER_JAR","@JCOMMON_SERIALIZER_JAR@","e" );
 ToFile( "ENABLE_DBUS",       "@ENABLE_DBUS@",      "e" );
 ToFile( "ENABLE_GNOMEVFS",   "@ENABLE_GNOMEVFS@",  "e" );
 ToFile( "ENABLE_KDE",        "@ENABLE_KDE@",       "e" );
