Index: target.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/target.mk,v
retrieving revision 1.155
diff -u -r1.155 target.mk
--- solenv/inc/target.mk	5 Aug 2005 14:00:27 -0000	1.155
+++ solenv/inc/target.mk	21 Sep 2005 12:39:25 -0000
@@ -1109,7 +1109,8 @@
 #moved here to get UNOTYPES from COMPxTYPELIST
 .IF "$(UNOTYPES)" != ""
 UNOUCRHEADER=$(foreach,j,$(subst,.,$/ $(UNOTYPES)) $(UNOUCROUT)$/$(j:+".hpp"))
-UNOUCRTARGET:=$(UNOUCRHEADER)
+UNOUCRTYPEFLAGS=$(foreach,j,$(UNOTYPES) $(UNOUCROUT)$/$(j:+".flag"))
+UNOUCRTARGET:=$(INCCOM)$/$(TARGET)_headergen.done
 .ENDIF			# "$(UNOTYPES)" != ""
 
 .IF "$(HELPIDFILES)"!=""
@@ -1886,7 +1887,6 @@
 CPPUMAKERFLAGS*=-L
 
 .IF "$(UNOTYPES)" != ""
-.IF "$(SINGLE_SHOT)"==""
 # makeing all in one
 .DIRCACHE=no
 .IF "$(ENVINCPRE))"!=""
@@ -1901,12 +1901,36 @@
 .IF "$(DEPOBJFILES)"!=""
 $(DEPOBJFILES) : $(UNOUCRHEADER)
 .ENDIF			# "$(SLOFILES)"!=""
-$(UNOUCRTARGET) : $(UNOUCRDEP)
+.IF "$(NOOPTTARGET)"!=""
+$(NOOPTTARGET) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+.IF "$(NOOPTFILES)"!=""
+$(NOOPTFILES) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+.IF "$(EXCEPTIONSTARGET)"!=""
+$(EXCEPTIONSTARGET) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+.IF "$(EXCEPTIONSFILES)"!=""
+$(EXCEPTIONSFILES) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+.IF "$(EXCEPTIONSNOOPTTARGET)"!=""
+$(EXCEPTIONSNOOPTTARGET) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+.IF "$(EXCEPTIONSNOOPTFILES)"!=""
+$(EXCEPTIONSNOOPTFILES) : $(UNOUCRHEADER)
+.ENDIF			# "$(SLOFILES)"!=""
+
+$(UNOUCRHEADER) : $(UNOUCRTARGET)
+
+$(UNOUCROUT)$/%.flag :
+	@+-$(MKDIRHIER) $(@:d)
+	@+$(TOUCH) $@
+
+$(UNOUCRTARGET) : $(UNOUCRDEP) $(UNOUCRTYPEFLAGS)
 .IF "$(XML2MK_FILES)"!=""
 	@+-$(RM) $(foreach,i,$(XML2MK_FILES) $(MISC)$/$(i).mk) >& $(NULLDEV)
 .ENDIF			# "$(XML2MK_FILES)"!=""
-	+$(CPPUMAKER) @$(mktmp $(CPPUMAKERFLAGS) -B$(UNOUCRBASE) -O$(UNOUCROUT) $(UNOTYPES:^"-T")  $(UNOUCRRDB))
-.ENDIF			# "$(SINGLE_SHOT)" == ""
+	+$(CPPUMAKER) @$(mktmp $(CPPUMAKERFLAGS) -B$(UNOUCRBASE) -O$(UNOUCROUT) $(UNOTYPES:^"-T")  $(UNOUCRRDB)) && touch $@
 .ENDIF			# "$(UNOTYPES)" != ""
 
 .ENDIF			# "$(L10N_framework)"!=""
