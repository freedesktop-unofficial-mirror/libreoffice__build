Index: configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.116
diff -u -u -r1.116 configure.in
--- config_office/configure.in	11 Apr 2005 09:31:15 -0000	1.116
+++ config_office/configure.in	30 Apr 2005 23:05:04 -0000
@@ -261,6 +261,9 @@
                           or XML filters. Use --with-java=gij to enable gij/gcj
                           as java/javac replacements
 ], WITH_JAVA=$withval, WITH_JAVA=java)
+AC_ARG_ENABLE(gcj-dbtool,
+[  --enable-gcj-dbtool     Use gcj-dbtool to cache the used jars to speed up using them (gcj-only)
+],,)
 AC_ARG_WITH(ant-home,
 [  --with-ant-home         If you have installed Jakarta Ant on your system,
                           please supply the path here.
@@ -1888,19 +1891,25 @@
 dnl ===================================================================
 dnl Check for optional gcj-dbtool
 dnl ===================================================================
-if test "$JDK" == "gcj"; then 
-    javacache=`echo $WITH_JAVA | $SED -e "s/gij/gcj-dbtool/g"`
-    if test -z "$with_jdk_home"; then
-        AC_PATH_PROG(JAVACACHE, $javacache)
-    else
-        _javac_path="$with_jdk_home/bin/$javacache"
-        dnl Check if there is a gcj-dbtool at all.
-        if test -x "$_javac_path"; then
-            JAVACACHE=$_javac_path
+if test "$JDK" == "gcj"; then
+    AC_MSG_CHECKING([whether to cache jars])
+    if test -n "$enable_gcj_dbtool" && test "$enable_gcj_dbtool" != "no"; then
+        AC_MSG_RESULT([yes])
+        javacache=`echo $WITH_JAVA | $SED -e "s/gij/gcj-dbtool/g"`
+        if test -z "$with_jdk_home"; then
+            AC_PATH_PROG(JAVACACHE, $javacache)
+        else
+            _javac_path="$with_jdk_home/bin/$javacache"
+            dnl Check if there is a gcj-dbtool at all.
+            if test -x "$_javac_path"; then
+                JAVACACHE=$_javac_path
+            fi
         fi
-    fi
-    if test -z "$JAVACACHE"; then
-      AC_MSG_WARN([$javacache not found set with_jdk_home])
+        if test -z "$JAVACACHE"; then
+          AC_MSG_WARN([$javacache not found set with_jdk_home])
+        fi
+    else
+        AC_MSG_RESULT([no])
     fi
 fi
 AC_SUBST(JAVACACHE)
Index: bin/deliver.pl
===================================================================
RCS file: /cvs/tools/solenv/bin/deliver.pl,v
retrieving revision 1.88
diff -u -u -r1.88 deliver.pl
--- solenv/bin/deliver.pl	25 Apr 2005 16:16:38 -0000	1.88
+++ solenv/bin/deliver.pl	30 Apr 2005 23:08:05 -0000
@@ -782,7 +782,7 @@
         # hard link if possible
         if( link($from, $to) ){
             print "LINK: $from -> $to\n";
-            if ($ENV{JDK} eq 'gcj' && is_jar($from)) {
+            if ($ENV{JDK} eq 'gcj' && $ENV{JAVACACHE} ne '' && is_jar($from)) {
                 cachejar($to);
             }
             return 1;
@@ -818,7 +818,7 @@
         fix_file_permissions($$from_stat_ref[2], $temp_file);
         $rc = rename($temp_file, $to);
         if ( $rc ) {
-            if (defined($ENV{JDK}) && $ENV{JDK} eq 'gcj' && is_jar($from)) {
+            if (defined($ENV{JDK}) && $ENV{JDK} eq 'gcj' && defined($ENV{JAVACACHE}) && $ENV{CACHEJAR} ne '' && is_jar($from)) {
                 cachejar($to);
             }
             # handle special packaging of *.dylib files for Mac OS X
