--- config_office/configure.in	2006-08-09 18:54:39.000000000 +0200
+++ config_office/configure.in	2006-08-09 18:54:35.000000000 +0200
@@ -2768,7 +2768,8 @@ if test "z$enable_odk" = "z" -o "$enable
       if test "$MINGWSTRIP" = "false"; then
          AC_MSG_ERROR(MinGW32 binutils needed. Install them.)
       fi
-      AC_LANG(C++)
+      AC_LANG_SAVE
+      AC_LANG_CPLUSPLUS
       save_CXX=$CXX
       save_CXXCPP=$CXXCPP
       CXX=$MINGWCXX
@@ -2789,7 +2790,7 @@ if test "z$enable_odk" = "z" -o "$enable
       CXX=$save_CXX
       CXXCPP=$save_CXXCPP
       LIBS=$save_LIBS
-      AC_LANG(C)
+      AC_LANG_RESTORE
    fi
    BUILD_TYPE="$BUILD_TYPE ODK"
 else
@@ -4896,6 +4897,8 @@ dnl ====================================
 AC_MSG_CHECKING([whether to enable KDE address book support])
 if test "$enable_kdeab" = "yes" && test "$enable_kde" = "yes"; then
    AC_MSG_RESULT([yes])
+   AC_LANG_SAVE
+   AC_LANG_CPLUSPLUS
    save_CXXFLAGS=$CXXFLAGS
    CXXFLAGS="$CXXFLAGS $KDE_CFLAGS"
    AC_MSG_CHECKING([whether KDE is between 3.2 and 3.6])
@@ -4908,6 +4911,7 @@ int main(int argc, char **argv) {
 }
        ], [AC_MSG_RESULT([yes])], [AC_MSG_ERROR([KDE version too old or too recent, please use another version of KDE or disable KDE address book support])])
    CXXFLAGS=$save_CXXFLAGS
+   AC_LANG_RESTORE
    ENABLE_KAB=TRUE
 else
    AC_MSG_RESULT([no])
