Index: source/drivers/evoab2/NDatabaseMetaData.cxx
===================================================================
RCS file: /cvs/dba/connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx,v
retrieving revision 1.6.178.1
diff -u -r1.6.178.1 NDatabaseMetaData.cxx
--- connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx	18 Jan 2008 14:56:06 -0000	1.6.178.1
+++ connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx	22 Jan 2008 18:58:12 -0000
@@ -285,7 +285,7 @@
 
 
 OEvoabDatabaseMetaData::OEvoabDatabaseMetaData(OEvoabConnection* _pCon)
-	: ::connectivity::ODatabaseMetaDataBase(_pCon)
+	: ::connectivity::ODatabaseMetaDataBase(_pCon, _pCon->getConnectionInfo())
 	,m_pConnection(_pCon)
 {
 	OSL_ENSURE(m_pConnection,"OEvoabDatabaseMetaData::OEvoabDatabaseMetaData: No connection set!");
@@ -368,56 +368,47 @@
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxBinaryLiteralLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxRowSize(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxCatalogNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxCharLiteralLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnsInIndex(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxCursorNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxConnections(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnsInTable(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 OEvoabDatabaseMetaData::impl_getMaxStatements_throw(  )
@@ -427,8 +418,7 @@
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxTableNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 OEvoabDatabaseMetaData::impl_getMaxTablesInSelect_throw(  ) 
@@ -485,8 +475,7 @@
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxIndexLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Bool SAL_CALL OEvoabDatabaseMetaData::supportsNonNullableColumns(  ) throw(SQLException, RuntimeException)
@@ -629,22 +618,19 @@
 	return sal_False;
 }
 // -------------------------------------------------------------------------
-sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxStatements(  ) throw(SQLException, RuntimeException)
+sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxStatementLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxProcedureNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxSchemaNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Bool SAL_CALL OEvoabDatabaseMetaData::supportsTransactions(  ) throw(SQLException, RuntimeException)
@@ -969,26 +955,22 @@
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnsInGroupBy(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnsInOrderBy(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxColumnsInSelect(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Int32 SAL_CALL OEvoabDatabaseMetaData::getMaxUserNameLength(  ) throw(SQLException, RuntimeException)
 {
-	sal_Int32 nValue = 0; // 0 means no limit
-	return nValue;
+	return 0;// 0 means no limit
 }
 // -------------------------------------------------------------------------
 sal_Bool SAL_CALL OEvoabDatabaseMetaData::supportsResultSetType( sal_Int32 /*setType*/ ) throw(SQLException, RuntimeException)
@@ -1075,10 +1057,8 @@
 		// ::rtl::OUString::createFromAscii("ALIAS"),
 		// ::rtl::OUString::createFromAscii("SYNONYM")
 	};
-	::connectivity::ODatabaseMetaDataResultSet* pResult = new ::connectivity::ODatabaseMetaDataResultSet();
+        ::connectivity::ODatabaseMetaDataResultSet* pResult = new ::connectivity::ODatabaseMetaDataResultSet(::connectivity::ODatabaseMetaDataResultSet::eTableTypes);
 	Reference< XResultSet > xRef = pResult;
-	// this call initialies the resultset metadata with the corresponding information
-	pResult->setTableTypes();
 
 	// here we fill the rows which should be visible when ask for data from the resultset returned here
 	sal_Int32  nSize = sizeof(sTableTypes) / sizeof(::rtl::OUString);
@@ -1104,9 +1084,9 @@
 	 * Return the proper type information required by evo driver  
 	 */
 
-	ODatabaseMetaDataResultSet* pResultSet = new ODatabaseMetaDataResultSet();
+	ODatabaseMetaDataResultSet* pResultSet = new ODatabaseMetaDataResultSet(ODatabaseMetaDataResultSet::eTypeInfo);
+
 	Reference< XResultSet > xResultSet = pResultSet;
-	pResultSet->setTypeInfoMap();
 	static ODatabaseMetaDataResultSet::ORows aRows;
 
 	if(aRows.empty())
@@ -1163,9 +1143,8 @@
 {
 	::osl::MutexGuard aGuard( m_aMutex );
 
-	ODatabaseMetaDataResultSet* pResult = new ODatabaseMetaDataResultSet();
+	ODatabaseMetaDataResultSet* pResult = new ODatabaseMetaDataResultSet(ODatabaseMetaDataResultSet::eTableTypes);
 	Reference< XResultSet > xRef = pResult;
-	pResult->setTablesMap();
 	
 	// check if any type is given
 	// when no types are given then we have to return all tables e.g. TABLE
