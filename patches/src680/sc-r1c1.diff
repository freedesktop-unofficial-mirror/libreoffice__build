Index: officecfg/registry/data/org/openoffice/Office/UI/CalcCommands.xcu
===================================================================
RCS file: /cvs/util/officecfg/registry/data/org/openoffice/Office/UI/CalcCommands.xcu,v
retrieving revision 1.14
diff -u -w -p -r1.14 CalcCommands.xcu
--- officecfg/registry/data/org/openoffice/Office/UI/CalcCommands.xcu	15 Mar 2005 12:42:05 -0000	1.14
+++ officecfg/registry/data/org/openoffice/Office/UI/CalcCommands.xcu	28 Nov 2005 19:35:06 -0000
@@ -1418,6 +1418,20 @@
 					<value xml:lang="en-US">R~ight-To-Left</value>
 				</prop>
 			</node>
+			<node oor:name=".uno:SheetUseR1C1" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					<value xml:lang="en-US">Use R1~C1</value>
+					<value xml:lang="cs">Použij R1~C1</value>
+					<value xml:lang="de">R1~C1 verwenden</value>
+					<value xml:lang="es">Usar R1~C1</value>
+					<value xml:lang="fr">Utiliser R1~C1</value>
+					<value xml:lang="it">Utilizza R1~C1</value>
+					<value xml:lang="ja">R1~C1を使用する</value>
+					<value xml:lang="pt-BR">Usar R1~C1</value>
+					<value xml:lang="zh-CN">使用 R1C1(~C)</value>
+					<value xml:lang="zh-TW">使用 R1C1(~C)</value>
+				</prop>
+			</node>
             <node oor:name=".uno:SetAnchorToPage" oor:op="replace">
                 <prop oor:name="Label" oor:type="xs:string">
                     <value xml:lang="de">Verankerung: An der Seite</value>
diff -r -u -p sc/uiconfig/scalc/menubar/menubar.xml sc/uiconfig/scalc/menubar/menubar.xml
--- sc/uiconfig/scalc/menubar/menubar.xml	2006-09-05 23:35:36.000000000 -0400
+++ sc/uiconfig/scalc/menubar/menubar.xml	2006-08-24 10:45:05.000000000 -0400
@@ -213,6 +213,7 @@
                     <menu:menuitem menu:id=".uno:Hide"/>
                     <menu:menuitem menu:id=".uno:Show"/>
                     <menu:menuitem menu:id=".uno:SheetRightToLeft"/>
+                    <menu:menuitem menu:id=".uno:SheetUseR1C1"/>
                 </menu:menupopup>
             </menu:menu>
             <menu:menu menu:id=".uno:MergeCellsMenu">
diff -r -u -p sc/inc/scfuncs.hrc sc/inc/scfuncs.hrc
--- sc/inc/scfuncs.hrc	2006-09-05 23:35:37.000000000 -0400
+++ sc/inc/scfuncs.hrc	2006-08-24 10:47:20.000000000 -0400
@@ -300,6 +300,8 @@
 #define HID_FUNC_TABELLEN			(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TABLE*ID_FUNCTION_OFFSET)+19)
 #define HID_FUNC_HYPERLINK			(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TABLE*ID_FUNCTION_OFFSET)+20)
 #define HID_FUNC_GETPIVOTDATA		(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TABLE*ID_FUNCTION_OFFSET)+21)
+#define HID_FUNC_INDIREKT_XL			(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TABLE*ID_FUNCTION_OFFSET)+22)
+#define HID_FUNC_ADRESSE_XL			(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TABLE*ID_FUNCTION_OFFSET)+23)
 
 #define HID_FUNC_CODE				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TEXT*ID_FUNCTION_OFFSET)+1)
 #define HID_FUNC_DM					(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_TEXT*ID_FUNCTION_OFFSET)+2)
diff -r -u -p sc/inc/sc.hrc sc/inc/sc.hrc
--- sc/inc/sc.hrc	2006-09-05 23:35:37.000000000 -0400
+++ sc/inc/sc.hrc	2006-08-24 10:45:04.000000000 -0400
@@ -805,6 +805,7 @@
 #define FID_TAB_APPEND			(TAB_POPUP_START+5)
 #define FID_TAB_INDEX			(TAB_POPUP_START+6)
 #define FID_TAB_RTL				(TAB_POPUP_START+7)
+#define FID_TAB_USE_R1C1		(TAB_POPUP_START+8)
 
 #define TAB_POPUP_END			(DATA_MENU_END + 20)
 
diff -r -u -p sc/sdi/docsh.sdi sc/sdi/docsh.sdi
--- sc/sdi/docsh.sdi	2006-09-05 23:35:37.000000000 -0400
+++ sc/sdi/docsh.sdi	2006-08-24 10:45:04.000000000 -0400
@@ -68,6 +68,7 @@ interface TableSelection
 	FID_DELETE_TABLE	[ ExecMethod = ExecuteTable; StateMethod = GetStateTable; ]
 	FID_TAB_RENAME		[ ExecMethod = ExecuteTable; StateMethod = GetStateTable; ]
 	FID_TAB_RTL			[ ExecMethod = ExecuteTable; StateMethod = GetStateTable; ]
+	FID_TAB_USE_R1C1	[ ExecMethod = ExecuteTable; StateMethod = GetStateTable; ]
 
 	SID_TABLE_ACTIVATE	[ ExecMethod = Execute; ]
 }
diff -r -u -p sc/sdi/scalc.sdi sc/sdi/scalc.sdi
--- sc/sdi/scalc.sdi	2006-09-05 23:35:37.000000000 -0400
+++ sc/sdi/scalc.sdi	2006-08-24 10:45:04.000000000 -0400
@@ -7754,3 +7754,30 @@ SfxBoolItem SheetRightToLeft FID_TAB_RTL
 ]
 
 
+//--------------------------------------------------------------------------
+SfxBoolItem SheetUseR1C1	FID_TAB_USE_R1C1
+
+[
+	/* flags */
+	AutoUpdate	= FALSE,
+	Cachable = Cachable,
+	FastCall = FALSE,
+	HasCoreId = FALSE,
+	HasDialog = FALSE,
+	ReadOnlyDoc = TRUE,
+	Toggle = FALSE,
+	Container = FALSE,
+	RecordAbsolute = FALSE,
+	RecordPerSet;
+	Synchron;
+
+	Readonly = FALSE,
+
+	/* config */
+	AccelConfig = TRUE,
+	MenuConfig = TRUE,
+	StatusBarConfig = FALSE,
+	ToolBoxConfig = TRUE,
+	GroupId = GID_FORMAT;
+]
+
diff -r -u -p sc/source/core/src/compiler.src sc/source/core/src/compiler.src
--- sc/source/core/src/compiler.src	2006-09-05 23:35:39.000000000 -0400
+++ sc/source/core/src/compiler.src	2006-08-24 10:45:05.000000000 -0400
@@ -1092,12 +1092,24 @@ Resource RID_SC_FUNCTION_NAMES
 		Text [ en-US ] = "INDIRECT" ;
 		Text [ x-comment ] = " ";
 	};
+	String SC_OPCODE_INDIRECT_XL
+	{
+		Text [ de ] = "INDIREKT_XL" ;
+		Text [ en-US ] = "INDIRECT_XL" ;
+		Text [ x-comment ] = " ";
+	};
 	String SC_OPCODE_ADDRESS
 	{
 		Text [ de ] = "ADRESSE" ;
 		Text [ en-US ] = "ADDRESS" ;
 		Text [ x-comment ] = " ";
 	};
+	String SC_OPCODE_ADDRESS_XL
+	{
+		Text [ de ] = "ADRESSE_XL" ;
+		Text [ en-US ] = "ADDRESS_XL" ;
+		Text [ x-comment ] = " ";
+	};
 	String SC_OPCODE_MATCH
 	{
 		Text [ de ] = "VERGLEICH" ;
@@ -1879,7 +1891,9 @@ Resource RID_SC_FUNCTION_NAMES_ENGLISH
 	String SC_OPCODE_DB_VAR { Text = "DVAR" ; };
 	String SC_OPCODE_DB_VAR_P { Text = "DVARP" ; };
 	String SC_OPCODE_INDIRECT { Text = "INDIRECT" ; };
+	String SC_OPCODE_INDIRECT_XL { Text = "INDIRECT_XL" ; };
 	String SC_OPCODE_ADDRESS { Text = "ADDRESS" ; };
+	String SC_OPCODE_ADDRESS_XL { Text = "ADDRESS_XL" ; };
 	String SC_OPCODE_MATCH { Text = "MATCH" ; };
 	String SC_OPCODE_COUNT_EMPTY_CELLS { Text = "COUNTBLANK" ; };
 	String SC_OPCODE_COUNT_IF { Text = "COUNTIF" ; };
diff -r -u -p sc/source/filter/excel/excform.cxx sc/source/filter/excel/excform.cxx
--- sc/source/filter/excel/excform.cxx	2006-09-05 23:35:38.000000000 -0400
+++ sc/source/filter/excel/excform.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -1372,12 +1372,6 @@ void ExcelToSc::DoMulArgs( DefTokenId eI
 		if( eId == ocPercentrank && nAnz == 3 )
 			nSkipEnd = 0;		// letzten Parameter bei Bedarf weglassen
 
-		else if( eId == ocIndirect && nAnz == 2 )
-			nSkipEnd = 0;
-
-		else if( eId == ocAddress && nAnz > 3 )
-			nNull = nAnz - 4;
-
 		// Joost-Spezialfaelle
 		else if( eId == ocIf )
 		{
diff -r -u -p sc/source/filter/excel/excimp8.cxx sc/source/filter/excel/excimp8.cxx
--- sc/source/filter/excel/excimp8.cxx	2006-09-05 23:35:40.000000000 -0400
+++ sc/source/filter/excel/excimp8.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -190,6 +190,12 @@ void ImportExcel8::Iteration( void )
 }
 
 
+void ImportExcel8::RefMode( void )
+{
+	pD->SetAddressConvention( (aIn.ReaduInt16() == 0)
+				  ? ScAddress::CONV_XL_R1C1
+				  : ScAddress::CONV_OOO );
+}
 void ImportExcel8:: WinProtection( void )
 {
     if( aIn.ReaduInt16() != 0 )
diff -r -u -p sc/source/filter/excel/read.cxx sc/source/filter/excel/read.cxx
--- sc/source/filter/excel/read.cxx	2006-09-05 23:35:40.000000000 -0400
+++ sc/source/filter/excel/read.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -1145,6 +1145,7 @@ FltError ImportExcel8::Read( void )
                     case 0x0206:
                     case 0x0406:    Formula25();            break;  // FORMULA      [ 2  5   ]
                     case 0x000C:    Calccount();            break;  // CALCCOUNT
+					case 0x000F:    RefMode();				break;	// REFMODE
                     case 0x0010:    Delta();                break;  // DELTA
                     case 0x0011:    Iteration();            break;  // ITERATION
                     case 0x001C:    Note();                 break;  // NOTE         [ 2345   ]
diff -r -u -p sc/source/filter/excel/xlformula.cxx sc/source/filter/excel/xlformula.cxx
--- sc/source/filter/excel/xlformula.cxx	2006-09-05 23:35:38.000000000 -0400
+++ sc/source/filter/excel/xlformula.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -187,7 +187,8 @@ static const XclFunctionInfo saFuncTable
     { ocLIA,                142,    3,  3,  V, { V } },
     { ocDIA,                143,    4,  4,  V, { V } },
     { ocGDA,                144,    4,  5,  V, { V } },
-    { ocIndirect,           148,    1,  2,  R, { V }, EXC_FUNCFLAG_VOLATILE },
+    { ocIndirectXL,         148,    1,  2,  R, { V }, EXC_FUNCFLAG_VOLATILE },
+    { ocIndirect,           148,    1,  2,  R, { V }, EXC_FUNCFLAG_VOLATILE | EXC_FUNCFLAG_EXPORTONLY },
     { ocClean,              162,    1,  1,  V, { V } },
     { ocMatDet,             163,    1,  1,  V, { A } },
     { ocMatInv,             164,    1,  1,  A, { A } },
@@ -219,7 +220,8 @@ static const XclFunctionInfo saFuncTable
     { ocRKP,                51,     1,  4,  A, { R, R, V, V } },    // BIFF2: 1-2, BIFF3: 1-4
     { ocGrowth,             52,     1,  4,  A, { R, R, R, V } },    // BIFF2: 1-3, BIFF3: 1-4
     { ocTrunc,              197,    1,  2,  V, { V } },             // BIFF2: 1,   BIFF3: 1-2
-    { ocAddress,            219,    2,  5,  V, { V, V, V, E, V } },
+    { ocAddressXL,          219,    2,  5,  V, { V, V, V, V, V } },
+    { ocAddress,            219,    2,  5,  V, { V, V, V, E, V }, EXC_FUNCFLAG_EXPORTONLY },
     { ocGetDiffDate360,     220,    2,  2,  V, { V, V, C, I } },
     { ocGetActDate,         221,    0,  0,  V, {}, EXC_FUNCFLAG_VOLATILE },
     { ocVBD,                222,    5,  7,  V, { V } },
diff -r -u -p sc/source/filter/inc/excimp8.hxx sc/source/filter/inc/excimp8.hxx
--- sc/source/filter/inc/excimp8.hxx	2006-09-05 23:35:40.000000000 -0400
+++ sc/source/filter/inc/excimp8.hxx	2006-08-24 10:45:05.000000000 -0400
@@ -76,6 +76,7 @@ class ImportExcel8 : public ImportExcel
 
 		void					Calccount( void );				// 0x0C
         void                    Precision( void );              // 0x0E
+		void					RefMode( void );				// 0x0F
 		void					Delta( void );					// 0x10
 		void					Iteration( void );				// 0x11
 		void					Note( void );					// 0x1C
diff -r -u -p sc/source/filter/inc/xcl97rec.hxx sc/source/filter/inc/xcl97rec.hxx
--- sc/source/filter/inc/xcl97rec.hxx	2006-09-05 23:35:40.000000000 -0400
+++ sc/source/filter/inc/xcl97rec.hxx	2006-08-24 10:45:05.000000000 -0400
@@ -506,6 +506,20 @@ public:
 	virtual	const BYTE*			GetData( void ) const;
 };
 
+class XclRefmode : public ExcRecord
+{
+private:
+	UINT16					    eConv;
+protected:
+	virtual void				SaveCont( XclExpStream& rStrm );
+public:
+								XclRefmode( ScDocument& rDoc );
+
+	virtual	UINT16				GetNum() const;
+	virtual	ULONG				GetLen() const;
+};
+
+
 
 // -------------------------------------------------------------------
 
diff -r -u -p sc/source/filter/lotus/lotform.cxx sc/source/filter/lotus/lotform.cxx
--- sc/source/filter/lotus/lotform.cxx	2006-09-05 23:35:38.000000000 -0400
+++ sc/source/filter/lotus/lotform.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -1056,7 +1056,7 @@ DefTokenId LotusToSc::IndexToToken( BYTE
 		ocTrue,				//  112 W()
 		ocExact,			//  113 Exact()
 		ocNoName,			//  114 Call()
-		ocIndirect,			//  115 @@()
+		ocIndirectXL,		//  115 @@()
 		ocZins,				//  116 Rate()
 		ocNoName,			//  117 Term()
 		ocNoName,			//  118 Cterm()
@@ -1587,7 +1587,7 @@ DefTokenId LotusToSc::IndexToTokenWK123(
 		ocNoName,			//  112 W()
 		ocExact,			//  113 Exact()
 		ocNoName,			//  114 Call()
-		ocIndirect,			//  115 @@()
+		ocIndirectXL,		//  115 @@()
 		ocZins,				//  116 Rate()
 		ocNoName,			//  117 Term()
 		ocNoName,			//  118 Cterm()
diff -r -u -p sc/source/filter/xcl97/xcl97rec.cxx sc/source/filter/xcl97/xcl97rec.cxx
--- sc/source/filter/xcl97/xcl97rec.cxx	2006-09-05 23:35:40.000000000 -0400
+++ sc/source/filter/xcl97/xcl97rec.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -1302,6 +1302,28 @@ const BYTE* XclProtection::GetData( void
 
 
 
+void XclRefmode::SaveCont( XclExpStream& rStrm )
+{
+	rStrm << eConv;
+}
+
+
+XclRefmode::XclRefmode( ScDocument& rDoc )
+{
+	eConv = (rDoc.GetAddressConvention() == ScAddress::CONV_XL_R1C1) ? 0 : 1;
+}
+
+
+UINT16 XclRefmode::GetNum() const
+{
+	return 0x000f;
+}
+
+
+ULONG XclRefmode::GetLen() const
+{
+	return 2;
+}
 
 
 
diff -r -u -p sc/source/ui/src/scfuncs.src sc/source/ui/src/scfuncs.src
--- sc/source/ui/src/scfuncs.src	2006-09-05 23:35:41.000000000 -0400
+++ sc/source/ui/src/scfuncs.src	2006-08-24 10:45:05.000000000 -0400
@@ -9047,6 +9047,104 @@ Resource RID_SC_FUNCTION_DESCRIPTIONS2
 			Text [ x-comment ] = " ";
 		};
 	};
+	Resource SC_OPCODE_ADDRESS_XL
+	{
+		String 1 // Description
+		{
+			Text [ en-US ] = "Returns the reference to a cell as text." ;
+			Text[ cs ] = "Vrátí odkaz na buňku jako text.";
+			Text[ de ] = "Gibt die Referenz auf eine Zelle als Text zurück.";
+			Text[ es ] = "Devuelve la referencia a una celda en formato de texto.";
+			Text[ fr ] = "Retourne la référence à une cellule sous forme de texte.";
+			Text[ it ] = "Restituisce un riferimento a una cella come testo.";
+			Text[ ja ] = "セルへの参照をテキストとして戻します。";
+			Text[ pt-BR ] = "Retorna a referência a uma célula como texto.";
+			Text[ zh-CN ] = "将引用作为文本返回至单元。";
+			Text[ zh-TW ] = "以文字方式傳回儲存格參考。";
+			Text [ x-comment ] = " ";
+		};
+		ExtraData =
+		{
+			ID_FUNCTION_GRP_TABLE;
+			U2S( HID_FUNC_ADRESSE_XL );
+			5;	0;	0;	1;	1;	1;
+		};
+		String 2 // Name of Parameter 1
+		{
+			Text [ de ] = "Zeile" ;
+			Text [ en-US ] = "row" ;
+			Text [ cs ] = "Řádek";
+			Text [ x-comment ] = " ";
+		};
+		String 3 // Description of Parameter 1
+		{
+			Text [ de ] = "Die Zeilennummer der Zelle." ;
+			Text [ en-US ] = "The row number of the cell." ;
+			Text [ cs ] = "Číslo řádku buňky.";
+			Text [ x-comment ] = " ";
+		};
+		String 4 // Name of Parameter 2
+		{
+			Text [ de ] = "Spalte" ;
+			Text [ en-US ] = "column" ;
+			Text [ cs ] = "Sloupec";
+			Text [ x-comment ] = " ";
+		};
+		String 5 // Description of Parameter 2
+		{
+			Text [ de ] = "Die Spaltennummer der Zelle." ;
+			Text [ en-US ] = "The column number of the cell." ;
+			Text [ cs ] = "Číslo sloupce buňky.";
+			Text [ x-comment ] = " ";
+		};
+		String 6 // Name of Parameter 3
+		{
+			Text [ de ] = "ABS" ;
+			Text [ en-US ] = "ABS" ;
+			Text [ x-comment ] = " ";
+		};
+		String 7 // Description of Parameter 3
+		{
+			Text [ de ] = "Gibt an, ob absolute oder relative Referenzierung verwendet wird." ;
+			Text [ en-US ] = "Specifies whether absolute or relative referencing is to be used." ;
+			Text [ cs ] = "Specifikuje zda budou použity absolutní nebo relativní odkazy.";
+			Text [ x-comment ] = " ";
+		};
+		String 8 // Name of Parameter 4
+		{
+			Text [ de ] = " ";
+			Text [ en-US ] = "A1";
+			Text [ x-comment ] = " ";
+		};
+		String 9 // Description of Parameter 4
+		{
+			Text [ en-US ] = "If TRUE (or 1) or omitted generate A1 style address, otherwise produce R1C1 style address.";
+			Text[ cs ] = "Pokud je hodnota pravdivá (nebo 1) nebo je vynechána, adresy budou ve stylu A1. V opačném případě bude použit styl R1C1.";
+			Text[ de ] = "Wenn TRUE (oder 1) bzw. ausgelassen, A1-Adresse generieren, anderenfalls R1C1-Adresse erstellen.";
+			Text[ es ] = "Si el valor es TRUE (o 1) o se omite, genera una dirección del estilo A1; de lo contrario, genera una dirección del estilo R1C1.";
+			Text[ fr ] = "Si TRUE (ou 1) ou omis, générer une adresse de style A1. Sinon, produire une adresse de style R1C1.";
+			Text[ it ] = "Se impostato su TRUE (o 1) oppure se omesso genera un indirizzo tipo A1, altrimenti genera un indirizzo di tipo R1C1.";
+			Text[ ja ] = "TRUE (1)またはA1スタイルアドレスが作成されていない場合、R1C1スタイルアドレスが作成されます。";
+			Text[ pt-BR ] = "Se VERDADEIRO (ou 1) ou omitido, gerar endereço em estilo A1; caso contrário produzir endereço em estilo R1C1.";
+			Text[ zh-CN ] = "如果为 TRUE（或 1），忽略生成 A1 样式地址，否则生成 R1C1 样式地址。";
+			Text[ zh-TW ] = "如果是傳回 TRUE (或 1) 或是省略就會產生 A1 格式位址，傳回其他值則會產生 R1C1 格式位址。";
+			Text [ x-comment ] = " ";
+		};
+		String 10 // Name of Parameter 5
+		{
+			Text [ de ] = "Tabelle" ;
+			Text [ en-US ] = "sheet" ;
+			Text [ cs ] = "List";
+			Text [ x-comment ] = " ";
+		};
+		String 11 // Description of Parameter 5
+		{
+			Text [ de ] = "Der Tabellenname des Zellbezugs." ;
+			Text [ en-US ] = "The spreadsheet name of the cell reference." ;
+			Text [ cs ] = "Název sešitu odkazující buňky";
+			Text [ x-comment ] = " ";
+		};
+	};
 	 // -=*# Resource for function BEREICHE #*=-
 	Resource SC_OPCODE_AREAS
 	{
@@ -9512,6 +9601,57 @@ Resource RID_SC_FUNCTION_DESCRIPTIONS2
 			Text [ x-comment ] = " ";
 		};
 	};
+	 // -=*# Resource for function INDIREKT_XL #*=-
+	Resource SC_OPCODE_INDIRECT_XL
+	{
+		String 1 // Description
+		{
+			Text [ de ] = "Bestimmt den Inhalt einer als Bezug in MS Excel (tm) Textform angegebenen Zelle." ;
+			Text [ en-US ] = "Returns the contents of a cell that is referenced in MS Excel (tm) text form." ;
+			Text [ cs ] = "Vrátí obsah buňky na kterou se odkazuje pomocí textové formy MS Excelu (tm).";
+			Text [ x-comment ] = " ";
+		};
+		ExtraData =
+		{
+			ID_FUNCTION_GRP_TABLE;
+			U2S( HID_FUNC_INDIREKT_XL );
+			2;	0;	1;	
+		};
+		String 2 // Name of Parameter 1
+		{
+			Text [ de ] = "Bezug" ;
+			Text [ en-US ] = "ref " ;
+			Text [ x-comment ] = " ";
+		};
+		String 3 // Description of Parameter 1
+		{
+			Text [ de ] = "Die Zelle, deren Inhalt ausgewertet werden soll als Bezug in MS Excel (tm) Textform (z.B. \"Sheet!A1\")." ;
+			Text [ en-US ] = "The cell whose contents are to be evaluated is to be referenced in MS Excel (tm) text form (e.g. \"Sheet!A1\")." ;
+			Text [ cs ] = "Na buňku, jejíž obsah bude vyhodnocován, bude odkazováno ve formátu MS Excelu (tm) (např. \"List!A1\").";
+			Text [ x-comment ] = " ";
+		};
+		String 4 // Name of Parameter 2
+		{
+			Text [ de ] = "'Adressformat'" ;
+			Text [ en-US ] = "Format" ;
+			Text [ cs ] = "Formát";
+			Text [ x-comment ] = " ";
+		};
+		String 5 // Description of Parameter 2
+		{
+			Text [ en-US ] = "What address format to expect.  TRUE for A1, FALSE for R1C1.  Defaults to A1." ;
+			Text[ cs ] = "Jaký formát odkazu je očekáván. TRUE (pravda) pro A1, FALSE (nepravda) pro R1C1. Standardně A1.";
+			Text[ de ] = "Zu erwartendes Adressformat.  TRUE für A1, FALSE für R1C1.  Standardmäßig wird A1 verwendet.";
+			Text[ es ] = "Formato de dirección que se debe esperar. TRUE para A1, FALSE para R1C1. El valor por defecto es A1.";
+			Text[ fr ] = "Quel format d'adresse attendre.  TRUE pour A1, FALSE pour R1C1.  La valeur par défaut est A1.";
+			Text[ it ] = "Formato di indirizzo previsto.  TRUE per A1, FALSE per R1C1.  Il valore predefinito è A1.";
+			Text[ ja ] = "作成されるアドレス形式  TRUEの場合はA1、FALSEの場合はR1C1が作成されます。  デフォルトでは、A1になります。";
+		Text[ pt-BR ] = "Formato do endereço esperado. VERDADEIRO para A1, FALSO para R1C1. Usa A1 por padrão.";
+			Text[ zh-CN ] = "期望何种地址格式。TRUE 代表 A1，FALSE 代表 R1C1。默认值为 A1。";
+			Text[ zh-TW ] = "預期會產生的位址格式。TRUE 會產生 A1 格式，FALSE 會產生 R1C1 格式。預設是產生 A1 格式。";
+			Text [ x-comment ] = " ";
+		};
+	};
 	 // -=*# Resource for function VERWEIS #*=-
 	Resource SC_OPCODE_LOOKUP
 	{
diff -r -u -p sc/source/ui/view/tabvwshf.cxx sc/source/ui/view/tabvwshf.cxx
--- sc/source/ui/view/tabvwshf.cxx	2006-09-05 23:35:41.000000000 -0400
+++ sc/source/ui/view/tabvwshf.cxx	2006-08-24 10:45:05.000000000 -0400
@@ -687,6 +687,17 @@ void ScTabViewShell::ExecuteTable( SfxRe
 			}
 			break;
 
+		case FID_TAB_USE_R1C1:
+			{
+				ScDocFunc aFunc( *pViewData->GetDocShell() );
+				const ScAddress::Convention eConv =  
+					(pDoc->GetAddressConvention() == ScAddress::CONV_OOO)
+						? ScAddress::CONV_XL_R1C1 : ScAddress::CONV_OOO ;
+
+				aFunc.SetAddressConvention( eConv );
+			}
+			break;
+
 		default:
 			DBG_ERROR("Unbekannte Message bei ViewShell");
 			break;
@@ -806,6 +817,13 @@ void ScTabViewShell::GetStateTable( SfxI
 						rSet.Put( SfxBoolItem( nWhich, pDoc->IsLayoutRTL( nTab ) ) );
 				}
 				break;
+
+			case FID_TAB_USE_R1C1:
+				{
+					const ScAddress::Convention eConv =  pDoc->GetAddressConvention();
+					rSet.Put( SfxBoolItem( nWhich, eConv == ScAddress::CONV_XL_R1C1 ) );
+				}
+				break;
 		}
 		nWhich = aIter.NextWhich();
 	}
diff -u -w -p -r1.26 interpre.hxx
--- sc/source/core/inc/interpre.hxx	18 Oct 2006 12:21:05 -0000	1.26
+++ sc/source/core/inc/interpre.hxx	30 Oct 2006 15:38:14 -0000
@@ -424,7 +426,9 @@ void ScDBStdDevP();
 void ScDBVar();
 void ScDBVarP();
 void ScIndirect();
+void ScIndirectXL();
 void ScAddressFunc();
+void ScAddressXL();
 void ScOffset();
 void ScIndex();
 void ScMultiArea();
diff -u -w -p -r1.41 interpr1.cxx
--- sc/source/core/tool/interpr1.cxx	18 Oct 2006 12:22:33 -0000	1.41
+++ sc/source/core/tool/interpr1.cxx	30 Oct 2006 15:38:15 -0000
@@ -5361,7 +5366,7 @@ void ScInterpreter::ScDBVarP()
 }
 
 
-#if 0
+#if 1
 // This could be the code to handle Excel notation. However, we don't offer it
 // (yet) at UI level and documents must not use it, as it isn't clarified how
 // to handle interoperability issues.
@@ -5458,7 +5463,7 @@ void ScInterpreter::ScAddressFunc()
 }
 
 
-#if 0
+#if 1
 // This could be the code to handle Excel notation. However, we don't offer it
 // (yet) at UI level and documents must not use it, as it isn't clarified how
 // to handle interoperability issues.
Index: sc/source/core/tool/interpr4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr4.cxx,v
retrieving revision 1.43
diff -u -w -p -r1.43 interpr4.cxx
--- sc/source/core/tool/interpr4.cxx	18 Oct 2006 12:22:49 -0000	1.43
+++ sc/source/core/tool/interpr4.cxx	15 Nov 2006 19:51:20 -0000
@@ -3401,7 +3426,9 @@ StackVar ScInterpreter::Interpret()
                 case ocDBVar            : ScDBVar();                    break;
                 case ocDBVarP           : ScDBVarP();                   break;
                 case ocIndirect         : ScIndirect();                 break;
+                case ocIndirectXL       : ScIndirectXL();               break;
                 case ocAddress          : ScAddressFunc();              break;
+				case ocAddressXL        : ScAddressXL();                break;
                 case ocMatch            : ScMatch();                    break;
                 case ocCountEmptyCells  : ScCountEmptyCells();          break;
                 case ocCountIf          : ScCountIf();                  break;
Index: sc/source/core/tool/address.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/address.cxx,v
retrieving revision 1.6
diff -u -w -p -r1.6 address.cxx
--- sc/source/core/tool/address.cxx	18 Oct 2006 12:21:36 -0000	1.6
+++ sc/source/core/tool/address.cxx	17 Nov 2006 17:12:41 -0000
@@ -156,7 +156,7 @@ lcl_XL_ParseSheetRef( const sal_Unicode 
 		while( 1 )
 		{
 			const sal_Unicode uc = *p;
-			if( CharClass::isAsciiAlpha( uc ) || uc == '_' )
+			if(  (uc < 128 ? CharClass::isAsciiAlpha( uc ) : ScGlobal::pCharClass->isLetter( uc )) || uc == '_' )
 			{
 				if( only_digits && p != start &&
 				   (uc == 'e' || uc == 'E' ) )
