Index: sfx2/inc/objsh.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/objsh.hxx,v
retrieving revision 1.61
diff -u -p -u -r1.61 objsh.hxx
--- sfx2/inc/objsh.hxx	11 Nov 2005 10:19:33 -0000	1.61
+++ sfx2/inc/objsh.hxx	11 Jan 2006 14:03:54 -0000
@@ -256,6 +256,8 @@ public:
 	sal_Bool					bHasName :1,		// sal_True := bestehendes Objekt, sal_False := es ist ein neues Objekt
                                 bIsTmp :1;          // temp. Storage
 
+    sal_Bool                    bMacroSecurityChecked : 1;
+
 private:
 #if _SOLAR__PRIVATE
 	SAL_DLLPRIVATE void Construct_Impl();
Index: sfx2/source/doc/objmisc.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/objmisc.cxx,v
retrieving revision 1.74
diff -u -p -u -r1.74 objmisc.cxx
--- sfx2/source/doc/objmisc.cxx	11 Nov 2005 12:23:53 -0000	1.74
+++ sfx2/source/doc/objmisc.cxx	11 Jan 2006 14:03:55 -0000
@@ -1044,9 +1044,11 @@ void SfxObjectShell::CheckMacrosOnLoadin
 	const SfxFilter* pFilter = pMedium->GetFilter();
     sal_Bool bHasStorage = IsPackageStorageFormat_Impl( *pMedium );
 
-	if ( GetError() != ERRCODE_NONE )
+	if ( GetError() != ERRCODE_NONE || bMacroSecurityChecked)
 		return;
 
+    bMacroSecurityChecked = sal_True;
+
 	if ( SvtSecurityOptions().IsMacroDisabled() )
 	{
 		// no macro should be executed at all
Index: sfx2/source/doc/objxtor.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/objxtor.cxx,v
retrieving revision 1.62
diff -u -p -u -r1.62 objxtor.cxx
--- sfx2/source/doc/objxtor.cxx	11 Nov 2005 09:06:17 -0000	1.62
+++ sfx2/source/doc/objxtor.cxx	11 Jan 2006 14:03:57 -0000
@@ -218,6 +218,7 @@ SfxObjectShell::SfxObjectShell
 	pImp->bInList = sal_True;
 	pImp->nLoadedFlags = SFX_LOADED_ALL;
 //REMOVE		SetObjectShell( TRUE );
+    bMacroSecurityChecked = sal_False;
 }
 
 //--------------------------------------------------------------------





