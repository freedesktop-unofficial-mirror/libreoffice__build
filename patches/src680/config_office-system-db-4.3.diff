--- config_office/configure.in.ark	2005-07-22 12:12:41.000000000 +0200
+++ config_office/configure.in	2005-07-22 12:13:31.000000000 +0200
@@ -2535,8 +2535,7 @@
         ], []
     )
     AC_MSG_CHECKING([whether db is at least 4.1])
-    # FIXME: Will db 4.3 work? Can't test it since the 4.3 java bindings are not packaged :/
-    for v in 1 2; do
+    for v in 1 2 3; do
        AC_TRY_RUN([
 #include <db.h>
 
@@ -2551,11 +2551,10 @@
     else
        AC_MSG_RESULT([no. you need at least db 4.1])
     fi
-    # does not work :/
-    #AC_CHECK_LIB(db, db_create, [],
-    #  [AC_MSG_ERROR([db library not installed or functional])], [])
-    AC_HAVE_LIBRARY(db, [],
-      [AC_MSG_ERROR([db not installed or functional])], [])
+    dnl Workaround for db 4.3 bug -- libdb-4.3 uses pthreads without linking to the lib
+    LIBS="$LIBS -lpthread"
+    AC_CHECK_LIB(db, db_create, [],
+      [AC_MSG_ERROR([db library not installed or functional])], [])
      if test "$SOLAR_JAVA" = "TRUE"; then
        if test -z $DB_JAR; then
          # three different naming methods *grumble* Are there even more?
