--- extensions/source/nsplugin/source/makefile.mk.old	2005-03-30 13:41:52.000000000 +0200
+++ extensions/source/nsplugin/source/makefile.mk	2005-05-19 12:41:28.000000000 +0200
@@ -78,16 +78,20 @@
 	@echo GTK disabled - nothing to build
 
 .ELSE           # "$(ENABLE_GTK)"==""
+PKGCONFIG_MODULES=gtk+-2.0
+.INCLUDE: pkg_config.mk
 .IF "$(OS)"=="LINUX" || "$(OS)"=="FREEBSD"
 INC+= -DNP_LINUX
 .IF "$(SYSTEM_MOZILLA)" == "YES"
-INCPRE=-I$(MOZ_INC)/nspr -I$(MOZ_INC)/java -I$(MOZ_INC)/plugin
+INCPRE=\
+	$(shell $(PKGCONFIG) $(PKGCONFIG_PREFIX) --cflags nspr || \
+		$(PKGCONFIG) $(PKGCONFIG_PREFIX) --cflags mozilla-nspr || \
+		echo -I$(MOZ_INC)/nspr) \
+	-I$(MOZ_INC)/java -I$(MOZ_INC)/plugin
 # not sure about -DMOZ_X11 but otheriwse some struct member don't exist...
 CFLAGS+=-DSYSTEM_MOZILLA -DMOZ_X11
 .ENDIF
 .ENDIF
-PKGCONFIG_MODULES=gtk+-2.0
-.INCLUDE: pkg_config.mk
 .ENDIF          # "$(ENABLE_GTK)"==""
 .ENDIF          # "$(GUI)"=="UNX"
 .IF "$(GUI)"=="WNT" 
