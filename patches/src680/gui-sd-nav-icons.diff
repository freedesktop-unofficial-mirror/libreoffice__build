Index: sd/source/ui/dlg/sdtreelb.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/dlg/sdtreelb.cxx,v
retrieving revision 1.24
diff -u -p -u -r1.24 sdtreelb.cxx
--- sd/source/ui/dlg/sdtreelb.cxx	16 Sep 2006 18:43:05 -0000	1.24
+++ sd/source/ui/dlg/sdtreelb.cxx	8 Jan 2007 14:00:54 -0000
@@ -207,11 +207,10 @@ SdPageObjsTLB::SdPageObjsTLB( Window* pP
 	pBookmarkDoc	    ( NULL ),
 	pMedium 	    	( NULL ),
 	pOwnMedium		    ( NULL ),
-	aTransparencyColor	( RGB_COLORDATA (0xff,0,0xff) ),
-	aImgOle             ( Bitmap( SdResId( BMP_OLE ) ), aTransparencyColor ),
-	aImgGraphic         ( Bitmap( SdResId( BMP_GRAPHIC ) ), aTransparencyColor ),
-	aImgOleH            ( Bitmap( SdResId( BMP_OLE_H ) ), aTransparencyColor),
-	aImgGraphicH        ( Bitmap( SdResId( BMP_GRAPHIC_H ) ), aTransparencyColor),
+	aImgOle             ( BitmapEx( SdResId( BMP_OLE ) ) ),
+	aImgGraphic         ( BitmapEx( SdResId( BMP_GRAPHIC ) ) ),
+	aImgOleH            ( BitmapEx( SdResId( BMP_OLE_H ) ) ),
+	aImgGraphicH        ( BitmapEx( SdResId( BMP_GRAPHIC_H ) ) ),
 	pDropNavWin		    ( NULL ),
 	bLinkableSelected   ( FALSE )
 {
@@ -350,27 +349,17 @@ void SdPageObjsTLB::Fill( const SdDrawDo
 	SdPage* 	 pPage = NULL;
 	SvLBoxEntry* pEntry = NULL;
 
-	Bitmap aBmpPage( SdResId( BMP_PAGE ) );
-	Image aImgPage( aBmpPage, aTransparencyColor );
-	Bitmap aBmpPageExcl( SdResId( BMP_PAGE_EXCLUDED ) );
-	Image aImgPageExcl( aBmpPageExcl, aTransparencyColor );
-	Bitmap aBmpPageObjsExcl( SdResId( BMP_PAGEOBJS_EXCLUDED ) );
-	Image aImgPageObjsExcl( aBmpPageObjsExcl, aTransparencyColor );
-	Bitmap aBmpPageObjs( SdResId( BMP_PAGEOBJS ) );
-	Image aImgPageObjs( aBmpPageObjs, aTransparencyColor );
-	Bitmap aBmpObjects( SdResId( BMP_OBJECTS ) );
-	Image aImgObjects( aBmpObjects, aTransparencyColor );
-
-	Bitmap aBmpPageH( SdResId( BMP_PAGE_H ) );
-	Image aImgPageH( aBmpPageH , aTransparencyColor );
-	Bitmap aBmpPageExclH( SdResId( BMP_PAGE_EXCLUDED_H ) );
-	Image aImgPageExclH( aBmpPageExclH, aTransparencyColor );
-	Bitmap aBmpPageObjExclH( SdResId( BMP_PAGEOBJS_EXCLUDED_H ) );
-	Image aImgPageObjsExclH( aBmpPageObjExclH, aTransparencyColor );
-	Bitmap aBmpPageObjsH( SdResId( BMP_PAGEOBJS_H ) );
-	Image aImgPageObjsH( aBmpPageObjsH, aTransparencyColor );
-	Bitmap aBmpObjectsH( SdResId( BMP_OBJECTS_H ) );
-	Image aImgObjectsH( aBmpObjectsH, aTransparencyColor );
+	Image aImgPage( BitmapEx( SdResId( BMP_PAGE ) ) );
+	Image aImgPageExcl( BitmapEx( SdResId( BMP_PAGE_EXCLUDED ) ) );
+	Image aImgPageObjsExcl( BitmapEx( SdResId( BMP_PAGEOBJS_EXCLUDED ) ) );
+	Image aImgPageObjs( BitmapEx( SdResId( BMP_PAGEOBJS ) ) );
+	Image aImgObjects( BitmapEx( SdResId( BMP_OBJECTS ) ) );
+
+	Image aImgPageH( BitmapEx( SdResId( BMP_PAGE_H ) ) );
+	Image aImgPageExclH( BitmapEx( SdResId( BMP_PAGE_EXCLUDED_H ) ) );
+	Image aImgPageObjsExclH( BitmapEx( SdResId( BMP_PAGEOBJS_EXCLUDED_H ) ) );
+	Image aImgPageObjsH( BitmapEx( SdResId( BMP_PAGEOBJS_H ) ) );
+	Image aImgObjectsH( BitmapEx( SdResId( BMP_OBJECTS_H ) ) );
 
 	// Zuerst alle Pages incl. Objekte einfuegen
 	USHORT nPage = 0;
@@ -525,14 +514,10 @@ void SdPageObjsTLB::Fill( const SdDrawDo
 	SvLBoxEntry* pFileEntry = NULL;
 	SvLBoxEntry* pPageEntry = NULL;
 
-	Bitmap aBmpDocOpen( SdResId( BMP_DOC_OPEN ) );
-	Image aImgDocOpen( aBmpDocOpen, aTransparencyColor );
-	Bitmap aBmpDocClosed( SdResId( BMP_DOC_CLOSED ) );
-	Image aImgDocClosed( aBmpDocClosed, aTransparencyColor );
-	Bitmap aBmpDocOpenH( SdResId( BMP_DOC_OPEN_H ) );
-	Image aImgDocOpenH( aBmpDocOpenH, aTransparencyColor );
-	Bitmap aBmpDocClosedH( SdResId( BMP_DOC_CLOSED_H ) );
-	Image aImgDocClosedH( aBmpDocClosedH, aTransparencyColor );
+	Image aImgDocOpen( BitmapEx( SdResId( BMP_DOC_OPEN ) ) );
+	Image aImgDocClosed( BitmapEx( SdResId( BMP_DOC_CLOSED ) ) );
+	Image aImgDocOpenH( BitmapEx( SdResId( BMP_DOC_OPEN_H ) ) );
+	Image aImgDocClosedH( BitmapEx( SdResId( BMP_DOC_CLOSED_H ) ) );
 
 	// Dokumentnamen einfuegen
 	pFileEntry = InsertEntry( aDocName,
@@ -728,18 +713,12 @@ void SdPageObjsTLB::RequestingChilds( Sv
 			SdPage* 	 pPage = NULL;
 			SvLBoxEntry* pPageEntry = NULL;
 
-			Bitmap aBmpPage( SdResId( BMP_PAGE ) );
-			Image aImgPage( aBmpPage, aTransparencyColor );
-			Bitmap aBmpPageObjs( SdResId( BMP_PAGEOBJS ) );
-			Image aImgPageObjs( aBmpPageObjs, aTransparencyColor );
-			Bitmap aBmpObjects( SdResId( BMP_OBJECTS ) );
-			Image aImgObjects( aBmpObjects, aTransparencyColor );
-			Bitmap aBmpPageH( SdResId( BMP_PAGE_H ) );
-			Image aImgPageH( aBmpPageH, aTransparencyColor );
-			Bitmap aBmpPageObjsH( SdResId( BMP_PAGEOBJS_H ) );
-			Image aImgPageObjsH( aBmpPageObjsH, aTransparencyColor );
-			Bitmap aBmpImgObjectsH( SdResId( BMP_OBJECTS_H ) );
-			Image aImgObjectsH( aBmpImgObjectsH, aTransparencyColor );
+			Image aImgPage( BitmapEx( SdResId( BMP_PAGE ) ) );
+			Image aImgPageObjs( BitmapEx( SdResId( BMP_PAGEOBJS ) ) );
+			Image aImgObjects( BitmapEx( SdResId( BMP_OBJECTS ) ) );
+			Image aImgPageH( BitmapEx( SdResId( BMP_PAGE_H ) ) );
+			Image aImgPageObjsH( BitmapEx( SdResId( BMP_PAGEOBJS_H ) ) );
+			Image aImgObjectsH( BitmapEx( SdResId( BMP_OBJECTS_H ) ) );
 
 			// Dokumentname ist schon eingefuegt
 
