--- config_office/configure.in	2005-07-22 17:17:05 +02:00
+++ config_office/configure.in	2005-07-22 11:14:49 +02:00
@@ -120,6 +120,10 @@
 [  --disable-gtk           Determines whether to use Gtk+ vclplug on platforms
                           where Gtk+ is available.
 ],,enable_gtk=yes)
+AC_ARG_ENABLE(cairo,
+[  --disable-cairo         Determines whether to use Cairo canvas backend on platforms
+                          where Cairo is available.
+],,enable_cairo=yes)
 AC_ARG_ENABLE(gnome-vfs,
 [  --disable-gnome-vfs     Determines whether to use the Gnome Virtual Filing
                           System on platforms where that VFS is available
@@ -570,6 +574,7 @@
 	solaris*)
 		test_x=yes
 		test_gtk=yes
+		test_cairo=yes
 		test_kde=yes
 		test_cups=yes
 		_os=SunOS
@@ -596,6 +601,7 @@
 	linux-gnu)
 		test_x=yes
 		test_gtk=yes
+		test_cairo=yes
 		test_kde=yes
 		test_cups=yes
 		if getconf GNU_LIBPTHREAD_VERSION |grep -q NPTL; then
@@ -617,11 +623,13 @@
 		test_x=no
 		test_cups=no
 		test_gtk=no
+		test_cairo=no
 		_os=Darwin
 		;;
 	freebsd*)
 		test_x=yes
 		test_gtk=yes
+		test_cairo=yes
 		test_kde=yes
 		test_cups=yes
 		AC_MSG_CHECKING([the FreeBSD operating system release])
@@ -653,6 +661,7 @@
 	netbsd)
 		test_x=yes
 		test_gtk=yes
+		test_cairo=yes
 		test_kde=yes
 		test_cups=no
 		PTHREAD_CFLAGS="-pthread"
@@ -3680,6 +3689,30 @@
 fi
 AC_SUBST(GTK_CFLAGS)
 AC_SUBST(GTK_LIBS)
+
+dnl ===================================================================
+dnl Check whether the Cairo libraries are available.
+dnl ===================================================================
+
+ENABLE_CAITO=""
+CAIRO_PACKAGES=""
+
+if test  "$test_cairo" = "yes"; then
+
+    if test "x$enable_cairo" = "xyes" ; then
+        ENABLE_CAIRO="TRUE"
+        PKG_CHECK_MODULES(CAIRO, cairo >= 0.5.2)
+	CAIRO_PACKAGES=cairo
+	PKG_CHECK_MODULES(GLITZ, glitz >= 0.4.4, have_glitz="yes", have_glitz="no")
+	PKG_CHECK_MODULES(GLITZ_GLX, glitz-glx >= 0.4.4, have_glitz_glx="yes", have_glitz_glx="no")
+	if test "x$have_glitz" = "xyes" && test "x$have_glitz_glx" = "xyes"; then
+	   CAIRO_PACKAGES="$CAIRO_PACKAGES glitz glitz-glx"
+	fi
+    fi
+fi
+
+AC_SUBST(ENABLE_CAIRO)
+AC_SUBST(CAIRO_PACKAGES)
 
 dnl ===================================================================
 dnl Check whether the Qt and KDE libraries are available.
--- config_office/set_soenv.in	2005-07-22 17:17:05 +02:00
+++ config_office/set_soenv.in	2005-07-22 11:15:08 +02:00
@@ -1484,6 +1484,8 @@
 ToFile( "GTK_CFLAGS",        "@GTK_CFLAGS@",       "e" );
 ToFile( "GTK_LIBS",          "@GTK_LIBS@",         "e" );
 ToFile( "ENABLE_STATIC_GTK", "@ENABLE_STATIC_GTK@", "e" );
+ToFile( "ENABLE_CAIRO",      "@ENABLE_CAIRO@",     "e" );
+ToFile( "CAIRO_PACKAGES",    "@CAIRO_PACKAGES@",   "e" );
 ToFile( "ENABLE_GNOMEVFS",   "@ENABLE_GNOMEVFS@",  "e" );
 ToFile( "ENABLE_KDE",        "@ENABLE_KDE@",       "e" );
 ToFile( "KDE_CFLAGS",        "@KDE_CFLAGS@",       "e" );
