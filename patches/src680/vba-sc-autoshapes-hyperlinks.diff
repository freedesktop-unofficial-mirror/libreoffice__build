--- xmloff/inc/xmloff/shapeexport.hxx	2007-07-06 14:27:43.000000000 +0200
+++ xmloff/inc/xmloff/shapeexport.hxx	2007-07-12 10:34:49.000000000 +0200
@@ -231,11 +231,9 @@ private:
 	const rtl::OUString							msStartShape;
 	const rtl::OUString							msEndShape;
 	const rtl::OUString							msOnClick;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 	const rtl::OUString							msOnAction;
 	const rtl::OUString							msAction;
 	const rtl::OUString							msURL;
-#endif
 	const rtl::OUString							msEventType;
 	const rtl::OUString							msPresentation;
 	const rtl::OUString							msMacroName;
--- xmloff/source/draw/eventimp.cxx	2007-07-06 14:27:59.000000000 +0200
+++ xmloff/source/draw/eventimp.cxx	2007-07-12 10:35:30.000000000 +0200
@@ -147,9 +147,7 @@ public:
 
 	sal_Bool mbValid;
 	sal_Bool mbScript;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     sal_Bool mbActionEvent;
-#endif
 	ClickAction meClickAction;
 	XMLEffect meEffect;
 	XMLEffectDirection meDirection;
@@ -161,9 +159,7 @@ public:
 	OUString msMacroName;
 	OUString msBookmark;
 	OUString msLanguage;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     OUString msHyperURL;
-#endif
 };
 
 ///////////////////////////////////////////////////////////////////////
@@ -222,18 +218,12 @@ TYPEINIT1( SdXMLEventContext, SvXMLImpor
 
 SdXMLEventContext::SdXMLEventContext( SvXMLImport& rImp,  sal_uInt16 nPrfx, const OUString& rLocalName,  const Reference< XAttributeList >& xAttrList, const Reference< XShape >& rxShape )
 :	SvXMLImportContext(rImp, nPrfx, rLocalName),
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     mxShape( rxShape ), mbScript( sal_False ), mbActionEvent( sal_False ), meClickAction( ClickAction_NONE ),
-#else
-    mxShape( rxShape ), mbScript( sal_False ), meClickAction( ClickAction_NONE ),
-#endif
 	meEffect( EK_none ), meDirection( ED_none ), mnStartScale( 100 ),
 	meSpeed( AnimationSpeed_MEDIUM ), mnVerb(0), mbPlayFull( sal_False )
 {
     static const OUString sXMLClickName( RTL_CONSTASCII_USTRINGPARAM( "click" ) );
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     static const OUString sXMLActionName( RTL_CONSTASCII_USTRINGPARAM( "action" ) );
-#endif
 
     if( nPrfx == XML_NAMESPACE_PRESENTATION && IsXMLToken( rLocalName, XML_EVENT_LISTENER ) )
 	{
@@ -304,12 +294,8 @@ SdXMLEventContext::SdXMLEventContext( Sv
 				sEventName = sValue;
 				sal_uInt16 nScriptPrefix =
 					GetImport().GetNamespaceMap().GetKeyByAttrName( sValue, &sEventName );
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                 mbValid = XML_NAMESPACE_DOM == nScriptPrefix && ( sEventName == sXMLClickName || sEventName == sXMLActionName );
                 mbActionEvent = mbValid && (sEventName == sXMLActionName);
-#else
-                mbValid = XML_NAMESPACE_DOM == nScriptPrefix && sEventName == sXMLClickName;
-#endif
 			}
 			else if( IsXMLToken( aAttrLocalName, XML_LANGUAGE ) )
 			{
@@ -338,12 +324,10 @@ SdXMLEventContext::SdXMLEventContext( Sv
 				{
 					msMacroName = sValue;
 				}
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                 else if ( mbActionEvent )
                 {
                     msHyperURL = sValue;
                 }
-#endif
 				else
 				{
 					const rtl::OUString &rTmp =
@@ -389,7 +373,6 @@ void SdXMLEventContext::EndElement()
         OUString sAPIEventName;
         uno::Sequence< beans::PropertyValue > aProperties;
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         if( mbActionEvent )
         {
             sAPIEventName = OUString( RTL_CONSTASCII_USTRINGPARAM( "OnAction" ) );
@@ -407,7 +390,6 @@ void SdXMLEventContext::EndElement()
             pProperty->State = beans::PropertyState_DIRECT_VALUE;
         }
         else
-#endif
         {
             sAPIEventName = OUString( RTL_CONSTASCII_USTRINGPARAM( "OnClick" ) );
 
--- xmloff/source/draw/shapeexport.cxx	2007-07-06 14:28:14.000000000 +0200
+++ xmloff/source/draw/shapeexport.cxx	2007-07-12 10:35:38.000000000 +0200
@@ -161,11 +161,9 @@ XMLShapeExport::XMLShapeExport(SvXMLExpo
 	msStartShape( RTL_CONSTASCII_USTRINGPARAM("StartShape") ),
 	msEndShape( RTL_CONSTASCII_USTRINGPARAM("EndShape") ),
 	msOnClick( RTL_CONSTASCII_USTRINGPARAM("OnClick") ),
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 	msOnAction( RTL_CONSTASCII_USTRINGPARAM("OnAction") ),
 	msAction( RTL_CONSTASCII_USTRINGPARAM("Action") ),
 	msURL( RTL_CONSTASCII_USTRINGPARAM("URL") ),
-#endif
 	msEventType( RTL_CONSTASCII_USTRINGPARAM("EventType") ),
 	msPresentation( RTL_CONSTASCII_USTRINGPARAM("Presentation") ),
 	msMacroName( RTL_CONSTASCII_USTRINGPARAM("MacroName") ),
--- xmloff/source/draw/shapeexport2.cxx	2007-07-06 14:28:29.000000000 +0200
+++ xmloff/source/draw/shapeexport2.cxx	2007-07-12 10:36:02.000000000 +0200
@@ -371,9 +371,7 @@ const sal_Int32 FOUND_CLICKEVENTTYPE    
 const sal_Int32 FOUND_MACRO             = 0x00000100;
 const sal_Int32 FOUND_LIBRARY           = 0x00000200;
 const sal_Int32 FOUND_ACTIONEVENTTYPE   = 0x00000400;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 const sal_Int32 FOUND_URL               = 0x00000800;
-#endif
 
 } // namespace
 
@@ -463,7 +461,6 @@ void XMLShapeExport::ImpExportEvents( co
         }
     }
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     // extract properties from "OnAction" event -------------------------------
 
     OUString aActionEventType;
@@ -488,7 +485,6 @@ void XMLShapeExport::ImpExportEvents( co
             }
         }
     }
-#endif
 
     // create the XML elements
 
@@ -641,15 +637,9 @@ void XMLShapeExport::ImpExportEvents( co
             SvXMLElementExport aEventElemt(mrExport, XML_NAMESPACE_SCRIPT, XML_EVENT_LISTENER, sal_True, sal_True);
         }
     }
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     else if( aClickEventType == msScript || aActionEventType == msAction )
     {
         if( nFound & ( FOUND_MACRO | FOUND_URL ) )
-#else
-    else if( aClickEventType == msScript )
-    {
-        if( nFound & FOUND_MACRO )
-#endif
         {
             SvXMLElementExport aEventsElemt(mrExport, XML_NAMESPACE_OFFICE, XML_EVENT_LISTENERS, sal_True, sal_True);
             if ( nFound & FOUND_MACRO )
@@ -664,7 +654,6 @@ void XMLShapeExport::ImpExportEvents( co
 
                 SvXMLElementExport aEventElemt(mrExport, XML_NAMESPACE_SCRIPT, XML_EVENT_LISTENER, sal_True, sal_True);
             }
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
             if ( nFound & FOUND_URL )
             {
                 OUString aEventQName(
@@ -675,7 +664,6 @@ void XMLShapeExport::ImpExportEvents( co
 
                 SvXMLElementExport aEventElemt(mrExport, XML_NAMESPACE_PRESENTATION, XML_EVENT_LISTENER, sal_True, sal_True);
             }
-#endif
         }
     }
 }
--- sc/inc/sc.hrc	2007-07-12 10:26:02.000000000 +0200
+++ sc/inc/sc.hrc	2007-07-12 10:36:44.000000000 +0200
@@ -583,11 +583,9 @@
 // #i59082# assign macro to shape
 #define SID_ASSIGNMACRO                 (SC_VIEW_START + 95)
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 // #i66550# hyperlinks in shapes
 #define SID_DRAW_HLINK_EDIT             (SC_VIEW_START + 96)
 #define SID_DRAW_HLINK_DELETE           (SC_VIEW_START + 97)
-#endif
 
 // NOTE: last valid ID is (SC_VIEW_START + 99)
 
--- sc/inc/userdat.hxx	2007-07-06 14:31:41.000000000 +0200
+++ sc/inc/userdat.hxx	2007-07-12 10:36:54.000000000 +0200
@@ -117,16 +117,12 @@ public:
     void            SetMacro( const rtl::OUString& rMacro ) { maMacro = rMacro; }
     const rtl::OUString& GetMacro() const { return maMacro; }
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     void            SetHlink( const rtl::OUString& rHlink ) { maHlink = rHlink; }
     const rtl::OUString& GetHlink() const { return maHlink; }
-#endif
 
 private:
     rtl::OUString   maMacro;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     rtl::OUString   maHlink;
-#endif
 };
 
 //-------------------------------------------------------------------------
--- sc/sdi/drawsh.sdi	2007-07-06 14:31:54.000000000 +0200
+++ sc/sdi/drawsh.sdi	2007-07-12 10:37:24.000000000 +0200
@@ -232,10 +232,9 @@ interface TableDraw
 	SID_FONTWORK_KERN_CHARACTER_PAIRS		[ ExecMethod = ExecDrawFunc ; StateMethod = GetDrawFuncState ; ]
     SID_FONTWORK_CHARACTER_SPACING_DIALOG	[ ExecMethod = ExecDrawFunc ; StateMethod = GetDrawFuncState ; ]
 
-// ISSUE66550_HLINK_FOR_SHAPES
-//    SID_DRAW_HLINK_EDIT             [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
-//    SID_DRAW_HLINK_DELETE           [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
-//    SID_OPEN_HYPERLINK              [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
+    SID_DRAW_HLINK_EDIT             [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
+    SID_DRAW_HLINK_DELETE           [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
+    SID_OPEN_HYPERLINK              [ ExecMethod = ExecDrawAttr; StateMethod = GetDrawFuncState; Export = FALSE; ]
 }
 
 
--- sc/sdi/scalc.sdi	2007-07-12 10:26:02.000000000 +0200
+++ sc/sdi/scalc.sdi	2007-07-12 10:37:51.000000000 +0200
@@ -6351,56 +6351,54 @@ SfxVoidItem StandardFonts SID_STANDARD_F
 ]
 
 //--------------------------------------------------------------------------
-// ISSUE66550_HLINK_FOR_SHAPES
-//SfxVoidItem EditShapeHyperlink SID_DRAW_HLINK_EDIT
-//()
-//[
-//   /* flags: */
-//   AutoUpdate = FALSE,
-//   Cachable = Cachable,
-//   FastCall = TRUE,
-//   HasCoreId = FALSE,
-//   HasDialog = TRUE,
-//   ReadOnlyDoc = TRUE,
-//   Toggle = FALSE,
-//   Container = FALSE,
-//   RecordAbsolute = FALSE,
-//   RecordPerSet;
-//   Synchron;
-//
-//   /* config: */
-//   AccelConfig = TRUE,
-//   MenuConfig = FALSE,
-//   StatusBarConfig = FALSE,
-//   ToolBoxConfig = FALSE,
-//   GroupId = GID_DRAWING;
-//]
-
-//--------------------------------------------------------------------------
-// ISSUE66550_HLINK_FOR_SHAPES
-//SfxVoidItem DeleteShapeHyperlink SID_DRAW_HLINK_DELETE
-//()
-//[
-//   /* flags: */
-//   AutoUpdate = TRUE,
-//   Cachable = Cachable,
-//   FastCall = TRUE,
-//   HasCoreId = FALSE,
-//   HasDialog = FALSE,
-//   ReadOnlyDoc = TRUE,
-//   Toggle = FALSE,
-//   Container = FALSE,
-//   RecordAbsolute = FALSE,
-//   RecordPerSet;
-//   Synchron;
-//
-//   /* config: */
-//   AccelConfig = TRUE,
-//   MenuConfig = FALSE,
-//   StatusBarConfig = FALSE,
-//   ToolBoxConfig = FALSE,
-//   GroupId = GID_DRAWING;
-//]
+SfxVoidItem EditShapeHyperlink SID_DRAW_HLINK_EDIT
+()
+[
+   /* flags: */
+   AutoUpdate = FALSE,
+   Cachable = Cachable,
+   FastCall = TRUE,
+   HasCoreId = FALSE,
+   HasDialog = TRUE,
+   ReadOnlyDoc = TRUE,
+   Toggle = FALSE,
+   Container = FALSE,
+   RecordAbsolute = FALSE,
+   RecordPerSet;
+   Synchron;
+
+   /* config: */
+   AccelConfig = TRUE,
+   MenuConfig = FALSE,
+   StatusBarConfig = FALSE,
+   ToolBoxConfig = FALSE,
+   GroupId = GID_DRAWING;
+]
+
+//--------------------------------------------------------------------------
+SfxVoidItem DeleteShapeHyperlink SID_DRAW_HLINK_DELETE
+()
+[
+   /* flags: */
+   AutoUpdate = TRUE,
+   Cachable = Cachable,
+   FastCall = TRUE,
+   HasCoreId = FALSE,
+   HasDialog = FALSE,
+   ReadOnlyDoc = TRUE,
+   Toggle = FALSE,
+   Container = FALSE,
+   RecordAbsolute = FALSE,
+   RecordPerSet;
+   Synchron;
+
+   /* config: */
+   AccelConfig = TRUE,
+   MenuConfig = FALSE,
+   StatusBarConfig = FALSE,
+   ToolBoxConfig = FALSE,
+   GroupId = GID_DRAWING;
+]
 
 //--------------------------------------------------------------------------
 SfxVoidItem StandardTextAttributes SID_TEXT_STANDARD
--- sc/source/filter/excel/xiescher.cxx	2007-07-06 14:37:20.000000000 +0200
+++ sc/source/filter/excel/xiescher.cxx	2007-07-12 10:38:07.000000000 +0200
@@ -1693,19 +1693,13 @@ SdrObject* XclImpDffManager::ProcessObj(
     {
         // macro name and hyperlink for drawing objects and pictures (not for controls and charts)
         const String& rMacro = xDrawObj->GetMacroName();
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         OUString aHlink = ReadHlinkProperty( rEscherStrm );
         if( (rMacro.Len() > 0) || (aHlink.getLength() > 0) )
-#else
-        if( rMacro.Len() > 0 )
-#endif
         {
             if( ScMacroInfo* pInfo = ScDrawLayer::GetMacroInfo( xSdrObj.get(), TRUE ) )
             {
                 pInfo->SetMacro( XclControlObjHelper::GetScMacroName( rMacro ) );
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                 pInfo->SetHlink( aHlink );
-#endif
             }
         }
     }
--- sc/source/ui/drawfunc/drawsh.cxx	2007-07-06 14:42:27.000000000 +0200
+++ sc/source/ui/drawfunc/drawsh.cxx	2007-07-12 10:38:23.000000000 +0200
@@ -218,7 +218,6 @@ void ScDrawShell::ExecDrawAttr( SfxReque
 			ExecuteTextAttrDlg( rReq );
 			break;
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         case SID_DRAW_HLINK_EDIT:
             if ( pSingleSelectedObj )
                 pViewData->GetDispatcher().Execute( SID_HYPERLINK_DIALOG );
@@ -246,7 +245,6 @@ void ScDrawShell::ExecDrawAttr( SfxReque
                     ScGlobal::OpenURL( pInfo->GetHlink(), String::EmptyString() );
             }
             break;
-#endif
 
 		case SID_ATTR_TRANSFORM:
 			{
@@ -498,7 +496,6 @@ void ScDrawShell::ExecuteTextAttrDlg( Sf
 	delete( pDlg );
 }
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 void ScDrawShell::SetHlinkForObject( SdrObject* pObj, const rtl::OUString& rHlnk )
 {
     if ( pObj )
@@ -508,5 +505,4 @@ void ScDrawShell::SetHlinkForObject( Sdr
         lcl_setModified( GetObjectShell() );
     }
 }
-#endif
 
--- sc/source/ui/drawfunc/drawsh2.cxx	2007-07-06 14:42:40.000000000 +0200
+++ sc/source/ui/drawfunc/drawsh2.cxx	2007-07-12 10:38:38.000000000 +0200
@@ -209,24 +209,20 @@ void ScDrawShell::GetDrawFuncState( SfxI
 	BOOL bCanRename = FALSE;
     if ( nMarkCount > 1 )
     {
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         // no hypelink options for a selected group
         rSet.DisableItem( SID_DRAW_HLINK_EDIT );
         rSet.DisableItem( SID_DRAW_HLINK_DELETE );
         rSet.DisableItem( SID_OPEN_HYPERLINK );
-#endif
     }
     else if ( nMarkCount == 1 )
 	{
         SdrObject* pObj = rMarkList.GetMark( 0 )->GetMarkedSdrObj();
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         ScMacroInfo* pInfo = ScDrawLayer::GetMacroInfo( pObj );
         if ( !pInfo || (pInfo->GetHlink().getLength() == 0) )
         {
             rSet.DisableItem( SID_DRAW_HLINK_DELETE );
             rSet.DisableItem( SID_OPEN_HYPERLINK );
         }
-#endif
         SdrLayerID nLayerID = pObj->GetLayer();
         if ( nLayerID != SC_LAYER_INTERN )
             bCanRename = TRUE;                          // #i51351# anything except internal objects can be renamed
--- sc/source/ui/drawfunc/drawsh5.cxx	2007-07-06 14:42:53.000000000 +0200
+++ sc/source/ui/drawfunc/drawsh5.cxx	2007-07-12 10:38:49.000000000 +0200
@@ -103,14 +103,12 @@ void ScDrawShell::GetHLinkState( SfxItem
     if ( nMarkCount == 1 )              // URL-Button markiert ?
     {
         SdrObject* pObj = rMarkList.GetMark(0)->GetMarkedSdrObj();
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         ScMacroInfo* pInfo = ScDrawLayer::GetMacroInfo( pObj );
         if ( pInfo && (pInfo->GetHlink().getLength() > 0) )
         {
             aHLinkItem.SetURL( pInfo->GetHlink() );
             aHLinkItem.SetInsertMode(HLINK_FIELD);
         }
-#endif
         SdrUnoObj* pUnoCtrl = PTR_CAST(SdrUnoObj, pObj);
         if (pUnoCtrl && FmFormInventor == pUnoCtrl->GetObjInventor())
         {
@@ -253,13 +251,11 @@ void ScDrawShell::ExecuteHLink( SfxReque
                                     bDone = TRUE;
                                 }
                             }
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                             else
                             {
                                 SetHlinkForObject( pObj, rURL );
                                 bDone = TRUE;
                             }
-#endif
                         }
                     }
 
--- sc/source/ui/drawfunc/fudraw.cxx	2007-07-06 14:43:05.000000000 +0200
+++ sc/source/ui/drawfunc/fudraw.cxx	2007-07-12 10:38:57.000000000 +0200
@@ -899,11 +899,7 @@ void FuDraw::ForcePointer(const MouseEve
 			SdrObjMacroHitRec aHitRec;	//! muss da noch irgendwas gesetzt werden ????
 			pViewShell->SetActivePointer( pObj->GetMacroPointer(aHitRec) );
 		}
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         else if ( !bAlt && pInfo && ((pInfo->GetMacro().getLength() > 0) || (pInfo->GetHlink().getLength() > 0)) )
-#else
-        else if ( !bAlt && pInfo && (pInfo->GetMacro().getLength() > 0) )
-#endif
 			pWindow->SetPointer( Pointer( POINTER_REFHAND ) );
 		else if ( IsDetectiveHit( aPnt ) )
 			pViewShell->SetActivePointer( Pointer( POINTER_DETECTIVE ) );
--- sc/source/ui/drawfunc/fusel.cxx	2007-07-06 14:43:18.000000000 +0200
+++ sc/source/ui/drawfunc/fusel.cxx	2007-07-12 10:39:06.000000000 +0200
@@ -210,7 +210,6 @@ BOOL __EXPORT FuSelection::MouseButtonDo
                    }
 
                    ScMacroInfo* pInfo = ScDrawLayer::GetMacroInfo( pObj, TRUE );
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                    // For interoperability favour links over macros if both are defined
                    if ( pInfo->GetHlink().getLength() > 0 )
                    {
@@ -218,9 +217,6 @@ BOOL __EXPORT FuSelection::MouseButtonDo
                        sURL = pInfo->GetHlink();
                    }
                    else if ( pInfo->GetMacro().getLength() > 0 )
-#else
-                   if ( pInfo->GetMacro().getLength() > 0 )
-#endif
                    {
                        SfxObjectShell* pObjSh = SfxObjectShell::Current();
                        if ( pObjSh && SfxApplication::IsXScriptURL( pInfo->GetMacro() ) )
--- sc/source/ui/drawfunc/objdraw.src	2007-07-06 14:43:31.000000000 +0200
+++ sc/source/ui/drawfunc/objdraw.src	2007-07-12 10:39:29.000000000 +0200
@@ -190,7 +190,6 @@
         ITEM_FORMAT_PARA_DLG\
     };
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 #define MN_EDITLNK \
     MenuItem\
     {\
@@ -206,7 +205,6 @@
         HelpID = SID_DRAW_HLINK_DELETE ; \
         Text [ en-US ] = "~Remove Hyperlink" ; \
 	};
-#endif
 
 #define MN_DRWTXTATTR \
     MenuItem\
@@ -1299,14 +1297,12 @@ Menu RID_POPUP_DRAW
 		MenuItem { Separator = TRUE ; };
 		 //------------------------------
 		ITEM_GROUP_MENU
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 		 //------------------------------
 		MenuItem { Separator = TRUE ; };
 		 //------------------------------
 		MN_EDITLNK
 		MN_DELLNK
         MenuItem { ITEM_OPEN_HYPERLINK };
-#endif
 	};
 };
 
@@ -1376,14 +1372,12 @@ Menu RID_POPUP_GRAPHIC
 		MenuItem { Separator = TRUE ; };
 		 //------------------------------
 		ITEM_GROUP_MENU
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 		 //------------------------------
 		MenuItem { Separator = TRUE ; };
 		 //------------------------------
 		MN_EDITLNK
 		MN_DELLNK
         MenuItem { ITEM_OPEN_HYPERLINK };
-#endif
 	};
 };
 
--- sc/source/ui/inc/drawsh.hxx	2007-07-06 14:44:12.000000000 +0200
+++ sc/source/ui/inc/drawsh.hxx	2007-07-12 10:39:35.000000000 +0200
@@ -62,9 +62,7 @@ class ScDrawShell : public SfxShell
 
     DECL_LINK( NameObjectHdl, AbstractSvxNameDialog* );
 
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
     void SetHlinkForObject( SdrObject* pObj, const rtl::OUString& rHlnk );
-#endif
 
 protected:
 	ScViewData*	GetViewData()	{ return pViewData; }
--- sc/source/ui/unoobj/shapeuno.cxx	2007-07-06 14:46:13.000000000 +0200
+++ sc/source/ui/unoobj/shapeuno.cxx	2007-07-12 10:40:10.000000000 +0200
@@ -1332,11 +1332,9 @@ SdrObject* ScShapeObj::GetSdrObject() co
 }
 
 #define SC_EVENTACC_ONCLICK     ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OnClick" ) )
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
 #define SC_EVENTACC_ONACTION    ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OnAction" ) )
 #define SC_EVENTACC_URL         ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "URL" ) )
 #define SC_EVENTACC_ACTION      ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "Action" ) )
-#endif
 #define SC_EVENTACC_SCRIPT      ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "Script" ) )
 #define SC_EVENTACC_EVENTTYPE   ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "EventType" ) )
 
@@ -1377,11 +1375,7 @@ public:
 				isEventType = true;
 				continue;
 			}
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
             if ( isEventType && ((pProperties->Name == SC_EVENTACC_SCRIPT) || (pProperties->Name == SC_EVENTACC_URL)) )
-#else
-            if ( isEventType && (pProperties->Name == SC_EVENTACC_SCRIPT) )
-#endif
 			{
                 rtl::OUString sValue;
                 if ( pProperties->Value >>= sValue )
@@ -1392,10 +1386,8 @@ public:
                         break;
                     if ( pProperties->Name == SC_EVENTACC_SCRIPT )
                         pInfo->SetMacro( sValue );
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                     else
                         pInfo->SetHlink( sValue );
-#endif
                 }
 			}
 		}
@@ -1418,7 +1410,6 @@ public:
                 aProperties[ 1 ].Value <<= pInfo->GetMacro();
             }
         }
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         else if( aName == SC_EVENTACC_ONACTION )
         {
             if ( pInfo && (pInfo->GetHlink().getLength() > 0) )
@@ -1430,7 +1421,6 @@ public:
                 aProperties[ 1 ].Value <<= pInfo->GetHlink();
             }
         }
-#endif
         else
         {
             throw container::NoSuchElementException();
@@ -1441,25 +1431,15 @@ public:
 
     virtual uno::Sequence< rtl::OUString > SAL_CALL getElementNames() throw(uno::RuntimeException)
 	{
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         uno::Sequence< rtl::OUString > aSeq( 2 );
-#else
-        uno::Sequence< rtl::OUString > aSeq( 1 );
-#endif
         aSeq[ 0 ] = SC_EVENTACC_ONCLICK;
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         aSeq[ 1 ] = SC_EVENTACC_ONACTION;
-#endif
         return aSeq;
 	}
 
 	virtual sal_Bool SAL_CALL hasByName( const rtl::OUString& aName ) throw(uno::RuntimeException)
 	{
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
         return (aName == SC_EVENTACC_ONCLICK) || (aName == SC_EVENTACC_ONACTION);
-#else
-        return aName == SC_EVENTACC_ONCLICK;
-#endif
 	}
 
 	// XElementAccess
--- sc/source/ui/view/gridwin5.cxx	2007-07-06 14:46:43.000000000 +0200
+++ sc/source/ui/view/gridwin5.cxx	2007-07-12 10:40:18.000000000 +0200
@@ -359,14 +359,12 @@ void ScGridWindow::RequestHelp(const Hel
                                     if ( pDrView->PickObj(aMDPos, pHit, pPV, SDRSEARCH_DEEP ) )
                                         pObj = pHit;
                             }
-#ifdef ISSUE66550_HLINK_FOR_SHAPES
                             ScMacroInfo* pInfo = ScDrawLayer::GetMacroInfo( pObj );
                             if ( pInfo && (pInfo->GetHlink().getLength() > 0) )
                             {
                                 aPixRect = LogicToPixel(aVEvt.pObj->GetLogicRect());
                                 aHelpText = pInfo->GetHlink();
                             }
-#endif
                         }
                     }
                 }
