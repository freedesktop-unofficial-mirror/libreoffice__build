--- sc/uiconfig/scalc/accelerator/en-US/default.xml	2005-10-13 22:06:08.000000000 +0530
+++ sc/uiconfig/scalc/accelerator/en-US/default.xml	2005-10-17 23:07:58.000000000 +0530
@@ -97,6 +97,7 @@
 	<accel:item accel:code="KEY_T" accel:shift="true" accel:mod1="true" xlink:href=".uno:FocusCellAddress"/>
 	<accel:item accel:code="KEY_F5" accel:shift="true" accel:mod1="true" xlink:href=".uno:FocusCellAddress"/>
     <accel:item accel:code="KEY_SPACE" accel:mod1="true" accel:shift="true" xlink:href=".uno:ResetAttributes"/>
 	<accel:item accel:code="KEY_J" accel:shift="true" accel:mod1="true" xlink:href=".uno:FullScreen"/>
+	<accel:item accel:code="KEY_QUOTELEFT" accel:mod1="true" xlink:href=".uno:ToggleFormula"/>
 </accel:acceleratorlist>
--- sc/source/ui/view/tabvwsh3.cxx	2004-10-05 01:55:55.000000000 +0530
+++ sc/source/ui/view/tabvwsh3.cxx	2005-10-18 07:47:16.668501384 +0530
@@ -602,6 +602,28 @@ void ScTabViewShell::Execute( SfxRequest
 				rReq.Done();
 			}
 			break;
+		case FID_TOGGLEFORMULA:
+			{
+				ScViewData* pViewData = GetViewData();
+				const ScViewOptions& rOpts = pViewData->GetOptions();
+				BOOL bFormulaMode = !rOpts.GetOption( VOPT_FORMULAS );
+				const SfxPoolItem *pItem;
+				if( pReqArgs && pReqArgs->GetItemState(nSlot, TRUE, &pItem) == SFX_ITEM_SET )
+					bFormulaMode = ((const SfxBoolItem *)pItem)->GetValue();
+
+
+				ScViewOptions rSetOpts = ScViewOptions( rOpts );
+	   			rSetOpts.SetOption( VOPT_FORMULAS, bFormulaMode );
+				pViewData->SetOptions( rSetOpts );
+	
+				pViewData->GetDocShell()->PostPaintGridAll();
+
+				rBindings.Invalidate( FID_TOGGLEFORMULA );
+                rReq.AppendItem( SfxBoolItem( nSlot, bFormulaMode ) );
+				rReq.Done();
+			}
+			break;
+			
 		case FID_TOGGLEINPUTLINE:
 			{
 				USHORT			nId  = ScInputWindowWrapper::GetChildWindowId();
--- sc/source/ui/view/tabvwsha.cxx	2005-01-28 22:53:33.000000000 +0530
+++ sc/source/ui/view/tabvwsha.cxx	2005-10-17 23:13:34.000000000 +0530
@@ -322,6 +322,14 @@ void __EXPORT ScTabViewShell::GetState( 
 			case FID_TOGGLEHEADERS:
 				rSet.Put(SfxBoolItem(nWhich, GetViewData()->IsHeaderMode()));
 				break;
+			case FID_TOGGLEFORMULA:
+				{
+					ScViewData* pViewData = GetViewData();
+					const ScViewOptions& rOpts = pViewData->GetOptions();
+					BOOL bFormulaMode = rOpts.GetOption( VOPT_FORMULAS );
+					rSet.Put(SfxBoolItem(nWhich, bFormulaMode ));
+				}
+				break;
 
             case FID_NORMALVIEWMODE:
 			case FID_PAGEBREAKMODE:
--- sc/sdi/scalc.sdi	2005-10-13 22:06:00.000000000 +0530
+++ sc/sdi/scalc.sdi	2005-10-16 12:54:46.000000000 +0530
@@ -7343,6 +7343,34 @@ SfxBoolItem ViewRowColumnHeaders FID_TOG
 ]
 
 //--------------------------------------------------------------------------
+SfxBoolItem ToggleFormula	FID_TOGGLEFORMULA
+
+[
+	/* flags */
+	AutoUpdate = FALSE,
+	Cachable = Cachable,
+	FastCall = FALSE,
+	HasCoreId = FALSE,
+	HasDialog = FALSE,
+	ReadOnlyDoc = TRUE,
+	Toggle = FALSE,
+	Container = FALSE,
+	RecordAbsolute = FALSE,
+	RecordPerSet;
+	Synchron;
+
+	Readonly = FALSE,
+
+	/* config */
+	AccelConfig = TRUE,
+	MenuConfig = FALSE,
+	StatusBarConfig = FALSE,
+	ToolBoxConfig = FALSE,
+	GroupId = GID_VIEW
+
+]
+
+//--------------------------------------------------------------------------
 SfxBoolItem ViewValueHighlighting FID_TOGGLESYNTAX
 
 [
--- sc/sdi/tabvwsh.sdi	2004-11-15 22:02:50.000000000 +0530
+++ sc/sdi/tabvwsh.sdi	2005-10-16 12:21:59.000000000 +0530
@@ -215,6 +215,7 @@ interface TableEditView : View
 	FID_SCALESTATUS		[ ExecMethod = Execute; StateMethod = GetState; ]
 	FID_TOGGLESYNTAX    [ ExecMethod = Execute; StateMethod = GetState; ]
 	FID_TOGGLEHEADERS	[ ExecMethod = Execute; StateMethod = GetState; ]
+	FID_TOGGLEFORMULA	[ ExecMethod = Execute; StateMethod = GetState; ]
 	FID_NORMALVIEWMODE	[ ExecMethod = Execute; StateMethod = GetState; ]
 	FID_PAGEBREAKMODE	[ ExecMethod = Execute; StateMethod = GetState; ]
 	SID_REPAINT			[ ExecMethod = Execute; StateMethod = GetState; ]
--- sc/inc/sc.hrc	2005-10-13 22:06:00.000000000 +0530
+++ sc/inc/sc.hrc	2005-10-16 13:33:48.000000000 +0530
@@ -711,6 +711,7 @@
 //#define FID_CHG_MERGE			(VIEW_MENU_START + 17)// DANGER DIRTY ID
 #define	FID_CHG_ACCEPT			(VIEW_MENU_START + 18)// DANGER DIRTY ID
 #define	FID_CHG_COMMENT			(VIEW_MENU_START + 19)// DANGER DIRTY ID
+#define FID_TOGGLEFORMULA		(VIEW_MENU_START + 16)
 #define VIEW_MENU_END			(VIEW_MENU_START + 20)
 
 #define INSERT_MENU_START		(VIEW_MENU_END)
