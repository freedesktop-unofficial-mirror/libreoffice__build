--- config_office/configure.in.old	2006-01-02 19:41:36.000000000 +0100
+++ config_office/configure.in	2006-01-04 10:08:01.000000000 +0100
@@ -2999,6 +2999,8 @@
     CPPFLAGS="$save_CPPFLAGS"
     LIBS="$save_LIBS"
 
+    PKG_CHECK_MODULES( MOZ_PLUGIN, $moz_flavour-plugin )
+
     MOZ_INC=`$PKG_CONFIG --variable=includedir $moz_flavour-xpcom`
     MOZ_LIB=`$PKG_CONFIG --variable=libdir $moz_flavour-xpcom`
     MOZ_LIB_XPCOM=$MOZILLAXPCOM_LIBS
@@ -3113,6 +3115,7 @@
 AC_SUBST(MOZ_LIB_XPCOM)
 AC_SUBST(MOZ_NSPR_CFLAGS)
 AC_SUBST(MOZ_NSS_CFLAGS)
+AC_SUBST(MOZ_PLUGIN_CFLAGS)
 AC_SUBST(MOZ_LDAP_CFLAGS)
 AC_SUBST(MOZ_NSS_HACK)
 
--- config_office/set_soenv.in.old	2006-01-02 19:41:36.000000000 +0100
+++ config_office/set_soenv.in	2006-01-04 10:12:12.000000000 +0100
@@ -1735,6 +1735,7 @@
 ToFile( "MOZ_LIB_XPCOM",     "@MOZ_LIB_XPCOM@",    "e" );
 ToFile( "MOZ_NSPR_CFLAGS",   "@MOZ_NSPR_CFLAGS@",  "e" );
 ToFile( "MOZ_NSS_CFLAGS",    "@MOZ_NSS_CFLAGS@",   "e" );
+ToFile( "MOZ_PLUGIN_CFLAGS", "@MOZ_PLUGIN_CFLAGS@","e" );
 ToFile( "MOZ_LDAP_CFLAGS",   "@MOZ_LDAP_CFLAGS@",  "e" );
 ToFile( "MOZ_NSS_HACK",      "@MOZ_NSS_HACK@",     "e" );
 ToFile( "WITH_FONTS",        "@WITH_FONTS@",       "e" );
--- extensions/source/plugin/util/makefile.pmk.old	2005-12-21 12:14:30.000000000 +0100
+++ extensions/source/plugin/util/makefile.pmk	2006-01-04 10:31:26.000000000 +0100
@@ -40,7 +40,6 @@
 .INCLUDE :  sv.mk
 
 .IF "$(SYSTEM_MOZILLA)" == "YES"
+INCPRE+=$(MOZ_PLUGIN_CFLAGS)
 CFLAGS+=-DSYSTEM_MOZILLA
-PKGCONFIG_MODULES=mozilla-plugin
-.INCLUDE : pkg_config.mk
 .ENDIF
