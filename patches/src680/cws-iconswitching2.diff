Index: svtools/inc/imgdef.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/imgdef.hxx,v
retrieving revision 1.4
retrieving revision 1.4.16.1
diff -u -p -u -p -r1.4 -r1.4.16.1
--- svtools/inc/imgdef.hxx	5 Jan 2006 18:12:35 -0000	1.4
+++ svtools/inc/imgdef.hxx	16 Jan 2006 18:20:53 -0000	1.4.16.1
@@ -48,8 +48,8 @@ enum SfxSymbolsStyle
     SFX_SYMBOLS_STYLE_AUTO,
     SFX_SYMBOLS_STYLE_DEFAULT,
     SFX_SYMBOLS_STYLE_HICONTRAST,
-    SFX_SYMBOLS_STYLE_INDUSTRIAL
-//    SFX_SYMBOLS_STYLE_CRYSTAL
+    SFX_SYMBOLS_STYLE_INDUSTRIAL,
+    SFX_SYMBOLS_STYLE_CRYSTAL
 };
 
 #define SFX_TOOLBOX_CHANGESYMBOLSET		0x0001
Index: svtools/source/config/miscopt.cxx
===================================================================
RCS file: /cvs/util/svtools/source/config/miscopt.cxx,v
retrieving revision 1.15
retrieving revision 1.15.16.2
diff -u -p -u -p -r1.15 -r1.15.16.2
--- svtools/source/config/miscopt.cxx	5 Jan 2006 18:12:59 -0000	1.15
+++ svtools/source/config/miscopt.cxx	31 Jan 2006 20:01:39 -0000	1.15.16.2
@@ -107,8 +107,8 @@ using namespace ::com::sun::star;
 #define PROPERTYHANDLE_TOOLBOXSTYLE			2
 #define PROPERTYNAME_USESYSTEMFILEDIALOG	ASCII_STR("UseSystemFileDialog")
 #define PROPERTYHANDLE_USESYSTEMFILEDIALOG	3
-#define PROPERTYNAME_SYMBOLSSTYLE			ASCII_STR("SymbolsStyle")
-#define PROPERTYHANDLE_SYMBOLSSTYLE			4
+#define PROPERTYNAME_SYMBOLSTYLE			ASCII_STR("SymbolStyle")
+#define PROPERTYHANDLE_SYMBOLSTYLE			4
 
 #define PROPERTYCOUNT						5
 
@@ -285,7 +285,7 @@ static sal_Int16 implSymbolsStyleFromVCL
 		case STYLE_SYMBOLS_DEFAULT:    return SFX_SYMBOLS_STYLE_DEFAULT;
 		case STYLE_SYMBOLS_HICONTRAST: return SFX_SYMBOLS_STYLE_HICONTRAST;
 		case STYLE_SYMBOLS_INDUSTRIAL: return SFX_SYMBOLS_STYLE_INDUSTRIAL;
-//		case STYLE_SYMBOLS_CRYSTAL:    return SFX_SYMBOLS_STYLE_CRYSTAL;
+		case STYLE_SYMBOLS_CRYSTAL:    return SFX_SYMBOLS_STYLE_CRYSTAL;
 	}
 
 	return SFX_SYMBOLS_STYLE_AUTO;
@@ -299,7 +299,7 @@ static ULONG implSymbolsStyleToVCL( sal_
 		case SFX_SYMBOLS_STYLE_DEFAULT:    return STYLE_SYMBOLS_DEFAULT;
 		case SFX_SYMBOLS_STYLE_HICONTRAST: return STYLE_SYMBOLS_HICONTRAST;
 		case SFX_SYMBOLS_STYLE_INDUSTRIAL: return STYLE_SYMBOLS_INDUSTRIAL;
-//		case SFX_SYMBOLS_STYLE_CRYSTAL:    return STYLE_SYMBOLS_CRYSTAL;
+		case SFX_SYMBOLS_STYLE_CRYSTAL:    return STYLE_SYMBOLS_CRYSTAL;
 	}
 
 	return STYLE_SYMBOLS_AUTO;
@@ -375,13 +375,13 @@ SvtMiscOptions_Impl::SvtMiscOptions_Impl
                 break;
             }
 
-            case PROPERTYHANDLE_SYMBOLSSTYLE :
+            case PROPERTYHANDLE_SYMBOLSTYLE :
             {
                 ::rtl::OUString aSymbolsStyle;
                 if( seqValues[nProperty] >>= aSymbolsStyle )
                     SetSymbolsStyleName( aSymbolsStyle );
                 else
-                    DBG_ERROR("Wrong type of \"Misc\\SymbolsStyle\"!" );
+                    DBG_ERROR("Wrong type of \"Misc\\SymbolStyle\"!" );
                 m_bIsSymbolsStyleRO = seqRO[nProperty];
                 break;
             }
@@ -461,12 +461,12 @@ void SvtMiscOptions_Impl::Load( const Se
                                                                 DBG_ERROR("Wrong type of \"Misc\\PluginsEnabled\"!" );
                                                         }
                                                     break;
-            case PROPERTYHANDLE_SYMBOLSSTYLE        :   {
+            case PROPERTYHANDLE_SYMBOLSTYLE         :   {
                                                             ::rtl::OUString aSymbolsStyle;
                                                             if( seqValues[nProperty] >>= aSymbolsStyle )
                                                                 SetSymbolsStyleName( aSymbolsStyle );
                                                             else
-                                                                DBG_ERROR("Wrong type of \"Misc\\SymbolsStyle\"!" );
+                                                                DBG_ERROR("Wrong type of \"Misc\\SymbolStyle\"!" );
                                                         }
                                                     break;
         }
@@ -605,7 +605,7 @@ void SvtMiscOptions_Impl::Commit()
                 break;
             }
 
-            case PROPERTYHANDLE_SYMBOLSSTYLE :
+            case PROPERTYHANDLE_SYMBOLSTYLE :
             {
                 if ( !m_bIsSymbolsStyleRO )
                     seqValues[nProperty] <<= GetSymbolsStyleName();
@@ -629,7 +629,7 @@ Sequence< OUString > SvtMiscOptions_Impl
         PROPERTYNAME_SYMBOLSET,
         PROPERTYNAME_TOOLBOXSTYLE,
         PROPERTYNAME_USESYSTEMFILEDIALOG,
-        PROPERTYNAME_SYMBOLSSTYLE
+        PROPERTYNAME_SYMBOLSTYLE
 	};
 
 	// Initialize return sequence with these list ...
Index: solenv/bin/cwscreate.pl
===================================================================
RCS file: /cvs/tools/solenv/bin/cwscreate.pl,v
retrieving revision 1.17
retrieving revision 1.17.8.1
diff -u -p -u -p -r1.17 -r1.17.8.1
--- solenv/bin/cwscreate.pl	10 Jan 2006 17:00:30 -0000	1.17
+++ solenv/bin/cwscreate.pl	31 Jan 2006 10:52:49 -0000	1.17.8.1
@@ -110,6 +110,7 @@ $obligatory_modules{'solenv'}++;
 $obligatory_modules{'default_images'}++;
 $obligatory_modules{'custom_images'}++;
 $obligatory_modules{'ooo_custom_images'}++;
+$obligatory_modules{'external_images'}++;
 $obligatory_modules{'postprocess'}++;
 $obligatory_modules{'instset_native'}++;
 $obligatory_modules{'instsetoo_native'}++;
Index: solenv/bin/cwsresync.pl
===================================================================
RCS file: /cvs/tools/solenv/bin/cwsresync.pl,v
retrieving revision 1.22
retrieving revision 1.22.8.1
diff -u -p -u -p -r1.22 -r1.22.8.1
--- solenv/bin/cwsresync.pl	10 Jan 2006 17:00:44 -0000	1.22
+++ solenv/bin/cwsresync.pl	31 Jan 2006 10:52:50 -0000	1.22.8.1
@@ -98,6 +98,7 @@ $obligatory_modules{'solenv'}++;
 $obligatory_modules{'default_images'}++;
 $obligatory_modules{'custom_images'}++;
 $obligatory_modules{'ooo_custom_images'}++;
+$obligatory_modules{'external_images'}++;
 $obligatory_modules{'postprocess'}++;
 $obligatory_modules{'instset_native'}++;
 $obligatory_modules{'instsetoo_native'}++;
Index: solenv/bin/packimages.pl
===================================================================
RCS file: /cvs/tools/solenv/bin/packimages.pl,v
retrieving revision 1.12
retrieving revision 1.12.182.1
diff -u -p -u -p -r1.12 -r1.12.182.1
--- solenv/bin/packimages.pl	7 Sep 2005 22:12:42 -0000	1.12
+++ solenv/bin/packimages.pl	16 Jan 2006 14:01:55 -0000	1.12.182.1
@@ -103,19 +103,20 @@ sub parse_options
 {
     my $opt_help;
     my $p = Getopt::Long::Parser->new();
+    my @custom_path_list;
     my $success =$p->getoptions(
                              '-h' => \$opt_help, 
                              '-o=s' => \$out_file,
                              '-g=s' => \$global_path,
                              '-m=s' => \$module_path,
-                             '-c=s' => \@custom_path,
+                             '-c=s' => \@custom_path_list,
                              '-l=s' => \@imagelist_path,
                              '-v'   => \$verbose,
                              '-vv'  => \$extra_verbose
                             );
 
     if ( $opt_help || !$success || !$out_file || !$global_path 
-        || !$module_path || !@custom_path || !@imagelist_path ) 
+        || !$module_path || !@custom_path_list || !@imagelist_path ) 
     {
         usage();
         exit(1);
@@ -127,15 +128,27 @@ sub parse_options
 
     # Check if out_file can be written.
     my $out_dir = dirname($out_file);
-    print_error("no such directory: '$out_dir'", 2) if ! -d $out_dir;
-    print_error("can't search directory: '$out_dir'", 2) if ! -x $out_dir;
-    print_error("directory is not writable: '$out_dir'", 2) if ! -w $out_dir;
 
     # Check paths.
-    foreach ($global_path, $module_path, @custom_path, @imagelist_path) {
+    foreach ($out_dir, $global_path, $module_path, @imagelist_path) {
         print_error("no such directory: '$_'", 2) if ! -d $_;
         print_error("can't search directory: '$_'", 2) if ! -x $_;
     }
+    print_error("directory is not writable: '$out_dir'", 2) if ! -w $out_dir;
+
+    # Use just the working paths
+    @custom_path = ();
+    foreach (@custom_path_list) {
+        if ( ! -d $_ ) {
+            print_warning("skipping non-existing directory: '$_'", 2);
+        }
+        elsif ( ! -x $_ ) {
+            print_error("can't search directory: '$_'", 2);
+        }
+        else {
+            push @custom_path, $_;
+        }
+    }
 }
 
 sub get_image_lists
Index: solenv/inc/settings.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/settings.mk,v
retrieving revision 1.183
retrieving revision 1.183.8.1
diff -u -p -u -p -r1.183 -r1.183.8.1
--- solenv/inc/settings.mk	10 Jan 2006 15:51:27 -0000	1.183
+++ solenv/inc/settings.mk	16 Jan 2006 18:20:53 -0000	1.183.8.1
@@ -1091,7 +1091,7 @@ RSCDEFS+= -DDEBUG
 .ENDIF
 
 # additional image sets
-CUSTOM_IMAGE_SETS=hicontrast industrial
+CUSTOM_IMAGE_SETS=hicontrast industrial crystal
 
 UNOIDL=unoidl
 
Index: officecfg/registry/data/org/openoffice/Setup.xcu
===================================================================
RCS file: /cvs/util/officecfg/registry/data/org/openoffice/Setup.xcu,v
retrieving revision 1.25
retrieving revision 1.25.8.1
diff -u -p -u -p -r1.25 -r1.25.8.1
--- officecfg/registry/data/org/openoffice/Setup.xcu	5 Jan 2006 17:53:27 -0000	1.25
+++ officecfg/registry/data/org/openoffice/Setup.xcu	31 Jan 2006 20:01:33 -0000	1.25.8.1
@@ -616,8 +616,7 @@
                         org.openoffice.Office.Common/Misc/PluginsEnabled
                         org.openoffice.Office.Common/Misc/SymbolSet
                         org.openoffice.Office.Common/Misc/UseSystemFileDialog
-                        org.openoffice.Office.Common/Misc/UseSystemFileDialog
-                        org.openoffice.Office.Common/Misc/SymbolsStyle
+                        org.openoffice.Office.Common/Misc/SymbolStyle
                         org.openoffice.Office.Common/OfficeObjects
                         org.openoffice.Office.Common/Passwords
                         org.openoffice.Office.Common/Print/PrintingModifiesDocument
Index: officecfg/registry/schema/org/openoffice/Office/Common.xcs
===================================================================
RCS file: /cvs/util/officecfg/registry/schema/org/openoffice/Office/Common.xcs,v
retrieving revision 1.112
retrieving revision 1.112.8.2
diff -u -p -u -p -r1.112 -r1.112.8.2
--- officecfg/registry/schema/org/openoffice/Office/Common.xcs	5 Jan 2006 17:54:05 -0000	1.112
+++ officecfg/registry/schema/org/openoffice/Office/Common.xcs	31 Jan 2006 20:01:34 -0000	1.112.8.2
@@ -4930,7 +4930,7 @@ Dymamic border coloring means that when 
 				</constraints>
 				<value>0</value>
 			</prop>
-			<prop oor:name="SymbolsStyle" oor:type="xs:string">
+			<prop oor:name="SymbolStyle" oor:type="xs:string">
 				<!-- UIHints: Tools  Options General View -->
 				<info>
 					<author>kendy</author>
@@ -4957,11 +4957,11 @@ Dymamic border coloring means that when 
 							<desc>Industrial - the Gnome default theme</desc>
 						</info>
 					</enumeration>
-					<!--enumeration oor:value="crystal">
+					<enumeration oor:value="crystal">
 						<info>
 							<desc>Crystal - the KDE default theme</desc>
 						</info>
-					</enumeration-->
+					</enumeration>
 				</constraints>
 				<value>auto</value>
 			</prop>
Index: svx/source/dialog/optgdlg.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optgdlg.cxx,v
retrieving revision 1.28
retrieving revision 1.28.26.1
diff -u -p -u -p -r1.28 -r1.28.26.1
--- svx/source/dialog/optgdlg.cxx	5 Jan 2006 17:58:40 -0000	1.28
+++ svx/source/dialog/optgdlg.cxx	16 Jan 2006 18:20:58 -0000	1.28.26.1
@@ -876,7 +876,7 @@ BOOL OfaViewTabPage::FillItemSet( SfxIte
             case 1: eSet = SFX_SYMBOLS_STYLE_DEFAULT;    break;
             case 2: eSet = SFX_SYMBOLS_STYLE_HICONTRAST; break;
             case 3: eSet = SFX_SYMBOLS_STYLE_INDUSTRIAL; break;
-//            case 4: eSet = SFX_SYMBOLS_STYLE_CRYSTAL;    break;
+            case 4: eSet = SFX_SYMBOLS_STYLE_CRYSTAL;    break;
             default:
                 DBG_ERROR( "OfaViewTabPage::FillItemSet(): This state of aIconStyleLB should not be possible!" );
         }
@@ -1063,7 +1063,7 @@ void OfaViewTabPage::Reset( const SfxIte
             case SFX_SYMBOLS_STYLE_DEFAULT:    nStyleLB_InitialSelection = 1; break;
             case SFX_SYMBOLS_STYLE_HICONTRAST: nStyleLB_InitialSelection = 2; break;
             case SFX_SYMBOLS_STYLE_INDUSTRIAL: nStyleLB_InitialSelection = 3; break;
-//            case SFX_SYMBOLS_STYLE_CRYSTAL:    nStyleLB_InitialSelection = 4; break;
+            case SFX_SYMBOLS_STYLE_CRYSTAL:    nStyleLB_InitialSelection = 4; break;
             default:                           nStyleLB_InitialSelection = 0; break;
         }
     }
Index: svx/source/dialog/optgdlg.src
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optgdlg.src,v
retrieving revision 1.21
retrieving revision 1.21.26.1
diff -u -p -u -p -r1.21 -r1.21.26.1
--- svx/source/dialog/optgdlg.src	5 Jan 2006 17:59:16 -0000	1.21
+++ svx/source/dialog/optgdlg.src	16 Jan 2006 18:20:58 -0000	1.21.26.1
@@ -272,7 +272,7 @@ TabPage OFA_TP_VIEW
             < "Standard" ; > ;
             < "HiContrast" ; > ;
             < "Industrial" ; > ;
-//            < "Crystal" ; > ;
+            < "Crystal" ; > ;
         };
         StringList [ en-US ] =
         {
@@ -280,7 +280,7 @@ TabPage OFA_TP_VIEW
             < "Default" ; > ;
             < "HiContrast" ; > ;
             < "Industrial" ; > ;
-//            < "Crystal" ; > ;
+            < "Crystal" ; > ;
         };
     };
 	CheckBox CB_SYSTEM_FONT
Index: instsetoo_native/packimages/makefile.mk
===================================================================
RCS file: /cvs/installation/instsetoo_native/packimages/makefile.mk,v
retrieving revision 1.11
retrieving revision 1.11.10.3
diff -u -p -u -p -r1.11 -r1.11.10.3
--- instsetoo_native/packimages/makefile.mk	5 Jan 2006 18:00:15 -0000	1.11
+++ instsetoo_native/packimages/makefile.mk	31 Jan 2006 15:42:13 -0000	1.11.10.3
@@ -47,7 +47,9 @@ IMAGES := $(COMMONBIN)$/images.zip
 CUSTOM_PREFERRED_FALLBACK=$(SOLARSRC)$/ooo_custom_images$/industrial
 CUSTOM_IMAGES=$(foreach,i,$(CUSTOM_IMAGE_SETS) images_$i)
 
-ALLTAR : $(IMAGES) $(SOLARSRC)$/ooo_custom_images$/hicontrast $(CUSTOM_IMAGES)
+CRYSTAL_TARBALL=$(SOLARSRC)$/external_images$/ooo_crystal_images-1.tar.gz
+
+ALLTAR : $(IMAGES) $(CUSTOM_IMAGES)
 
 $(RES)$/img$/commandimagelist.ilst .PHONY :
     +-$(MKDIR) $(RES)$/img
@@ -63,7 +65,17 @@ $(COMMONBIN)$/images.zip .PHONY: $(RES)$
     +$(PERL) $(SOLARENV)$/bin$/packimages.pl -g $(SOLARSRC)$/$(RSCDEFIMG) -m $(SOLARSRC)$/$(RSCDEFIMG) -c $(RSCCUSTOMIMG) -l $(SOLARCOMMONRESDIR)$/img -l $(RES)$/img -o $@
 
 images_% : $(RES)$/img$/commandimagelist.ilst
-    +$(PERL) $(SOLARENV)$/bin$/packimages.pl -g $(SOLARSRC)$/$(RSCDEFIMG) -m $(SOLARSRC)$/$(RSCDEFIMG) -c $(RSCCUSTOMIMG) -c $(SOLARSRC)$/ooo_custom_images/$(@:s/images_//) -c $(CUSTOM_PREFERRED_FALLBACK) -l $(SOLARCOMMONRESDIR)$/img -l $(RES)$/img -o $(COMMONBIN)$/$@.zip
+    +$(PERL) $(SOLARENV)$/bin$/packimages.pl -g $(SOLARSRC)$/$(RSCDEFIMG) -m $(SOLARSRC)$/$(RSCDEFIMG) -c $(RSCCUSTOMIMG) -c $(SOLARSRC)$/ooo_custom_images$/$(@:s/images_//) -c $(MISC)$/$(@:s/images_//) -c $(CUSTOM_PREFERRED_FALLBACK) -l $(SOLARCOMMONRESDIR)$/img -l $(RES)$/img -o $(COMMONBIN)$/$@.zip
+
+# generate the HiContrast icon set
+$(MISC)$/hicontrast.flag : $(RES)$/img$/commandimagelist.ilst
+    +$(PERL) $(SOLARENV)$/bin$/hicontrast-to-theme.pl $(SOLARSRC)$/default_images $(MISC)$/hicontrast && touch $@
+
+# unpack the Crystal icon set
+$(MISC)$/crystal.flag : $(RES)$/img$/commandimagelist.ilst
+    +gunzip -c $(CRYSTAL_TARBALL) | ( tar -x -C $(MISC) -f - ) && $(TOUCH) $@
+
+# dependencies
+images_hicontrast : $(MISC)$/hicontrast.flag
 
-"$(SOLARSRC)$/ooo_custom_images$/hicontrast" : $(RES)$/img$/commandimagelist.ilst
-    +$(PERL) $(SOLARENV)$/bin$/hicontrast-to-theme.pl $(SOLARSRC)$/default_images $@
+images_crystal : $(MISC)$/crystal.flag
Index: sfx2/source/toolbox/tbxitem.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/toolbox/tbxitem.cxx,v
retrieving revision 1.54
retrieving revision 1.54.10.1
diff -u -p -u -p -r1.54 -r1.54.10.1
--- sfx2/source/toolbox/tbxitem.cxx	5 Jan 2006 18:22:12 -0000	1.54
+++ sfx2/source/toolbox/tbxitem.cxx	17 Jan 2006 07:31:15 -0000	1.54.10.1
@@ -1724,7 +1724,15 @@ void SfxAppToolBoxControl_Impl::SetImage
     if ( !aImage )
         aImage = !!aMenuImage ? aMenuImage :
             SvFileInformationManager::GetImage( INetURLObject( aURL ), bBig, bHC );
-    GetToolBox().SetItemImage( GetId(), aImage );
+    Size aBigSize( GetToolBox().GetDefaultImageSize() );
+    if ( bBig && aImage.GetSizePixel() != aBigSize )
+    {
+        BitmapEx aScaleBmpEx( aImage.GetBitmapEx() );
+        aScaleBmpEx.Scale( aBigSize, BMP_SCALE_INTERPOLATE );
+        GetToolBox().SetItemImage( GetId(), Image( aScaleBmpEx ) );
+    } 
+    else
+        GetToolBox().SetItemImage( GetId(), aImage );
 	aLastURL = aURL;
 }
 
Index: vcl/inc/settings.hxx
===================================================================
RCS file: /cvs/gsl/vcl/inc/settings.hxx,v
retrieving revision 1.31
retrieving revision 1.31.18.1
diff -u -p -u -p -r1.31 -r1.31.18.1
--- vcl/inc/settings.hxx	5 Jan 2006 18:06:50 -0000	1.31
+++ vcl/inc/settings.hxx	16 Jan 2006 18:20:58 -0000	1.31.18.1
@@ -522,7 +522,7 @@ private:
 #define STYLE_SYMBOLS_DEFAULT		((ULONG)1)
 #define STYLE_SYMBOLS_HICONTRAST	((ULONG)2)
 #define STYLE_SYMBOLS_INDUSTRIAL	((ULONG)3)
-//#define STYLE_SYMBOLS_CRYSTAL		((ULONG)4)
+#define STYLE_SYMBOLS_CRYSTAL		((ULONG)4)
 
 #define STYLE_CURSOR_NOBLINKTIME    ((ULONG)0xFFFFFFFF)
 
Index: vcl/inc/toolbox.h
===================================================================
RCS file: /cvs/gsl/vcl/inc/toolbox.h,v
retrieving revision 1.13
retrieving revision 1.13.76.1
diff -u -p -u -p -r1.13 -r1.13.76.1
--- vcl/inc/toolbox.h	11 Nov 2005 13:58:54 -0000	1.13
+++ vcl/inc/toolbox.h	17 Jan 2006 07:12:05 -0000	1.13.76.1
@@ -66,7 +66,10 @@
 #define TB_MENUBUTTON_OFFSET    2
 
 #define TB_SMALLIMAGESIZE       16
-#define TB_LARGEIMAGESIZE       32
+
+#define TB_LARGEIMAGESIZE            26
+#define TB_LARGEIMAGESIZE_INDUSTRIAL 24
+#define TB_LARGEIMAGESIZE_CRYSTAL    22
 
 class Window;
 
Index: vcl/inc/toolbox.hxx
===================================================================
RCS file: /cvs/gsl/vcl/inc/toolbox.hxx,v
retrieving revision 1.42
retrieving revision 1.42.76.1
diff -u -p -u -p -r1.42 -r1.42.76.1
--- vcl/inc/toolbox.hxx	11 Nov 2005 13:59:07 -0000	1.42
+++ vcl/inc/toolbox.hxx	17 Jan 2006 07:31:15 -0000	1.42.76.1
@@ -288,7 +288,6 @@ private:
     SAL_DLLPRIVATE void            ImplHideFocus();
 	SAL_DLLPRIVATE void			   ImplUpdateInputEnable();
     SAL_DLLPRIVATE void			   ImplFillLayoutData() const;
-    SAL_DLLPRIVATE const Size&     ImplGetDefaultImageSize() const;
     SAL_DLLPRIVATE void            ImplUpdateCustomMenu();
     SAL_DLLPRIVATE BOOL            ImplHasClippedItems();
     SAL_DLLPRIVATE Point           ImplGetPopupPosition( const Rectangle& rRect, const Size& rSize ) const;
@@ -638,6 +637,8 @@ public:
     Pair GetTextStartEnd( long nText ) const;
     // returns the item id for text portion nText or 0 if nText is invalid
     USHORT GetDisplayItemId( long nText ) const;
+
+    const Size&         GetDefaultImageSize() const;
 };
 
 inline void ToolBox::CheckItem( USHORT nItemId, BOOL bCheck )
Index: vcl/source/app/settings.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/app/settings.cxx,v
retrieving revision 1.55
retrieving revision 1.55.18.1
diff -u -p -u -p -r1.55 -r1.55.18.1
--- vcl/source/app/settings.cxx	5 Jan 2006 18:07:04 -0000	1.55
+++ vcl/source/app/settings.cxx	16 Jan 2006 18:20:59 -0000	1.55.18.1
@@ -721,7 +721,7 @@ void StyleSettings::Set3DColors( const C
 		case STYLE_SYMBOLS_DEFAULT:    return ::rtl::OUString::createFromAscii( "default" );
 		case STYLE_SYMBOLS_HICONTRAST: return ::rtl::OUString::createFromAscii( "hicontrast" );
 		case STYLE_SYMBOLS_INDUSTRIAL: return ::rtl::OUString::createFromAscii( "industrial" );
-//		case STYLE_SYMBOLS_CRYSTAL:    return ::rtl::OUString::createFromAscii( "crystal" );
+		case STYLE_SYMBOLS_CRYSTAL:    return ::rtl::OUString::createFromAscii( "crystal" );
 	}
 
 	return ::rtl::OUString::createFromAscii( "auto" );
@@ -737,8 +737,8 @@ ULONG StyleSettings::ImplNameToSymbolsSt
 		return STYLE_SYMBOLS_HICONTRAST;
 	else if ( rName == ::rtl::OUString::createFromAscii( "industrial" ) )
 		return STYLE_SYMBOLS_INDUSTRIAL;
-//	else if ( rName == ::rtl::OUString::createFromAscii( "crystal" ) )
-//		return STYLE_SYMBOLS_CRYSTAL;
+	else if ( rName == ::rtl::OUString::createFromAscii( "crystal" ) )
+		return STYLE_SYMBOLS_CRYSTAL;
 
 	return STYLE_SYMBOLS_AUTO;
 }
@@ -760,8 +760,8 @@ ULONG StyleSettings::GetCurrentSymbolsSt
 
 			if( rDesktopEnvironment.equalsIgnoreAsciiCaseAscii( "gnome" ) )
 				snDesktopStyle = STYLE_SYMBOLS_INDUSTRIAL;
-//			else if( rDesktopEnvironment.equalsIgnoreAsciiCaseAscii( "kde" ) )
-//				snDesktopStyle = STYLE_SYMBOLS_CRYSTAL;
+			else if( rDesktopEnvironment.equalsIgnoreAsciiCaseAscii( "kde" ) )
+				snDesktopStyle = STYLE_SYMBOLS_CRYSTAL;
 
 			sbDesktopChecked = true;
 		}
Index: vcl/source/window/toolbox.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/window/toolbox.cxx,v
retrieving revision 1.94
retrieving revision 1.94.74.1
diff -u -p -u -p -r1.94 -r1.94.74.1
--- vcl/source/window/toolbox.cxx	11 Nov 2005 11:55:12 -0000	1.94
+++ vcl/source/window/toolbox.cxx	17 Jan 2006 07:38:14 -0000	1.94.74.1
@@ -1944,8 +1944,8 @@ BOOL ToolBox::ImplCalcItem()
     long            nDropDownArrowWidth = TB_DROPDOWNARROWWIDTH;
 
     // set defaults if image or text is needed but empty
-    nDefWidth       = ImplGetDefaultImageSize().Width();
-    nDefHeight      = ImplGetDefaultImageSize().Height();
+    nDefWidth       = GetDefaultImageSize().Width();
+    nDefHeight      = GetDefaultImageSize().Height();
 
     // determine minimum size necessary in NWF
     if( IsNativeControlSupported( CTRL_TOOLBAR, PART_BUTTON ) )
Index: vcl/source/window/toolbox2.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/window/toolbox2.cxx,v
retrieving revision 1.44
retrieving revision 1.44.62.2
diff -u -p -u -p -r1.44 -r1.44.62.2
--- vcl/source/window/toolbox2.cxx	17 Nov 2005 17:21:01 -0000	1.44
+++ vcl/source/window/toolbox2.cxx	17 Jan 2006 07:38:14 -0000	1.44.62.2
@@ -1002,10 +1002,30 @@ ToolBoxButtonSize ToolBox::GetToolboxBut
 
 // -----------------------------------------------------------------------
 
-const Size& ToolBox::ImplGetDefaultImageSize() const
+const Size& ToolBox::GetDefaultImageSize() const
 {
-    static Size aLargeButtonSize( TB_LARGEIMAGESIZE, TB_LARGEIMAGESIZE );
     static Size aSmallButtonSize( TB_SMALLIMAGESIZE, TB_SMALLIMAGESIZE );
+
+    static ULONG s_nSymbolsStyle = STYLE_SYMBOLS_DEFAULT;
+    static Size aLargeButtonSize( TB_LARGEIMAGESIZE, TB_LARGEIMAGESIZE );
+
+    ULONG nSymbolsStyle = Application::GetSettings().GetStyleSettings().GetCurrentSymbolsStyle();
+    if ( s_nSymbolsStyle != nSymbolsStyle )
+    {
+        s_nSymbolsStyle = nSymbolsStyle;
+        switch ( nSymbolsStyle )
+        {
+            case STYLE_SYMBOLS_INDUSTRIAL:
+                aLargeButtonSize = Size( TB_LARGEIMAGESIZE_INDUSTRIAL, TB_LARGEIMAGESIZE_INDUSTRIAL );
+                break;
+            case STYLE_SYMBOLS_CRYSTAL:
+                aLargeButtonSize = Size( TB_LARGEIMAGESIZE_CRYSTAL, TB_LARGEIMAGESIZE_CRYSTAL );
+                break;
+            default:
+                aLargeButtonSize = Size( TB_LARGEIMAGESIZE, TB_LARGEIMAGESIZE );
+        }
+    }
+
     return GetToolboxButtonSize() == TOOLBOX_BUTTONSIZE_LARGE ? aLargeButtonSize : aSmallButtonSize;
 }
 
