Index: sc/source/ui/view/tabvwsh4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsh4.cxx,v
retrieving revision 1.68
diff -u -p -r1.68 tabvwsh4.cxx
--- sc/source/ui/view/tabvwsh4.cxx	17 Jul 2007 13:35:24 -0000	1.68
+++ sc/source/ui/view/tabvwsh4.cxx	30 Nov 2007 03:57:02 -0000
@@ -1196,6 +1204,20 @@ PrintDialog* __EXPORT ScTabViewShell::Cr
 	pDoc->SetPrintOptions();				// Optionen aus OFA am Printer setzen
 	SfxPrinter* pPrinter = GetPrinter();
 
+	const SfxPoolItem* pItem;
+	const SfxItemSet& rOptionSet = pPrinter->GetOptions();
+	BOOL bHasOptions = ( rOptionSet.GetItemState(SID_SCPRINTOPTIONS, FALSE, &pItem) == SFX_ITEM_SET );
+	ScPrintOptions aOptions;
+	if (bHasOptions)
+		aOptions = ((const ScTpPrintItem*)pItem)->GetPrintOptions();
+	else
+		aOptions = SC_MOD()->GetPrintOptions();		// use configuration
+
+	bool bAllTabs = aOptions.GetAllSheets();
+
+	ScMarkData aMarkData;
+	aMarkData.SelectTable( GetViewData()->GetTabNo(), TRUE );
+
 	String			aStrRange;
 	PrintDialog*	pDlg 		= new PrintDialog( pParent);
 	SCTAB			nTabCount	= pDoc->GetTableCount();
@@ -1203,6 +1225,8 @@ PrintDialog* __EXPORT ScTabViewShell::Cr
 
 	for ( SCTAB i=0; i<nTabCount; i++ )
 	{
+		if ( !bAllTabs && !aMarkData.GetTableSelect( i ) )
+			continue;
 		ScPrintFunc aPrintFunc( pDocShell, pPrinter, i );
 		nDocPageMax += aPrintFunc.GetTotalPages();
 	}
Index: sc/source/ui/view/preview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/preview.cxx,v
retrieving revision 1.32
diff -u -p -r1.32 preview.cxx
--- sc/source/ui/view/preview.cxx	10 May 2007 17:01:54 -0000	1.32
+++ sc/source/ui/view/preview.cxx	15 Dec 2007 03:19:12 -0000
@@ -231,8 +231,17 @@ void ScPreview::CalcPages( SCTAB nToWhic
 	//	but always all sheets are used (there is no selected sheet)
 	ScPrintOptions aOptions = SC_MOD()->GetPrintOptions();
 
+	ScMarkData aMarkData;
+	aMarkData.SelectTable( ScDocShell::GetCurTab(), TRUE );
+
 	for (SCTAB i=nStart; i<nAnz; i++)
 	{
+		if (!aOptions.GetAllSheets() && !aMarkData.GetTableSelect( i )) {
+			nPages[i] = 0;
+			nFirstAttr[i] = 0;
+			continue;
+		}
+
 		long nAttrPage = i > 0 ? nFirstAttr[i-1] : 1;
 
 		long nThisStart = nTotalPages;
