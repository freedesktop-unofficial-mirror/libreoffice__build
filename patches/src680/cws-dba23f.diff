Index: source/ui/app/AppController.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/app/AppController.cxx,v
retrieving revision 1.44
retrieving revision 1.44.22.1
diff -u -u -r1.44 -r1.44.22.1
--- dbaccess/source/ui/app/AppController.cxx	3 Aug 2007 12:47:47 -0000	1.44
+++ dbaccess/source/ui/app/AppController.cxx	6 Sep 2007 07:13:33 -0000	1.44.22.1
@@ -224,9 +224,8 @@
 #ifndef _DBAUI_DSNTYPES_HXX_
 #include "dsntypes.hxx"
 #endif
-#ifndef _PASTEDLG_HXX
-#include <so3/pastedlg.hxx>
-#endif
+#include <svx/svxdlg.hxx>
+#include <svtools/insdlg.hxx>
 #ifndef _UNOTOOLS_TEMPFILE_HXX
 #include <unotools/tempfile.hxx>
 #endif
@@ -1012,17 +1011,17 @@
 				{
 					if ( !aArgs.getLength() )
 					{
-						SvPasteObjectDialog aDlg;
+                        SvxAbstractDialogFactory* pFact = SvxAbstractDialogFactory::Create();
+                        ::std::auto_ptr<SfxAbstractPasteDialog> pDlg(pFact->CreatePasteDialog( getView() ));
 						::std::vector<SotFormatStringId> aFormatIds;
 						getSupportedFormats(getContainer()->getElementType(),aFormatIds);
-						::std::vector<SotFormatStringId>::iterator aEnd = aFormatIds.end();
+						const ::std::vector<SotFormatStringId>::iterator aEnd = aFormatIds.end();
+                        ::rtl::OUString sEmpty;
 						for (::std::vector<SotFormatStringId>::iterator aIter = aFormatIds.begin();aIter != aEnd; ++aIter)
-						{
-							aDlg.Insert(*aIter,SvPasteObjectDialog::GetSotFormatUIName(*aIter));
-						}
+							pDlg->Insert(*aIter,sEmpty);
 
 						const TransferableDataHelper& rClipboard = getViewClipboard();
-						pasteFormat(aDlg.Execute(getView(),rClipboard.GetTransferable()));
+						pasteFormat(pDlg->GetFormat(rClipboard.GetTransferable()));
 					}
 					else
 					{
