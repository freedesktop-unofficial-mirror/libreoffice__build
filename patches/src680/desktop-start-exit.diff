Index: desktop/source/app/app.cxx
===================================================================
RCS file: /cvs/framework/desktop/source/app/app.cxx,v
retrieving revision 1.202
diff -u -p -u -r1.202 app.cxx
--- desktop/source/app/app.cxx	26 Apr 2007 08:21:55 -0000	1.202
+++ desktop/source/app/app.cxx	11 Jun 2007 13:55:22 -0000
@@ -2019,6 +2020,20 @@ IMPL_STATIC_LINK_NOINSTANCE( Desktop, As
     return 0L;
 }
 
+class ExitTimer : public Timer 
+{
+  public:
+    ExitTimer()
+    {
+        SetTimeout(500);
+        Start();
+    }
+    virtual void Timeout()
+    {
+        exit (0);
+    }
+};
+
 IMPL_LINK( Desktop, OpenClients_Impl, void*, EMPTYARG )
 {
 	RTL_LOGFILE_PRODUCT_CONTEXT( aLog, "PERFORMANCE - DesktopOpenClients_Impl()" );
@@ -2036,6 +2051,10 @@ IMPL_LINK( Desktop, OpenClients_Impl, vo
 //    OfficeIPCThread::SetReady();
 
     EnableOleAutomation();
+
+    if (getenv ("OOO_EXIT_POST_STARTUP"))
+        new ExitTimer();
+
     return 0;
 }
 
