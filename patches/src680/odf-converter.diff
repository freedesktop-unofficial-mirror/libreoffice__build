--- scp2/source/ooo/file_ooo.scp
+++ scp2/source/ooo/file_ooo.scp
@@ -2587,3 +2587,56 @@
     Styles = (PACKED);
 End
 #endif
+
+#ifdef WNT
+
+File gid_File_OdfConverter
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "odfconverter.exe";
+End
+
+File gid_File_ZlibDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "zlib1.dll";
+End
+
+File gid_File_GlibDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "libglib-2.0-0.dll";
+End
+
+File gid_File_GmoduleDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "libgmodule-2.0-0.dll";
+End
+
+File gid_File_GthreadDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "libgthread-2.0-0.dll";
+End
+
+File gid_File_IconvDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "iconv.dll";
+End
+
+File gid_File_IntlDll
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED,PATCH);
+    Name = "intl.dll";
+End
+
+#endif
dummy line to avoid confusing diff-mode
--- filter/source/config/fragments/fcfg_writer.mk
+++ filter/source/config/fragments/fcfg_writer.mk
@@ -28,7 +28,7 @@
 .ENDIF
 
 # -----------------------------------------------
-# count = 39
+# count = 40
 T4_WRITER = \
     writer_web_HTML \
     writer_Lotus_1_2_3_10_DOS_StarWriter \
@@ -58,10 +58,11 @@
     writer8 \
     writer_MS_Word_2003_XML \
 	LaTeX \
-	BibTeX
+	BibTeX \
+	MOOX
 
 # -----------------------------------------------
-# count = 39
+# count = 40
 F4_WRITER = \
 	HTML__StarWriter_ \
 	Lotus_1_2_3_1_0__DOS___StarWriter_ \
@@ -91,7 +91,8 @@
 	writer8_template \
     MS_Word_2003_XML \
 	LaTeX_Writer \
-	BibTeX_Writer
+	BibTeX_Writer \
+	MOOX
 
 # -----------------------------------------------
 # count = 14
dummy line to avoid confusing diff-mode
--- /dev/null
+++ filter/source/config/fragments/types/MOOX.xcu
@@ -0,0 +1,11 @@
+	<node oor:name="MOOXTYPE" oor:op="replace">
+		<prop oor:name="URLPattern"><value>*.docx</value></prop>
+		<prop oor:name="Extensions"><value>docx</value></prop>
+		<prop oor:name="MediaType"><value>application/vnd.openxmlformats-officedocument.wordprocessingml.document</value></prop>
+		<prop oor:name="Preferred"><value>false</value></prop>
+		<prop oor:name="PreferredFilter"><value>MOOX</value></prop>
+		<prop oor:name="UIName">
+			<value xml:lang="x-default">Microsoft Word 2007 Document</value>
+		</prop>
+		<prop oor:name="ClipboardFormat"><value>doctype:wordDocument</value></prop>
+	</node>
dummy line to avoid confusing diff-mode
--- /dev/null
+++ filter/source/config/fragments/filters/MOOX.xcu
@@ -0,0 +1,13 @@
+	<node oor:name="MOOX" oor:op="replace">
+		<prop oor:name="Flags"><value>IMPORT EXPORT TEMPLATE OWN ALIEN DEFAULT PREFERRED</value></prop>
+		<prop oor:name="UIComponent"/>
+		<prop oor:name="FilterService"/>
+		<prop oor:name="UserData"><value>CXML,Preprocess=&lt;vnd.sun.star.expand:$ORIGIN/odfconverter.exe /DOCX2ODT /I %SOURCE% /O %TARGET%&gt;,Postprocess=&lt;vnd.sun.star.expand:$ORIGIN/odfconverter.exe /ODT2DOCX /I %SOURCE% /O %TARGET%&gt;</value></prop>
+		<prop oor:name="FileFormatVersion"><value>6800</value></prop>
+		<prop oor:name="Type"><value>MOOXTYPE</value></prop>
+		<prop oor:name="TemplateName"/>
+		<prop oor:name="DocumentService"><value>com.sun.star.text.TextDocument</value></prop>
+		<prop oor:name="UIName">
+			<value xml:lang="x-default">Microsoft Word 2007 Document</value>
+		</prop>
+	</node>
dummy line to avoid confusing diff-mode
--- external/prj/d.lst
+++ external/prj/d.lst
@@ -88,6 +88,10 @@
 ..\msi\instmsia.exe %_DEST%\bin%_EXT%\instmsia.exe
 ..\msi\instmsiw.exe %_DEST%\bin%_EXT%\instmsiw.exe
 
+..\glib\*.dll %_DEST%\bin%_EXT%\*.dll
+..\odfconverter\*.exe %_DEST%\bin%_EXT%\*.exe
+..\zlib1dll\*.dll %_DEST%\bin%_EXT%\*.dll
+
 ..\X11\extensions\*.h %_DEST%\inc%_EXT%\X11\extensions\*.h
 
 ..\%__SRC%\lib\lib*static*.dylib %_DEST%\lib%_EXT%\lib*static*.dylib
dummy line to avoid confusing diff-mode
--- setup_native/source/win32/customactions/reg4msdoc/registrationcontextinformation.hxx
+++ setup_native/source/win32/customactions/reg4msdoc/registrationcontextinformation.hxx
@@ -41,6 +41,14 @@
 	std::wstring GetWordDocumentDefaultIconEntry() const;
 	std::wstring GetWordDocumentDefaultShellCommand() const;
 
+	/** MOOX Word document information		
+		The icon index is the index of the icon 
+		in soffice.exe to be associated with 
+		word document files
+	*/
+	std::wstring GetMOOXWordDocumentDisplayName() const;
+	std::wstring GetMOOXWordDocumentFileExtension() const;
+
 	/** Word template information
 		The icon index is the index of the icon 
 		in soffice.exe to be associated with 
dummy line to avoid confusing diff-mode
--- setup_native/source/win32/customactions/reg4msdoc/registrationcontextinformation.cxx
+++ setup_native/source/win32/customactions/reg4msdoc/registrationcontextinformation.cxx
@@ -59,6 +59,18 @@
 	return std::wstring(TEXT("open"));
 }
 
+std::wstring RegistrationContextInformation::GetMOOXWordDocumentDisplayName() const
+{	
+	std::wstring str;
+	str = TEXT("Microsoft Office Open XML Word Document");
+	return str;
+}
+
+std::wstring RegistrationContextInformation::GetMOOXWordDocumentFileExtension() const
+{
+	return std::wstring(TEXT(".docx"));
+}
+
 std::wstring RegistrationContextInformation::GetWordTemplateDisplayName() const
 {
 	std::wstring str;
dummy line to avoid confusing diff-mode
--- setup_native/source/win32/customactions/reg4msdoc/registrar.cxx
+++ setup_native/source/win32/customactions/reg4msdoc/registrar.cxx
@@ -66,6 +66,13 @@
         m_ContextInformation.GetWordDocumentDefaultShellCommand(),
         m_ContextInformation.ShellNewCommandDisplayName());
 	
+    RegisterForMsOfficeApplication(
+        m_ContextInformation.GetMOOXWordDocumentFileExtension(),
+        m_ContextInformation.GetMOOXWordDocumentDisplayName(),
+        m_ContextInformation.GetWordDocumentDefaultIconEntry(),
+        m_ContextInformation.GetWordDocumentDefaultShellCommand(),
+        m_ContextInformation.ShellNewCommandDisplayName());
+	
     RegisterForMsOfficeApplication(
         m_ContextInformation.GetWordTemplateFileExtension(),
         m_ContextInformation.GetWordTemplateDisplayName(),
@@ -88,6 +88,14 @@
 	catch(RegistryKeyNotFoundException&)
 	{}
 
+	try
+	{
+		UnregisterForMsOfficeApplication(
+			m_ContextInformation.GetMOOXWordDocumentFileExtension());
+	}
+	catch(RegistryKeyNotFoundException&)
+	{}
+
 	try
 	{
 		UnregisterForMsOfficeApplication(
@@ -131,7 +131,9 @@
 bool Registrar::QueryPreselectMsWordRegistration() const
 {    
     return QueryPreselectForMsApplication(
-        m_ContextInformation.GetWordDocumentFileExtension());
+                m_ContextInformation.GetWordDocumentFileExtension()) &&
+           QueryPreselectForMsApplication(
+                m_ContextInformation.GetMOOXWordDocumentFileExtension());
 }
 
 void Registrar::RegisterForMsExcel() const
dummy line to avoid confusing diff-mode
