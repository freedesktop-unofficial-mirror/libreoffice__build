Index: connectivity/version.mk
===================================================================
RCS file: /cvs/dba/connectivity/version.mk,v
retrieving revision 1.10
retrieving revision 1.10.104.1
diff -u -p -u -p -r1.10 -r1.10.104.1
--- connectivity/version.mk	9 Nov 2004 12:05:23 -0000	1.10
+++ connectivity/version.mk	29 Aug 2005 08:46:07 -0000	1.10.104.1
@@ -255,6 +255,22 @@ EVOAB_CPP=1
 
 EVOAB=$(EVOAB_TARGET_TARGET)_$(CMPEXT)
 
+# ----------------------------Kab settings-------------------------------------#
+# target
+KAB_TARGET=kab
+
+# the major 
+KAB_MAJOR=1
+# the minor 
+KAB_MINOR=0
+# the micro 
+KAB_MICRO=0
+
+# this is a c++ compatible library 
+KAB_CPP=1
+
+KAB=$(KAB_TARGET_TARGET)_$(CMPEXT)
+
 # ----------------------------HSQLDB settings-----------------------------------#
 # target
 HSQLDB_TARGET=hsqldb
@@ -269,4 +285,4 @@ HSQLDB_MICRO=0
 # this is a c++ compatible library 
 HSQLDB_CPP=1
 
-HSQLDB=$(HSQLDB_TARGET_TARGET)_$(CMPEXT)
\ No newline at end of file
+HSQLDB=$(HSQLDB_TARGET_TARGET)_$(CMPEXT)
Index: connectivity/prj/build.lst
===================================================================
RCS file: /cvs/dba/connectivity/prj/build.lst,v
retrieving revision 1.24
retrieving revision 1.24.36.1
diff -u -p -u -p -r1.24 -r1.24.36.1
--- connectivity/prj/build.lst	9 Jun 2005 14:08:55 -0000	1.24
+++ connectivity/prj/build.lst	29 Aug 2005 08:46:07 -0000	1.24.36.1
@@ -11,6 +11,7 @@ cn	connectivity\source\drivers\ado			nma
 cn	connectivity\source\drivers\mozab\bootstrap	nmake	-	all	cn_mozab_bootstrap NULL
 cn	connectivity\source\drivers\mozab\mozillasrc	nmake	-	all	cn_mozab_mozillasrc cn_file NULL
 cn	connectivity\source\drivers\mozab		nmake	-	all	cn_mozab cn_mozab_bootstrap cn_mozab_mozillasrc cn_dbtools NULL
+cn	connectivity\source\drivers\kab			nmake	-	all	cn_kab cn_dbtools cn_file NULL
 cn	connectivity\source\drivers\evoab		nmake	-	all	cn_evoab cn_dbtools cn_file NULL
 cn	connectivity\source\drivers\evoab2		nmake	-	all	cn_evoab2 cn_dbtools cn_file NULL
 cn	connectivity\source\drivers\calc		nmake	-	all	cn_calc cn_file NULL
Index: connectivity/prj/d.lst
===================================================================
RCS file: /cvs/dba/connectivity/prj/d.lst,v
retrieving revision 1.22
retrieving revision 1.22.36.1
diff -u -p -u -p -r1.22 -r1.22.36.1
--- connectivity/prj/d.lst	9 Jun 2005 14:09:09 -0000	1.22
+++ connectivity/prj/d.lst	29 Aug 2005 08:46:08 -0000	1.22.36.1
@@ -6,6 +6,7 @@
 ..\source\cpool\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\adabas\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\ado\*.xml %_DEST%\xml%_EXT%\*.xml
+..\source\drivers\kab\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\file\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\flat\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\dbase\*.xml %_DEST%\xml%_EXT%\*.xml
Index: connectivity/source/drivers/kab/KCatalog.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KCatalog.cxx
diff -N connectivity/source/drivers/kab/KCatalog.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KCatalog.cxx	2 Sep 2005 08:04:21 -0000	1.1.2.2
@@ -0,0 +1,159 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KCatalog.hxx"
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_TABLES_HXX_
+#include "KTables.hxx"
+#endif
+
+using namespace connectivity::kab;
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::sdbcx;
+using namespace ::com::sun::star::sdbc;
+using namespace ::com::sun::star::container;
+using namespace ::com::sun::star::lang;
+using namespace ::cppu;
+
+// -------------------------------------------------------------------------
+KabCatalog::KabCatalog(KabConnection* _pCon)
+		: connectivity::sdbcx::OCatalog(_pCon),
+		  m_pConnection(_pCon),
+		  m_xMetaData(m_pConnection->getMetaData())
+{
+}
+// -------------------------------------------------------------------------
+void KabCatalog::refreshTables()
+{
+	TStringVector aVector;
+	Sequence< ::rtl::OUString > aTypes(1);
+	aTypes[0] = ::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("%"));
+	Reference< XResultSet > xResult = m_xMetaData->getTables(
+		Any(),
+		::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM("%")),
+		::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM("%")),
+		aTypes);
+
+	if (xResult.is())
+	{
+		Reference< XRow > xRow(xResult,UNO_QUERY);
+		::rtl::OUString aName;
+		// const ::rtl::OUString& sDot = KabCatalog::getDot();
+
+		while (xResult->next())
+		{
+			// aName = xRow->getString(2);
+			// aName += sDot;
+			aName = xRow->getString(3);
+			aVector.push_back(aName);
+		}
+	}
+	if (m_pTables)
+		m_pTables->reFill(aVector);
+	else
+		m_pTables = new KabTables(m_xMetaData,*this,m_aMutex,aVector);
+}
+// -------------------------------------------------------------------------
+void KabCatalog::refreshViews()
+{
+}
+// -------------------------------------------------------------------------
+void KabCatalog::refreshGroups()
+{
+}
+// -------------------------------------------------------------------------
+void KabCatalog::refreshUsers()
+{
+}
+// -------------------------------------------------------------------------
+const ::rtl::OUString& KabCatalog::getDot()
+{
+	static const ::rtl::OUString sDot = ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM("."));
+	return sDot;
+}
+// -----------------------------------------------------------------------------
+
+// XTablesSupplier
+Reference< XNameAccess > SAL_CALL KabCatalog::getTables(  ) throw(RuntimeException)
+{
+	::osl::MutexGuard aGuard(m_aMutex);
+	checkDisposed(rBHelper.bDisposed);
+		
+	try
+	{
+		if (!m_pTables)
+			refreshTables();
+	}
+	catch( const RuntimeException& )
+	{
+		// allowed to leave this method
+		throw;
+	}
+	catch( const Exception& )
+	{
+		// allowed
+	}
+
+	return m_pTables;
+}
Index: connectivity/source/drivers/kab/KCatalog.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KCatalog.hxx
diff -N connectivity/source/drivers/kab/KCatalog.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KCatalog.hxx	2 Sep 2005 08:04:22 -0000	1.1.2.2
@@ -0,0 +1,100 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_CATALOG_HXX_
+#define _CONNECTIVITY_KAB_CATALOG_HXX_
+
+#ifndef _CONNECTIVITY_SDBCX_CATALOG_HXX_
+#include "connectivity/sdbcx/VCatalog.hxx"
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+	        class KabConnection;
+
+		class KabCatalog : public connectivity::sdbcx::OCatalog
+		{
+			KabConnection* m_pConnection;		// used to get the metadata
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData > m_xMetaData; // just to make things easier
+
+		public:
+			KabCatalog(KabConnection* _pCon);
+
+			inline KabConnection* getConnection() const { return m_pConnection; }
+
+			static const ::rtl::OUString& getDot();
+
+			// implementation of the pure virtual methods
+			virtual void refreshTables();
+			virtual void refreshViews();
+			virtual void refreshGroups();
+			virtual void refreshUsers();
+
+			// XTablesSupplier
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::container::XNameAccess > SAL_CALL getTables(
+					) throw(::com::sun::star::uno::RuntimeException);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_CATALOG_HXX_
Index: connectivity/source/drivers/kab/KColumns.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KColumns.cxx
diff -N connectivity/source/drivers/kab/KColumns.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KColumns.cxx	29 Aug 2005 08:43:47 -0000	1.1.2.1
@@ -0,0 +1,129 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KColumns.hxx"
+#ifndef _CONNECTIVITY_KAB_TABLE_HXX_
+#include "KTable.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_TABLES_HXX_
+#include "KTables.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CATALOG_HXX_
+#include "KCatalog.hxx"
+#endif
+
+#ifndef _CONNECTIVITY_SDBCX_COLUMN_HXX_
+#include "connectivity/sdbcx/VColumn.hxx"
+#endif
+
+using namespace connectivity::kab;
+using namespace connectivity::sdbcx;
+using namespace connectivity;
+using namespace ::comphelper;
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::sdbc;
+using namespace ::com::sun::star::container;
+using namespace ::com::sun::star::lang;
+
+// -------------------------------------------------------------------------
+sdbcx::ObjectType KabColumns::createObject(const ::rtl::OUString& _rName)
+{
+	Reference< XResultSet > xResult = m_pTable->getConnection()->getMetaData()->getColumns(
+		Any(),
+		m_pTable->getSchema(),
+		m_pTable->getTableName(),
+		_rName);
+
+	sdbcx::ObjectType xRet = NULL;
+	if (xResult.is())
+	{
+		Reference< XRow > xRow(xResult,UNO_QUERY);
+
+		while (xResult->next())
+		{
+			if (xRow->getString(4) == _rName)
+			{
+				OColumn* pRet = new OColumn(
+						_rName,
+						xRow->getString(6),
+						xRow->getString(13),
+						xRow->getInt(11),
+						xRow->getInt(7),
+						xRow->getInt(9),
+						xRow->getInt(5),
+						sal_False,
+						sal_False,
+						sal_False,
+						sal_True);
+				xRet = pRet;
+				break;
+			}
+		}
+	}
+
+	return xRet;
+}
+// -------------------------------------------------------------------------
+void KabColumns::impl_refresh() throw(RuntimeException)
+{
+	m_pTable->refreshColumns();
+}
Index: connectivity/source/drivers/kab/KColumns.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KColumns.hxx
diff -N connectivity/source/drivers/kab/KColumns.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KColumns.hxx	29 Aug 2005 08:43:47 -0000	1.1.2.1
@@ -0,0 +1,96 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_COLUMNS_HXX_
+#define _CONNECTIVITY_KAB_COLUMNS_HXX_
+
+#ifndef _CONNECTIVITY_KAB_TABLE_HXX_
+#include "KTable.hxx"
+#endif
+
+#ifndef _CONNECTIVITY_SDBCX_COLLECTION_HXX_
+#include "connectivity/sdbcx/VCollection.hxx"
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		class KabColumns : public sdbcx::OCollection
+		{
+		protected:
+			KabTable*	m_pTable;
+
+			virtual sdbcx::ObjectType createObject(const ::rtl::OUString& _rName);
+			virtual void impl_refresh() throw(::com::sun::star::uno::RuntimeException);
+
+		public:
+			KabColumns(	KabTable* _pTable,
+						::osl::Mutex& _rMutex,
+						const TStringVector &_rVector
+						) : sdbcx::OCollection(*_pTable,sal_True,_rMutex,_rVector),
+							m_pTable(_pTable)
+			{ }
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_COLUMNS_HXX_
Index: connectivity/source/drivers/kab/KCondition.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KCondition.cxx
diff -N connectivity/source/drivers/kab/KCondition.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KCondition.cxx	29 Aug 2005 08:43:47 -0000	1.1.2.1
@@ -0,0 +1,263 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KCondition.hxx"
+#ifndef _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+#include "KResultSetMetaData.hxx"
+#endif
+
+using namespace ::connectivity::kab;
+
+using namespace ::com::sun::star::sdbc;
+// -----------------------------------------------------------------------------
+KabCondition::~KabCondition()
+{
+}
+// -----------------------------------------------------------------------------
+KabConditionConstant::KabConditionConstant(const sal_Bool value)
+	: m_bValue(value),
+          KabCondition()
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionConstant::isAlwaysTrue() const
+{
+	return m_bValue;
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionConstant::isAlwaysFalse() const
+{
+	return !m_bValue;
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionConstant::eval(::KABC::Addressee &addressee) const
+{
+	return m_bValue;
+}
+// -----------------------------------------------------------------------------
+KabConditionColumn::KabConditionColumn(const ::rtl::OUString &columnName) throw(SQLException)
+	: KabCondition()
+{
+	m_nFieldNumber = KabResultSetMetaData::findKabField(columnName);
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionColumn::isAlwaysTrue() const
+{
+	// Sometimes true, sometimes false
+	return sal_False;
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionColumn::isAlwaysFalse() const
+{
+	// Sometimes true, sometimes false
+	return sal_False;
+}
+// -----------------------------------------------------------------------------
+KabConditionNull::KabConditionNull(const ::rtl::OUString &columnName) throw(SQLException)
+	: KabConditionColumn(columnName)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionNull::eval(::KABC::Addressee &addressee) const
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	QString aQtName(aFields[m_nFieldNumber]->value(addressee));
+
+	return aQtName.isNull();
+// KDE address book currently does not use NULL values.
+// But it might do it someday
+}
+// -----------------------------------------------------------------------------
+KabConditionNotNull::KabConditionNotNull(const ::rtl::OUString &columnName) throw(SQLException)
+	: KabConditionColumn(columnName)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionNotNull::eval(::KABC::Addressee &addressee) const
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	QString aQtName(aFields[m_nFieldNumber]->value(addressee));
+
+	return !aQtName.isNull();
+// KDE address book currently does not use NULL values.
+// But it might do it someday
+}
+// -----------------------------------------------------------------------------
+KabConditionCompare::KabConditionCompare(const ::rtl::OUString &columnName, const ::rtl::OUString &matchString) throw(SQLException)
+	: m_sMatchString(matchString),
+	  KabConditionColumn(columnName)
+{
+}
+// -----------------------------------------------------------------------------
+KabConditionEqual::KabConditionEqual(const ::rtl::OUString &columnName, const ::rtl::OUString &matchString) throw(SQLException)
+	: KabConditionCompare(columnName, matchString)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionEqual::eval(::KABC::Addressee &addressee) const
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	QString aQtName(aFields[m_nFieldNumber]->value(addressee));
+
+	if (aQtName.isNull()) return sal_False;
+
+	::rtl::OUString sValue((const sal_Unicode *) aQtName.ucs2());
+	return sValue == m_sMatchString;
+}
+// -----------------------------------------------------------------------------
+KabConditionDifferent::KabConditionDifferent(const ::rtl::OUString &columnName, const ::rtl::OUString &matchString) throw(SQLException)
+	: KabConditionCompare(columnName, matchString)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionDifferent::eval(::KABC::Addressee &addressee) const
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	QString aQtName(aFields[m_nFieldNumber]->value(addressee));
+
+	if (aQtName.isNull()) return sal_False;
+
+	::rtl::OUString sValue((const sal_Unicode *) aQtName.ucs2());
+	return sValue != m_sMatchString;
+}
+// -----------------------------------------------------------------------------
+KabConditionSimilar::KabConditionSimilar(const ::rtl::OUString &columnName, const ::rtl::OUString &matchString) throw(SQLException)
+	: KabConditionCompare(columnName, matchString)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionSimilar::eval(::KABC::Addressee &addressee) const
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	QString aQtName(aFields[m_nFieldNumber]->value(addressee));
+
+	if (aQtName.isNull()) return sal_False;
+
+	::rtl::OUString sValue((const sal_Unicode *) aQtName.ucs2());
+	return match(m_sMatchString, sValue, '\0');
+}
+// -----------------------------------------------------------------------------
+KabConditionBoolean::KabConditionBoolean(KabCondition *left, KabCondition *right)
+	: m_pLeft(left),
+          m_pRight(right),
+          KabCondition()
+{
+}
+// -----------------------------------------------------------------------------
+KabConditionBoolean::~KabConditionBoolean()
+{
+	delete m_pLeft;
+	delete m_pRight;
+}
+// -----------------------------------------------------------------------------
+KabConditionOr::KabConditionOr(KabCondition *left, KabCondition *right)
+	: KabConditionBoolean(left, right)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionOr::isAlwaysTrue() const
+{
+	return m_pLeft->isAlwaysTrue() || m_pRight->isAlwaysTrue();
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionOr::isAlwaysFalse() const
+{
+	return m_pLeft->isAlwaysFalse() && m_pRight->isAlwaysFalse();
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionOr::eval(::KABC::Addressee &addressee) const
+{
+	// We avoid evaluating terms as much as we can
+	if (m_pLeft->isAlwaysTrue() || m_pRight->isAlwaysTrue()) return sal_True;
+	if (m_pLeft->isAlwaysFalse() && m_pRight->isAlwaysFalse()) return sal_False;
+
+	if (m_pLeft->eval(addressee)) return sal_True;
+	if (m_pRight->eval(addressee)) return sal_True;
+
+	return sal_False;
+}
+// -----------------------------------------------------------------------------
+KabConditionAnd::KabConditionAnd(KabCondition *left, KabCondition *right)
+	: KabConditionBoolean(left, right)
+{
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionAnd::isAlwaysTrue() const
+{
+	return m_pLeft->isAlwaysTrue() && m_pRight->isAlwaysTrue();
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionAnd::isAlwaysFalse() const
+{
+	return m_pLeft->isAlwaysFalse() || m_pRight->isAlwaysFalse();
+}
+// -----------------------------------------------------------------------------
+sal_Bool KabConditionAnd::eval(::KABC::Addressee &addressee) const
+{
+	// We avoid evaluating terms as much as we can
+	if (m_pLeft->isAlwaysFalse() || m_pRight->isAlwaysFalse()) return sal_False;
+	if (m_pLeft->isAlwaysTrue() && m_pRight->isAlwaysTrue()) return sal_True;
+
+	if (!m_pLeft->eval(addressee)) return sal_False;
+	if (!m_pRight->eval(addressee)) return sal_False;
+
+	return sal_True;
+}
Index: connectivity/source/drivers/kab/KCondition.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KCondition.hxx
diff -N connectivity/source/drivers/kab/KCondition.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KCondition.hxx	29 Aug 2005 08:43:48 -0000	1.1.2.1
@@ -0,0 +1,197 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_CONDITION_HXX_
+#define _CONNECTIVITY_KAB_CONDITION_HXX_
+
+#ifndef _COMPHELPER_TYPES_H_
+#include <comphelper/types.hxx>
+#endif
+#include <kabc/addressee.h>
+
+#ifndef _DBHELPER_DBEXCEPTION_HXX_
+#include <connectivity/dbexception.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+// -----------------------------------------------------------------------------
+class KabCondition
+{
+	public:
+		virtual ~KabCondition();
+		virtual sal_Bool isAlwaysTrue() const = 0;
+		virtual sal_Bool isAlwaysFalse() const = 0;
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const = 0;
+};
+// -----------------------------------------------------------------------------
+class KabConditionConstant : public KabCondition
+{
+	protected:
+		sal_Bool m_bValue;
+
+	public:
+		KabConditionConstant(const sal_Bool value);
+		virtual sal_Bool isAlwaysTrue() const;
+		virtual sal_Bool isAlwaysFalse() const;
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionColumn : public KabCondition
+{
+	protected:
+		sal_Int32 m_nFieldNumber;
+
+	public:
+		KabConditionColumn(
+			const ::rtl::OUString &columnName) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool isAlwaysTrue() const;
+		virtual sal_Bool isAlwaysFalse() const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionNull : public KabConditionColumn
+{
+	public:
+		KabConditionNull(
+			const ::rtl::OUString &columnName) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionNotNull : public KabConditionColumn
+{
+	public:
+		KabConditionNotNull(
+			const ::rtl::OUString &columnName) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionCompare : public KabConditionColumn
+{
+	protected:
+		const ::rtl::OUString m_sMatchString;
+
+	public:
+		KabConditionCompare(
+			const ::rtl::OUString &columnName,
+			const ::rtl::OUString &matchString) throw(::com::sun::star::sdbc::SQLException);
+};
+// -----------------------------------------------------------------------------
+class KabConditionEqual : public KabConditionCompare
+{
+	public:
+		KabConditionEqual(
+			const ::rtl::OUString &columnName,
+			const ::rtl::OUString &matchString) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionDifferent : public KabConditionCompare
+{
+	public:
+		KabConditionDifferent(
+			const ::rtl::OUString &columnName,
+			const ::rtl::OUString &matchString) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionSimilar : public KabConditionCompare
+{
+	public:
+		KabConditionSimilar(
+			const ::rtl::OUString &columnName,
+			const ::rtl::OUString &matchString) throw(::com::sun::star::sdbc::SQLException);
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionBoolean : public KabCondition
+{
+	protected:
+		KabCondition *m_pLeft, *m_pRight;
+
+	public:
+		KabConditionBoolean(KabCondition *left, KabCondition *right);
+		virtual ~KabConditionBoolean();
+};
+// -----------------------------------------------------------------------------
+class KabConditionOr : public KabConditionBoolean
+{
+	public:
+		KabConditionOr(KabCondition *left, KabCondition *right);
+		virtual sal_Bool isAlwaysTrue() const;
+		virtual sal_Bool isAlwaysFalse() const;
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+class KabConditionAnd : public KabConditionBoolean
+{
+	public:
+		KabConditionAnd(KabCondition *left, KabCondition *right);
+		virtual sal_Bool isAlwaysTrue() const;
+		virtual sal_Bool isAlwaysFalse() const;
+		virtual sal_Bool eval(::KABC::Addressee &addressee) const;
+};
+// -----------------------------------------------------------------------------
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_CONDITION_HXX_
Index: connectivity/source/drivers/kab/KConnection.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KConnection.cxx
diff -N connectivity/source/drivers/kab/KConnection.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KConnection.cxx	2 Sep 2005 13:50:49 -0000	1.1.2.4
@@ -0,0 +1,358 @@
+/*************************************************************************
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KConnection.hxx"
+#ifndef _CONNECTIVITY_KAB_DATABASEMETADATA_HXX_
+#include "KDatabaseMetaData.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_STATEMENT_HXX_
+#include "KStatement.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_PREPAREDSTATEMENT_HXX_
+#include "KPreparedStatement.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_DRIVER_HXX_
+#include "KDriver.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CATALOG_HXX_
+#include "KCatalog.hxx"
+#endif
+
+#ifndef _COM_SUN_STAR_SDBC_COLUMNVALUE_HPP_
+#include <com/sun/star/sdbc/ColumnValue.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_TRANSACTIONISOLATION_HPP_
+#include <com/sun/star/sdbc/TransactionIsolation.hpp>
+#endif
+
+using namespace connectivity::kab;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+
+IMPLEMENT_SERVICE_INFO(KabConnection, "com.sun.star.sdbc.drivers.KabConnection", "com.sun.star.sdbc.Connection")
+//-----------------------------------------------------------------------------
+KabConnection::KabConnection(KabDriver*	_pDriver) 
+		 : OSubComponent<KabConnection, KabConnection_BASE>((::cppu::OWeakObject*)_pDriver, this),
+		 OMetaConnection_BASE(m_aMutex),
+		 m_pAddressBook(NULL),
+		 m_pDriver(_pDriver),
+		 m_xMetaData(NULL)
+{
+	m_pDriver->acquire();
+}
+//-----------------------------------------------------------------------------
+KabConnection::~KabConnection()
+{
+	if (!isClosed())
+		close();
+
+	m_pDriver->release();
+	m_pDriver = NULL;
+}
+//-----------------------------------------------------------------------------
+void SAL_CALL KabConnection::release() throw()
+{
+	relase_ChildImpl();
+}
+// -----------------------------------------------------------------------------
+void KabConnection::construct(const ::rtl::OUString& url, const Sequence< PropertyValue >& info) throw(SQLException)
+{
+	osl_incrementInterlockedCount( &m_refCount );
+
+	// create a KDE address book object
+	m_pAddressBook = KABC::StdAddressBook::self();
+	m_pAddressBook->setAutomaticSave(false);
+// perharps we should analyze the URL to know whether the addressbook is local, over LDAP, etc...
+// perharps we should get some user and password information from "info" properties
+
+	osl_decrementInterlockedCount( &m_refCount );
+}
+// XServiceInfo
+// --------------------------------------------------------------------------------
+Reference< XStatement > SAL_CALL KabConnection::createStatement(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// create a statement
+	// the statement can only be executed once
+	Reference< XStatement > xReturn = new KabStatement(this);
+	m_aStatements.push_back(WeakReferenceHelper(xReturn));
+	return xReturn;
+}
+// --------------------------------------------------------------------------------
+Reference< XPreparedStatement > SAL_CALL KabConnection::prepareStatement( const ::rtl::OUString& _sSql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+
+	// create a statement
+	// the statement can only be executed more than once
+	Reference< XPreparedStatement > xReturn = new KabPreparedStatement(this, _sSql);
+	m_aStatements.push_back(WeakReferenceHelper(xReturn));
+	return xReturn;
+}
+// --------------------------------------------------------------------------------
+Reference< XPreparedStatement > SAL_CALL KabConnection::prepareCall( const ::rtl::OUString& _sSql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// not implemented yet :-) a task to do 
+	return NULL;
+}
+// --------------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabConnection::nativeSQL( const ::rtl::OUString& _sSql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	// when you need to transform SQL92 to you driver specific you can do it here
+	
+	return _sSql;
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::setAutoCommit( sal_Bool autoCommit ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+	// here you  have to set your commit mode please have a look at the jdbc documentation to get a clear explanation
+}
+// --------------------------------------------------------------------------------
+sal_Bool SAL_CALL KabConnection::getAutoCommit(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+	// you have to distinguish which if you are in autocommit mode or not
+	// at normal case true should be fine here
+
+	return sal_True;
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::commit(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+
+	// when you database does support transactions you should commit here
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::rollback(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+
+	// same as commit but for the other case
+}
+// --------------------------------------------------------------------------------
+sal_Bool SAL_CALL KabConnection::isClosed(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	
+	// just simple -> we are close when we are disposed taht means someone called dispose(); (XComponent)
+	return KabConnection_BASE::rBHelper.bDisposed;
+}
+// --------------------------------------------------------------------------------
+Reference< XDatabaseMetaData > SAL_CALL KabConnection::getMetaData(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// here we have to create the class with biggest interface
+	// The answer is 42 :-)
+	Reference< XDatabaseMetaData > xMetaData = m_xMetaData;
+	if (!xMetaData.is())
+	{
+		xMetaData = new KabDatabaseMetaData(this); // need the connection because it can return it
+		m_xMetaData = xMetaData;
+	}
+
+	return xMetaData;
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::setReadOnly( sal_Bool readOnly ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// set you connection to readonly
+}
+// --------------------------------------------------------------------------------
+sal_Bool SAL_CALL KabConnection::isReadOnly(  ) throw(SQLException, RuntimeException)
+{	
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// return if your connection to readonly
+	return sal_False;
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::setCatalog( const ::rtl::OUString& catalog ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+
+	// if your database doesn't work with catalogs you go to next method otherwise you kjnow what to do
+}
+// --------------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabConnection::getCatalog(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+
+	// return your current catalog
+	return ::rtl::OUString();
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::setTransactionIsolation( sal_Int32 level ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+
+	// set your isolation level
+	// please have a look at @see com.sun.star.sdbc.TransactionIsolation
+}
+// --------------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabConnection::getTransactionIsolation(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+
+	// please have a look at @see com.sun.star.sdbc.TransactionIsolation
+	return TransactionIsolation::NONE;
+}
+// --------------------------------------------------------------------------------
+Reference< ::com::sun::star::container::XNameAccess > SAL_CALL KabConnection::getTypeMap(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+		
+	// if your driver has special database types you can return it here
+
+	return NULL;
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::setTypeMap( const Reference< ::com::sun::star::container::XNameAccess >& typeMap ) throw(SQLException, RuntimeException)
+{
+	// the other way around
+}
+// --------------------------------------------------------------------------------
+// XCloseable
+void SAL_CALL KabConnection::close(  ) throw(SQLException, RuntimeException)
+{
+	{
+		::osl::MutexGuard aGuard( m_aMutex );
+		checkDisposed(KabConnection_BASE::rBHelper.bDisposed);
+	}
+	dispose();
+}
+// --------------------------------------------------------------------------------
+// XWarningsSupplier
+Any SAL_CALL KabConnection::getWarnings(  ) throw(SQLException, RuntimeException)
+{
+	// when you collected some warnings -> return it
+	return Any();
+}
+// --------------------------------------------------------------------------------
+void SAL_CALL KabConnection::clearWarnings(  ) throw(SQLException, RuntimeException)
+{
+	// you should clear your collected warnings here
+}
+//------------------------------------------------------------------------------
+void KabConnection::disposing()
+{
+	// we noticed that we should be destroied in near future so we have to dispose our statements
+	::osl::MutexGuard aGuard(m_aMutex);
+
+	for (OWeakRefArray::iterator i = m_aStatements.begin(); m_aStatements.end() != i; ++i)
+	{
+		Reference< XComponent > xComp(i->get(), UNO_QUERY);
+		if (xComp.is())
+			xComp->dispose();
+	}
+	m_aStatements.clear();
+
+	if (m_pAddressBook != NULL)
+	{
+		m_pAddressBook->close();
+		m_pAddressBook = NULL;
+	}
+
+	m_xMetaData = ::com::sun::star::uno::WeakReference< ::com::sun::star::sdbc::XDatabaseMetaData>();
+
+	dispose_ChildImpl();
+	KabConnection_BASE::disposing();
+}
+// -----------------------------------------------------------------------------
+Reference< XTablesSupplier > SAL_CALL KabConnection::createCatalog()
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+
+	Reference< XTablesSupplier > xTab = m_xCatalog;
+	if (!m_xCatalog.is())
+	{
+		KabCatalog *pCat = new KabCatalog(this);
+		xTab = pCat;
+		m_xCatalog = xTab;
+	}
+	return xTab;
+}
Index: connectivity/source/drivers/kab/KConnection.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KConnection.hxx
diff -N connectivity/source/drivers/kab/KConnection.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KConnection.hxx	2 Sep 2005 15:57:12 -0000	1.1.2.4
@@ -0,0 +1,187 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#define _CONNECTIVITY_KAB_CONNECTION_HXX_
+
+#include <map>
+#include <kabc/stdaddressbook.h>
+
+#ifndef _CONNECTIVITY_OSUBCOMPONENT_HXX_
+#include "OSubComponent.hxx"
+#endif
+#ifndef _CONNECTIVITY_COMMONTOOLS_HXX_
+#include "connectivity/CommonTools.hxx"
+#endif
+#ifndef _COM_SUN_STAR_LANG_XSERVICEINFO_HPP_
+#include <com/sun/star/lang/XServiceInfo.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_SQLWARNING_HPP_
+#include <com/sun/star/sdbc/SQLWarning.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XWARNINGSSUPPLIER_HPP_
+#include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XCONNECTION_HPP_
+#include <com/sun/star/sdbc/XConnection.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBCX_XTABLESSUPPLIER_HPP_
+#include <com/sun/star/sdbcx/XTablesSupplier.hpp>
+#endif
+#ifndef _COMPHELPER_BROADCASTHELPER_HXX_
+#include <comphelper/broadcasthelper.hxx>
+#endif
+#ifndef _CPPUHELPER_COMPBASE3_HXX_
+#include <cppuhelper/compbase3.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+
+		typedef ::cppu::WeakComponentImplHelper3<   ::com::sun::star::sdbc::XConnection,
+												::com::sun::star::sdbc::XWarningsSupplier,
+                                                ::com::sun::star::lang::XServiceInfo
+											> OMetaConnection_BASE;
+
+		class KabStatement_Base;
+		class KabDriver;
+		class KabDatabaseMetaData;
+
+		typedef OMetaConnection_BASE				KabConnection_BASE; // implements basics and text encoding
+		typedef std::vector< ::com::sun::star::uno::WeakReferenceHelper > OWeakRefArray;
+
+		class KabConnection : public comphelper::OBaseMutex,
+							public KabConnection_BASE,
+							public OSubComponent<KabConnection, KabConnection_BASE>
+		{
+			friend class OSubComponent<KabConnection, KabConnection_BASE>;
+
+		protected:
+			//====================================================================
+			// Data attributes
+			//====================================================================
+			::com::sun::star::uno::WeakReference< ::com::sun::star::sdbc::XDatabaseMetaData > m_xMetaData;
+
+			OWeakRefArray							m_aStatements;	// vector containing a list of all the Statement objects
+																	// for this Connection
+
+			::KABC::StdAddressBook*					m_pAddressBook;	// the address book
+			KabDriver*								m_pDriver;		// pointer to the owning driver object
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbcx::XTablesSupplier>
+													m_xCatalog;		// needed for the SQL interpreter
+
+		public:
+			virtual void construct( const ::rtl::OUString& url,const ::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue >& info) throw(::com::sun::star::sdbc::SQLException);
+
+			KabConnection(KabDriver* _pDriver);
+			virtual ~KabConnection();
+
+			void closeAllStatements () throw( ::com::sun::star::sdbc::SQLException);
+
+			// OComponentHelper
+			virtual void SAL_CALL disposing(void);
+
+			// XInterface
+			virtual void SAL_CALL release() throw();
+
+			// XServiceInfo
+			DECLARE_SERVICE_INFO();
+
+			// XConnection
+            virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XStatement > SAL_CALL createStatement(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XPreparedStatement > SAL_CALL prepareStatement( const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XPreparedStatement > SAL_CALL prepareCall( const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::rtl::OUString SAL_CALL nativeSQL( const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL setAutoCommit( sal_Bool autoCommit ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual sal_Bool SAL_CALL getAutoCommit(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL commit(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL rollback(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual sal_Bool SAL_CALL isClosed(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData > SAL_CALL getMetaData(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL setReadOnly( sal_Bool readOnly ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual sal_Bool SAL_CALL isReadOnly(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL setCatalog( const ::rtl::OUString& catalog ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::rtl::OUString SAL_CALL getCatalog(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL setTransactionIsolation( sal_Int32 level ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual sal_Int32 SAL_CALL getTransactionIsolation(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual ::com::sun::star::uno::Reference< ::com::sun::star::container::XNameAccess > SAL_CALL getTypeMap(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+            virtual void SAL_CALL setTypeMap( const ::com::sun::star::uno::Reference< ::com::sun::star::container::XNameAccess >& typeMap ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XCloseable
+			virtual void SAL_CALL close(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XWarningsSupplier
+			virtual ::com::sun::star::uno::Any SAL_CALL getWarnings(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL clearWarnings(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// needed for the SQL interpreter
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbcx::XTablesSupplier > SAL_CALL createCatalog();
+
+			// accessors
+			inline KabDriver*			getDriver()			const { return m_pDriver;}
+			inline ::KABC::AddressBook*	getAddressBook()	const { return m_pAddressBook; }
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_CONNECTION_HXX_
Index: connectivity/source/drivers/kab/KDatabaseMetaData.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KDatabaseMetaData.cxx
diff -N connectivity/source/drivers/kab/KDatabaseMetaData.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KDatabaseMetaData.cxx	2 Sep 2005 15:57:11 -0000	1.1.2.4
@@ -0,0 +1,1078 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KDatabaseMetaData.hxx"
+#include <kabc/field.h>
+
+#ifndef _CONNECTIVITY_FDATABASEMETADATARESULTSET_HXX_
+#include "FDatabaseMetaDataResultSet.hxx"
+#endif
+#ifndef _CONNECTIVITY_OTYPEINFO_HXX_
+#include "OTypeInfo.hxx"
+#endif
+
+#ifndef _COM_SUN_STAR_SDBC_COLUMNVALUE_HPP_
+#include <com/sun/star/sdbc/ColumnValue.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_RESULTSETTYPE_HPP_
+#include <com/sun/star/sdbc/ResultSetType.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_TRANSACTIONISOLATION_HPP_
+#include <com/sun/star/sdbc/TransactionIsolation.hpp>
+#endif
+
+using namespace connectivity::kab;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+
+KabDatabaseMetaData::KabDatabaseMetaData(KabConnection* _pCon) 
+		: m_xConnection(_pCon),
+		  m_bUseCatalog(sal_True)
+{
+	OSL_ENSURE(m_pConnection,"KabDatabaseMetaData::KabDatabaseMetaData: No connection set!");
+
+	osl_incrementInterlockedCount( &m_refCount );
+	m_bUseCatalog	= !(usesLocalFiles() || usesLocalFilePerTable());
+	osl_decrementInterlockedCount( &m_refCount );
+}
+// -------------------------------------------------------------------------
+KabDatabaseMetaData::~KabDatabaseMetaData()
+{
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getCatalogSeparator(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aVal;
+	if (m_bUseCatalog)
+	{ // do some special here for you database
+	}
+
+	return aVal;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxBinaryLiteralLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxRowSize(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxCatalogNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxCharLiteralLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnsInIndex(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxCursorNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxConnections(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnsInTable(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxStatementLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxTableNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxTablesInSelect(  ) throw(SQLException, RuntimeException)
+{
+	// MaxTablesInSelect describes how many tables can participate in the FROM part of a given SELECT statement,
+	// currently, the resultset/statement implementations can cope with one table only
+	sal_Int32 nValue = 1;
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::doesMaxRowSizeIncludeBlobs(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesLowerCaseQuotedIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesLowerCaseIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesMixedCaseQuotedIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesMixedCaseIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesUpperCaseQuotedIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::storesUpperCaseIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsAlterTableWithAddColumn(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsAlterTableWithDropColumn(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxIndexLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsNonNullableColumns(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getCatalogTerm(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aVal;
+	if (m_bUseCatalog)
+	{
+	}
+	return aVal;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getIdentifierQuoteString(  ) throw(SQLException, RuntimeException)
+{
+	// normally this is "
+	::rtl::OUString aVal = ::rtl::OUString::createFromAscii("\"");
+	return aVal;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getExtraNameCharacters(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aVal;
+	return aVal;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsDifferentTableCorrelationNames(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::isCatalogAtStart(  ) throw(SQLException, RuntimeException)
+{
+	sal_Bool bValue = sal_False;
+	if (m_bUseCatalog)
+	{
+	}
+	return bValue;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::dataDefinitionIgnoredInTransactions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::dataDefinitionCausesTransactionCommit(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsDataManipulationTransactionsOnly(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsDataDefinitionAndDataManipulationTransactions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsPositionedDelete(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsPositionedUpdate(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOpenStatementsAcrossRollback(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOpenStatementsAcrossCommit(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOpenCursorsAcrossCommit(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOpenCursorsAcrossRollback(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsTransactionIsolationLevel( sal_Int32 level ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSchemasInDataManipulation(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsANSI92FullSQL(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsANSI92EntryLevelSQL(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True; // should be supported at least
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsIntegrityEnhancementFacility(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSchemasInIndexDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSchemasInTableDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCatalogsInTableDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCatalogsInIndexDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCatalogsInDataManipulation(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOuterJoins(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxStatements(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxProcedureNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxSchemaNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsTransactions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::allProceduresAreCallable(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsStoredProcedures(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSelectForUpdate(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::allTablesAreSelectable(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::isReadOnly(  ) throw(SQLException, RuntimeException)
+{
+	// for the moment, we have read-only addresses, but this might change in the future
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::usesLocalFiles(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::usesLocalFilePerTable(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsTypeConversion(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::nullPlusNonNullIsNull(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsColumnAliasing(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsTableCorrelationNames(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsConvert( sal_Int32 fromType, sal_Int32 toType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsExpressionsInOrderBy(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsGroupBy(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsGroupByBeyondSelect(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsGroupByUnrelated(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsMultipleTransactions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsMultipleResultSets(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsLikeEscapeClause(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsOrderByUnrelated(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsUnion(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsUnionAll(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsMixedCaseIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsMixedCaseQuotedIdentifiers(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::nullsAreSortedAtEnd(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::nullsAreSortedAtStart(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::nullsAreSortedHigh(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::nullsAreSortedLow(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSchemasInProcedureCalls(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSchemasInPrivilegeDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCatalogsInProcedureCalls(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCatalogsInPrivilegeDefinitions(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCorrelatedSubqueries(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSubqueriesInComparisons(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSubqueriesInExists(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSubqueriesInIns(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsSubqueriesInQuantifieds(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsANSI92IntermediateSQL(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getURL(  ) throw(SQLException, RuntimeException)
+{
+	// if someday we support more than the default address book,
+	// this method should return the URL which was used to create it
+	::rtl::OUString aValue = ::rtl::OUString::createFromAscii("sdbc:address:kab:");
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getUserName(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getDriverName(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue = ::rtl::OUString::createFromAscii("kab");
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getDriverVersion() throw(SQLException, RuntimeException)
+{
+	// version 0.1
+	::rtl::OUString aValue = ::rtl::OUString::createFromAscii("0.1");
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getDatabaseProductVersion(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getDatabaseProductName(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getProcedureTerm(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getSchemaTerm(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getDriverMajorVersion(  ) throw(RuntimeException)
+{
+	return 1;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getDefaultTransactionIsolation(  ) throw(SQLException, RuntimeException)
+{
+	return TransactionIsolation::NONE;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getDriverMinorVersion(  ) throw(RuntimeException)
+{
+	return 0;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getSQLKeywords(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getSearchStringEscape(  ) throw(SQLException, RuntimeException)
+{
+	::rtl::OUString aValue;
+	return aValue;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getStringFunctions(  ) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getTimeDateFunctions(  ) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getSystemFunctions(  ) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDatabaseMetaData::getNumericFunctions(  ) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsExtendedSQLGrammar(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsCoreSQLGrammar(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsMinimumSQLGrammar(  ) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsFullOuterJoins(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsLimitedOuterJoins(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnsInGroupBy(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnsInOrderBy(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxColumnsInSelect(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDatabaseMetaData::getMaxUserNameLength(  ) throw(SQLException, RuntimeException)
+{
+	sal_Int32 nValue = 0; // 0 means no limit
+	return nValue;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsResultSetType( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	switch (setType)
+	{
+		case ResultSetType::FORWARD_ONLY:
+		case ResultSetType::SCROLL_INSENSITIVE:
+			return sal_True;
+	}
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsResultSetConcurrency( sal_Int32 setType, sal_Int32 concurrency ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::ownUpdatesAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::ownDeletesAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::ownInsertsAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::othersUpdatesAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::othersDeletesAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::othersInsertsAreVisible( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::updatesAreDetected( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::deletesAreDetected( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::insertsAreDetected( sal_Int32 setType ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDatabaseMetaData::supportsBatchUpdates(  ) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+Reference< XConnection > SAL_CALL KabDatabaseMetaData::getConnection(  ) throw(SQLException, RuntimeException)
+{
+	return (Reference< XConnection >) m_xConnection.get();
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getTableTypes(  ) throw(SQLException, RuntimeException)
+{
+	::connectivity::ODatabaseMetaDataResultSet* pResult = new ::connectivity::ODatabaseMetaDataResultSet();
+	Reference< XResultSet > xRef = pResult;
+
+	pResult->setTableTypes();
+
+	static ODatabaseMetaDataResultSet::ORows aRows;
+	static const ::rtl::OUString aTable(::rtl::OUString::createFromAscii("TABLE"));
+
+	if (aRows.empty())
+	{
+		ODatabaseMetaDataResultSet::ORow aRow(2);
+		aRow[0] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[1] = new ORowSetValueDecorator(aTable);
+		aRows.push_back(aRow);
+	}
+	pResult->setRows(aRows);
+	return xRef;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getTypeInfo(  ) throw(SQLException, RuntimeException)
+{
+	ODatabaseMetaDataResultSet* pResult = new ODatabaseMetaDataResultSet();
+	Reference< XResultSet > xRef = pResult;
+
+	pResult->setTypeInfoMap();
+
+	static ODatabaseMetaDataResultSet::ORows aRows;
+	if (aRows.empty())
+	{
+		ODatabaseMetaDataResultSet::ORow aRow(19);
+
+		aRow[0] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[1] = new ORowSetValueDecorator(::rtl::OUString::createFromAscii("CHAR"));
+		aRow[2] = new ORowSetValueDecorator(DataType::CHAR);
+		aRow[3] = new ORowSetValueDecorator((sal_Int32) 254);
+		aRow[4] = ODatabaseMetaDataResultSet::getQuoteValue();
+		aRow[5] = ODatabaseMetaDataResultSet::getQuoteValue();
+		aRow[6] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[7] = new ORowSetValueDecorator((sal_Int32) ColumnValue::NULLABLE);
+		aRow[8] = ODatabaseMetaDataResultSet::get1Value();
+		aRow[9] = new ORowSetValueDecorator((sal_Int32) ColumnSearch::CHAR);
+		aRow[10] = ODatabaseMetaDataResultSet::get1Value();
+		aRow[11] = ODatabaseMetaDataResultSet::get0Value();
+		aRow[12] = ODatabaseMetaDataResultSet::get0Value();
+		aRow[13] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[14] = ODatabaseMetaDataResultSet::get0Value();
+		aRow[15] = ODatabaseMetaDataResultSet::get0Value();
+		aRow[16] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[17] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[18] = new ORowSetValueDecorator((sal_Int32) 10);
+		aRows.push_back(aRow);
+// Much more types might appear in KDE address books
+// To be completed
+	}
+	pResult->setRows(aRows);
+	return xRef;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getCatalogs(  ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -----------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getSchemas(  ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getColumnPrivileges( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, 
+	const ::rtl::OUString& columnNamePattern ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getColumns( 
+	const Any& catalog,
+	const ::rtl::OUString& schemaPattern,
+	const ::rtl::OUString& tableNamePattern, 
+	const ::rtl::OUString& columnNamePattern) throw(SQLException, RuntimeException)
+{
+	::connectivity::ODatabaseMetaDataResultSet* pResult = new ::connectivity::ODatabaseMetaDataResultSet();
+	Reference< XResultSet > xRef = pResult;
+
+	pResult->setColumnsMap();
+
+	ODatabaseMetaDataResultSet::ORows aRows;
+	static const ::rtl::OUString aAddresses(::rtl::OUString::createFromAscii("addresses"));
+
+	if (match(tableNamePattern, aAddresses, '\0'))
+	{
+		ODatabaseMetaDataResultSet::ORow aRow(19);
+
+		aRow[0] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[1] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[2] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[3] = new ORowSetValueDecorator(aAddresses);
+		aRow[5] = new ORowSetValueDecorator(DataType::CHAR);
+		aRow[6] = new ORowSetValueDecorator(::rtl::OUString::createFromAscii("CHAR"));
+		aRow[7] = new ORowSetValueDecorator((sal_Int32) 256);
+// Might be VARCHAR and not CHAR[256]...
+		aRow[8] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[9] = ODatabaseMetaDataResultSet::get0Value();
+		aRow[10] = new ORowSetValueDecorator((sal_Int32) 10);
+		aRow[11] = ODatabaseMetaDataResultSet::get1Value();
+		aRow[12] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[13] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[14] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[15] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[16] = new ORowSetValueDecorator((sal_Int32) 254);
+		aRow[18] = new ORowSetValueDecorator(::rtl::OUString::createFromAscii("YES"));
+
+		::KABC::Field::List aFields = ::KABC::Field::allFields();
+		::KABC::Field::List::iterator aField;
+		sal_Int32 nPosition;
+
+		for (	aField = aFields.begin(), nPosition = 1;
+				aField != aFields.end();
+				++aField, ++nPosition)
+		{
+			QString aQtName((*aField)->label());
+			::rtl::OUString aName((const sal_Unicode *) aQtName.ucs2());
+			if (match(columnNamePattern, aName, '\0'))
+			{
+				aRow[4] = new ORowSetValueDecorator(aName);
+				aRow[17] = new ORowSetValueDecorator(nPosition);
+				aRows.push_back(aRow);
+			}
+		}
+	}
+	pResult->setRows(aRows);
+	return xRef;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getTables( 
+	const Any& catalog,
+	const ::rtl::OUString& schemaPattern,
+	const ::rtl::OUString& tableNamePattern,
+	const Sequence< ::rtl::OUString >& types) throw(SQLException, RuntimeException)
+{
+	ODatabaseMetaDataResultSet* pResult = new ODatabaseMetaDataResultSet();
+	Reference< XResultSet > xRef = pResult;
+
+	pResult->setTablesMap();
+
+	// check whether we have tables in the requested types
+	// for the moment, we answer only the "TABLE" table type
+	// when no types are given at all, we return all the tables
+	static const ::rtl::OUString aTable(::rtl::OUString::createFromAscii("TABLE"));
+	sal_Bool bTableFound = sal_False;
+	const ::rtl::OUString* p = types.getConstArray(),
+	                     * pEnd = p + types.getLength();
+
+	if (p == pEnd)
+	{
+		bTableFound = sal_True;
+	}
+	else while (p < pEnd)
+	{
+		if (match(*p, aTable, '\0'))
+		{
+			bTableFound = sal_True;
+			break;
+		}
+		p++;
+	}
+	if (!bTableFound)
+		return xRef;
+
+	static ODatabaseMetaDataResultSet::ORows aRows;
+	static const ::rtl::OUString aAddresses(::rtl::OUString::createFromAscii("addresses"));
+
+	if (aRows.empty())
+	{
+		ODatabaseMetaDataResultSet::ORow aRow(6);
+
+		aRow[0] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[1] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[2] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRow[3] = new ORowSetValueDecorator(aAddresses);
+		aRow[4] = new ORowSetValueDecorator(aTable);
+		aRow[5] = ODatabaseMetaDataResultSet::getEmptyValue();
+		aRows.push_back(aRow);
+	}
+	pResult->setRows(aRows);
+	return xRef;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getProcedureColumns( 
+	const Any& catalog, const ::rtl::OUString& schemaPattern, 
+	const ::rtl::OUString& procedureNamePattern, const ::rtl::OUString& columnNamePattern ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getProcedures( 
+	const Any& catalog, const ::rtl::OUString& schemaPattern, 
+	const ::rtl::OUString& procedureNamePattern ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getVersionColumns( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getExportedKeys( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getImportedKeys( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getPrimaryKeys( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getIndexInfo( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, 
+	sal_Bool unique, sal_Bool approximate ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getBestRowIdentifier( 
+	const Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, sal_Int32 scope, 
+	sal_Bool nullable ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getTablePrivileges( 
+	const Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& tableNamePattern ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getCrossReference( 
+	const Any& primaryCatalog, const ::rtl::OUString& primarySchema, 
+	const ::rtl::OUString& primaryTable, const Any& foreignCatalog, 
+	const ::rtl::OUString& foreignSchema, const ::rtl::OUString& foreignTable ) throw(SQLException, RuntimeException)
+{
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabDatabaseMetaData::getUDTs( const Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& typeNamePattern, const Sequence< sal_Int32 >& types ) throw(SQLException, RuntimeException)
+{
+	OSL_ENSURE(0,"Not implemented yet!");
+	throw SQLException();
+	return NULL;
+}
+// -----------------------------------------------------------------------------
Index: connectivity/source/drivers/kab/KDatabaseMetaData.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KDatabaseMetaData.hxx
diff -N connectivity/source/drivers/kab/KDatabaseMetaData.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KDatabaseMetaData.hxx	2 Sep 2005 15:57:11 -0000	1.1.2.2
@@ -0,0 +1,253 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_DATABASEMETADATA_HXX_
+#define _CONNECTIVITY_KAB_DATABASEMETADATA_HXX_
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#ifndef _COM_SUN_STAR_SDBC_XDATABASEMETADATA_HPP_
+#include <com/sun/star/sdbc/XDatabaseMetaData.hpp>
+#endif
+#ifndef _CPPUHELPER_IMPLBASE1_HXX_
+#include <cppuhelper/implbase1.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		//**************************************************************
+		//************ Class: KabDatabaseMetaData
+		//**************************************************************
+
+		typedef ::cppu::WeakImplHelper1< ::com::sun::star::sdbc::XDatabaseMetaData> KabDatabaseMetaData_BASE;
+
+		class KabDatabaseMetaData : public KabDatabaseMetaData_BASE
+		{
+			::com::sun::star::uno::Reference< KabConnection > m_xConnection;
+			sal_Bool		m_bUseCatalog;
+
+		public:
+
+			inline KabConnection* getOwnConnection() const { return m_xConnection.get(); }
+
+			KabDatabaseMetaData(KabConnection* _pCon);
+			virtual ~KabDatabaseMetaData();
+
+			// this interface is really BIG
+			// XDatabaseMetaData
+			virtual sal_Bool SAL_CALL allProceduresAreCallable(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL allTablesAreSelectable(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getURL(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getUserName(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isReadOnly(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL nullsAreSortedHigh(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL nullsAreSortedLow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL nullsAreSortedAtStart(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL nullsAreSortedAtEnd(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getDatabaseProductName(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getDatabaseProductVersion(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getDriverName(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getDriverVersion(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getDriverMajorVersion(  ) throw(::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getDriverMinorVersion(  ) throw(::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL usesLocalFiles(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL usesLocalFilePerTable(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsMixedCaseIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesUpperCaseIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesLowerCaseIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesMixedCaseIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsMixedCaseQuotedIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesUpperCaseQuotedIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesLowerCaseQuotedIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL storesMixedCaseQuotedIdentifiers(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getIdentifierQuoteString(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getSQLKeywords(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getNumericFunctions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getStringFunctions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getSystemFunctions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getTimeDateFunctions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getSearchStringEscape(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getExtraNameCharacters(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsAlterTableWithAddColumn(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsAlterTableWithDropColumn(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsColumnAliasing(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL nullPlusNonNullIsNull(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsTypeConversion(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsConvert( sal_Int32 fromType, sal_Int32 toType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsTableCorrelationNames(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsDifferentTableCorrelationNames(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsExpressionsInOrderBy(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOrderByUnrelated(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsGroupBy(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsGroupByUnrelated(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsGroupByBeyondSelect(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsLikeEscapeClause(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsMultipleResultSets(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsMultipleTransactions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsNonNullableColumns(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsMinimumSQLGrammar(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCoreSQLGrammar(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsExtendedSQLGrammar(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsANSI92EntryLevelSQL(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsANSI92IntermediateSQL(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsANSI92FullSQL(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsIntegrityEnhancementFacility(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOuterJoins(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsFullOuterJoins(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsLimitedOuterJoins(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getSchemaTerm(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getProcedureTerm(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getCatalogTerm(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isCatalogAtStart(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getCatalogSeparator(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSchemasInDataManipulation(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSchemasInProcedureCalls(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSchemasInTableDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSchemasInIndexDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSchemasInPrivilegeDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCatalogsInDataManipulation(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCatalogsInProcedureCalls(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCatalogsInTableDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCatalogsInIndexDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCatalogsInPrivilegeDefinitions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsPositionedDelete(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsPositionedUpdate(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSelectForUpdate(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsStoredProcedures(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSubqueriesInComparisons(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSubqueriesInExists(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSubqueriesInIns(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsSubqueriesInQuantifieds(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsCorrelatedSubqueries(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsUnion(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsUnionAll(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOpenCursorsAcrossCommit(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOpenCursorsAcrossRollback(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOpenStatementsAcrossCommit(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsOpenStatementsAcrossRollback(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxBinaryLiteralLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxCharLiteralLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnsInGroupBy(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnsInIndex(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnsInOrderBy(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnsInSelect(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxColumnsInTable(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxConnections(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxCursorNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxIndexLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxSchemaNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxProcedureNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxCatalogNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxRowSize(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL doesMaxRowSizeIncludeBlobs(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxStatementLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxStatements(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxTableNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxTablesInSelect(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMaxUserNameLength(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getDefaultTransactionIsolation(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsTransactions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsTransactionIsolationLevel( sal_Int32 level ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsDataDefinitionAndDataManipulationTransactions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsDataManipulationTransactionsOnly(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL dataDefinitionCausesTransactionCommit(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL dataDefinitionIgnoredInTransactions(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getProcedures( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& procedureNamePattern ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getProcedureColumns( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& procedureNamePattern, const ::rtl::OUString& columnNamePattern ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getTables( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& tableNamePattern, const ::com::sun::star::uno::Sequence< ::rtl::OUString >& types ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getSchemas(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getCatalogs(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getTableTypes(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getColumns( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& tableNamePattern, const ::rtl::OUString& columnNamePattern ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getColumnPrivileges( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, const ::rtl::OUString& columnNamePattern ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getTablePrivileges( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& tableNamePattern ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getBestRowIdentifier( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, sal_Int32 scope, sal_Bool nullable ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getVersionColumns( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getPrimaryKeys( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getImportedKeys( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getExportedKeys( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getCrossReference( const ::com::sun::star::uno::Any& primaryCatalog, const ::rtl::OUString& primarySchema, const ::rtl::OUString& primaryTable, const ::com::sun::star::uno::Any& foreignCatalog, const ::rtl::OUString& foreignSchema, const ::rtl::OUString& foreignTable ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getTypeInfo(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getIndexInfo( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schema, const ::rtl::OUString& table, sal_Bool unique, sal_Bool approximate ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsResultSetType( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsResultSetConcurrency( sal_Int32 setType, sal_Int32 concurrency ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL ownUpdatesAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL ownDeletesAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL ownInsertsAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL othersUpdatesAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL othersDeletesAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL othersInsertsAreVisible( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL updatesAreDetected( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL deletesAreDetected( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL insertsAreDetected( sal_Int32 setType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsBatchUpdates(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL getUDTs( const ::com::sun::star::uno::Any& catalog, const ::rtl::OUString& schemaPattern, const ::rtl::OUString& typeNamePattern, const ::com::sun::star::uno::Sequence< sal_Int32 >& types ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_DATABASEMETADATA_HXX_
Index: connectivity/source/drivers/kab/KDriver.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KDriver.cxx
diff -N connectivity/source/drivers/kab/KDriver.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KDriver.cxx	1 Sep 2005 20:06:23 -0000	1.1.2.2
@@ -0,0 +1,230 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KDriver.hxx"
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#include <kcmdlineargs.h>
+#include <kglobal.h>
+#include <klocale.h>
+
+#ifndef _OSL_PROCESS_H_
+#include <osl/process.h>
+#endif
+
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace connectivity::kab;
+
+KabDriver::KabDriver(
+	const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory) 
+	: KDriver_BASE(m_aMutex),
+	  m_xMSFactory(_rxFactory),
+	  m_pKApplication(NULL)
+{
+	// we create a KDE application only if it is not already done
+	if (KApplication::kApplication() == NULL)
+	{
+		// version 0.1
+		char *kabargs[1] = {"libkab1"};
+		KCmdLineArgs::init(1, kabargs, "KAddressBook", *kabargs, "Address Book driver", "0.1");
+
+		m_pKApplication = new KApplication(false, false);
+// It would be better to call this constructor with a "Display" argument
+// Especially if OOo is run on diplay :1...
+	}
+
+	// set language
+	rtl_Locale *pProcessLocale;
+	osl_getProcessLocale(&pProcessLocale);
+	// sal_Unicode and QChar are (currently) both 16 bits characters
+	QString aLanguage(
+		(const QChar *) pProcessLocale->Language->buffer,
+		(int) pProcessLocale->Language->length);
+	KGlobal::locale()->setLanguage(aLanguage);
+}
+// --------------------------------------------------------------------------------
+void KabDriver::disposing()
+{
+	::osl::MutexGuard aGuard(m_aMutex);
+
+	// when driver will be destroied so all our connections have to be destroied as well
+	for (OWeakRefArray::iterator i = m_xConnections.begin(); m_xConnections.end() != i; ++i)
+	{
+		Reference< XComponent > xComp(i->get(), UNO_QUERY);
+		if (xComp.is())
+			xComp->dispose();
+	}
+	m_xConnections.clear();
+
+	if (m_pKApplication != NULL)
+	{
+		delete m_pKApplication;
+		m_pKApplication = NULL;
+	}
+
+	KDriver_BASE::disposing();
+}
+// static ServiceInfo
+//------------------------------------------------------------------------------
+rtl::OUString KabDriver::getImplementationName_Static(  ) throw(RuntimeException)
+{
+	return rtl::OUString::createFromAscii("com.sun.star.comp.sdbc.kab.Driver");
+		// this name is referenced in the configuration and in the kab.xml
+		// Please be careful when changing it.
+}
+//------------------------------------------------------------------------------
+Sequence< ::rtl::OUString > KabDriver::getSupportedServiceNames_Static(  ) throw (RuntimeException)
+{
+	// which service is supported 
+	// for more information @see com.sun.star.sdbc.Driver
+	Sequence< ::rtl::OUString > aSNS( 1 );
+	aSNS[0] = ::rtl::OUString::createFromAscii("com.sun.star.sdbc.Driver");
+
+	return aSNS;
+}
+//------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabDriver::getImplementationName(  ) throw(RuntimeException)
+{
+	return getImplementationName_Static();
+}
+//------------------------------------------------------------------
+sal_Bool SAL_CALL KabDriver::supportsService( const ::rtl::OUString& _rServiceName ) throw(RuntimeException)
+{
+	Sequence< ::rtl::OUString > aSupported(getSupportedServiceNames());
+	const ::rtl::OUString* pSupported = aSupported.getConstArray();
+	const ::rtl::OUString* pEnd = pSupported + aSupported.getLength();
+
+	while (pSupported != pEnd && !pSupported->equals(_rServiceName))
+		++pSupported;
+	return pSupported != pEnd;
+}
+//------------------------------------------------------------------
+Sequence< ::rtl::OUString > SAL_CALL KabDriver::getSupportedServiceNames(  ) throw(RuntimeException)
+{
+	return getSupportedServiceNames_Static();
+}
+// --------------------------------------------------------------------------------
+Reference< XConnection > SAL_CALL KabDriver::connect( const ::rtl::OUString& url, const Sequence< PropertyValue >& info ) throw(SQLException, RuntimeException)
+{
+	// create a new connection with the given properties and append it to our vector
+	KabConnection* pCon = new KabConnection(this);
+	Reference< XConnection > xCon = pCon;	// important here because otherwise the connection could be deleted inside (refcount goes -> 0)
+	pCon->construct(url,info);				// late constructor call which can throw exception and allows a correct dtor call when so
+	m_xConnections.push_back(WeakReferenceHelper(*pCon));
+	
+	return xCon;
+}
+// --------------------------------------------------------------------------------
+sal_Bool SAL_CALL KabDriver::acceptsURL( const ::rtl::OUString& url ) 
+		throw(SQLException, RuntimeException)
+{
+	// here we have to look whether we support this URL format
+	return (!url.compareTo(::rtl::OUString::createFromAscii("sdbc:address:kab:"), 16));
+}
+// --------------------------------------------------------------------------------
+Sequence< DriverPropertyInfo > SAL_CALL KabDriver::getPropertyInfo( const ::rtl::OUString& url, const Sequence< PropertyValue >& info ) throw(SQLException, RuntimeException)
+{
+	// if you have something special to say, return it here :-)
+	return Sequence< DriverPropertyInfo >();
+}
+// --------------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDriver::getMajorVersion(  ) throw(RuntimeException)
+{
+	// version 0.1
+	return 0;
+}
+// --------------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabDriver::getMinorVersion(  ) throw(RuntimeException)
+{
+	// version 0.1
+	return 1;
+}
+// --------------------------------------------------------------------------------
+
+//.........................................................................
+namespace connectivity
+{
+	namespace kab
+	{
+//.........................................................................
+
+::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >  SAL_CALL KabDriver_CreateInstance(
+		const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory
+		) throw( ::com::sun::star::uno::Exception )
+{
+	return *(new KabDriver(_rxFactory));
+}
+
+void checkDisposed(sal_Bool _bThrow) throw ( DisposedException )
+{
+	if (_bThrow)
+		throw DisposedException();
+}
+
+//.........................................................................
+	}
+}
+//.........................................................................
Index: connectivity/source/drivers/kab/KDriver.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KDriver.hxx
diff -N connectivity/source/drivers/kab/KDriver.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KDriver.hxx	29 Aug 2005 08:43:50 -0000	1.1.2.1
@@ -0,0 +1,127 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_DRIVER_HXX_
+#define _CONNECTIVITY_KAB_DRIVER_HXX_
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#include <kapplication.h>
+
+#ifndef _COM_SUN_STAR_SDBC_XDRIVER_HPP_
+#include <com/sun/star/sdbc/XDriver.hpp>
+#endif
+#ifndef _CPPUHELPER_COMPBASE2_HXX_
+#include <cppuhelper/compbase2.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > SAL_CALL KabDriver_CreateInstance(const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory) throw( ::com::sun::star::uno::Exception );
+
+		typedef ::cppu::WeakComponentImplHelper2<	::com::sun::star::sdbc::XDriver, 
+													::com::sun::star::lang::XServiceInfo > KDriver_BASE;
+
+		class KabDriver : public KDriver_BASE
+		{
+		protected:
+			KApplication*				m_pKApplication;	// KDE application if we own it
+			::osl::Mutex				m_aMutex;			// mutex is need to control member access
+			OWeakRefArray				m_xConnections;		// vector containing a list of all the
+															//  KabConnection objects for this Driver
+			::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >
+										m_xMSFactory;		// the multi-service factory
+
+		public:
+
+			KabDriver(const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >& _rxFactory);
+
+			// OComponentHelper
+			virtual void SAL_CALL disposing(void);
+
+			// XInterface
+			static ::rtl::OUString getImplementationName_Static(  ) throw(::com::sun::star::uno::RuntimeException);
+			static ::com::sun::star::uno::Sequence< ::rtl::OUString > getSupportedServiceNames_Static(  ) throw (::com::sun::star::uno::RuntimeException);
+
+			// XServiceInfo
+			virtual ::rtl::OUString SAL_CALL getImplementationName(  ) throw(::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL supportsService( const ::rtl::OUString& ServiceName ) throw(::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Sequence< ::rtl::OUString > SAL_CALL getSupportedServiceNames(  ) throw(::com::sun::star::uno::RuntimeException);
+
+			// XDriver
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL connect( const ::rtl::OUString& url, const ::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue >& info ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL acceptsURL( const ::rtl::OUString& url ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Sequence< ::com::sun::star::sdbc::DriverPropertyInfo > SAL_CALL getPropertyInfo( const ::rtl::OUString& url, const ::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue >& info ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMajorVersion() throw(::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getMinorVersion() throw(::com::sun::star::uno::RuntimeException);
+
+			const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >&
+					getMSFactory() const { return m_xMSFactory; }
+		};
+	}
+
+}
+
+#endif // _CONNECTIVITY_KAB_DRIVER_HXX_
Index: connectivity/source/drivers/kab/KPreparedStatement.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KPreparedStatement.cxx
diff -N connectivity/source/drivers/kab/KPreparedStatement.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KPreparedStatement.cxx	2 Sep 2005 13:50:50 -0000	1.1.2.5
@@ -0,0 +1,340 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KPreparedStatement.hxx"
+
+#ifndef _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+#include "KResultSetMetaData.hxx"
+#endif
+
+#ifndef _CONNECTIVITY_PROPERTYIDS_HXX_
+#include "propertyids.hxx"
+#endif
+
+using namespace connectivity::kab;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+
+IMPLEMENT_SERVICE_INFO(KabPreparedStatement, "com.sun.star.sdbc.drivers.KabPreparedStatement", "com.sun.star.sdbc.PreparedStatement");
+// -------------------------------------------------------------------------
+KabPreparedStatement::KabPreparedStatement(
+	KabConnection* _pConnection,
+	const ::rtl::OUString& sql)
+	: KabPreparedStatement_BASE(_pConnection),
+	  m_bPrepared(sal_False),
+	  m_sSqlStatement(sql)
+{
+}
+// -------------------------------------------------------------------------
+KabPreparedStatement::~KabPreparedStatement()
+{
+}
+// -------------------------------------------------------------------------
+Reference< XResultSetMetaData > SAL_CALL KabPreparedStatement::getMetaData() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+	if (!m_xMetaData.is())
+		m_xMetaData = new KabResultSetMetaData(getOwnConnection());
+	return m_xMetaData;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::close() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+	// Reset last warning message
+	try {
+		clearWarnings ();
+		KabCommonStatement::close();
+	}
+	catch (SQLException &) {
+		// If we get an error, ignore
+	}
+
+	// Remove this Statement object from the Connection object's
+	// list
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabPreparedStatement::execute() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	Reference< XResultSet> xRS = KabCommonStatement::executeQuery(m_sSqlStatement);
+
+	return xRS.is();
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabPreparedStatement::executeUpdate() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+	// same as in statement with the difference that this statement also can contain parameter
+	return 0;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setString(sal_Int32 parameterIndex, const ::rtl::OUString& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+Reference< XConnection > SAL_CALL KabPreparedStatement::getConnection() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	return (Reference< XConnection >) m_pConnection;
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabPreparedStatement::executeQuery() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	Reference< XResultSet > rs = KabCommonStatement::executeQuery(m_sSqlStatement);
+
+	return rs;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setBoolean(sal_Int32 parameterIndex, sal_Bool x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setByte(sal_Int32 parameterIndex, sal_Int8 x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setDate(sal_Int32 parameterIndex, const Date& aData) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setTime(sal_Int32 parameterIndex, const Time& aVal) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setTimestamp(sal_Int32 parameterIndex, const DateTime& aVal) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setDouble(sal_Int32 parameterIndex, double x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setFloat(sal_Int32 parameterIndex, float x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setInt(sal_Int32 parameterIndex, sal_Int32 x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setLong(sal_Int32 parameterIndex, sal_Int64 aVal) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setNull(sal_Int32 parameterIndex, sal_Int32 sqlType) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setClob(sal_Int32 parameterIndex, const Reference< XClob >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setBlob(sal_Int32 parameterIndex, const Reference< XBlob >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setArray(sal_Int32 parameterIndex, const Reference< XArray >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+
+void SAL_CALL KabPreparedStatement::setRef(sal_Int32 parameterIndex, const Reference< XRef >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setObjectWithInfo(sal_Int32 parameterIndex, const Any& x, sal_Int32 sqlType, sal_Int32 scale) throw(SQLException, RuntimeException)
+{
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+	::osl::MutexGuard aGuard( m_aMutex );	
+
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setObjectNull(sal_Int32 parameterIndex, sal_Int32 sqlType, const ::rtl::OUString& typeName) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setObject(sal_Int32 parameterIndex, const Any& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setShort(sal_Int32 parameterIndex, sal_Int16 x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setBytes(sal_Int32 parameterIndex, const Sequence< sal_Int8 >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setCharacterStream(sal_Int32 parameterIndex, const Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::setBinaryStream(sal_Int32 parameterIndex, const Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabPreparedStatement::clearParameters() throw(SQLException, RuntimeException)
+{
+}
+// -------------------------------------------------------------------------
+void KabPreparedStatement::setFastPropertyValue_NoBroadcast(sal_Int32 nHandle,const Any& rValue) throw (Exception)
+{
+	switch (nHandle)
+	{
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+			break;
+		case PROPERTY_ID_RESULTSETTYPE:
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+			break;
+		case PROPERTY_ID_USEBOOKMARKS:
+			break;
+		default:
+			KabCommonStatement::setFastPropertyValue_NoBroadcast(nHandle,rValue);
+	}
+}
+// -----------------------------------------------------------------------------
+void KabPreparedStatement::checkParameterIndex(sal_Int32 _parameterIndex)
+{
+	// no parameters allowed in this implementation
+	throw SQLException();
+}
Index: connectivity/source/drivers/kab/KPreparedStatement.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KPreparedStatement.hxx
diff -N connectivity/source/drivers/kab/KPreparedStatement.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KPreparedStatement.hxx	2 Sep 2005 02:42:03 -0000	1.1.2.4
@@ -0,0 +1,166 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_PREPAREDSTATEMENT_HXX_
+#define _CONNECTIVITY_KAB_PREPAREDSTATEMENT_HXX_
+
+#ifndef _CONNECTIVITY_KAB_STATEMENT_HXX_
+#include "KStatement.hxx"
+#endif
+
+#ifndef _COM_SUN_STAR_SDBC_XPARAMETERS_HPP_
+#include <com/sun/star/sdbc/XParameters.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XRESULTSETMETADATASUPPLIER_HPP_
+#include <com/sun/star/sdbc/XResultSetMetaDataSupplier.hpp>
+#endif
+#ifndef _CPPUHELPER_IMPLBASE4_HXX_
+#include <cppuhelper/implbase4.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+
+		class OBoundParam;
+		typedef ::cppu::ImplInheritanceHelper4<	KabCommonStatement,
+												::com::sun::star::sdbc::XPreparedStatement,
+												::com::sun::star::sdbc::XParameters,
+												::com::sun::star::sdbc::XResultSetMetaDataSupplier,
+												::com::sun::star::lang::XServiceInfo> KabPreparedStatement_BASE;
+
+		class KabPreparedStatement : public  KabPreparedStatement_BASE
+		{
+		protected:
+			struct Parameter
+			{
+				::com::sun::star::uno::Any	aValue;
+				sal_Int32					nDataType;
+
+				Parameter(const ::com::sun::star::uno::Any&	rValue,
+						  sal_Int32							rDataType) : aValue(rValue),nDataType(rDataType)
+				{
+				}
+
+			};
+
+			::std::vector< Parameter>		m_aParameters;
+			//====================================================================
+			// Data attributes
+			//====================================================================
+			::rtl::OUString					m_sSqlStatement;
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData >	m_xMetaData;
+			sal_Bool						m_bPrepared;
+
+			void checkParameterIndex(sal_Int32 _parameterIndex);
+
+		protected:
+			virtual void SAL_CALL setFastPropertyValue_NoBroadcast(
+					sal_Int32 nHandle,
+					const ::com::sun::star::uno::Any& rValue) throw (::com::sun::star::uno::Exception);
+			virtual ~KabPreparedStatement();
+
+		public:
+			DECLARE_SERVICE_INFO();
+			KabPreparedStatement(KabConnection* _pConnection, const ::rtl::OUString& sql);
+
+			// XPreparedStatement
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL executeQuery(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL executeUpdate(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL execute(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XParameters
+			virtual void SAL_CALL setNull( sal_Int32 parameterIndex, sal_Int32 sqlType ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setObjectNull( sal_Int32 parameterIndex, sal_Int32 sqlType, const ::rtl::OUString& typeName ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setBoolean( sal_Int32 parameterIndex, sal_Bool x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setByte( sal_Int32 parameterIndex, sal_Int8 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setShort( sal_Int32 parameterIndex, sal_Int16 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setInt( sal_Int32 parameterIndex, sal_Int32 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setLong( sal_Int32 parameterIndex, sal_Int64 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setFloat( sal_Int32 parameterIndex, float x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setDouble( sal_Int32 parameterIndex, double x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setString( sal_Int32 parameterIndex, const ::rtl::OUString& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setBytes( sal_Int32 parameterIndex, const ::com::sun::star::uno::Sequence< sal_Int8 >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setDate( sal_Int32 parameterIndex, const ::com::sun::star::util::Date& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setTime( sal_Int32 parameterIndex, const ::com::sun::star::util::Time& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setTimestamp( sal_Int32 parameterIndex, const ::com::sun::star::util::DateTime& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setBinaryStream( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setCharacterStream( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setObject( sal_Int32 parameterIndex, const ::com::sun::star::uno::Any& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setObjectWithInfo( sal_Int32 parameterIndex, const ::com::sun::star::uno::Any& x, sal_Int32 targetSqlType, sal_Int32 scale ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setRef( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XRef >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setBlob( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XBlob >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setClob( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XClob >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL setArray( sal_Int32 parameterIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XArray >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL clearParameters(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XCloseable
+            virtual void SAL_CALL close(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XResultSetMetaDataSupplier
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData > SAL_CALL getMetaData(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_PREPAREDSTATEMENT_HXX_
Index: connectivity/source/drivers/kab/KResultSet.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KResultSet.cxx
diff -N connectivity/source/drivers/kab/KResultSet.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KResultSet.cxx	2 Sep 2005 15:22:52 -0000	1.1.2.6
@@ -0,0 +1,882 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KResultSet.hxx"
+#ifndef _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+#include "KResultSetMetaData.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CONDITION_HXX_
+#include "KCondition.hxx"
+#endif
+#include <kabc/addressbook.h>
+
+#ifndef _COM_SUN_STAR_BEANS_PROPERTYATTRIBUTE_HPP_
+#include <com/sun/star/beans/PropertyAttribute.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBCX_COMPAREBOOKMARK_HPP_
+#include <com/sun/star/sdbcx/CompareBookmark.hpp>
+#endif
+#ifndef CONNECTIVITY_CONNECTION_HXX
+#include "TConnection.hxx"
+#endif
+#ifndef _DBHELPER_DBEXCEPTION_HXX_
+#include <connectivity/dbexception.hxx>
+#endif
+
+using namespace connectivity::kab;
+using namespace cppu;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+
+IMPLEMENT_SERVICE_INFO(KabResultSet, "com.sun.star.sdbc.drivers.KabResultSet", "com.sun.star.sdbc.ResultSet");
+// -------------------------------------------------------------------------
+KabResultSet::KabResultSet(KabCommonStatement* pStmt) 
+	: KabResultSet_BASE(m_aMutex),
+	  OPropertySetHelper(KabResultSet_BASE::rBHelper),
+	  m_xStatement(pStmt),
+	  m_xMetaData(NULL),
+	  m_aKabAddressees(),
+	  m_nRowPos(-1),
+	  m_bWasNull(sal_True)
+{
+}
+// -------------------------------------------------------------------------
+KabResultSet::~KabResultSet()
+{
+}
+// -------------------------------------------------------------------------
+void KabResultSet::allKabAddressees()
+{
+	KabCommonStatement* pStatement = m_xStatement.get();
+	KabConnection* pConnection = (KabConnection *) pStatement->getConnection().get();
+	KABC::AddressBook* pAddressBook = pConnection->getAddressBook();
+
+	m_aKabAddressees = pAddressBook->allAddressees();
+}
+// -------------------------------------------------------------------------
+void KabResultSet::someKabAddressees(const KabCondition *pCondition)
+{
+	KabCommonStatement* pStatement = m_xStatement.get();
+	KabConnection* pConnection = (KabConnection *) pStatement->getConnection().get();
+	KABC::AddressBook* pAddressBook = pConnection->getAddressBook();
+
+	KABC::AddressBook::Iterator iterator;
+
+	for (iterator = pAddressBook->begin();
+	     iterator != pAddressBook->end();
+	     ++iterator)
+	{
+		if (pCondition->eval(*iterator))
+			m_aKabAddressees.push_back(*iterator);
+	}
+}
+// -------------------------------------------------------------------------
+void KabResultSet::disposing()
+{
+	OPropertySetHelper::disposing();
+
+	::osl::MutexGuard aGuard(m_aMutex);
+
+	m_xStatement	= NULL;
+	m_xMetaData		= NULL;
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL KabResultSet::queryInterface(const Type & rType) throw(RuntimeException)
+{
+	Any aRet = OPropertySetHelper::queryInterface(rType);
+	if (!aRet.hasValue())
+		aRet = KabResultSet_BASE::queryInterface(rType);
+	return aRet;
+}
+// -------------------------------------------------------------------------
+Sequence<  Type > SAL_CALL KabResultSet::getTypes() throw(RuntimeException)
+{
+	OTypeCollection aTypes(
+		::getCppuType( (const Reference< ::com::sun::star::beans::XMultiPropertySet >*) 0),
+		::getCppuType( (const Reference< ::com::sun::star::beans::XFastPropertySet >*) 0),
+		::getCppuType( (const Reference< ::com::sun::star::beans::XPropertySet >*) 0));
+
+	return comphelper::concatSequences(aTypes.getTypes(), KabResultSet_BASE::getTypes());
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSet::findColumn(const ::rtl::OUString& columnName) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	// find the first column with the name columnName 
+	Reference< XResultSetMetaData > xMeta = getMetaData();
+	sal_Int32 nLen = xMeta->getColumnCount(),
+	          i;
+
+	for (i = 1; i <= nLen; ++i)
+		if (xMeta->isCaseSensitive(i) ?
+			columnName == xMeta->getColumnName(i) : 
+			columnName.equalsIgnoreAsciiCase(xMeta->getColumnName(i)))
+				return i;
+
+	::dbtools::throwGenericSQLException(
+		::rtl::OUString::createFromAscii("Invalid column name: ") + columnName,
+		NULL);
+}
+// -------------------------------------------------------------------------
+Reference< XInputStream > SAL_CALL KabResultSet::getBinaryStream(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XInputStream > SAL_CALL KabResultSet::getCharacterStream(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::getBoolean(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int8 SAL_CALL KabResultSet::getByte(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int8 nRet = 0;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+Sequence< sal_Int8 > SAL_CALL KabResultSet::getBytes(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	return Sequence< sal_Int8 >();
+}
+// -------------------------------------------------------------------------
+Date SAL_CALL KabResultSet::getDate(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	Date nRet;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+double SAL_CALL KabResultSet::getDouble(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	double nRet = 0;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+float SAL_CALL KabResultSet::getFloat(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	float nVal(0);
+	return nVal;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSet::getInt(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	sal_Int32 nRet=0;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSet::getRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return m_nRowPos;
+}
+// -------------------------------------------------------------------------
+sal_Int64 SAL_CALL KabResultSet::getLong(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	return sal_Int64();
+}
+// -------------------------------------------------------------------------
+Reference< XResultSetMetaData > SAL_CALL KabResultSet::getMetaData() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	if (!m_xMetaData.is())
+		m_xMetaData = new KabResultSetMetaData(m_xStatement.get()->getOwnConnection());
+
+	return m_xMetaData;
+}
+// -------------------------------------------------------------------------
+Reference< XArray > SAL_CALL KabResultSet::getArray(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XClob > SAL_CALL KabResultSet::getClob(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XBlob > SAL_CALL KabResultSet::getBlob(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Reference< XRef > SAL_CALL KabResultSet::getRef(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return NULL;
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL KabResultSet::getObject(sal_Int32 columnIndex, const Reference< ::com::sun::star::container::XNameAccess >& typeMap) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return Any();
+}
+// -------------------------------------------------------------------------
+sal_Int16 SAL_CALL KabResultSet::getShort(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int16 nRet=0;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSet::getString(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	::rtl::OUString aRet;
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+
+	if (m_nRowPos != -1 && m_nRowPos != nAddressees && m_xMetaData.is())
+	{
+		KabResultSetMetaData *pMeta = (KabResultSetMetaData *) m_xMetaData.get();
+		sal_Int32 nFieldNumber = pMeta->fieldAtColumn(columnIndex);
+		QString aQtName(aFields[nFieldNumber]->value(m_aKabAddressees[m_nRowPos]));
+
+		if (!aQtName.isNull())
+		{
+			m_bWasNull = false;
+			aRet = ::rtl::OUString((const sal_Unicode *) aQtName.ucs2());
+			return aRet;
+		}
+	}
+// KDE address book currently does not use NULL values.
+// But it might do it someday
+	m_bWasNull = true;
+	return aRet;
+}
+// -------------------------------------------------------------------------
+Time SAL_CALL KabResultSet::getTime(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	Time nRet;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+DateTime SAL_CALL KabResultSet::getTimestamp(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	DateTime nRet;
+	return nRet;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::isBeforeFirst() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	if (m_nRowPos == -1)
+		return sal_True;
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::isAfterLast() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	if (m_nRowPos == nAddressees)
+		return sal_True;
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::isFirst() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	if (m_nRowPos == 0)
+		return sal_True;
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::isLast() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	if (m_nRowPos == nAddressees - 1)
+		return sal_True;
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::beforeFirst() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	// move before the first row
+	m_nRowPos == -1;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::afterLast() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	// move after the last row
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	m_nRowPos = nAddressees;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::close() throw(SQLException, RuntimeException)
+{
+	{
+		::osl::MutexGuard aGuard( m_aMutex );
+		checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+	}
+	dispose();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::first() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	if (nAddressees == 0)
+		return sal_False;
+
+	m_nRowPos = 0;
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::last() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	if (nAddressees == 0)
+		return sal_False;
+
+	m_nRowPos = nAddressees - 1;
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::absolute(sal_Int32 row) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	sal_Int32 nAddressees = m_aKabAddressees.size();
+	if (row <= -1 ||
+	    row >= nAddressees)
+		return sal_False;
+
+	m_nRowPos = row;
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::relative(sal_Int32 row) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return absolute(m_nRowPos + row);
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::next() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return absolute(m_nRowPos + 1);
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::previous() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return absolute(m_nRowPos - 1);
+}
+// -------------------------------------------------------------------------
+Reference< XInterface > SAL_CALL KabResultSet::getStatement() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return m_xStatement;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::rowDeleted() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::rowInserted() throw(SQLException, RuntimeException)
+{	
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::rowUpdated() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::wasNull() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return m_bWasNull;
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::cancel() throw(RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::clearWarnings() throw(SQLException, RuntimeException)
+{
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL KabResultSet::getWarnings() throw(SQLException, RuntimeException)
+{
+	return Any();
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::insertRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	// you only have to implement this if you want to insert new rows
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	// only when you allow updates
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::deleteRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::cancelRowUpdates() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::moveToInsertRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	// only when you allow inserts
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::moveToCurrentRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateNull(sal_Int32 columnIndex) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateBoolean(sal_Int32 columnIndex, sal_Bool x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateByte(sal_Int32 columnIndex, sal_Int8 x) throw(SQLException, RuntimeException)
+{
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+	::osl::MutexGuard aGuard( m_aMutex );
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateShort(sal_Int32 columnIndex, sal_Int16 x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateInt(sal_Int32 columnIndex, sal_Int32 x) throw(SQLException, RuntimeException)
+{
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+	::osl::MutexGuard aGuard( m_aMutex );
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateLong(sal_Int32 columnIndex, sal_Int64 x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -----------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateFloat(sal_Int32 columnIndex, float x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateDouble(sal_Int32 columnIndex, double x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateString(sal_Int32 columnIndex, const ::rtl::OUString& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateBytes(sal_Int32 columnIndex, const Sequence< sal_Int8 >& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateDate(sal_Int32 columnIndex, const Date& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateTime(sal_Int32 columnIndex, const Time& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateTimestamp(sal_Int32 columnIndex, const DateTime& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateBinaryStream(sal_Int32 columnIndex, const Reference< XInputStream >& x, sal_Int32 length) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateCharacterStream(sal_Int32 columnIndex, const Reference< XInputStream >& x, sal_Int32 length) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::refreshRow() throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateObject(sal_Int32 columnIndex, const Any& x) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabResultSet::updateNumericObject(sal_Int32 columnIndex, const Any& x, sal_Int32 scale) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+}
+// -------------------------------------------------------------------------
+// XRowLocate
+Any SAL_CALL KabResultSet::getBookmark() throw( SQLException,  RuntimeException)
+{
+	 ::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	// if you don't want to support bookmark you must remove the XRowLocate interface
+
+	 return Any();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::moveToBookmark(const  Any& bookmark) throw( SQLException,  RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::moveRelativeToBookmark(const  Any& bookmark, sal_Int32 rows) throw( SQLException,  RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSet::compareBookmarks(const  Any& first, const  Any& second) throw( SQLException,  RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+
+	return CompareBookmark::NOT_EQUAL;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSet::hasOrderedBookmarks() throw( SQLException,  RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSet::hashBookmark(const  Any& bookmark) throw( SQLException,  RuntimeException)
+{
+	throw SQLException();
+}
+// -------------------------------------------------------------------------
+// XDeleteRows
+Sequence< sal_Int32 > SAL_CALL KabResultSet::deleteRows(const  Sequence<  Any >& rows) throw( SQLException,  RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabResultSet_BASE::rBHelper.bDisposed);
+		
+	return Sequence< sal_Int32 >();
+}
+// -------------------------------------------------------------------------
+IPropertyArrayHelper* KabResultSet::createArrayHelper() const
+{
+	Sequence< Property > aProps(6);
+	Property* pProperties = aProps.getArray();
+	sal_Int32 nPos = 0;
+	DECL_PROP1IMPL(CURSORNAME,			::rtl::OUString) PropertyAttribute::READONLY);
+	DECL_PROP0(FETCHDIRECTION,			sal_Int32);
+	DECL_PROP0(FETCHSIZE,				sal_Int32);
+	DECL_BOOL_PROP1IMPL(ISBOOKMARKABLE) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETCONCURRENCY,sal_Int32) PropertyAttribute::READONLY);
+	DECL_PROP1IMPL(RESULTSETTYPE,		sal_Int32) PropertyAttribute::READONLY);
+
+	return new OPropertyArrayHelper(aProps);
+}
+// -------------------------------------------------------------------------
+IPropertyArrayHelper & KabResultSet::getInfoHelper()
+{
+	return *const_cast<KabResultSet*>(this)->getArrayHelper();
+}
+// -------------------------------------------------------------------------
+sal_Bool KabResultSet::convertFastPropertyValue(
+			Any & rConvertedValue,
+			Any & rOldValue,
+			sal_Int32 nHandle,
+			const Any& rValue )
+				throw (::com::sun::star::lang::IllegalArgumentException)
+{
+	switch (nHandle)
+	{
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw ::com::sun::star::lang::IllegalArgumentException();
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		default:
+			;
+	}
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+void KabResultSet::setFastPropertyValue_NoBroadcast(
+			sal_Int32 nHandle,
+			const Any& rValue )
+				 throw (Exception)
+{
+	switch (nHandle)
+	{
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+			throw Exception();
+			break;
+		case PROPERTY_ID_FETCHDIRECTION:
+			break;
+		case PROPERTY_ID_FETCHSIZE:
+			break;
+		default:
+			;
+	}
+}
+// -------------------------------------------------------------------------
+void KabResultSet::getFastPropertyValue(
+			Any& rValue,
+			sal_Int32 nHandle) const
+{
+	switch (nHandle)
+	{
+		case PROPERTY_ID_ISBOOKMARKABLE:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+			;
+	}
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL KabResultSet::acquire() throw()
+{
+	KabResultSet_BASE::acquire();
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL KabResultSet::release() throw()
+{
+	KabResultSet_BASE::release();
+}
+// -----------------------------------------------------------------------------
+::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL KabResultSet::getPropertySetInfo(  ) throw(::com::sun::star::uno::RuntimeException)
+{
+	return ::cppu::OPropertySetHelper::createPropertySetInfo(getInfoHelper());
+}
+// -----------------------------------------------------------------------------
Index: connectivity/source/drivers/kab/KResultSet.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KResultSet.hxx
diff -N connectivity/source/drivers/kab/KResultSet.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KResultSet.hxx	2 Sep 2005 15:22:52 -0000	1.1.2.3
@@ -0,0 +1,275 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_RESULTSET_HXX_
+#define _CONNECTIVITY_KAB_RESULTSET_HXX_
+
+#ifndef _CONNECTIVITY_KAB_STATEMENT_HXX_
+#include "KStatement.hxx"
+#endif
+#include <kabc/addressee.h>
+
+#ifndef _COM_SUN_STAR_SDBC_XROW_HPP_
+#include <com/sun/star/sdbc/XRow.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XRESULTSETMETADATASUPPLIER_HPP_
+#include <com/sun/star/sdbc/XResultSetMetaDataSupplier.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XCOLUMNLOCATE_HPP_
+#include <com/sun/star/sdbc/XColumnLocate.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XRESULTSETUPDATE_HPP_
+#include <com/sun/star/sdbc/XResultSetUpdate.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XROWUPDATE_HPP_
+#include <com/sun/star/sdbc/XRowUpdate.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBCX_XROWLOCATE_HPP_
+#include <com/sun/star/sdbcx/XRowLocate.hpp>
+#endif
+#ifndef _COM_SUN_STAR_SDBCX_XDELETEROWS_HPP_
+#include <com/sun/star/sdbcx/XDeleteRows.hpp>
+#endif
+#ifndef _CPPUHELPER_COMPBASE12_HXX_
+#include <cppuhelper/compbase12.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		/*
+		**	KabResultSet
+		*/
+        typedef ::cppu::WeakComponentImplHelper12<      ::com::sun::star::sdbc::XResultSet,
+			                                            ::com::sun::star::sdbc::XRow,
+			                                            ::com::sun::star::sdbc::XResultSetMetaDataSupplier,
+			                                            ::com::sun::star::util::XCancellable,
+			                                            ::com::sun::star::sdbc::XWarningsSupplier,
+			                                            ::com::sun::star::sdbc::XResultSetUpdate,
+			                                            ::com::sun::star::sdbc::XRowUpdate,
+														::com::sun::star::sdbcx::XRowLocate,
+														::com::sun::star::sdbcx::XDeleteRows,
+			                                            ::com::sun::star::sdbc::XCloseable,
+			                                            ::com::sun::star::sdbc::XColumnLocate,
+			                                            ::com::sun::star::lang::XServiceInfo> KabResultSet_BASE;
+
+		class KabResultSet : public	comphelper::OBaseMutex,
+							 public	KabResultSet_BASE,
+							 public	::cppu::OPropertySetHelper,
+							 public	comphelper::OPropertyArrayUsageHelper<KabResultSet>
+		{
+		protected:
+			::com::sun::star::uno::Reference< KabCommonStatement >							m_xStatement;
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData >	m_xMetaData;
+			::KABC::Addressee::List						m_aKabAddressees;	// address book entries matching the query
+			sal_Int32									m_nRowPos;
+			sal_Bool									m_bWasNull;
+
+			// OPropertyArrayUsageHelper
+			virtual ::cppu::IPropertyArrayHelper* createArrayHelper( ) const;
+
+			// OPropertySetHelper
+			virtual ::cppu::IPropertyArrayHelper & SAL_CALL getInfoHelper();
+
+			virtual sal_Bool SAL_CALL convertFastPropertyValue(
+			                    ::com::sun::star::uno::Any & rConvertedValue,
+			                    ::com::sun::star::uno::Any & rOldValue,
+								sal_Int32 nHandle,
+			                    const ::com::sun::star::uno::Any& rValue)
+									throw (::com::sun::star::lang::IllegalArgumentException);
+			virtual void SAL_CALL setFastPropertyValue_NoBroadcast(
+								sal_Int32 nHandle,
+			                    const ::com::sun::star::uno::Any& rValue)
+									throw (::com::sun::star::uno::Exception);
+			virtual void SAL_CALL getFastPropertyValue(
+								::com::sun::star::uno::Any& rValue,
+								sal_Int32 nHandle) const;
+
+			// you can't delete objects of this type
+			virtual ~KabResultSet();
+
+		public:
+			DECLARE_SERVICE_INFO();
+			
+			KabResultSet(KabCommonStatement *pStmt);
+
+			::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > operator *()
+			{
+				return ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >(*(KabResultSet_BASE*) this);
+			}
+
+			void allKabAddressees();
+			void someKabAddressees(const class KabCondition *pCondition);
+
+			// ::cppu::OComponentHelper
+			virtual void SAL_CALL disposing(void);
+
+			// XInterface
+			virtual ::com::sun::star::uno::Any SAL_CALL queryInterface( const ::com::sun::star::uno::Type & rType ) throw(::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL acquire() throw();
+			virtual void SAL_CALL release() throw();
+
+			// XTypeProvider
+			virtual ::com::sun::star::uno::Sequence< ::com::sun::star::uno::Type > SAL_CALL getTypes(  ) throw(::com::sun::star::uno::RuntimeException);
+
+			// XPropertySet
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL getPropertySetInfo(  ) throw(::com::sun::star::uno::RuntimeException);
+
+			// XResultSet
+			virtual sal_Bool SAL_CALL isBeforeFirst(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isAfterLast(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isFirst(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isLast(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL beforeFirst(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL afterLast(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL first(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL last(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL absolute( sal_Int32 row ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL relative( sal_Int32 rows ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL next(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL previous(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL refreshRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL rowUpdated(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL rowInserted(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL rowDeleted(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface > SAL_CALL getStatement(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XRow
+			virtual sal_Bool SAL_CALL wasNull(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getString( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL getBoolean( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int8 SAL_CALL getByte( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int16 SAL_CALL getShort( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getInt( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int64 SAL_CALL getLong( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual float SAL_CALL getFloat( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual double SAL_CALL getDouble( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Sequence< sal_Int8 > SAL_CALL getBytes( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::util::Date SAL_CALL getDate( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::util::Time SAL_CALL getTime( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::util::DateTime SAL_CALL getTimestamp( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream > SAL_CALL getBinaryStream( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream > SAL_CALL getCharacterStream( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Any SAL_CALL getObject( sal_Int32 columnIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::container::XNameAccess >& typeMap ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XRef > SAL_CALL getRef( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XBlob > SAL_CALL getBlob( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XClob > SAL_CALL getClob( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XArray > SAL_CALL getArray( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XResultSetMetaDataSupplier
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData > SAL_CALL getMetaData(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XCancellable
+			virtual void SAL_CALL cancel(  ) throw(::com::sun::star::uno::RuntimeException);
+
+			// XCloseable
+			virtual void SAL_CALL close(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XWarningsSupplier
+			virtual ::com::sun::star::uno::Any SAL_CALL getWarnings(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL clearWarnings(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XResultSetUpdate
+			virtual void SAL_CALL insertRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL deleteRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL cancelRowUpdates(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL moveToInsertRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL moveToCurrentRow(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			// XRowUpdate
+			virtual void SAL_CALL updateNull( sal_Int32 columnIndex ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateBoolean( sal_Int32 columnIndex, sal_Bool x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateByte( sal_Int32 columnIndex, sal_Int8 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateShort( sal_Int32 columnIndex, sal_Int16 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateInt( sal_Int32 columnIndex, sal_Int32 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateLong( sal_Int32 columnIndex, sal_Int64 x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateFloat( sal_Int32 columnIndex, float x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateDouble( sal_Int32 columnIndex, double x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateString( sal_Int32 columnIndex, const ::rtl::OUString& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateBytes( sal_Int32 columnIndex, const ::com::sun::star::uno::Sequence< sal_Int8 >& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateDate( sal_Int32 columnIndex, const ::com::sun::star::util::Date& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateTime( sal_Int32 columnIndex, const ::com::sun::star::util::Time& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateTimestamp( sal_Int32 columnIndex, const ::com::sun::star::util::DateTime& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateBinaryStream( sal_Int32 columnIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateCharacterStream( sal_Int32 columnIndex, const ::com::sun::star::uno::Reference< ::com::sun::star::io::XInputStream >& x, sal_Int32 length ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateObject( sal_Int32 columnIndex, const ::com::sun::star::uno::Any& x ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL updateNumericObject( sal_Int32 columnIndex, const ::com::sun::star::uno::Any& x, sal_Int32 scale ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XColumnLocate
+			virtual sal_Int32 SAL_CALL findColumn( const ::rtl::OUString& columnName ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XRowLocate
+			virtual ::com::sun::star::uno::Any SAL_CALL getBookmark(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL moveToBookmark( const ::com::sun::star::uno::Any& bookmark ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL moveRelativeToBookmark( const ::com::sun::star::uno::Any& bookmark, sal_Int32 rows ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL compareBookmarks( const ::com::sun::star::uno::Any& first, const ::com::sun::star::uno::Any& second ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL hasOrderedBookmarks(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL hashBookmark( const ::com::sun::star::uno::Any& bookmark ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XDeleteRows
+			virtual ::com::sun::star::uno::Sequence< sal_Int32 > SAL_CALL deleteRows( const ::com::sun::star::uno::Sequence< ::com::sun::star::uno::Any >& rows ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_RESULTSET_HXX_
Index: connectivity/source/drivers/kab/KResultSetMetaData.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KResultSetMetaData.cxx
diff -N connectivity/source/drivers/kab/KResultSetMetaData.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KResultSetMetaData.cxx	29 Aug 2005 08:43:52 -0000	1.1.2.1
@@ -0,0 +1,238 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KResultSetMetaData.hxx"
+#include <kabc/field.h>
+
+#ifndef _DBHELPER_DBEXCEPTION_HXX_
+#include <connectivity/dbexception.hxx>
+#endif
+
+using namespace connectivity::kab;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::sdbc;
+
+KabResultSetMetaData::KabResultSetMetaData(KabConnection* _pConnection)
+	: m_pConnection(_pConnection),
+	  m_aKabFields()
+{
+}
+// -------------------------------------------------------------------------
+KabResultSetMetaData::~KabResultSetMetaData()
+{
+}
+// -------------------------------------------------------------------------
+sal_uInt32 KabResultSetMetaData::findKabField(const ::rtl::OUString& columnName) throw(SQLException)
+{
+	// search the KDE address book field number of a given column name
+
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	::KABC::Field::List::iterator aField;
+	sal_uInt32 nResult;
+
+	for (	aField = aFields.begin(), nResult = 0;
+			aField != aFields.end();
+			++aField, ++nResult)
+	{
+		QString aQtName((*aField)->label());
+		::rtl::OUString aName((const sal_Unicode *) aQtName.ucs2());
+
+		if (aName == columnName)
+			return nResult;
+	}
+
+	::dbtools::throwGenericSQLException(
+		::rtl::OUString::createFromAscii("Invalid column name: ") + columnName,
+		NULL);
+}
+// -------------------------------------------------------------------------
+void KabResultSetMetaData::setKabFields(const ::vos::ORef<connectivity::OSQLColumns> &xColumns) throw(SQLException)
+{
+	OSQLColumns::const_iterator aIter;
+	static const ::rtl::OUString aName(::rtl::OUString::createFromAscii("Name"));
+
+	for (aIter = xColumns->begin(); aIter != xColumns->end(); ++aIter)
+	{
+		::rtl::OUString aFieldName;
+		sal_uInt32 nFieldNumber;
+
+		(*aIter)->getPropertyValue(aName) >>= aFieldName;
+		nFieldNumber = findKabField(aFieldName);
+		m_aKabFields.push_back(nFieldNumber);
+	}
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::getColumnDisplaySize(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return 50;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::getColumnType(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return DataType::CHAR;
+// KDE address book might support other types
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::getColumnCount() throw(SQLException, RuntimeException)
+{
+	return m_aKabFields.size();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isCaseSensitive(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getSchemaName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getColumnName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	::KABC::Field::List aFields = ::KABC::Field::allFields();
+	sal_uInt32 nFieldNumber = m_aKabFields[column - 1];
+	QString aQtName(aFields[nFieldNumber]->label());
+	::rtl::OUString aName((const sal_Unicode *) aQtName.ucs2());
+
+	return aName;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getTableName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	static const ::rtl::OUString aAddresses(::rtl::OUString::createFromAscii("addresses"));
+
+	return aAddresses;
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getCatalogName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getColumnTypeName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getColumnLabel(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+::rtl::OUString SAL_CALL KabResultSetMetaData::getColumnServiceName(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return ::rtl::OUString();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isCurrency(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isAutoIncrement(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isSigned(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::getPrecision(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return 0;
+}
+// -----------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::getScale(sal_Int32 column) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException)
+{
+	return 0;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabResultSetMetaData::isNullable(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return (sal_Int32) sal_True;
+// KDE address book currently does not use NULL values.
+// But it might do it someday
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isSearchable(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isReadOnly(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_True;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isDefinitelyWritable(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabResultSetMetaData::isWritable(sal_Int32 column) throw(SQLException, RuntimeException)
+{
+	return sal_False;
+}
+// -------------------------------------------------------------------------
Index: connectivity/source/drivers/kab/KResultSetMetaData.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KResultSetMetaData.hxx
diff -N connectivity/source/drivers/kab/KResultSetMetaData.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KResultSetMetaData.hxx	29 Aug 2005 08:43:53 -0000	1.1.2.1
@@ -0,0 +1,136 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+#define _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#ifndef _CONNECTIVITY_PARSE_SQLITERATOR_HXX_
+#include "connectivity/sqliterator.hxx"
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XRESULTSETMETADATA_HPP_
+#include <com/sun/star/sdbc/XResultSetMetaData.hpp>
+#endif
+#ifndef _CPPUHELPER_IMPLBASE1_HXX_
+#include <cppuhelper/implbase1.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		/*
+		**	KabResultSetMetaData
+		*/
+		typedef ::cppu::WeakImplHelper1< ::com::sun::star::sdbc::XResultSetMetaData>   KabResultSetMetaData_BASE;
+
+		class KabResultSetMetaData : public KabResultSetMetaData_BASE
+		{
+			KabConnection*				m_pConnection;
+			::std::vector<sal_Int32>	m_aKabFields;	// for each selected column, contains the number
+														//  of the corresponding KAddressBook field
+
+		protected:
+			virtual ~KabResultSetMetaData();
+
+		public:
+			KabResultSetMetaData(KabConnection* _pConnection);
+
+			// avoid ambigous cast error from the compiler
+			inline operator ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSetMetaData > () throw()
+			{ return this; }
+
+			static sal_uInt32 findKabField(
+					const ::rtl::OUString& columnName) throw(::com::sun::star::sdbc::SQLException);
+			void setKabFields(
+				const ::vos::ORef<connectivity::OSQLColumns> &xColumns) throw(::com::sun::star::sdbc::SQLException);
+			inline sal_uInt32 fieldAtColumn(sal_Int32 columnIndex) const
+			{ return m_aKabFields[columnIndex - 1]; }
+
+			virtual sal_Int32 SAL_CALL getColumnCount(  ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isAutoIncrement( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isCaseSensitive( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isSearchable( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isCurrency( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL isNullable( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isSigned( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getColumnDisplaySize( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getColumnLabel( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getColumnName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getSchemaName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getPrecision( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getScale( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getTableName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getCatalogName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL getColumnType( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getColumnTypeName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isReadOnly( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isWritable( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL isDefinitelyWritable( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::rtl::OUString SAL_CALL getColumnServiceName( sal_Int32 column ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
Index: connectivity/source/drivers/kab/KServices.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KServices.cxx
diff -N connectivity/source/drivers/kab/KServices.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KServices.cxx	29 Aug 2005 08:43:53 -0000	1.1.2.1
@@ -0,0 +1,213 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KDriver.hxx"
+
+#ifndef _CPPUHELPER_FACTORY_HXX_
+#include <cppuhelper/factory.hxx>
+#endif
+#ifndef _OSL_DIAGNOSE_H_
+#include <osl/diagnose.h>
+#endif
+
+using namespace connectivity::kab;
+using ::rtl::OUString;
+using ::com::sun::star::uno::Reference;
+using ::com::sun::star::uno::Sequence;
+using ::com::sun::star::registry::XRegistryKey;
+using ::com::sun::star::lang::XSingleServiceFactory;
+using ::com::sun::star::lang::XMultiServiceFactory;
+
+typedef Reference< XSingleServiceFactory > (SAL_CALL *createFactoryFunc)
+		(
+			const Reference< XMultiServiceFactory > & rServiceManager,
+			const OUString & rComponentName, 
+			::cppu::ComponentInstantiation pCreateFunction,
+			const Sequence< OUString > & rServiceNames,
+			rtl_ModuleCount* _pTemp
+		);
+
+//***************************************************************************************
+//
+// The following C Api must be provided!
+// It consists in three functions that must be exported by the module
+//
+
+//---------------------------------------------------------------------------------------
+void REGISTER_PROVIDER(
+		const OUString& aServiceImplName, 
+		const Sequence< OUString>& Services, 
+		const Reference< ::com::sun::star::registry::XRegistryKey > & xKey)
+{
+	OUString aMainKeyName;
+	aMainKeyName = OUString::createFromAscii("/");
+	aMainKeyName += aServiceImplName;
+	aMainKeyName += OUString::createFromAscii("/UNO/SERVICES");
+
+	Reference< ::com::sun::star::registry::XRegistryKey >  xNewKey( xKey->createKey(aMainKeyName) );
+	OSL_ENSURE(xNewKey.is(), "KAB::component_writeInfo : could not create a registry key !");
+
+	for (sal_uInt32 i=0; i<Services.getLength(); ++i)
+		xNewKey->createKey(Services[i]);
+}
+
+
+//---------------------------------------------------------------------------------------
+struct ProviderRequest
+{
+	Reference< XSingleServiceFactory > xRet;
+	Reference< XMultiServiceFactory > const xServiceManager;
+	OUString const sImplementationName;
+
+	ProviderRequest(
+		void* pServiceManager,
+		sal_Char const* pImplementationName
+	)
+	: xServiceManager(reinterpret_cast<XMultiServiceFactory*>(pServiceManager))
+	, sImplementationName(OUString::createFromAscii(pImplementationName))
+	{
+	}
+
+	inline
+	sal_Bool CREATE_PROVIDER(
+				const OUString& Implname, 
+				const Sequence< OUString > & Services, 
+				::cppu::ComponentInstantiation Factory,
+				createFactoryFunc creator
+			)
+	{
+		if (!xRet.is() && (Implname == sImplementationName))
+		try																							
+		{																								
+			xRet = creator( xServiceManager, sImplementationName,Factory, Services,0);	
+		}
+		catch(...)
+		{
+		}
+		return xRet.is();
+	}
+	
+	void* getProvider() const { return xRet.get(); }
+};
+
+//---------------------------------------------------------------------------------------
+
+extern "C" void SAL_CALL component_getImplementationEnvironment(
+				const sal_Char	**ppEnvTypeName,
+				uno_Environment	**ppEnv
+			)
+{
+	*ppEnvTypeName = CPPU_CURRENT_LANGUAGE_BINDING_NAME;
+}
+
+//---------------------------------------------------------------------------------------
+extern "C" sal_Bool SAL_CALL component_writeInfo(
+				void* pServiceManager,
+				void* pRegistryKey
+			)
+{
+	if (pRegistryKey) 
+	try 
+	{
+		Reference< ::com::sun::star::registry::XRegistryKey > xKey(reinterpret_cast< ::com::sun::star::registry::XRegistryKey*>(pRegistryKey));
+
+		REGISTER_PROVIDER(
+			KabDriver::getImplementationName_Static(), 
+			KabDriver::getSupportedServiceNames_Static(), xKey);		
+
+		return sal_True;
+	}
+	catch (::com::sun::star::registry::InvalidRegistryException& )
+	{
+		OSL_ENSURE(sal_False, "KAB::component_writeInfo : could not create a registry key ! ## InvalidRegistryException !");
+	}
+
+	return sal_False;
+}
+
+//---------------------------------------------------------------------------------------
+extern "C" void* SAL_CALL component_getFactory(
+					const sal_Char* pImplementationName,
+					void* pServiceManager,
+					void* pRegistryKey)
+{
+	void* pRet = 0;
+	if (pServiceManager)
+	{
+		ProviderRequest aReq(pServiceManager,pImplementationName);
+
+		aReq.CREATE_PROVIDER(
+			KabDriver::getImplementationName_Static(), 
+			KabDriver::getSupportedServiceNames_Static(),
+			KabDriver_CreateInstance,
+			::cppu::createSingleFactory) 
+		;
+
+		if (aReq.xRet.is())
+			aReq.xRet->acquire();
+
+		pRet = aReq.getProvider();
+	}
+
+	return pRet;
+};
+
+
Index: connectivity/source/drivers/kab/KStatement.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KStatement.cxx
diff -N connectivity/source/drivers/kab/KStatement.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KStatement.cxx	2 Sep 2005 14:09:53 -0000	1.1.2.6
@@ -0,0 +1,518 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KStatement.hxx"
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_DRIVER_HXX_
+#include "KDriver.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_RESULTSET_HXX_
+#include "KResultSet.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_RESULTSETMETADATA_HXX_
+#include "KResultSetMetaData.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CONDITION_HXX_
+#include "KCondition.hxx"
+#endif
+
+#ifndef CONNECTIVITY_CONNECTION_HXX
+#include "TConnection.hxx"
+#endif
+#ifndef _DBHELPER_DBEXCEPTION_HXX_
+#include <connectivity/dbexception.hxx>
+#endif
+
+#if OSL_DEBUG_LEVEL > 0
+# define OUtoCStr( x ) ( ::rtl::OUStringToOString ( (x), RTL_TEXTENCODING_ASCII_US).getStr())
+#else /* OSL_DEBUG_LEVEL */
+# define OUtoCStr( x ) ("dummy")
+#endif /* OSL_DEBUG_LEVEL */
+
+using namespace connectivity::kab;
+using namespace com::sun::star::uno;
+using namespace com::sun::star::lang;
+using namespace com::sun::star::beans;
+using namespace com::sun::star::sdbc;
+using namespace com::sun::star::sdbcx;
+using namespace com::sun::star::container;
+using namespace com::sun::star::io;
+using namespace com::sun::star::util;
+
+IMPLEMENT_SERVICE_INFO(KabStatement, "com.sun.star.sdbc.drivers.KabStatement", "com.sun.star.sdbc.Statement");
+//------------------------------------------------------------------------------
+KabCommonStatement::KabCommonStatement(KabConnection* _pConnection ) 
+	: KabCommonStatement_BASE(m_aMutex),
+	OPropertySetHelper(KabCommonStatement_BASE::rBHelper),
+	rBHelper(KabCommonStatement_BASE::rBHelper),
+	m_pParseTree(NULL),
+	m_aSQLIterator(_pConnection->createCatalog()->getTables(), _pConnection->getMetaData(), NULL),
+	m_aParser(_pConnection->getDriver()->getMSFactory()),
+	m_pConnection(_pConnection)
+{
+	m_pConnection->acquire();
+}
+// -----------------------------------------------------------------------------
+KabCommonStatement::~KabCommonStatement()
+{
+}
+// -----------------------------------------------------------------------------
+KabCondition *KabCommonStatement::analyseWhereClause(const OSQLParseNode *pParseNode) const throw(SQLException)
+{
+	if (pParseNode->count() == 3)
+	{
+		const OSQLParseNode *pLeft = pParseNode->getChild(0),
+		                    *pMiddle = pParseNode->getChild(1),
+		                    *pRight = pParseNode->getChild(2);
+
+		// WHERE ( ... ) ?
+		if (SQL_ISPUNCTUATION(pLeft, "(") && SQL_ISPUNCTUATION(pRight, ")"))
+		{
+		  	return analyseWhereClause(pMiddle);
+		}
+		else if (SQL_ISRULE(pParseNode, comparison_predicate))
+		{
+			if (pLeft->isToken() && pRight->isToken())
+			{
+				switch (pMiddle->getNodeType())
+				{
+					case SQL_NODE_EQUAL:
+						// WHERE 0 = 1
+						return new KabConditionConstant(pLeft->getTokenValue() == pRight->getTokenValue());
+
+					case SQL_NODE_NOTEQUAL:
+						// WHERE 0 <> 1
+						// (might not be correct SQL... don't care, handling anyway)
+						return new KabConditionConstant(pLeft->getTokenValue() != pRight->getTokenValue());
+				}
+			}
+			else if (SQL_ISRULE(pLeft, column_ref) && pRight->isToken())
+			{
+				::rtl::OUString sColumnName,
+				                sTableRange,
+				                sMatchString;
+
+				m_aSQLIterator.getColumnRange(pLeft, sColumnName, sTableRange);
+				sMatchString = pRight->getTokenValue();
+
+				switch (pMiddle->getNodeType())
+				{
+					case SQL_NODE_EQUAL:
+						// WHERE Name = 'Smith'
+						return new KabConditionEqual(sColumnName, sMatchString);
+
+		 			case SQL_NODE_NOTEQUAL:
+						// WHERE Name <> 'Jones'
+						return new KabConditionDifferent(sColumnName, sMatchString);
+				}
+			}
+		}
+		else if (SQL_ISRULE(pParseNode, search_condition))
+		{
+			if (SQL_ISTOKEN(pMiddle, OR))
+			{
+				// WHERE Name = 'Smith' OR Name = 'Jones'
+				return new KabConditionOr(
+					analyseWhereClause(pLeft),
+					analyseWhereClause(pRight));
+			}
+		}
+		else if (SQL_ISRULE(pParseNode, boolean_term))
+		{
+			if (SQL_ISTOKEN(pMiddle, AND))
+			{
+				// WHERE Name = 'Smith' AND "Given Name" = 'Peter'
+				return new KabConditionAnd(
+					analyseWhereClause(pLeft),
+					analyseWhereClause(pRight));
+			}
+		}
+	}
+	else if (pParseNode->count() == 4)
+	{
+		const OSQLParseNode *pLeft = pParseNode->getChild(0),
+		                    *pMiddleLeft = pParseNode->getChild(1),
+		                    *pMiddleRight = pParseNode->getChild(2),
+		                    *pRight = pParseNode->getChild(3);
+
+		if (SQL_ISRULE(pParseNode, test_for_null))
+		{
+			if (SQL_ISRULE(pLeft, column_ref) &&
+                            SQL_ISTOKEN(pMiddleLeft, IS) &&
+                            SQL_ISTOKEN(pRight, NULL))
+			{
+				::rtl::OUString sColumnName,
+				                sTableRange;
+
+				m_aSQLIterator.getColumnRange(pLeft, sColumnName, sTableRange);
+
+				if (SQL_ISTOKEN(pMiddleRight, NOT))
+				{
+					// WHERE "Mobile Phone" IS NOT NULL
+					return new KabConditionNotNull(sColumnName);
+				}
+				else
+				{
+					// WHERE "Mobile Phone" IS NULL
+					return new KabConditionNull(sColumnName);
+				}
+			}
+		}
+		else if (SQL_ISRULE(pParseNode, like_predicate))
+		{
+			if (SQL_ISRULE(pLeft, column_ref) && pMiddleRight->getNodeType() == SQL_NODE_STRING)
+			{
+				::rtl::OUString sColumnName,
+				                sTableRange,
+				                sMatchString;
+
+				m_aSQLIterator.getColumnRange(pLeft, sColumnName, sTableRange);
+				sMatchString = pMiddleRight->getTokenValue();
+
+				// WHERE Name LIKE 'Sm%'
+				return new KabConditionSimilar(sColumnName, sMatchString);
+			}
+		}
+	}
+	::dbtools::throwGenericSQLException(
+		::rtl::OUString::createFromAscii("Syntax error or keyword not recognized."),
+		NULL);
+}
+//------------------------------------------------------------------------------
+sal_Bool KabCommonStatement::isTableKnown(KabResultSet *pResult) const
+{
+	// can handle requests like        SELECT * FROM addresses addresses
+	// but cannot handle requests like SELECT * FROM addresses persons
+	if (m_aSQLIterator.getTables().size() != 1)
+		return sal_False;
+
+	if (m_aSQLIterator.getTables().begin()->first != pResult->getMetaData()->getTableName(0))
+		return sal_False;
+
+	return sal_True;
+}
+//------------------------------------------------------------------------------
+void KabCommonStatement::setKabFields(KabResultSet *pResult) const throw(SQLException)
+{
+	::vos::ORef<connectivity::OSQLColumns> xColumns;	// selected columns
+	KabResultSetMetaData *pMeta;				// meta information - holds the list of KAddressBook fields
+
+	xColumns = m_aSQLIterator.getSelectColumns();
+	if (!xColumns.isValid())
+	{
+		::dbtools::throwGenericSQLException(
+			::rtl::OUString::createFromAscii("Invalid selection of columns"),
+			NULL);
+	}
+	pMeta = (KabResultSetMetaData *) pResult->getMetaData().get();
+	pMeta->setKabFields(xColumns);
+}
+// -------------------------------------------------------------------------
+void KabCommonStatement::selectAddressees(KabResultSet *pResult) const throw(SQLException)
+{
+	const OSQLParseNode *pParseNode;
+	KabCondition *pCondition;
+
+	pParseNode = m_aSQLIterator.getWhereTree();
+	if (pParseNode != NULL)
+	{
+		if (SQL_ISRULE(pParseNode, where_clause))
+		{
+			pParseNode = pParseNode->getChild(1);
+			pCondition = analyseWhereClause(pParseNode);
+			if (pCondition->isAlwaysTrue())
+				pResult->allKabAddressees();
+			else if (!pCondition->isAlwaysFalse())
+				pResult->someKabAddressees(pCondition);
+			delete pCondition;
+			return;
+		}
+	}
+
+	// no WHERE clause: get all rows
+	pResult->allKabAddressees();
+}
+//-----------------------------------------------------------------------------
+Any SAL_CALL KabCommonStatement::queryInterface( const Type & rType ) throw(RuntimeException)
+{
+	Any aRet = KabCommonStatement_BASE::queryInterface(rType);
+	if (!aRet.hasValue())
+		aRet = OPropertySetHelper::queryInterface(rType);
+	return aRet;
+}
+// -------------------------------------------------------------------------
+Sequence< Type > SAL_CALL KabCommonStatement::getTypes(  ) throw(RuntimeException)
+{
+	::cppu::OTypeCollection aTypes(	::getCppuType( (const Reference< XMultiPropertySet > *)0 ),
+									::getCppuType( (const Reference< XFastPropertySet > *)0 ),
+									::getCppuType( (const Reference< XPropertySet > *)0 ));
+
+	return comphelper::concatSequences(aTypes.getTypes(),KabCommonStatement_BASE::getTypes());
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabCommonStatement::cancel(  ) throw(RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+	// cancel the current sql statement
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabCommonStatement::close(  ) throw(SQLException, RuntimeException)
+{
+	{
+		::osl::MutexGuard aGuard( m_aMutex );
+		checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+			
+	}
+	dispose();
+}
+// -------------------------------------------------------------------------
+sal_Bool SAL_CALL KabCommonStatement::execute(
+		const ::rtl::OUString& sql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	Reference< XResultSet > xRS = executeQuery(sql);
+
+	return xRS.is();
+}
+// -------------------------------------------------------------------------
+Reference< XResultSet > SAL_CALL KabCommonStatement::executeQuery(
+		const ::rtl::OUString& sql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+OSL_TRACE("KDE Address book - SQL Request: %s", OUtoCStr(sql));
+
+	KabResultSet* pResult = new KabResultSet(this);
+	Reference< XResultSet > xRS = pResult;
+	::rtl::OUString aErr;
+
+	m_pParseTree = m_aParser.parseTree(aErr, sql);
+	if (m_pParseTree == NULL)
+		throw SQLException(aErr, *this, ::rtl::OUString(), 0, Any());
+// the above line is copied from another driver, but I did not succeed in
+// triggering a single case where m_ParseTree was NULL or where aErr was not empty
+
+	m_aSQLIterator.setParseTree(m_pParseTree);
+	m_aSQLIterator.traverseAll();
+	switch (m_aSQLIterator.getStatementType())
+	{
+		case SQL_STATEMENT_SELECT:
+			if (isTableKnown(pResult))		// FROM which table ?
+			{
+				setKabFields(pResult);		// SELECT which columns ?
+				selectAddressees(pResult);	// WHERE which condition ?
+// To be continued: ORDER BY "Name",
+//                  DISTINCT
+//				    etc...
+			}
+			break;
+
+		default:
+// To be continued: UPDATE
+//		    DELETE
+//		    etc...
+			::dbtools::throwGenericSQLException(
+				::rtl::OUString::createFromAscii("Unsupported SQL statement"),
+				NULL);
+	}
+
+	return xRS;
+}
+// -------------------------------------------------------------------------
+Reference< XConnection > SAL_CALL KabCommonStatement::getConnection(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+	// just return our connection here
+	return (Reference< XConnection >) m_pConnection;
+}
+// -------------------------------------------------------------------------
+sal_Int32 SAL_CALL KabCommonStatement::executeUpdate( const ::rtl::OUString& sql ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+		
+	// the return values gives information about how many rows are affected by executing the sql statement		
+	return 0;
+}
+// -------------------------------------------------------------------------
+Any SAL_CALL KabCommonStatement::getWarnings(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	return makeAny(m_aLastWarning);
+}
+// -------------------------------------------------------------------------
+void SAL_CALL KabCommonStatement::clearWarnings(  ) throw(SQLException, RuntimeException)
+{
+	::osl::MutexGuard aGuard( m_aMutex );
+	checkDisposed(KabCommonStatement_BASE::rBHelper.bDisposed);
+
+	m_aLastWarning = SQLWarning();
+}
+// -------------------------------------------------------------------------
+::cppu::IPropertyArrayHelper* KabCommonStatement::createArrayHelper( ) const
+{
+	// this properties are defined by the service statement
+	// they must be in alphabetic order
+	Sequence< Property > aProps(10);
+	Property* pProperties = aProps.getArray();
+	sal_Int32 nPos = 0;
+	DECL_PROP0(CURSORNAME,	::rtl::OUString);
+	DECL_BOOL_PROP0(ESCAPEPROCESSING);
+	DECL_PROP0(FETCHDIRECTION,sal_Int32);
+	DECL_PROP0(FETCHSIZE,	sal_Int32);
+	DECL_PROP0(MAXFIELDSIZE,sal_Int32);
+	DECL_PROP0(MAXROWS,		sal_Int32);
+	DECL_PROP0(QUERYTIMEOUT,sal_Int32);
+	DECL_PROP0(RESULTSETCONCURRENCY,sal_Int32);
+	DECL_PROP0(RESULTSETTYPE,sal_Int32);
+	DECL_BOOL_PROP0(USEBOOKMARKS);
+
+	return new ::cppu::OPropertyArrayHelper(aProps);
+}
+// -------------------------------------------------------------------------
+::cppu::IPropertyArrayHelper & KabCommonStatement::getInfoHelper()
+{
+	return *const_cast<KabCommonStatement*>(this)->getArrayHelper();
+}
+// -------------------------------------------------------------------------
+sal_Bool KabCommonStatement::convertFastPropertyValue(
+		Any & rConvertedValue,
+		Any & rOldValue,
+		sal_Int32 nHandle,
+		const Any& rValue) throw (::com::sun::star::lang::IllegalArgumentException)
+{
+	sal_Bool bConverted = sal_False;
+	// here we have to try to convert 
+OSL_ENSURE(false, "KabCommonStatement::convertFastPropertyValue is not implemented!");
+	return bConverted;
+}
+// -------------------------------------------------------------------------
+void KabCommonStatement::setFastPropertyValue_NoBroadcast(sal_Int32 nHandle,const Any& rValue) throw (Exception)
+{
+	// set the value to whatever is nescessary
+	switch (nHandle)
+	{
+		case PROPERTY_ID_QUERYTIMEOUT:
+		case PROPERTY_ID_MAXFIELDSIZE:
+		case PROPERTY_ID_MAXROWS:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		case PROPERTY_ID_ESCAPEPROCESSING:
+		case PROPERTY_ID_USEBOOKMARKS:
+		default:
+			;
+	}
+OSL_ENSURE(false, "KabCommonStatement::setFastPropertyValue_NoBroadcast is not implemented!");
+}
+// -------------------------------------------------------------------------
+void KabCommonStatement::getFastPropertyValue(Any& rValue,sal_Int32 nHandle) const
+{
+	switch (nHandle)
+	{
+		case PROPERTY_ID_QUERYTIMEOUT:
+		case PROPERTY_ID_MAXFIELDSIZE:
+		case PROPERTY_ID_MAXROWS:
+		case PROPERTY_ID_CURSORNAME:
+		case PROPERTY_ID_RESULTSETCONCURRENCY:
+		case PROPERTY_ID_RESULTSETTYPE:
+		case PROPERTY_ID_FETCHDIRECTION:
+		case PROPERTY_ID_FETCHSIZE:
+		case PROPERTY_ID_ESCAPEPROCESSING:
+		case PROPERTY_ID_USEBOOKMARKS:
+		default:
+			;
+	}
+OSL_ENSURE(false, "KabCommonStatement::getFastPropertyValue is not implemented!");
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL KabCommonStatement::acquire() throw()
+{
+	KabCommonStatement_BASE::acquire();
+}
+// -----------------------------------------------------------------------------
+void SAL_CALL KabCommonStatement::release() throw()
+{
+	KabCommonStatement_BASE::release();
+}
+// -----------------------------------------------------------------------------
+Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL KabCommonStatement::getPropertySetInfo(  ) throw(RuntimeException)
+{
+	return ::cppu::OPropertySetHelper::createPropertySetInfo(getInfoHelper());
+}
+// -----------------------------------------------------------------------------
+KabStatement::KabStatement(KabConnection* _pConnection)
+	: KabStatement_BASE(_pConnection)
+{
+}
Index: connectivity/source/drivers/kab/KStatement.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KStatement.hxx
diff -N connectivity/source/drivers/kab/KStatement.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KStatement.hxx	1 Sep 2005 17:11:30 -0000	1.1.2.3
@@ -0,0 +1,215 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_STATEMENT_HXX_
+#define _CONNECTIVITY_KAB_STATEMENT_HXX_
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+#include <list>
+
+#ifndef _CONNECTIVITY_PARSE_SQLITERATOR_HXX_
+#include "connectivity/sqliterator.hxx"
+#endif
+#ifndef _CONNECTIVITY_PARSE_SQLPARSE_HXX_
+#include "connectivity/sqlparse.hxx"
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XSTATEMENT_HPP_
+#include <com/sun/star/sdbc/XStatement.hpp>
+#endif
+#ifndef _COM_SUN_STAR_UTIL_XCANCELLABLE_HPP_
+#include <com/sun/star/util/XCancellable.hpp>
+#endif
+#ifndef _CPPUHELPER_COMPBASE4_HXX_
+#include <cppuhelper/compbase4.hxx>
+#endif
+#ifndef _CPPUHELPER_IMPLBASE1_HXX_
+#include <cppuhelper/implbase1.hxx>
+#endif
+#ifndef _COMPHELPER_PROPERTY_ARRAY_HELPER_HXX_
+#include <comphelper/proparrhlp.hxx>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		typedef ::cppu::WeakComponentImplHelper4<	::com::sun::star::sdbc::XStatement,
+                                                    ::com::sun::star::sdbc::XWarningsSupplier,
+                                                    ::com::sun::star::util::XCancellable,
+                                                    ::com::sun::star::sdbc::XCloseable> KabCommonStatement_BASE;
+
+		//**************************************************************
+		// Class KabCommonStatement
+		// is a base class for the normal statement and for the prepared statement
+		//**************************************************************
+		class KabCommonStatement :	public comphelper::OBaseMutex,
+						public	KabCommonStatement_BASE,
+						public	::cppu::OPropertySetHelper,
+						public	comphelper::OPropertyArrayUsageHelper<KabCommonStatement>
+
+		{
+			::com::sun::star::sdbc::SQLWarning	m_aLastWarning;
+
+		protected:
+			::std::list< ::rtl::OUString>		m_aBatchList;
+			connectivity::OSQLParser			m_aParser;
+			connectivity::OSQLParseTreeIterator	m_aSQLIterator;
+			connectivity::OSQLParseNode*		m_pParseTree;
+			KabConnection*						m_pConnection;	// The owning Connection object
+
+		protected:
+			class KabCondition *analyseWhereClause(
+				const OSQLParseNode *pParseNode) const throw(::com::sun::star::sdbc::SQLException);
+			sal_Bool isTableKnown(class KabResultSet *pResult) const;
+			void setKabFields(class KabResultSet *pResult) const throw(::com::sun::star::sdbc::SQLException);
+			void selectAddressees(KabResultSet *pResult) const throw(::com::sun::star::sdbc::SQLException);
+
+			// OPropertyArrayUsageHelper
+			virtual ::cppu::IPropertyArrayHelper* createArrayHelper() const;
+
+			// OPropertySetHelper
+			virtual ::cppu::IPropertyArrayHelper & SAL_CALL getInfoHelper();
+			virtual sal_Bool SAL_CALL convertFastPropertyValue(
+					::com::sun::star::uno::Any & rConvertedValue,
+					::com::sun::star::uno::Any & rOldValue,
+					sal_Int32 nHandle,
+					const ::com::sun::star::uno::Any& rValue) throw (::com::sun::star::lang::IllegalArgumentException);
+			virtual void SAL_CALL setFastPropertyValue_NoBroadcast(
+					sal_Int32 nHandle,
+					const ::com::sun::star::uno::Any& rValue) throw (::com::sun::star::uno::Exception);
+			virtual void SAL_CALL getFastPropertyValue(
+					::com::sun::star::uno::Any& rValue,
+					sal_Int32 nHandle) const;
+			virtual ~KabCommonStatement();
+
+		public:
+			::cppu::OBroadcastHelper& rBHelper;
+
+			KabCommonStatement(KabConnection *_pConnection);
+			using KabCommonStatement_BASE::operator ::com::sun::star::uno::Reference< ::com::sun::star::uno::XInterface >;
+
+			// OComponentHelper
+			virtual void SAL_CALL disposing(void){KabCommonStatement_BASE::disposing();}
+
+			// XInterface
+			virtual void SAL_CALL release() throw();
+			virtual void SAL_CALL acquire() throw();
+			virtual ::com::sun::star::uno::Any SAL_CALL queryInterface(
+					const ::com::sun::star::uno::Type & rType
+					) throw(::com::sun::star::uno::RuntimeException);
+
+			// XTypeProvider
+			virtual ::com::sun::star::uno::Sequence< ::com::sun::star::uno::Type > SAL_CALL getTypes(
+					) throw(::com::sun::star::uno::RuntimeException);
+
+			// XPropertySet
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySetInfo > SAL_CALL getPropertySetInfo(
+					) throw(::com::sun::star::uno::RuntimeException);
+
+			// XStatement
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XResultSet > SAL_CALL executeQuery(
+					const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Int32 SAL_CALL executeUpdate(
+					 const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual sal_Bool SAL_CALL execute(
+					const ::rtl::OUString& sql ) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XConnection > SAL_CALL getConnection(
+					) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XWarningsSupplier
+			virtual ::com::sun::star::uno::Any SAL_CALL getWarnings(
+					) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+			virtual void SAL_CALL clearWarnings(
+					) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// XCancellable
+			virtual void SAL_CALL cancel(
+					) throw(::com::sun::star::uno::RuntimeException);
+
+			// XCloseable
+			virtual void SAL_CALL close(
+					) throw(::com::sun::star::sdbc::SQLException, ::com::sun::star::uno::RuntimeException);
+
+			// other methods
+			inline KabConnection* getOwnConnection() const { return m_pConnection; }
+		};
+
+		//**************************************************************
+		// Class KabStatement
+		//**************************************************************
+		typedef ::cppu::ImplInheritanceHelper1<
+				KabCommonStatement, ::com::sun::star::lang::XServiceInfo > KabStatement_BASE;
+
+		class KabStatement : public KabStatement_BASE
+		{
+		protected:
+			virtual ~KabStatement() { }
+
+		public:
+			KabStatement(KabConnection* _pConnection);
+			DECLARE_SERVICE_INFO();
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_STATEMENT_HXX_
Index: connectivity/source/drivers/kab/KTable.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KTable.cxx
diff -N connectivity/source/drivers/kab/KTable.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KTable.cxx	30 Aug 2005 15:36:25 -0000	1.1.2.2
@@ -0,0 +1,133 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KTable.hxx"
+#ifndef _CONNECTIVITY_KAB_TABLES_HXX_
+#include "KTables.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_COLUMNS_HXX_
+#include "KColumns.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CATALOG_HXX_
+#include "KCatalog.hxx"
+#endif
+
+using namespace connectivity::kab;
+using namespace connectivity;
+using namespace ::comphelper;
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::sdbcx;
+using namespace ::com::sun::star::sdbc;
+using namespace ::com::sun::star::container;
+using namespace ::com::sun::star::lang;
+
+// -------------------------------------------------------------------------
+KabTable::KabTable( sdbcx::OCollection* _pTables, KabConnection* _pConnection) 
+	: KabTable_TYPEDEF(_pTables, sal_True),
+	m_pConnection(_pConnection)
+{
+	construct();
+}
+// -------------------------------------------------------------------------
+KabTable::KabTable( sdbcx::OCollection* _pTables,
+	            KabConnection* _pConnection,
+	            const ::rtl::OUString& _Name,
+	            const ::rtl::OUString& _Type,
+	            const ::rtl::OUString& _Description ,
+	            const ::rtl::OUString& _SchemaName,
+	            const ::rtl::OUString& _CatalogName
+	            ) : KabTable_TYPEDEF(_pTables,sal_True,
+	                              _Name,
+	                              _Type,
+	                              _Description,
+	                              _SchemaName,
+	                              _CatalogName),
+	                m_pConnection(_pConnection)
+{
+	construct();
+}
+// -------------------------------------------------------------------------
+void KabTable::refreshColumns()
+{
+	TStringVector aVector;
+
+	if (!isNew())
+	{
+	    Reference< XResultSet > xResult = m_pConnection->getMetaData()->getColumns(
+				Any(),
+				m_SchemaName,
+				m_Name,
+				::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("%")));
+
+	    if (xResult.is())
+	    {
+		Reference< XRow > xRow(xResult, UNO_QUERY);
+		while (xResult->next())
+				aVector.push_back(xRow->getString(4));
+	    }
+	}
+
+	if (m_pColumns)
+	    m_pColumns->reFill(aVector);
+	else
+	    m_pColumns  = new KabColumns(this,m_aMutex,aVector);
+}
Index: connectivity/source/drivers/kab/KTable.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KTable.hxx
diff -N connectivity/source/drivers/kab/KTable.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KTable.hxx	30 Aug 2005 15:36:26 -0000	1.1.2.2
@@ -0,0 +1,107 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_TABLE_HXX_
+#define _CONNECTIVITY_KAB_TABLE_HXX_
+
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#ifndef _CONNECTIVITY_SDBCX_TABLE_HXX_
+#include "connectivity/sdbcx/VTable.hxx"
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		typedef connectivity::sdbcx::OTable KabTable_TYPEDEF;
+
+		::rtl::OUString getTypeString(const ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySet >& xColProp);
+
+		class KabTable : public KabTable_TYPEDEF
+		{
+			::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData > m_xMetaData;
+			KabConnection* m_pConnection;
+
+		public:
+			KabTable(	sdbcx::OCollection* _pTables, KabConnection* _pConnection);
+			KabTable(	sdbcx::OCollection* _pTables, 
+					KabConnection* _pConnection,
+					const ::rtl::OUString& _Name,
+					const ::rtl::OUString& _Type,
+					const ::rtl::OUString& _Description = ::rtl::OUString(),
+					const ::rtl::OUString& _SchemaName = ::rtl::OUString(),
+					const ::rtl::OUString& _CatalogName = ::rtl::OUString()
+				);
+
+			KabConnection* getConnection() { return m_pConnection;}
+
+			virtual void refreshColumns();
+
+			::rtl::OUString getTableName() const { return m_Name; }
+			::rtl::OUString getSchema() const { return m_SchemaName; }
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_TABLE_HXX_
Index: connectivity/source/drivers/kab/KTables.cxx
===================================================================
RCS file: connectivity/source/drivers/kab/KTables.cxx
diff -N connectivity/source/drivers/kab/KTables.cxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KTables.cxx	29 Aug 2005 08:43:55 -0000	1.1.2.1
@@ -0,0 +1,130 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#include "KTables.hxx"
+#ifndef _CONNECTIVITY_KAB_TABLE_HXX_
+#include "KTable.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CATALOG_HXX_
+#include "KCatalog.hxx"
+#endif
+#ifndef _CONNECTIVITY_KAB_CONNECTION_HXX_
+#include "KConnection.hxx"
+#endif
+
+#ifndef _COMPHELPER_TYPES_HXX_
+#include <comphelper/types.hxx>
+#endif
+
+using namespace connectivity::kab;
+using namespace connectivity;
+using namespace ::comphelper;
+using namespace ::cppu;
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::beans;
+using namespace ::com::sun::star::sdbcx;
+using namespace ::com::sun::star::sdbc;
+using namespace ::com::sun::star::container;
+using namespace ::com::sun::star::lang;
+
+sdbcx::ObjectType KabTables::createObject(const ::rtl::OUString& _rName)
+{
+	::rtl::OUString aName,aSchema;
+	aSchema = ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM("%"));
+	aName = _rName;
+
+	Sequence< ::rtl::OUString > aTypes(1);
+	aTypes[0] = ::rtl::OUString( RTL_CONSTASCII_USTRINGPARAM("%"));
+	::rtl::OUString sEmpty;
+
+	Reference< XResultSet > xResult = m_xMetaData->getTables(Any(), aSchema, aName, aTypes);
+
+	sdbcx::ObjectType xRet = NULL;
+	if (xResult.is())
+	{
+        Reference< XRow > xRow(xResult, UNO_QUERY);
+		if (xResult->next()) // there can be only one table with this name
+		{
+			KabTable* pRet = new KabTable(
+					this,
+					static_cast<KabCatalog&>(m_rParent).getConnection(),
+					aName,
+					xRow->getString(4),
+					xRow->getString(5),
+					sEmpty);
+			xRet = pRet;
+		}
+	}
+	::comphelper::disposeComponent(xResult);
+
+	return xRet;
+}
+// -------------------------------------------------------------------------
+void KabTables::impl_refresh(  ) throw(RuntimeException)
+{
+	static_cast<KabCatalog&>(m_rParent).refreshTables();
+}
+// -------------------------------------------------------------------------
+void KabTables::disposing(void)
+{
+	m_xMetaData = NULL;
+	OCollection::disposing();
+}
Index: connectivity/source/drivers/kab/KTables.hxx
===================================================================
RCS file: connectivity/source/drivers/kab/KTables.hxx
diff -N connectivity/source/drivers/kab/KTables.hxx
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/KTables.hxx	29 Aug 2005 08:43:55 -0000	1.1.2.1
@@ -0,0 +1,99 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., July, 2005
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2005 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2005 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): _______________________________________
+ *
+ *
+ ************************************************************************/
+
+#ifndef _CONNECTIVITY_KAB_TABLES_HXX_
+#define _CONNECTIVITY_KAB_TABLES_HXX_
+
+#ifndef _CONNECTIVITY_SDBCX_COLLECTION_HXX_
+#include "connectivity/sdbcx/VCollection.hxx"
+#endif
+#ifndef _COM_SUN_STAR_SDBC_XDATABASEMETADATA_HPP_
+#include <com/sun/star/sdbc/XDatabaseMetaData.hpp>
+#endif
+
+namespace connectivity
+{
+	namespace kab
+	{
+		class KabTables : public sdbcx::OCollection
+		{
+            ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData >       m_xMetaData;
+
+		protected:
+            virtual sdbcx::ObjectType createObject(const ::rtl::OUString& _rName);
+            virtual void impl_refresh() throw(::com::sun::star::uno::RuntimeException);
+
+		public:
+            KabTables(
+				const ::com::sun::star::uno::Reference< ::com::sun::star::sdbc::XDatabaseMetaData >& _rMetaData,
+				::cppu::OWeakObject& _rParent,
+				::osl::Mutex& _rMutex,
+				const TStringVector &_rVector)
+				: sdbcx::OCollection(_rParent,sal_True,_rMutex,_rVector),
+				  m_xMetaData(_rMetaData)
+				{ }
+
+			virtual void SAL_CALL disposing(void);
+		};
+	}
+}
+
+#endif // _CONNECTIVITY_KAB_TABLES_HXX_
Index: connectivity/source/drivers/kab/exports.dxp
===================================================================
RCS file: connectivity/source/drivers/kab/exports.dxp
diff -N connectivity/source/drivers/kab/exports.dxp
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/exports.dxp	29 Aug 2005 08:43:56 -0000	1.1.2.1
@@ -0,0 +1,3 @@
+component_getImplementationEnvironment
+component_writeInfo
+component_getFactory
Index: connectivity/source/drivers/kab/kab.map
===================================================================
RCS file: connectivity/source/drivers/kab/kab.map
diff -N connectivity/source/drivers/kab/kab.map
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/kab.map	29 Aug 2005 08:43:56 -0000	1.1.2.1
@@ -0,0 +1,8 @@
+KAB_1_0 {
+	global:
+		component_getImplementationEnvironment;
+		component_writeInfo;
+		component_getFactory;
+	local:
+		*;
+};
Index: connectivity/source/drivers/kab/kab.xml
===================================================================
RCS file: connectivity/source/drivers/kab/kab.xml
diff -N connectivity/source/drivers/kab/kab.xml
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/kab.xml	29 Aug 2005 08:43:56 -0000	1.1.2.1
@@ -0,0 +1,79 @@
+<?xml version='1.0' encoding="UTF-8"?>
+<!DOCTYPE COMPONENTDESCRIPTION PUBLIC "-//W3C//DTD HTML 3.2//EN" "module-description.dtd">
+<module-description xmlns:xlink="http://www.w3.org/1999/xlink">
+	<module-name>	kab1	</module-name>
+	<component-description>
+		<Author>Eric Bischoff</Author>
+		<Name>com.sun.star.comp.sdbc.kab.Driver</Name>
+		<description>This library implements the database driver for KDE address book formats.</description>
+		<loader-name>com.sun.star.loader.SharedLibrary</loader-name>
+		<language>c++</language>
+		<status value="final"/>
+		<supported-service>com.sun.star.sdbc.Driver</supported-service>
+		<service-dependency>	...	</service-dependency>
+	</component-description>	  
+	<project-build-dependency>	cppuhelper	</project-build-dependency>
+	<project-build-dependency>	cppu		</project-build-dependency>
+	<project-build-dependency>	sal			</project-build-dependency>
+	<project-build-dependency>	vos			</project-build-dependency>
+
+	<runtime-module-dependency>	cppuhelper	</runtime-module-dependency>
+	<runtime-module-dependency>	cppu1		</runtime-module-dependency>
+	<runtime-module-dependency>	sal1		</runtime-module-dependency>
+	<runtime-module-dependency>	vos			</runtime-module-dependency>
+
+	<type>	com.sun.star.registry.XRegistryKey			</type>
+	<type>	com.sun.star.util.XCancellable				</type>
+	<type>	com.sun.star.util.XNumberFormatter			</type>
+	<type>	com.sun.star.uno.TypeClass					</type>
+	<type>	com.sun.star.uno.XWeak						</type>
+	<type>	com.sun.star.uno.XAggregation				</type>
+	<type>	com.sun.star.uno.XComponentContext			</type>
+	<type>	com.sun.star.beans.PropertyAttribute		</type>
+	<type>	com.sun.star.beans.XPropertyState			</type>
+	<type>	com.sun.star.beans.XPropertySet				</type>
+	<type>	com.sun.star.beans.PropertyValue			</type>
+	<type>	com.sun.star.beans.XMultiPropertySet		</type>
+	<type>	com.sun.star.beans.XFastPropertySet			</type>
+	<type>	com.sun.star.lang.XSingleServiceFactory		</type>
+	<type>	com.sun.star.lang.XTypeProvider				</type>
+	<type>	com.sun.star.lang.XSingleComponentFactory	</type>
+	<type>	com.sun.star.lang.EventObject				</type>
+	<type>	com.sun.star.lang.XComponent				</type>
+	<type>	com.sun.star.lang.IllegalArgumentException	</type>
+	<type>	com.sun.star.lang.DisposedException			</type>
+	<type>	com.sun.star.lang.XMultiServiceFactory		</type>
+	<type>	com.sun.star.lang.XServiceInfo				</type>
+	<type>	com.sun.star.lang.XUnoTunnel				</type>
+	<type>	com.sun.star.java.XJavaThreadRegister_11	</type>
+	<type>	com.sun.star.java.XJavaVM					</type>	
+	<type>	com.sun.star.sdbc.FetchDirection			</type>
+	<type>	com.sun.star.sdbc.XConnection				</type>
+	<type>	com.sun.star.sdbc.XStatement				</type>
+	<type>	com.sun.star.sdbc.XResultSet				</type>
+	<type>	com.sun.star.sdbc.XResultSetMetaDataSupplier</type>
+	<type>	com.sun.star.sdbc.XColumnLocate				</type>
+	<type>	com.sun.star.sdbc.XResultSetUpdate			</type>
+	<type>	com.sun.star.sdbc.XWarningsSupplier			</type>
+	<type>	com.sun.star.sdbc.XRowUpdate				</type>
+	<type>	com.sun.star.sdbc.XMultipleResults			</type>
+	<type>	com.sun.star.sdbc.XBatchExecution			</type>
+	<type>	com.sun.star.sdbc.XPreparedBatchExecution	</type>
+	<type>	com.sun.star.sdbc.XParameters				</type>
+	<type>	com.sun.star.sdbc.XOutParameters			</type>
+	<type>	com.sun.star.sdbc.DriverPropertyInfo		</type>
+	<type>	com.sun.star.sdbc.SQLWarning				</type>
+	<type>	com.sun.star.sdbc.XRow						</type>
+	<type>	com.sun.star.sdbc.ColumnSearch				</type>
+	<type>	com.sun.star.sdbc.ColumnValue				</type>
+	<type>	com.sun.star.sdbc.DataType					</type>
+	<type>	com.sun.star.sdbc.XDriver					</type>
+	<type>	com.sun.star.sdbc.TransactionIsolation		</type>
+	<type>	com.sun.star.sdbc.ResultSetType				</type>
+	<type>	com.sun.star.sdbc.ResultSetConcurrency		</type>
+	<type>	com.sun.star.sdbcx.XRowLocate				</type>
+	<type>	com.sun.star.sdbcx.XDeleteRows				</type>
+	<type>	com.sun.star.sdbcx.CompareBookmark			</type>
+	<type>	com.sun.star.sdb.XColumnUpdate				</type>
+	<type>	com.sun.star.sdb.XColumn					</type>
+</module-description>
Index: connectivity/source/drivers/kab/makefile.mk
===================================================================
RCS file: connectivity/source/drivers/kab/makefile.mk
diff -N connectivity/source/drivers/kab/makefile.mk
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ connectivity/source/drivers/kab/makefile.mk	31 Aug 2005 08:30:37 -0000	1.1.2.4
@@ -0,0 +1,151 @@
+#*************************************************************************
+#
+#   $RCSfile$
+#
+#   $Revision$
+#
+#   last change: $Author$ $Date$
+#
+#   The Contents of this file are made available subject to the terms of
+#   either of the following licenses
+#
+#          - GNU Lesser General Public License Version 2.1
+#          - Sun Industry Standards Source License Version 1.1
+#
+#   Sun Microsystems Inc., July, 2005
+#
+#   GNU Lesser General Public License Version 2.1
+#   =============================================
+#   Copyright 2005 by Sun Microsystems, Inc.
+#   901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#   This library is free software; you can redistribute it and/or
+#   modify it under the terms of the GNU Lesser General Public
+#   License version 2.1, as published by the Free Software Foundation.
+#
+#   This library is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#   Lesser General Public License for more details.
+#
+#   You should have received a copy of the GNU Lesser General Public
+#   License along with this library; if not, write to the Free Software
+#   Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#   MA  02111-1307  USA
+#
+#
+#   Sun Industry Standards Source License Version 1.1
+#   =================================================
+#   The contents of this file are subject to the Sun Industry Standards
+#   Source License Version 1.1 (the "License"); You may not use this file
+#   except in compliance with the License. You may obtain a copy of the
+#   License at http://www.openoffice.org/license.html.
+#
+#   Software provided under this License is provided on an "AS IS" basis,
+#   WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+#   WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+#   MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+#   See the License for the specific provisions governing your rights and
+#   obligations concerning the Software.
+#
+#   The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+#
+#   Copyright: 2005 by Sun Microsystems, Inc.
+#
+#   All Rights Reserved.
+#
+#   Contributor(s): _______________________________________
+#
+#
+#
+#*************************************************************************
+
+PRJ=..$/..$/..
+PRJINC=..$/..
+PRJNAME=connectivity
+TARGET=kab
+
+# --- Settings ----------------------------------
+.IF "$(DBGUTIL_OJ)"!=""
+ENVCFLAGS+=/FR$(SLO)$/
+.ENDIF
+
+.INCLUDE : settings.mk
+.INCLUDE :  $(PRJ)$/version.mk
+
+.IF "$(GUI)" == "UNX"
+.IF "$(ENABLE_KDE)" == "TRUE"
+# --- Files -------------------------------------
+
+EXCEPTIONSFILES=\
+	$(SLO)$/KColumns.obj			\
+	$(SLO)$/KTable.obj				\
+	$(SLO)$/KTables.obj				\
+	$(SLO)$/KCatalog.obj			\
+	$(SLO)$/KResultSet.obj			\
+	$(SLO)$/KStatement.obj			\
+	$(SLO)$/KPreparedStatement.obj	\
+	$(SLO)$/KDatabaseMetaData.obj	\
+	$(SLO)$/KConnection.obj			\
+	$(SLO)$/KServices.obj			\
+	$(SLO)$/KResultSetMetaData.obj	\
+	$(SLO)$/KDriver.obj				\
+	$(SLO)$/KCondition.obj
+ 
+CFLAGS+=$(KDE_CFLAGS)
+
+SLOFILES=\
+	$(EXCEPTIONSFILES)
+
+KAB_LIB=$(KDE_LIBS) -lkabc
+
+SHL1VERSIONMAP=$(TARGET).map
+
+
+# --- Library -----------------------------------
+
+SHL1TARGET=	$(KAB_TARGET)$(KAB_MAJOR)
+SHL1OBJS=$(SLOFILES)
+SHL1STDLIBS=\
+	$(CPPULIB)					\
+	$(CPPUHELPERLIB)			\
+	$(VOSLIB)					\
+	$(OSLLIB)					\
+	$(SVLLIB)					\
+	$(SVLIB)					\
+	$(TOOLSLIB)					\
+	$(SVTOOLLIB)				\
+	$(SVTLIB)					\
+	$(UNOTOOLSLIB)				\
+	$(UCBHELPERLIB)				\
+	$(SALLIB)					\
+	$(DBTOOLSLIB)				\
+	$(DBFILELIB)				\
+	$(COMPHELPERLIB)			\
+	$(KAB_LIB)
+
+.IF "$(DBFILELIB)" == ""
+SHL1STDLIBS+= ifile$(UPD).lib
+.ENDIF
+
+SHL1DEPN=
+SHL1IMPLIB=	i$(TARGET)
+
+SHL1DEF=	$(MISC)$/$(SHL1TARGET).def
+
+DEF1NAME=	$(SHL1TARGET)
+
+
+# --- Targets -----------------------------------
+.ELSE		# "$(ENABLE_KDE)" == "TRUE"
+dummy:
+	@echo KDE disabled - nothing to build
+.ENDIF
+
+.ELSE		# "$(GUI)" == "UNX"
+dummy:
+	@echo "Nothing to build for GUI $(GUI)"
+.ENDIF
+
+.INCLUDE : target.mk
+
Index: helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp
===================================================================
RCS file: /cvs/documentation/helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp,v
retrieving revision 1.5
retrieving revision 1.5.18.1
diff -u -p -u -p -r1.5 -r1.5.18.1
--- helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp	30 Jun 2005 16:22:49 -0000	1.5
+++ helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp	29 Aug 2005 09:00:32 -0000	1.5.18.1
@@ -87,7 +87,7 @@
 <paragraph role="paragraph" id="par_idN10590" xml-lang="en-US" l10n="NEW"><ahelp hid=".">Select to create a database document for an existing database connection.</ahelp></paragraph>
 <paragraph role="heading" id="par_idN10593" xml-lang="en-US" level="3" l10n="NEW">Database type</paragraph>
 <paragraph role="paragraph" id="par_idN10597" xml-lang="en-US" l10n="NEW"><ahelp hid=".">Select the database type for the existing database connection.</ahelp></paragraph>
-<paragraph role="note" id="par_idN1059A" xml-lang="en-US" l10n="NEW">The Outlook, Evolution, and Mozilla database types do not need additional information. For other database types, the wizard contains additional pages to specify the required information.</paragraph>
+<paragraph role="note" id="par_idN1059A" xml-lang="en-US" l10n="NEW">The Outlook, Evolution, KDE Address Book, and Mozilla database types do not need additional information. For other database types, the wizard contains additional pages to specify the required information.</paragraph>
 <paragraph role="paragraph" id="par_idN10611" xml-lang="en-US" l10n="NEW">The next wizard page is one of the following pages:</paragraph>
 <embed href="text/shared/explorer/database/dabawiz02.xhp#nextsteps"/>
 <paragraph role="paragraph" id="par_idN1061C" xml-lang="en-US" l10n="NEW"><link href="text/shared/explorer/database/dabawiz02text.xhp">Set up text file connection</link></paragraph>
Index: solenv/inc/unx.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/unx.mk,v
retrieving revision 1.27
retrieving revision 1.27.286.3
diff -u -p -u -p -r1.27 -r1.27.286.3
--- solenv/inc/unx.mk	18 Jan 2005 14:50:42 -0000	1.27
+++ solenv/inc/unx.mk	31 Aug 2005 16:01:01 -0000	1.27.286.3
@@ -230,5 +230,14 @@ SONAME_SWITCH*=-h
 .IF "$(UNIXVERSIONNAMES)"!=""
 DLLPOST!:=$(DLLPOST).$($(UNIXVERSIONNAMES)_MAJOR)
 .ENDIF			# "$(UNIXVERSIONNAMES)"!=""
-.ENDIF			# "$(GUI)" == "UNX"
 
+#enable building/linking KDE-dependent code in both OOo and SO build environment
+.IF "$(ENABLE_KDE)" != ""
+.IF "$(KDE_ROOT)"!=""
+KDE_CFLAGS:=-I$(KDE_ROOT)$/include -DQT_CLEAN_NAMESPACE
+KDE_LIBS:=-lkdeui -lkdecore -lqt-mt
+SOLARLIB+=-L$(KDE_ROOT)$/lib
+.ENDIF          # "$(KDE_ROOT)"!=""
+.ENDIF          # "$(ENABLE_KDE)" != ""
+
+.ENDIF			# "$(GUI)" == "UNX"
Index: officecfg/registry/data/org/openoffice/Office/DataAccess.xcu
===================================================================
RCS file: /cvs/util/officecfg/registry/data/org/openoffice/Office/DataAccess.xcu,v
retrieving revision 1.20
retrieving revision 1.20.226.1
diff -u -p -u -p -r1.20 -r1.20.226.1
--- officecfg/registry/data/org/openoffice/Office/DataAccess.xcu	17 Nov 2004 14:07:13 -0000	1.20
+++ officecfg/registry/data/org/openoffice/Office/DataAccess.xcu	29 Aug 2005 09:21:23 -0000	1.20.226.1
@@ -85,6 +85,17 @@
            <value>60</value>
          </prop>
       </node>
+      <node oor:name="com.sun.star.comp.sdbc.kab.Driver" oor:op="replace">
+         <prop oor:name="DriverName">
+           <value>com.sun.star.comp.sdbc.kab.Driver</value>
+         </prop>
+         <prop oor:name="Enable">
+           <value>false</value>
+         </prop>
+         <prop oor:name="Timeout">
+           <value>60</value>
+         </prop>
+      </node>
       <node oor:name="com.sun.star.comp.sdbc.ado.ODriver" oor:op="replace">
         <prop oor:name="DriverName">
           <value>com.sun.star.comp.sdbc.ado.ODriver</value>
Index: officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs
===================================================================
RCS file: /cvs/util/officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs,v
retrieving revision 1.32
retrieving revision 1.32.228.1
diff -u -p -u -p -r1.32 -r1.32.228.1
--- officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs	24 Nov 2004 17:28:07 -0000	1.32
+++ officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs	29 Aug 2005 09:21:24 -0000	1.32.228.1
@@ -754,6 +754,198 @@
 					</prop>
 				</group>
 			</group>
+			<group oor:name="com.sun.star.comp.sdbc.kab.Driver">
+				<info>
+					<desc>Specifies the driver settings for the KAddressBook database driver.</desc>
+				</info>
+				<group oor:name="KAddressBookPreferences">
+					<info>
+						<desc>Specifies the KAddressBook preferences.</desc>
+					</info>
+					<prop oor:name="FullPathExportingCommand" oor:type="xs:string">
+						<info>
+							<desc>Specifies the KAddressBook full path exporting command name.</desc>
+						</info>
+						<value/>
+						<!-- JB: Empty default inserted into empty property node. Remove if NIL was intended -->
+					</prop>
+				</group>
+				<group oor:name="ColumnAliases">
+					<info>
+						<desc>Specifies the column alias names used.</desc>
+					</info>
+					<prop oor:name="Formatted Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the display name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Family Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the last name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Given Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the first name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Additional Names" oor:type="xs:string">
+						<info>
+							<desc>Specifies the other names.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Honorific Prefixes" oor:type="xs:string">
+						<info>
+							<desc>Specifies the titles before the name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Honorific Suffixes" oor:type="xs:string">
+						<info>
+							<desc>Specifies the ttiles after the name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Nick Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the nick name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Birthday" oor:type="xs:string">
+						<info>
+							<desc>Specifies the date of birth.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Street" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home street.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address City" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home city.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address State" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home state.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Zip Code" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home postal code.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Country" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home country.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Label" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home label.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Street" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work street.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address City" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work city.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address State" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work state.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Zip Code" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work postal code.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Country" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work country.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Mobile Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the mobile phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Fax" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home fax number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Fax" oor:type="xs:string">
+						<info>
+							<desc>Specifies the business fax number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Car Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the car phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="ISDN" oor:type="xs:string">
+						<info>
+							<desc>Specifies the ISDN number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Pager" oor:type="xs:string">
+						<info>
+							<desc>Specifies the pager number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Email Address" oor:type="xs:string">
+						<info>
+							<desc>Specifies the email address.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Mail Client" oor:type="xs:string">
+						<info>
+							<desc>Specifies the type of email software used.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Title" oor:type="xs:string">
+						<info>
+							<desc>Specifies the honorific title.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Role" oor:type="xs:string">
+						<info>
+							<desc>Specifies the exerced job.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Organization" oor:type="xs:string">
+						<info>
+							<desc>Specifies the company or administration.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Note" oor:type="xs:string">
+						<info>
+							<desc>Specifies the notes.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Homepage" oor:type="xs:string">
+						<info>
+							<desc>Specifies the web page.</desc>
+						</info>
+					</prop>
+				</group>
+			</group>
 		</group>
 		<group oor:name="FormSearchOptions">
 			<info>
Index: config_office/configure
===================================================================
RCS file: /cvs/tools/config_office/configure,v
retrieving revision 1.112
retrieving revision 1.112.8.1
diff -u -p -u -p -r1.112 -r1.112.8.1
--- config_office/configure	5 Aug 2005 15:58:49 -0000	1.112
+++ config_office/configure	26 Aug 2005 14:53:44 -0000	1.112.8.1
@@ -17846,7 +17846,7 @@ your KDE installation by exporting KDEDI
    { (exit 1); exit 1; }; }
     fi
 
-        KDE_CFLAGS="-I$qt_incdir -I$kde_incdir -DQT_CLEAN_NAMESPACE -DQT_NO_EMIT -DQT_THREAD_SUPPORT"
+        KDE_CFLAGS="-I$qt_incdir -I$kde_incdir -DQT_CLEAN_NAMESPACE -DQT_THREAD_SUPPORT"
     KDE_LIBS="-L$kde_libdir -L$qt_libdir -lkdeui -lkdecore -lqt-mt"
 fi
 
Index: config_office/configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.129
retrieving revision 1.129.8.1
diff -u -p -u -p -r1.129 -r1.129.8.1
--- config_office/configure.in	5 Aug 2005 15:05:56 -0000	1.129
+++ config_office/configure.in	26 Aug 2005 14:53:46 -0000	1.129.8.1
@@ -3779,7 +3779,7 @@ your KDE installation by exporting KDEDI
     fi
 
     dnl Set the variables
-    KDE_CFLAGS="-I$qt_incdir -I$kde_incdir -DQT_CLEAN_NAMESPACE -DQT_NO_EMIT -DQT_THREAD_SUPPORT"
+    KDE_CFLAGS="-I$qt_incdir -I$kde_incdir -DQT_CLEAN_NAMESPACE -DQT_THREAD_SUPPORT"
     KDE_LIBS="-L$kde_libdir -L$qt_libdir -lkdeui -lkdecore -lqt-mt"
 fi
 AC_SUBST(KDE_CFLAGS)
Index: dbaccess/source/ui/app/AppController.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/app/AppController.cxx,v
retrieving revision 1.20
retrieving revision 1.20.82.1
diff -u -p -u -p -r1.20 -r1.20.82.1
--- dbaccess/source/ui/app/AppController.cxx	6 Apr 2005 11:40:09 -0000	1.20
+++ dbaccess/source/ui/app/AppController.cxx	29 Aug 2005 08:51:30 -0000	1.20.82.1
@@ -801,7 +801,7 @@ FeatureState OApplicationController::Get
			if ( aReturn.bEnabled = m_xDataSource.is() )
				{
					DATASOURCE_TYPE eType = m_aTypeCollection.getType(::comphelper::getString(m_xDataSource->getPropertyValue(PROPERTY_URL)));
-					aReturn.bEnabled = DST_EMBEDDED != eType && DST_MOZILLA != eType && DST_EVOLUTION != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
+					aReturn.bEnabled = DST_EMBEDDED != eType && DST_MOZILLA != eType && DST_EVOLUTION != eType && DST_KAB != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
 				}
 				break;
 			case SID_DB_APP_DSCONNECTION_TYPE:
@@ -816,7 +816,7 @@ FeatureState OApplicationController::Get
 				if ( aReturn.bEnabled = m_xDataSource.is() )
 				{
 					DATASOURCE_TYPE eType = m_aTypeCollection.getType(::comphelper::getString(m_xDataSource->getPropertyValue(PROPERTY_URL)));
-					aReturn.bEnabled = DST_EMBEDDED != eType && DST_LDAP != eType && DST_CALC != eType && DST_MOZILLA != eType && DST_THUNDERBIRD != eType && DST_EVOLUTION != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
+					aReturn.bEnabled = DST_EMBEDDED != eType && DST_LDAP != eType && DST_CALC != eType && DST_MOZILLA != eType && DST_THUNDERBIRD != eType && DST_EVOLUTION != eType && DST_KAB != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
 				}
 				break;
 			case SID_DB_APP_CONVERTTOVIEW:
Index: dbaccess/source/ui/dlg/AdabasStatDlg.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/AdabasStatDlg.cxx,v
retrieving revision 1.5
retrieving revision 1.5.44.2
diff -u -p -u -p -r1.5 -r1.5.44.2
--- dbaccess/source/ui/dlg/AdabasStatDlg.cxx	30 Jun 2005 16:30:03 -0000	1.5
+++ dbaccess/source/ui/dlg/AdabasStatDlg.cxx	30 Aug 2005 11:11:43 -0000	1.5.44.2
@@ -141,32 +141,6 @@ namespace dbaui
 			case DST_ADABAS:
 				AddTabPage(TAB_PAG_ADABAS_SETTINGS, String(ResId(STR_PAGETITLE_ADABAS_STATISTIC)), ODriversSettings::CreateAdabas,0, sal_False, 1);
 				break;
-			case DST_DBASE:
-			case DST_FLAT: 
-			case DST_MSACCESS:
-			case DST_ADO:
-			case DST_ODBC:
-			case DST_MYSQL_ODBC:
-			case DST_MYSQL_JDBC:
-			case DST_LDAP:
-			case DST_CALC:
-			case DST_MOZILLA: 
-			case DST_THUNDERBIRD:
-			case DST_EVOLUTION: 
-			case DST_OUTLOOK	: 
-			case DST_OUTLOOKEXP:
-			case DST_JDBC:
-			case DST_ORACLE_JDBC:
-			case DST_USERDEFINE1:	/// first user defined driver
-			case DST_USERDEFINE2:
-			case DST_USERDEFINE3:
-			case DST_USERDEFINE4:
-			case DST_USERDEFINE5:
-			case DST_USERDEFINE6:
-			case DST_USERDEFINE7:
-			case DST_USERDEFINE8:
-			case DST_USERDEFINE9:
-			case DST_USERDEFINE10:
 			default:
 				OSL_ENSURE(0,"Not supported for other types thasn adabas!");
 				break;
Index: dbaccess/source/ui/dlg/AdvancedPageDlg.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/AdvancedPageDlg.cxx,v
retrieving revision 1.5
retrieving revision 1.5.44.1
diff -u -p -u -p -r1.5 -r1.5.44.1
--- dbaccess/source/ui/dlg/AdvancedPageDlg.cxx	30 Jun 2005 16:30:21 -0000	1.5
+++ dbaccess/source/ui/dlg/AdvancedPageDlg.cxx	29 Aug 2005 08:51:32 -0000	1.5.44.1
@@ -165,6 +165,7 @@ namespace dbaui
 			case DST_MOZILLA: 
 			case DST_THUNDERBIRD:
 			case DST_EVOLUTION: 
+			case DST_KAB: 
 			case DST_OUTLOOK	: 
 			case DST_OUTLOOKEXP:
 				break;
Index: dbaccess/source/ui/dlg/ConnectionPage.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/ConnectionPage.cxx,v
retrieving revision 1.10
retrieving revision 1.10.94.1
diff -u -p -u -p -r1.10 -r1.10.94.1
--- dbaccess/source/ui/dlg/ConnectionPage.cxx	18 Mar 2005 10:09:18 -0000	1.10
+++ dbaccess/source/ui/dlg/ConnectionPage.cxx	29 Aug 2005 08:51:32 -0000	1.10.94.1
@@ -323,6 +323,7 @@ namespace dbaui
 			case DST_OUTLOOK:
 			case DST_OUTLOOKEXP:
 			case DST_EVOLUTION:
+			case DST_KAB:
                 m_aFT_Connection.SetText(String(ModuleRes(STR_NO_ADDITIONAL_SETTINGS)));
 				{
 					String sText = m_aFT_Connection.GetText();
Index: dbaccess/source/ui/dlg/DriverSettings.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/DriverSettings.cxx,v
retrieving revision 1.3
retrieving revision 1.3.110.1
diff -u -p -u -p -r1.3 -r1.3.110.1
--- dbaccess/source/ui/dlg/DriverSettings.cxx	21 Feb 2005 12:41:35 -0000	1.3
+++ dbaccess/source/ui/dlg/DriverSettings.cxx	29 Aug 2005 08:51:32 -0000	1.3.110.1
@@ -174,6 +174,9 @@ void ODriversSettings::fillDetailIds(DAT
 		case DST_EVOLUTION: 
 			_rDetailsIds.push_back(DSID_DOSLINEENDS);
 			break;
+		case DST_KAB: 
+			_rDetailsIds.push_back(DSID_DOSLINEENDS);
+			break;
 		case DST_OUTLOOK: 
 			_rDetailsIds.push_back(DSID_DOSLINEENDS);
 			break;
Index: dbaccess/source/ui/dlg/dbadmin2.src
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/dbadmin2.src,v
retrieving revision 1.4
retrieving revision 1.4.110.1
diff -u -p -u -p -r1.4 -r1.4.110.1
--- dbaccess/source/ui/dlg/dbadmin2.src	21 Feb 2005 12:43:11 -0000	1.4
+++ dbaccess/source/ui/dlg/dbadmin2.src	29 Aug 2005 08:51:32 -0000	1.4.110.1
@@ -133,6 +133,11 @@ String STR_ADDRESSBOOK_EVOLUTION
 	Text [ de ] ="Evolution address book";
 	Text[ en-US ] = "Evolution address book";
 };
+String STR_ADDRESSBOOK_KAB
+{
+	Text [ de ] ="KDE address book";
+	Text[ en-US ] = "KDE address book";
+};
 String STR_ADDRESSBOOK_LDAP
 {
 	Text [ de ] ="LDAP Adressbuch";
Index: dbaccess/source/ui/dlg/dbwiz.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/dbwiz.cxx,v
retrieving revision 1.7
retrieving revision 1.7.46.1
diff -u -p -u -p -r1.7 -r1.7.46.1
--- dbaccess/source/ui/dlg/dbwiz.cxx	30 Jun 2005 16:32:42 -0000	1.7
+++ dbaccess/source/ui/dlg/dbwiz.cxx	29 Aug 2005 08:51:33 -0000	1.7.46.1
@@ -206,6 +206,7 @@ IMPL_LINK(ODbTypeWizDialog, OnTypeSelect
 		case DST_OUTLOOK:
 		case DST_OUTLOOKEXP:
 		case DST_EVOLUTION:
+		case DST_KAB:
             enableButtons(WZB_NEXT,sal_False);
 			enableButtons(WZB_FINISH,sal_True);
 			break;
@@ -229,6 +230,7 @@ WizardTypes::WizardState ODbTypeWizDialo
 				case DST_OUTLOOK:
 				case DST_OUTLOOKEXP:
 				case DST_EVOLUTION:
+				case DST_KAB:
 					nNextState = WZS_INVALID_STATE;
 					break;
                 default:
@@ -244,6 +246,7 @@ WizardTypes::WizardState ODbTypeWizDialo
 				case DST_OUTLOOK:
 				case DST_OUTLOOKEXP:
 				case DST_EVOLUTION:
+				case DST_KAB:
 				case DST_MSACCESS:
 				case DST_JDBC:
 				case DST_CALC:
Index: dbaccess/source/ui/dlg/dbwizsetup.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/dbwizsetup.cxx,v
retrieving revision 1.12
retrieving revision 1.12.44.1
diff -u -p -u -p -r1.12 -r1.12.44.1
--- dbaccess/source/ui/dlg/dbwizsetup.cxx	30 Jun 2005 16:32:58 -0000	1.12
+++ dbaccess/source/ui/dlg/dbwizsetup.cxx	29 Aug 2005 08:51:33 -0000	1.12.44.1
@@ -268,10 +268,11 @@ using namespace ::cppu;
 #define OUTLOOK_PATH           14
 #define MOZILLA_PATH           15
 #define EVOLUTION_PATH         16
-#define THUNDERBIRD_PATH       17
-#define CREATENEW_PATH         18
-#define USERDEFINED_PATH       19
-#define OPEN_DOC_PATH          20
+#define KAB_PATH               17
+#define THUNDERBIRD_PATH       18
+#define CREATENEW_PATH         19
+#define USERDEFINED_PATH       20
+#define OPEN_DOC_PATH          21
 
 OFinalDBPageSetup*          pFinalPage;
 
@@ -419,6 +420,11 @@ ODbTypeWizDialogSetup::ODbTypeWizDialogS
     else
         declarePath( EVOLUTION_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
 
+if ( m_pCollection->hasAuthentication(DST_KAB))
+	declarePath( KAB_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_AUTHENTIFICATION, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
+else
+	declarePath( KAB_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
+
 	if ( m_pCollection->hasAuthentication(m_pCollection->getEmbeddedDatabaseType(getORB())))
         declarePath( CREATENEW_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_AUTHENTIFICATION, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
     else
@@ -560,6 +566,7 @@ void ODbTypeWizDialogSetup::activateData
             { DST_MOZILLA,      MOZILLA_PATH        },
             { DST_THUNDERBIRD,  THUNDERBIRD_PATH    },
             { DST_EVOLUTION,    EVOLUTION_PATH      },
+            { DST_KAB,          KAB_PATH            },
             { DST_USERDEFINE1,  USERDEFINED_PATH    },
 		    { DST_USERDEFINE2,  USERDEFINED_PATH    },
 		    { DST_USERDEFINE3,  USERDEFINED_PATH    },
@@ -630,6 +637,7 @@ sal_Bool ODbTypeWizDialogSetup::IsConnec
 	DATASOURCE_TYPE eType = getDatasourceType(*m_pOutSet);
 	switch ( m_eType )
     {
+		case DST_KAB:
         case DST_EVOLUTION:
         case DST_OUTLOOK:
         case DST_OUTLOOKEXP:
Index: dbaccess/source/ui/inc/dbu_dlg.hrc
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/inc/dbu_dlg.hrc,v
retrieving revision 1.8
retrieving revision 1.8.46.1
diff -u -p -u -p -r1.8 -r1.8.46.1
--- dbaccess/source/ui/inc/dbu_dlg.hrc	30 Jun 2005 16:33:57 -0000	1.8
+++ dbaccess/source/ui/inc/dbu_dlg.hrc	29 Aug 2005 08:51:34 -0000	1.8.46.1
@@ -108,28 +108,29 @@
 #define STR_ADDRESSBOOK_SYSTEM				RID_STR_DLG_START + 17
 #define STR_ADDRESSBOOK_MOZILLA				RID_STR_DLG_START + 18
 #define STR_ADDRESSBOOK_EVOLUTION			RID_STR_DLG_START + 19
-#define STR_ADDRESSBOOK_LDAP				RID_STR_DLG_START + 20
-#define STR_ADDRESSBOOK_OUTLOOK				RID_STR_DLG_START + 21
-#define STR_COMMAND_EXECUTED_SUCCESSFULLY	RID_STR_DLG_START + 22
-#define STR_DIRECTSQL_CONNECTIONLOST		RID_STR_DLG_START + 23
+#define STR_ADDRESSBOOK_KAB					RID_STR_DLG_START + 20
+#define STR_ADDRESSBOOK_LDAP				RID_STR_DLG_START + 21
+#define STR_ADDRESSBOOK_OUTLOOK				RID_STR_DLG_START + 22
+#define STR_COMMAND_EXECUTED_SUCCESSFULLY	RID_STR_DLG_START + 23
+#define STR_DIRECTSQL_CONNECTIONLOST		RID_STR_DLG_START + 24
     // FREE
-#define STR_HINT_READONLY_CONNECTION		RID_STR_DLG_START + 25
-#define STR_HINT_CONNECTION_NOT_CAPABLE		RID_STR_DLG_START + 26
-#define STR_USERADMIN_NOT_AVAILABLE			RID_STR_DLG_START + 27
-#define STR_TAB_INDEX_SORTORDER				RID_STR_DLG_START + 28
-#define STR_TAB_INDEX_FIELD					RID_STR_DLG_START + 29
-#define STR_ORDER_ASCENDING					RID_STR_DLG_START + 30
-#define STR_ORDER_DESCENDING				RID_STR_DLG_START + 31
-#define STR_CONFIRM_DROP_INDEX				RID_STR_DLG_START + 32
-#define STR_LOGICAL_INDEX_NAME				RID_STR_DLG_START + 33
-#define STR_CONNECTION_TEST					RID_STR_DLG_START + 34
-#define STR_CONNECTION_SUCCESS				RID_STR_DLG_START + 35
-#define STR_JDBCDRIVER_TEST					RID_STR_DLG_START + 36
-#define STR_JDBCDRIVER_SUCCESS				RID_STR_DLG_START + 37
-#define STR_JDBCDRIVER_NO_SUCCESS			RID_STR_DLG_START + 38
-#define STR_MSACCESS_FILTERNAME				RID_STR_DLG_START + 39
-#define STR_CONNECTION_NO_SUCCESS			RID_STR_DLG_START + 40
-#define STR_DBASE_PATH_OR_FILE				RID_STR_DLG_START + 41
+#define STR_HINT_READONLY_CONNECTION		RID_STR_DLG_START + 26
+#define STR_HINT_CONNECTION_NOT_CAPABLE		RID_STR_DLG_START + 27
+#define STR_USERADMIN_NOT_AVAILABLE			RID_STR_DLG_START + 28
+#define STR_TAB_INDEX_SORTORDER				RID_STR_DLG_START + 29
+#define STR_TAB_INDEX_FIELD					RID_STR_DLG_START + 30
+#define STR_ORDER_ASCENDING					RID_STR_DLG_START + 31
+#define STR_ORDER_DESCENDING				RID_STR_DLG_START + 32
+#define STR_CONFIRM_DROP_INDEX				RID_STR_DLG_START + 33
+#define STR_LOGICAL_INDEX_NAME				RID_STR_DLG_START + 34
+#define STR_CONNECTION_TEST					RID_STR_DLG_START + 35
+#define STR_CONNECTION_SUCCESS				RID_STR_DLG_START + 36
+#define STR_JDBCDRIVER_TEST					RID_STR_DLG_START + 37
+#define STR_JDBCDRIVER_SUCCESS				RID_STR_DLG_START + 38
+#define STR_JDBCDRIVER_NO_SUCCESS			RID_STR_DLG_START + 39
+#define STR_MSACCESS_FILTERNAME				RID_STR_DLG_START + 40
+#define STR_CONNECTION_NO_SUCCESS			RID_STR_DLG_START + 41
+#define STR_DBASE_PATH_OR_FILE				RID_STR_DLG_START + 42
 #define STR_TEXT_PATH_OR_FILE				RID_STR_DLG_START + 45
 #define STR_FLAT_PATH_OR_FILE				RID_STR_DLG_START + 46
 #define STR_CALC_PATH_OR_FILE				RID_STR_DLG_START + 47
Index: dbaccess/source/ui/inc/dsntypes.hxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/inc/dsntypes.hxx,v
retrieving revision 1.17
retrieving revision 1.17.110.1
diff -u -p -u -p -r1.17 -r1.17.110.1
--- dbaccess/source/ui/inc/dsntypes.hxx	21 Feb 2005 12:45:45 -0000	1.17
+++ dbaccess/source/ui/inc/dsntypes.hxx	29 Aug 2005 08:51:34 -0000	1.17.110.1
@@ -99,8 +99,9 @@ enum DATASOURCE_TYPE
 	DST_OUTLOOK		=	14,	
 	DST_OUTLOOKEXP	=	15,	
 	DST_EVOLUTION	=	16,
-	DST_EMBEDDED	=	17,
- 	DST_THUNDERBIRD	=	18,	
+	DST_KAB			=	17,
+	DST_EMBEDDED	=	18,
+ 	DST_THUNDERBIRD	=	19,	
 
 	DST_USERDEFINE1,	/// first user defined driver
 	DST_USERDEFINE2,
Index: dbaccess/source/ui/misc/dbumiscres.hrc
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/misc/dbumiscres.hrc,v
retrieving revision 1.6
retrieving revision 1.6.110.1
diff -u -p -u -p -r1.6 -r1.6.110.1
--- dbaccess/source/ui/misc/dbumiscres.hrc	21 Feb 2005 12:45:59 -0000	1.6
+++ dbaccess/source/ui/misc/dbumiscres.hrc	29 Aug 2005 08:51:34 -0000	1.6.110.1
@@ -81,8 +81,9 @@
 #define STR_OUTLOOK				14
 #define STR_OUTLOOKEXP			15
 #define STR_EVOLUTION			16 
-#define STR_EMBEDDED			17
-#define STR_THUNDERBIRD			18
+#define STR_KAB					17
+#define STR_EMBEDDED			18
+#define STR_THUNDERBIRD			19
 
 #define STR_END					STR_THUNDERBIRD + 1
 
Index: dbaccess/source/ui/misc/dbumiscres.src
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/misc/dbumiscres.src,v
retrieving revision 1.67
retrieving revision 1.67.110.1
diff -u -p -u -p -r1.67 -r1.67.110.1
--- dbaccess/source/ui/misc/dbumiscres.src	21 Feb 2005 12:46:20 -0000	1.67
+++ dbaccess/source/ui/misc/dbumiscres.src	29 Aug 2005 08:51:35 -0000	1.67.110.1
@@ -137,6 +137,10 @@ Resource RSC_DATASOURCE_TYPES
 	{
 		Text  ="sdbc:address:evolution";
 	};	
+	String STR_KAB
+	{
+		Text  ="sdbc:address:kab";
+	};
 	String STR_EMBEDDED
 	{
 		Text = "sdbc:embedded:";
@@ -226,6 +230,11 @@ Resource RSC_DATASOURCE_TYPE_UINAMES
 		Text [ de ] = "Evolution Adressbuch";
 		Text[ en-US ] = "Evolution Address Book";
 	};
+	String STR_KAB
+	{
+		Text [ de ] = "KDE Adressbuch";
+		Text[ en-US ] = "KDE Address Book";
+	};
 	String STR_EMBEDDED
 	{
 		Text [ de ] = "Interne Datenbank";
Index: dbaccess/source/ui/misc/dsntypes.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/misc/dsntypes.cxx,v
retrieving revision 1.25
retrieving revision 1.25.110.1
diff -u -p -u -p -r1.25 -r1.25.110.1
--- dbaccess/source/ui/misc/dsntypes.cxx	21 Feb 2005 14:15:14 -0000	1.25
+++ dbaccess/source/ui/misc/dsntypes.cxx	29 Aug 2005 08:51:35 -0000	1.25.110.1
@@ -413,6 +413,7 @@ sal_Bool ODsnTypeCollection::supportsTab
 			case DST_OUTLOOKEXP:
 			case DST_FLAT:
             case DST_EVOLUTION:
+            case DST_KAB:
 	 		case DST_THUNDERBIRD:
 			case DST_CALC:
                 bSupportsTableCreation = FALSE;
@@ -458,6 +459,7 @@ sal_Bool ODsnTypeCollection::supportsBro
 		case DST_OUTLOOKEXP:
 		case DST_JDBC:
         case DST_EVOLUTION:
+        case DST_KAB:
 			bEnableBrowseButton = FALSE;
 			break;
 		default:
@@ -497,6 +499,7 @@ sal_Bool ODsnTypeCollection::hasAuthenti
 		case DST_MOZILLA:
 		case DST_THUNDERBIRD:
 		case DST_EVOLUTION:
+		case DST_KAB:
 		case DST_OUTLOOK:
         case DST_OUTLOOKEXP: //????
 		case DST_DBASE:
@@ -576,6 +579,8 @@ DATASOURCE_TYPE ODsnTypeCollection::impl
 			return DST_OUTLOOKEXP;
 		if (_rDsn.EqualsIgnoreCaseAscii("evolution", nSeparator,_rDsn.Len() - nSeparator))
 			return DST_EVOLUTION;
+		if (_rDsn.EqualsIgnoreCaseAscii("kab", nSeparator,_rDsn.Len() - nSeparator))
+			return DST_KAB;
 	}
 
 	// find third :
Index: vcl/unx/kde/makefile.mk
===================================================================
RCS file: /cvs/gsl/vcl/unx/kde/makefile.mk,v
retrieving revision 1.5
retrieving revision 1.5.140.1
diff -u -p -u -p -r1.5 -r1.5.140.1
--- vcl/unx/kde/makefile.mk	18 May 2005 08:05:57 -0000	1.5
+++ vcl/unx/kde/makefile.mk	31 Aug 2005 12:40:24 -0000	1.5.140.1
@@ -85,10 +85,6 @@ dummy:
 
 .IF "$(ENABLE_KDE)" != ""
 
-.IF "$(KDE_ROOT)"!=""
-KDE_CFLAGS:=-I$(KDE_ROOT)$/include -DQT_CLEAN_NAMESPACE
-.ENDIF 			# "$(KDE_ROOT)"!=""
-
 CFLAGS+=$(KDE_CFLAGS)
 
 SLOFILES=\
Index: vcl/util/makefile.mk
===================================================================
RCS file: /cvs/gsl/vcl/util/makefile.mk,v
retrieving revision 1.71
retrieving revision 1.71.68.1
diff -u -p -u -p -r1.71 -r1.71.68.1
--- vcl/util/makefile.mk	18 Jul 2005 14:10:12 -0000	1.71
+++ vcl/util/makefile.mk	31 Aug 2005 12:40:43 -0000	1.71.68.1
@@ -403,10 +403,6 @@ SHL4STDLIBS+=$(SHL3STDLIBS) -lX11 -ldl
 
 # KDE plugin
 .IF "$(ENABLE_KDE)" != ""
-.IF "$(KDE_ROOT)"!=""
-SOLARLIB+=-L$(KDE_ROOT)$/lib
-KDE_LIBS:=-lkdeui -lkdecore -lqt-mt
-.ENDIF 			# "$(KDE_ROOT)"!=""
 LIB5TARGET=$(SLB)$/ikde_plug_
 LIB5FILES=$(SLB)$/kdeplug.lib
 SHL5TARGET=vclplug_kde$(UPD)$(DLLPOSTFIX)
Index: scp2/source/ooo/file_library_ooo.scp
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/file_library_ooo.scp,v
retrieving revision 1.136
retrieving revision 1.136.14.1
diff -u -p -u -p -r1.136 -r1.136.14.1
--- scp2/source/ooo/file_library_ooo.scp	5 Aug 2005 12:55:52 -0000	1.136
+++ scp2/source/ooo/file_library_ooo.scp	29 Aug 2005 09:46:58 -0000	1.136.14.1
@@ -571,6 +571,18 @@ File gid_File_Lib_Evoab_1
     Name = STRING(CONCAT2(libevoab1,UNXSUFFIX));
 End
 
+#ifdef ENABLE_KDE
+
+File gid_File_Lib_Kab_1
+    TXT_FILE_BODY;
+    Styles = (PACKED,UNO_COMPONENT);
+    RegistryID = gid_Starregistry_Services_Rdb;
+    Dir = gid_Dir_Program;
+    Name = STRING(CONCAT2(libkab1,UNXSUFFIX));
+End
+
+#endif
+
 #endif
 
 #ifdef ENABLE_EVOAB2
Index: scp2/source/ooo/module_hidden_ooo.scp
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/module_hidden_ooo.scp,v
retrieving revision 1.21
retrieving revision 1.21.48.1
diff -u -p -u -p -r1.21 -r1.21.48.1
--- scp2/source/ooo/module_hidden_ooo.scp	20 Jul 2005 10:27:24 -0000	1.21
+++ scp2/source/ooo/module_hidden_ooo.scp	29 Aug 2005 09:46:58 -0000	1.21.48.1
@@ -327,6 +327,7 @@ Module gid_Module_Root_Files_5
 	gid_File_Lib_Embobj,
 	gid_File_Lib_Emboleobj,
 	gid_File_Lib_Evoab_1,
+	gid_File_Lib_Kab_1,
 	gid_File_Lib_Evtatt,
 	gid_File_Lib_Fileacc,
 	gid_File_Lib_Filterconfig1,
Index: extensions/source/abpilot/abpresid.hrc
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/abpresid.hrc,v
retrieving revision 1.7
retrieving revision 1.7.170.1
diff -u -p -u -p -r1.7 -r1.7.170.1
--- extensions/source/abpilot/abpresid.hrc	16 Nov 2004 11:57:20 -0000	1.7
+++ extensions/source/abpilot/abpresid.hrc	29 Aug 2005 08:55:12 -0000	1.7.170.1
@@ -194,10 +194,11 @@
 #define RB_MORK				1
 #define RB_THUNDERBIRD          2
 #define RB_EVOLUTION			3
-#define RB_LDAP				4
-#define RB_OUTLOOK				5
-#define RB_OUTLOOKEXPRESS		6
-#define RB_OTHER				7
+#define RB_KAB					4
+#define RB_LDAP				5
+#define RB_OUTLOOK				6
+#define RB_OUTLOOKEXPRESS		7
+#define RB_OTHER				8
 
 //........................................................................
 #define ET_DATASOURCENAME		1
Index: extensions/source/abpilot/abspilot.cxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/abspilot.cxx,v
retrieving revision 1.10
retrieving revision 1.10.142.1
diff -u -p -u -p -r1.10 -r1.10.142.1
--- extensions/source/abpilot/abspilot.cxx	21 Jan 2005 17:24:40 -0000	1.10
+++ extensions/source/abpilot/abspilot.cxx	29 Aug 2005 08:55:12 -0000	1.10.142.1
@@ -427,6 +427,10 @@ namespace abp
 				m_aNewDataSource = aContext.createNewEvolution( m_aSettings.sDataSourceName );
 				break;
 
+			case AST_KAB:
+				m_aNewDataSource = aContext.createNewKab( m_aSettings.sDataSourceName );
+				break;
+
 			case AST_LDAP:
 				m_aNewDataSource = aContext.createNewLDAP( m_aSettings.sDataSourceName );
 				break;
Index: extensions/source/abpilot/abspilot.src
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/abspilot.src,v
retrieving revision 1.49
retrieving revision 1.49.220.1
diff -u -p -u -p -r1.49 -r1.49.220.1
--- extensions/source/abpilot/abspilot.src	2 Aug 2004 17:35:10 -0000	1.49
+++ extensions/source/abpilot/abspilot.src	29 Aug 2005 08:55:13 -0000	1.49.220.1
@@ -165,9 +165,17 @@ TabPage RID_PAGE_SELECTABTYPE
		Text [ de ] = "Evolution";
		Text [ en-US ] = "Evolution";
	};
+	RadioButton RB_KAB
+ 	{
+ 		Pos		= MAP_APPFONT ( 15, 101 ) ;
+ 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
+
+		Text [ de ] = "KDE Adressbuch";
+		Text [ en-US ] = "KDE address book";
+	};
 	RadioButton RB_LDAP
 	{
-		Pos		= MAP_APPFONT ( 15, 101 ) ;
+		Pos		= MAP_APPFONT ( 15, 111 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "LDAP Adress-Bestand";
@@ -175,7 +183,7 @@ TabPage RID_PAGE_SELECTABTYPE
 	};
 	RadioButton RB_OUTLOOK
 	{
-		Pos		= MAP_APPFONT ( 15, 111 ) ;
+		Pos		= MAP_APPFONT ( 15, 123 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "Outlook Adressbuch";
@@ -183,7 +191,7 @@ TabPage RID_PAGE_SELECTABTYPE
 	};
 	RadioButton RB_OUTLOOKEXPRESS
 	{
-		Pos		= MAP_APPFONT ( 15,123 ) ;
+		Pos		= MAP_APPFONT ( 15,134 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "Windows System-Adressbuch";
@@ -191,7 +199,7 @@ TabPage RID_PAGE_SELECTABTYPE
 	};
 	RadioButton RB_OTHER
 	{
-		Pos		= MAP_APPFONT ( 15, 134 ) ;
+		Pos		= MAP_APPFONT ( 15, 145 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "andere externe Datenquelle";
Index: extensions/source/abpilot/addresssettings.hxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/addresssettings.hxx,v
retrieving revision 1.4
retrieving revision 1.4.220.1
diff -u -p -u -p -r1.4 -r1.4.220.1
--- extensions/source/abpilot/addresssettings.hxx	2 Aug 2004 17:35:26 -0000	1.4
+++ extensions/source/abpilot/addresssettings.hxx	29 Aug 2005 08:55:13 -0000	1.4.220.1
@@ -81,6 +81,7 @@ namespace abp
 	{
 		AST_MORK,
 		AST_EVOLUTION,
+		AST_KAB,
 		AST_LDAP,
 		AST_OUTLOOK,
 		AST_OE,
Index: extensions/source/abpilot/datasourcehandling.cxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/datasourcehandling.cxx,v
retrieving revision 1.6
retrieving revision 1.6.100.1
diff -u -p -u -p -r1.6 -r1.6.100.1
--- extensions/source/abpilot/datasourcehandling.cxx	23 Mar 2005 14:53:30 -0000	1.6
+++ extensions/source/abpilot/datasourcehandling.cxx	29 Aug 2005 08:55:13 -0000	1.6.100.1
@@ -356,6 +356,12 @@ namespace abp
 	}
 
 	//---------------------------------------------------------------------
+	ODataSource	ODataSourceContext::createNewKab( const ::rtl::OUString& _rName) SAL_THROW (( ))
+	{
+		return lcl_implCreateAndSetURL( m_pImpl->xORB, _rName, "sdbc:address:kab" );
+	}
+
+	//---------------------------------------------------------------------
 	ODataSource	ODataSourceContext::createNewOutlook( const ::rtl::OUString& _rName) SAL_THROW (( ))
 	{
 		return lcl_implCreateAndSetURL( m_pImpl->xORB, _rName, "sdbc:address:outlook" );
Index: extensions/source/abpilot/datasourcehandling.hxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/datasourcehandling.hxx,v
retrieving revision 1.4
retrieving revision 1.4.220.1
diff -u -p -u -p -r1.4 -r1.4.220.1
--- extensions/source/abpilot/datasourcehandling.hxx	2 Aug 2004 17:36:51 -0000	1.4
+++ extensions/source/abpilot/datasourcehandling.hxx	29 Aug 2005 08:55:14 -0000	1.4.220.1
@@ -115,6 +115,9 @@ namespace abp
 		/// creates a new Evolution data source
 		ODataSource createNewEvolution( const ::rtl::OUString& _rName ) SAL_THROW (( ));
 
+		/// creates a new KDE address book data source
+		ODataSource createNewKab( const ::rtl::OUString& _rName ) SAL_THROW (( ));
+
 		/// creates a new LDAP data source
 		ODataSource	createNewLDAP( const ::rtl::OUString& _rName ) SAL_THROW (( ));
 
Index: extensions/source/abpilot/typeselectionpage.cxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/typeselectionpage.cxx,v
retrieving revision 1.6
retrieving revision 1.6.220.1
diff -u -p -u -p -r1.6 -r1.6.220.1
--- extensions/source/abpilot/typeselectionpage.cxx	2 Aug 2004 17:37:33 -0000	1.6
+++ extensions/source/abpilot/typeselectionpage.cxx	29 Aug 2005 08:55:14 -0000	1.6.220.1
@@ -91,6 +91,7 @@ namespace abp
 		,m_aTypeSep			(this,	ResId(FL_TYPE))
 		,m_aMORK			(this,	ResId(RB_MORK))
 		,m_aEvolution		(this,	ResId(RB_EVOLUTION))
+		,m_aKab				(this,	ResId(RB_KAB))
 		,m_aLDAP			(this,	ResId(RB_LDAP))
 		,m_aOutlook			(this,	ResId(RB_OUTLOOK))
 		,m_aOE				(this,	ResId(RB_OUTLOOKEXPRESS))
@@ -101,6 +102,7 @@ namespace abp
 		Link aTypeSelectionHandler = LINK(this, TypeSelectionPage, OnTypeSelected );
 		m_aMORK.SetClickHdl( aTypeSelectionHandler );
 		m_aEvolution.SetClickHdl( aTypeSelectionHandler );
+		m_aKab.SetClickHdl( aTypeSelectionHandler );
 		m_aLDAP.SetClickHdl( aTypeSelectionHandler );
 		m_aOutlook.SetClickHdl( aTypeSelectionHandler );
 		m_aOE.SetClickHdl( aTypeSelectionHandler );
@@ -109,6 +111,7 @@ namespace abp
 #ifndef UNX
 		sal_Int32 nMoveControlsUp = m_aLDAP.GetPosPixel().Y() - m_aEvolution.GetPosPixel().Y();
 		m_aEvolution.Hide();
+		m_aKab.Hide();
 
 		Point aPos = m_aLDAP.GetPosPixel();
 		aPos.Y() -= nMoveControlsUp;
@@ -143,6 +146,7 @@ namespace abp
 		{
 			nMoveControlsUp = m_aLDAP.GetPosPixel().Y() - m_aEvolution.GetPosPixel().Y();
 			m_aEvolution.Hide();
+			m_aKab.Hide();
 			
 			aPos = m_aLDAP.GetPosPixel();
 			aPos.Y() -= nMoveControlsUp;
@@ -164,7 +168,7 @@ namespace abp
		AddressBookSourcePage::ActivatePage();

        RadioButton* pOptions[] = {
-            &m_aMORK, &m_aThunderbird, &m_aEvolution, &m_aLDAP, &m_aOutlook, &m_aOE, &m_aOther, NULL
+            &m_aMORK, &m_aThunderbird, &m_aEvolution, &m_aKab, &m_aLDAP, &m_aOutlook, &m_aOE, &m_aOther, NULL
        };
        for ( RadioButton** pCheck = pOptions; *pCheck; ++pCheck )
            if ( (*pCheck)->IsChecked() )
@@ -188,6 +194,7 @@ namespace abp
 	{
 		m_aMORK.Check(AST_MORK == _eType);
 		m_aEvolution.Check(AST_EVOLUTION == _eType);
+		m_aKab.Check(AST_KAB == _eType);
 		m_aLDAP.Check(AST_LDAP == _eType);
 		m_aOutlook.Check(AST_OUTLOOK == _eType);
 		m_aOE.Check(AST_OE == _eType);
@@ -201,6 +208,8 @@ namespace abp
 			return AST_MORK;
 		else if (m_aEvolution.IsChecked())
 			return AST_EVOLUTION;
+		else if (m_aKab.IsChecked())
+			return AST_KAB;
 		else if (m_aLDAP.IsChecked())
 			return AST_LDAP;
 		else if (m_aOutlook.IsChecked())
Index: extensions/source/abpilot/typeselectionpage.hxx
===================================================================
RCS file: /cvs/util/extensions/source/abpilot/typeselectionpage.hxx,v
retrieving revision 1.5
retrieving revision 1.5.272.1
diff -u -p -u -p -r1.5 -r1.5.272.1
--- extensions/source/abpilot/typeselectionpage.hxx	19 May 2004 13:38:39 -0000	1.5
+++ extensions/source/abpilot/typeselectionpage.hxx	29 Aug 2005 08:55:14 -0000	1.5.272.1
@@ -87,6 +87,7 @@ namespace abp
 		FixedLine		m_aTypeSep;
 		RadioButton		m_aMORK;
 		RadioButton		m_aEvolution;
+		RadioButton		m_aKab;
 		RadioButton		m_aLDAP;
 		RadioButton		m_aOutlook;
 		RadioButton		m_aOE;
