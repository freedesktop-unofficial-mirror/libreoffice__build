Index: config_office/configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.112
retrieving revision 1.112.2.1
diff -u -u -r1.112 -r1.112.2.1
--- config_office/configure.in	30 Mar 2005 11:38:08 -0000	1.112
+++ config_office/configure.in	31 Mar 2005 08:28:16 -0000	1.112.2.1
@@ -189,9 +189,13 @@
 #AC_ARG_WITH(system-icu,
 #[  --with-system-icu       Use icu already on system
 #],,)
-#AC_ARG_WITH(system-db3,
-#[  --with-system-db3       Use berkley ver 3 db already on system
-#],,)
+AC_ARG_WITH(system-db,
+[  --with-system-db       Use berkeley db already on system
+],,)
+AC_ARG_WITH(db-jar,
+[  --with-db-jar=JARFILE          Specify path to jarfile manually ],
+[ DB_JAR="$withval"
+])
 AC_ARG_WITH(system-sablot,
 [  --with-system-sablot    Use sablot already on system
 ],,)
@@ -2326,23 +2330,81 @@
 AC_SUBST(PYTHON_CFLAGS)
 AC_SUBST(PYTHON_LIBS)
 
-# DISABLED; DOESN'T WORK, WE'LL NEED DB 4.1/4.2
 dnl ===================================================================
 dnl Check for system berkley db
 dnl ===================================================================
-#AC_MSG_CHECKING([which db to use])
-#if test -n "$with_system_db3" -o -n "$with_system_libs" && \
-#	test "$with_system_db3" != "no"; then
-#    SYSTEM_DB3=YES
-#    AC_MSG_RESULT([external])
-#    AC_LANG(C++)
-#    AC_CHECK_HEADER(db3/db_cxx.h, [],
-#                    [AC_MSG_ERROR([db3/db_cxx.h could not be found. install devel db3 libraries])], [])
-#else
-#    AC_MSG_RESULT([internal])
-#    SYSTEM_DB3=NO
-#fi
-#AC_SUBST(SYSTEM_DB3)
+AC_MSG_CHECKING([which db to use])
+if test -n "$with_system_db" -o -n "$with_system_libs" && \
+	test "$with_system_db" != "no"; then
+    SYSTEM_DB=YES
+    AC_MSG_RESULT([external])
+    AC_CHECK_HEADER(db.h, [ DB_INCLUDES=/usr/include ],
+        [
+             CFLAGS=-I/usr/include/db4
+             AC_CHECK_HEADER(db4/db.h,
+             [ DB_INCLUDES=/usr/include/db4 ],
+             [ AC_MSG_ERROR(no. install the db4 libraries) ], []+             )
+        ], []
+    )
+    AC_MSG_CHECKING([whether db is at least 4.1])
+    # FIXME: Will db 4.3 work? Can't test it since the 4.3 java bindings are not packaged :/
+    for v in 1 2; do
+       AC_TRY_RUN([
+#include <db.h>
+
+int main(int argc, char **argv) {
+       if(DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR == $v) return 0;
+       else return 1;
+}
+       ], [DB_VERSION_MINOR=$v], [])
+    done
+    if test "$DB_VERSION_MINOR" -gt "1"; then
+       AC_MSG_RESULT([OK])
+       DB_VERSION=4.$DB_VERSION_MINOR
+    else
+       AC_MSG_RESULT([no. you need at least db 4.1])
+    fi
+    # does not work :/
+    #AC_CHECK_LIB(db, db_create, [],
+    #  [AC_MSG_ERROR([db library not installed or functional])], [])
+    AC_HAVE_LIBRARY(db, [],
+      [AC_MSG_ERROR([db not installed or functional])], [])
+     if test "$SOLAR_JAVA" = "TRUE"; then
+       if test -z $DB_JAR; then
+         # three different naming methods *grumble* Are there even more?
+         AC_CHECK_FILE(/usr/share/java/db.jar, [ JARVER=0 ],
+           [
+             AC_CHECK_FILE(/usr/share/java/db-$DB_VERSION.jar, [ JARVER=1 ],
+               [ AC_CHECK_FILE(/usr/share/java/libdb$DB_VERSION-java.jar,
+                   [ JARVER_LONGSTYLE=1 ],
+                   [ AC_MSG_ERROR(db$DB_VERSION_MAJOR Java bindings not found)]
+                 )
+               ]
+             )
+           ]
+         )
+         if test "$JARVER" = "1"; then
+           DB_JAR=/usr/share/java/jar-$DB_VERSION.jar
+         else
+           DB_JAR=/usr/share/java/db.jar
+         fi
+         if test "$JARVER_LONGSTYLE" = "1"; then
+           DB_JAR=/usr/share/java/libdb$DB_VERSION-java.jar
+         fi
+	  if test -z "$DB_JAR"; then
+	    AC_MSG_ERROR([libdb $DB_VERSION jar not found. Install it or specify path with --with-db-jar=/path/to/jar])
+	  fi
+       fi
+    fi
+    SCPDEFS="$SCPDEFS -DSYSTEM_DB"
+else
+    AC_MSG_RESULT([internal])
+    SYSTEM_DB=NO
+fi
+AC_SUBST(SYSTEM_DB)
+AC_SUBST(DB_VERSION)
+AC_SUBST(DB_INCLUDES)
+AC_SUBST(DB_JAR)
 
 dnl ===================================================================
 dnl Check for system sablot
Index: config_office/set_soenv.in
===================================================================
RCS file: /cvs/tools/config_office/set_soenv.in,v
retrieving revision 1.55
retrieving revision 1.55.2.1
diff -u -u -r1.55 -r1.55.2.1
--- config_office/set_soenv.in	30 Mar 2005 11:38:22 -0000	1.55
+++ config_office/set_soenv.in	31 Mar 2005 08:28:18 -0000	1.55.2.1
@@ -1700,7 +1700,10 @@
 ToFile( "LIBXML_CFLAGS",     "@LIBXML_CFLAGS@",    "e" );
 ToFile( "LIBXML_LIBS",       "@LIBXML_LIBS@",      "e" );
 ToFile( "SYSTEM_EXPAT",      "@SYSTEM_EXPAT@",     "e" );
-#ToFile( "SYSTEM_DB3",        "@SYSTEM_DB3@",       "e" );
+ToFile( "SYSTEM_DB",         "@SYSTEM_DB@",        "e" );
+ToFile( "DB_VERSION",        "@DB_VERSION@",       "e" );
+ToFile( "DB_INCLUDES",       "@DB_INCLUDES@",      "e" );
+ToFile( "DB_JAR",            "@DB_JAR@",           "e" );
 ToFile( "SYSTEM_SABLOT",     "@SYSTEM_SABLOT@",    "e" );
 ToFile( "SABLOT_LIBS",       "@SABLOT_LIBS@",      "e" );
 ToFile( "SYSTEM_ODBC_HEADERS","@SYSTEM_ODBC_HEADERS@","e" );
Index: scp2/source/ooo/file_library_ooo.scp
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/file_library_ooo.scp,v
retrieving revision 1.96
retrieving revision 1.96.2.1
diff -u -u -r1.96 -r1.96.2.1
--- scp2/source/ooo/file_library_ooo.scp	30 Mar 2005 11:40:14 -0000	1.96
+++ scp2/source/ooo/file_library_ooo.scp	31 Mar 2005 08:28:25 -0000	1.96.2.1
@@ -429,9 +429,9 @@
 
 #endif
 
-#ifndef SYSTEM_DB3
+#ifndef SYSTEM_DB
 
-File gid_File_Lib_Db31
+File gid_File_Lib_Db
     TXT_FILE_BODY;
     Styles = (PACKED);
     Dir = gid_Dir_Program;
@@ -462,8 +462,9 @@
 STD_LIB_FILE( gid_File_Lib_Dbfile , file)
 
 #ifdef SOLAR_JAVA
+#ifndef SYSTEM_DB
 
-File gid_File_Lib_Dbjava31
+File gid_File_Lib_Dbjava
     TXT_FILE_BODY;
     Styles = (PACKED);
     Dir = gid_Dir_Program;
@@ -474,6 +475,7 @@
   #endif
 End
 
+#endif
 #endif
 
 File gid_File_Lib_Dbodbcbase
Index: scp2/source/ooo/makefile.mk
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/makefile.mk,v
retrieving revision 1.28
retrieving revision 1.28.2.1
diff -u -u -r1.28 -r1.28.2.1
--- scp2/source/ooo/makefile.mk	30 Mar 2005 11:40:55 -0000	1.28
+++ scp2/source/ooo/makefile.mk	31 Mar 2005 08:28:26 -0000	1.28.2.1
@@ -110,8 +110,8 @@
 SCPDEFS+=-DSYSTEM_LIBXML
 .ENDIF
 
-.IF "$(SYSTEM_DB3)" == "YES"
-SCPDEFS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+SCPDEFS+=-DSYSTEM_DB
 .ENDIF
 
 .IF "$(USE_SYSTEM_STL)" == "YES"
Index: scp2/source/ooo/module_hidden_ooo.scp
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/module_hidden_ooo.scp,v
retrieving revision 1.5
retrieving revision 1.5.2.1
diff -u -u -r1.5 -r1.5.2.1
--- scp2/source/ooo/module_hidden_ooo.scp	30 Mar 2005 11:41:08 -0000	1.5
+++ scp2/source/ooo/module_hidden_ooo.scp	31 Mar 2005 08:28:26 -0000	1.5.2.1
@@ -98,13 +98,13 @@
 	gid_File_Lib_Ctl,
 	gid_File_Lib_Cui,
 	gid_File_Lib_Curl,
-	gid_File_Lib_Db31,
+	gid_File_Lib_Db,
 	gid_File_Lib_Db_Cxx,
 	gid_File_Lib_Dba,
 	gid_File_Lib_Dbacfg,
 	gid_File_Lib_Dbase2,
 	gid_File_Lib_Dbfile,
-	gid_File_Lib_Dbjava31,
+	gid_File_Lib_Dbjava,
 	gid_File_Lib_Dbodbcbase,
 	gid_File_Lib_Dbp,
 	gid_File_Lib_Dbpool,
Index: solenv/inc/libs.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/libs.mk,v
retrieving revision 1.87
retrieving revision 1.87.2.1
diff -u -u -r1.87 -r1.87.2.1
--- solenv/inc/libs.mk	30 Mar 2005 08:36:11 -0000	1.87
+++ solenv/inc/libs.mk	31 Mar 2005 08:28:27 -0000	1.87.2.1
@@ -208,8 +208,13 @@
 JPEG3RDLIB=-ljpeglib
 .ENDIF
 NEON3RDLIB=-lneon
+.IF "$(SYSTEM_DB)" == "YES"
+BERKELEYLIB=-ldb
+BERKELEYCPPLIB=-ldb_cxx
+.ELSE
 BERKELEYLIB=-ldb-4.2
 BERKELEYCPPLIB=-ldb_cxx-4.2
+.ENDIF
 CURLLIB=-lcurl
 SFX2LIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
 SFXLIB=-lsfx$(OFFICEUPD)$(DLLPOSTFIX)
Index: xmlhelp/source/com/sun/star/help/makefile.mk
===================================================================
RCS file: /cvs/util/xmlhelp/source/com/sun/star/help/makefile.mk,v
retrieving revision 1.19
retrieving revision 1.19.24.2
diff -u -u -r1.19 -r1.19.24.2
--- xmlhelp/source/com/sun/star/help/makefile.mk	25 Jan 2005 15:29:28 -0000	1.19
+++ xmlhelp/source/com/sun/star/help/makefile.mk	7 Apr 2005 14:38:03 -0000	1.19.24.2
@@ -22,8 +22,14 @@
 
 .INCLUDE : settings.mk
 
-JARFILES 		= jaxp.jar parser.jar xt.jar unoil.jar ridl.jar jurt.jar jut.jar xmlsearch.jar db.jar
+JARFILES 		= jaxp.jar parser.jar xt.jar unoil.jar ridl.jar jurt.jar jut.jar xmlsearch.jar
 EXTRAJARFILES 	= 
+
+.IF "$(SYSTEM_DB)" == "YES"
+XCLASSPATH!:=$(XCLASSPATH)$(PATH_SEPERATOR)$(DB_JAR)
+.ELSE
+JARFILES+= db.jar
+.ENDIF
 
 CLASSGENDIR		= $(OUT)$/classgen
 RDB		 		= $(SOLARBINDIR)$/types.rdb
Index: xmlhelp/source/cxxhelp/provider/db.hxx
===================================================================
RCS file: /cvs/util/xmlhelp/source/cxxhelp/provider/db.hxx,v
retrieving revision 1.2
retrieving revision 1.2.2.1
diff -u -u -r1.2 -r1.2.2.1
--- xmlhelp/source/cxxhelp/provider/db.hxx	30 Mar 2005 08:38:07 -0000	1.2
+++ xmlhelp/source/cxxhelp/provider/db.hxx	31 Mar 2005 08:28:27 -0000	1.2.2.1
@@ -61,7 +61,11 @@
 #ifndef BERKELEYDBPROXY_DB_HXX_
 #define BERKELEYDBPROXY_DB_HXX_
 
+#ifdef SYSTEM_DB
+#include <db.h>
+#else
 #include <berkeleydb/db.h>
+#endif
 
 #include <rtl/string.hxx>
 
Index: xmlhelp/source/cxxhelp/provider/makefile.mk
===================================================================
RCS file: /cvs/util/xmlhelp/source/cxxhelp/provider/makefile.mk,v
retrieving revision 1.15
retrieving revision 1.15.2.1
diff -u -u -r1.15 -r1.15.2.1
--- xmlhelp/source/cxxhelp/provider/makefile.mk	30 Mar 2005 08:38:21 -0000	1.15
+++ xmlhelp/source/cxxhelp/provider/makefile.mk	31 Mar 2005 08:28:28 -0000	1.15.2.1
@@ -75,8 +75,8 @@
 
 CFLAGS +=  -DHAVE_EXPAT_H
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+CFLAGS+=-DSYSTEM_DB -I$(DB_INCLUDES)
 .ENDIF
 
 .IF "$(SYSTEM_SABLOT)" == "YES"
Index: desktop/inc/db.hxx
===================================================================
RCS file: /cvs/framework/desktop/inc/db.hxx,v
retrieving revision 1.2
retrieving revision 1.2.2.1
diff -u -u -r1.2 -r1.2.2.1
--- desktop/inc/db.hxx	30 Mar 2005 08:43:24 -0000	1.2
+++ desktop/inc/db.hxx	31 Mar 2005 08:28:19 -0000	1.2.2.1
@@ -61,7 +61,11 @@
 #ifndef BERKELEYDBPROXY_DB_HXX_
 #define BERKELEYDBPROXY_DB_HXX_
 
+#ifdef SYSTEM_DB
+#include <db.h>
+#else
 #include <berkeleydb/db.h>
+#endif
 
 #include <rtl/string.hxx>
 
Index: desktop/source/deployment/manager/makefile.mk
===================================================================
RCS file: /cvs/framework/desktop/source/deployment/manager/makefile.mk,v
retrieving revision 1.5
retrieving revision 1.5.142.1
diff -u -u -r1.5 -r1.5.142.1
--- desktop/source/deployment/manager/makefile.mk	8 Sep 2004 16:48:40 -0000	1.5
+++ desktop/source/deployment/manager/makefile.mk	31 Mar 2005 08:28:20 -0000	1.5.142.1
@@ -68,8 +68,8 @@
 
 .INCLUDE : settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+CFLAGS+=-DSYSTEM_DB -I$(DB_INCLUDES)
 .ENDIF
 
 SRS1NAME = $(TARGET)
Index: desktop/source/deployment/misc/makefile.mk
===================================================================
RCS file: /cvs/framework/desktop/source/deployment/misc/makefile.mk,v
retrieving revision 1.6
retrieving revision 1.6.2.1
diff -u -u -r1.6 -r1.6.2.1
--- desktop/source/deployment/misc/makefile.mk	30 Mar 2005 08:44:35 -0000	1.6
+++ desktop/source/deployment/misc/makefile.mk	31 Mar 2005 08:28:21 -0000	1.6.2.1
@@ -68,8 +68,8 @@
 
 .INCLUDE : settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+CFLAGS+=-DSYSTEM_DB -I$(DB_INCLUDES)
 .ENDIF
 
 SRS1NAME = $(TARGET)
Index: desktop/source/deployment/registry/component/makefile.mk
===================================================================
RCS file: /cvs/framework/desktop/source/deployment/registry/component/makefile.mk,v
retrieving revision 1.4
retrieving revision 1.4.142.1
diff -u -u -r1.4 -r1.4.142.1
--- desktop/source/deployment/registry/component/makefile.mk	8 Sep 2004 16:49:26 -0000	1.4
+++ desktop/source/deployment/registry/component/makefile.mk	31 Mar 2005 08:28:22 -0000	1.4.142.1
@@ -68,10 +68,6 @@
 
 .INCLUDE : settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
-.ENDIF
-
 SRS1NAME = $(TARGET)
 SRC1FILES = \
         dp_component.src
Index: desktop/source/deployment/registry/configuration/makefile.mk
===================================================================
RCS file: /cvs/framework/desktop/source/deployment/registry/configuration/makefile.mk,v
retrieving revision 1.4
retrieving revision 1.4.142.1
diff -u -u -r1.4 -r1.4.142.1
--- desktop/source/deployment/registry/configuration/makefile.mk	8 Sep 2004 16:49:38 -0000	1.4
+++ desktop/source/deployment/registry/configuration/makefile.mk	31 Mar 2005 08:28:23 -0000	1.4.142.1
@@ -68,8 +68,8 @@
 
 .INCLUDE : settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+CFLAGS+=-DSYSTEM_DB -I$(DB_INCLUDES)
 .ENDIF
 
 SRS1NAME = $(TARGET)
Index: desktop/source/pkgchk/makefile.mk
===================================================================
RCS file: /cvs/framework/desktop/source/pkgchk/makefile.mk,v
retrieving revision 1.12
retrieving revision 1.12.2.1
diff -u -u -r1.12 -r1.12.2.1
--- desktop/source/pkgchk/makefile.mk	30 Mar 2005 08:45:03 -0000	1.12
+++ desktop/source/pkgchk/makefile.mk	31 Mar 2005 08:28:24 -0000	1.12.2.1
@@ -71,8 +71,8 @@
 PRJINC += ..$/deployment
 .INCLUDE : settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
-CFLAGS+=-DSYSTEM_DB3
+.IF "$(SYSTEM_DB)" == "YES"
+CFLAGS+=-DSYSTEM_DB -I$(DB_INCLUDES)
 .ENDIF
 
 # INCPRE += ..$/deployment$/inc
Index: helpcontent2/settings.pmk
===================================================================
RCS file: /cvs/documentation/helpcontent2/settings.pmk,v
retrieving revision 1.3
retrieving revision 1.3.34.2
diff -u -u -r1.3 -r1.3.34.2
--- helpcontent2/settings.pmk	16 Dec 2004 12:18:54 -0000	1.3
+++ helpcontent2/settings.pmk	7 Apr 2005 14:35:35 -0000	1.3.34.2
@@ -1,5 +1,11 @@
 
-my_cp=$(CLASSPATH)$(PATH_SEPERATOR)$(SOLARBINDIR)$/jaxp.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/parser.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xt.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/unoil.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/ridl.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/jurt.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/jut.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xmlsearch.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/db.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xmlsearch.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xmlhelp.jar
+my_cp=$(CLASSPATH)$(PATH_SEPERATOR)$(SOLARBINDIR)$/jaxp.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/parser.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xt.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/unoil.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/ridl.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/jurt.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/jut.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xmlsearch.jar$(PATH_SEPERATOR)$(SOLARBINDIR)$/xmlhelp.jar
+
+.IF "$(SYSTEM_DB)" == "YES"
+my_cp:=$(my_cp)$(PATH_SEPERATOR)$(DB_JAR)
+.ELSE
+my_cp:=$(my_cp)$(PATH_SEPERATOR)$(SOLARBINDIR)$/db.jar
+.ENDIF
 
 .INCLUDE : $(INCCOM)$/aux_langs.mk
 
Index: helpcontent2/util/target.pmk
===================================================================
RCS file: /cvs/documentation/helpcontent2/util/target.pmk,v
retrieving revision 1.8
retrieving revision 1.8.18.1
diff -u -u -r1.8 -r1.8.18.1
--- helpcontent2/util/target.pmk	11 Feb 2005 18:24:05 -0000	1.8
+++ helpcontent2/util/target.pmk	31 Mar 2005 08:28:24 -0000	1.8.18.1
@@ -67,7 +67,11 @@
 ALLTAR : $(LINKALLTARGETS)
 .ENDIF
 
+.IF "$(SYSTEM_DB)" != "YES"
+JAVA_LIBRARY_PATH= -Djava.library.path=$(SOLARSHAREDBIN)
+.ENDIF
+
 $(LINKALLTARGETS) : $(foreach,i,$(LINKLINKFILES) $(MISC)$/$$(@:b:s/_/./:e:s/.//)/$i) $(subst,LANGUAGE,$$(@:b:s/_/./:e:s/.//) $(LINKADDEDDEPS)) $(MISC)$/xhp_changed.flag
 	@+-$(MKDIR) -p $(@:d)
-	$(JAVAI) -Djava.library.path=$(SOLARSHAREDBIN) -cp $(my_cp) com.sun.star.help.HelpLinker @$(mktmp -mod $(LINKNAME) -hid $(PRJ)$/helpers/hid.lst -src $(MISC) -sty $(PRJ)$/source$/auxiliary$/embed.xsl -idx $(PRJ)$/source$/auxiliary$/index.xsl -lang {$(subst,$(LINKNAME)_, $(@:b))} $(subst,LANGUAGE,{$(subst,$(LINKNAME)_, $(@:b))} $(LINKADDEDFILES)) $(foreach,i,$(LINKLINKFILES) $(MISC)$/{$(subst,$(LINKNAME)_, $(@:b))}/$i) -o $@)
+	$(JAVAI) $(JAVA_LIBRARY_PATH) -cp $(my_cp) com.sun.star.help.HelpLinker @$(mktmp -mod $(LINKNAME) -hid $(PRJ)$/helpers/hid.lst -src $(MISC) -sty $(PRJ)$/source$/auxiliary$/embed.xsl -idx $(PRJ)$/source$/auxiliary$/index.xsl -lang {$(subst,$(LINKNAME)_, $(@:b))} $(subst,LANGUAGE,{$(subst,$(LINKNAME)_, $(@:b))} $(LINKADDEDFILES)) $(foreach,i,$(LINKLINKFILES) $(MISC)$/{$(subst,$(LINKNAME)_, $(@:b))}/$i) -o $@)
 
Index: berkeleydb/makefile.mk
===================================================================
RCS file: /cvs/external/berkeleydb/makefile.mk,v
retrieving revision 1.19
retrieving revision 1.19.2.2
diff -u -u -r1.19 -r1.19.2.2
--- berkeleydb/makefile.mk	30 Mar 2005 08:33:28 -0000	1.19
+++ berkeleydb/makefile.mk	6 Apr 2005 08:13:03 -0000	1.19.2.2
@@ -69,9 +69,9 @@
 
 .INCLUDE :	settings.mk
 
-.IF "$(SYSTEM_DB3)" == "YES"
+.IF "$(SYSTEM_DB)" == "YES"
 all:
-        @echo "An already available installation of db3 should exist on your system."
+        @echo "An already available installation of db should exist on your system."
 	@echo "Therefore the version provided here does not need to be built in addition."
 .ENDIF
 
