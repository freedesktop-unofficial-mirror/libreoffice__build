--- /dev/null	2006-11-25 20:17:37.000000000 +0800
+++ offapi/com/sun/star/awt/XWindow3.idl	2006-12-14 17:39:39.000000000 +0800
@@ -0,0 +1,82 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_awt_XWindow3_idl__ 
+#define __com_sun_star_awt_XWindow3_idl__ 
+ 
+#ifndef __com_sun_star_awt_XWindow_idl__ 
+#include <com/sun/star/awt/XWindow.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_awt_Size_idl__ 
+#include <com/sun/star/awt/Size.idl> 
+#endif 
+ 
+ 
+ 
+//============================================================================= 
+ 
+ module com {  module sun {  module star {  module awt {  
+ 
+//============================================================================= 
+ 
+/** specifies some extended operations for a window component.
+		
+	<p>A window is a rectangular region on an output device with 
+	its own position, size, and internal coordinate system.
+    A window is used for displaying data. In addition, the window
+    receives events from the user.</p>
+ */
+published interface XWindow3: com::sun::star::awt::XWindow
+{ 
+	//------------------------------------------------------------------------- 
+	 
+	/** returns the visibility state of the window
+	 */
+	boolean isVisible(); 
+ 
+	//------------------------------------------------------------------------- 
+	 
+	/** returns the enabled state of the window
+	 */
+	boolean isEnabled(); 
+ 
+	//------------------------------------------------------------------------- 
+}; 
+ 
+//============================================================================= 
+ 
+}; }; }; };  
+ 
+#endif 
--- toolkit/inc/toolkit/controls/unocontrol.hxx	2006-12-14 17:04:41.000000000 +0800
+++ toolkit/inc/toolkit/controls/unocontrol.hxx	2006-12-14 17:04:46.000000000 +0800
@@ -46,6 +46,9 @@
 #ifndef _COM_SUN_STAR_AWT_XWINDOW_HPP_
 #include <com/sun/star/awt/XWindow.hpp>
 #endif
+#ifndef _COM_SUN_STAR_AWT_XWINDOW3_HPP_
+#include <com/sun/star/awt/XWindow3.hpp>
+#endif
 #ifndef _COM_SUN_STAR_AWT_XView_HPP_
 #include <com/sun/star/awt/XView.hpp>
 #endif
@@ -123,7 +126,7 @@ struct UnoControlComponentInfos
 //	class UnoControl
 //	----------------------------------------------------
 typedef ::cppu::WeakAggImplHelper7	<	::com::sun::star::awt::XControl
-									,	::com::sun::star::awt::XWindow
+									,	::com::sun::star::awt::XWindow3
 									,	::com::sun::star::awt::XView
 									,	::com::sun::star::beans::XPropertiesChangeListener
 									,	::com::sun::star::lang::XServiceInfo
@@ -260,6 +263,9 @@ public:
 private:
 	// ::com::sun::star::beans::XPropertiesChangeListener
     void SAL_CALL propertiesChange( const ::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyChangeEvent >& evt ) throw(::com::sun::star::uno::RuntimeException);
+    //::com::sun::star::awt::XWindow3
+    sal_Bool SAL_CALL isVisible() throw (::com::sun::star::uno::RuntimeException);
+    sal_Bool SAL_CALL isEnabled() throw (::com::sun::star::uno::RuntimeException);
 };
 
 
--- toolkit/source/controls/unocontrol.cxx	2006-12-14 17:05:06.000000000 +0800
+++ toolkit/source/controls/unocontrol.cxx	2006-12-14 17:05:20.000000000 +0800
@@ -1286,3 +1286,13 @@ void SAL_CALL UnoControl::removeModeChan
 	throw NoSupportException( );
 }
 
+//XWindow3
+sal_Bool SAL_CALL UnoControl::isVisible() throw (::com::sun::star::uno::RuntimeException)
+{
+    return maComponentInfos.bVisible;
+}
+
+sal_Bool SAL_CALL UnoControl::isEnabled() throw (::com::sun::star::uno::RuntimeException)
+{
+    return maComponentInfos.bEnable;
+}
