diff -uNpr xmloff.bk/inc/PageMasterImportContext.hxx xmloff/inc/PageMasterImportContext.hxx
--- xmloff.bk/inc/PageMasterImportContext.hxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/inc/PageMasterImportContext.hxx	2008-02-19 15:20:49.000000000 +0800
@@ -60,7 +60,8 @@ public:
 	PageStyleContext( SvXMLImport& rImport, sal_uInt16 nPrfx,
 			const ::rtl::OUString& rLName,
 			const ::com::sun::star::uno::Reference< ::com::sun::star::xml::sax::XAttributeList > & xAttrList,
-			SvXMLStylesContext& rStyles);
+			SvXMLStylesContext& rStyles,
+			sal_Bool bDefaultStyle=sal_False);
 	virtual ~PageStyleContext();
 
 	virtual SvXMLImportContext *CreateChildContext(
@@ -71,6 +72,9 @@ public:
 	virtual void FillPropertySet(
 			const ::com::sun::star::uno::Reference<
 				::com::sun::star::beans::XPropertySet > & rPropSet );
+
+	//text grid enhancement
+	virtual void SetDefaults();
 };
 
 #endif
diff -uNpr xmloff.bk/inc/xmloff/PageMasterStyleMap.hxx xmloff/inc/xmloff/PageMasterStyleMap.hxx
--- xmloff.bk/inc/xmloff/PageMasterStyleMap.hxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/inc/xmloff/PageMasterStyleMap.hxx	2008-02-19 15:20:49.000000000 +0800
@@ -107,6 +107,9 @@
 #define CTF_PM_SCALETOPAGES				(XML_PM_CTF_START + 0x0052)
 #define CTF_PM_SCALETOX                 (XML_PM_CTF_START + 0x0053)
 #define CTF_PM_SCALETOY                 (XML_PM_CTF_START + 0x0054)
+#define CTF_PM_STANDARD_MODE            (XML_PM_CTF_START + 0x0055)
+#define CTP_PM_GRID_BASE_WIDTH          (XML_PM_CTF_START + 0x0056)
+#define CTP_PM_GRID_SNAP_TO_CHARS       (XML_PM_CTF_START + 0x0057)
 // header
 #define CTF_PM_HEADERBORDERALL			(CTF_PM_HEADERFLAG|CTF_PM_BORDERALL)
 #define CTF_PM_HEADERBORDERTOP			(CTF_PM_HEADERFLAG|CTF_PM_BORDERTOP)
diff -uNpr xmloff.bk/inc/xmloff/XMLPageExport.hxx xmloff/inc/xmloff/XMLPageExport.hxx
--- xmloff.bk/inc/xmloff/XMLPageExport.hxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/inc/xmloff/XMLPageExport.hxx	2008-02-19 15:20:49.000000000 +0800
@@ -130,6 +130,9 @@ public:
 	void	collectAutoStyles( sal_Bool bUsed )		{ exportStyles( bUsed, sal_True ); }
 	void	exportAutoStyles();
 	void	exportMasterStyles( sal_Bool bUsed )	{ exportStyles( bUsed, sal_False ); }
+
+	//text grid enhancement for better CJK support
+	void exportDefaultStyle();
 };
 
 #endif	//  _XMLOFF_XMLTEXTMASTERPAGEEXPORT_HXX
diff -uNpr xmloff.bk/inc/xmloff/xmlstyle.hxx xmloff/inc/xmloff/xmlstyle.hxx
--- xmloff.bk/inc/xmloff/xmlstyle.hxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/inc/xmloff/xmlstyle.hxx	2008-02-19 15:20:49.000000000 +0800
@@ -91,6 +91,7 @@ enum XMLStyleStylesElemTokens
 	XML_TOK_TEXT_BIBLIOGRAPHY_CONFIG,
 	XML_TOK_TEXT_LINENUMBERING_CONFIG,
 	XML_TOK_STYLE_DEFAULT_STYLE,
+	XML_TOK_STYLE_DEFAULT_PAGE_LAYOUT,	//text grid enhancement
 	XML_TOK_STYLE_STYLES_ELEM_END=XML_TOK_UNKNOWN
 };
 
diff -uNpr xmloff.bk/inc/xmloff/xmltoken.hxx xmloff/inc/xmloff/xmltoken.hxx
--- xmloff.bk/inc/xmloff/xmltoken.hxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/inc/xmloff/xmltoken.hxx	2008-02-19 15:20:49.000000000 +0800
@@ -2081,6 +2081,12 @@ namespace xmloff { namespace token {
         XML_LAYOUT_GRID_PRINT,
         XML_LAYOUT_GRID_DISPLAY,
 
+		//text grid enhancement for better CJK support
+		XML_DEFAULT_PAGE_LAYOUT,
+		XML_LAYOUT_GRID_STANDARD_MODE,
+		XML_LAYOUT_GRID_BASE_WIDTH,
+		XML_LAYOUT_GRID_SNAP_TO_CHARS,
+
         XML_SNAP_TO_LAYOUT_GRID,
         XML_DONT_BALANCE_TEXT_COLUMNS,
 
diff -uNpr xmloff.bk/source/core/xmltoken.cxx xmloff/source/core/xmltoken.cxx
--- xmloff.bk/source/core/xmltoken.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/core/xmltoken.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -2091,6 +2091,12 @@ namespace xmloff { namespace token {
         TOKEN( "layout-grid-print",               XML_LAYOUT_GRID_PRINT ),
         TOKEN( "layout-grid-display",             XML_LAYOUT_GRID_DISPLAY ),
 
+		//text grid enhancement for better CJK support
+        TOKEN( "default-page-layout",             XML_DEFAULT_PAGE_LAYOUT ),
+        TOKEN( "layout-grid-standard-mode",       XML_LAYOUT_GRID_STANDARD_MODE ),
+        TOKEN( "layout-grid-base-width",          XML_LAYOUT_GRID_BASE_WIDTH ),
+        TOKEN( "layout-grid-snap-to-characters",       XML_LAYOUT_GRID_SNAP_TO_CHARS ),
+
         TOKEN( "snap-to-layout-grid",             XML_SNAP_TO_LAYOUT_GRID ),
 
         TOKEN( "dont-balance-text-columns",       XML_DONT_BALANCE_TEXT_COLUMNS ),
diff -uNpr xmloff.bk/source/style/PageMasterExportPropMapper.cxx xmloff/source/style/PageMasterExportPropMapper.cxx
--- xmloff.bk/source/style/PageMasterExportPropMapper.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/style/PageMasterExportPropMapper.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -348,6 +348,9 @@ void XMLPageMasterExportPropMapper::Cont
 	XMLPropertyState*		pPMScaleToPages		= NULL;
 	XMLPropertyState*		pPMScaleToX 		= NULL;
 	XMLPropertyState*		pPMScaleToY	    	= NULL;
+	XMLPropertyState*		pPMStandardMode    	= NULL;
+	XMLPropertyState*		pPMGridBaseWidth   	= NULL;
+	XMLPropertyState*		pPMGridSnapToChars 	= NULL;
 
     XMLPropertyState*       pPrint              = NULL;
 
@@ -400,6 +403,9 @@ void XMLPageMasterExportPropMapper::Cont
 			case CTF_PM_SCALETOPAGES:		pPMScaleToPages		= pProp;	break;
             case CTF_PM_SCALETOX:   		pPMScaleToX 		= pProp;	break;
             case CTF_PM_SCALETOY:   		pPMScaleToY 		= pProp;	break;
+            case CTF_PM_STANDARD_MODE:		pPMStandardMode		= pProp;	break;
+            case CTP_PM_GRID_BASE_WIDTH:		pPMGridBaseWidth	= pProp;	break;
+            case CTP_PM_GRID_SNAP_TO_CHARS:		pPMGridSnapToChars	= pProp;	break;
 		}
         if (nPrintId == CTF_PM_PRINTMASK)
         {
@@ -408,6 +414,18 @@ void XMLPageMasterExportPropMapper::Cont
         }
 	}
 
+	if( pPMStandardMode && !getBOOL(pPMStandardMode->maValue) )
+	{
+		lcl_RemoveState(pPMStandardMode);
+		if( pPMGridBaseWidth )
+			lcl_RemoveState(pPMGridBaseWidth);
+		if( pPMGridSnapToChars )
+			lcl_RemoveState(pPMGridSnapToChars);
+	}
+
+	if( pPMGridBaseWidth && pPMStandardMode )
+		lcl_RemoveState(pPMStandardMode);	
+	
 	aPageBuffer.ContextFilter( rPropState );
 	aHeaderBuffer.ContextFilter( rPropState );
 	aFooterBuffer.ContextFilter( rPropState );
diff -uNpr xmloff.bk/source/style/PageMasterImportContext.cxx xmloff/source/style/PageMasterImportContext.cxx
--- xmloff.bk/source/style/PageMasterImportContext.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/style/PageMasterImportContext.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -67,8 +67,14 @@
 #include <xmloff/PageMasterStyleMap.hxx>
 #endif
 
+#ifndef _COM_SUN_STAR_LANG_XMULTISERVICEFACTORY_HPP_
+#include <com/sun/star/lang/XMultiServiceFactory.hpp>
+#endif
+
 using namespace ::com::sun::star;
 using namespace ::xmloff::token;
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::lang;
 
 void PageStyleContext::SetAttribute( sal_uInt16 nPrefixKey,
                                         const rtl::OUString& rLocalName,
@@ -90,8 +96,9 @@ TYPEINIT1( PageStyleContext, XMLPropStyl
 PageStyleContext::PageStyleContext( SvXMLImport& rImport,
         sal_uInt16 nPrfx, const rtl::OUString& rLName,
         const uno::Reference< xml::sax::XAttributeList > & xAttrList,
-        SvXMLStylesContext& rStyles) :
-    XMLPropStyleContext( rImport, nPrfx, rLName, xAttrList, rStyles, XML_STYLE_FAMILY_PAGE_MASTER ),
+        SvXMLStylesContext& rStyles,
+        sal_Bool bDefaultStyle) :
+    XMLPropStyleContext( rImport, nPrfx, rLName, xAttrList, rStyles, XML_STYLE_FAMILY_PAGE_MASTER, bDefaultStyle),
     sPageUsage()
 {
 }
@@ -202,3 +209,18 @@ void PageStyleContext::FillPropertySet(
     }
 }
 
+// text grid enhancement for better CJK support
+//set default page layout style
+void PageStyleContext::SetDefaults( )
+{
+	Reference < XMultiServiceFactory > xFactory ( GetImport().GetModel(), UNO_QUERY);
+	if (xFactory.is())
+	{
+		Reference < XInterface > xInt = xFactory->createInstance (
+	    rtl::OUString ( RTL_CONSTASCII_USTRINGPARAM ( "com.sun.star.text.Defaults" ) ) );
+	    Reference < beans::XPropertySet > xProperties ( xInt, UNO_QUERY );
+	    if ( xProperties.is() )
+	    	FillPropertySet ( xProperties );
+	}
+}
+
diff -uNpr xmloff.bk/source/style/PageMasterStyleMap.cxx xmloff/source/style/PageMasterStyleMap.cxx
--- xmloff.bk/source/style/PageMasterStyleMap.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/style/PageMasterStyleMap.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -122,6 +122,12 @@ const XMLPropertyMapEntry aXMLPageMaster
     PLMAP( "GridPrint", XML_NAMESPACE_STYLE, XML_LAYOUT_GRID_PRINT, XML_TYPE_BOOL, 0 ),
     PLMAP( "GridDisplay", XML_NAMESPACE_STYLE, XML_LAYOUT_GRID_DISPLAY, XML_TYPE_BOOL, 0 ),
 
+	//text grid enhancement for better CJK support
+    PLMAP( "GridBaseWidth", XML_NAMESPACE_STYLE, XML_LAYOUT_GRID_BASE_WIDTH, XML_TYPE_MEASURE, CTP_PM_GRID_BASE_WIDTH ),
+    PLMAP( "GridSnapToChars", XML_NAMESPACE_STYLE, XML_LAYOUT_GRID_SNAP_TO_CHARS, XML_TYPE_BOOL, CTP_PM_GRID_SNAP_TO_CHARS ),
+  	//export as a default attribute
+    PLMAP( "StandardPageMode", XML_NAMESPACE_STYLE, XML_LAYOUT_GRID_STANDARD_MODE, XML_TYPE_BOOL|MID_FLAG_DEFAULT_ITEM_EXPORT, CTF_PM_STANDARD_MODE ),
+	
 	PLMAP( "UserDefinedAttributes",	XML_NAMESPACE_TEXT,		XML_XMLNS,						XML_TYPE_ATTRIBUTE_CONTAINER | MID_FLAG_SPECIAL_ITEM, 0 ),
 
 // footnote
diff -uNpr xmloff.bk/source/style/XMLPageExport.cxx xmloff/source/style/XMLPageExport.cxx
--- xmloff.bk/source/style/XMLPageExport.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/style/XMLPageExport.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -277,3 +277,47 @@ void XMLPageExport::exportAutoStyles()
 		rExport.GetNamespaceMap()
         );
 }
+
+void XMLPageExport::exportDefaultStyle()
+{
+	Reference < lang::XMultiServiceFactory > xFactory (GetExport().GetModel(), UNO_QUERY);
+	if (xFactory.is())
+	{
+		OUString sTextDefaults ( RTL_CONSTASCII_USTRINGPARAM ( "com.sun.star.text.Defaults" ) );
+		Reference < XPropertySet > xPropSet (xFactory->createInstance ( sTextDefaults ), UNO_QUERY);
+		if (xPropSet.is())
+		{
+			// <style:default-style ...>
+			GetExport().CheckAttrList();
+
+			::std::vector< XMLPropertyState > xPropStates =
+				xPageMasterExportPropMapper->FilterDefaults( xPropSet );
+			
+			sal_Bool bExport = sal_False;
+			UniReference < XMLPropertySetMapper > aPropMapper(xPageMasterExportPropMapper->getPropertySetMapper());
+			for( ::std::vector< XMLPropertyState >::iterator aIter = xPropStates.begin(); aIter != xPropStates.end(); ++aIter )
+			{
+        		XMLPropertyState *pProp = &(*aIter);
+				sal_Int16 nContextId	= aPropMapper->GetEntryContextId( pProp->mnIndex );
+				if( nContextId == CTF_PM_STANDARD_MODE )
+				{
+					bExport = sal_True;
+					break;
+				}
+			}
+
+		//	if ( xPropStates.size() != 0 &&
+          //          ( xPropStates.size() != 1 || xPropStates[0].mnIndex != -1 ) )
+			if( bExport )	
+			{
+				//<style:default-page-layout>
+				SvXMLElementExport aElem( GetExport(), XML_NAMESPACE_STYLE,
+										  XML_DEFAULT_PAGE_LAYOUT,
+										  sal_True, sal_True );
+
+				xPageMasterExportPropMapper->exportXML( GetExport(), xPropStates,
+									   	  XML_EXPORT_FLAG_IGN_WS );
+			}
+		}
+	}
+}
diff -uNpr xmloff.bk/source/style/xmlstyle.cxx xmloff/source/style/xmlstyle.cxx
--- xmloff.bk/source/style/xmlstyle.cxx	2008-02-19 15:20:40.000000000 +0800
+++ xmloff/source/style/xmlstyle.cxx	2008-02-19 15:20:49.000000000 +0800
@@ -175,6 +175,7 @@ static __FAR_DATA SvXMLTokenMapEntry aSt
 	{ XML_NAMESPACE_TEXT,	XML_NOTES_CONFIGURATION,    XML_TOK_TEXT_NOTE_CONFIG },
 	{ XML_NAMESPACE_TEXT,	XML_BIBLIOGRAPHY_CONFIGURATION, XML_TOK_TEXT_BIBLIOGRAPHY_CONFIG },
 	{ XML_NAMESPACE_TEXT,   XML_LINENUMBERING_CONFIGURATION,XML_TOK_TEXT_LINENUMBERING_CONFIG },
+	{ XML_NAMESPACE_STYLE,	XML_DEFAULT_PAGE_LAYOUT,	XML_TOK_STYLE_DEFAULT_PAGE_LAYOUT        },
 	XML_TOKEN_MAP_END
 };
 
@@ -546,9 +547,13 @@ SvXMLStyleContext *SvXMLStylesContext::C
 			}
 			break;
 			case XML_TOK_STYLE_PAGE_MASTER:
+			case XML_TOK_STYLE_DEFAULT_PAGE_LAYOUT:
 			{
+				//there is not page family in odf now, so I specify one for it
+				sal_Bool bDefaultStyle  = XML_TOK_STYLE_DEFAULT_PAGE_LAYOUT == nToken
+					? sal_True: sal_False;
 				pStyle = new PageStyleContext( GetImport(), p_nPrefix,
-													rLocalName, xAttrList, *this );
+													rLocalName, xAttrList, *this, bDefaultStyle );
 			}
 			break;
 			case XML_TOK_TEXT_LIST_STYLE:
