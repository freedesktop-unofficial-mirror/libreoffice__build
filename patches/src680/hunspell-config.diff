Index: config_office/configure.in
===================================================================
--- config_office/configure.in.orig	2006-01-16 23:56:37.000000000 +0100
+++ config_office/configure.in	2006-01-16 23:57:01.000000000 +0100
@@ -43,6 +43,9 @@ AC_ARG_ENABLE(openldap,
 AC_ARG_ENABLE(libsn,
 [  --enable-libsn          Enables the use of libstartup-notification
 ],,)
+AC_ARG_ENABLE(hunspell,
+[  --enable-hunspell       Enables the Hunspell UNO component
+],,)
 AC_ARG_ENABLE(mozilla,
 [  --disable-mozilla       OO.o usually includes a strangely hacked up mozilla
                           binary for your platform, to build without this
@@ -304,6 +307,9 @@ AC_ARG_WITH(system-agg,
 AC_ARG_WITH(system-myspell,
 [  --with-system-myspell   Use myspell already on system
 ],,)
+AC_ARG_WITH(system-hunspell,
+[  --with-system-hunspell   Use libhunspell already on system
+],,)
 AC_ARG_WITH(system-mythes,
 [  --with-system-mythes    Use mythes already on system
 ],,)
@@ -3516,6 +3522,41 @@ AC_SUBST(MYSPELL_CFLAGS)
 AC_SUBST(MYSPELL_LIBS)
 
 dnl ===================================================================
+dnl Check for system hunspell
+dnl ===================================================================
+AC_MSG_CHECKING([which libhunspell to use])
+if test -n "$with_system_hunspell" && test "$with_system_hunspell" != "no"; then
+    AC_MSG_RESULT([external])
+    SYSTEM_HUNSPELL=YES
+    AC_LANG(C++)
+    save_CPPFLAGS=$CPPFLAGS
+    if test -r /usr/include/hunspell/hunspell.hxx ; then
+        HUNSPELL_CFLAGS="-I/usr/include/hunspell"        
+        CPPFLAGS="$CPPFLAGS $HUNSPELL_CFLAGS"
+    fi
+
+    AC_CHECK_HEADER(hunspell.hxx, [],
+        [ AC_MSG_ERROR(hunspell headers not found.) ], [])
+
+    dnl use PIC version if it is available
+    AC_CHECK_LIB(hunspell_pic, main,
+        [ HUNSPELL_LIBS=-lhunspell_pic ], [], [])
+    if test -z $HUNSPELL_LIBS ; then
+        AC_CHECK_LIB(hunspell, main, [ HUNSPELL_LIBS=-lhunspell ],
+            [ AC_MSG_ERROR(hunspell library not found.) ], [])
+    fi
+
+    CPPFLAGS=$save_CPPFLAGS
+else
+    AC_MSG_RESULT([internal])
+    SYSTEM_HUNSPELL=NO
+    HUNSPELL_LIBS=-lhunspell
+fi
+AC_SUBST(SYSTEM_HUNSPELL)
+AC_SUBST(HUNSPELL_CFLAGS)
+AC_SUBST(HUNSPELL_LIBS)
+
+dnl ===================================================================
 dnl Checking for altlinuxhyph
 dnl ===================================================================
 AC_MSG_CHECKING([which altlinuxhyph to use])
@@ -4218,6 +4259,19 @@ AC_SUBST(LIBSN_CFLAGS)
 AC_SUBST(LIBSN_LIBS)
 
 dnl ===================================================================
+dnl Test whether to build Hunspell UNO component
+dnl ===================================================================
+AC_MSG_CHECKING([whether to build Hunspell UNO component])
+if test -n "$enable_hunspell" && test "$enable_hunspell" != "no"; then
+  ENABLE_HUNSPELL="TRUE"
+  AC_MSG_RESULT([yes])
+else
+  ENABLE_HUNSPELL="FALSE"
+  AC_MSG_RESULT([no])
+fi
+AC_SUBST(ENABLE_HUNSPELL)
+
+dnl ===================================================================
 dnl Test whether to include Evolution 2 support
 dnl ===================================================================
 AC_MSG_CHECKING([whether to enable evolution 2 support])
Index: config_office/set_soenv.in
===================================================================
--- config_office/set_soenv.in.orig	2006-01-16 23:56:37.000000000 +0100
+++ config_office/set_soenv.in	2006-01-16 23:57:01.000000000 +0100
@@ -1729,6 +1729,7 @@ ToFile( "LIBART_LIBS",       "@LIBART_LI
 ToFile( "WITH_LIBSN",        "@WITH_LIBSN@",       "e" );
 ToFile( "LIBSN_CFLAGS",      "@LIBSN_CFLAGS@",     "e" );
 ToFile( "LIBSN_LIBS",        "@LIBSN_LIBS@",       "e" );
+ToFile( "ENABLE_HUNSPELL",   "@ENABLE_HUNSPELL@",  "e" );
 ToFile( "WITH_OPENLDAP",     "@WITH_OPENLDAP@",    "e" );
 ToFile( "WITH_MOZILLA",      "@WITH_MOZILLA@",     "e" );
 ToFile( "SYSTEM_MOZILLA",    "@SYSTEM_MOZILLA@",   "e" );
@@ -1809,6 +1810,9 @@ ToFile( "BUILD_DMAKE",       "@BUILD_DMA
 ToFile( "USE_XINERAMA",      "@USE_XINERAMA@",     "e" );
 ToFile( "XINERAMA_LINK",     "@XINERAMA_LINK@",    "e" );
 ToFile( "SYSTEM_MYSPELL",    "@SYSTEM_MYSPELL@",   "e" );
+ToFile( "SYSTEM_HUNSPELL",   "@SYSTEM_HUNSPELL@",  "e" );
+ToFile( "HUNSPELL_CFLAGS",   "@SYSTEM_HUNSPELL@",  "e" );
+ToFile( "HUNSPELL_LIBS",     "@HUNSPELL_LIBS@",    "e" );
 ToFile( "MYSPELL_CFLAGS",    "@MYSPELL_CFLAGS@",   "e" );
 ToFile( "MYSPELL_LIBS",      "@MYSPELL_LIBS@",     "e" );
 ToFile( "SYSTEM_HYPH",       "@SYSTEM_HYPH@",      "e" );
