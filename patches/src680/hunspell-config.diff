--- config_office/configure.in.old	2005-08-04 21:37:32.000000000 +0200
+++ config_office/configure.in	2005-08-09 18:25:04.000000000 +0200
@@ -46,6 +46,9 @@
 AC_ARG_ENABLE(libsn,
 [  --enable-libsn          Enables the use of libstartup-notification
 ],,)
+AC_ARG_ENABLE(hunspell,
+[  --enable-hunspell       Enables the Hunspell UNO component
+],,)
 AC_ARG_ENABLE(mozilla,
 [  --disable-mozilla       OO.o usually includes a strangely hacked up mozilla
                           binary for your platform, to build without this
@@ -267,6 +270,9 @@
 AC_ARG_WITH(system-myspell,
 [  --with-system-myspell   Use myspell already on system
 ],,)
+AC_ARG_WITH(system-hunspell,
+[  --with-system-hunspell   Use libhunspell already on system
+],,)
 AC_ARG_WITH(system-mythes,
 [  --with-system-mythes    Use mythes already on system
 ],,)
@@ -3252,6 +3258,24 @@
 AC_SUBST(MYSPELL_LIBS)
 
 dnl ===================================================================
+dnl Check for system hunspell
+dnl ===================================================================
+AC_MSG_CHECKING([which libhunspell to use])
+if test -n "$with_system_hunspell" && test "$with_system_hunspell" != "no"; then
+    AC_MSG_RESULT([external])
+    SYSTEM_HUNSPELL=YES
+    AC_LANG(C++)
+    AC_CHECK_HEADER(hunspell.hxx, [],
+        [AC_MSG_ERROR(hunspell headers not found.)], [])
+    AC_CHECK_LIB(hunspell, main, [],
+           [ AC_MSG_ERROR(hunspell library not found.) ], [])
+else
+    AC_MSG_RESULT([internal])
+    SYSTEM_HUNSPELL=NO
+fi
+AC_SUBST(SYSTEM_HUNSPELL)
+
+dnl ===================================================================
 dnl Checking for altlinuxhyph
 dnl ===================================================================
 AC_MSG_CHECKING([which altlinuxhyph to use])
@@ -3966,6 +3990,19 @@
 AC_SUBST(LIBSN_LIBS)
 
 dnl ===================================================================
+dnl Test whether to build Hunspell UNO component
+dnl ===================================================================
+AC_MSG_CHECKING([whether to build Hunspell UNO component])
+if test -n "$enable_hunspell" && test "$enable_hunspell" != "no"; then
+  ENABLE_HUNSPELL="TRUE"
+  AC_MSG_RESULT([yes])
+else
+  ENABLE_HUNSPELL="FALSE"
+  AC_MSG_RESULT([no])
+fi
+AC_SUBST(ENABLE_HUNSPELL)
+
+dnl ===================================================================
 dnl Test whether to include Evolution 2 support
 dnl ===================================================================
 AC_MSG_CHECKING([whether to enable evolution 2 support])
--- config_office/set_soenv.in.old	2005-08-04 21:37:32.000000000 +0200
+++ config_office/set_soenv.in	2005-08-09 18:15:17.000000000 +0200
@@ -1695,6 +1695,7 @@
 ToFile( "WITH_LIBSN",        "@WITH_LIBSN@",       "e" );
 ToFile( "LIBSN_CFLAGS",      "@LIBSN_CFLAGS@",     "e" );
 ToFile( "LIBSN_LIBS",        "@LIBSN_LIBS@",       "e" );
+ToFile( "ENABLE_HUNSPELL",   "@ENABLE_HUNSPELL@",  "e" );
 ToFile( "WITH_OPENLDAP",     "@WITH_OPENLDAP@",    "e" );
 ToFile( "WITH_MOZILLA",      "@WITH_MOZILLA@",     "e" );
 ToFile( "SYSTEM_MOZILLA",    "@SYSTEM_MOZILLA@",   "e" );
@@ -1766,6 +1767,7 @@
 ToFile( "USE_XINERAMA",      "@USE_XINERAMA@",     "e" );
 ToFile( "XINERAMA_LINK",     "@XINERAMA_LINK@",    "e" );
 ToFile( "SYSTEM_MYSPELL",    "@SYSTEM_MYSPELL@",   "e" );
+ToFile( "SYSTEM_HUNSPELL",   "@SYSTEM_HUNSPELL@",  "e" );
 ToFile( "MYSPELL_CFLAGS",    "@MYSPELL_CFLAGS@",   "e" );
 ToFile( "MYSPELL_LIBS",      "@MYSPELL_LIBS@",     "e" );
 ToFile( "SYSTEM_HYPH",       "@SYSTEM_HYPH@",      "e" );
