--- xmloff/source/core/XMLEmbeddedObjectImportContext.cxx	27 Jun 2007 14:55:45 -0000	1.15
+++ xmloff/source/core/XMLEmbeddedObjectImportContext.cxx	26 Jul 2007 11:44:31 -0000	1.15.28.2
@@ -120,6 +120,7 @@ const XMLServiceMapEntry_Impl aServiceMa
 	SERVICE_MAP_ENTRY( ONLINE_TEXT, WRITER ),
 	SERVICE_MAP_ENTRY( SPREADSHEET, CALC ),
 	SERVICE_MAP_ENTRY( DRAWING, DRAW ),
+	SERVICE_MAP_ENTRY( GRAPHICS, DRAW ),
 	SERVICE_MAP_ENTRY( PRESENTATION, IMPRESS ),
 	SERVICE_MAP_ENTRY( CHART, CHART ),
 	{ XML_TOKEN_INVALID, 0, 0 }
@@ -269,16 +270,22 @@ XMLEmbeddedObjectImportContext::XMLEmbed
 		}
 
 		OUString sClass;
-		OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") );
-		if( 0 == sMime.compareTo( aTmp, aTmp.getLength() ) )
+		static const char * aTmp[] =
 		{
-			sClass = sMime.copy( aTmp.getLength() );
-		}
-		else
+			"application/vnd.oasis.openoffice.",
+			"application/x-vnd.oasis.openoffice.",
+			"application/vnd.oasis.opendocument.",
+			"application/x-vnd.oasis.opendocument.",
+			NULL
+		};
+		for (int k=0; aTmp[k]; k++)
 		{
-			aTmp = OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
-			if( 0 == sMime.compareTo( aTmp, aTmp.getLength() ) )
-				sClass = sMime.copy( aTmp.getLength() );
+			::rtl::OUString sTmpString = ::rtl::OUString::createFromAscii(aTmp[k]);
+			if( sMime.matchAsciiL( aTmp[k], sTmpString.getLength() ) )
+			{
+				sClass = sMime.copy( sTmpString.getLength() );
+				break;
+			}
 		}
 
 		if( sClass.getLength() )
@@ -297,7 +304,9 @@ XMLEmbeddedObjectImportContext::XMLEmbed
 					case XML_TEXT:			aName = SvGlobalName(SO3_SW_CLASSID); break;
 					case XML_ONLINE_TEXT:	aName = SvGlobalName(SO3_SWWEB_CLASSID); break;
 					case XML_SPREADSHEET:	aName = SvGlobalName(SO3_SC_CLASSID); break;
-					case XML_DRAWING:		aName = SvGlobalName(SO3_SDRAW_CLASSID); break;
+					case XML_DRAWING:
+					case XML_GRAPHICS:
+					case XML_IMAGE:		aName = SvGlobalName(SO3_SDRAW_CLASSID); break;
 					case XML_PRESENTATION:	aName = SvGlobalName(SO3_SIMPRESS_CLASSID); break;
 					case XML_CHART:			aName = SvGlobalName(SO3_SCH_CLASSID); break;
 					default:
--- xmloff/source/core/xmlexp.cxx	27 Jun 2007 14:57:25 -0000	1.130
+++ xmloff/source/core/xmlexp.cxx	26 Jul 2007 09:42:54 -0000	1.130.26.1
@@ -1321,7 +1321,7 @@ sal_uInt32 SvXMLExport::exportDoc( enum 
 			// office:mimetype = ... (only for stream containing the content)
 			if( eClass != XML_TOKEN_INVALID )
 			{
-				OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
+				OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.opendocument.") );
 				aTmp += GetXMLToken( eClass );
 				AddAttribute( XML_NAMESPACE_OFFICE, XML_MIMETYPE, aTmp );
 			}
--- xmloff/source/transform/DocumentTContext.cxx	27 Jun 2007 16:20:13 -0000	1.5
+++ xmloff/source/transform/DocumentTContext.cxx	26 Jul 2007 11:44:32 -0000	1.5.28.2
@@ -113,18 +113,24 @@ void XMLDocumentTransformerContext::Star
 			IsXMLToken( aLocalName, XML_MIMETYPE ) )
 		{
 			const OUString& rValue = xAttrList->getValueByIndex( i );
-			OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") );
-			if( 0 == rValue.compareTo( aTmp, aTmp.getLength() ) )
+			static const char * aTmp[] =
 			{
-				aClass = rValue.copy( aTmp.getLength() );
-			}
-			else
+				"application/vnd.oasis.openoffice.",
+				"application/x-vnd.oasis.openoffice.",
+				"application/vnd.oasis.opendocument.",
+				"application/x-vnd.oasis.document.",
+				NULL
+			};
+			for (int k=0; aTmp[k]; k++)
 			{
-				aTmp = OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
-				if( 0 == rValue.compareTo( aTmp, aTmp.getLength() ) )
-					aClass = rValue.copy( aTmp.getLength() );
+				::rtl::OUString sTmpString = ::rtl::OUString::createFromAscii(aTmp[k]);
+				if( rValue.matchAsciiL( aTmp[k], sTmpString.getLength() ) )
+				{
+					aClass = rValue.copy( sTmpString.getLength() );
+					break;
+				}
 			}
-			
+
 			if( !pMutableAttrList )
 			{
 				pMutableAttrList = new XMLMutableAttributeList( xAttrList );
--- xmloff/source/transform/OOo2Oasis.cxx	27 Jun 2007 16:21:57 -0000	1.20
+++ xmloff/source/transform/OOo2Oasis.cxx	26 Jul 2007 12:23:11 -0000	1.20.28.2
@@ -1202,7 +1202,7 @@ void XMLDocumentTransformerContext_Impl:
 
 			pMutableAttrList = new XMLMutableAttributeList( xAttrList );
 			xAttrList = pMutableAttrList;
-			OUString sMime(RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
+			OUString sMime(RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.opendocument.") );
 			sMime += rValue;
 			pMutableAttrList->SetValueByIndex( i, sMime );
 			OUString aNewAttrQName( GetTransformer().GetNamespaceMap().GetQNameByKey( XML_NAMESPACE_OFFICE, ::xmloff::token::GetXMLToken( XML_MIMETYPE ) ) );
