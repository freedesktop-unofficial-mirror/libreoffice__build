--- configmgr/source/cmdtools/configimport.sh	2005-10-10 17:00:52.000000000 +0200
+++ configmgr/source/cmdtools/configimport.sh	2005-10-10 17:03:39.000000000 +0200
@@ -91,27 +91,57 @@ fi
 sd_platform=`uname -s`
 case $sd_platform in
   AIX)
-    LIBPATH="$sd_prog":$LIBPATH
+    if [ $LIBPATH ]; then
+      SYSTEM_LIBPATH=$LIBPATH
+      export SYSTEM_LIBPATH
+      LIBPATH="$sd_prog":$LIBPATH
+    else
+      LIBPATH="$sd_prog"
+    fi
     export LIBPATH
     ;;
 
   Darwin)
-    DYLD_LIBRARY_PATH="$sd_prog":$DYLD_LIBRARY_PATH
+    if [ $DYLD_LIBRARY_PATH ]; then 
+      SYSTEM_DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH
+      export SYSTEM_DYLD_LIBRARY_PATH
+      DYLD_LIBRARY_PATH="$sd_prog":$DYLD_LIBRARY_PATH
+    else
+      DYLD_LIBRARY_PATH="$sd_prog"
+    fi
     export DYLD_LIBRARY_PATH
     ;;
 
   HP-UX)
-    SHLIB_PATH="$sd_prog":/usr/openwin/lib:$SHLIB_PATH
+    if [ $SHLIB_PATH ]; then
+      SYSTEM_SHLIB_PATH=$SHLIB_PATH
+      export SYSTEM_SHLIB_PATH
+      SHLIB_PATH="$sd_prog":/usr/openwin/lib:$SHLIB_PATH
+    else
+      SHLIB_PATH="$sd_prog":/usr/openwin/lib
+    fi
     export SHLIB_PATH
     ;;
 
   IRIX*)
-    LD_LIBRARYN32_PATH=:"$sd_prog":$LD_LIBRARYN32_PATH
+    if [ $LD_LIBRARYN32_PATH ]; then
+       SYSTEM_LD_LIBRARYN32_PATH=$LD_LIBRARYN32_PATH
+       export SYSTEM_LD_LIBRARYN32_PATH
+       LD_LIBRARYN32_PATH=:"$sd_prog":$LD_LIBRARYN32_PATH
+    else
+       LD_LIBRARYN32_PATH=:"$sd_prog"
+    fi
     export LD_LIBRARYN32_PATH
     ;;
 
   *)
-    LD_LIBRARY_PATH="$sd_prog":$LD_LIBRARY_PATH
+    if [ $LD_LIBRARY_PATH ]; then
+      SYSTEM_LD_LIBRARY_PATH=$LD_LIBRARY_PATH
+      export SYSTEM_LD_LIBRARY_PATH
+      LD_LIBRARY_PATH="$sd_prog":$LD_LIBRARY_PATH
+    else
+      LD_LIBRARY_PATH="$sd_prog"
+    fi
     export LD_LIBRARY_PATH
     ;;
 esac
--- desktop/scripts/soffice.sh	2005-09-08 19:02:48.000000000 +0200
+++ desktop/scripts/soffice.sh	2005-10-20 12:59:08.000000000 +0200
@@ -81,9 +81,9 @@
 
 # set search path for shared libraries
 sd_platform=`uname -s`
-moz_lib=
+add_moz_lib=
 for moz_lib_path in $MOZILLA_LIBRARY_PATH /usr/lib /usr/lib/mozilla /usr/lib/mozilla-firefox /usr/lib/mozilla-thunderbird /opt/mozilla/lib /opt/MozillaFirefox/lib /opt/MozillaThunderbird/lib; do
-	test -f $moz_lib_path/libnss3.so && moz_lib="$moz_lib_path" && break;
+	test -f $moz_lib_path/libnss3.so && add_moz_lib=":$moz_lib_path" && break;
 done
 case $sd_platform in
   AIX)
@@ -91,9 +91,9 @@
     if [ $LIBPATH ]; then
       SYSTEM_LIBPATH=$LIBPATH
       export SYSTEM_LIBPATH
-      LIBPATH="$sd_prog:$moz_lib":$LIBPATH
+      LIBPATH="$sd_prog$add_moz_lib":$LIBPATH
     else
-      LIBPATH="$sd_prog:$moz_lib"
+      LIBPATH="$sd_prog$add_moz_lib"
     fi
     export LIBPATH
     ;;
@@ -103,9 +103,9 @@
     if [ $DYLD_LIBRARY_PATH ]; then 
       SYSTEM_DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH
       export SYSTEM_DYLD_LIBRARY_PATH
-      DYLD_LIBRARY_PATH="$sd_prog:$moz_lib":$DYLD_LIBRARY_PATH
+      DYLD_LIBRARY_PATH="$sd_prog$add_moz_lib":$DYLD_LIBRARY_PATH
     else
-      DYLD_LIBRARY_PATH="$sd_prog:$moz_lib"
+      DYLD_LIBRARY_PATH="$sd_prog$add_moz_lib"
     fi
     export DYLD_LIBRARY_PATH
     ;;
@@ -115,9 +115,9 @@
     if [ $SHLIB_PATH ]; then
       SYSTEM_SHLIB_PATH=$SHLIB_PATH
       export SYSTEM_SHLIB_PATH
-      SHLIB_PATH="$sd_prog:$moz_lib":/usr/openwin/lib:$SHLIB_PATH
+      SHLIB_PATH="$sd_prog$add_moz_lib":/usr/openwin/lib:$SHLIB_PATH
     else
-      SHLIB_PATH="$sd_prog:$moz_lib":/usr/openwin/lib
+      SHLIB_PATH="$sd_prog$add_moz_lib":/usr/openwin/lib
     fi
     export SHLIB_PATH
     ;;
@@ -127,9 +127,9 @@
     if [ $LD_LIBRARYN32_PATH ]; then
        SYSTEM_LD_LIBRARYN32_PATH=$LD_LIBRARYN32_PATH
        export SYSTEM_LD_LIBRARYN32_PATH
-       LD_LIBRARYN32_PATH=:"$sd_prog:$moz_lib":$LD_LIBRARYN32_PATH
+       LD_LIBRARYN32_PATH=:"$sd_prog$add_moz_lib":$LD_LIBRARYN32_PATH
     else
-       LD_LIBRARYN32_PATH=:"$sd_prog:$moz_lib"
+       LD_LIBRARYN32_PATH=:"$sd_prog$add_moz_lib"
     fi
     export LD_LIBRARYN32_PATH
     ;;
@@ -139,9 +139,9 @@
     if [ $LD_LIBRARY_PATH ]; then
       SYSTEM_LD_LIBRARY_PATH=$LD_LIBRARY_PATH
       export SYSTEM_LD_LIBRARY_PATH
-      LD_LIBRARY_PATH="$sd_prog:$moz_lib":$LD_LIBRARY_PATH
+      LD_LIBRARY_PATH="$sd_prog$add_moz_lib":$LD_LIBRARY_PATH
     else
-      LD_LIBRARY_PATH="$sd_prog:$moz_lib"
+      LD_LIBRARY_PATH="$sd_prog$add_moz_lib"
     fi
     export LD_LIBRARY_PATH
     ;;
--- desktop/scripts/unopkg.sh	2005-10-10 17:00:52.000000000 +0200
+++ desktop/scripts/unopkg.sh	2005-10-10 17:03:39.000000000 +0200
@@ -91,27 +91,57 @@ fi
 sd_platform=`uname -s`
 case $sd_platform in
   AIX)
-    LIBPATH="$sd_prog":$LIBPATH
+    if [ $LIBPATH ]; then
+      SYSTEM_LIBPATH=$LIBPATH
+      export SYSTEM_LIBPATH
+      LIBPATH="$sd_prog":$LIBPATH
+    else
+      LIBPATH="$sd_prog"
+    fi
     export LIBPATH
     ;;
 
   Darwin)
-    DYLD_LIBRARY_PATH="$sd_prog":$DYLD_LIBRARY_PATH
+    if [ $DYLD_LIBRARY_PATH ]; then 
+      SYSTEM_DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH
+      export SYSTEM_DYLD_LIBRARY_PATH
+      DYLD_LIBRARY_PATH="$sd_prog":$DYLD_LIBRARY_PATH
+    else
+      DYLD_LIBRARY_PATH="$sd_prog"
+    fi
     export DYLD_LIBRARY_PATH
     ;;
 
   HP-UX)
-    SHLIB_PATH="$sd_prog":/usr/openwin/lib:$SHLIB_PATH
+    if [ $SHLIB_PATH ]; then
+      SYSTEM_SHLIB_PATH=$SHLIB_PATH
+      export SYSTEM_SHLIB_PATH
+      SHLIB_PATH="$sd_prog":/usr/openwin/lib:$SHLIB_PATH
+    else
+      SHLIB_PATH="$sd_prog":/usr/openwin/lib
+    fi
     export SHLIB_PATH
     ;;
 
   IRIX*)
-    LD_LIBRARYN32_PATH=:"$sd_prog":$LD_LIBRARYN32_PATH
+    if [ $LD_LIBRARYN32_PATH ]; then
+       SYSTEM_LD_LIBRARYN32_PATH=$LD_LIBRARYN32_PATH
+       export SYSTEM_LD_LIBRARYN32_PATH
+       LD_LIBRARYN32_PATH=:"$sd_prog":$LD_LIBRARYN32_PATH
+    else
+       LD_LIBRARYN32_PATH=:"$sd_prog"
+    fi
     export LD_LIBRARYN32_PATH
     ;;
 
   *)
-    LD_LIBRARY_PATH="$sd_prog":$LD_LIBRARY_PATH
+    if [ $LD_LIBRARY_PATH ]; then
+      SYSTEM_LD_LIBRARY_PATH=$LD_LIBRARY_PATH
+      export SYSTEM_LD_LIBRARY_PATH
+      LD_LIBRARY_PATH="$sd_prog":$LD_LIBRARY_PATH
+    else
+      LD_LIBRARY_PATH="$sd_prog"
+    fi
     export LD_LIBRARY_PATH
     ;;
 esac
