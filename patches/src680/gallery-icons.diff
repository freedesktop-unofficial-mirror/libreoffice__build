Index: svx/source/gallery2/galbrws1.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/gallery2/galbrws1.cxx,v
retrieving revision 1.24
diff -u -p -u -r1.24 galbrws1.cxx
--- svx/source/gallery2/galbrws1.cxx	3 Nov 2004 16:03:22 -0000	1.24
+++ svx/source/gallery2/galbrws1.cxx	22 Feb 2005 17:14:17 -0000
@@ -221,14 +221,10 @@ ULONG GalleryBrowser1::ImplInsertThemeEn
 
 	if( pEntry && ( !pEntry->IsHidden() || bShowHiddenThemes ) )
 	{
-		Bitmap aBMP( GAL_RESID( RID_SVXBMP_THEME_NORMAL ) );
-		static const Image aImgNormal( BitmapEx( aBMP, COL_LIGHTMAGENTA ) );
-		aBMP = Bitmap( GAL_RESID( RID_SVXBMP_THEME_DEFAULT ) );
-		static const Image aImgDefault( BitmapEx( aBMP, COL_LIGHTMAGENTA ) );
-		aBMP = Bitmap( GAL_RESID( RID_SVXBMP_THEME_READONLY ) );
-		static const Image aImgReadOnly( BitmapEx( aBMP, COL_LIGHTMAGENTA ) );
-		aBMP = Bitmap( GAL_RESID( RID_SVXBMP_THEME_IMPORTED ) );
-		static const Image aImgImported( BitmapEx( aBMP, COL_LIGHTMAGENTA ) );
+		static const Image aImgNormal( GalleryResGetBitmapEx( RID_SVXBMP_THEME_NORMAL ) );
+		static const Image aImgDefault( GalleryResGetBitmapEx( RID_SVXBMP_THEME_DEFAULT ) );
+		static const Image aImgReadOnly( GalleryResGetBitmapEx( RID_SVXBMP_THEME_READONLY ) );
+		static const Image aImgImported( GalleryResGetBitmapEx( RID_SVXBMP_THEME_IMPORTED ) );
 
 		const Image* pImage;
 


diff -u -p -u -r1.32 galmisc.cxx
--- svx/source/gallery2/galmisc.cxx	11 Jan 2005 13:00:41 -0000	1.32
+++ svx/source/gallery2/galmisc.cxx	22 Feb 2005 17:14:17 -0000
@@ -714,4 +726,14 @@ void GalleryTransferable::StartDrag( Win
 	    mpTheme->SetDragPos( mnObjectPos );
 		TransferableHelper::StartDrag( pWindow, nDragSourceActions, nDragPointer, nDragImage );
     }
+}
+
+BitmapEx GalleryResGetBitmapEx( ULONG nId )
+{
+	BitmapEx aBmpEx( GAL_RES( nId ) );
+	
+	if( !aBmpEx.IsTransparent() )
+			aBmpEx = BitmapEx( aBmpEx.GetBitmap(), COL_LIGHTMAGENTA );
+
+	return aBmpEx;
 }
Index: svx/inc/galmisc.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/galmisc.hxx,v
retrieving revision 1.7
diff -u -p -u -r1.7 galmisc.hxx
--- svx/inc/galmisc.hxx	21 Jan 2005 14:42:26 -0000	1.7
+++ svx/inc/galmisc.hxx	22 Feb 2005 17:16:12 -0000
@@ -127,6 +127,8 @@ BOOL			FileExists( const INetURLObject& 
 BOOL			CreateDir(  const INetURLObject& rURL );
 BOOL			CopyFile(  const INetURLObject& rSrcURL, const INetURLObject& rDstURL );
 BOOL			KillFile( const INetURLObject& rURL );
+BitmapEx		GalleryResGetBitmapEx( ULONG nId );
+
 
 // ---------------
 // - SgaIMapInfo -
