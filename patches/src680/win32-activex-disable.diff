--- config_office/configure.in	Wed May  3 15:15:00 2006
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/config_office/configure.in	Wed May  3 14:38:03 2006
@@ -74,4 +74,8 @@
                                 set.
 ],,with_agfa_monotype_fonts="yes")
+AC_ARG_ENABLE(activex,
+[  --disable-activex       Remove support for ActiveX embedding of 
+                          OOo components
+],,enable_activex=yes)
 AC_ARG_ENABLE(epm,
 [  --disable-epm           OO.o includes self-packaging code, that requires
@@ -4268,6 +4272,19 @@
 fi
 AC_SUBST(WITH_AGFA_MONOTYPE_FONTS)
-
 AC_SUBST(SCPDEFS)
+
+if test "$_os" = "WINNT"; then
+  AC_MSG_CHECKING([whether to enable ActiveX embedding of OOo components])
+  if test "$enable_activex" = "yes" -o "$enable_activex" = "TRUE" -o "$enable_activex" = ""; then
+    ENABLE_ACTIVEX="TRUE"
+    AC_MSG_RESULT([yes])
+    SCPDEFS="$SCPDEFS -DWITH_ACTIVEX"
+  else
+    ENABLE_ACTIVEX=""
+    AC_MSG_RESULT([no])
+  fi
+  AC_SUBST(ENABLE_ACTIVEX)
+  AC_SUBST(SCPDEFS)
+fi
 
 AC_MSG_CHECKING([whether to include PPDs])
--- scp2/source/activex/file_activex.scp	Thu Oct 27 17:08:13 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/activex/file_activex.scp	Wed May  3 14:24:12 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 File gid_File_Lib_Soactivex
     TXT_FILE_BODY;
@@ -50,2 +52,3 @@
 End
 
+#endif // WITH_ACTIVEX
--- scp2/source/activex/module_activex.scp	Fri Sep  9 04:17:32 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/activex/module_activex.scp	Wed May  3 14:24:29 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 Module gid_Module_Optional_Activexcontrol
     MOD_NAME_DESC ( MODULE_OPTIONAL_ACTIVEXCONTROL );
@@ -43,2 +45,4 @@
     Files = (gid_File_Lib_Soactivex, gid_File_Lib_Regactivex_Msi);
 End
+
+#endif // WITH_ACTIVEX
--- scp2/source/calc/registryitem_calc.scp	Thu Nov 10 18:18:08 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/calc/registryitem_calc.scp	Wed May  3 14:25:20 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 // MSOLE embedded object in SO7 file format
 RegistryItem gid_Regitem_Clsid__7b342dc4_139a_4a46_8a93_Db0827ccee9c_
@@ -272,4 +274,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Sdc_Contenttype
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -359,4 +363,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starcalcdocument_6_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -366,4 +372,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starcalcdocument_6_Defaulticon
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -688,4 +696,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Openoffice_Calcdocument_1_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -694,4 +704,6 @@
     Value = "{7FA8AE11-B3E3-4D88-AABF-255526CD1CE8}";
 End
+
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Openoffice_Calcdocument_1_Defaulticon
--- scp2/source/draw/registryitem_draw.scp	Thu Nov 10 18:18:21 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/draw/registryitem_draw.scp	Wed May  3 14:25:46 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 // MSOLE embedded object in SO7 file format
 RegistryItem gid_Regitem_Clsid__41662fc2_0d57_4aff_Ab27_Ad2e12e7c273_
@@ -272,5 +274,5 @@
 End
 
-
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Sda_Contenttype
@@ -361,4 +363,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Stardrawdocument_6_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -368,4 +372,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Stardrawdocument_6_Defaulticon
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -690,4 +696,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Openoffice_Drawdocument_1_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -696,4 +704,6 @@
     Value = "{448BB771-CFE2-47C4-BCDF-1FBF378E202C}";
 End
+
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Openoffice_Drawdocument_1_Defaulticon
--- scp2/source/impress/registryitem_impress.scp	Thu Nov 10 18:18:33 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/impress/registryitem_impress.scp	Wed May  3 14:26:13 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 // MSOLE embedded object in SO7 file format
 RegistryItem gid_Regitem_Clsid__E5a0b632_Dfba_4549_9346_E414da06e6f8_
@@ -272,5 +274,5 @@
 End
 
-
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Sdd_Contenttype
@@ -377,4 +379,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starimpressdocument_6_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -384,4 +388,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starimpressdocument_6_Defaulticon
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -727,4 +733,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Openoffice_Impressdocument_1_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -733,4 +741,6 @@
     Value = "{EE5D1EA4-D445-4289-B2FC-55FC93693917}";
 End
+
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Openoffice_Impressdocument_1_Defaulticon
--- scp2/source/math/registryitem_math.scp	Thu Nov 10 18:18:46 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/math/registryitem_math.scp	Wed May  3 14:26:36 2006
@@ -35,4 +35,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 // MSOLE embedded object in SO7 file format
 RegistryItem gid_Regitem_Clsid__D0484de6_Aaee_468a_991f_8d4b0737b57a_
@@ -271,5 +273,5 @@
 End
 
-
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Smf_Contenttype
@@ -360,4 +362,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starmathdocument_6_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -367,4 +371,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starmathdocument_6_Defaulticon
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -582,4 +588,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Openoffice_Mathdocument_1_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -588,4 +596,6 @@
     Value = "{D2D59CD1-0A6A-4D36-AE20-47817077D57C}";
 End
+
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Openoffice_Mathdocument_1_Defaulticon
--- scp2/source/writer/registryitem_writer.scp	Thu Nov 10 18:19:00 2005
+++ /mnt/pippi/src/2.0.2/build/OOO_2_0_2/scp2/source/writer/registryitem_writer.scp	Wed May  3 14:27:50 2006
@@ -36,4 +36,6 @@
 #include "macros.inc"
 
+#ifdef WITH_ACTIVEX
+
 // MSOLE embedded object in SO7 file format
 RegistryItem gid_Regitem_Clsid__30a2652a_Ddf7_45e7_Aca6_3eab26fc8a4e_
@@ -272,4 +274,5 @@
 End
 
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Sdw_Contenttype
@@ -376,4 +379,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starwriterdocument_6_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -383,4 +388,6 @@
 End
 
+#endif // WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Soffice_Starwriterdocument_6_Defaulticon
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -882,4 +889,6 @@
 End
 
+#ifdef WITH_ACTIVEX
+
 RegistryItem gid_Regitem_Openoffice_Writerdocument_1_Clsid
     ParentID = PREDEFINED_HKEY_CLASSES_ROOT;
@@ -888,4 +897,6 @@
     Value = "{F616B81F-7BB8-4F22-B8A5-47428D59F8AD}";
 End
+
+#endif // WITH_ACTIVEX
 
 RegistryItem gid_Regitem_Openoffice_Writerdocument_1_Defaulticon
