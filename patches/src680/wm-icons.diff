Index: svtools/inc/imagemgr.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/imagemgr.hxx,v
retrieving revision 1.5
diff -u -p -u -r1.5 imagemgr.hxx
--- svtools/inc/imagemgr.hxx	11 Apr 2002 09:59:41 -0000	1.5
+++ svtools/inc/imagemgr.hxx	22 Dec 2004 18:08:18 -0000
@@ -70,6 +70,8 @@
 #ifndef _IMAGE_HXX
 #include <vcl/image.hxx>
 #endif
+#include <vcl/bitmapex.hxx>
+#include <list>
 
 class INetURLObject;
 
@@ -125,6 +127,8 @@ public:
 	static String	GetDescription( const INetURLObject& rObject );
 	static String	GetFileDescription( const INetURLObject& rObject );
 	static String	GetFolderDescription( const svtools::VolumeInfo& rInfo );
+
+	static std::list< BitmapEx > GetIcons( sal_Int16 nIconIndex );
 };
 
 #endif
Index: svtools/source/misc/imagemgr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/misc/imagemgr.cxx,v
retrieving revision 1.34
diff -u -p -u -r1.34 imagemgr.cxx
--- svtools/source/misc/imagemgr.cxx	29 Nov 2004 12:08:37 -0000	1.34
+++ svtools/source/misc/imagemgr.cxx	22 Dec 2004 18:08:18 -0000
@@ -944,3 +944,45 @@ String SvFileInformationManager::GetFold
     return sDescription;
 }
 
+static std::list< BitmapEx > GetIcons( sal_Int16 nIconIndex )
+{
+	USHORT nImageId = IMG_FILE;
+	switch( nIconIndex )
+	{
+#define MAP(a,b) \
+	case a: nImageId = b; break
+
+		MAP( ICON_DEFAULT, IMG_FILE );    // ??
+	    MAP( ICON_SO_DEFAULT, IMG_FILE ); // ??
+	    MAP( ICON_TEXT_DOCUMENT, IMG_WRITER );
+	    MAP( ICON_TEXT_TEMPLATE, IMG_WRITERTEMPLATE );
+	    MAP( ICON_SPREADSHEET_DOCUMENT, IMG_CALC );
+	    MAP( ICON_SPREADSHEET_TEMPLATE, IMG_CALCTEMPLATE );
+	    MAP( ICON_DRAWING_DOCUMENT, IMG_DRAW );
+	    MAP( ICON_DRAWING_TEMPLATE, IMG_DRAWTEMPLATE );
+	    MAP( ICON_PRESENTATION_DOCUMENT, IMG_IMPRESS );
+	    MAP( ICON_PRESENTATION_TEMPLATE, IMG_IMPRESSTEMPLATE );
+	    MAP( ICON_PRESENTATION_COMPRESSED, IMG_IMPRESSPACKED );
+	    MAP( ICON_GLOBAL_DOCUMENT, IMG_GLOBAL_DOC );
+	    MAP( ICON_HTML_DOCUMENT, IMG_HTML );
+	    MAP( ICON_CHART_DOCUMENT, IMG_CHART );
+	    MAP( ICON_DATABASE_DOCUMENT, IMG_DATABASE );
+	    MAP( ICON_MATH_DOCUMENT, IMG_MATH );
+	    MAP( ICON_TEMPLATE, IMG_NEWFROMTEMPLATE );
+	    MAP( ICON_MACROLIBRARY, IMG_MACROLIB );
+	    MAP( ICON_PLAYER, IMG_DXF ); // !!
+	    MAP( ICON_SETUP, IMG_TASK ); // !!
+	}
+
+	std::list< BitmapEx > aList;
+	
+	BOOL bHighContrast = FALSE; // should be done at the theme level
+
+	Image aSmall = GetImageFromList_Impl( nImageId, FALSE, bHighContrast );
+	aList.push_back( aSmall.GetBitmapEx() );
+
+	Image aLarge = GetImageFromList_Impl( nImageId, TRUE, bHighContrast );
+	aList.push_back( aLarge.GetBitmapEx() );
+
+	return aList;
+}
