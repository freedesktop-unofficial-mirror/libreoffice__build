--- solenv/inc/packtools.mk	2006-01-20 09:02:14.000000000 +0100
+++ solenv/inc/packtools.mk	2006-01-20 09:59:48.000000000 +0100
@@ -34,6 +34,12 @@
 #*************************************************************************
 
 .IF "$(GUI)"!="WNT"
-RPM*:=$(shell +-ls -l `which rpm` >& /dev/null && set i=`which rpm` && echo rpm`test -x $${{i}}build && echo build`)
+
+.IF "$(PKGFORMAT)" == "rpm"
+RPM*:=$(shell +-test -x "`which rpm`" && echo -n rpm && test -x "`which rpmbuild`" && echo build)
+.ENDIF
+.IF "$(PKGFORMAT)" == "deb"
 DPKG*:=$(shell +-ls -l `which dpkg` >& /dev/null && echo dpkg)
 .ENDIF
+
+.ENDIF
--- sysui/desktop/util/makefile.mk	2006-01-20 09:47:39.000000000 +0100
+++ sysui/desktop/util/makefile.mk	2006-01-20 10:09:21.000000000 +0100
@@ -81,12 +81,12 @@ PKGCONFIG_LIBS!:=-Wl,--export-dynamic $(
 
 .ENDIF          # "$(ENABLE_GNOMEVFS)"!=""
 
-.IF "$(OS)"!="SOLARIS"
+.IF "$(RPM)" != ""
 TARFILE=$(BIN)$/rpm$/openoffice.org-desktop-integration.tar.gz
+.ENDIF  # "$(RPM)" != ""
 .IF "$(DPKG)" != ""
 TARFILE2=$(BIN)$/deb$/openoffice.org-desktop-integration.tar.gz
 .ENDIF  # "$(DPKG)" != ""
-.ENDIF  # "$(OS)"!="SOLARIS"
 
 # --- Files --------------------------------------------------------
 
@@ -113,7 +113,7 @@ $(SCRIPTS) : $$(@:f)
     +@cat $(@:f) | tr -d "\015" > $@
     +@chmod 555 $@
 
-.IF "$(OS)"!="SOLARIS"
+.IF "$(RPM)" != ""
 
 $(TARFILE) : $(PKGDIR)$/{$(shell ls $(PKGDIR))}
 	$(MKDIRHIER) $(@:d)
