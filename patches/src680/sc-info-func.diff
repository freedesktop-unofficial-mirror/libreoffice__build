--- sc/inc/compiler.hrc	2005-04-14 09:49:48.000000000 +0530
+++ sc/inc/compiler.hrc	2005-04-19 10:54:19.668066325 +0530
@@ -196,6 +196,7 @@
 #define	SC_OPCODE_ERR_CELL			129
 #define	SC_OPCODE_FORMULA			130
 #define	SC_OPCODE_ARABIC			131
+#define	SC_OPCODE_INFO				132
 #define	SC_OPCODE_END_1_PAR			200
 
 /*** Funktionen mit mehreren Parametern ***/
--- sc/source/core/src/compiler.src	2005-04-14 09:50:04.000000000 +0530
+++ sc/source/core/src/compiler.src	2005-04-19 10:53:40.148159575 +0530
@@ -1692,6 +1692,11 @@
         Text [ de ] = "BAHTTEXT";
         Text [ en-US ] = "BAHTTEXT";
     };
+    String SC_OPCODE_INFO
+    {
+        Text [ de ] = "INFO";
+        Text [ en-US ] = "INFO";
+    };
 };
 Resource RID_SC_FUNCTION_NAMES_ENGLISH
 {
@@ -1987,5 +1992,6 @@
 	String SC_OPCODE_ARABIC { Text = "ARABIC" ; };
 	String SC_OPCODE_HYPERLINK { Text = "HYPERLINK" ; };
     String SC_OPCODE_BAHTTEXT { Text = "BAHTTEXT" ; };
+    String SC_OPCODE_INFO { Text = "INFO" ; };
 };
 

--- sc/inc/globstr.hrc	2005-04-19 09:07:32.000000000 +0530
+++ sc/inc/globstr.hrc	2005-04-22 11:54:18.015584338 +0530
@@ -581,7 +581,9 @@
 #define STR_NUM_ERROR               414
 #define STR_NULL_ERROR              415
 
-#define STR_COUNT                   416
+#define STR_MANUAL                  416
+
+#define STR_COUNT                   417
 
 #endif
 

--- sc/source/ui/src/globstr.src
+++ sc/source/ui/src/globstr.src
@@ -2065,8 +2065,8 @@ Resource RID_GLOBSTR
     };
     String STR_SCATTR_PAGE_SCALE_AUTO
     {
-        Text [ de ] = "automatisch" ;
-        Text [ en-US ] = "automatic" ;
+        Text [ de ] = "Automatisch" ;
+        Text [ en-US ] = "Automatic" ;
     };
 	String STR_DOC_STAT
 	{
@@ -2611,5 +2611,18 @@ Resource RID_GLOBSTR
 		Text [ en-US ] = "#NULL!" ;
 		Text [ x-comment ] = " ";
 	};
+	String STR_MANUAL
+	{
+		Text [ en-US ] = " Manual ";
+		Text[ de ] = "Manuell";
+		Text[ es ] = "Manual";
+		Text[ fr ] = "Manuel";
+		Text[ it ] = "Manuale";
+		Text[ ja ] = "手動";
+		Text[ pt-BR ] = "Manual";
+		Text[ zh-CN ] = "手册";
+		Text[ zh-TW ] = "手動";
+		Text [ x-comment ] = " ";
+	};
 };
 

--- sc/util/hidother.src	2005-04-14 09:49:51.000000000 +0530
+++ sc/util/hidother.src	2005-04-19 10:55:06.808990934 +0530
@@ -410,6 +410,7 @@
 hidspecial HID_FUNC_ROEMISCH		 { HelpID = HID_FUNC_ROEMISCH; };
 hidspecial HID_FUNC_ARABISCH		 { HelpID = HID_FUNC_ARABISCH; };
 hidspecial HID_FUNC_BAHTTEXT         { HelpID = HID_FUNC_BAHTTEXT; };
+hidspecial HID_FUNC_INFO		 { HelpID = HID_FUNC_INFO; };
 
 // ... and from Analysis Addin
 

--- sc/source/core/tool/interpr4.cxx	2005-04-22 10:38:05.000000000 +0530
+++ sc/source/core/tool/interpr4.cxx	2005-04-22 12:16:02.399713062 +0530
@@ -3531,6 +3531,7 @@ StackVar ScInterpreter::Interpret()
                 case ocConvert          : ScConvert();                  break;
                 case ocRoman            : ScRoman();                    break;
                 case ocArabic           : ScArabic();                   break;
+                case ocInfo             : ScInfo();                     break;
                 case ocHyperLink        : ScHyperLink();                break;
                 case ocAnswer           : ScAnswer();                   break;
                 case ocTeam             : ScCalcTeam();                 break;
--- sc/source/core/tool/interpr5.cxx	2005-04-14 09:50:06.000000000 +0530
+++ sc/source/core/tool/interpr5.cxx	2005-04-22 11:51:51.580714679 +0530
@@ -4015,5 +4015,45 @@ void ScInterpreter::ScMatRef()
 		SetError( errNoRef );
 }
 
+void ScInterpreter::ScInfo()
+{
+	if( MustHaveParamCount( GetByte(), 1 ) )
+	{
+		if( GetStackType() != svString)
+		{
+			SetIllegalArgument();
+			return;
+		}
+
+		String aStr = String(PopString()).ToUpperAscii();
+
+		if( aStr.EqualsAscii("SYSTEM") )
+			PushString( String::CreateFromAscii(OSVERSION) );
+
+		else if( aStr.EqualsAscii("OSVERSION") )
+			PushString( String::CreateFromAscii("Windows (32-bit) NT 5.01") );
+
+		else if( aStr.EqualsAscii("RELEASE") )
+			PushString( String::CreateFromAscii(BUILD_ID "-" MINOR) );
 
+		else if( aStr.EqualsAscii("ARCH") )
+			PushString( String::CreateFromAscii(ARCH) );
 
+		else if( aStr.EqualsAscii("GUI") )
+			PushString( String::CreateFromAscii(CGUI) );
+
+		else if( aStr.EqualsAscii("NUMFILE") )
+			PushString( String::CreateFromInt32(1) );
+
+		else if( aStr.EqualsAscii("RECALC") )
+		{
+			if( pDok->GetAutoCalc() )
+				PushString( ScGlobal::GetRscString( STR_SCATTR_PAGE_SCALE_AUTO ) );
+			else
+				PushString( ScGlobal::GetRscString( STR_MANUAL ) );
+		}
+
+		else	
+			SetIllegalParameter();
+	}
+}
--- sc/source/core/inc/interpre.hxx	2005-04-14 09:50:04.000000000 +0530
+++ sc/source/core/inc/interpre.hxx	2005-04-19 10:53:28.353679629 +0530
@@ -685,6 +685,7 @@
 void ScSTEXY();
 void ScSlope();
 void ScTrend();
+void ScInfo();
 
 
 public:
--- sc/inc/opcode.hxx	2005-04-14 09:49:49.000000000 +0530
+++ sc/inc/opcode.hxx	2005-04-19 10:54:10.434256359 +0530
@@ -206,6 +206,7 @@
 		ocErrCell			= SC_OPCODE_ERR_CELL,
 		ocFormula			= SC_OPCODE_FORMULA,
 		ocArabic			= SC_OPCODE_ARABIC,
+		ocInfo				= SC_OPCODE_INFO,
 		ocEnd1Par			= SC_OPCODE_END_1_PAR,
 	// Funktionen mit mehreren Parametern
 		ocArcTan2			= SC_OPCODE_ARC_TAN_2,
--- sc/source/ui/src/scfuncs.src	2005-04-14 09:49:55.000000000 +0530
+++ sc/source/ui/src/scfuncs.src	2005-04-22 11:54:44.487950093 +0530
@@ -11027,6 +11027,45 @@ Resource RID_SC_FUNCTION_DESCRIPTIONS2
 			Text [ en-US ] = "The text that represents a Roman numeral.";
 		};
 	};
+	Resource SC_OPCODE_INFO
+	{
+		String 1
+		{
+			Text [ de ] = " ";
+			Text [ en-US ] = "Gives some information about the environment";
+		Text[ de ] = "Einige Informationen zur Umgebung";
+		Text[ es ] = "Proporciona información sobre el entorno";
+		Text[ fr ] = "Donne quelques informations sur l'environnement";
+		Text[ it ] = "Include alcune informazioni sull'ambiente";
+		Text[ ja ] = "環境について説明します";
+		Text[ pt-BR ] = "Fornece algumas informações sobre o ambiente";
+		Text[ zh-CN ] = "提供一些关于环境的信息";
+		Text[ zh-TW ] = "提供一些有關環境的資訊。";
+		};
+		ExtraData = 
+		{
+			ID_FUNCTION_GRP_INFO;
+			U2S( HID_FUNC_INFO );
+			1;	0;
+		};
+		String 2
+		{
+			Text [ de ] = " ";
+			Text [ en-US ] = "Text";
+		};
+		String 3
+		{
+			Text [ en-US ] = "Can be 'osversion', 'system', 'release', 'arch', 'gui', 'numfile' and 'recalc'.";
+		Text[ de ] = "Kann 'osversion', 'system', 'release', 'arch', 'gui', 'numfile' und 'recalc' sein.";
+		Text[ fr ] = "Peut être 'osversion', 'system', 'release', 'arch', 'gui', 'numfile' et 'recalc'.";
+		Text[ it ] = "Può corrispondere a 'osversion', 'system', 'release', 'arch', 'gui', 'numfile' e 'recalc'.";
+		Text[ ja ] = "「osversion」、「system」、「release」、「arch」、「gui」、「numfile」、「recalc」になります。";
+		Text[ pt-BR ] = "Pode ser 'osversion', 'system', 'release', 'arch', 'gui', 'numfile' e 'recalc'.";
+		Text[ zh-CN ] = "可以是 'osversion'、'system'、'release'、'arch', 'gui'、'numfile' 和 'recalc'。";
+		Text[ zh-TW ] = "可以是 'osversion'、'system'、'release'、'arch', 'gui'、'numfile' 和 'recalc'。";
+			Text [ x-comment ] = " Donot translate quoted text. ";
+		};
+	};
 };
 
 #if defined(U2S)


--- solenv/inc/settings.mk	2005-04-14 10:17:33.000000000 +0530
+++ solenv/inc/settings.mk	2005-04-21 12:27:59.783874767 +0530
@@ -1393,6 +1393,12 @@
 .ENDIF
 #.ENDIF
 
+#Settings for the sc/tool, for producing information for =info function
+.IF "$(PRJNAME)"=="sc" && "$(TARGET)"=="tool"
+CDEFS+=-DMINOR=\"$(LAST_MINOR)\" -DBUILD_ID=\"$(BUILD)\" -DOSVERSION=\"$(OS)\"
+CDEFS+=-DARCH=\"$(CPUNAME)\" -DCGUI=\"$(GUI)\"
+.ENDIF
+
 #to be removed soon!!!
 .IF "$(TF_NEWEX)"!=""
 CDEFS+= -DTF_NEWEX
--- sc/source/filter/excel/xlformula.cxx	2005-04-14 09:50:10.000000000 +0530
+++ sc/source/filter/excel/xlformula.cxx	2005-04-22 11:53:58.701236836 +0530
@@ -219,7 +219,7 @@ static const XclFunctionInfo saFuncTable
     { ocRoundDown,          213,    2,  2,  V, { V } }
 };
 
-/** Functions new in BIFF3. Unsupported Excel function: INFO. */
+/** Functions new in BIFF3. */
 static const XclFunctionInfo saFuncTable_3[] =
 {
     { ocRGP,                49,     1,  4,  A, { R, R, V, V } },    // BIFF2: 1-2, BIFF3: 1-4
@@ -239,7 +239,8 @@ static const XclFunctionInfo saFuncTable
     { ocArcSinHyp,          232,    1,  1,  V, { V } },
     { ocArcCosHyp,          233,    1,  1,  V, { V } },
     { ocArcTanHyp,          234,    1,  1,  V, { V } },
-    { ocDBGet,              235,    3,  3,  V, { R } }
+    { ocDBGet,              235,    3,  3,  V, { R } },
+    { ocInfo,               244,    1,  1,  V, { V } }
 };
 
 /** Functions new in BIFF4. */
--- sc/inc/scfuncs.hrc	2005-04-14 09:49:48.000000000 +0530
+++ sc/inc/scfuncs.hrc	2005-04-22 11:52:54.715029952 +0530
@@ -147,6 +147,8 @@
 #define HID_FUNC_AKTUELL			(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_INFO*ID_FUNCTION_OFFSET)+14)
 #define HID_FUNC_FORMEL				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_INFO*ID_FUNCTION_OFFSET)+15)
 #define HID_FUNC_ZELLE				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_INFO*ID_FUNCTION_OFFSET)+16)
+#define HID_FUNC_INFO				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_INFO*ID_FUNCTION_OFFSET)+17)
+
 
 #define HID_FUNC_FALSCH				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_LOGIC*ID_FUNCTION_OFFSET)+1)
 #define HID_FUNC_NICHT				(HID_SC_FUNC_DUMMY+(ID_FUNCTION_GRP_LOGIC*ID_FUNCTION_OFFSET)+2)
