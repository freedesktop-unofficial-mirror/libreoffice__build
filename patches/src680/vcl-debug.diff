Index: vcl/unx/source/app/saldata.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/app/saldata.cxx,v
retrieving revision 1.45.34.1
diff -u -p -u -r1.45.34.1 saldata.cxx
--- vcl/unx/source/app/saldata.cxx	10 Aug 2006 14:56:47 -0000	1.45.34.1
+++ vcl/unx/source/app/saldata.cxx	22 Dec 2006 12:07:24 -0000
@@ -518,6 +518,35 @@ void EmitFontpathWarning( void )
 
 } /* extern "C" */
 
+static void PrintXError( Display *pDisplay, XErrorEvent *pEvent )
+{
+	char msg[ 120 ] = "";
+#if ! ( defined LINUX && defined PPC )
+    XGetErrorText( pDisplay, pEvent->error_code, msg, sizeof( msg ) );
+#endif
+    fprintf( stderr, "X-Error: %s\n", msg );
+    if( pEvent->request_code > capacityof( XRequest ) )
+        fprintf( stderr, "\tMajor opcode: %d\n", pEvent->request_code );
+    else if( XRequest[pEvent->request_code] )
+        fprintf( stderr, "\tMajor opcode: %d (%s)\n",
+                 pEvent->request_code, XRequest[pEvent->request_code] );
+    else
+        fprintf( stderr, "\tMajor opcode: %d (BadRequest?)\n", pEvent->request_code );
+    fprintf( stderr, "\tResource ID:  0x%lx\n",
+             pEvent->resourceid );
+    fprintf( stderr, "\tSerial No:    %ld (%ld)\n",
+             pEvent->serial, LastKnownRequestProcessed(pDisplay) );
+
+    if( !getenv( "SAL_SYNCHRONIZE" ) )
+    {
+        fprintf( stderr, "These errors are reported asynchronously, use:\n");
+        fprintf( stderr, "\texport SAL_SYNCHRONIZE=1 to help debugging\n");
+    }
+    
+    fflush( stdout );
+    fflush( stderr );
+}
+
 void SalXLib::XError( Display *pDisplay, XErrorEvent *pEvent )
 {
     if( m_bHaveSystemChildFrames )
@@ -545,25 +574,7 @@ void SalXLib::XError( Display *pDisplay,
             return;
 
 #if (OSL_DEBUG_LEVEL > 1) || defined DBG_UTIL
-	char msg[ 120 ] = "";
-#if ! ( defined LINUX && defined PPC )
-		XGetErrorText( pDisplay, pEvent->error_code, msg, sizeof( msg ) );
-#endif
-		fprintf( stderr, "X-Error: %s\n", msg );
-		if( pEvent->request_code > capacityof( XRequest ) )
-			fprintf( stderr, "\tMajor opcode: %d\n", pEvent->request_code );
-		else if( XRequest[pEvent->request_code] )
-			fprintf( stderr, "\tMajor opcode: %d (%s)\n",
-					 pEvent->request_code, XRequest[pEvent->request_code] );
-		else
-			fprintf( stderr, "\tMajor opcode: %d (BadRequest?)\n", pEvent->request_code );
-		fprintf( stderr, "\tResource ID:  0x%lx\n",
-				 pEvent->resourceid );
-		fprintf( stderr, "\tSerial No:    %ld (%ld)\n",
-				 pEvent->serial, LastKnownRequestProcessed(pDisplay) );
-
-		fflush( stdout );
-		fflush( stderr );
+        PrintXError( pDisplay, pEvent );
 #endif
         if( pDisplay != GetX11SalData()->GetDisplay()->GetDisplay() )
             return;
@@ -574,8 +585,10 @@ void SalXLib::XError( Display *pDisplay,
 			case osl_Signal_ActIgnore		:
 				return;
 			case osl_Signal_ActAbortApp 	:
+                PrintXError( pDisplay, pEvent );
 				abort();
 			case osl_Signal_ActKillApp		:
+                PrintXError( pDisplay, pEvent );
 				exit(0);
 			case osl_Signal_ActCallNextHdl	:
 				break;
