--- svx/source/dialog/selector.cxx.old	2006-09-27 15:53:45.088388000 +0200
+++ svx/source/dialog/selector.cxx	2006-09-27 15:55:20.298388000 +0200
@@ -584,6 +584,8 @@
 							node is a first level child of the Root and is NOT
 							either the current document, user or share */
 							Reference< browse::XBrowseNode >& theChild = children[n];
+							if (!theChild.is())
+								continue;
                             ::rtl::OUString uiName = theChild->getName();
 							BOOL bDisplay = TRUE;
 
@@ -902,6 +904,8 @@
 
                     for ( long n = 0; n < children.getLength(); n++ )
 					{
+         				if (!children[n].is())
+							continue;
 						if (children[n]->getType() == browse::BrowseNodeTypes::SCRIPT)
 						{
 							OUString uri;
@@ -1058,6 +1062,8 @@
 							node is a first level child of the Root and is NOT
 							either the current document, user or share */
 							Reference< browse::XBrowseNode >& theChild = children[n];
+                            if (!theChild.is())
+                                continue;
                             ::rtl::OUString uiName = theChild->getName();
 							BOOL bDisplay = TRUE;
 
