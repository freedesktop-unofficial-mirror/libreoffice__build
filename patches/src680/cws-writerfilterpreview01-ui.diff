--- filter/source/config/fragments/fcfg_writer.mk	13 Jul 2006 09:12:35 -0000	1.9
+++ filter/source/config/fragments/fcfg_writer.mk	2 Jul 2007 16:29:38 -0000	1.9.156.1
@@ -57,6 +57,7 @@ T4_WRITER = \
     writer8_template\
     writer8 \
     writer_MS_Word_2003_XML \
+    writer_MS_Word_2007_XML \
 	LaTeX \
 	BibTeX
 
@@ -90,6 +91,7 @@ F4_WRITER = \
 	writer8\
 	writer8_template \
     MS_Word_2003_XML \
+    MS_Word_2007_XML \
 	LaTeX_Writer \
 	BibTeX_Writer
 
@@ -109,7 +111,8 @@ F4_UI_WRITER = \
 	writer_StarOffice_XML_Writer_Template_ui \
 	writer8_ui \
 	writer8_template_ui \
-    MS_Word_2003_XML_ui
+    MS_Word_2003_XML_ui \
+    MS_Word_2007_XML_ui
 
 # -----------------------------------------------
 # count = 0
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ filter/source/config/fragments/filters/MS_Word_2007_XML.xcu	2 Jul 2007 16:29:39 -0000	1.1.4.2
@@ -0,0 +1,13 @@
+    <node oor:name="MS Word 2007" oor:op="replace">
+        <prop oor:name="Flags"><value>IMPORT ALIEN 3RDPARTYFILTER</value></prop>
+        <prop oor:name="UIComponent"/>
+        <prop oor:name="FilterService"><value>com.sun.star.comp.Writer.WriterFilter</value></prop>
+        <prop oor:name="UserData"><value>OXML</value></prop>
+        <prop oor:name="UIName">
+            <value xml:lang="x-default">Microsoft Word 2007</value>
+        </prop>
+        <prop oor:name="FileFormatVersion"><value>0</value></prop>
+        <prop oor:name="Type"><value>writer_MS_Word_2007</value></prop>
+        <prop oor:name="TemplateName"/>
+        <prop oor:name="DocumentService"><value>com.sun.star.text.TextDocument</value></prop>
+    </node>
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ filter/source/config/fragments/filters/MS_Word_2007_XML_ui.xcu	2 Jul 2007 16:29:39 -0000	1.1.4.2
@@ -0,0 +1,5 @@
+    <node oor:name="MS Word 2007 XML">
+		<prop oor:name="UIName">
+            <value xml:lang="en-US">Microsoft Word 2007 XML</value>
+		</prop>
+	</node>
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ filter/source/config/fragments/types/writer_MS_Word_2007_XML.xcu	2 Jul 2007 16:29:39 -0000	1.1.4.2
@@ -0,0 +1,12 @@
+    <node oor:name="writer_MS_Word_2007" oor:op="replace" >
+        <prop oor:name="DetectService"><value>com.sun.star.comp.Writer.WriterFilterDetector</value></prop>
+        <prop oor:name="URLPattern"/>
+        <prop oor:name="Extensions"><value>docx</value></prop>
+        <prop oor:name="MediaType"><value>application/msword</value></prop>
+        <prop oor:name="Preferred"><value>true</value></prop>
+        <prop oor:name="PreferredFilter"><value>MS Word 2007</value></prop>
+        <prop oor:name="UIName">
+            <value>Microsoft Word 2007</value>
+        </prop>
+        <prop oor:name="ClipboardFormat"><value>MSWordDoc</value></prop>
+    </node>
--- postprocess/prj/build.lst	15 Dec 2006 07:53:44 -0000	1.30
+++ postprocess/prj/build.lst	2 Jul 2007 16:44:39 -0000	1.30.22.1
@@ -1,4 +1,4 @@
-po	postprocess	::	accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker helpcontent2 hwpfilter io JAVAINSTALLER2:javainstaller2 lingucomponent MATHMLDTD:MathMLDTD MSFONTEXTRACT:msfontextract ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins scp2 scripting sd ODK:sdk_oo setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools jfreereport reportdesign NULL
+po	postprocess	::	accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker helpcontent2 hwpfilter io JAVAINSTALLER2:javainstaller2 lingucomponent MATHMLDTD:MathMLDTD MSFONTEXTRACT:msfontextract ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins scp2 scripting sd ODK:sdk_oo setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools jfreereport reportdesign writerfilter NULL
 po	postprocess			    	usr1	-	all	po_mkout NULL
 po	postprocess\checkxml		nmake	-	all	po_checkxml NULL
 po	postprocess\checkdeliver	nmake	-	all	po_checkdlv NULL
--- scp2/source/ooo/file_library_ooo.scp	28 Jun 2007 16:34:39 -0000	1.247
+++ scp2/source/ooo/file_library_ooo.scp	2 Jul 2007 16:52:24 -0000	1.247.2.1
@@ -1440,6 +1440,8 @@ End
 
 STD_UNO_LIB_FILE_PATCH(gid_File_Lib_Wpft,wpft)
 
+STD_UNO_LIB_FILE_PATCH(gid_File_Lib_Writerfilter,writerfilter)
+
 #if !defined(MACOSX) && ( !defined(SYSTEM_MOZILLA) && !defined(WITHOUT_MOZILLA) )
 
 File gid_File_Lib_Mozabdrv
--- scp2/source/writer/module_writer.scp	2 Jan 2007 15:31:51 -0000	1.17
+++ scp2/source/writer/module_writer.scp	2 Jul 2007 16:52:24 -0000	1.17.202.1
@@ -55,6 +55,7 @@ Module gid_Module_Prg_Wrt_Bin
     gid_File_Lib_Wpft,
     gid_File_Lib_Msworks,
     gid_File_Lib_T602Filter,
+    gid_File_Lib_Writerfilter,
     gid_File_Share_Config_Sofficecfg_Writer_Menubar_Xml,
     gid_File_Share_Config_Sofficecfg_Writerweb_Menubar_Xml,
     gid_File_Share_Config_Sofficecfg_Writerglobal_Menubar_Xml,
@@ -71,11 +72,12 @@ Module gid_Module_Prg_Wrt_Bin
     gid_File_Oo_Office_Ui_Writerwindowstate_Xcu,
     gid_File_Oo_Office_Ui_Writerglobalwindowstate_Xcu,
     gid_File_Oo_Office_Ui_Writerwebwindowstate_Xcu,
-	gid_File_Registry_Spool_Oo_Office_Embedding_Writer_Xcu,
+    gid_File_Registry_Spool_Oo_Office_Embedding_Writer_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Writer_Types_Xcu, gid_File_Registry_Spool_Oo_TypeDetection_Writer_Filters_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Web_Types_Xcu, gid_File_Registry_Spool_Oo_TypeDetection_Web_Filters_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Global_Types_Xcu, gid_File_Registry_Spool_Oo_TypeDetection_Global_Filters_Xcu,
-    gid_File_Tmp_Userinstall_Wrt_Inf);
+    gid_File_Tmp_Userinstall_Wrt_Inf, gid_File_Lib_writerfilter);
+
 End
 
 Module gid_Module_Prg_Wrt_Help
