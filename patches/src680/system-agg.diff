--- canvas/source/tools/image.hxx.ark	2005-11-22 16:49:56.000000000 +0000
+++ canvas/source/tools/image.hxx	2005-11-22 16:50:05.000000000 +0000
@@ -54,7 +54,7 @@
 #endif
 
 #include <canvas/elapsedtime.hxx>
-#include <agg/agg_rendering_buffer.h>
+#include <agg2/agg_rendering_buffer.h>
 
 
 struct BitmapSystemData;
--- canvas/source/tools/image.cxx.ark	2005-11-22 16:53:48.000000000 +0000
+++ canvas/source/tools/image.cxx	2005-11-22 16:54:11.000000000 +0000
@@ -63,41 +63,41 @@
 // includes from antigrain [i would love to write this stuff by myself]
 //////////////////////////////////////////////////////////////////////////////////
 
-#include <agg/agg_rendering_buffer.h>
-#include <agg/agg_pixfmt_rgb.h>
-#include <agg/agg_pixfmt_rgba.h>
-#include <agg/agg_renderer_base.h>
-#include <agg/agg_color_rgba.h>
-#include <agg/agg_rasterizer_outline_aa.h>
-#include <agg/agg_rasterizer_scanline_aa.h>
-#include <agg/agg_scanline_p.h>
-#include <agg/agg_scanline_u.h>
-#include <agg/agg_renderer_scanline.h>
-#include <agg/agg_renderer_outline_aa.h>
-#include <agg/agg_renderer_primitives.h>
-#include <agg/agg_path_storage.h>
-#include <agg/agg_span_pattern.h>
-#include <agg/agg_span_pattern_rgba.h>
-#include <agg/agg_span_pattern_resample_rgb.h>
-#include <agg/agg_span_pattern_resample_rgba.h>
-#include <agg/agg_span_interpolator_linear.h>
-#include <agg/agg_span_gradient.h>
-#include <agg/agg_span_image_resample_rgb.h>
-#include <agg/agg_span_image_resample_rgba.h>
-#include <agg/agg_image_filters.h>
-#include <agg/agg_dda_line.h>
-#include <agg/agg_scanline_storage_aa.h>
-#include <agg/agg_scanline_storage_bin.h>
-#include <agg/agg_scanline_bin.h>
-#include <agg/agg_path_storage_integer.h>
-#include <agg/agg_conv_contour.h>
-#include <agg/agg_conv_curve.h>
-#include <agg/agg_conv_stroke.h>
-#include <agg/agg_conv_transform.h>
-#include <agg/agg_trans_affine.h>
-#include <agg/agg_font_cache_manager.h>
-#include <agg/agg_bitset_iterator.h>
-#include <agg/agg_path_storage.h>
+#include <agg2/agg_rendering_buffer.h>
+#include <agg2/agg_pixfmt_rgb.h>
+#include <agg2/agg_pixfmt_rgba.h>
+#include <agg2/agg_renderer_base.h>
+#include <agg2/agg_color_rgba.h>
+#include <agg2/agg_rasterizer_outline_aa.h>
+#include <agg2/agg_rasterizer_scanline_aa.h>
+#include <agg2/agg_scanline_p.h>
+#include <agg2/agg_scanline_u.h>
+#include <agg2/agg_renderer_scanline.h>
+#include <agg2/agg_renderer_outline_aa.h>
+#include <agg2/agg_renderer_primitives.h>
+#include <agg2/agg_path_storage.h>
+#include <agg2/agg_span_pattern.h>
+#include <agg2/agg_span_pattern_rgba.h>
+#include <agg2/agg_span_pattern_resample_rgb.h>
+#include <agg2/agg_span_pattern_resample_rgba.h>
+#include <agg2/agg_span_interpolator_linear.h>
+#include <agg2/agg_span_gradient.h>
+#include <agg2/agg_span_image_resample_rgb.h>
+#include <agg2/agg_span_image_resample_rgba.h>
+#include <agg2/agg_image_filters.h>
+#include <agg2/agg_dda_line.h>
+#include <agg2/agg_scanline_storage_aa.h>
+#include <agg2/agg_scanline_storage_bin.h>
+#include <agg2/agg_scanline_bin.h>
+#include <agg2/agg_path_storage_integer.h>
+#include <agg2/agg_conv_contour.h>
+#include <agg2/agg_conv_curve.h>
+#include <agg2/agg_conv_stroke.h>
+#include <agg2/agg_conv_transform.h>
+#include <agg2/agg_trans_affine.h>
+#include <agg2/agg_font_cache_manager.h>
+#include <agg2/agg_bitset_iterator.h>
+#include <agg2/agg_path_storage.h>
 
 //////////////////////////////////////////////////////////////////////////////////
 // platform-dependend includes [wrapped into their own namepsaces]
Index: inc/libs.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/libs.mk,v
retrieving revision 1.94
diff -u -u -r1.94 libs.mk
--- solenv/inc/libs.mk	2 Nov 2005 13:52:18 -0000	1.94
+++ solenv/inc/libs.mk	22 Nov 2005 22:52:59 -0000
@@ -114,7 +114,11 @@
 BASEGFXLIB=-lbasegfx$(OFFICEUPD)$(DLLPOSTFIX)
 CANVASTOOLSLIB=-lcanvastools$(OFFICEUPD)$(DLLPOSTFIX)
 CPPCANVASLIB=-lcppcanvas$(OFFICEUPD)$(DLLPOSTFIX)
+.IF "$(SYSTEM_AGG)" "YES"
+AGGLIB=-lagg
+.ELSE
 AGGLIB=-lagg$(OFFICEUPD)$(DLLPOSTFIX)
+.ENDIF
 .IF "$(SYSTEM_FREETYPE)"=="YES"
 FREETYPELIB=$(FREETYPE_LIBS)
 FREETYPELIBST=$(FREETYPE_LIBS)
Index: configure.in
===================================================================
RCS file: /cvs/tools/config_office/configure.in,v
retrieving revision 1.139
diff -u -u -r1.139 configure.in
--- config_office/configure.in	25 Oct 2005 11:23:57 -0000	1.139
+++ config_office/configure.in	22 Nov 2005 22:58:38 -0000
@@ -266,6 +266,9 @@
 AC_ARG_WITH(system-neon,
 [  --with-system-neon      Use neon already on system
 ],,)
+AC_ARG_WITH(system-agg,
+[  --with-system-agg       Use AGG already on system
+],,)
 AC_ARG_WITH(system-myspell,
 [  --with-system-myspell   Use myspell already on system
 ],,)
@@ -3207,6 +3210,22 @@
 AC_SUBST(SYSTEM_NEON)
 AC_SUBST(NEON_LIBS)
 AC_SUBST(NEON_CFLAGS)
+
+dnl ===================================================================
+dnl Check for system AGG
+dnl ===================================================================
+AC_MSG_CHECKING([which AGG to use])
+if test -n "$with_system_agg" -o -n "$with_system_libs" && \
+   test "$with_system_agg" != "no"; then
+         AC_MSG_RESULT([external])
+         PKG_CHECK_MODULES(AGG, libagg >= 2.3)
+         SYSTEM_AGG=YES
+else
+         AC_MSG_RESULT([internal])
+         SYSTEM_AGG=NO
+         BUILD_TYPE="$BUILD_TYPE AGG"
+fi
+AC_SUBST(SYSTEM_AGG)
 
 dnl ===================================================================
 dnl Check for system myspell
Index: set_soenv.in
===================================================================
RCS file: /cvs/tools/config_office/set_soenv.in,v
retrieving revision 1.78
diff -u -u -r1.78 set_soenv.in
--- config_office/set_soenv.in	28 Oct 2005 11:59:53 -0000	1.78
+++ config_office/set_soenv.in	22 Nov 2005 22:58:39 -0000
@@ -1781,6 +1781,7 @@
 ToFile( "SYSTEM_NEON",       "@SYSTEM_NEON@",      "e" );
 ToFile( "NEON_LIBS",         "@NEON_LIBS@",        "e" );
 ToFile( "NEON_CFLAGS",       "@NEON_CFLAGS@",      "e" );
+ToFile( "SYSTEM_AGG",	     "@SYSTEM_AGG@",       "e" );
 ToFile( "BUILD_DMAKE",       "@BUILD_DMAKE@",      "e" );
 ToFile( "USE_XINERAMA",      "@USE_XINERAMA@",     "e" );
 ToFile( "XINERAMA_LINK",     "@XINERAMA_LINK@",    "e" );
Index: prj/build.lst
===================================================================
RCS file: /cvs/gsl/canvas/prj/build.lst,v
retrieving revision 1.6
diff -u -u -r1.6 build.lst
--- canvas/prj/build.lst	2 Nov 2005 12:46:09 -0000	1.6
+++ canvas/prj/build.lst	22 Nov 2005 23:00:09 -0000
@@ -1,4 +1,4 @@
-uc	canvas	:	javaunohelper comphelper cppuhelper offuh unoil tools goodies vcl agg basegfx NULL
+uc	canvas	:	javaunohelper comphelper cppuhelper offuh unoil tools goodies vcl AGG:agg basegfx NULL
 uc	canvas											 usr1	-	all	uc_mkout NULL
 uc	canvas\source\tools								 nmake	-	all uc_tools NULL
 uc	canvas\source\vcl								 nmake	-	all	uc_vcl uc_tools NULL
Index: prj/d.lst
===================================================================
RCS file: /cvs/external/agg/prj/d.lst,v
retrieving revision 1.2
diff -u -u -r1.2 d.lst
--- agg/prj/d.lst	4 Nov 2005 08:30:48 -0000	1.2
+++ agg/prj/d.lst	23 Nov 2005 08:25:38 -0000
@@ -6,4 +6,6 @@
 ..\%__SRC%\lib\*.a %_DEST%\lib%_EXT%\*.a
 ..\%__SRC%\lib\*.dylib %_DEST%\lib%_EXT%\*.dylib
 
-..\inc\*.h %_DEST%\inc%_EXT%\agg
+mkdir: %_DEST%\inc%_EXT%\agg2
+..\inc\*.h %_DEST%\inc%_EXT%\agg2
+
