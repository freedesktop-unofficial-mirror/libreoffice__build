diff -Nur config_office.orig/configure.in config_office/configure.in
--- config_office.orig/configure.in	2006-04-27 17:30:12.000000000 +0200
+++ config_office/configure.in	2006-04-27 18:08:05.000000000 +0200
@@ -3108,6 +3108,8 @@
 
     if $PKG_CONFIG --exists nspr ; then
       PKG_CHECK_MODULES( MOZ_NSPR, nspr )
+      NSPR_LIB="-L`$PKG_CONFIG --variable=libdir nspr`"
+      AC_SUBST(NSPR_LIB)
     else
       PKG_CHECK_MODULES( MOZ_NSPR, mozilla-nspr )
     fi
@@ -3115,6 +3117,9 @@
     PKG_CHECK_MODULES( MOZ_NSS, nss, STANDALONENSS="TRUE", STANDALONENSS="" )
     if test -z "$STANDALONENSS"; then
         PKG_CHECK_MODULES( MOZ_NSS, $moz_flavour-nss )
+    else
+        NSS_LIB="-L`$PKG_CONFIG --variable=libdir nss`"
+        AC_SUBST(NSS_LIB)
     fi
 
     save_CPPFLAGS="$CPPFLAGS"
diff -Nur config_office.orig/set_soenv.in config_office/set_soenv.in
--- config_office.orig/set_soenv.in	2006-04-29 17:31:15.000000000 +0200
+++ config_office/set_soenv.in	2006-04-29 17:33:27.000000000 +0200
@@ -1713,6 +1713,8 @@
 ToFile( "WITH_OPENLDAP",     "@WITH_OPENLDAP@",    "e" );
 ToFile( "WITH_MOZILLA",      "@WITH_MOZILLA@",     "e" );
 ToFile( "SYSTEM_MOZILLA",    "@SYSTEM_MOZILLA@",   "e" );
+ToFile( "NSPR_LIB",          "@NSPR_LIB@",         "e" );
+ToFile( "NSS_LIB",           "@NSS_LIB@",          "e" );
 ToFile( "MOZ_INC",           "@MOZ_INC@",          "e" );
 ToFile( "MOZ_LIB",           "@MOZ_LIB@",          "e" );
 ToFile( "MOZ_LIB_XPCOM",     "@MOZ_LIB_XPCOM@",    "e" );
diff -Nur xmlsecurity.orig/util/makefile.mk xmlsecurity/util/makefile.mk
--- xmlsecurity.orig/util/makefile.mk	2006-04-27 17:30:05.000000000 +0200
+++ xmlsecurity/util/makefile.mk	2006-04-27 18:22:18.000000000 +0200
@@ -108,6 +108,15 @@
 	$(CPPUHELPERLIB)	\
 	$(XMLOFFLIB)
 
+.IF "$(SYSTEM_MOZILLA)" == "YES"
+.IF "$(NSPR_LIB)" != ""
+SHL2STDLIBS += $(NSPR_LIB)
+.ENDIF
+.IF "$(NSS_LIB)" != ""
+SHL2STDLIBS += $(NSS_LIB)
+.ENDIF
+.ENDIF
+
 .IF "$(CRYPTO_ENGINE)" == "mscrypto"
 SHL2STDLIBS+= $(MSCRYPTOLIBS)
 .ELSE
