diff --git a/config_office/configure.in b/config_office/configure.in
index a402135..0f084df 100644
--- config_office/configure.in
+++ config_office/configure.in
@@ -230,6 +230,9 @@ AC_ARG_ENABLE(static-gtk,
                           the static libraries instead of the dynamic ones. 
                           (enables -Bstatic linker flag for gtk libraries)
 ],,)
+AC_ARG_ENABLE(layout,
+[  --enable-layout         Enable the compilation and use of layout dialogs
+],,)
 AC_ARG_ENABLE(build-mozilla,
 [  --disable-build-mozilla Use this option if you do not want to build the
                           mozilla components from the mozilla source code but
@@ -6019,6 +6022,16 @@ else
 fi
 AC_SUBST(ENABLE_STATIC_GTK)
 
+AC_MSG_CHECKING([whether to use layout dialogs])
+if test -n "$enable_layout" && test "$enable_layout" != "no"; then
+   ENABLE_LAYOUT="TRUE"
+   AC_MSG_RESULT([yes])
+else
+   ENABLE_LAYOUT="FALSE"	
+   AC_MSG_RESULT([no])
+fi
+AC_SUBST(ENABLE_LAYOUT)
+
 dnl ===================================================================
 dnl Setting up the environment.
 dnl ===================================================================
diff --git a/config_office/set_soenv.in b/config_office/set_soenv.in
index 6d696e4..5df58ea 100644
--- config_office/set_soenv.in
+++ config_office/set_soenv.in
@@ -1795,6 +1795,7 @@ ToFile( "MKDEPENDSOLVER",    "TRUE",             "e" );
 # (c = comment, e = environment variable, a = alias )
 ToFile( "Platform dependent constant values.", $empty, "c" );
 ToFile( "SOLAR_JAVA",        $SOLAR_JAVA,        "e" );
+ToFile( "ENABLE_LAYOUT",       "@ENABLE_LAYOUT@",    "e" );
 ToFile( "ENABLE_MONO",       "@ENABLE_MONO@",    "e" );
 ToFile( "ENABLE_MONO_CLIMAKER",       "@ENABLE_MONO_CLIMAKER@",    "e" );
 ToFile( "CSC",               "@CSC@",            "e" );
diff --git a/scp2/prj/build.lst b/scp2/prj/build.lst
index 61f5aa0..2fb7334 100644
--- scp2/prj/build.lst
+++ scp2/prj/build.lst
@@ -12,6 +12,7 @@ cp    scp2\source\graphicfilter   nmake    -    all    cp_graphicfilter cp_langm
 cp    scp2\source\impress         nmake    -    all    cp_impress cp_langmacros NULL
 cp    scp2\source\javafilter      nmake    -    all    cp_javafilter cp_langmacros NULL
 cp    scp2\source\kde             nmake    -    all    cp_kde cp_langmacros NULL
+cp    scp2\source\layout          nmake    -    all    cp_layout cp_langmacros NULL
 cp    scp2\source\lingu           nmake    -    all    cp_lingu cp_langmacros NULL
 cp    scp2\source\math            nmake    -    all    cp_math cp_langmacros NULL
 cp    scp2\source\ooo             nmake    -    all    cp_ooo cp_langmacros NULL
@@ -26,4 +27,4 @@ cp    scp2\source\winexplorerext  nmake    -    all    cp_winexplorerext cp_lang
 cp    scp2\source\ure             nmake    -    all    cp_ure cp_langmacros NULL
 cp    scp2\source\onlineupdate    nmake    -    all    cp_update cp_langmacros NULL
 cp    scp2\source\ooo_wo_ure      nmake    -    all    cp_ooo_wo_ure cp_langmacros NULL
-cp    scp2\util                   nmake    -    all    cp_util cp_activex cp_calc cp_canvas cp_crashrep cp_draw cp_gnome cp_graphicfilter cp_impress cp_javafilter cp_kde cp_lingu cp_math cp_ooo cp_python cp_quickstart cp_testtool cp_writer cp_base cp_xsltfilter cp_winexplorerext cp_ure cp_sdkoo cp_update cp_ooo_wo_ure NULL
+cp    scp2\util                   nmake    -    all    cp_util cp_activex cp_calc cp_canvas cp_crashrep cp_draw cp_gnome cp_graphicfilter cp_impress cp_javafilter cp_kde cp_layout cp_lingu cp_math cp_ooo cp_python cp_quickstart cp_testtool cp_writer cp_base cp_xsltfilter cp_winexplorerext cp_ure cp_sdkoo cp_update cp_ooo_wo_ure NULL
diff --git a/scp2/source/layout/layout.scp b/scp2/source/layout/layout.scp
new file mode 100644
index 0000000..f7a59e1
--- /dev/null
+++ scp2/source/layout/layout.scp
@@ -0,0 +1,117 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: layout.scp,v $
+ *
+ *  $Revision: 1.3 $
+ *
+ *  last change: $Author: kz $ $Date: 2006/12/13 16:12:23 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+************************************************************************/
+
+#include "macros.inc"
+
+File gid_File_Lib_Layout
+    TXT_FILE_BODY;
+    Styles = (PACKED,UNO_COMPONENT);
+    RegistryID = gid_Starregistry_Services_Rdb;
+    Dir = gid_Dir_Program;
+  #ifdef UNX
+    Name = STRING(CONCAT4(liblayout,OFFICEUPD,DLLPOSTFIX,UNXSUFFIX));
+  #else
+    Name = STRING(CONCAT4(layout,OFFICEUPD,DLLPOSTFIX,.dll));
+  #endif
+End
+
+Directory gid_Dir_Share_Layout
+    ParentID = gid_Dir_Share;
+    DosName = "layout";
+End
+
+File gid_File_Xml_Wordcount
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout;
+   Name = "wordcount.xml";
+   Styles = (PACKED);
+End
+
+File gid_File_Xml_Zoom
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout;
+   Name = "zoom.xml";
+   Styles = (PACKED);
+End
+
+Directory gid_Dir_Share_Layout_De
+    ParentID = gid_Dir_Share_Layout;
+    DosName = "de";
+End
+
+File gid_File_Xml_Wordcount_De
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout_De;
+   Name = "de/wordcount.xml";
+   Styles = (PACKED);
+End
+
+File gid_File_Xml_Zoom_De
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout_De;
+   Name = "de/zoom.xml";
+   Styles = (PACKED);
+End
+
+Directory gid_Dir_Share_Layout_Nl
+    ParentID = gid_Dir_Share_Layout;
+    DosName = "nl";
+End
+
+File gid_File_Xml_Wordcount_Nl
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout_Nl;
+   Name = "nl/wordcount.xml";
+   Styles = (PACKED);
+End
+
+File gid_File_Xml_Zoom_Nl
+   TXT_FILE_BODY;
+   Dir = gid_Dir_Share_Layout_Nl;
+   Name = "nl/zoom.xml";
+   Styles = (PACKED);
+End
+
+//  Do we need this?
+//  Must MODULE_OPTIONAL_LAYOUT be registered somewhere?
+//
+// Module gid_Module_Layout
+//    MOD_NAME_DESC (MODULE_OPTIONAL_LAYOUT);
+//    ParentID = gid_Module_Optional;
+//    Files = (gid_File_Lib_Layout,gid_File_Xml_Wordcount,gid_File_Xml_Zoom);
+//    Minimal = NO;
+//    Default = YES;
+//    Styles = ();
+// End
diff --git a/scp2/source/layout/makefile.mk b/scp2/source/layout/makefile.mk
new file mode 100644
index 0000000..53c2ba3
--- /dev/null
+++ scp2/source/layout/makefile.mk
@@ -0,0 +1,58 @@
+#*************************************************************************
+#
+#   OpenOffice.org - a multi-platform office productivity suite
+#
+#   $RCSfile: makefile.mk,v $
+#
+#   $Revision: 1.5 $
+#
+#   last change: $Author: ihi $ $Date: 2006/08/04 13:34:40 $
+#
+#   The Contents of this file are made available subject to
+#   the terms of GNU Lesser General Public License Version 2.1.
+#
+#
+#     GNU Lesser General Public License Version 2.1
+#     =============================================
+#     Copyright 2005 by Sun Microsystems, Inc.
+#     901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#     This library is free software; you can redistribute it and/or
+#     modify it under the terms of the GNU Lesser General Public
+#     License version 2.1, as published by the Free Software Foundation.
+#
+#     This library is distributed in the hope that it will be useful,
+#     but WITHOUT ANY WARRANTY; without even the implied warranty of
+#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#     Lesser General Public License for more details.
+#
+#     You should have received a copy of the GNU Lesser General Public
+#     License along with this library; if not, write to the Free Software
+#     Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#     MA  02111-1307  USA
+#
+#*************************************************************************
+
+PRJ=..$/..
+
+PRJPCH=
+
+PRJNAME=scp2
+TARGET=layout
+TARGETTYPE=CUI
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :	settings.mk
+
+SCP_PRODUCT_TYPE=osl
+
+PARFILES=
+
+.IF "$(ENABLE_LAYOUT)" == "TRUE"
+PARFILES+= layout.par
+.ENDIF # ENABLE_LAYOUT == TRUE
+
+# --- File ---------------------------------------------------------
+
+.INCLUDE :  target.mk
diff --git a/scp2/util/makefile.mk b/scp2/util/makefile.mk
index d3a9e9a..1fcb482 100644
--- scp2/util/makefile.mk
+++ scp2/util/makefile.mk
@@ -178,6 +178,10 @@ SCP1FILES += \
 SCP1FILES += cairocanvas.par
 .ENDIF
 
+.IF "$(ENABLE_LAYOUT)" == "TRUE"
+SCP1FILES += layout.par
+.ENDIF # ENABLE_LAYOUT == TRUE
+
 .IF "$(BUILD_SPECIAL)"!=""
 SCP1FILES += \
              module_onlineupdate.par   \
@@ -314,6 +318,10 @@ SCP2FILES += \
 SCP2FILES += \
              vclcanvas.par
 
+.IF "$(ENABLE_LAYOUT)" == "TRUE"
+SCP2FILES += layout.par
+.ENDIF # ENABLE_LAYOUT == TRUE
+
 .IF "$(BUILD_SPECIAL)"!=""
 SCP2FILES += \
              module_onlineupdate.par   \
