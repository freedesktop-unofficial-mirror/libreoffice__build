Index: sc/source/core/tool/interpr1.cxx
===================================================================
diff -u -w -p -r1.34 interpr1.cxx
--- sc/source/core/tool/interpr1.cxx       29 Mar 2005 13:32:52 -0000      1.34
+++ sc/source/core/tool/interpr1.cxx       13 Jun 2005 16:39:00 -0000
@@ -3262,7 +3262,24 @@ void ScInterpreter::ScColumn()
 	{
 		double nVal;
 		if (nParamCount == 0)
+        {
 			nVal = aPos.Col() + 1;
+            if (bMatrixFormula)
+            {
+                SCCOL nCols;
+                SCROW nRows;
+                pMyFormulaCell->GetMatColsRows( nCols, nRows);
+                ScMatrixRef pResMat = GetNewMat( static_cast<SCSIZE>(nCols), static_cast<SCSIZE>(nRows));
+                if (pResMat)
+                {
+                    for (SCSIZE i=0; i < nCols; i++)
+                        for (SCSIZE j=0; j < nRows; j++)
+                            pResMat->PutDouble( nVal + i, i, j);
+                    PushMatrix( pResMat);
+                    return;
+                }
+            }
+        }
 		else
 		{
 			switch ( GetStackType() )
@@ -3321,7 +3337,24 @@ void ScInterpreter::ScRow()
 	{
 		double nVal;
 		if (nParamCount == 0)
+        {
 			nVal = aPos.Row() + 1;
+            if (bMatrixFormula)
+            {
+                SCCOL nCols;
+                SCROW nRows;
+                pMyFormulaCell->GetMatColsRows( nCols, nRows);
+                ScMatrixRef pResMat = GetNewMat( static_cast<SCSIZE>(nCols), static_cast<SCSIZE>(nRows));
+                if (pResMat)
+                {
+                    for (SCSIZE i=0; i < nRows; i++)
+                        for (SCSIZE j=0; j < nCols; j++)
+                            pResMat->PutDouble( nVal + i, j, i);
+                    PushMatrix( pResMat);
+                    return;
+                }
+            }
+        }
 		else
 		{
 			switch ( GetStackType() )
