? i18npool/i18npool.vpj
Index: i18npool/source/transliteration/transliterationImpl.cxx
===================================================================
RCS file: /cvs/l10n/i18npool/source/transliteration/transliterationImpl.cxx,v
retrieving revision 1.15
diff -u -r1.15 transliterationImpl.cxx
--- i18npool/source/transliteration/transliterationImpl.cxx	17 Sep 2006 09:31:51 -0000	1.15
+++ i18npool/source/transliteration/transliterationImpl.cxx	20 Aug 2007 18:35:39 -0000
@@ -599,6 +599,18 @@
 static void SAL_CALL loadBody( Reference<XMultiServiceFactory>& xSMgr, OUString &implName, 
                         Reference<XExtendedTransliteration>& body) throw(RuntimeException)
 {
+    // Cache the last body to avoid redundant, and expensive looping.
+    static struct {
+        OUString Name;
+        Reference<XExtendedTransliteration> Body;
+    } lastBody;
+
+    if (implName.equals(lastBody.Name))
+    {
+        body = lastBody.Body;
+        return;
+    }
+
     Reference< XContentEnumerationAccess > xEnumAccess( xSMgr, UNO_QUERY );
     Reference< XEnumeration > xEnum(xEnumAccess->createContentEnumeration(
                                     OUString::createFromAscii(TRLT_SERVICELNAME_L10N)));
@@ -615,6 +627,8 @@
                             a = xI->queryInterface(::getCppuType((
                                         const Reference<XExtendedTransliteration>*)0));
                             a >>= body;
+                            lastBody.Name = implName;
+                            lastBody.Body = body;
                             return;
                         }
                     }
