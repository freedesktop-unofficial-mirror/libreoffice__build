--- dbaccess/source/ui/app/AppController.cxx.kab~	2005-04-06 11:40:09.000000000 +0000
+++ dbaccess/source/ui/app/AppController.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -801,7 +801,7 @@
 				{
 					static ODsnTypeCollection aTypeCollection;
 					DATASOURCE_TYPE eType = aTypeCollection.getType(::comphelper::getString(m_xDataSource->getPropertyValue(PROPERTY_URL)));
-					aReturn.bEnabled = DST_EMBEDDED != eType && DST_MOZILLA != eType && DST_EVOLUTION != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
+					aReturn.bEnabled = DST_EMBEDDED != eType && DST_MOZILLA != eType && DST_EVOLUTION != eType && DST_KAB != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
 				}
 				break;
 			case SID_DB_APP_DSCONNECTION_TYPE:
@@ -816,7 +816,7 @@
 				if ( aReturn.bEnabled = m_xDataSource.is() )
 				{
 					DATASOURCE_TYPE eType = m_aTypeCollection.getType(::comphelper::getString(m_xDataSource->getPropertyValue(PROPERTY_URL)));
-					aReturn.bEnabled = DST_EMBEDDED != eType && DST_LDAP != eType && DST_CALC != eType && DST_MOZILLA != eType && DST_THUNDERBIRD != eType && DST_EVOLUTION != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
+					aReturn.bEnabled = DST_EMBEDDED != eType && DST_LDAP != eType && DST_CALC != eType && DST_MOZILLA != eType && DST_THUNDERBIRD != eType && DST_EVOLUTION != eType && DST_KAB != eType && DST_OUTLOOK != eType && DST_OUTLOOKEXP != eType;
 				}
 				break;
 			case SID_DB_APP_CONVERTTOVIEW:
--- dbaccess/source/ui/dlg/dbadmin2.src.kab~	2005-02-21 12:43:11.000000000 +0000
+++ dbaccess/source/ui/dlg/dbadmin2.src	2005-08-22 11:41:30.000000000 +0000
@@ -133,6 +133,11 @@
 	Text [ de ] ="Evolution address book";
 	Text[ en-US ] = "Evolution address book";
 };
+String STR_ADDRESSBOOK_KAB
+{
+	Text [ de ] ="KDE address book";
+	Text[ en-US ] = "KDE address book";
+};
 String STR_ADDRESSBOOK_LDAP
 {
 	Text [ de ] ="LDAP Adressbuch";
--- dbaccess/source/ui/dlg/dbwizsetup.cxx.kab~	2005-08-22 11:36:41.000000000 +0000
+++ dbaccess/source/ui/dlg/dbwizsetup.cxx	2005-08-22 11:43:26.000000000 +0000
@@ -266,13 +266,14 @@
 #define SPREADSHEET_PATH       12
 #define OUTLOOKEXP_PATH        13
 #define OUTLOOK_PATH           14
-#define MOZILLA_PATH           15
-#define EVOLUTION_PATH         16
-#define THUNDERBIRD_PATH       17
-#define CREATENEW_PATH         18
-#define USERDEFINED_PATH       19
-#define OPEN_DOC_PATH          20
-#define EVOLUTION_PATH_LOCAL   21
+#define KAB_PATH               15
+#define MOZILLA_PATH           16
+#define EVOLUTION_PATH         17
+#define THUNDERBIRD_PATH       18
+#define CREATENEW_PATH         19
+#define USERDEFINED_PATH       20
+#define OPEN_DOC_PATH          21
+#define EVOLUTION_PATH_LOCAL   22
 
 OFinalDBPageSetup*          pFinalPage;
 
@@ -428,6 +429,11 @@
     else
         declarePath( EVOLUTION_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
 
+if ( m_pCollection->hasAuthentication(DST_KAB))
+	declarePath( KAB_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_AUTHENTIFICATION, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
+else
+	declarePath( KAB_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
+
 	if ( m_pCollection->hasAuthentication(m_pCollection->getEmbeddedDatabaseType(getORB())))
         declarePath( CREATENEW_PATH, PAGE_DBSETUPWIZARD_INTRO, PAGE_DBSETUPWIZARD_AUTHENTIFICATION, PAGE_DBSETUPWIZARD_FINAL, WZS_INVALID_STATE);
     else
@@ -566,6 +572,7 @@
             { DST_MSACCESS,     MSACCESS_PATH       },
             { DST_OUTLOOKEXP,   OUTLOOKEXP_PATH     },
             { DST_OUTLOOK,      OUTLOOK_PATH        },
+	    { DST_KAB,		KAB_PATH            },
             { DST_MOZILLA,      MOZILLA_PATH        },
             { DST_THUNDERBIRD,  THUNDERBIRD_PATH    },
             { DST_EVOLUTION,    EVOLUTION_PATH      },
@@ -641,6 +648,7 @@
 	DATASOURCE_TYPE eType = getDatasourceType(*m_pOutSet);
 	switch ( m_eType )
     {
+		case DST_KAB:
         case DST_EVOLUTION:
         case DST_EVOLUTION_LOCAL:
         case DST_EVOLUTION_LDAP:
--- dbaccess/source/ui/dlg/AdabasStatDlg.cxx.kab~	2005-06-30 16:30:03.000000000 +0000
+++ dbaccess/source/ui/dlg/AdabasStatDlg.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -153,6 +153,7 @@
 			case DST_MOZILLA: 
 			case DST_THUNDERBIRD:
 			case DST_EVOLUTION: 
+			case DST_KAB: 
 			case DST_OUTLOOK	: 
 			case DST_OUTLOOKEXP:
 			case DST_JDBC:
--- dbaccess/source/ui/dlg/AdvancedPageDlg.cxx.kab~	2005-06-30 16:30:21.000000000 +0000
+++ dbaccess/source/ui/dlg/AdvancedPageDlg.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -165,6 +165,7 @@
 			case DST_MOZILLA: 
 			case DST_THUNDERBIRD:
 			case DST_EVOLUTION: 
+			case DST_KAB: 
 			case DST_OUTLOOK	: 
 			case DST_OUTLOOKEXP:
 				break;
--- dbaccess/source/ui/dlg/ConnectionPage.cxx.kab~	2005-03-18 10:09:18.000000000 +0000
+++ dbaccess/source/ui/dlg/ConnectionPage.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -323,6 +323,7 @@
 			case DST_OUTLOOK:
 			case DST_OUTLOOKEXP:
 			case DST_EVOLUTION:
+			case DST_KAB:
                 m_aFT_Connection.SetText(String(ModuleRes(STR_NO_ADDITIONAL_SETTINGS)));
 				{
 					String sText = m_aFT_Connection.GetText();
--- dbaccess/source/ui/dlg/DriverSettings.cxx.kab~	2005-02-21 12:41:35.000000000 +0000
+++ dbaccess/source/ui/dlg/DriverSettings.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -174,6 +174,9 @@
 		case DST_EVOLUTION: 
 			_rDetailsIds.push_back(DSID_DOSLINEENDS);
 			break;
+		case DST_KAB: 
+			_rDetailsIds.push_back(DSID_DOSLINEENDS);
+			break;
 		case DST_OUTLOOK: 
 			_rDetailsIds.push_back(DSID_DOSLINEENDS);
 			break;
--- dbaccess/source/ui/dlg/dbwiz.cxx.kab~	2005-06-30 16:32:42.000000000 +0000
+++ dbaccess/source/ui/dlg/dbwiz.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -206,6 +206,7 @@
 		case DST_OUTLOOK:
 		case DST_OUTLOOKEXP:
 		case DST_EVOLUTION:
+		case DST_KAB:
             enableButtons(WZB_NEXT,sal_False);
 			enableButtons(WZB_FINISH,sal_True);
 			break;
@@ -229,6 +230,7 @@
 				case DST_OUTLOOK:
 				case DST_OUTLOOKEXP:
 				case DST_EVOLUTION:
+				case DST_KAB:
 					nNextState = WZS_INVALID_STATE;
 					break;
                 default:
@@ -244,6 +246,7 @@
 				case DST_OUTLOOK:
 				case DST_OUTLOOKEXP:
 				case DST_EVOLUTION:
+				case DST_KAB:
 				case DST_MSACCESS:
 				case DST_JDBC:
 				case DST_CALC:
--- dbaccess/source/ui/inc/dbu_dlg.hrc.kab~	2005-06-30 16:33:57.000000000 +0000
+++ dbaccess/source/ui/inc/dbu_dlg.hrc	2005-08-22 11:41:30.000000000 +0000
@@ -108,28 +108,29 @@
 #define STR_ADDRESSBOOK_SYSTEM				RID_STR_DLG_START + 17
 #define STR_ADDRESSBOOK_MOZILLA				RID_STR_DLG_START + 18
 #define STR_ADDRESSBOOK_EVOLUTION			RID_STR_DLG_START + 19
-#define STR_ADDRESSBOOK_LDAP				RID_STR_DLG_START + 20
-#define STR_ADDRESSBOOK_OUTLOOK				RID_STR_DLG_START + 21
-#define STR_COMMAND_EXECUTED_SUCCESSFULLY	RID_STR_DLG_START + 22
-#define STR_DIRECTSQL_CONNECTIONLOST		RID_STR_DLG_START + 23
+#define STR_ADDRESSBOOK_KAB					RID_STR_DLG_START + 20
+#define STR_ADDRESSBOOK_LDAP				RID_STR_DLG_START + 21
+#define STR_ADDRESSBOOK_OUTLOOK				RID_STR_DLG_START + 22
+#define STR_COMMAND_EXECUTED_SUCCESSFULLY	RID_STR_DLG_START + 23
+#define STR_DIRECTSQL_CONNECTIONLOST		RID_STR_DLG_START + 24
     // FREE
-#define STR_HINT_READONLY_CONNECTION		RID_STR_DLG_START + 25
-#define STR_HINT_CONNECTION_NOT_CAPABLE		RID_STR_DLG_START + 26
-#define STR_USERADMIN_NOT_AVAILABLE			RID_STR_DLG_START + 27
-#define STR_TAB_INDEX_SORTORDER				RID_STR_DLG_START + 28
-#define STR_TAB_INDEX_FIELD					RID_STR_DLG_START + 29
-#define STR_ORDER_ASCENDING					RID_STR_DLG_START + 30
-#define STR_ORDER_DESCENDING				RID_STR_DLG_START + 31
-#define STR_CONFIRM_DROP_INDEX				RID_STR_DLG_START + 32
-#define STR_LOGICAL_INDEX_NAME				RID_STR_DLG_START + 33
-#define STR_CONNECTION_TEST					RID_STR_DLG_START + 34
-#define STR_CONNECTION_SUCCESS				RID_STR_DLG_START + 35
-#define STR_JDBCDRIVER_TEST					RID_STR_DLG_START + 36
-#define STR_JDBCDRIVER_SUCCESS				RID_STR_DLG_START + 37
-#define STR_JDBCDRIVER_NO_SUCCESS			RID_STR_DLG_START + 38
-#define STR_MSACCESS_FILTERNAME				RID_STR_DLG_START + 39
-#define STR_CONNECTION_NO_SUCCESS			RID_STR_DLG_START + 40
-#define STR_DBASE_PATH_OR_FILE				RID_STR_DLG_START + 41
+#define STR_HINT_READONLY_CONNECTION		RID_STR_DLG_START + 26
+#define STR_HINT_CONNECTION_NOT_CAPABLE		RID_STR_DLG_START + 27
+#define STR_USERADMIN_NOT_AVAILABLE			RID_STR_DLG_START + 28
+#define STR_TAB_INDEX_SORTORDER				RID_STR_DLG_START + 29
+#define STR_TAB_INDEX_FIELD					RID_STR_DLG_START + 30
+#define STR_ORDER_ASCENDING					RID_STR_DLG_START + 31
+#define STR_ORDER_DESCENDING				RID_STR_DLG_START + 32
+#define STR_CONFIRM_DROP_INDEX				RID_STR_DLG_START + 33
+#define STR_LOGICAL_INDEX_NAME				RID_STR_DLG_START + 34
+#define STR_CONNECTION_TEST					RID_STR_DLG_START + 35
+#define STR_CONNECTION_SUCCESS				RID_STR_DLG_START + 36
+#define STR_JDBCDRIVER_TEST					RID_STR_DLG_START + 37
+#define STR_JDBCDRIVER_SUCCESS				RID_STR_DLG_START + 38
+#define STR_JDBCDRIVER_NO_SUCCESS			RID_STR_DLG_START + 39
+#define STR_MSACCESS_FILTERNAME				RID_STR_DLG_START + 40
+#define STR_CONNECTION_NO_SUCCESS			RID_STR_DLG_START + 41
+#define STR_DBASE_PATH_OR_FILE				RID_STR_DLG_START + 42
 #define STR_TEXT_PATH_OR_FILE				RID_STR_DLG_START + 45
 #define STR_FLAT_PATH_OR_FILE				RID_STR_DLG_START + 46
 #define STR_CALC_PATH_OR_FILE				RID_STR_DLG_START + 47
--- dbaccess/source/ui/inc/dsntypes.hxx.kab~	2005-08-22 11:36:41.000000000 +0000
+++ dbaccess/source/ui/inc/dsntypes.hxx	2005-08-22 11:44:31.000000000 +0000
@@ -98,11 +98,12 @@
 	DST_LDAP		=	13,	
 	DST_OUTLOOK		=	14,	
 	DST_OUTLOOKEXP	=	15,	
-	DST_EVOLUTION	=	16,
-	DST_EMBEDDED	=	17,
- 	DST_THUNDERBIRD	=	18,	
-	DST_EVOLUTION_LOCAL =   19,
-	DST_EVOLUTION_LDAP  =   20,
+	DST_KAB		=	16,
+	DST_EVOLUTION	=	17,
+	DST_EMBEDDED	=	18,
+ 	DST_THUNDERBIRD	=	19,	
+	DST_EVOLUTION_LOCAL =   20,
+	DST_EVOLUTION_LDAP  =   21,
 
 	DST_USERDEFINE1,	/// first user defined driver
 	DST_USERDEFINE2,
--- dbaccess/source/ui/misc/dbumiscres.src.kab~	2005-08-22 11:40:22.000000000 +0000
+++ dbaccess/source/ui/misc/dbumiscres.src	2005-08-22 11:45:37.000000000 +0000
@@ -146,6 +146,10 @@
         {
                 Text  ="sdbc:address:evolution:groupwise";
 	};	
+	String STR_KAB
+	{
+		Text  ="sdbc:address:kab";
+	};
 	String STR_EMBEDDED
 	{
 		Text = "sdbc:embedded:";
@@ -230,6 +234,11 @@
 		Text [ de ] = "Microsoft Windows Adressbuch";
 		Text[ en-US ] = "Microsoft Windows Address Book";
 	};
+	String STR_KAB
+	{
+		Text [ de ] = "KDE Adressbuch";
+		Text[ en-US ] = "KDE Address Book";
+	};
         String STR_EVOLUTION_LOCAL
         {
                 Text [ de ] = "Evolution Local Adressbuch";
--- dbaccess/source/ui/misc/dbumiscres.hrc.kab~	2005-08-22 11:36:41.000000000 +0000
+++ dbaccess/source/ui/misc/dbumiscres.hrc	2005-08-22 11:46:19.000000000 +0000
@@ -80,11 +80,12 @@
 #define STR_LDAP				13
 #define STR_OUTLOOK				14
 #define STR_OUTLOOKEXP			15
-#define STR_EVOLUTION_GROUPWISE			16 
-#define STR_EMBEDDED			17
-#define STR_THUNDERBIRD			18
-#define STR_EVOLUTION_LOCAL             19
-#define STR_EVOLUTION_LDAP              20
+#define STR_KAB				16
+#define STR_EVOLUTION_GROUPWISE		17 
+#define STR_EMBEDDED			18
+#define STR_THUNDERBIRD			19
+#define STR_EVOLUTION_LOCAL             20
+#define STR_EVOLUTION_LDAP              21
 #define STR_END					STR_EVOLUTION_LDAP + 1
 
 #endif // _DBU_MISCRES_HRC_
--- dbaccess/source/ui/misc/dsntypes.cxx.kab~	2005-08-22 11:40:22.000000000 +0000
+++ dbaccess/source/ui/misc/dsntypes.cxx	2005-08-22 11:48:32.000000000 +0000
@@ -412,6 +412,7 @@
 			case DST_OUTLOOK:
 			case DST_OUTLOOKEXP:
 			case DST_FLAT:
+			case DST_KAB:
 			case DST_EVOLUTION_LDAP:
             		case DST_EVOLUTION:
 			case DST_EVOLUTION_LOCAL:
@@ -459,6 +460,7 @@
 		case DST_OUTLOOK:
 		case DST_OUTLOOKEXP:
 		case DST_JDBC:
+		case DST_KAB:
                 case DST_EVOLUTION_LDAP:
                 case DST_EVOLUTION:
                 case DST_EVOLUTION_LOCAL:
@@ -503,6 +505,7 @@
 		case DST_MOZILLA:
 		case DST_THUNDERBIRD:
 		case DST_EVOLUTION_LOCAL:
+		case DST_KAB:
 		case DST_OUTLOOK:
         case DST_OUTLOOKEXP: //????
 		case DST_DBASE:
@@ -577,6 +580,8 @@
 			return DST_THUNDERBIRD;
 		if (_rDsn.EqualsIgnoreCaseAscii("ldap:", nSeparator,_rDsn.Len() - nSeparator))
 			return DST_LDAP;
+		if (_rDsn.EqualsIgnoreCaseAscii("kab", nSeparator, _rDsn.Len() - nSeparator))
+			return DST_KAB;
 		if (_rDsn.EqualsIgnoreCaseAscii("outlook", nSeparator,_rDsn.Len() - nSeparator))
 			return DST_OUTLOOK;
 		if (_rDsn.EqualsIgnoreCaseAscii("outlookexp", nSeparator,_rDsn.Len() - nSeparator))
--- connectivity/prj/build.lst.kab~	2005-08-22 11:40:22.000000000 +0000
+++ connectivity/prj/build.lst	2005-08-22 11:41:30.000000000 +0000
@@ -11,6 +11,7 @@
 cn	connectivity\source\drivers\mozab\bootstrap	nmake	-	all	cn_mozab_bootstrap NULL
 cn	connectivity\source\drivers\mozab\mozillasrc	nmake	-	all	cn_mozab_mozillasrc cn_file NULL
 cn	connectivity\source\drivers\mozab		nmake	-	all	cn_mozab cn_mozab_bootstrap cn_mozab_mozillasrc cn_dbtools NULL
+cn	connectivity\source\drivers\kab			nmake	-	all	cn_kab cn_dbtools NULL
 cn	connectivity\source\drivers\evoab		nmake	-	all	cn_evoab cn_dbtools cn_file NULL
 cn	connectivity\source\drivers\evoab2		nmake	-	all	cn_evoab2 cn_dbtools cn_file NULL
 cn	connectivity\source\drivers\calc		nmake	-	all	cn_calc cn_file NULL
--- connectivity/prj/d.lst.kab~	2005-08-22 11:40:22.000000000 +0000
+++ connectivity/prj/d.lst	2005-08-22 11:41:30.000000000 +0000
@@ -6,6 +6,7 @@
 ..\source\cpool\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\adabas\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\ado\*.xml %_DEST%\xml%_EXT%\*.xml
+..\source\drivers\kab\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\file\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\flat\*.xml %_DEST%\xml%_EXT%\*.xml
 ..\source\drivers\dbase\*.xml %_DEST%\xml%_EXT%\*.xml
--- connectivity/version.mk.kab~	2004-11-09 12:05:23.000000000 +0000
+++ connectivity/version.mk	2005-08-22 11:41:30.000000000 +0000
@@ -255,6 +255,22 @@
 
 EVOAB=$(EVOAB_TARGET_TARGET)_$(CMPEXT)
 
+# ----------------------------Kab settings-------------------------------------#
+# target
+KAB_TARGET=kab
+
+# the major 
+KAB_MAJOR=1
+# the minor 
+KAB_MINOR=0
+# the micro 
+KAB_MICRO=0
+
+# this is a c++ compatible library 
+KAB_CPP=1
+
+KAB=$(KAB_TARGET_TARGET)_$(CMPEXT)
+
 # ----------------------------HSQLDB settings-----------------------------------#
 # target
 HSQLDB_TARGET=hsqldb
--- extensions/source/abpilot/abspilot.src.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/abspilot.src	2005-08-22 11:51:43.000000000 +0000
@@ -148,9 +148,18 @@
 		Text [ en-US ] = "Please select the type of your external address book:";
 	};
 
+	RadioButton RB_KAB
+	{
+		Pos	= MAP_APPFONT ( 15, 79 ) ;
+		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
+
+		Text [ de ] = "KDE Adressbuch";
+		Text [ en-US ] = "KDE address book";
+	};
+
         RadioButton RB_GROUPWISE
         {
-                Pos             = MAP_APPFONT ( 15, 79 ) ;
+                Pos             = MAP_APPFONT ( 15, 90 ) ;
                 Size    = MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
                                                                                                     
                 Text [ de ] = "Groupwise";
@@ -158,7 +167,7 @@
         };
 	RadioButton RB_LDAP
 	{
-		Pos		= MAP_APPFONT ( 15, 90 ) ;
+		Pos		= MAP_APPFONT ( 15, 101 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "LDAP Adress-Bestand";
@@ -167,7 +176,7 @@
 
 	RadioButton RB_EVOLUTION
  	{
- 		Pos		= MAP_APPFONT ( 15, 101 ) ;
+ 		Pos		= MAP_APPFONT ( 15, 112 ) ;
  		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "Evolution";
@@ -176,7 +185,7 @@
 
 	RadioButton RB_OUTLOOK
 	{
-		Pos		= MAP_APPFONT ( 15, 112 ) ;
+		Pos		= MAP_APPFONT ( 15, 123 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "Outlook Adressbuch";
@@ -184,7 +193,7 @@
 	};
 	RadioButton RB_OUTLOOKEXPRESS
 	{
-		Pos		= MAP_APPFONT ( 15,123 ) ;
+		Pos		= MAP_APPFONT ( 15,134 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "Windows System-Adressbuch";
@@ -192,7 +201,7 @@
 	};
 	RadioButton RB_OTHER
 	{
-		Pos		= MAP_APPFONT ( 15, 134 ) ;
+		Pos		= MAP_APPFONT ( 15, 145 ) ;
 		Size	= MAP_APPFONT ( WINDOW_SIZE_X - 30, 8 ) ;
 
 		Text [ de ] = "andere externe Datenquelle";
--- extensions/source/abpilot/abpresid.hrc.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/abpresid.hrc	2005-08-22 11:52:26.000000000 +0000
@@ -193,13 +193,14 @@
 
 //........................................................................
 #define RB_MORK					1
-#define RB_EVOLUTION			2
-#define RB_LDAP					3
-#define RB_OUTLOOK				4
-#define RB_OUTLOOKEXPRESS		5
-#define RB_OTHER				6
-#define RB_EVOLUTION_LDAP		7
-#define RB_GROUPWISE			8
+#define RB_KAB					2
+#define RB_EVOLUTION				3
+#define RB_LDAP					4
+#define RB_OUTLOOK				5
+#define RB_OUTLOOKEXPRESS			6
+#define RB_OTHER				7
+#define RB_EVOLUTION_LDAP			8
+#define RB_GROUPWISE				9
 //........................................................................
 #define ET_DATASOURCENAME		1
 #define ET_LOCATION				2
--- extensions/source/abpilot/typeselectionpage.hxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/typeselectionpage.hxx	2005-08-22 11:52:49.000000000 +0000
@@ -85,6 +85,7 @@
 	protected:
 		FixedText		m_aHint;
 		FixedLine		m_aTypeSep;
+		RadioButton		m_aKab;
 		RadioButton		m_aEvolutionGroupwise;
 		RadioButton		m_aEvolutionLdap;
 		RadioButton		m_aEvolution;
--- extensions/source/abpilot/typeselectionpage.cxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/typeselectionpage.cxx	2005-08-22 11:55:18.000000000 +0000
@@ -89,6 +89,7 @@
 		:AddressBookSourcePage(_pParent, ModuleRes(RID_PAGE_SELECTABTYPE))
 		,m_aHint			(this,	ResId(FT_TYPE_HINTS))
 		,m_aTypeSep			(this,	ResId(FL_TYPE))
+		,m_aKab				(this,	ResId(RB_KAB))
 		,m_aEvolutionGroupwise		(this,	ResId(RB_GROUPWISE))
 		,m_aEvolutionLdap		(this,	ResId(RB_LDAP))
 		,m_aEvolution			(this,	ResId(RB_EVOLUTION))
@@ -99,6 +100,7 @@
 		FreeResource();
 
 		Link aTypeSelectionHandler = LINK(this, TypeSelectionPage, OnTypeSelected );
+		m_aKab.SetClickHdl( aTypeSelectionHandler );
 		m_aEvolutionGroupwise.SetClickHdl( aTypeSelectionHandler );
 		m_aEvolutionLdap.SetClickHdl( aTypeSelectionHandler );
 		m_aEvolution.SetClickHdl( aTypeSelectionHandler );
@@ -110,9 +112,11 @@
 		sal_Int32 nMoveControlsUp = m_aEvolution.GetPosPixel().Y() - m_aEvolutionLdap.GetPosPixel().Y();
 		sal_Int32 nMoveControlsUp = m_aEvolutionLdap.GetPosPixel().Y() - m_aEvolutionGroupwise.GetPosPixel().Y();
 
+		m_aKab.Hide();
 		m_aEvolutionGroupwise.Hide();
 		m_aEvolutionLdap.Hide();
 		m_aEvolution.Hide();
+		m_aKab.Hide();
 
 		aPos = m_aOutlook.GetPosPixel();
 		aPos.Y() -= nMoveControlsUp;
@@ -159,7 +163,9 @@
 	{
 		AddressBookSourcePage::ActivatePage();
 
-		if (m_aEvolution.IsChecked())
+		if (m_aKab.IsChecked())
+			m_aKab.GrabFocus();
+		else if (m_aEvolution.IsChecked())
 			m_aEvolution.GrabFocus();
 		else if (m_aEvolutionGroupwise.IsChecked())
 			m_aEvolutionGroupwise.GrabFocus();
@@ -185,6 +191,7 @@
 	//---------------------------------------------------------------------
 	void TypeSelectionPage::selectType( AddressSourceType _eType )
 	{
+		m_aKab.Check(AST_KAB == _eType);
 		m_aEvolutionGroupwise.Check(AST_GROUPWISE == _eType);
 		m_aEvolutionLdap.Check(AST_EVOLUTION_LDAP == _eType);
 		m_aEvolution.Check(AST_EVOLUTION == _eType);
@@ -196,7 +203,9 @@
 	//---------------------------------------------------------------------
 	AddressSourceType TypeSelectionPage::getSelectedType( )
 	{
-		if (m_aEvolutionLdap.IsChecked())
+		if (m_aKab.IsChecked())
+			return AST_KAB;
+		else if (m_aEvolutionLdap.IsChecked())
 			return AST_EVOLUTION_LDAP;
 		else if (m_aEvolutionGroupwise.IsChecked())
 			return AST_GROUPWISE;
--- extensions/source/abpilot/addresssettings.hxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/addresssettings.hxx	2005-08-22 11:41:30.000000000 +0000
@@ -83,6 +83,7 @@
 		AST_GROUPWISE,
 		AST_EVOLUTION_LDAP,
 		AST_EVOLUTION,
+		AST_KAB,
 		AST_LDAP,
 		AST_OUTLOOK,
 		AST_OE,
--- extensions/source/abpilot/abspilot.cxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/abspilot.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -437,6 +437,10 @@
 				m_aNewDataSource = aContext.createNewEvolution( m_aSettings.sDataSourceName );
 				break;
 
+			case AST_KAB:
+				m_aNewDataSource = aContext.createNewKab( m_aSettings.sDataSourceName );
+				break;
+
 			case AST_LDAP:
 				m_aNewDataSource = aContext.createNewLDAP( m_aSettings.sDataSourceName );
 				break;
--- extensions/source/abpilot/datasourcehandling.hxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/datasourcehandling.hxx	2005-08-22 11:41:30.000000000 +0000
@@ -121,6 +121,9 @@
 		/// creates a new Evolution GROUPWISE data source
 		ODataSource createNewEvolutionGroupwise( const ::rtl::OUString& _rName ) SAL_THROW (( ));
 
+		/// creates a new KDE address book data source
+		ODataSource createNewKab( const ::rtl::OUString& _rName ) SAL_THROW (( ));
+
 		/// creates a new LDAP data source
 		ODataSource	createNewLDAP( const ::rtl::OUString& _rName ) SAL_THROW (( ));
 
--- extensions/source/abpilot/datasourcehandling.cxx.kab~	2005-08-22 11:40:20.000000000 +0000
+++ extensions/source/abpilot/datasourcehandling.cxx	2005-08-22 11:41:30.000000000 +0000
@@ -366,6 +366,12 @@
 	}
 
 	//---------------------------------------------------------------------
+	ODataSource	ODataSourceContext::createNewKab( const ::rtl::OUString& _rName) SAL_THROW (( ))
+	{
+		return lcl_implCreateAndSetURL( m_pImpl->xORB, _rName, "sdbc:address:kab" );
+	}
+
+	//---------------------------------------------------------------------
 	ODataSource	ODataSourceContext::createNewOutlook( const ::rtl::OUString& _rName) SAL_THROW (( ))
 	{
 		return lcl_implCreateAndSetURL( m_pImpl->xORB, _rName, "sdbc:address:outlook" );
--- officecfg/registry/data/org/openoffice/Office/DataAccess.xcu.kab~	2005-08-22 11:40:22.000000000 +0000
+++ officecfg/registry/data/org/openoffice/Office/DataAccess.xcu	2005-08-22 11:41:30.000000000 +0000
@@ -85,6 +85,17 @@
            <value>60</value>
          </prop>
       </node>
+      <node oor:name="com.sun.star.comp.sdbc.kab.Driver" oor:op="replace">
+         <prop oor:name="DriverName">
+           <value>com.sun.star.comp.sdbc.kab.Driver</value>
+         </prop>
+         <prop oor:name="Enable">
+           <value>false</value>
+         </prop>
+         <prop oor:name="Timeout">
+           <value>60</value>
+         </prop>
+      </node>
       <node oor:name="com.sun.star.comp.sdbc.ado.ODriver" oor:op="replace">
         <prop oor:name="DriverName">
           <value>com.sun.star.comp.sdbc.ado.ODriver</value>
--- officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs.kab~	2004-11-24 17:28:07.000000000 +0000
+++ officecfg/registry/schema/org/openoffice/Office/DataAccess.xcs	2005-08-22 11:41:30.000000000 +0000
@@ -754,6 +754,198 @@
 					</prop>
 				</group>
 			</group>
+			<group oor:name="com.sun.star.comp.sdbc.kab.Driver">
+				<info>
+					<desc>Specifies the driver settings for the KAddressBook database driver.</desc>
+				</info>
+				<group oor:name="KAddressBookPreferences">
+					<info>
+						<desc>Specifies the KAddressBook preferences.</desc>
+					</info>
+					<prop oor:name="FullPathExportingCommand" oor:type="xs:string">
+						<info>
+							<desc>Specifies the KAddressBook full path exporting command name.</desc>
+						</info>
+						<value/>
+						<!-- JB: Empty default inserted into empty property node. Remove if NIL was intended -->
+					</prop>
+				</group>
+				<group oor:name="ColumnAliases">
+					<info>
+						<desc>Specifies the column alias names used.</desc>
+					</info>
+					<prop oor:name="Formatted Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the display name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Family Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the last name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Given Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the display name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Additional Names" oor:type="xs:string">
+						<info>
+							<desc>Specifies the other names.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Honorific Prefixes" oor:type="xs:string">
+						<info>
+							<desc>Specifies the titles before the name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Honorific Suffixes" oor:type="xs:string">
+						<info>
+							<desc>Specifies the ttiles after the name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Nick Name" oor:type="xs:string">
+						<info>
+							<desc>Specifies the nick name.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Birthday" oor:type="xs:string">
+						<info>
+							<desc>Specifies the date of birth.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Street" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home street.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address City" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home city.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address State" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home state.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Zip Code" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home postal code.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Country" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home country.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Address Label" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home label.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Street" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work street.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address City" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work city.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address State" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work state.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Zip Code" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work postal code.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Address Country" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work country.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the work phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Mobile Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the mobile phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Home Fax" oor:type="xs:string">
+						<info>
+							<desc>Specifies the home fax number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Business Fax" oor:type="xs:string">
+						<info>
+							<desc>Specifies the business fax number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Car Phone" oor:type="xs:string">
+						<info>
+							<desc>Specifies the car phone number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="ISDN" oor:type="xs:string">
+						<info>
+							<desc>Specifies the ISDN number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Pager" oor:type="xs:string">
+						<info>
+							<desc>Specifies the pager number.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Email Address" oor:type="xs:string">
+						<info>
+							<desc>Specifies the email address.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Mail Client" oor:type="xs:string">
+						<info>
+							<desc>Specifies the type of email software used.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Title" oor:type="xs:string">
+						<info>
+							<desc>Specifies the honorific title.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Role" oor:type="xs:string">
+						<info>
+							<desc>Specifies the exerced job.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Organization" oor:type="xs:string">
+						<info>
+							<desc>Specifies the company or administration.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Note" oor:type="xs:string">
+						<info>
+							<desc>Specifies the notes.</desc>
+						</info>
+					</prop>
+					<prop oor:name="Homepage" oor:type="xs:string">
+						<info>
+							<desc>Specifies the web page.</desc>
+						</info>
+					</prop>
+				</group>
+			</group>
 		</group>
 		<group oor:name="FormSearchOptions">
 			<info>
--- scp2/source/ooo/file_library_ooo.scp.kab~	2005-08-22 11:40:22.000000000 +0000
+++ scp2/source/ooo/file_library_ooo.scp	2005-08-22 11:41:30.000000000 +0000
@@ -602,6 +602,14 @@
     Name = STRING(CONCAT2(libevoab1,UNXSUFFIX));
 End
 
+File gid_File_Lib_Kab_1
+    TXT_FILE_BODY;
+    Styles = (PACKED,UNO_COMPONENT);
+    RegistryID = gid_Starregistry_Services_Rdb;
+    Dir = gid_Dir_Program;
+    Name = STRING(CONCAT2(libkab1,UNXSUFFIX));
+End
+
 #endif
 
 #ifdef ENABLE_EVOAB2
--- scp2/source/ooo/module_hidden_ooo.scp.kab~	2005-08-22 11:36:42.000000000 +0000
+++ scp2/source/ooo/module_hidden_ooo.scp	2005-08-22 11:41:30.000000000 +0000
@@ -330,6 +330,7 @@
 	gid_File_Lib_Embobj,
 	gid_File_Lib_Emboleobj,
 	gid_File_Lib_Evoab_1,
+	gid_File_Lib_Kab_1,
 	gid_File_Lib_Evtatt,
 	gid_File_Lib_Fileacc,
 	gid_File_Lib_Filterconfig1,
--- instsetoo_native/inc_openoffice/windows/msi_templates/components.txt.kab~	2005-04-04 10:10:03.000000000 +0000
+++ instsetoo_native/inc_openoffice/windows/msi_templates/components.txt	2005-08-22 11:41:30.000000000 +0000
@@ -440,6 +440,7 @@
 g_f_lib_juhx__program	84C3FFA8-60DA-495B-BFA6-E4FEAAFF5EF8
 g_f_lib_jvmaccess__program	424ACECB-E1C9-4263-8A34-F6AFB74C0C13
 g_f_lib_jvmfwk__program	842D4A06-D52F-47B4-8C97-E54AF47939EF
+g_f_lib_kab_1__program	00000000-0000-0000-0000-000000000000
 g_f_lib_ldapbe2__program	817C0CBC-E0A5-4E5E-9B2B-8BD3E50381B0
 g_f_lib_legacy_binfilters__program	E734A45D-3869-4C53-AC33-670382346874
 g_f_lib_libxmlsec_xmlseccore__program	73F3B5E2-0342-4CE2-816F-9EF6BB3250B3
--- helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp.kab~	2005-06-30 16:22:49.000000000 +0000
+++ helpcontent2/source/text/shared/explorer/database/dabawiz01.xhp	2005-08-22 11:41:30.000000000 +0000
@@ -87,7 +87,7 @@
 <paragraph role="paragraph" id="par_idN10590" xml-lang="en-US" l10n="NEW"><ahelp hid=".">Select to create a database document for an existing database connection.</ahelp></paragraph>
 <paragraph role="heading" id="par_idN10593" xml-lang="en-US" level="3" l10n="NEW">Database type</paragraph>
 <paragraph role="paragraph" id="par_idN10597" xml-lang="en-US" l10n="NEW"><ahelp hid=".">Select the database type for the existing database connection.</ahelp></paragraph>
-<paragraph role="note" id="par_idN1059A" xml-lang="en-US" l10n="NEW">The Outlook, Evolution, and Mozilla database types do not need additional information. For other database types, the wizard contains additional pages to specify the required information.</paragraph>
+<paragraph role="note" id="par_idN1059A" xml-lang="en-US" l10n="NEW">The Outlook, Evolution, KDE Address Book, and Mozilla database types do not need additional information. For other database types, the wizard contains additional pages to specify the required information.</paragraph>
 <paragraph role="paragraph" id="par_idN10611" xml-lang="en-US" l10n="NEW">The next wizard page is one of the following pages:</paragraph>
 <embed href="text/shared/explorer/database/dabawiz02.xhp#nextsteps"/>
 <paragraph role="paragraph" id="par_idN1061C" xml-lang="en-US" l10n="NEW"><link href="text/shared/explorer/database/dabawiz02text.xhp">Set up text file connection</link></paragraph>
