Index: scp2/source/ooo/file_ooo.scp
===================================================================
RCS file: /cvs/installation/scp2/source/ooo/file_ooo.scp,v
retrieving revision 1.58
diff -u -p -u -r1.58 file_ooo.scp
--- scp2/source/ooo/file_ooo.scp	9 Dec 2004 16:16:21 -0000	1.58
+++ scp2/source/ooo/file_ooo.scp	21 Dec 2004 12:04:31 -0000
@@ -631,7 +631,10 @@ File gid_File_Images_Zip
     Styles = (PACKED,SETUPZIP);
 End
 
+// Include any custom image sets
+#include "images.inc"
+
 File gid_File_Inethist_Dat_Delete_Only
     TXT_FILE_BODY;
     Dir = gid_Dir_User_Config;


--- /dev/null	2004-07-26 12:51:14.000000000 +0100
+++ scp2/macros/images.pl	2004-12-21 11:55:33.946715752 +0000
@@ -0,0 +1,37 @@
+my $outfile = "";
+
+while (my $a = shift @ARGV) {
+    if ($a eq '-o') {
+	$outfile = shift @ARGV || die "-o requires filename";
+    }
+}
+
+open OUTFILE, ">$outfile" || die "$0 ERROR: cannot open $outfile for writing!\n";
+
+print OUTFILE << "HEADER"
+// This file is autogenerated by macros/images.pl
+
+HEADER
+;
+
+my @themes = split / /, $ENV{CUSTOM_IMAGE_SETS};
+while (my $theme = shift @themes)
+{
+    $theme =~ /^\s*$/ && next;
+    $themezip = $theme . "_Zip";
+
+    print OUTFILE << "EOFRAG"
+File gid_File_Images_$themezip 
+    Carrier=gid_Datacarrier; 
+    Time="0200"; 
+    Date="29022004"; 
+    UnixRights=444; 
+    Dir=gid_Dir_Share_Config; 
+    Name="images_$theme.zip"; 
+    Styles = (PACKED,SETUPZIP); 
+End
+EOFRAG
+;
+}
+
+close OUTFILE;


Index: scp2/prj/build.lst
===================================================================
RCS file: /cvs/installation/scp2/prj/build.lst,v
retrieving revision 1.8
retrieving revision 1.8.8.1
diff -u -p -u -r1.8 -r1.8.8.1
--- scp2/prj/build.lst	15 Nov 2004 13:15:48 -0000	1.8
+++ scp2/prj/build.lst	15 Dec 2004 16:14:06 -0000	1.8.8.1
@@ -1,22 +1,23 @@
 cp    scp2    :    scptools setup_native python NULL
 cp    scp2                        usr1     -    all    cp_mkout NULL
-cp    scp2\source\activex         nmake    -    all    cp_activex NULL
-cp    scp2\source\calc            nmake    -    all    cp_calc NULL
-cp    scp2\source\canvas          nmake    -    all    cp_canvas NULL
-cp    scp2\source\crashrep        nmake    -    all    cp_crashrep NULL
-cp    scp2\source\draw            nmake    -    all    cp_draw NULL
-cp    scp2\source\gnome           nmake    -    all    cp_gnome NULL
-cp    scp2\source\graphicfilter   nmake    -    all    cp_graphicfilter NULL
-cp    scp2\source\impress         nmake    -    all    cp_impress NULL
-cp    scp2\source\javafilter      nmake    -    all    cp_javafilter NULL
-cp    scp2\source\kde             nmake    -    all    cp_kde NULL
-cp    scp2\source\lingu           nmake    -    all    cp_lingu NULL
-cp    scp2\source\mailcap         nmake    -    all    cp_mailcap NULL
-cp    scp2\source\math            nmake    -    all    cp_math NULL
-cp    scp2\source\ooo             nmake    -    all    cp_ooo NULL
-cp    scp2\source\python          nmake    -    all    cp_python NULL
-cp    scp2\source\testtool        nmake    -    all    cp_testtool NULL
-cp    scp2\source\writer          nmake    -    all    cp_writer NULL
-cp    scp2\source\xsltfilter      nmake    -    all    cp_xsltfilter NULL
-cp    scp2\source\winexplorerext  nmake    -    all    cp_winexplorerext NULL
+cp    scp2\macros                 nmake    -    all    cp_langmacros NULL
+cp    scp2\source\activex         nmake    -    all    cp_activex cp_langmacros NULL
+cp    scp2\source\calc            nmake    -    all    cp_calc cp_langmacros NULL
+cp    scp2\source\canvas          nmake    -    all    cp_canvas cp_langmacros NULL
+cp    scp2\source\crashrep        nmake    -    all    cp_crashrep cp_langmacros NULL
+cp    scp2\source\draw            nmake    -    all    cp_draw cp_langmacros NULL
+cp    scp2\source\gnome           nmake    -    all    cp_gnome cp_langmacros NULL
+cp    scp2\source\graphicfilter   nmake    -    all    cp_graphicfilter cp_langmacros NULL
+cp    scp2\source\impress         nmake    -    all    cp_impress cp_langmacros NULL
+cp    scp2\source\javafilter      nmake    -    all    cp_javafilter cp_langmacros NULL
+cp    scp2\source\kde             nmake    -    all    cp_kde cp_langmacros NULL
+cp    scp2\source\lingu           nmake    -    all    cp_lingu cp_langmacros NULL
+cp    scp2\source\mailcap         nmake    -    all    cp_mailcap cp_langmacros NULL
+cp    scp2\source\math            nmake    -    all    cp_math cp_langmacros NULL
+cp    scp2\source\ooo             nmake    -    all    cp_ooo cp_langmacros NULL
+cp    scp2\source\python          nmake    -    all    cp_python cp_langmacros NULL
+cp    scp2\source\testtool        nmake    -    all    cp_testtool cp_langmacros NULL
+cp    scp2\source\writer          nmake    -    all    cp_writer cp_langmacros NULL
+cp    scp2\source\xsltfilter      nmake    -    all    cp_xsltfilter cp_langmacros NULL
+cp    scp2\source\winexplorerext  nmake    -    all    cp_winexplorerext cp_langmacros NULL
 cp    scp2\util                   nmake    -    all    cp_util cp_activex cp_calc cp_canvas cp_crashrep cp_draw cp_gnome cp_graphicfilter cp_impress cp_javafilter cp_kde cp_lingu cp_mailcap cp_math cp_ooo cp_python cp_testtool cp_writer cp_xsltfilter cp_winexplorerext NULL


--- /dev/null	2004-08-25 18:34:59.000000000 +0100
+++ scp2/macros/makefile.mk	2004-12-21 12:14:15.870471880 +0000
@@ -0,0 +1,19 @@
+PRJ=..
+PRJNAME=scp2
+TARGET=macros
+
+# --- Settings -----------------------------------------------------
+
+.INCLUDE :  settings.mk
+.INCLUDE :  target.mk
+
+ALLTAR : $(INCCOM)$/images.inc
+
+CUSTOM_IMAGE_SETS:=$(CUSTOM_IMAGE_SETS)
+.EXPORT : CUSTOM_IMAGE_SETS
+
+.PHONY $(INCCOM)$/images.inc:
+        @echo ------------------------------
+        @echo Making: $@  
+	+-$(RENAME) $@ $@.tmp >& $(NULLDEV)
+	+$(PERL) images.pl -o $@.tmp && $(RENAME) $@.tmp $@
