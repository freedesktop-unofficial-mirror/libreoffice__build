--- config_office/configure.in	2007-05-28 13:35:49.000000000 +0200
+++ config_office/configure.in	2007-05-28 18:01:00.000000000 +0200
@@ -43,6 +43,11 @@ AC_ARG_WITH(openldap,
 AC_ARG_ENABLE(lockdown,
 [  --enable-lockdown       Enables the gconf integration work in OOo
 ],,)
+AC_ARG_ENABLE(separate-helpcontent,
+[  --enable-separate-helpcontent
+                          Don't build helpcontent during the main build, just
+                          prepare the separate scp2 scripts.
+],,)
 AC_ARG_ENABLE(vba,
 [  --disable-vba           disables the vba compatibility feature
 ],,)
@@ -5361,6 +5366,20 @@ fi
 AC_SUBST(ENABLE_LOCKDOWN)
 
 dnl ===================================================================
+dnl Test for the disabling the helpcontent build
+dnl ===================================================================
+AC_MSG_CHECKING([whether to build (and pack) helpcontent separately])
+SEPARATE_HELPCONTENT=
+if test "$enable_separate_helpcontent" = "yes"; then
+  SEPARATE_HELPCONTENT="YES"
+  AC_MSG_RESULT([yes])
+else
+  BUILD_TYPE="$BUILD_TYPE HELPCONTENT2"
+  AC_MSG_RESULT([no])
+fi
+AC_SUBST(SEPARATE_HELPCONTENT)
+
+dnl ===================================================================
 dnl Test for the presence of libstartup-notification
 dnl ===================================================================
 AC_MSG_CHECKING([whether to use libstartup-notification])
--- config_office/set_soenv.in	2007-05-28 11:19:16.000000000 +0200
+++ config_office/set_soenv.in	2007-05-28 18:02:53.000000000 +0200
@@ -1795,6 +1795,7 @@ ToFile( "VC_STANDARD",       "@VC_STANDA
 ToFile( "WITH_GPC",          "@WITH_GPC@",         "e" );
 ToFile( "WITH_MYSPELL_DICTS","@WITH_MYSPELL_DICTS@","e");
 ToFile( "ENABLE_LOCKDOWN",   "@ENABLE_LOCKDOWN@",  "e" );
+ToFile( "SEPARATE_HELPCONTENT","@SEPARATE_HELPCONTENT@","e" );
 ToFile( "WITH_LIBSN",        "@WITH_LIBSN@",       "e" );
 ToFile( "LIBSN_CFLAGS",      "@LIBSN_CFLAGS@",     "e" );
 ToFile( "LIBSN_LIBS",        "@LIBSN_LIBS@",       "e" );
--- postprocess/prj/build.lst	2007-05-28 13:19:48.000000000 +0200
+++ postprocess/prj/build.lst	2007-05-28 12:07:48.000000000 +0200
@@ -1,4 +1,4 @@
-po	postprocess	::	accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker helpcontent2 hwpfilter io lingucomponent MATHMLDTD:MathMLDTD MSFONTEXTRACT:msfontextract ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins scp2 scripting sd ODK:sdk_oo setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts AGFA_MONOTYPE_FONTS:agfa_monotype_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools NULL
+po	postprocess	::	accessibility automation basctl bean fondu BINFILTER:binfilter chart2 configmgr CRASHREP:crashrep dbaccess desktop dtrans embeddedobj embedserv EPM:epm eventattacher extensions extras fileaccess filter forms fpicker xmlhelp HELPCONTENT2:helpcontent2 hwpfilter io lingucomponent MATHMLDTD:MathMLDTD MSFONTEXTRACT:msfontextract ODK:odk officecfg package padmin psprint_config remotebridges sc scaddins scp2 scripting sd ODK:sdk_oo setup_native slideshow starmath sw sysui testshl2 testtools ucb UnoControls unoxml ure wizards xmerge xmlsecurity BITSTREAM_VERA_FONTS:bitstream_vera_fonts AGFA_MONOTYPE_FONTS:agfa_monotype_fonts DICTIONARIES:dictionaries OOo:pyuno OOo:readlicense_oo SO:top unodevtools NULL
 po	postprocess			    	usr1	-	all	po_mkout NULL
 po	postprocess\checkxml		nmake	-	all	po_checkxml NULL
 po	postprocess\checkdeliver	nmake	-	all	po_checkdlv NULL
--- scp2/prj/d.lst	2005-11-09 10:39:07.000000000 +0100
+++ scp2/prj/d.lst	2007-05-30 15:47:19.000000000 +0200
@@ -6,6 +6,8 @@
 ..\%__SRC%\bin\sdk\sdkoo.ins %_DEST%\bin%_EXT%\sdkoo.ins
 ..\%__SRC%\bin\osl\setup_osljre.inf %_DEST%\bin%_EXT%\setup_osljre.inf
 ..\%__SRC%\bin\osl\setup_osljre.ins %_DEST%\bin%_EXT%\setup_osljre.ins
+..\%__SRC%\bin\osl\helpcontent.inf %_DEST%\bin%_EXT%\helpcontent.inf
+..\%__SRC%\bin\osl\helpcontent.ins %_DEST%\bin%_EXT%\helpcontent.ins
 
 mkdir: %_DEST%\par%_EXT%
 
--- scp2/source/base/file_base.scp	2006-11-01 14:52:16.000000000 +0100
+++ scp2/source/base/file_base.scp	2007-05-28 16:59:42.000000000 +0200
@@ -64,29 +64,6 @@ End
 
 #endif
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Sdatabase_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sdatabase);
-    Patchfiles = ("sdatabase.db",
-                  "sdatabase.ht",
-                  "sdatabase.jar",
-                  "sdatabase.key",
-                  "sdatabase.idx/CONTEXTS",
-                  "sdatabase.idx/DICTIONARY",
-                  "sdatabase.idx/DOCS",
-                  "sdatabase.idx/DOCS.TAB",
-                  "sdatabase.idx/EDGE",
-                  "sdatabase.idx/LINKNAMES",
-                  "sdatabase.idx/OFFSETS",
-                  "sdatabase.idx/POSITIONS",
-                  "sdatabase.idx/SCHEMA"); 
-End
-
-#endif
-
 File gid_File_Registry_Spool_Oo_Setup_Base_Xcu
     TXT_FILE_BODY;
     Styles = (PACKED,PATCH);
--- scp2/source/base/help_base.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/base/help_base.scp	2007-05-28 17:14:08.000000000 +0200
@@ -0,0 +1,67 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Base_Help
+    MOD_NAME_DESC ( MODULE_PRG_BASE_HELP );
+    ParentID = gid_Module_Prg_Base;
+    Minimal = NO;
+    Default = YES;
+    Files = (gid_File_Help_Sdatabase_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Sdatabase_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sdatabase);
+    Patchfiles = ("sdatabase.db",
+                  "sdatabase.ht",
+                  "sdatabase.jar",
+                  "sdatabase.key",
+                  "sdatabase.idx/CONTEXTS",
+                  "sdatabase.idx/DICTIONARY",
+                  "sdatabase.idx/DOCS",
+                  "sdatabase.idx/DOCS.TAB",
+                  "sdatabase.idx/EDGE",
+                  "sdatabase.idx/LINKNAMES",
+                  "sdatabase.idx/OFFSETS",
+                  "sdatabase.idx/POSITIONS",
+                  "sdatabase.idx/SCHEMA"); 
+End
+
+#endif
--- scp2/source/base/makefile.mk	2005-11-15 13:54:19.000000000 +0100
+++ scp2/source/base/makefile.mk	2007-05-28 17:11:24.000000000 +0200
@@ -49,6 +49,7 @@ SCP_PRODUCT_TYPE=osl
 
 PARFILES= \
         module_base.par             \
+        help_base.par               \
         file_base.par
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/base/module_base.scp	2007-01-02 16:27:26.000000000 +0100
+++ scp2/source/base/module_base.scp	2007-05-28 16:58:19.000000000 +0200
@@ -58,11 +58,3 @@ Module gid_Module_Prg_Base_Bin
         ,gid_File_Res_Cnr
     );
 End
-
-Module gid_Module_Prg_Base_Help
-    MOD_NAME_DESC ( MODULE_PRG_BASE_HELP );
-    ParentID = gid_Module_Prg_Base;
-    Minimal = NO;
-    Default = YES;
-    Files = (gid_File_Help_Sdatabase_Zip);
-End
--- scp2/source/calc/file_calc.scp	2007-05-28 11:19:13.000000000 +0200
+++ scp2/source/calc/file_calc.scp	2007-05-28 17:14:29.000000000 +0200
@@ -110,30 +110,6 @@ File gid_File_Registry_Spool_Oo_Office_E
     Name = "/registry/spool/org/openoffice/Office/Embedding-calc.xcu";
 End
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Scalc_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(scalc);
-    Patchfiles = ("scalc.db",
-                  "scalc.ht",
-                  "scalc.jar",
-                  "scalc.key",
-                  "scalc.tree",
-                  "scalc.idx/CONTEXTS",
-                  "scalc.idx/DICTIONARY",
-                  "scalc.idx/DOCS",
-                  "scalc.idx/DOCS.TAB",
-                  "scalc.idx/EDGE",
-                  "scalc.idx/LINKNAMES",
-                  "scalc.idx/OFFSETS",
-                  "scalc.idx/POSITIONS",
-                  "scalc.idx/SCHEMA"); 
-End
-
-#endif
-
 // new user interface configuration files
 /*
 File gid_File_Share_Config_Sofficecfg_Calc_Menubar_Xml
--- scp2/source/calc/help_calc.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/calc/help_calc.scp	2007-05-28 17:14:48.000000000 +0200
@@ -0,0 +1,68 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Calc_Help
+    MOD_NAME_DESC ( MODULE_PRG_CALC_HELP );
+    ParentID = gid_Module_Prg_Calc;
+    Default = YES;
+    Files = (gid_File_Help_Scalc_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Scalc_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(scalc);
+    Patchfiles = ("scalc.db",
+                  "scalc.ht",
+                  "scalc.jar",
+                  "scalc.key",
+                  "scalc.tree",
+                  "scalc.idx/CONTEXTS",
+                  "scalc.idx/DICTIONARY",
+                  "scalc.idx/DOCS",
+                  "scalc.idx/DOCS.TAB",
+                  "scalc.idx/EDGE",
+                  "scalc.idx/LINKNAMES",
+                  "scalc.idx/OFFSETS",
+                  "scalc.idx/POSITIONS",
+                  "scalc.idx/SCHEMA"); 
+End
+
+#endif
+
--- scp2/source/calc/makefile.mk	2007-05-28 11:19:13.000000000 +0200
+++ scp2/source/calc/makefile.mk	2007-05-28 17:15:20.000000000 +0200
@@ -56,6 +56,7 @@ SCPDEFS+=-DSYSTEM_LPSOLVE
 SCP_PRODUCT_TYPE=osl
 PARFILES= \
         module_calc.par              \
+        help_calc.par                \
         file_calc.par 
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/calc/module_calc.scp	2007-01-02 16:27:54.000000000 +0100
+++ scp2/source/calc/module_calc.scp	2007-05-28 17:14:54.000000000 +0200
@@ -53,13 +53,6 @@ Module gid_Module_Prg_Calc_Bin
     gid_File_Lib_Bf_Sc,gid_File_Res_Bf_Sc,gid_File_Oo_Office_Ui_Calcwindowstate_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Calc_Filters_Xcu, gid_File_Tmp_Userinstall_Calc_Inf);
 End
 
-Module gid_Module_Prg_Calc_Help
-    MOD_NAME_DESC ( MODULE_PRG_CALC_HELP );
-    ParentID = gid_Module_Prg_Calc;
-    Default = YES;
-    Files = (gid_File_Help_Scalc_Zip);
-End
-
 Module gid_Module_Prg_Calc_Addins
     MOD_NAME_DESC ( MODULE_OPTIONAL_ADDINS );
     ParentID = gid_Module_Prg_Calc;
--- scp2/source/draw/file_draw.scp	2006-11-01 14:52:47.000000000 +0100
+++ scp2/source/draw/file_draw.scp	2007-05-28 17:16:22.000000000 +0200
@@ -42,29 +42,6 @@ File gid_File_Registry_Spool_Oo_Office_E
     Name = "/registry/spool/org/openoffice/Office/Embedding-draw.xcu";
 End
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Sdraw_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sdraw);
-    Patchfiles = ("sdraw.db",
-                  "sdraw.ht",
-                  "sdraw.jar",
-                  "sdraw.key",
-                  "sdraw.idx/CONTEXTS",
-                  "sdraw.idx/DICTIONARY",
-                  "sdraw.idx/DOCS",
-                  "sdraw.idx/DOCS.TAB",
-                  "sdraw.idx/EDGE",
-                  "sdraw.idx/LINKNAMES",
-                  "sdraw.idx/OFFSETS",
-                  "sdraw.idx/POSITIONS",
-                  "sdraw.idx/SCHEMA"); 
-End
-
-#endif
-
 File gid_File_Exe_Sdraw
     BIN_FILE_BODY;
     Dir = gid_Dir_Program;
--- scp2/source/draw/help_draw.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/draw/help_draw.scp	2007-05-28 17:16:48.000000000 +0200
@@ -0,0 +1,66 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Draw_Help
+    MOD_NAME_DESC ( MODULE_PRG_DRAW_HELP );
+    ParentID = gid_Module_Prg_Draw;
+    Default = YES;
+    Files = (gid_File_Help_Sdraw_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Sdraw_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sdraw);
+    Patchfiles = ("sdraw.db",
+                  "sdraw.ht",
+                  "sdraw.jar",
+                  "sdraw.key",
+                  "sdraw.idx/CONTEXTS",
+                  "sdraw.idx/DICTIONARY",
+                  "sdraw.idx/DOCS",
+                  "sdraw.idx/DOCS.TAB",
+                  "sdraw.idx/EDGE",
+                  "sdraw.idx/LINKNAMES",
+                  "sdraw.idx/OFFSETS",
+                  "sdraw.idx/POSITIONS",
+                  "sdraw.idx/SCHEMA"); 
+End
+
+#endif
--- scp2/source/draw/makefile.mk	2005-09-09 03:25:32.000000000 +0200
+++ scp2/source/draw/makefile.mk	2007-05-28 17:17:12.000000000 +0200
@@ -48,6 +48,7 @@ TARGETTYPE=CUI
 SCP_PRODUCT_TYPE=osl
 PARFILES= \
         module_draw.par              \
+        help_draw.par                \
         file_draw.par  
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/draw/module_draw.scp	2007-01-02 16:28:05.000000000 +0100
+++ scp2/source/draw/module_draw.scp	2007-05-28 17:16:41.000000000 +0200
@@ -52,10 +52,3 @@ Module gid_Module_Prg_Draw_Bin
 	gid_File_Registry_Spool_Oo_Office_Embedding_Draw_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Draw_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Draw_Filters_Xcu, gid_File_Tmp_Userinstall_Draw_Inf);
 End
-
-Module gid_Module_Prg_Draw_Help
-    MOD_NAME_DESC ( MODULE_PRG_DRAW_HELP );
-    ParentID = gid_Module_Prg_Draw;
-    Default = YES;
-    Files = (gid_File_Help_Sdraw_Zip);
-End
--- scp2/source/impress/file_impress.scp	2006-11-01 14:53:03.000000000 +0100
+++ scp2/source/impress/file_impress.scp	2007-05-28 17:19:27.000000000 +0200
@@ -52,31 +52,6 @@ File gid_File_Registry_Spool_Oo_Office_E
     Name = "/registry/spool/org/openoffice/Office/Embedding-impress.xcu";
 End
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Simpress_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    TXT_FILE_BODY;
-    Styles = (ARCHIVE,DONT_OVERWRITE,PATCH);
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(simpress);
-    Patchfiles = ("simpress.db",
-                  "simpress.ht",
-                  "simpress.jar",
-                  "simpress.key",
-                  "simpress.tree",
-                  "simpress.idx/CONTEXTS",
-                  "simpress.idx/DICTIONARY",
-                  "simpress.idx/DOCS",
-                  "simpress.idx/DOCS.TAB",
-                  "simpress.idx/EDGE",
-                  "simpress.idx/LINKNAMES",
-                  "simpress.idx/OFFSETS",
-                  "simpress.idx/POSITIONS",
-                  "simpress.idx/SCHEMA"); 
-End
-
-#endif
-
 File gid_File_Exe_Simpress
     BIN_FILE_BODY;
     Dir = gid_Dir_Program;
--- scp2/source/impress/help_impress.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/impress/help_impress.scp	2007-05-28 17:20:00.000000000 +0200
@@ -0,0 +1,68 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Impress_Help
+    MOD_NAME_DESC ( MODULE_PRG_IMPRESS_HELP );
+    ParentID = gid_Module_Prg_Impress;
+    Default = YES;
+    Files = (gid_File_Help_Simpress_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Simpress_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    TXT_FILE_BODY;
+    Styles = (ARCHIVE,DONT_OVERWRITE,PATCH);
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(simpress);
+    Patchfiles = ("simpress.db",
+                  "simpress.ht",
+                  "simpress.jar",
+                  "simpress.key",
+                  "simpress.tree",
+                  "simpress.idx/CONTEXTS",
+                  "simpress.idx/DICTIONARY",
+                  "simpress.idx/DOCS",
+                  "simpress.idx/DOCS.TAB",
+                  "simpress.idx/EDGE",
+                  "simpress.idx/LINKNAMES",
+                  "simpress.idx/OFFSETS",
+                  "simpress.idx/POSITIONS",
+                  "simpress.idx/SCHEMA"); 
+End
+
+#endif
--- scp2/source/impress/makefile.mk	2005-09-09 03:29:59.000000000 +0200
+++ scp2/source/impress/makefile.mk	2007-05-28 17:20:19.000000000 +0200
@@ -49,6 +49,7 @@ SCP_PRODUCT_TYPE=osl
 
 PARFILES= \
         module_impress.par              \
+        help_impress.par                \
         file_impress.par 
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/impress/module_impress.scp	2007-01-02 16:28:58.000000000 +0100
+++ scp2/source/impress/module_impress.scp	2007-05-28 17:20:05.000000000 +0200
@@ -53,10 +53,3 @@ Module gid_Module_Prg_Impress_Bin
 	gid_File_Oo_Office_Ui_Effects_Xcs, gid_File_Oo_Office_Ui_Effects_Xcu, gid_File_Xdg_Impress, gid_File_Registry_Spool_Oo_Office_Embedding_Impress_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Impress_Filters_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Impress_Types_Xcu, gid_File_Tmp_Userinstall_Impress_Inf);
 End
-
-Module gid_Module_Prg_Impress_Help
-    MOD_NAME_DESC ( MODULE_PRG_IMPRESS_HELP );
-    ParentID = gid_Module_Prg_Impress;
-    Default = YES;
-    Files = (gid_File_Help_Simpress_Zip);
-End
--- scp2/source/math/file_math.scp	2007-04-25 16:38:37.000000000 +0200
+++ scp2/source/math/file_math.scp	2007-05-28 17:21:16.000000000 +0200
@@ -77,31 +77,6 @@ File gid_File_Registry_Spool_Oo_Office_E
     Name = "/registry/spool/org/openoffice/Office/Embedding-math.xcu";
 End
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Smath_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(smath);
-    Patchfiles = ("smath.cfg",
-                  "smath.db",
-                  "smath.ht",
-                  "smath.jar",
-                  "smath.key",
-                  "smath.tree",
-                  "smath.idx/CONTEXTS",
-                  "smath.idx/DICTIONARY",
-                  "smath.idx/DOCS",
-                  "smath.idx/DOCS.TAB",
-                  "smath.idx/EDGE",
-                  "smath.idx/LINKNAMES",
-                  "smath.idx/OFFSETS",
-                  "smath.idx/POSITIONS",
-                  "smath.idx/SCHEMA");
-End
-
-#endif
-
 File gid_File_Exe_Smath
     BIN_FILE_BODY;
     Dir = gid_Dir_Program;
--- scp2/source/math/help_math.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/math/help_math.scp	2007-05-28 17:21:44.000000000 +0200
@@ -0,0 +1,68 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Math_Help
+    MOD_NAME_DESC ( MODULE_PRG_MATH_HELP );
+    ParentID = gid_Module_Prg_Math;
+    Default = YES;
+    Files = (gid_File_Help_Smath_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Smath_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(smath);
+    Patchfiles = ("smath.cfg",
+                  "smath.db",
+                  "smath.ht",
+                  "smath.jar",
+                  "smath.key",
+                  "smath.tree",
+                  "smath.idx/CONTEXTS",
+                  "smath.idx/DICTIONARY",
+                  "smath.idx/DOCS",
+                  "smath.idx/DOCS.TAB",
+                  "smath.idx/EDGE",
+                  "smath.idx/LINKNAMES",
+                  "smath.idx/OFFSETS",
+                  "smath.idx/POSITIONS",
+                  "smath.idx/SCHEMA");
+End
+
+#endif
--- scp2/source/math/makefile.mk	2005-09-09 03:35:06.000000000 +0200
+++ scp2/source/math/makefile.mk	2007-05-28 17:54:44.000000000 +0200
@@ -52,6 +52,7 @@ SCPDEFS+=-DWITHOUT_BINFILTER
 SCP_PRODUCT_TYPE=osl
 PARFILES= \
         module_math.par              \
+        help_math.par                \
         file_math.par 
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/math/module_math.scp	2007-01-02 16:29:10.000000000 +0100
+++ scp2/source/math/module_math.scp	2007-05-28 17:21:40.000000000 +0200
@@ -53,10 +53,3 @@ Module gid_Module_Prg_Math_Bin
 	gid_File_Oo_Office_Ui_Mathwindowstate_Xcu, gid_File_Share_Xdg_Math, gid_File_Registry_Spool_Oo_Office_Embedding_Math_Xcu,
     gid_File_Registry_Spool_Oo_TypeDetection_Math_Types_Xcu,gid_File_Registry_Spool_Oo_TypeDetection_Math_Filters_Xcu, gid_File_Tmp_Userinstall_Math_Inf);
 End
-
-Module gid_Module_Prg_Math_Help
-    MOD_NAME_DESC ( MODULE_PRG_MATH_HELP );
-    ParentID = gid_Module_Prg_Math;
-    Default = YES;
-    Files = (gid_File_Help_Smath_Zip);
-End
--- scp2/source/ooo/directory_ooo.scp	2006-10-27 14:11:22.000000000 +0200
+++ scp2/source/ooo/directory_ooo.scp	2007-05-28 18:05:29.000000000 +0200
@@ -1027,11 +1027,6 @@ Directory gid_Dir_Config_Language
     DIR_ISOLANGUAGE_ALL_LANG_2;
 End
 
-Directory gid_Dir_Share_Config_Help
-    ParentID = gid_Dir_Config;
-    DosName = "help";
-End
-
 Directory gid_Dir_Config_More
     ParentID = gid_Dir_Config;
     DosName = "more";
@@ -1443,20 +1438,6 @@ Directory gid_Dir_Share_Plugin
     DosName = "plugin";
 End
 
-Directory gid_Dir_Help
-#ifndef MACOSX
-    ParentID = PD_PROGDIR;
-#else
-    ParentID = gid_Dir_Bundle_Contents_Macos;
-#endif
-    DosName = "help";
-End
-
-Directory gid_Dir_Help_Isolanguage
-    ParentID = gid_Dir_Help;
-    DIR_ISOLANGUAGE_ALL_LANG;
-End
-
 #ifdef UNX
 
 Directory gid_Dir_User_Psprint
--- scp2/source/ooo/file_ooo.scp	2007-05-28 11:19:11.000000000 +0200
+++ scp2/source/ooo/file_ooo.scp	2007-05-28 17:53:24.000000000 +0200
@@ -636,54 +636,6 @@ STD_RES_FILE( gid_File_Res_Ept, ept )
 
 STD_RES_FILE( gid_File_Res_Eme, eme )
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Common_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(shared);
-    Patchfiles = ("shared.db",
-                  "shared.ht",
-                  "shared.jar",
-                  "shared.key",
-                  "shared.tree",
-                  "err.html");
-End
-
-File gid_File_Help_Help_Zip
-    Dir = gid_Dir_Help;
-    ARCHIVE_TXT_FILE_BODY;
-    Name = "helpxsl.zip";
-End
-
-File gid_File_Help_Sbasic_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sbasic);
-    Patchfiles = ("sbasic.db",
-                  "sbasic.ht",
-                  "sbasic.jar",
-                  "sbasic.key",
-                  "sbasic.tree",
-                  "sbasic.idx/CONTEXTS",
-                  "sbasic.idx/DICTIONARY",
-                  "sbasic.idx/DOCS",
-                  "sbasic.idx/DOCS.TAB",
-                  "sbasic.idx/EDGE",
-                  "sbasic.idx/LINKNAMES",
-                  "sbasic.idx/OFFSETS",
-                  "sbasic.idx/POSITIONS",
-                  "sbasic.idx/SCHEMA");
-End
-
-File gid_File_Help_Schart_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(schart);
-End
-
-#endif
-
 File gid_File_Html_Thirdpartylicensereadme
     Name = "THIRDPARTYLICENSEREADME.html";
 #ifndef MACOSX
--- scp2/source/ooo/help_ooo.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/ooo/help_ooo.scp	2007-05-28 18:37:09.000000000 +0200
@@ -0,0 +1,115 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Root_Files_7
+	ParentID = gid_Module_Root;
+	Name = "gid_Module_Root_Files_7";
+	Description = "gid_Module_Root_Files_7";
+	Default = YES;
+	Styles = (HIDDEN_ROOT);
+	Files = (gid_File_Help_Common_Zip,
+	gid_File_Help_Help_Zip,
+	gid_File_Help_Sbasic_Zip,
+	gid_File_Help_Schart_Zip);
+End
+
+Directory gid_Dir_Share_Config_Help
+    ParentID = gid_Dir_Config;
+    DosName = "help";
+End
+
+Directory gid_Dir_Help
+#ifndef MACOSX
+    ParentID = PD_PROGDIR;
+#else
+    ParentID = gid_Dir_Bundle_Contents_Macos;
+#endif
+    DosName = "help";
+End
+
+Directory gid_Dir_Help_Isolanguage
+    ParentID = gid_Dir_Help;
+    DIR_ISOLANGUAGE_ALL_LANG;
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Common_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(shared);
+    Patchfiles = ("shared.db",
+                  "shared.ht",
+                  "shared.jar",
+                  "shared.key",
+                  "shared.tree",
+                  "err.html");
+End
+
+File gid_File_Help_Help_Zip
+    Dir = gid_Dir_Help;
+    ARCHIVE_TXT_FILE_BODY;
+    Name = "helpxsl.zip";
+End
+
+File gid_File_Help_Sbasic_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(sbasic);
+    Patchfiles = ("sbasic.db",
+                  "sbasic.ht",
+                  "sbasic.jar",
+                  "sbasic.key",
+                  "sbasic.tree",
+                  "sbasic.idx/CONTEXTS",
+                  "sbasic.idx/DICTIONARY",
+                  "sbasic.idx/DOCS",
+                  "sbasic.idx/DOCS.TAB",
+                  "sbasic.idx/EDGE",
+                  "sbasic.idx/LINKNAMES",
+                  "sbasic.idx/OFFSETS",
+                  "sbasic.idx/POSITIONS",
+                  "sbasic.idx/SCHEMA");
+End
+
+File gid_File_Help_Schart_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(schart);
+End
+
+#endif
--- scp2/source/ooo/help.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/ooo/help.scp	2007-05-28 19:12:36.000000000 +0200
@@ -0,0 +1,60 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+************************************************************************/
+
+#include "macros.inc"
+
+Installation gid_Installation
+    ProductName = "${PRODUCTNAME}";
+    ProductVersion = "${PRODUCTVERSION}";
+  #ifdef WNT
+    DefaultDestPath = "<winprogpath>\${PRODUCTNAME}${PRODUCTVERSION}";
+  #else
+	DefaultDestPath = "/opt/${UNIXPRODUCTNAME}${PRODUCTVERSION}";
+  #endif
+End
+
+Directory gid_Dir_Program
+#ifndef MACOSX
+    ParentID = PD_PROGDIR;
+#else
+    ParentID = gid_Dir_Bundle_Contents_Macos;
+#endif
+    DosName = "program";
+End
+
+Module gid_Module_Root_Help
+    Name = "help";
+    Description = "help";
+End
--- scp2/source/ooo/makefile.mk	2007-05-28 11:19:13.000000000 +0200
+++ scp2/source/ooo/makefile.mk	2007-05-28 18:53:28.000000000 +0200
@@ -246,6 +246,8 @@ PARFILES=                          \
         file_font_ooo.par          \
         file_library_ooo.par       \
         file_resource_ooo.par      \
+        help.par                   \
+        help_ooo.par               \
         shortcut_ooo.par           \
         module_ooo.par             \
         module_hidden_ooo.par      \
--- scp2/source/ooo/module_hidden_ooo.scp	2007-05-28 11:19:16.000000000 +0200
+++ scp2/source/ooo/module_hidden_ooo.scp	2007-05-28 17:25:43.000000000 +0200
@@ -832,18 +832,6 @@ Module gid_Module_Root_Files_6
 	gid_File_Spuser1_Txt);
 End
 
-Module gid_Module_Root_Files_7
-	ParentID = gid_Module_Root;
-	Name = "gid_Module_Root_Files_7";
-	Description = "gid_Module_Root_Files_7";
-	Default = YES;
-	Styles = (HIDDEN_ROOT);
-	Files = (gid_File_Help_Common_Zip,
-	gid_File_Help_Help_Zip,
-	gid_File_Help_Sbasic_Zip,
-	gid_File_Help_Schart_Zip);
-End
-
 Module gid_Module_Root_Files_8
 	ParentID = gid_Module_Root;
 	Name = "gid_Module_Root_Files_8";
--- scp2/source/testtool/file_testtool.scp	2006-08-04 12:25:33.000000000 +0200
+++ scp2/source/testtool/file_testtool.scp	2007-05-29 14:06:48.000000000 +0200
@@ -49,13 +49,6 @@ File gid_File_Bin_Testtool
   #endif
 End
 
-File gid_File_Hid_Testtool
-    BIN_FILE_BODY;
-    Dir = gid_Dir_Program;
-    Styles = (PACKED);
-    Name = "hid.lst";
-End
-
 File gid_File_Config_Testtool
     BIN_FILE_BODY;
     Dir = gid_Dir_Program;
--- scp2/source/testtool/help_testtool.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/testtool/help_testtool.scp	2007-05-29 14:06:46.000000000 +0200
@@ -0,0 +1,43 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+File gid_File_Hid_Testtool
+    BIN_FILE_BODY;
+    Dir = gid_Dir_Program;
+    Styles = (PACKED);
+    Name = "hid.lst";
+End
--- scp2/source/testtool/makefile.mk	2005-09-09 03:46:03.000000000 +0200
+++ scp2/source/testtool/makefile.mk	2007-05-29 14:06:59.000000000 +0200
@@ -49,6 +49,7 @@ SCP_PRODUCT_TYPE=osl
 
 PARFILES= \
         module_testtool.par     \
+        help_testtool.par     \
         file_testtool.par
 
 ULFFILES= \
--- scp2/source/writer/file_writer.scp	2007-04-16 19:00:12.000000000 +0200
+++ scp2/source/writer/file_writer.scp	2007-05-28 17:28:10.000000000 +0200
@@ -85,30 +85,6 @@ File gid_File_Registry_Spool_Oo_Office_E
     Name = "/registry/spool/org/openoffice/Office/Embedding-writer.xcu";
 End
 
-#ifdef SOLAR_JAVA
-
-File gid_File_Help_Swriter_Zip
-    Dir = gid_Dir_Help_Isolanguage;
-    ARCHIVE_TXT_FILE_BODY_PATCH;
-    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(swriter);
-    Patchfiles = ("swriter.db",
-                  "swriter.ht",
-                  "swriter.jar",
-                  "swriter.key",
-                  "swriter.tree",
-                  "swriter.idx/CONTEXTS",
-                  "swriter.idx/DICTIONARY",
-                  "swriter.idx/DOCS",
-                  "swriter.idx/DOCS.TAB",
-                  "swriter.idx/EDGE",
-                  "swriter.idx/LINKNAMES",
-                  "swriter.idx/OFFSETS",
-                  "swriter.idx/POSITIONS",
-                  "swriter.idx/SCHEMA");
-End
-
-#endif
-
 /*
 File gid_File_Share_Config_Sofficecfg_Writer_Menubar_Xml
     TXT_FILE_BODY;
--- scp2/source/writer/help_writer.scp	1970-01-01 01:00:00.000000000 +0100
+++ scp2/source/writer/help_writer.scp	2007-05-28 17:28:25.000000000 +0200
@@ -0,0 +1,68 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "macros.inc"
+
+Module gid_Module_Prg_Wrt_Help
+    MOD_NAME_DESC ( MODULE_PRG_WRT_HELP );
+    ParentID = gid_Module_Prg_Wrt;
+    Default = YES;
+    Minimal = YES;
+    Files = (gid_File_Help_Swriter_Zip);
+End
+
+#ifdef SOLAR_JAVA
+
+File gid_File_Help_Swriter_Zip
+    Dir = gid_Dir_Help_Isolanguage;
+    ARCHIVE_TXT_FILE_BODY_PATCH;
+    EXTRA_ALL_GOOD_HELP_LOCALIZATIONS_LANG(swriter);
+    Patchfiles = ("swriter.db",
+                  "swriter.ht",
+                  "swriter.jar",
+                  "swriter.key",
+                  "swriter.tree",
+                  "swriter.idx/CONTEXTS",
+                  "swriter.idx/DICTIONARY",
+                  "swriter.idx/DOCS",
+                  "swriter.idx/DOCS.TAB",
+                  "swriter.idx/EDGE",
+                  "swriter.idx/LINKNAMES",
+                  "swriter.idx/OFFSETS",
+                  "swriter.idx/POSITIONS",
+                  "swriter.idx/SCHEMA");
+End
+
+#endif
--- scp2/source/writer/makefile.mk	2005-09-09 03:49:46.000000000 +0200
+++ scp2/source/writer/makefile.mk	2007-05-28 17:55:17.000000000 +0200
@@ -49,6 +49,7 @@ SCP_PRODUCT_TYPE=osl
 
 PARFILES= \
         module_writer.par              \
+        help_writer.par                \
         file_writer.par
 
 .IF "$(GUI)"=="WNT"
--- scp2/source/writer/module_writer.scp	2007-05-28 11:19:11.000000000 +0200
+++ scp2/source/writer/module_writer.scp	2007-05-28 17:28:39.000000000 +0200
@@ -80,11 +80,3 @@ Module gid_Module_Prg_Wrt_Bin
     gid_File_Registry_Spool_Oo_TypeDetection_Global_Types_Xcu, gid_File_Registry_Spool_Oo_TypeDetection_Global_Filters_Xcu,
     gid_File_Tmp_Userinstall_Wrt_Inf);
 End
-
-Module gid_Module_Prg_Wrt_Help
-    MOD_NAME_DESC ( MODULE_PRG_WRT_HELP );
-    ParentID = gid_Module_Prg_Wrt;
-    Default = YES;
-    Minimal = YES;
-    Files = (gid_File_Help_Swriter_Zip);
-End
--- scp2/util/makefile.mk	2007-01-22 15:50:30.000000000 +0100
+++ scp2/util/makefile.mk	2007-05-28 19:02:35.000000000 +0200
@@ -305,6 +305,32 @@ SCP4LINK_PRODUCT_TYPE = sdk
 SCP4TARGET = sdkoo
 SCP4FILES = sdkoo.par
 
+# ------------------------------------------------------------------------
+# Help - it can be part of the product, or separate
+
+HELP_FILES =                               \
+             help_base.par                 \
+             help_calc.par                 \
+             help_draw.par                 \
+             help_impress.par              \
+             help_math.par                 \
+             help_ooo.par                  \
+             help_testtool.par             \
+             help_writer.par
+
+SCP5LINK_PRODUCT_TYPE = osl
+SCP5TARGET = helpcontent
+SCP5FILES =                                \
+             help.par                      \
+             $(HELP_FILES)
+
+.IF "$(SEPARATE_HELPCONTENT)" != "YES"
+
+SCP1FILES += $(HELP_FILES)
+SCP2FILES += $(HELP_FILES)
+
+.ENDIF
+
 # --- target -------------------------------------------------------------
 .INCLUDE :  target.mk
 
