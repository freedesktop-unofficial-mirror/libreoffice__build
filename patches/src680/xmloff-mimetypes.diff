--- xmloff/source/core/XMLEmbeddedObjectImportContext.cxx	27 Jun 2007 14:55:45 -0000	1.15
+++ xmloff/source/core/XMLEmbeddedObjectImportContext.cxx	9 Jul 2007 08:35:05 -0000
@@ -120,6 +120,8 @@
 	SERVICE_MAP_ENTRY( ONLINE_TEXT, WRITER ),
 	SERVICE_MAP_ENTRY( SPREADSHEET, CALC ),
 	SERVICE_MAP_ENTRY( DRAWING, DRAW ),
+	SERVICE_MAP_ENTRY( GRAPHICS, DRAW ),
+	SERVICE_MAP_ENTRY( IMAGE, DRAW ),
 	SERVICE_MAP_ENTRY( PRESENTATION, IMPRESS ),
 	SERVICE_MAP_ENTRY( CHART, CHART ),
 	{ XML_TOKEN_INVALID, 0, 0 }
@@ -269,16 +271,21 @@
 		}
 
 		OUString sClass;
-		OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") );
-		if( 0 == sMime.compareTo( aTmp, aTmp.getLength() ) )
+		const OUString aTmp[] =
 		{
-			sClass = sMime.copy( aTmp.getLength() );
-		}
-		else
-		{
-			aTmp = OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
-			if( 0 == sMime.compareTo( aTmp, aTmp.getLength() ) )
-				sClass = sMime.copy( aTmp.getLength() );
+			OUString( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") ),
+			OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") ),
+			OUString( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.opendocument.") ),
+			OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.document.") ),
+			OUString()
+		};
+		for (int k=0; !aTmp[k].equals(OUString()); k++)
+		{ 
+			if( !sMime.compareTo( aTmp[k], aTmp[k].getLength() ) )
+			{
+				sClass = sMime.copy( aTmp[k].getLength() );
+				break;
+			}
 		}
 
 		if( sClass.getLength() )
@@ -297,7 +304,9 @@
 					case XML_TEXT:			aName = SvGlobalName(SO3_SW_CLASSID); break;
 					case XML_ONLINE_TEXT:	aName = SvGlobalName(SO3_SWWEB_CLASSID); break;
 					case XML_SPREADSHEET:	aName = SvGlobalName(SO3_SC_CLASSID); break;
-					case XML_DRAWING:		aName = SvGlobalName(SO3_SDRAW_CLASSID); break;
+					case XML_DRAWING:
+					case XML_GRAPHICS:
+					case XML_IMAGE:		aName = SvGlobalName(SO3_SDRAW_CLASSID); break;
 					case XML_PRESENTATION:	aName = SvGlobalName(SO3_SIMPRESS_CLASSID); break;
 					case XML_CHART:			aName = SvGlobalName(SO3_SCH_CLASSID); break;
 					default:
--- xmloff/source/transform/DocumentTContext.cxx	27 Jun 2007 16:20:13 -0000	1.5
+++ xmloff/source/transform/DocumentTContext.cxx	9 Jul 2007 08:35:06 -0000
@@ -113,18 +113,23 @@
 			IsXMLToken( aLocalName, XML_MIMETYPE ) )
 		{
 			const OUString& rValue = xAttrList->getValueByIndex( i );
-			OUString aTmp( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") );
-			if( 0 == rValue.compareTo( aTmp, aTmp.getLength() ) )
+			const OUString aTmp[] =
 			{
-				aClass = rValue.copy( aTmp.getLength() );
+				OUString( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.openoffice.") ),
+				OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") ),
+				OUString( RTL_CONSTASCII_USTRINGPARAM("application/vnd.oasis.opendocument.") ),
+				OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.document.") ),
+				OUString()
+			};
+			for (int k=0; !aTmp[k].equals(OUString()); k++)
+			{ 
+				if( !rValue.compareTo( aTmp[k], aTmp[k].getLength() ) )
+				{
+					aClass = rValue.copy( aTmp[k].getLength() );
+					break;
+				}
 			}
-			else
-			{
-				aTmp = OUString( RTL_CONSTASCII_USTRINGPARAM("application/x-vnd.oasis.openoffice.") );
-				if( 0 == rValue.compareTo( aTmp, aTmp.getLength() ) )
-					aClass = rValue.copy( aTmp.getLength() );
-			}
-			
+
 			if( !pMutableAttrList )
 			{
 				pMutableAttrList = new XMLMutableAttributeList( xAttrList );
