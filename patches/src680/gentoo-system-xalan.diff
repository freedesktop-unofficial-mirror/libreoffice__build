--- beanshell/prj/build.lst.orig	2005-12-05 12:09:34.000000000 +0100
+++ beanshell/prj/build.lst	2005-12-05 12:10:18.000000000 +0100
@@ -1,3 +1,3 @@
-be	beanshell	:	solenv xalan NULL
+be	beanshell	:	solenv XALAN:xalan NULL
 be	beanshell							usr1		-	all	be_mkout				NULL
 be	beanshell							nmake		-	all	be_beanshell		NULL
--- rhino/prj/build.lst.orig	2005-12-05 12:09:49.000000000 +0100
+++ rhino/prj/build.lst	2005-12-05 12:10:34.000000000 +0100
@@ -1,3 +1,3 @@
-xh	rhino	:	soltools xalan NULL
+xh	rhino	:	soltools XALAN:xalan NULL
 xh	rhino		usr1	-	all	xh_mkout NULL
 xh	rhino      nmake	-	all	xh_rhino NULL
--- config_office/configure.in.orig	2005-12-05 12:05:13.000000000 +0100
+++ config_office/configure.in	2005-12-05 12:36:50.000000000 +0100
@@ -71,6 +71,13 @@
 [  --disable-qadevooo      OO.o includes some qa testsuites which some
                           packagers may wish to build without
 ],,enable_qadevooo="yes")
+AC_ARG_WITH(system-xalan,
+[  --with-system-xalan     Use Xalan from system
+],,)
+AC_ARG_WITH(xalan-jar,
+[  --with-xalan-jar=JARFILE   Specify path to jarfile manually ],
+[ XALAN_JAR="$withval"
+])
 AC_ARG_ENABLE(fontooo,
 [  --disable-fontooo       disable FontOOo
                           (useful for distributions using fontconfig for OOo)
@@ -1476,6 +1479,20 @@
    AC_HEADER_STDC
 fi
 
+AC_MSG_CHECKING([which Xalan])
+if test "$with_system_xalan" = "yes"; then
+   AC_MSG_RESULT([external])
+   SYSTEM_XALAN=YES
+   AC_CHECK_FILE($XALAN_JAR, [],
+    [AC_MSG_ERROR(Xalan jar not found. Set with --with-xalan-jar=JARFILE!)], [])
+else
+   AC_MSG_RESULT(internal[])
+   SYSTEM_XALAN=NO
+   BUILD_TYPE="$BUILD_TYPE XALAN"
+fi
+AC_SUBST(SYSTEM_XALAN)
+AC_SUBST(XALAN_JAR)
+
 dnl ===================================================================
 dnl Check if cups/cups.h is available 
 dnl ===================================================================
@@ -4507,8 +4518,6 @@
 fi
 AC_SUBST(LOCAL_SOLVER)
 
-BUILD_TYPE="$BUILD_TYPE XALAN"
-
 AC_SUBST(BUILD_TYPE)
 
 # make sure config.guess is +x; we execute config.guess, so it has to be so; 
--- config_office/set_soenv.in.orig	2005-12-28 22:01:05.000000000 +0100
+++ config_office/set_soenv.in	2005-12-28 22:02:30.000000000 +0100
@@ -1782,6 +1782,8 @@
 ToFile( "DB_JAR",            "@DB_JAR@",           "e" );
 ToFile( "SYSTEM_BSH",        "@SYSTEM_BSH@",       "e" );
 ToFile( "BSH_JAR",           "@BSH_JAR@",          "e" );
+ToFile( "SYSTEM_XALAN",      "@SYSTEM_XALAN@",     "e" );
+ToFile( "XALAN_JAR",         "@XALAN_JAR@",        "e" );
 ToFile( "SYSTEM_SABLOT",     "@SYSTEM_SABLOT@",    "e" );
 ToFile( "SABLOT_LIBS",       "@SABLOT_LIBS@",      "e" );
 ToFile( "SYSTEM_ODBC_HEADERS","@SYSTEM_ODBC_HEADERS@","e" );
--- filter/source/config/fragments/makefile.mk.orig	2005-12-28 21:16:39.000000000 +0100
+++ filter/source/config/fragments/makefile.mk	2005-12-28 21:19:55.000000000 +0100
@@ -156,8 +156,12 @@
 MERGE:=python ../tools/merge/pyAltFCFGMerge
 .ELSE
 MERGE    := $(JAVAI) -jar $(CLASSDIR)$/FCFGMerge.jar
+.IF "$(SYSTEM_XALAN)" == "YES"
+PACKLANG := $(JAVAI) $(JAVACPS) $(XALAN_JAR) org.apache.xalan.xslt.Process -XSL langfilter.xsl
+.ELSE
 PACKLANG := $(JAVAI) $(JAVACPS) $(SOLARBINDIR)/xalan.jar org.apache.xalan.xslt.Process -XSL langfilter.xsl
 .ENDIF
+.ENDIF
 
 # -----------------------------------------------------------------------------
 # build every module seperated
--- filter/source/xsltfilter/makefile.mk.orig	2005-12-28 21:28:18.000000000 +0100
+++ filter/source/xsltfilter/makefile.mk	2005-12-28 22:13:41.000000000 +0100
@@ -70,7 +70,12 @@
 
 #USE_UDK_EXTENDED_MANIFESTFILE=TRUE
 #USE_EXTENDED_MANIFESTFILE=TRUE
-JARFILES 		= ridl.jar unoil.jar jurt.jar juh.jar xalan.jar xercesImpl.jar xml-apis.jar
+JARFILES		= ridl.jar unoil.jar jurt.jar juh.jar
+.IF "$(SYSTEM_XALAN)" != "YES"
+JARFILES += xalan.jar xercesImpl.jar xml-apis.jar
+.ELSE
+XCLASSPATH=$(XALAN_JAR)$(PATH_SEPERATOR)/usr/share/xalan/lib/serializer.jar$(PATH_SEPERATOR)/usr/share/xerces-2/lib/xercesImpl.jar$(PATH_SEPERATOR)/usr/share/xerces-2/lib/xml-apis.jar
+.ENDIF
 JAVAFILES		= $(subst,$(CLASSDIR)$/, $(subst,.class,.java $(JAVACLASSFILES))) 
 CUSTOMMANIFESTFILE = Manifest  
 #JARMANIFEST = Manifest
