--- jvmfwk/source/framework.cxx.old	2008-05-21 21:46:16.000000000 +0200
+++ jvmfwk/source/framework.cxx	2008-05-22 20:02:15.000000000 +0200
@@ -885,7 +885,8 @@ javaFrameworkError SAL_CALL jfw_setSelec
 		//check if pInfo is the selected JRE
 		JavaInfo *currentInfo = NULL;
 		errcode = jfw_getSelectedJRE( & currentInfo);
-		if (errcode != JFW_E_NONE && errcode != JFW_E_INVALID_SETTINGS)
+		if (errcode != JFW_E_NONE && errcode != JFW_E_INVALID_SETTINGS &&
+		    errcode != JFW_E_TRY_AUTOSELECT && errcode != JFW_E_CONFIGURATION )
 			return errcode;
 	    
 		if (jfw_areEqualJavaInfo(currentInfo, pInfo) == sal_False)
--- svx/source/dialog/optjava.cxx.old	2007-06-27 19:28:51.000000000 +0200
+++ svx/source/dialog/optjava.cxx	2008-05-22 19:58:25.000000000 +0200
@@ -750,7 +750,8 @@ BOOL SvxJavaOptionsPage::FillItemSet( Sf
 
 			JavaInfo* pSelectedJava = NULL;
 			eErr = jfw_getSelectedJRE( &pSelectedJava );
-			if ( JFW_E_NONE == eErr || JFW_E_INVALID_SETTINGS == eErr )
+			if ( JFW_E_NONE == eErr || JFW_E_INVALID_SETTINGS == eErr ||
+			     JFW_E_TRY_AUTOSELECT == eErr || JFW_E_CONFIGURATION == eErr )
 			{
 				if (pSelectedJava == NULL || !jfw_areEqualJavaInfo( pInfo, pSelectedJava ) )
 				{
