--- sc/source/core/data/document.cxx	2007-08-21 12:03:20.000000000 +0800
+++ sc/source/core/data/document.cxx	2007-08-21 12:03:29.000000000 +0800
@@ -339,7 +339,8 @@ BOOL ScDocument::InsertTab( SCTAB nPos, 
 
 				for (i = nTabCount; i > nPos; i--)
 				{
-					if ( pTab[i] && pExtOptions && ( pExtOptions->GetCodeNameCount() > 0 ) )
+					pTab[i] = pTab[i - 1];
+					if ( pExtOptions && ( pExtOptions->GetCodeNameCount() > 0 ) )
 					{
 						String sCodeName = pExtOptions->GetCodeName( i - 1 );
 						if ( sCodeName.Len() )
@@ -348,7 +349,6 @@ BOOL ScDocument::InsertTab( SCTAB nPos, 
 							pExtOptions->SetCodeName( sCodeName, i );
 						}
 					}
-					pTab[i] = pTab[i - 1];
 				}
 
 				if ( pExtOptions && ( pExtOptions->GetCodeNameCount() > 0 ) )
