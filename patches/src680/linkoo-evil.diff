Index: solenv/bin/linkoo
===================================================================
RCS file: /cvs/tools/solenv/bin/linkoo,v
retrieving revision 1.5
diff -u -p -u -r1.5 linkoo
--- solenv/bin/linkoo	11 Feb 2005 15:23:57 -0000	1.5
+++ solenv/bin/linkoo	15 Mar 2005 11:04:38 -0000
@@ -238,13 +238,24 @@ sub scan_and_link_files($$$)
     print "\n";
 }
 
-sub fixup_evilness
+sub evilness($)
 {
+    my $doit = shift;
     my $name = 'librecentfile.so';
-    my $src = "$OOO_BUILD/shell/$TARGET/lib/$name";
-    if (-f $src) {
-	print " link $name\n";
-	symlink $src, "$OOO_BUILD/sfx2/$TARGET/lib/$name";
+    my $src  = "$OOO_BUILD/shell/$TARGET/lib/$name";
+    my $dest = "$OOO_BUILD/sfx2/$TARGET/lib/$name";
+
+    if ($doit eq 'undo') {
+	if (-l $dest) {
+	    print " unlink $name\n";
+	    unlink $dest;
+	}
+    } else {
+	$doit eq 'do' || die;
+        if (-f $src) {
+	    print " link $name\n";
+	    symlink $src, $dest;
+	}
     }
 }
 
@@ -290,6 +301,8 @@ substr ($OOO_BUILD, 0, 1)   eq '/' || di
 
 ($TARGET, $LIBVER, $LANG, $DLLSUFFIX) = sniff_target ($OOO_BUILD);
 
+evilness ('undo');
+
 my $installed_files = build_installed_list ($OOO_INSTALL);
 
 scan_and_link_files ($OOO_BUILD, $installed_files, $TARGET);
@@ -311,4 +324,4 @@ if (!-f "$OOO_INSTALL/program/env") {
     close ($env);
 }
 
-fixup_evilness();
+evilness ('do');
