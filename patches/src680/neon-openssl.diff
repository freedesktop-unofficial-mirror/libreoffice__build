--- config_office/configure.in.orig	2007-11-30 18:46:42.000000000 +0100
+++ config_office/configure.in	2007-11-30 18:52:48.000000000 +0100
@@ -402,6 +402,9 @@
 AC_ARG_WITH(system-neon,
 [  --with-system-neon      Use neon already on system
 ],,)
+AC_ARG_WITH(system-openssl,
+[  --with-system-openssl   Use neon with OpenSSL from system
+],,)
 AC_ARG_WITH(system-agg,
 [  --with-system-agg       Use AGG already on system
 ],,)
@@ -4332,6 +4335,15 @@
     NEON_CFLAGS=
     BUILD_TYPE="$BUILD_TYPE NEON"
 fi
+  AC_MSG_CHECKING([Use neon with OpenSSL])
+  if test "$with_system_openssl" != "no"; then
+     AC_MSG_RESULT([internal])
+     BUILD_TYPE="$BUILD_TYPE OPENSSL"
+     ENABLE_OPENSSL=TRUE
+     AC_SUBST(ENABLE_OPENSSL)
+  else
+     AC_MSG_RESULT([external])
+  fi
 AC_SUBST(SYSTEM_NEON)
 AC_SUBST(NEON_VERSION)
 AC_SUBST(NEON_LIBS)
--- config_office/set_soenv.in.orig	2007-12-01 01:21:17.000000000 +0100
+++ config_office/set_soenv.in	2007-12-01 01:22:05.000000000 +0100
@@ -1983,6 +1983,7 @@
 ToFile( "NEON_LIBS",         "@NEON_LIBS@",        "e" );
 ToFile( "NEON_CFLAGS",       "@NEON_CFLAGS@",      "e" );
 ToFile( "DISABLE_NEON",      "@DISABLE_NEON@",     "e" );
+ToFile( "ENABLE_OPENSSL",    "@ENABLE_OPENSSL@",   "e" );
 ToFile( "DISABLE_XAW",       "@DISABLE_XAW@",      "e" );
 ToFile( "ENABLE_AGG",        "@ENABLE_AGG@",       "e" );
 ToFile( "SYSTEM_AGG",	     "@SYSTEM_AGG@",       "e" );
--- ucb/prj/build.lst.orig	2007-11-30 18:44:55.000000000 +0100
+++ ucb/prj/build.lst	2007-11-30 18:45:07.000000000 +0100
@@ -1,4 +1,4 @@
-uc ucb : cppuhelper CURL:curl openssl NEON:neon LIBXML2:libxml2 offapi sal salhelper ucbhelper udkapi comphelper tools vcl NULL
+uc ucb : cppuhelper CURL:curl OPENSSL:openssl NEON:neon LIBXML2:libxml2 offapi sal salhelper ucbhelper udkapi comphelper tools vcl NULL
 uc	ucb							usr1	-	all	uc_mkout NULL
 uc	ucb\inc					    nmake	-	all	uc_inc NULL
 uc	ucb\source\regexp		    nmake	-	all	uc_regexp uc_inc NULL
--- scp2/source/ooo/makefile.mk.orig	2007-12-01 01:14:47.000000000 +0100
+++ scp2/source/ooo/makefile.mk	2007-12-01 01:15:39.000000000 +0100
@@ -207,6 +207,10 @@
 SCPDEFS+=-DDISABLE_NEON
 .ENDIF
 
+.IF "$(ENABLE_OPENSSL)" == "TRUE"
+SCPDEFS+=-DOPENSSL
+.ENDIF
+
 .IF "$(ENABLE_VBA)" == "YES"
     .IF "$(VBA_EXTENSION)" == "YES"
         SCPDEFS+=-DVBA_EXTENSION
--- scp2/source/ooo/file_library_ooo.scp.orig	2007-12-01 01:10:39.000000000 +0100
+++ scp2/source/ooo/file_library_ooo.scp	2007-12-01 01:13:12.000000000 +0100
@@ -2740,6 +2740,7 @@
 End
 #endif
 
+#ifdef OPENSSL
 File gid_File_Lib_Openssl
     TXT_FILE_BODY;
     Styles = (PACKED,PATCH);
@@ -2748,6 +2749,7 @@
     Name = "ssleay32.dll";
   #endif
 End
+#endif
 
 File gid_File_Lib_Crypto
     TXT_FILE_BODY;
