Index: source/nsplugin/source/so_env.cxx
===================================================================
RCS file: /cvs/util/extensions/source/nsplugin/source/so_env.cxx,v
retrieving revision 1.4
diff -u -u -r1.4 so_env.cxx
--- extensions/source/nsplugin/source/so_env.cxx	31 May 2005 17:09:26 -0000	1.4
+++ extensions/source/nsplugin/source/so_env.cxx	26 Jun 2005 11:11:08 -0000
@@ -159,6 +159,18 @@
     // Filename of lnk file, eg. "soffice"
     char lnkFileName[NPP_PATH_MAX] = {0};
     char* pTempZero = NULL;
+
+    /* try a mozilla available in $MOZILLA_FIVE_HOME first */
+    if (getenv("MOZILLA_FIVE_HOME")) { 
+	    sprintf(lnkFileName, "%s/plugins/%s", getenv("MOZILLA_FIVE_HOME"), "libnpsoplugin.so");
+    	if ((0 > readlink(lnkFileName, realFileName, NPP_PATH_MAX)) ||
+		(NULL == (pTempZero = strstr(realFileName, "/program/libnpsoplugin.so"))))
+    	{
+       	*realFileName = 0;
+       	return -1;
+    	}
+    }
+    /* .. now in $HOME */
     sprintf(lnkFileName, "%s/.mozilla/plugins/%s", getenv("HOME"), "libnpsoplugin.so");
     if ((0 > readlink(lnkFileName, realFileName, NPP_PATH_MAX)) ||
        (NULL == (pTempZero = strstr(realFileName, "/program/libnpsoplugin.so"))))
