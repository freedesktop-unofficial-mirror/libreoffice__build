--- sfx2/source/view/viewsh.cxx	2005-06-27 16:27:21.000000000 +0530
+++ sfx2/source/view/viewsh.cxx	2005-06-30 15:08:11.153882995 +0530
@@ -345,6 +345,7 @@ void SfxViewShell::GetState_Impl( SfxIte
 			case SID_SETUPPRINTER:
 			{
 				BOOL bEnabled = pImp->bCanPrint && !pImp->nPrinterLocks;
+				bEnabled = bEnabled  && !Application::GetSettings().GetMiscSettings().GetDisablePrinting();
 				if ( bEnabled )
 				{
 					SfxPrinter *pPrinter = GetPrinter(FALSE);
--- officecfg/registry/data/org/openoffice/VCL.xcu	2005-06-27 16:27:28.000000000 +0530
+++ officecfg/registry/data/org/openoffice/VCL.xcu	2005-06-30 15:08:11.159882014 +0530
@@ -67,6 +67,11 @@
         <value>false</value>
       </prop>
     </node>
+    <node oor:name="DesktopManagement" oor:op="replace">
+      <prop oor:name="DisablePrinting" oor:type="xs:string" oor:op="replace">
+        <value>false</value>
+      </prop>
+    </node>
 	<node oor:name="Transfer" oor:op="replace">
 	  <prop oor:name="SelectionTimeout" oor:type="xs:string" oor:op="replace">
 	    <value>3</value>
--- vcl/inc/settings.hxx	2005-06-27 16:27:26.000000000 +0530
+++ vcl/inc/settings.hxx	2005-06-30 15:08:11.204874654 +0530
@@ -971,6 +971,7 @@ private:
     USHORT                          mnRefCount;
     USHORT                          mnTwoDigitYearStart;
     USHORT                          mnEnableATT;
+    USHORT                          mnDisablePrinting;
     BOOL                            mbEnableLocalizedDecimalSep;
 };
 
@@ -996,6 +997,7 @@ public:
                                         { return mpData->mnTwoDigitYearStart; }
     void							SetEnableATToolSupport( BOOL bEnable );
     BOOL							GetEnableATToolSupport() const;
+    BOOL							GetDisablePrinting() const;
     void							SetEnableLocalizedDecimalSep( BOOL bEnable );
     BOOL							GetEnableLocalizedDecimalSep() const;
     const MiscSettings&             operator =( const MiscSettings& rSet );
--- vcl/source/app/settings.cxx	2005-06-27 16:27:26.000000000 +0530
+++ vcl/source/app/settings.cxx	2005-06-30 15:08:11.215872855 +0530
@@ -1028,6 +1028,7 @@ ImplMiscData::ImplMiscData()
     mnRefCount                  = 1;
     mnTwoDigitYearStart         = 1930;
     mnEnableATT					= ~0;
+    mnDisablePrinting			= ~0;
     static const char* pEnv = getenv("SAL_DECIMALSEP_ENABLED" ); // set default without UI
     mbEnableLocalizedDecimalSep = (pEnv != NULL) ? TRUE : FALSE;
 }
@@ -1039,6 +1040,7 @@ ImplMiscData::ImplMiscData( const ImplMi
     mnRefCount                  = 1;
     mnTwoDigitYearStart         = rData.mnTwoDigitYearStart;
     mnEnableATT					= rData.mnEnableATT;
+    mnDisablePrinting			= rData.mnDisablePrinting;
     mbEnableLocalizedDecimalSep = rData.mbEnableLocalizedDecimalSep;
 }
 
@@ -1112,6 +1114,7 @@ BOOL MiscSettings::operator ==( const Mi
 
     if ( (mpData->mnTwoDigitYearStart   == rSet.mpData->mnTwoDigitYearStart ) &&
          (mpData->mnEnableATT			== rSet.mpData->mnEnableATT ) &&
+         (mpData->mnDisablePrinting		== rSet.mpData->mnDisablePrinting ) &&
          (mpData->mbEnableLocalizedDecimalSep == rSet.mpData->mbEnableLocalizedDecimalSep ) )
         return TRUE;
     else
@@ -1120,6 +1123,21 @@ BOOL MiscSettings::operator ==( const Mi
 
 // -----------------------------------------------------------------------
 
+BOOL MiscSettings::GetDisablePrinting() const
+{
+    if( mpData->mnDisablePrinting == (USHORT)~0 )
+    {
+        rtl::OUString aEnable =
+            vcl::SettingsConfigItem::get()->
+            getValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "DesktopManagement" ) ),
+                      rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "DisablePrinting" ) ) );
+        mpData->mnDisablePrinting = aEnable.equalsIgnoreAsciiCaseAscii( "true" ) ? 1 : 0;
+    }
+    
+    return (BOOL)mpData->mnDisablePrinting;
+}
+// -----------------------------------------------------------------------
+
 BOOL MiscSettings::GetEnableATToolSupport() const
 {
     
--- vcl/unx/source/gdi/salprnpsp.cxx	2005-03-30 14:39:56.000000000 +0530
+++ vcl/unx/source/gdi/salprnpsp.cxx	2005-06-06 11:22:32.898146544 +0530
@@ -76,6 +76,9 @@
 #include <sys/wait.h>
 #include <sys/stat.h>
 
+#ifndef _SV_SVAPP_HXX
+#include <svapp.hxx>
+#endif
 #ifndef _SV_JOBSET_H
 #include <jobset.h>
 #endif
@@ -1208,6 +1211,9 @@ IMPL_STATIC_LINK( vcl_sal::PrinterUpdate
 
 void vcl_sal::PrinterUpdate::update()
 {
+    if( Application::GetSettings().GetMiscSettings().GetDisablePrinting() )
+        return;
+    
     if( ! static_cast< X11SalInstance* >(GetSalData()->pInstance_)->isPrinterInit() )
     {
         // #i45389# start background printer detection
--- sfx2/source/doc/sfxbasemodel.cxx	2005-07-14 17:16:24.000000000 +0530
+++ sfx2/source/doc/sfxbasemodel.cxx	2005-08-01 16:05:36.621412055 +0530
@@ -1953,6 +1953,9 @@ class ImplUCBPrintWatcher : public ::osl
 void SAL_CALL SfxBaseModel::print(const SEQUENCE< PROPERTYVALUE >& rOptions)
         throw (::com::sun::star::lang::IllegalArgumentException, ::com::sun::star::uno::RuntimeException)
 {
+    if( Application::GetSettings().GetMiscSettings().GetDisablePrinting() )
+        return;
+
 	// object already disposed?
 	// object already disposed?
     ::vos::OGuard aGuard( Application::GetSolarMutex() );
--- sw/source/ui/uiview/pview.cxx	2005-07-21 14:59:22.000000000 +0530
+++ sw/source/ui/uiview/pview.cxx	2005-08-09 16:28:05.004771408 +0530
@@ -1770,7 +1770,10 @@ void  SwPagePreView::GetState( SfxItemSe
 				const SfxPoolItem* pItem;
 				SfxItemSet aSet( *rSet.GetPool(), SID_PRINTDOC, SID_PRINTDOC );
 				GetSlotState( SID_PRINTDOC, SfxViewShell::GetInterface(), &aSet );
-				if( SFX_ITEM_SET == aSet.GetItemState( SID_PRINTDOC,
+				if( SFX_ITEM_DISABLED == aSet.GetItemState( SID_PRINTDOC,
+						FALSE, &pItem ))
+					rSet.DisableItem( nWhich );
+				else if( SFX_ITEM_SET == aSet.GetItemState( SID_PRINTDOC,
 						FALSE, &pItem ))
 				{
 					((SfxPoolItem*)pItem)->SetWhich( FN_PRINT_PAGEPREVIEW );
