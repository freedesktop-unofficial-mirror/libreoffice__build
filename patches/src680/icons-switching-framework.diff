--- framework/inc/uiconfiguration/moduleimagemanager.hxx	2005-03-01 20:26:44.000000000 +0100
+++ framework/inc/uiconfiguration/moduleimagemanager.hxx	2005-05-20 16:57:35.288859803 +0200
@@ -200,6 +200,7 @@ namespace framework
             ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory > m_xServiceManager;
             ::std::vector< rtl::OUString >                                                   m_aImageNameVector;
             ::std::vector< rtl::OUString >                                                   m_aImageCommandNameVector;
+            sal_Int16                                                                        m_nSymbolsStyle;
     };
 
     class GlobalImageList : public CmdImageList, public rtl::IReference
--- framework/inc/uielement/menubarmanager.hxx	2005-03-29 17:48:16.000000000 +0200
+++ framework/inc/uielement/menubarmanager.hxx	2005-05-20 16:58:39.651758054 +0200
@@ -313,6 +313,7 @@ class MenuBarManager : public com::sun::
         ::com::sun::star::uno::Reference< ::com::sun::star::ui::XAcceleratorConfiguration >            m_xGlobalAcceleratorManager;
 		// #110897#
 		const ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >&        mxServiceFactory;
+		sal_Int16                                                                                      m_nSymbolsStyle;
 };
 
 } // namespace
--- framework/source/uiconfiguration/moduleimagemanager.cxx	2005-03-01 20:39:42.000000000 +0100
+++ framework/source/uiconfiguration/moduleimagemanager.cxx	2005-05-20 18:44:19.418232163 +0200
@@ -140,6 +140,10 @@
 #include <vcl/pngwrite.hxx>
 #endif
 
+#ifndef INCLUDED_SVTOOLS_MISCOPT_HXX
+#include "svtools/miscopt.hxx"
+#endif
+
 //_________________________________________________________________________________________________________________
 //	namespaces
 //_________________________________________________________________________________________________________________
@@ -230,7 +234,8 @@ static GlobalImageList* getGlobalImageLi
 CmdImageList::CmdImageList( const uno::Reference< XMultiServiceFactory >& rServiceManager, const rtl::OUString& aModuleIdentifier ) :
     m_aModuleIdentifier( aModuleIdentifier ),
     m_bVectorInit( sal_False ),
-    m_xServiceManager( rServiceManager )
+    m_xServiceManager( rServiceManager ),
+    m_nSymbolsStyle( SvtMiscOptions().GetCurrentSymbolsStyle() )
 {
     for ( sal_Int32 n=0; n < ImageType_COUNT; n++ )
         m_pImageList[n] = 0;
@@ -310,6 +315,16 @@ void CmdImageList::impl_fillCommandToIma
 
 ImageList* CmdImageList::impl_getImageList( sal_Int16 nImageType )
 {
+    SvtMiscOptions aMiscOptions;
+
+    sal_Int16 nSymbolsStyle = aMiscOptions.GetCurrentSymbolsStyle();
+    if ( nSymbolsStyle != m_nSymbolsStyle )
+    {
+        m_nSymbolsStyle = nSymbolsStyle;
+        for ( sal_Int32 n=0; n < ImageType_COUNT; n++ )
+            delete m_pImageList[n], m_pImageList[n] = NULL;
+    }
+
     if ( !m_pImageList[nImageType] )
     {
         m_pImageList[nImageType] = new ImageList( m_aImageNameVector,
--- framework/source/uielement/menubarmanager.cxx	2005-03-29 17:49:25.000000000 +0200
+++ framework/source/uielement/menubarmanager.cxx	2005-05-20 16:58:29.368531775 +0200
@@ -218,6 +218,10 @@
 #include <rtl/logfile.hxx>
 #endif
 
+#ifndef INCLUDED_SVTOOLS_MISCOPT_HXX
+#include "svtools/miscopt.hxx"
+#endif
+
 //_________________________________________________________________________________________________________________
 //	namespace
 //_________________________________________________________________________________________________________________
@@ -318,6 +322,7 @@ MenuBarManager::MenuBarManager(
     , m_bModuleIdentified( sal_False )
     , m_bRetrieveImages( sal_False )
     , m_bAcceleratorCfg( sal_False )
+    , m_nSymbolsStyle( SvtMiscOptions().GetCurrentSymbolsStyle() )
 {
     m_xPopupMenuControllerRegistration = Reference< ::com::sun::star::frame::XUIControllerRegistration >(
 		getServiceFactory()->createInstance( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "com.sun.star.frame.PopupMenuControllerFactory" ))),
@@ -338,6 +343,7 @@ MenuBarManager::MenuBarManager(
     , m_bModuleIdentified( sal_False )
     , m_bRetrieveImages( sal_False )
     , m_bAcceleratorCfg( sal_False )
+    , m_nSymbolsStyle( SvtMiscOptions().GetCurrentSymbolsStyle() )
 {
 	m_bActive			= sal_False;
 	m_bDeleteMenu		= bDelete;
@@ -425,6 +431,7 @@ MenuBarManager::MenuBarManager(
     , m_bModuleIdentified( sal_False )
     , m_bRetrieveImages( sal_False )
     , m_bAcceleratorCfg( sal_False )
+    , m_nSymbolsStyle( SvtMiscOptions().GetCurrentSymbolsStyle() )
 {
 	m_bActive			= sal_False;
 	m_bDeleteMenu		= bDelete;
@@ -1102,15 +1109,18 @@ IMPL_LINK( MenuBarManager, Activate, Men
 		// Check if some modes have changed so we have to update our menu images
 		const StyleSettings& rSettings = Application::GetSettings().GetStyleSettings();
 		sal_Bool bIsHiContrast = rSettings.GetMenuColor().IsDark();
+		sal_Int16 nSymbolsStyle = SvtMiscOptions().GetCurrentSymbolsStyle();
 
 		if ( m_bRetrieveImages ||
              m_bWasHiContrast != bIsHiContrast ||
-             bShowMenuImages != m_bShowMenuImages )
+             bShowMenuImages != m_bShowMenuImages ||
+             nSymbolsStyle != m_nSymbolsStyle )
 		{
 			// The mode changed so we have to replace all images
 			m_bWasHiContrast	= bIsHiContrast;
 			m_bShowMenuImages	= bShowMenuImages;
 			m_bRetrieveImages	= sal_False;
+			m_nSymbolsStyle		= nSymbolsStyle;
 			AddonsOptions		aAddonOptions;
 
 			for ( USHORT nPos = 0; nPos < pMenu->GetItemCount(); nPos++ )
