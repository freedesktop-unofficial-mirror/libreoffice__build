Index: officecfg/registry/data/org/openoffice/Office/Writer.xcu
===================================================================
RCS file: /cvs/util/officecfg/registry/data/org/openoffice/Office/Writer.xcu,v
retrieving revision 1.19
retrieving revision 1.19.88.1
diff -u -p -r1.19 -r1.19.88.1
--- officecfg/registry/data/org/openoffice/Office/Writer.xcu	16 Nov 2004 16:54:44 -0000	1.19
+++ officecfg/registry/data/org/openoffice/Office/Writer.xcu	7 Feb 2005 16:32:38 -0000	1.19.88.1
@@ -245,13 +245,13 @@
      <value>true</value>
     </prop>
     <prop oor:name="Greeting" oor:type="xs:string">
-     <value></value>
+     <value>Sincerely</value>
     </prop>
     <prop oor:name="PaperCompanyAddressReceiverField" oor:type="xs:boolean">
-     <value>false</value>
+     <value>true</value>
     </prop>
     <prop oor:name="PaperFooter" oor:type="xs:boolean">
-     <value>false</value>
+     <value>true</value>
     </prop>
     <prop oor:name="PaperFooterHeight" oor:type="xs:double">
      <value>3.1</value>
@@ -281,7 +281,7 @@
      <value>1</value>
     </prop>
     <prop oor:name="Salutation" oor:type="xs:string">
-     <value/>
+     <value>To Whom it May Concern</value>
     </prop>
     <prop oor:name="SenderAddressType" oor:type="xs:int">
      <value>1</value>
@@ -305,11 +305,11 @@
      <value/>
     </prop>
     <prop oor:name="TemplatePath" oor:type="xs:string">
-     <value></value>
+     <value>myBusinessLetterTemplate.ott</value>
     </prop>
     <node oor:name="CompanyAddress">
      <prop oor:name="Display" oor:type="xs:boolean">
-      <value>false</value>
+      <value>true</value>
      </prop>
      <prop oor:name="Height" oor:type="xs:double">
       <value>4</value>
@@ -326,7 +326,7 @@
     </node>
     <node oor:name="CompanyLogo">
      <prop oor:name="Display" oor:type="xs:boolean">
-      <value>false</value>
+      <value>true</value>
      </prop>
      <prop oor:name="Height" oor:type="xs:double">
       <value>4</value>
@@ -341,13 +341,22 @@
       <value>0</value>
      </prop>
     </node>
+    <prop oor:name="Norm" oor:type="xs:int">
+     <value>0</value>
+    </prop>
+    <prop oor:name="PrintLetterSigns" oor:type="xs:boolean">
+     <value>true</value>
+    </prop>
+    <prop oor:name="SenderState" oor:type="xs:string">
+     <value/>
+    </prop>
    </node>
    <node oor:name="PrivateLetter">
     <prop oor:name="CreationType" oor:type="xs:int">
      <value>0</value>
     </prop>
     <prop oor:name="Greeting" oor:type="xs:string">
-     <value/>
+     <value>Cheers</value>
     </prop>
     <prop oor:name="PrintGreeting" oor:type="xs:boolean">
      <value>true</value>
@@ -359,7 +368,7 @@
      <value>true</value>
     </prop>
     <prop oor:name="Salutation" oor:type="xs:string">
-     <value/>
+     <value>Hello</value>
     </prop>
     <prop oor:name="Style" oor:type="xs:int">
      <value>0</value>
@@ -368,8 +377,102 @@
      <value/>
     </prop>
     <prop oor:name="TemplatePath" oor:type="xs:string">
+     <value>myPrivateLetterTemplate.ott</value>
+    </prop>
+    <prop oor:name="BusinessPaper" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="Footer" oor:type="xs:string">
      <value/>
     </prop>
+    <prop oor:name="FooterOnlySecondPage" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="FooterPageNumbers" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="Norm" oor:type="xs:int">
+     <value>0</value>
+    </prop>
+    <prop oor:name="PaperCompanyAddressReceiverField" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PaperFooter" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PaperFooterHeight" oor:type="xs:double">
+     <value>0</value>
+    </prop>
+    <prop oor:name="PrintBendMarks" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PrintCompanyAddressReceiverField" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PrintCompanyLogo" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PrintFooter" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PrintLetterSigns" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="ReceiverAddressType" oor:type="xs:int">
+     <value>0</value>
+    </prop>
+    <prop oor:name="SenderAddressType" oor:type="xs:int">
+     <value>0</value>
+    </prop>
+    <prop oor:name="SenderCity" oor:type="xs:string">
+     <value/>
+    </prop>
+    <prop oor:name="SenderCompanyName" oor:type="xs:string">
+     <value/>
+    </prop>
+    <prop oor:name="SenderPostCode" oor:type="xs:string">
+     <value/>
+    </prop>
+    <prop oor:name="SenderState" oor:type="xs:string">
+     <value/>
+    </prop>
+    <prop oor:name="SenderStreet" oor:type="xs:string">
+     <value/>
+    </prop>
+    <node oor:name="CompanyAddress">
+     <prop oor:name="Display" oor:type="xs:boolean">
+      <value>false</value>
+     </prop>
+     <prop oor:name="Height" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Width" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="X" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Y" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+    </node>
+    <node oor:name="CompanyLogo">
+     <prop oor:name="Display" oor:type="xs:boolean">
+      <value>false</value>
+     </prop>
+     <prop oor:name="Height" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Width" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="X" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Y" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+    </node>
    </node>
    <node oor:name="PrivateOfficialLetter">
     <prop oor:name="CreationType" oor:type="xs:int">
@@ -379,7 +482,7 @@
      <value>true</value>
     </prop>
     <prop oor:name="Greeting" oor:type="xs:string">
-     <value/>
+     <value>Best regards</value>
     </prop>
     <prop oor:name="PrintBendMarks" oor:type="xs:boolean">
      <value>true</value>
@@ -403,7 +506,7 @@
      <value>1</value>
     </prop>
     <prop oor:name="Salutation" oor:type="xs:string">
-     <value/>
+     <value>Dear Sir or Madam</value>
     </prop>
     <prop oor:name="SenderAddressType" oor:type="xs:int">
      <value>1</value>
@@ -430,8 +533,69 @@
      <value/>
     </prop>
     <prop oor:name="TemplatePath" oor:type="xs:string">
+     <value>myFormalLetterTemplate.ott</value>
+    </prop>
+    <prop oor:name="BusinessPaper" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="Footer" oor:type="xs:string">
      <value/>
     </prop>
+    <prop oor:name="FooterOnlySecondPage" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="Norm" oor:type="xs:int">
+     <value>0</value>
+    </prop>
+    <prop oor:name="PaperCompanyAddressReceiverField" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PaperFooter" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PaperFooterHeight" oor:type="xs:double">
+     <value>0</value>
+    </prop>
+    <prop oor:name="PrintCompanyLogo" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <prop oor:name="PrintLetterSigns" oor:type="xs:boolean">
+     <value>false</value>
+    </prop>
+    <node oor:name="CompanyAddress">
+     <prop oor:name="Display" oor:type="xs:boolean">
+      <value>false</value>
+     </prop>
+     <prop oor:name="Height" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Width" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="X" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Y" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+    </node>
+    <node oor:name="CompanyLogo">
+     <prop oor:name="Display" oor:type="xs:boolean">
+      <value>false</value>
+     </prop>
+     <prop oor:name="Height" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Width" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="X" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+     <prop oor:name="Y" oor:type="xs:double">
+      <value>0</value>
+     </prop>
+    </node>
    </node>
   </node>
   <node oor:name="Fax">
Index: wizards/com/sun/star/wizards/common/Configuration.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/common/Configuration.java,v
retrieving revision 1.3
retrieving revision 1.3.36.1
diff -u -p -r1.3 -r1.3.36.1
--- wizards/com/sun/star/wizards/common/Configuration.java	27 Oct 2004 13:28:13 -0000	1.3
+++ wizards/com/sun/star/wizards/common/Configuration.java	7 Feb 2005 13:21:43 -0000	1.3.36.1
@@ -65,6 +65,7 @@ import com.sun.star.lang.WrappedTargetEx
 import com.sun.star.lang.XMultiServiceFactory;
 import com.sun.star.lang.XSingleServiceFactory;
 import com.sun.star.uno.AnyConverter;
+import com.sun.star.uno.Exception;
 import com.sun.star.uno.UnoRuntime;
 import com.sun.star.lang.Locale;
 import com.sun.star.util.XChangesBatch;
@@ -213,6 +214,17 @@ public abstract class Configuration {
 			return null;
 		}
 	}
+	
+	public static String getOfficeLinguistic(XMultiServiceFactory xMSF) {
+		try {
+			Object oMasterKey = getConfigurationRoot(xMSF, "org.openoffice.Office.Linguistic/General/", false);
+			String sLinguistic = (String) Helper.getUnoObjectbyName(oMasterKey, "DefaultLocale");
+			return sLinguistic;
+		} catch (Exception exception) {			
+			exception.printStackTrace();
+			return null;
+		}		
+	}
 
 	/**
 	 * This method creates a new configuration node and adds it
@@ -280,13 +292,9 @@ public abstract class Configuration {
 	
 	
 	public static String[] getNodeDisplayNames(XNameAccess _xNameAccessNode){
-	String[] snames = null;
-	try {
-		return getNodeChildNames(_xNameAccessNode, "Name");
-	} catch (Exception e) {
-		e.printStackTrace(System.out);
-		return snames;
-	}}
+	String[] snames = null;	
+	return getNodeChildNames(_xNameAccessNode, "Name");		
+	}
 	
 
 	public static String[] getNodeChildNames(XNameAccess xNameAccessNode, String _schildname){
Index: wizards/com/sun/star/wizards/fax/FaxDocument.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/fax/FaxDocument.java,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
--- wizards/com/sun/star/wizards/fax/FaxDocument.java	27 Nov 2004 09:05:43 -0000	1.3
+++ wizards/com/sun/star/wizards/fax/FaxDocument.java	24 Feb 2005 15:49:22 -0000	1.3.20.1
@@ -21,7 +21,6 @@ import com.sun.star.style.XStyle;
 public class FaxDocument extends TextDocument {
 
 	XDesktop xDesktop;
-	Size DocSize = null;	
 	boolean keepLogoFrame = true;
 	boolean keepTypeFrame = true;
 
Index: wizards/com/sun/star/wizards/fax/FaxWizardDialogImpl.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/fax/FaxWizardDialogImpl.java,v
retrieving revision 1.3
retrieving revision 1.3.20.2
diff -u -p -r1.3 -r1.3.20.2
--- wizards/com/sun/star/wizards/fax/FaxWizardDialogImpl.java	27 Nov 2004 09:05:56 -0000	1.3
+++ wizards/com/sun/star/wizards/fax/FaxWizardDialogImpl.java	24 Feb 2005 15:49:22 -0000	1.3.20.2
@@ -28,6 +28,7 @@ import com.sun.star.wizards.document.*;
 import com.sun.star.wizards.ui.*;
 import com.sun.star.wizards.ui.event.*;
 import com.sun.star.wizards.common.Helper;
+import com.sun.star.document.MacroExecMode;
 
 public class FaxWizardDialogImpl extends FaxWizardDialog {
 
@@ -168,10 +169,6 @@ public class FaxWizardDialogImpl extends
 				sPath = myPathSelection.getSelectedPath();
 			}
 			sPath = fileAccess.getURL(sPath);
-			myFaxDoc.killEmptyUserFields();
-			myFaxDoc.keepLogoFrame = (chkUseLogo.getState() != 0);
-			myFaxDoc.keepTypeFrame = (chkUseCommunicationType.getState() != 0);
-			myFaxDoc.killEmptyFrames();
 			
 			//first, if the filename was not changed, thus
 			//it is coming from a saved session, check if the
@@ -183,6 +180,11 @@ public class FaxWizardDialogImpl extends
 					if (answer == 3) // user said: no, do not overwrite....
 						return;
 				}
+			myFaxDoc.setWizardTemplateDocInfo(resources.resFaxWizardDialog_title, resources.resTemplateDescription);
+			myFaxDoc.killEmptyUserFields();
+			myFaxDoc.keepLogoFrame = (chkUseLogo.getState() != 0);
+			myFaxDoc.keepTypeFrame = (chkUseCommunicationType.getState() != 0);
+			myFaxDoc.killEmptyFrames();
 
 			
 			bSaveSuccess = OfficeDocument.store(xMSF, xTextDocument, sPath, "writer8_template", false, "Template could not be saved to" + sPath);
@@ -191,15 +193,23 @@ public class FaxWizardDialogImpl extends
 				xWindow.setVisible(false);
 				closeDocument();
 				//myFaxDoc.xTextDocument.unlockControllers();
-				PropertyValue loadValues[] = new PropertyValue[1];
+
+				PropertyValue loadValues[] = new PropertyValue[3];
 				loadValues[0] = new PropertyValue();
 				loadValues[0].Name = "AsTemplate";
+				loadValues[1] = new PropertyValue();
+				loadValues[1].Name = "MacroExecutionMode";
+				loadValues[1].Value = new Short (MacroExecMode.ALWAYS_EXECUTE);
+				loadValues[2] = new PropertyValue();
+				loadValues[2].Name = "UpdateDocMode";
+				loadValues[2].Value = new Short (com.sun.star.document.UpdateDocMode.FULL_UPDATE);
+				
 				if (bEditTemplate) {
 					loadValues[0].Value = Boolean.FALSE;
 				} else {
 					loadValues[0].Value = Boolean.TRUE;
 				}
-				Object oDoc = OfficeDocument.load(Desktop.getDesktop(xMSF), sPath, "_blank", loadValues);
+				Object oDoc = OfficeDocument.load(Desktop.getDesktop(xMSF), sPath, "_default", loadValues);
 				XTextDocument xTextDocument = (com.sun.star.text.XTextDocument) oDoc;
 				XMultiServiceFactory xDocMSF = (XMultiServiceFactory) UnoRuntime.queryInterface(XMultiServiceFactory.class, xTextDocument);
 				ViewHandler myViewHandler = new ViewHandler(xDocMSF, xTextDocument);
@@ -672,4 +682,4 @@ public class FaxWizardDialogImpl extends
 
 
 
-    
\ No newline at end of file
+    
Index: wizards/com/sun/star/wizards/letter/LetterDocument.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/letter/LetterDocument.java,v
retrieving revision 1.5
retrieving revision 1.5.2.1
diff -u -p -r1.5 -r1.5.2.1
--- wizards/com/sun/star/wizards/letter/LetterDocument.java	27 Jan 2005 10:38:34 -0000	1.5
+++ wizards/com/sun/star/wizards/letter/LetterDocument.java	24 Feb 2005 15:49:23 -0000	1.5.2.1
@@ -21,8 +21,7 @@ import com.sun.star.style.XStyle;
 
 public class LetterDocument extends TextDocument {
 
-	XDesktop xDesktop;
-	//Size DocSize = null;	
+	XDesktop xDesktop;	
 	boolean keepLogoFrame = true;
 	boolean keepBendMarksFrame = true;
 	boolean keepLetterSignsFrame = true;
Index: wizards/com/sun/star/wizards/letter/LetterWizardDialogImpl.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/letter/LetterWizardDialogImpl.java,v
retrieving revision 1.4
retrieving revision 1.4.20.2
diff -u -p -r1.4 -r1.4.20.2
--- wizards/com/sun/star/wizards/letter/LetterWizardDialogImpl.java	27 Nov 2004 09:06:34 -0000	1.4
+++ wizards/com/sun/star/wizards/letter/LetterWizardDialogImpl.java	16 Feb 2005 09:02:30 -0000	1.4.20.2
@@ -2,8 +2,10 @@ package com.sun.star.wizards.letter;
 
 import java.util.Vector;
 import com.sun.star.lang.IllegalArgumentException;
+import com.sun.star.lang.Locale;
 import com.sun.star.lang.WrappedTargetException;
 import com.sun.star.lang.XMultiServiceFactory;
+import com.sun.star.wizards.common.Configuration;
 import com.sun.star.wizards.common.Desktop;
 import com.sun.star.wizards.common.NoValidPathException;
 import com.sun.star.wizards.common.SystemDialog;
@@ -13,9 +15,12 @@ import com.sun.star.awt.XWindow;
 import com.sun.star.awt.XWindowPeer;
 import com.sun.star.beans.PropertyValue;
 import com.sun.star.container.NoSuchElementException;
+import com.sun.star.document.MacroExecMode;
 import com.sun.star.document.XDocumentInfo;
 import com.sun.star.document.XDocumentInfoSupplier;
 import com.sun.star.uno.AnyConverter;
+import com.sun.star.uno.Exception;
+import com.sun.star.uno.RuntimeException;
 import com.sun.star.uno.UnoRuntime;
 import com.sun.star.wizards.text.*;
 import com.sun.star.wizards.common.*;
@@ -79,14 +84,19 @@ public class LetterWizardDialogImpl exte
 
 	public static void main(String args[]) {
 		//only being called when starting wizard remotely
-		try {
+		
 			String ConnectStr = "uno:socket,host=127.0.0.1,port=8100;urp,negotiate=0,forcesynchronous=1;StarOffice.NamingService";		
-			XMultiServiceFactory xLocMSF = Desktop.connect(ConnectStr);
+			XMultiServiceFactory xLocMSF = null;
+			try {
+				xLocMSF = Desktop.connect(ConnectStr);
+			} catch (Exception e) {
+				e.printStackTrace();
+			} catch (java.lang.Exception e) {
+				e.printStackTrace();
+			}
 			LetterWizardDialogImpl lw = new LetterWizardDialogImpl(xLocMSF);
 			lw.startWizard(xLocMSF, null);		
-		} catch (Exception e) {			
-			e.printStackTrace();		
-		}		
+				
 	}
 
 	public void startWizard(XMultiServiceFactory xMSF, Object[] CurPropertyValue) {
@@ -119,6 +129,8 @@ public class LetterWizardDialogImpl exte
 			//load the last used settings from the registry and apply listeners to the controls:
 			initConfiguration();
 			
+			//set the language according to the Linguistic
+			getCurrentLetter().cp_Norm = getOfficeLinguistic();
 			initializeTemplates(xMSF);
 			
 			//update the dialog UI according to the loaded Configuration
@@ -162,7 +174,6 @@ public class LetterWizardDialogImpl exte
 
 	public void finishWizard() {
 		switchToStep(getCurrentStep(),getMaxStep());
-		myLetterDoc.setWizardTemplateDocInfo(resources.resLetterWizardDialog_title, resources.resTemplateDescription);
 		try {
 			//myLetterDoc.xTextDocument.lockControllers();
 			FileAccess fileAccess = new FileAccess(xMSF);
@@ -172,11 +183,6 @@ public class LetterWizardDialogImpl exte
 				sPath = myPathSelection.getSelectedPath();
 			}
 			sPath = fileAccess.getURL(sPath);			
-			myLetterDoc.killEmptyUserFields();
-			myLetterDoc.keepLogoFrame = (chkUseLogo.getState() != 0);
-			myLetterDoc.keepBendMarksFrame = (chkUseBendMarks.getState() != 0);
-			myLetterDoc.keepLetterSignsFrame = (chkUseSigns.getState() != 0);
-			myLetterDoc.killEmptyFrames();
 			
 			//first, if the filename was not changed, thus
 			//it is coming from a saved session, check if the
@@ -188,19 +194,31 @@ public class LetterWizardDialogImpl exte
 					if (answer == 3) // user said: no, do not overwrite....
 						return;
 				}
+			myLetterDoc.setWizardTemplateDocInfo(resources.resLetterWizardDialog_title, resources.resTemplateDescription);
+			myLetterDoc.killEmptyUserFields();
+			myLetterDoc.keepLogoFrame = (chkUseLogo.getState() != 0);
+			myLetterDoc.keepBendMarksFrame = (chkUseBendMarks.getState() != 0);
+			myLetterDoc.keepLetterSignsFrame = (chkUseSigns.getState() != 0);
+			myLetterDoc.killEmptyFrames();
 
 			
-			//bSaveSuccess = OfficeDocument.store(xMSF, xTextDocument, sPath, "writer_StarOffice_XML_Writer_Template", false, "Template could not be saved!");
-				bSaveSuccess = OfficeDocument.store(xMSF, xTextDocument, sPath, "writer8_template", false, "Template could not be saved to " + sPath);
+			bSaveSuccess = OfficeDocument.store(xMSF, xTextDocument, sPath, "writer8_template", false, "Template could not be saved to " + sPath);
 			
 			if (bSaveSuccess) {
 				saveConfiguration();
 				xWindow.setVisible(false);
 				closeDocument();
 				//myLetterDoc.xTextDocument.unlockControllers();
-				PropertyValue loadValues[] = new PropertyValue[1];
+				PropertyValue loadValues[] = new PropertyValue[3];
 				loadValues[0] = new PropertyValue();
 				loadValues[0].Name = "AsTemplate";
+				loadValues[1] = new PropertyValue();
+				loadValues[1].Name = "MacroExecutionMode";
+				loadValues[1].Value = new Short (MacroExecMode.ALWAYS_EXECUTE);
+				loadValues[2] = new PropertyValue();
+				loadValues[2].Name = "UpdateDocMode";
+				loadValues[2].Value = new Short (com.sun.star.document.UpdateDocMode.FULL_UPDATE);
+				
 				if (bEditTemplate) {
 					loadValues[0].Value = Boolean.FALSE;
 				} else {
@@ -539,7 +557,6 @@ public class LetterWizardDialogImpl exte
 				myLetterDoc.switchElement("Company Logo", logostatus);				
 			}
 		} catch (IllegalArgumentException e) {
-			// TODO Auto-generated catch block
 			e.printStackTrace();
 		}
 	}
@@ -551,7 +568,6 @@ public class LetterWizardDialogImpl exte
 				myLetterDoc.switchElement("Sender Address Repeated", rstatus);
 			}
 		} catch (IllegalArgumentException e) {
-			// TODO Auto-generated catch block
 			e.printStackTrace();
 		}
 	}
@@ -613,10 +629,6 @@ public class LetterWizardDialogImpl exte
 	private void setPossibleAddressReceiver(boolean bState) {
 		if (myLetterDoc.hasElement("Sender Address Repeated")) {		
 			setControlProperty("chkUseAddressReceiver", "Enabled", new Boolean(bState));
-			/*
-			if (!bState) {
-				chkUseAddressReceiver.setState((short) 0);
-			}*/
 			chkUseAddressReceiverItemChanged();
 		}
 	}
@@ -714,7 +726,19 @@ public class LetterWizardDialogImpl exte
 			enableBusinessPaper();
 		} else {
 			disableBusinessPaper();
+			setPossibleSenderData(true);
+		}
+	}
+	
+	private int getOfficeLinguistic() {
+		int oL = 0;
+		String OfficeLinguistic = Configuration.getOfficeLinguistic(xMSF);
+		for (int i = 0; i < Norms.length; i++){
+			if (Norms[i].equalsIgnoreCase(OfficeLinguistic)) {
+				oL = i;
+			}
 		}
+		return oL;
 	}
 	
 	private void setPossibleSenderData(boolean bState) {
Index: wizards/com/sun/star/wizards/ui/WizardDialog.java
===================================================================
RCS file: /cvs/installation/wizards/com/sun/star/wizards/ui/WizardDialog.java,v
retrieving revision 1.7
retrieving revision 1.7.18.1
diff -u -p -r1.7 -r1.7.18.1
--- wizards/com/sun/star/wizards/ui/WizardDialog.java	29 Nov 2004 14:52:54 -0000	1.7
+++ wizards/com/sun/star/wizards/ui/WizardDialog.java	16 Feb 2005 09:02:30 -0000	1.7.18.1
@@ -498,7 +498,6 @@ public abstract class WizardDialog exten
 	public abstract void finishWizard();
     
     public void finishWizard_1() {
-        wizardClosed = true;
         finishWizard();
         Desktop.getDesktop(xMSF).removeTerminateListener(this);
     }
@@ -557,13 +556,8 @@ public abstract class WizardDialog exten
      * perform a cancel.
      */
     public void cancelWizard_1() {
-        if (wizardClosed)
-           return;
-        else {
-            wizardClosed = true;
-            cancelWizard();
-            Desktop.getDesktop(xMSF).removeTerminateListener(this);
-        }
+    	cancelWizard();
+		Desktop.getDesktop(xMSF).removeTerminateListener(this);
     }
     
     public void windowHidden() {
Index: extras/source/templates/wizard/fax/lang/de/bus-classic-pri_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/bus-classic-pri_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.2
diff -u -p -r1.4 -r1.4.20.2
Binary files /tmp/cvs5Raaym and /tmp/cvs6Raaym differ
Index: extras/source/templates/wizard/fax/lang/de/bus-classic_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/bus-classic_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.3
diff -u -p -r1.4 -r1.4.20.3
Binary files /tmp/cvs7Raaym and /tmp/cvs8Raaym differ
Index: extras/source/templates/wizard/fax/lang/de/bus-modern-pri_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/bus-modern-pri_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.2
diff -u -p -r1.4 -r1.4.20.2
Binary files /tmp/cvs9Raaym and /tmp/cvs.Raaym differ
Index: extras/source/templates/wizard/fax/lang/de/bus-modern_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/bus-modern_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.2
diff -u -p -r1.4 -r1.4.20.2
Binary files /tmp/cvs_Raaym and /tmp/cvsaSaaym differ
Index: extras/source/templates/wizard/fax/lang/de/pri-bottle_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/pri-bottle_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsbSaaym and /tmp/cvscSaaym differ
Index: extras/source/templates/wizard/fax/lang/de/pri-fax_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/pri-fax_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsdSaaym and /tmp/cvseSaaym differ
Index: extras/source/templates/wizard/fax/lang/de/pri-lines_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/pri-lines_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsfSaaym and /tmp/cvsgSaaym differ
Index: extras/source/templates/wizard/fax/lang/de/pri-marine_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/de/pri-marine_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvshSaaym and /tmp/cvsiSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/bus-classic-pri_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/bus-classic-pri_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsjSaaym and /tmp/cvskSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/bus-classic_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/bus-classic_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvslSaaym and /tmp/cvsmSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/bus-modern-pri_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/bus-modern-pri_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsnSaaym and /tmp/cvsoSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/bus-modern_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/bus-modern_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvspSaaym and /tmp/cvsqSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/pri-bottle_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/pri-bottle_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsrSaaym and /tmp/cvssSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/pri-fax_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/pri-fax_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvstSaaym and /tmp/cvsuSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/pri-lines_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/pri-lines_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsvSaaym and /tmp/cvswSaaym differ
Index: extras/source/templates/wizard/fax/lang/en-US/pri-marine_f.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/fax/lang/en-US/pri-marine_f.ott,v
retrieving revision 1.4
retrieving revision 1.4.20.1
diff -u -p -r1.4 -r1.4.20.1
Binary files /tmp/cvsxSaaym and /tmp/cvsySaaym differ
Index: extras/source/templates/wizard/letter/lang/de/bus-elegant_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/bus-elegant_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvszSaaym and /tmp/cvsASaaym differ
Index: extras/source/templates/wizard/letter/lang/de/bus-modern_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/bus-modern_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvsBSaaym and /tmp/cvsCSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/bus-office_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/bus-office_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvsDSaaym and /tmp/cvsESaaym differ
Index: extras/source/templates/wizard/letter/lang/de/off-elegant_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/off-elegant_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvsFSaaym and /tmp/cvsGSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/off-modern_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/off-modern_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvsHSaaym and /tmp/cvsISaaym differ
Index: extras/source/templates/wizard/letter/lang/de/off-office_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/off-office_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.2
diff -u -p -r1.4 -r1.4.4.2
Binary files /tmp/cvsJSaaym and /tmp/cvsKSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/pri-bottle_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/pri-bottle_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvsLSaaym and /tmp/cvsMSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/pri-mail_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/pri-mail_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvsNSaaym and /tmp/cvsOSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/pri-marine_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/pri-marine_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvsPSaaym and /tmp/cvsQSaaym differ
Index: extras/source/templates/wizard/letter/lang/de/pri-redline_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/de/pri-redline_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvsRSaaym and /tmp/cvsSSaaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/bus-elegant_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/bus-elegant_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvsTSaaym and /tmp/cvsUSaaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/bus-modern_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/bus-modern_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvsVSaaym and /tmp/cvsWSaaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/bus-office_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/bus-office_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvsXSaaym and /tmp/cvsYSaaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/off-elegant_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/off-elegant_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvsZSaaym and /tmp/cvs0Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/off-modern_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/off-modern_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvs1Saaym and /tmp/cvs2Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/off-office_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/off-office_l.ott,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -r1.4 -r1.4.4.1
Binary files /tmp/cvs3Saaym and /tmp/cvs4Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/pri-bottle_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/pri-bottle_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvs5Saaym and /tmp/cvs6Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/pri-mail_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/pri-mail_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvs7Saaym and /tmp/cvs8Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/pri-marine_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/pri-marine_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvs9Saaym and /tmp/cvs.Saaym differ
Index: extras/source/templates/wizard/letter/lang/en-US/pri-redline_l.ott
===================================================================
RCS file: /cvs/installation/extras/source/templates/wizard/letter/lang/en-US/pri-redline_l.ott,v
retrieving revision 1.3
retrieving revision 1.3.20.1
diff -u -p -r1.3 -r1.3.20.1
Binary files /tmp/cvs_Saaym and /tmp/cvsaTaaym differ
