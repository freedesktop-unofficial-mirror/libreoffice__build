Index: sd/source/filter/html/pubdlg.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/filter/html/pubdlg.cxx,v
retrieving revision 1.3
diff -u -p -u -r1.3 pubdlg.cxx
--- sd/source/filter/html/pubdlg.cxx	16 Jul 2002 08:13:01 -0000	1.3
+++ sd/source/filter/html/pubdlg.cxx	14 Aug 2003 13:27:28 -0000
@@ -509,7 +509,7 @@ SdPublishingDlg::SdPublishingDlg(Window*
 	pPage2_Index->SetText(aText);
 	pPage2_CGI->SetText( UniString::CreateFromAscii( RTL_CONSTASCII_STRINGPARAM( "/cgi-bin/" ) ) );
 
-	pPage3_Gif->SetClickHdl(LINK(this,SdPublishingDlg, GfxFormatHdl));
+	pPage3_Png->SetClickHdl(LINK(this,SdPublishingDlg, GfxFormatHdl));
 	pPage3_Jpg->SetClickHdl(LINK(this,SdPublishingDlg, GfxFormatHdl));
 
 	pPage3_Resolution_1->SetClickHdl(LINK(this,SdPublishingDlg, ResolutionHdl ));
@@ -663,7 +663,7 @@ void SdPublishingDlg::CreatePages()
 	aAssistentFunc.InsertControl(3,
 		pPage3_Titel1 = new FixedLine(this,SdResId(PAGE3_TITEL_1)));
 	aAssistentFunc.InsertControl(3,
-		pPage3_Gif = new RadioButton(this,SdResId(PAGE3_GIF)));
+		pPage3_Png = new RadioButton(this,SdResId(PAGE3_PNG)));
 	aAssistentFunc.InsertControl(3,
 		pPage3_Jpg = new RadioButton(this,SdResId(PAGE3_JPG)));
 	aAssistentFunc.InsertControl(3,
@@ -814,7 +814,7 @@ void SdPublishingDlg::RemovePages()
 
 	delete pPage3_Bmp;
 	delete pPage3_Titel1;
-	delete pPage3_Gif;
+	delete pPage3_Png;
 	delete pPage3_Jpg;
 	delete pPage3_Quality_txt;
 	delete pPage3_Quality;
@@ -944,7 +944,7 @@ void SdPublishingDlg::GetParameterSequen
 	aProps.push_back( aValue );
 
 	aValue.Name = OUString( RTL_CONSTASCII_USTRINGPARAM( "Format" ) );
-	aValue.Value <<= (sal_Int32)(pPage3_Gif->IsChecked()?FORMAT_GIF:FORMAT_JPG);
+	aValue.Value <<= (sal_Int32)(pPage3_Png->IsChecked()?FORMAT_PNG:FORMAT_JPG);
 	aProps.push_back( aValue );
 
 	// Page 4
@@ -1128,10 +1128,10 @@ IMPL_LINK( SdPublishingDlg, WebServerHdl
 // =====================================================================
 IMPL_LINK( SdPublishingDlg, GfxFormatHdl, RadioButton *, pButton )
 {
-	if(pButton == pPage3_Gif)
+	if(pButton == pPage3_Png)
 		pPage3_Jpg->Check(FALSE);
 	else
-		pPage3_Gif->Check(FALSE);
+		pPage3_Png->Check(FALSE);
 
 	pPage3_Quality->Enable(pButton == pPage3_Jpg);
 	return 0;
@@ -1551,7 +1551,7 @@ void SdPublishingDlg::SetDesign( SdPubli
 
 	pPage2_Endless->Check( pDesign->m_bEndless );
 
-	pPage3_Gif->Check(pDesign->m_eFormat == FORMAT_GIF);
+	pPage3_Png->Check(pDesign->m_eFormat != FORMAT_JPG);
 	pPage3_Jpg->Check(pDesign->m_eFormat == FORMAT_JPG);
 
 	pPage3_Quality->SetText(pDesign->m_aCompression);
@@ -1611,7 +1611,7 @@ void SdPublishingDlg::GetDesign( SdPubli
 	pDesign->m_bContentPage = pPage2_Content->IsChecked();
 	if(m_bImpress)
 		pDesign->m_bNotes = pPage2_Notes->IsChecked();
-	pDesign->m_eFormat = pPage3_Gif->IsChecked()?FORMAT_GIF:FORMAT_JPG;
+	pDesign->m_eFormat = pPage3_Png->IsChecked()?FORMAT_PNG:FORMAT_JPG;
 	pDesign->m_aCompression = pPage3_Quality->GetText();
 
 	pDesign->m_nResolution = pPage3_Resolution_1->IsChecked()?PUB_LOWRES_WIDTH:
Index: sd/source/filter/html/pubdlg.hrc
===================================================================
RCS file: /cvs/graphics/sd/source/filter/html/pubdlg.hrc,v
retrieving revision 1.1
diff -u -p -u -r1.1 pubdlg.hrc
--- sd/source/filter/html/pubdlg.hrc	18 Apr 2002 15:04:35 -0000	1.1
+++ sd/source/filter/html/pubdlg.hrc	14 Aug 2003 13:27:28 -0000
@@ -108,7 +108,7 @@
 
 #define PAGE3_BMP			50
 #define PAGE3_TITEL_1		51
-#define PAGE3_GIF			52
+#define PAGE3_PNG			52
 #define PAGE3_JPG			53
 #define PAGE3_QUALITY_TXT	54
 #define PAGE3_QUALITY		55
Index: sd/source/filter/html/pubdlg.hxx
===================================================================
RCS file: /cvs/graphics/sd/source/filter/html/pubdlg.hxx,v
retrieving revision 1.2
diff -u -p -u -r1.2 pubdlg.hxx
--- sd/source/filter/html/pubdlg.hxx	16 Jul 2002 08:13:01 -0000	1.2
+++ sd/source/filter/html/pubdlg.hxx	14 Aug 2003 13:27:28 -0000
@@ -163,7 +163,7 @@ private:
 	// page 3 controls
 	FixedBitmap*	pPage3_Bmp;
 	FixedLine*		pPage3_Titel1;
-	RadioButton*	pPage3_Gif;
+	RadioButton*	pPage3_Png;
 	RadioButton*	pPage3_Jpg;
 	FixedText*		pPage3_Quality_txt;
 	ComboBox*		pPage3_Quality;
Index: sd/source/filter/html/pubdlg.src
===================================================================
RCS file: /cvs/graphics/sd/source/filter/html/pubdlg.src,v
retrieving revision 1.13
diff -u -p -u -r1.13 pubdlg.src
--- sd/source/filter/html/pubdlg.src	17 Jul 2003 12:39:25 -0000	1.13
+++ sd/source/filter/html/pubdlg.src	14 Aug 2003 13:27:30 -0000
@@ -1112,37 +1112,37 @@ ModalDialog DLG_PUBLISHING
 		Text[ slovak ] = "Uložiť obrázok ako";
 	};
 
-	RadioButton PAGE3_GIF
+	RadioButton PAGE3_PNG
 	{
 		Pos = MAP_APPFONT( 12, 49 );
 		Size = MAP_APPFONT( 116, 10 );
-		Text = "~GIF";
-		Text [ ENGLISH ] = "~GIF";
-		Text[ italian ] = "~GIF";
-		Text[ portuguese_brazilian ] = "~GIF";
-		Text[ portuguese ] = "~GIF - Graphics Interchange Format";
-		Text[ danish ] = "GIF - Graphics Interchange Format";
-		Text[ french ] = "GIF";
-		Text[ swedish ] = "~GIF";
-		Text[ dutch ] = "~GIF - Graphics Interchange-Format";
-		Text[ spanish ] = "~GIF ";
-		Text[ english_us ] = "~GIF";
-		Text[ chinese_simplified ] = "~GIF";
-		Text[ russian ] = "~GIF - Graphics Interchange Format";
-		Text[ polish ] = "GIF - Graphics Interchange Format";
-		Text[ japanese ] = "~GIF";
-		Text[ greek ] = "~GIF - Graphics Interchange Format";
-		Text[ korean ] = "~GIF";
-		Text[ chinese_traditional ] = "~GIF";
-		Text[ arabic ] = "GIF - Graphics Interchange-Format";
-		Text[ turkish ] = "~GIF";
-		Text[ catalan ] = "~GIF";
-		Text[ finnish ] = "~GIF";
-		Text[ thai ] = "~GIF - Graphics Interchange Format";
-		Text[ czech ] = "GIF";
-		Text[ hebrew ] = "~GIF";
-		Text[ hindi ] = "~GIF";
-		Text[ slovak ] = "~GIF";
+		Text = "~PNG";
+		Text [ ENGLISH ] = "~PNG";
+		Text[ italian ] = "~PNG";
+		Text[ portuguese_brazilian ] = "~PNG";
+		Text[ portuguese ] = "~PNG";
+		Text[ danish ] = "PNG";
+		Text[ french ] = "PNG";
+		Text[ swedish ] = "~PNG";
+		Text[ dutch ] = "~PNG";
+		Text[ spanish ] = "~PNG ";
+		Text[ english_us ] = "~PNG";
+		Text[ chinese_simplified ] = "~PNG";
+		Text[ russian ] = "~PNG";
+		Text[ polish ] = "PNG";
+		Text[ japanese ] = "~PNG";
+		Text[ greek ] = "~PNG";
+		Text[ korean ] = "~PNG";
+		Text[ chinese_traditional ] = "~PNG";
+		Text[ arabic ] = "PNG";
+		Text[ turkish ] = "~PNG";
+		Text[ catalan ] = "~PNG";
+		Text[ finnish ] = "~PNG";
+		Text[ thai ] = "~PNG";
+		Text[ czech ] = "PNG";
+		Text[ hebrew ] = "~PNG";
+		Text[ hindi ] = "~PNG";
+		Text[ slovak ] = "~PNG";
 	};
 
 	RadioButton PAGE3_JPG
Index: sd/inc/resltn.hxx
===================================================================
RCS file: /cvs/graphics/sd/inc/resltn.hxx,v
retrieving revision 1.1.1.1
diff -u -p -u -r1.1.1.1 resltn.hxx
--- sd/inc/resltn.hxx	18 Sep 2000 16:48:28 -0000	1.1.1.1
+++ sd/inc/resltn.hxx	14 Aug 2003 13:27:09 -0000
@@ -71,8 +71,9 @@ enum PublishingResolution
 
 enum PublishingFormat
 {
-	FORMAT_GIF,
-	FORMAT_JPG
+//	FORMAT_GIF,
+	FORMAT_JPG = 1,
+	FORMAT_PNG = 2
 };
 
 enum PublishingScript
Index: sd/source/filter/html/htmlex.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/filter/html/htmlex.cxx,v
retrieving revision 1.10
diff -u -p -u -r1.10 htmlex.cxx
--- sd/source/filter/html/htmlex.cxx	4 Jun 2003 11:02:23 -0000	1.10
+++ sd/source/filter/html/htmlex.cxx	14 Aug 2003 14:19:38 -0000
@@ -1077,7 +1077,7 @@ bool HtmlExport::CreateImagesForPresPage
 		Sequence< PropertyValue > aDescriptor( 3 );
 		aDescriptor[0].Name = OUString( RTL_CONSTASCII_USTRINGPARAM("URL") );
 		aDescriptor[1].Name = OUString( RTL_CONSTASCII_USTRINGPARAM("FilterName") );
-		aDescriptor[1].Value <<= OUString( RTL_CONSTASCII_USTRINGPARAM(m_eFormat==FORMAT_GIF ? "GIF" : "JPG") );
+		aDescriptor[1].Value <<= OUString( RTL_CONSTASCII_USTRINGPARAM(m_eFormat==FORMAT_JPG ? "JPG" : "PNG") );
 		aDescriptor[2].Name = OUString( RTL_CONSTASCII_USTRINGPARAM("FilterData") );
 		aDescriptor[2].Value <<= aFilterData;
 
@@ -2116,10 +2116,10 @@ void HtmlExport::CreateFileNames()
 
 		pName = new String( RTL_CONSTASCII_USTRINGPARAM("img") );
 		*pName += String::CreateFromInt32(nSdPage);
-		if( m_eFormat==FORMAT_GIF )
-            pName->AppendAscii( ".gif" );
+		if( m_eFormat!=FORMAT_JPG )
+			pName->AppendAscii( ".png" );
 		else
-            pName->AppendAscii( ".jpg" );
+			pName->AppendAscii( ".jpg" );
 
 		m_pImageFiles[nSdPage] = pName;
 
@@ -2726,11 +2726,13 @@ ULONG HtmlExport::CreateBitmap( ULONG nT
 			{
 				BitmapEx aBitmap( aGraphic.GetBitmapEx() );
 
-				if( aBitmap.GetTransparentType() != TRANSPARENT_NONE )
+				if( aBitmap.GetTransparentType() != TRANSPARENT_NONE &&
+				    m_eFormat != FORMAT_PNG )
 					SmoothBitmap( aBitmap, m_bUserAttr?m_aBackColor:m_aFirstPageColor );
 				aGraphic = Graphic( aBitmap );
 			}
-			nErr = GraphicConverter::Export( *pStrm, aGraphic, CVT_GIF );
+
+			nErr = GraphicConverter::Export( *pStrm, aGraphic, m_eFormat==FORMAT_JPG?CVT_JPG:CVT_PNG );
 		}
 
 		if( nErr == 0 )
@@ -3455,6 +3457,16 @@ String HtmlExport::GetButtonName( USHORT
 {
 	String aName;
 	aName.AssignAscii( pButtonNames[nButton] );
+	
+	xub_StrLen nExtnOffset;
+	if ( ( nExtnOffset = aName.SearchBackward( '.' ) ) > 0 ) {
+		aName.Erase( nExtnOffset );
+		if (m_eFormat != FORMAT_PNG)
+			aName += String::CreateFromAscii( ".jpg" );
+		else
+			aName += String::CreateFromAscii( ".png" );
+	}
+
 	return aName;
 }
 
