Index: extensions/source/plugin/unx/npnapi.cxx
===================================================================
RCS file: /cvs/util/extensions/source/plugin/unx/npnapi.cxx,v
retrieving revision 1.7
retrieving revision 1.7.62.1
diff -u -p -u -p -r1.7 -r1.7.62.1
--- extensions/source/plugin/unx/npnapi.cxx	13 Oct 2004 09:03:01 -0000	1.7
+++ extensions/source/plugin/unx/npnapi.cxx	21 Jan 2005 16:21:53 -0000	1.7.62.1
@@ -23,7 +23,7 @@ void* CreateNewShell( void**, XLIB_Windo
 // begin Netscape plugin api calls
 extern "C" {
 
-static void* l_NPN_MemAlloc( UINT32 nBytes )
+static void* l_NPN_MemAlloc( uint32 nBytes )
 {
 	void* pMem = new char[nBytes];
     return pMem;
@@ -34,7 +34,7 @@ static void l_NPN_MemFree( void* pMem )
     delete [] (char*)pMem;
 }
     
-static UINT32 l_NPN_MemFlush( UINT32 nSize )
+static uint32 l_NPN_MemFlush( uint32 nSize )
 {
     return 0;
 }
@@ -165,7 +165,7 @@ static NPError l_NPN_NewStream( NPP inst
 	return aRet;
 }
 
-static NPError l_NPN_PostURLNotify( NPP instance, const char* url, const char* target, UINT32 len, const char* buf, NPBool file, void* notifyData )
+static NPError l_NPN_PostURLNotify( NPP instance, const char* url, const char* target, uint32 len, const char* buf, NPBool file, void* notifyData )
 {
 	UINT32 nInstance = pConnector->GetNPPID( instance );
     if( nInstance == PluginConnector::UnknownNPPID )
@@ -190,7 +190,7 @@ static NPError l_NPN_PostURLNotify( NPP 
 	return aRet;
 }
 
-static NPError l_NPN_PostURL( NPP instance, const char* url, const char* window, UINT32 len, const char* buf, NPBool file )
+static NPError l_NPN_PostURL( NPP instance, const char* url, const char* window, uint32 len, const char* buf, NPBool file )
 {
 	UINT32 nInstance = pConnector->GetNPPID( instance );
     if( nInstance == PluginConnector::UnknownNPPID )
Index: framework/inc/services/documentproperties.hxx
===================================================================
RCS file: /cvs/framework/framework/inc/services/documentproperties.hxx,v
retrieving revision 1.7
retrieving revision 1.7.22.1
diff -u -p -u -p -r1.7 -r1.7.22.1
--- framework/inc/services/documentproperties.hxx	8 Sep 2004 14:06:37 -0000	1.7
+++ framework/inc/services/documentproperties.hxx	21 Jan 2005 15:29:49 -0000	1.7.22.1
@@ -726,7 +726,8 @@ class DocumentProperties	:	public css::l
 		void impl_writeToStream( SvStream& aStream,	const	sal_uInt16&						nValue									);
 		void impl_writeToStream( SvStream& aStream,	const	sal_Int32&						nValue  								);
 		void impl_writeToStream( SvStream& aStream,	const	sal_uInt32&						nValue  								);
-
+		void impl_writeToStream( SvStream& aStream,	const	sal_Int64&						nValue  								);
+		void impl_writeToStream( SvStream& aStream,	const	sal_uInt64&						nValue  								);
 		/*-****************************************************************************************************//**
 			@short		convert a format-ID to right MIMEType
 			@descr		Use "aStaticConvertTable[]" to do that!
--- framework/source/services/documentproperties.cxx	8 Sep 2004 14:11:36 -0000	1.20
+++ framework/source/services/documentproperties.cxx	21 Jan 2005 15:31:01 -0000	1.20.22.1
@@ -2190,6 +2190,30 @@ void DocumentProperties::impl_writeToStr
 //******************************************************************************************************************************
 //	private method
 //******************************************************************************************************************************
+void DocumentProperties::impl_writeToStream(			SvStream&	aStream	,
+												const	sal_Int64&	nValue	)
+{
+	aStream << nValue;
+	#ifdef ENABLE_STREAMCHECK
+	impldbg_checkSvStream( aStream, "impl_writeToStream( int64 )" );
+	#endif
+}
+
+//******************************************************************************************************************************
+//	private method
+//******************************************************************************************************************************
+void DocumentProperties::impl_writeToStream(			SvStream&	aStream	,
+												const	sal_uInt64&	nValue	)
+{
+	aStream << nValue;
+	#ifdef ENABLE_STREAMCHECK
+	impldbg_checkSvStream( aStream, "impl_writeToStream( unsigned int64 )" );
+	#endif
+}
+
+//******************************************************************************************************************************
+//	private method
+//******************************************************************************************************************************
 OUString DocumentProperties::impl_FormatID2MIMEType( sal_uInt32 nFormatID ) const
 {
 	const int nCount = sizeof( aStaticConvertTable ) / sizeof( tIMPL_ConverterItem );
Index: framework/source/layoutmanager/layoutmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/layoutmanager/layoutmanager.cxx,v
retrieving revision 1.24
retrieving revision 1.16.14.2
diff -u -p -u -p -r1.24 -r1.16.14.2
--- framework/source/layoutmanager/layoutmanager.cxx	4 Mar 2005 00:14:17 -0000	1.24
+++ framework/source/layoutmanager/layoutmanager.cxx	9 Mar 2005 16:23:01 -0000	1.16.14.2
@@ -1499,7 +1499,7 @@ void LayoutManager::implts_findNextDocki
     sal_Int32 nFreeRowColPixelPos( 0 );
     sal_Int32 nMaxSpace( 0 );
     sal_Int32 nNeededSpace( 0 );
-    sal_Int32 nTopDockingAreaSize( 0 );
+    long nTopDockingAreaSize( 0 );
     sal_Bool  bFoundRowColumn( sal_False );
 
     if (( DockingArea == DockingArea_DOCKINGAREA_TOP ) ||
@@ -2016,7 +2016,7 @@ void LayoutManager::implts_getDockingAre
         return rMovedElementRect;
     else
     {
-        sal_Int32 nSpace( 0 );
+        long nSpace( 0 );
         ::Rectangle aFrontDockingRect( rMovedElementRect );
         for ( sal_uInt32 i = 0; i < aRowColumnWindowData.aRowColumnWindows.size(); i++ )
         {
@@ -2164,11 +2164,11 @@ LayoutManager::implts_determineDockingOp
     sal_Bool bHorizontalDockArea( ( eDockingArea == DockingArea_DOCKINGAREA_TOP ) ||
                                   ( eDockingArea == DockingArea_DOCKINGAREA_BOTTOM ));
 
-    sal_Int32 nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
-    sal_Int32 nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
+    long nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
+    long nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
 
     ::Size  aStatusBarSize( implts_getStatusBarSize() );
-    sal_Int32 nMaxLeftRightDockAreaSize = rContainerWinSize.Height() -
+    long nMaxLeftRightDockAreaSize = rContainerWinSize.Height() -
                                           nTopDockingAreaSize -
                                           nBottomDockingAreaSize -
                                           aStatusBarSize.Height();
@@ -2176,13 +2176,12 @@ LayoutManager::implts_determineDockingOp
     ::Rectangle aTrackingRect( rTrackingRect );
     if ( bHorizontalDockArea )
     {
-        sal_Int32 nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
+        long nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
         if (( nPosX + rTrackingRect.getWidth()) > rContainerWinSize.Width() )
             nPosX = std::min( nPosX,
-                                std::max( sal_Int32( rContainerWinSize.Width() - rTrackingRect.getWidth() ),
-                                          sal_Int32( 0 )));
+                                std::max( rContainerWinSize.Width() - rTrackingRect.getWidth() , 0L ));
 
-        sal_Int32 nSize = std::min( rContainerWinSize.Width(), rTrackingRect.getWidth() );
+        long nSize = std::min( rContainerWinSize.Width(), rTrackingRect.getWidth() );
 
         aTrackingRect.SetPos( ::Point( nPosX, rRowColumnRect.Top() ));
         aTrackingRect.setWidth( nSize );
@@ -2194,16 +2193,15 @@ LayoutManager::implts_determineDockingOp
     }
     else
     {
-        sal_Int32 nMaxDockingAreaHeight = std::max( sal_Int32( 0 ),
-                                                    sal_Int32( nMaxLeftRightDockAreaSize ));
+        long nMaxDockingAreaHeight = std::max( 0L, nMaxLeftRightDockAreaSize );
 
-        sal_Int32 nPosY( std::max( sal_Int32( aTrackingRect.Top()), sal_Int32( nTopDockingAreaSize )));
+        long nPosY( std::max( aTrackingRect.Top(), nTopDockingAreaSize ));
         if (( nPosY + aTrackingRect.getHeight()) > ( nTopDockingAreaSize + nMaxDockingAreaHeight ))
             nPosY = std::min( nPosY,
-                                std::max( sal_Int32( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() )),
-                                        sal_Int32( nTopDockingAreaSize )));
+                                std::max( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() ),
+                                          nTopDockingAreaSize ));
 
-        sal_Int32 nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
+        long nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
 
         aTrackingRect.SetPos( ::Point( rRowColumnRect.Left(), nPosY ));
         aTrackingRect.setWidth( rRowColumnRect.getWidth() );
@@ -2278,12 +2276,12 @@ void LayoutManager::implts_calcDockingPo
     Reference< css::awt::XWindow >          xDockingAreaWindow;
     ::Rectangle                             aTrackingRect( rTrackingRect );
     ::com::sun::star::ui::DockingArea eDockedArea( (::com::sun::star::ui::DockingArea)rUIElement.m_aDockedData.m_nDockedArea );
-    sal_Int32                               nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
-    sal_Int32                               nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
+    long                               nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
+    long                               nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
     sal_Bool                                bHorizontalDockArea( ( eDockedArea == DockingArea_DOCKINGAREA_TOP ) ||
                                                                  ( eDockedArea == DockingArea_DOCKINGAREA_BOTTOM ));
     ::Size                                  aStatusBarSize( implts_getStatusBarSize() );
-    sal_Int32                               nMaxLeftRightDockAreaSize = aContainerWinSize.Height() -
+    long                               nMaxLeftRightDockAreaSize = aContainerWinSize.Height() -
                                                                         nTopDockingAreaSize -
                                                                         nBottomDockingAreaSize -
                                                                         aStatusBarSize.Height();
@@ -2378,8 +2376,7 @@ void LayoutManager::implts_calcDockingPo
                     {
                         if ( bHorizontalDockArea )
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32( aContainerWinSize.Width() -  aWindowRect.Left() ),
-                                                                                    sal_Int32( aTrackingRect.getWidth() )));
+                            long nSize = ::std::max( 0L, std::min( aContainerWinSize.Width() -  aWindowRect.Left(), aTrackingRect.getWidth() ));
                             if ( nSize == 0 )
                                 nSize = aWindowRect.getWidth();
 
@@ -2392,9 +2389,8 @@ void LayoutManager::implts_calcDockingPo
                         }
                         else
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32(
-                                                    nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Top() ),
-                                                    sal_Int32( aTrackingRect.getHeight() )));
+                            long nSize = ::std::max( 0L, std::min( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Top(),
+                                                    aTrackingRect.getHeight() ));
                             if ( nSize == 0 )
                                 nSize = aWindowRect.getHeight();
 
@@ -2415,8 +2411,7 @@ void LayoutManager::implts_calcDockingPo
                     {
                         if ( bHorizontalDockArea )
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32(( aContainerWinSize.Width() ) - aWindowRect.Right() ),
-                                                                                    sal_Int32( aTrackingRect.getWidth() )));
+                            long nSize = ::std::max( 0L, std::min( aContainerWinSize.Width() - aWindowRect.Right(), aTrackingRect.getWidth() ));
                             if ( nSize == 0 )
                             {
                                 aUIElementRect.SetPos( ::Point( aContainerWinSize.Width() - aTrackingRect.getWidth(), aWindowRect.Top() ));
@@ -2435,8 +2430,8 @@ void LayoutManager::implts_calcDockingPo
                         }
                         else
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Bottom() ),
-                                                                                    sal_Int32( aTrackingRect.getHeight() )));
+                            long nSize = ::std::max( 0L, std::min( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Bottom(),
+                                                                  aTrackingRect.getHeight() ));
                             aUIElementRect.SetPos( ::Point( aWindowRect.Left(), aWindowRect.Bottom() ));
                             aUIElementRect.SetSize( ::Size( aWindowRect.getWidth(), nSize ));
 
@@ -2532,14 +2527,12 @@ void LayoutManager::implts_calcDockingPo
 
         if ( bHorizontalDockArea )
         {
-            sal_Int32 nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
+            long nPosX( std::max( rTrackingRect.Left(), 0L ));
             if (( nPosX + rTrackingRect.getWidth()) > aContainerWinSize.Width() )
-                nPosX = std::min( nPosX,
-                                std::max( sal_Int32( aContainerWinSize.Width() - rTrackingRect.getWidth() ),
-                                          sal_Int32( 0 )));
+                nPosX = std::min( nPosX, std::max( aContainerWinSize.Width() - rTrackingRect.getWidth(), 0L ));
 
-            sal_Int32 nSize = std::min( aContainerWinSize.Width(), rTrackingRect.getWidth() );
-            sal_Int32 nDockHeight = std::max( aDockingAreaRect.getHeight(), sal_Int32( 0 ));
+            long nSize = std::min( aContainerWinSize.Width(), rTrackingRect.getWidth() );
+            long nDockHeight = std::max( aDockingAreaRect.getHeight(), 0L );
             if ( nDockHeight == 0 )
             {
                 sal_Int32 nPosY( std::max( aDockingAreaRect.Top(), aDockingAreaRect.Bottom() ));
@@ -2577,17 +2570,16 @@ void LayoutManager::implts_calcDockingPo
         }
         else
         {
-            sal_Int32 nMaxDockingAreaHeight = std::max( sal_Int32( 0 ),
-                                                        sal_Int32( nMaxLeftRightDockAreaSize ));
+            long nMaxDockingAreaHeight = std::max( 0L, nMaxLeftRightDockAreaSize );
 
-            sal_Int32 nPosY( std::max( sal_Int32( aTrackingRect.Top()), sal_Int32( nTopDockingAreaSize )));
+            long nPosY( std::max( aTrackingRect.Top(), nTopDockingAreaSize ) );
             if (( nPosY + aTrackingRect.getHeight()) > ( nTopDockingAreaSize + nMaxDockingAreaHeight ))
                 nPosY = std::min( nPosY,
-                                std::max( sal_Int32( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() )),
-                                        sal_Int32( nTopDockingAreaSize )));
+                                std::max( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() ),
+                                          nTopDockingAreaSize ));
 
-            sal_Int32 nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
-            sal_Int32 nDockWidth = std::max( aDockingAreaRect.getWidth(), sal_Int32( 0 ));
+            long nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
+            long nDockWidth = std::max( aDockingAreaRect.getWidth(), 0L );
             if ( nDockWidth == 0 )
             {
                 sal_Int32 nPosX( std::max( aDockingAreaRect.Left(), aDockingAreaRect.Right() ));
@@ -4821,7 +4813,7 @@ void LayoutManager::implts_doLayout( sal
             // Position the status bar
             if ( aStatusBarSize.Height() > 0 )
             {
-                implts_setStatusBarPosSize( ::Point( 0, std::max(( aContainerSize.Height() ), sal_Int32( 0 ))),
+                implts_setStatusBarPosSize( ::Point( 0, std::max(( (sal_Int32) aContainerSize.Height() ), sal_Int32( 0 ))),
                                             ::Size( aContainerSize.Width(),aStatusBarSize.Height() ));
             }
 
@@ -4871,8 +4863,8 @@ void LayoutManager::implts_calcWindowPos
 {
     sal_Int32   nDiff( 0 );
     sal_Int32   nSpace( rRowColumnWindowData.nSpace );
-    sal_Int32   nTopDockingAreaSize;
-    sal_Int32   nBottomDockingAreaSize;
+    long        nTopDockingAreaSize;
+    long        nBottomDockingAreaSize;
     sal_Int32   nContainerClientSize;
 
     if ( rRowColumnWindowData.aRowColumnWindows.size() == 0 )
@@ -5214,7 +5206,7 @@ void LayoutManager::implts_setDockingAre
                                                                   aRectangle.Height - aInfo.TopInset  - aInfo.BottomInset );
     ::Size               aStatusBarSize         = implts_getStatusBarSize();
 
-    sal_Int32 nLeftRightDockingAreaHeight( aContainerClientSize.Height );
+    long nLeftRightDockingAreaHeight( aContainerClientSize.Height );
     if ( rBorderSpace.Y >= 0 )
     {
         // Top docking area window
@@ -5230,8 +5222,8 @@ void LayoutManager::implts_setDockingAre
     if ( rBorderSpace.Height >= 0 )
     {
         // Bottom docking area window
-        sal_Int32 nBottomPos = std::max( sal_Int32( aContainerClientSize.Height - rBorderSpace.Height - aStatusBarSize.Height() ), sal_Int32( 0 ));
-        sal_Int32 nHeight = ( nBottomPos == 0 ) ? 0 : rBorderSpace.Height;
+        long nBottomPos = std::max( aContainerClientSize.Height - rBorderSpace.Height - aStatusBarSize.Height(), 0L );
+        long nHeight = ( nBottomPos == 0 ) ? 0L : rBorderSpace.Height;
 
         ReadGuard aReadLock( m_aLock );
         Reference< css::awt::XWindow > xDockAreaWindow( m_xDockAreaWindows[DockingArea_DOCKINGAREA_BOTTOM] );
@@ -5251,7 +5243,7 @@ void LayoutManager::implts_setDockingAre
         aReadLock.unlock();
 
         // We also have to change our right docking area window if the top or bottom area has changed. They have a higher priority!
-        sal_Int32 nHeight = std::max( sal_Int32( 0 ), sal_Int32( nLeftRightDockingAreaHeight ));
+        long nHeight = std::max( 0L, nLeftRightDockingAreaHeight );
 
         xDockAreaWindow->setPosSize( 0, rBorderSpace.Y, rBorderSpace.X, nHeight, css::awt::PosSize::POSSIZE );
         xDockAreaWindow->setVisible( sal_True );
@@ -5264,9 +5256,9 @@ void LayoutManager::implts_setDockingAre
         aReadLock.unlock();
 
         // We also have to change our right docking area window if the top or bottom area has changed. They have a higher priority!
-        sal_Int32 nLeftPos  = std::max( sal_Int32( 0 ), sal_Int32( aContainerClientSize.Width - rBorderSpace.Width ));
-        sal_Int32 nHeight   = std::max( sal_Int32( 0 ), sal_Int32( nLeftRightDockingAreaHeight ));
-        sal_Int32 nWidth    = ( nLeftPos == 0 ) ? 0 : rBorderSpace.Width;
+        long nLeftPos  = std::max( 0, aContainerClientSize.Width - rBorderSpace.Width );
+        long nHeight   = std::max( 0L, nLeftRightDockingAreaHeight );
+        long nWidth    = ( nLeftPos == 0 ) ? 0L : rBorderSpace.Width;
 
         xDockAreaWindow->setPosSize( nLeftPos, rBorderSpace.Y, nWidth, nHeight, css::awt::PosSize::POSSIZE );
         xDockAreaWindow->setVisible( sal_True );
@@ -5275,7 +5267,7 @@ void LayoutManager::implts_setDockingAre
     // Position the status bar
     if ( aStatusBarSize.Height() > 0 )
     {
-        implts_setStatusBarPosSize( ::Point( 0, std::max(( aContainerClientSize.Height - aStatusBarSize.Height() ), sal_Int32( 0 ))),
+        implts_setStatusBarPosSize( ::Point( 0, std::max((sal_Int32) (aContainerClientSize.Height - aStatusBarSize.Height()), sal_Int32( 0 ))),
                                     ::Size( aContainerClientSize.Width, aStatusBarSize.Height() ));
     }
 }
Index: framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx,v
retrieving revision 1.13
retrieving revision 1.4.14.4
diff -u -p -u -p -r1.13 -r1.4.14.4
--- framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx	1 Mar 2005 19:40:15 -0000	1.13
+++ framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx	9 Mar 2005 16:19:18 -0000	1.4.14.4
@@ -914,7 +914,7 @@ void SAL_CALL ModuleUIConfigurationManag
             Reference< XPropertySet > xPropSet( m_xUserConfigStorage, UNO_QUERY );
             if ( xPropSet.is() )
             {
-                long nOpenMode;
+                sal_Int32 nOpenMode;
                 Any a = xPropSet->getPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OpenMode" )));
                 if ( a >>= nOpenMode )
                     m_bReadOnly = !( nOpenMode & ElementModes::WRITE );
Index: framework/source/uiconfiguration/uiconfigurationmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/uiconfiguration/uiconfigurationmanager.cxx,v
retrieving revision 1.12
retrieving revision 1.4.14.4
diff -u -p -u -p -r1.12 -r1.4.14.4
--- framework/source/uiconfiguration/uiconfigurationmanager.cxx	1 Mar 2005 19:40:44 -0000	1.12
+++ framework/source/uiconfiguration/uiconfigurationmanager.cxx	9 Mar 2005 16:19:09 -0000	1.4.14.4
@@ -1243,7 +1243,7 @@ void SAL_CALL UIConfigurationManager::se
         {
             try
             {
-                long nOpenMode;
+                sal_Int32 nOpenMode;
                 Any a = xPropSet->getPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OpenMode" )));
                 if ( a >>= nOpenMode )
                     m_bReadOnly = !( nOpenMode & ElementModes::WRITE );
Index: so3/source/persist/transprt.cxx
===================================================================
RCS file: /cvs/oi/so3/source/persist/transprt.cxx,v
retrieving revision 1.5
retrieving revision 1.5.220.1
diff -u -p -u -p -r1.5 -r1.5.220.1
--- so3/source/persist/transprt.cxx	20 Nov 2001 17:16:56 -0000	1.5
+++ so3/source/persist/transprt.cxx	21 Jul 2004 18:50:24 -0000	1.5.220.1
@@ -1130,7 +1130,7 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 	sal_Int32 nSize = 0;
 	while (nSize < nBytesToRead)
 	{
-		ULONG nCount = 0;
+		sal_Size nCount = 0;
 		ErrCode nError = m_xLockBytes->ReadAt (
 			m_nPosition,
 			rData.getArray() + nSize,
@@ -1138,8 +1138,8 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 			&nCount);
 		if (nError != ERRCODE_NONE && nError != ERRCODE_IO_PENDING)
 			throw IOException();
-		m_nPosition += nCount;
-		nSize += nCount;
+		m_nPosition += svstream_Size_to_u32( nCount );
+		nSize += svstream_Size_to_u32( nCount );
 		if (nError == ERRCODE_NONE && nCount == 0)
 			break;
 	}
@@ -1159,7 +1159,7 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 		throw NotConnectedException();
 
 	rData.realloc(nMaxBytesToRead);
-	ULONG nCount;
+	sal_Size nCount;
 	ErrCode nError;
 	do
 	{
@@ -1170,12 +1170,12 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 			&nCount);
 		if (nError != ERRCODE_NONE && nError != ERRCODE_IO_PENDING)
 			throw IOException();
-		m_nPosition += nCount;
+		m_nPosition += svstream_Size_to_u32( nCount );
 	}
 	while (nCount == 0 && nError == ERRCODE_IO_PENDING);
 
-	rData.realloc(sal_Int32(nCount));
-	return sal_Int32(nCount);
+	rData.realloc(sal_Int32(svstream_Size_to_u32(nCount)));
+	return sal_Int32(svstream_Size_to_u32(nCount));
 }
 
 /*
Index: sw/inc/doc.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/doc.hxx,v
retrieving revision 1.101
retrieving revision 1.97.26.2
diff -u -p -u -p -r1.101 -r1.97.26.2
--- sw/inc/doc.hxx	21 Feb 2005 16:01:55 -0000	1.101
+++ sw/inc/doc.hxx	10 Mar 2005 01:14:25 -0000	1.97.26.2
@@ -1100,7 +1100,7 @@ public:
 		// eine erzeugte Liste aller Felder mit uebergegeben werden.
 		// (ist die Adresse != 0, und der Pointer == 0 wird eine neue
 		// Liste returnt.)
-	void FldsToCalc( SwCalc& rCalc, sal_uInt32 nLastNd = ULONG_MAX,
+	void FldsToCalc( SwCalc& rCalc, ULONG nLastNd = ULONG_MAX,
 					sal_uInt16 nLastCntnt = USHRT_MAX );
 	void FldsToCalc( SwCalc& rCalc, const _SetGetExpFld& rToThisFld );
 	void FldsToExpand( SwHash**& ppTbl, sal_uInt16& rTblSize,
@@ -1529,7 +1529,7 @@ public:
 											const SwTOXBase& rTOX,
 											const SfxItemSet* pSet = 0,
 											sal_Bool bExpand = sal_False );
-	const SwTOXBaseSection* InsertTableOf( sal_uInt32 nSttNd, sal_uInt32 nEndNd,
+	const SwTOXBaseSection* InsertTableOf( ULONG nSttNd, ULONG nEndNd,
 											const SwTOXBase& rTOX,
 											const SfxItemSet* pSet = 0											);
 	const SwTOXBase* GetCurTOX( const SwPosition& rPos ) const;
@@ -1825,7 +1825,7 @@ public:
 	//Einfuegen einer Beschriftung - falls ein FlyFormat erzeugt wird, so
 	// returne dieses.
     SwFlyFrmFmt* InsertLabel( const SwLabelType eType, const String &rTxt, const String& rSeparator,
-					const sal_Bool bBefore, const sal_uInt16 nId, const sal_uInt32 nIdx,
+					const sal_Bool bBefore, const sal_uInt16 nId, const ULONG nIdx,
                     const String& rCharacterStyle,
 					const sal_Bool bCpyBrd = sal_True );
     SwFlyFrmFmt* InsertDrawLabel(
Index: sw/inc/docufld.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/docufld.hxx,v
retrieving revision 1.7
retrieving revision 1.7.76.1
diff -u -p -u -p -r1.7 -r1.7.76.1
--- sw/inc/docufld.hxx	8 Sep 2004 14:49:42 -0000	1.7
+++ sw/inc/docufld.hxx	21 Jan 2005 16:54:24 -0000	1.7.76.1
@@ -231,7 +231,7 @@ class SwAuthorFieldType : public SwField
 public:
 	SwAuthorFieldType();
 
-	String 					Expand(ULONG) const;
+	String 					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -266,7 +266,7 @@ class SwFileNameFieldType : public SwFie
 public:
 	SwFileNameFieldType(SwDoc*);
 
-	String					Expand(ULONG) const;
+	String					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -301,7 +301,7 @@ class SwTemplNameFieldType : public SwFi
 public:
 	SwTemplNameFieldType(SwDoc*);
 
-	String					Expand(ULONG) const;
+	String					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
Index: sw/inc/ndindex.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/ndindex.hxx,v
retrieving revision 1.2
retrieving revision 1.2.760.1
diff -u -p -u -p -r1.2 -r1.2.760.1
--- sw/inc/ndindex.hxx	28 Sep 2001 07:03:31 -0000	1.2
+++ sw/inc/ndindex.hxx	9 Sep 2004 09:53:00 -0000	1.2.760.1
@@ -94,8 +94,8 @@ class SwNodeIndex
 
 public:
 	SwNodeIndex( SwNodes& rNds, ULONG nIdx = 0 );
-	SwNodeIndex( const SwNodeIndex &, long nDiff = 0 );
-	SwNodeIndex( const SwNode&, long nDiff = 0 );
+	SwNodeIndex( const SwNodeIndex &, sal_Int32 nDiff = 0 );
+	SwNodeIndex( const SwNode&, sal_Int32 nDiff = 0 );
 	~SwNodeIndex() { Remove(); }
 
 	inline ULONG operator++();
@@ -133,7 +133,7 @@ public:
 
 	// ermoeglicht Zuweisungen ohne Erzeugen eines temporaeren Objektes
 	SwNodeIndex& Assign( SwNodes& rNds, ULONG );
-	SwNodeIndex& Assign( const SwNode& rNd, long nOffset = 0 );
+	SwNodeIndex& Assign( const SwNode& rNd, sal_Int32 nOffset = 0 );
 
 		// Herausgabe des Pointers auf das NodesArray,
 	inline const SwNodes& GetNodes() const;
Index: sw/inc/ndtxt.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/ndtxt.hxx,v
retrieving revision 1.35
retrieving revision 1.25.22.4
diff -u -p -u -p -r1.35 -r1.25.22.4
--- sw/inc/ndtxt.hxx	22 Feb 2005 08:16:28 -0000	1.35
+++ sw/inc/ndtxt.hxx	10 Mar 2005 01:14:17 -0000	1.25.22.4
@@ -259,7 +259,7 @@ public:
 	void Replace( const SwIndex& rStart, xub_Unicode cCh );
 	void Replace( const SwIndex& rStart, xub_StrLen nLen, const XubString& rText );
 	void ReplaceTextOnly( xub_StrLen nPos, xub_StrLen nLen, const XubString& rText,
-					const ::com::sun::star::uno::Sequence<long>& rOffsets );
+					const ::com::sun::star::uno::Sequence<sal_Int32>& rOffsets );
 
 	// virtuelle Methoden aus dem CntntNode
 	virtual SwCntntFrm *MakeFrm();
Index: sw/inc/undobj.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/undobj.hxx,v
retrieving revision 1.20
retrieving revision 1.9.64.4
diff -u -p -u -p -r1.20 -r1.9.64.4
--- sw/inc/undobj.hxx	25 Jan 2005 14:41:38 -0000	1.20
+++ sw/inc/undobj.hxx	10 Mar 2005 01:16:36 -0000	1.9.64.4
@@ -1730,7 +1730,7 @@ public:
 	virtual void Repeat( SwUndoIter& rUndoIter );
 
 	void AddChanges( const SwTxtNode& rTNd, xub_StrLen nStart, xub_StrLen nLen,
-		 			::com::sun::star::uno::Sequence <long>& rOffsets );
+		 			::com::sun::star::uno::Sequence <sal_Int32>& rOffsets );
 	BOOL HasData() const {return 0 != pData; }
 };
 
Index: sw/inc/viewsh.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/viewsh.hxx,v
retrieving revision 1.44
retrieving revision 1.44.66.1
diff -u -p -u -p -r1.44 -r1.44.66.1
--- sw/inc/viewsh.hxx	4 Oct 2004 19:01:08 -0000	1.44
+++ sw/inc/viewsh.hxx	21 Jan 2005 16:55:43 -0000	1.44.66.1
@@ -338,7 +338,7 @@ public:
 
 	//Wird intern fuer die Shell gerufen die Druckt. Formatiert die Seiten.
 	void CalcPagesForPrint( sal_uInt16 nMax, SfxProgress* pProgress = 0,
-		const String* pStr = NULL, sal_uInt32 nMergeAct = 0, sal_uInt32 nMergeCnt = 0 );
+		const String* pStr = NULL, ULONG nMergeAct = 0, ULONG nMergeCnt = 0 );
 
 	//All about fields.
 	void UpdateFlds(sal_Bool bCloseDB = sal_False);
Index: sw/source/core/doc/docedt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docedt.cxx,v
retrieving revision 1.22
retrieving revision 1.21.124.2
diff -u -p -u -p -r1.22 -r1.21.124.2
--- sw/source/core/doc/docedt.cxx	21 Jan 2005 10:28:58 -0000	1.22
+++ sw/source/core/doc/docedt.cxx	10 Mar 2005 01:46:07 -0000	1.21.124.2
@@ -1718,13 +1718,13 @@ uno::Any SwDoc::Spell( SwPaM& rPaM,
                             pSttPos->nNode.GetNode().GetTxtNode(), pSttPos->nContent,
                             pEndPos->nNode.GetNode().GetTxtNode(), pEndPos->nContent );
 
-	sal_uInt32 nCurrNd = pSttPos->nNode.GetIndex();
-	sal_uInt32 nEndNd = pEndPos->nNode.GetIndex();
+	ULONG nCurrNd = pSttPos->nNode.GetIndex();
+	ULONG nEndNd = pEndPos->nNode.GetIndex();
 
 	if( nCurrNd <= nEndNd )
 	{
 		SwCntntFrm* pCntFrm;
-		sal_uInt32 nCount = nEndNd - nCurrNd;
+		ULONG nCount = nEndNd - nCurrNd;
 		sal_Bool bGoOn = sal_True;
 		while( bGoOn )
 		{
@@ -2246,7 +2246,7 @@ sal_Bool SwDoc::DelFullPara( SwPaM& rPam
 
 	/* #i9185# This whould lead to a segmentation fault if not catched
        above. */
-	sal_uInt32 nNextNd = rEnd.nNode.GetIndex() + 1;
+	ULONG nNextNd = rEnd.nNode.GetIndex() + 1;
 	SwTableNode* pTblNd = aNodes[ nNextNd ]->GetTableNode();
 
 	if( pTblNd && pNd->IsCntntNode() )
Index: sw/source/core/doc/docfld.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docfld.cxx,v
retrieving revision 1.22
retrieving revision 1.22.66.1
diff -u -p -u -p -r1.22 -r1.22.66.1
--- sw/source/core/doc/docfld.cxx	4 Oct 2004 19:02:51 -0000	1.22
+++ sw/source/core/doc/docfld.cxx	21 Jan 2005 16:56:33 -0000	1.22.66.1
@@ -2221,7 +2221,7 @@ void SwDoc::SetFixFields( BOOL bOnlyTime
 		ResetModified();
 }
 
-BOOL SwDoc::SetFieldsDirty( BOOL b, const SwNode* pChk, ULONG nLen )
+BOOL SwDoc::SetFieldsDirty( BOOL b, const SwNode* pChk, sal_uInt32 nLen )
 {
 	// teste ggfs. mal, ob die angegbenen Nodes ueberhaupt Felder beinhalten.
 	// wenn nicht, braucht das Flag nicht veraendert werden.
Index: sw/source/core/doc/doclay.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/doclay.cxx,v
retrieving revision 1.32
retrieving revision 1.29.46.2
diff -u -p -u -p -r1.32 -r1.29.46.2
--- sw/source/core/doc/doclay.cxx	1 Mar 2005 15:23:43 -0000	1.32
+++ sw/source/core/doc/doclay.cxx	10 Mar 2005 01:46:19 -0000	1.29.46.2
@@ -1337,7 +1337,7 @@ void lcl_CpyAttr( SfxItemSet &rNewSet, c
 
 
 SwFlyFrmFmt* SwDoc::InsertLabel( const SwLabelType eType, const String &rTxt, const String& rSeparator,
-			const sal_Bool bBefore, const sal_uInt16 nId, const sal_uInt32 nNdIdx,
+			const sal_Bool bBefore, const sal_uInt16 nId, const ULONG nNdIdx,
             const String& rCharacterStyle,
 			const sal_Bool bCpyBrd )
 {
@@ -1390,7 +1390,7 @@ SwFlyFrmFmt* SwDoc::InsertLabel( const S
 			{
 				SwStartNode *pSttNd = GetNodes()[nNdIdx]->GetStartNode();
 				ASSERT( pSttNd, "Kein StartNode in InsertLabel." );
-				sal_uInt32 nNode;
+				ULONG nNode;
 				if( bBefore )
 				{
 					nNode = pSttNd->GetIndex();
Index: sw/source/core/docnode/ndindex.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/docnode/ndindex.cxx,v
retrieving revision 1.2
retrieving revision 1.2.574.1
diff -u -p -u -p -r1.2 -r1.2.574.1
--- sw/source/core/docnode/ndindex.cxx	17 Apr 2003 13:56:15 -0000	1.2
+++ sw/source/core/docnode/ndindex.cxx	9 Sep 2004 09:53:02 -0000	1.2.574.1
@@ -106,7 +106,7 @@ SwNodeIndex::SwNodeIndex( SwNodes& rNds,
 }
 
 
-SwNodeIndex::SwNodeIndex( const SwNodeIndex& rIdx, long nDiff )
+SwNodeIndex::SwNodeIndex( const SwNodeIndex& rIdx, sal_Int32 nDiff )
 	: pNext( 0 ), pPrev( 0 )
 {
 	if( nDiff )
@@ -121,7 +121,7 @@ SwNodeIndex::SwNodeIndex( const SwNodeIn
 }
 
 
-SwNodeIndex::SwNodeIndex( const SwNode& rNd, long nDiff )
+SwNodeIndex::SwNodeIndex( const SwNode& rNd, sal_Int32 nDiff )
 	: pNext( 0 ), pPrev( 0 )
 {
 	if( nDiff )
@@ -180,7 +180,7 @@ SwNodeIndex& SwNodeIndex::Assign( SwNode
 	return *this;
 }
 
-SwNodeIndex& SwNodeIndex::Assign( const SwNode& rNd, long nOffset )
+SwNodeIndex& SwNodeIndex::Assign( const SwNode& rNd, sal_Int32 nOffset )
 {
 	if( &pNd->GetNodes() != &rNd.GetNodes() )
 	{
Index: sw/source/core/layout/flycnt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/flycnt.cxx,v
retrieving revision 1.46
retrieving revision 1.45.48.2
diff -u -p -u -p -r1.46 -r1.45.48.2
--- sw/source/core/layout/flycnt.cxx	27 Jan 2005 11:11:12 -0000	1.46
+++ sw/source/core/layout/flycnt.cxx	10 Mar 2005 01:55:28 -0000	1.45.48.2
@@ -868,7 +868,7 @@ ULONG MA_FASTCALL lcl_FindCntDiff( const
 		{
 			//Jetzt die Entfernung zwischen den beiden Punkten berechnen.
 			//'Delta' X^2 + 'Delta'Y^2 = 'Entfernung'^2
-			ULONG dX = Max( pCnt->Frm().Left(), rPt.X() ) -
+			sal_uInt32 dX = Max( pCnt->Frm().Left(), rPt.X() ) -
 					   Min( pCnt->Frm().Left(), rPt.X() ),
 				  dY = Max( pCnt->Frm().Top(), rPt.Y() ) -
 					   Min( pCnt->Frm().Top(), rPt.Y() );
Index: sw/source/core/layout/trvlfrm.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/trvlfrm.cxx,v
retrieving revision 1.43
retrieving revision 1.41.76.2
diff -u -p -u -p -r1.43 -r1.41.76.2
--- sw/source/core/layout/trvlfrm.cxx	28 Jan 2005 15:27:06 -0000	1.43
+++ sw/source/core/layout/trvlfrm.cxx	10 Mar 2005 01:56:49 -0000	1.41.76.2
@@ -1143,11 +1143,11 @@ BOOL GetFrmInPage( const SwCntntFrm *pCn
 |*	Letzte Aenderung	MA 09. Jan. 97
 |*
 |*************************************************************************/
-ULONG CalcDiff( const Point &rPt1, const Point &rPt2 )
+sal_uInt32 CalcDiff( const Point &rPt1, const Point &rPt2 )
 {
 	//Jetzt die Entfernung zwischen den beiden Punkten berechnen.
 	//'Delta' X^2 + 'Delta'Y^2 = 'Entfernung'^2
-	ULONG dX = Max( rPt1.X(), rPt2.X() ) -
+	sal_uInt32 dX = Max( rPt1.X(), rPt2.X() ) -
 			   Min( rPt1.X(), rPt2.X() ),
 		  dY = Max( rPt1.Y(), rPt2.Y() ) -
 			   Min( rPt1.Y(), rPt2.Y() );
@@ -1208,7 +1208,7 @@ const SwCntntFrm *SwLayoutFrm::GetCntntP
 	const SwLayoutFrm *pInside = NULL;
 	USHORT nMaxPage = GetPhyPageNum() + (bDefaultExpand ? 1 : 0);
 	Point aPoint = rPoint;
-	ULONG nDistance = ULONG_MAX;
+	sal_uInt32 nDistance = SAL_MAX_UINT32;
 
 	while ( TRUE ) 	//Sicherheitsschleifchen, damit immer einer gefunden wird.
 	{
@@ -1261,7 +1261,7 @@ const SwCntntFrm *SwLayoutFrm::GetCntntP
 					if( !pInside || ( pInside->IsAnLower( pCntnt ) &&
 						( !pCntnt->IsInFtn() || pInside->IsFtnContFrm() ) ) )
 					{
-						const ULONG nDiff = ::CalcDiff( aCntntPoint, rPoint );
+						const sal_uInt32 nDiff = ::CalcDiff( aCntntPoint, rPoint );
 						BOOL bBetter = nDiff < nDistance;  // Dichter dran
 						if( !pInside )
 						{
@@ -1422,7 +1422,7 @@ void SwPageFrm::GetCntntPosition( const 
 
 	const SwCntntFrm *pAct = pCntnt;
 	Point aAct 		 = rPt;
-	ULONG nDist		 = ULONG_MAX;
+	sal_uInt32 nDist = SAL_MAX_UINT32;
 
 	while ( pCntnt )
 	{
@@ -1449,7 +1449,7 @@ void SwPageFrm::GetCntntPosition( const 
 		else if ( aCntFrm.Right() < rPt.X() )
 			aPoint.X() = aCntFrm.Right();
 
-		const ULONG nDiff = ::CalcDiff( aPoint, rPt );
+		const sal_uInt32 nDiff = ::CalcDiff( aPoint, rPt );
 		if ( nDiff < nDist )
 		{
 			aAct	= aPoint;
Index: sw/source/core/txtnode/txtedt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/txtnode/txtedt.cxx,v
retrieving revision 1.63
retrieving revision 1.53.92.4
diff -u -p -u -p -r1.63 -r1.53.92.4
--- sw/source/core/txtnode/txtedt.cxx	1 Mar 2005 15:24:39 -0000	1.63
+++ sw/source/core/txtnode/txtedt.cxx	10 Mar 2005 01:58:06 -0000	1.53.92.4
@@ -623,12 +623,12 @@ BOOL SwScanner::NextWord()
                 pBreakIt->xBreak->getScriptType( rText, nBegin );
 
         XubString aTmpWord = rText.Copy( nBegin, static_cast<xub_StrLen>(aBound.endPos - nBegin) );
-        const long nScriptEnd = nBegin +
+        const sal_Int32 nScriptEnd = nBegin +
             pBreakIt->xBreak->endOfScript( aTmpWord, 0, nCurrScript );
         const long nEnd = Min( aBound.endPos, nScriptEnd );
 
         // restrict word start to last script change position
-        long nScriptBegin = 0;
+        sal_Int32 nScriptBegin = 0;
         if ( aBound.startPos < nBegin )
         {
             // search from nBegin backwards until the next script change
@@ -646,7 +646,7 @@ BOOL SwScanner::NextWord()
                 pBreakIt->xBreak->getScriptType( rText, aBound.startPos );
         XubString aTmpWord = rText.Copy( static_cast<xub_StrLen>(aBound.startPos),
                                          static_cast<xub_StrLen>(aBound.endPos - aBound.startPos) );
-        const long nScriptEnd = aBound.startPos +
+        const sal_Int32 nScriptEnd = aBound.startPos +
             pBreakIt->xBreak->endOfScript( aTmpWord, 0, nCurrScript );
         const long nEnd = Min( aBound.endPos, nScriptEnd );
         nBegin = (xub_StrLen)aBound.startPos;
@@ -1349,7 +1349,7 @@ void SwTxtNode::TransliterateText( utl::
 			}
 			xub_StrLen nLen = nEndPos - nStart;
 
-			Sequence <long> aOffsets;
+			Sequence <sal_Int32> aOffsets;
 			String sChgd( rTrans.transliterate( aText, nLang, nStart, nLen,
 													&aOffsets ));
 			if( !aText.Equals( sChgd, nStart, nLen ) )
@@ -1367,12 +1367,12 @@ void SwTxtNode::TransliterateText( utl::
 
 void SwTxtNode::ReplaceTextOnly( xub_StrLen nPos, xub_StrLen nLen,
 								const XubString& rText,
-								const Sequence<long>& rOffsets )
+								const Sequence<sal_Int32>& rOffsets )
 {
 	aText.Replace( nPos, nLen, rText );
 
 	xub_StrLen nTLen = rText.Len();
-	const long* pOffsets = rOffsets.getConstArray();
+	const sal_Int32* pOffsets = rOffsets.getConstArray();
 	// now look for no 1-1 mapping -> move the indizies!
 	xub_StrLen nI, nMyOff;
 	for( nI = 0, nMyOff = nPos; nI < nTLen; ++nI, ++nMyOff )
Index: sw/source/core/undo/unovwr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/undo/unovwr.cxx,v
retrieving revision 1.13
retrieving revision 1.12.64.2
diff -u -p -u -p -r1.13 -r1.12.64.2
--- sw/source/core/undo/unovwr.cxx	8 Sep 2004 15:00:49 -0000	1.13
+++ sw/source/core/undo/unovwr.cxx	20 Oct 2004 12:00:44 -0000	1.12.64.2
@@ -411,7 +411,7 @@ struct _UndoTransliterate_Data
 	String sText;
 	_UndoTransliterate_Data* pNext;
 	SwHistory* pHistory;
-	Sequence <long>* pOffsets;
+	Sequence <sal_Int32>* pOffsets;
 	ULONG nNdIdx;
 	xub_StrLen nStart, nLen;
 
@@ -478,7 +478,7 @@ void SwUndoTransliterate::Repeat( SwUndo
 
 void SwUndoTransliterate::AddChanges( const SwTxtNode& rTNd,
 					xub_StrLen nStart, xub_StrLen nLen,
-		 			::com::sun::star::uno::Sequence <long>& rOffsets )
+		 			::com::sun::star::uno::Sequence <sal_Int32>& rOffsets )
 {
 	long nOffsLen = rOffsets.getLength();
 	_UndoTransliterate_Data* pNew = new _UndoTransliterate_Data(
@@ -490,17 +490,17 @@ void SwUndoTransliterate::AddChanges( co
 		pData = pNew;
 	pLastData = pNew;
 
-	const long* pOffsets = rOffsets.getConstArray();
+	const sal_Int32* pOffsets = rOffsets.getConstArray();
 	// where did we need less memory ?
 	// check for 1-1 mappings:
 	BOOL bOneToOne = TRUE;
-	const long* p = pOffsets;
+	const sal_Int32* p = pOffsets;
 	for( long n = 0; n < nOffsLen; ++n, ++p )
 		if( *p != ( nStart + n ))
 		{
 			// create the Offset array
-			pNew->pOffsets = new Sequence <long> ( nLen );
-			long* pIdx = pNew->pOffsets->getArray();
+			pNew->pOffsets = new Sequence <sal_Int32> ( nLen );
+			sal_Int32* pIdx = pNew->pOffsets->getArray();
 			p = pOffsets;
 			long nMyOff, nNewVal = nStart;
 			for( n = 0, nMyOff = nStart; n < nOffsLen; ++p, ++n, ++nMyOff )
@@ -554,12 +554,12 @@ void _UndoTransliterate_Data::SetChangeA
 	SwTxtNode* pTNd = rDoc.GetNodes()[ nNdIdx ]->GetTxtNode();
 	if( pTNd )
 	{
-		Sequence <long> aOffsets( pOffsets ? pOffsets->getLength() : nLen );
+		Sequence <sal_Int32> aOffsets( pOffsets ? pOffsets->getLength() : nLen );
 		if( pOffsets )
 			aOffsets = *pOffsets;
 		else
 		{
-			long* p = aOffsets.getArray();
+			sal_Int32* p = aOffsets.getArray();
 			for( xub_StrLen n = 0; n < nLen; ++n, ++p )
 				*p = n + nStart;
 		}
Index: sw/source/core/unocore/unoobj.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unoobj.cxx,v
retrieving revision 1.84
retrieving revision 1.82.8.2
diff -u -p -u -p -r1.84 -r1.82.8.2
--- sw/source/core/unocore/unoobj.cxx	22 Feb 2005 10:03:29 -0000	1.84
+++ sw/source/core/unocore/unoobj.cxx	10 Mar 2005 01:58:48 -0000	1.82.8.2
@@ -913,14 +913,14 @@ SwFmtColl* SwXTextCursor::GetCurTxtFmtCo
 	sal_Bool bError = sal_False;
 	FOREACHUNOPAM_START(&rPam)
 
-		sal_uInt32 nSttNd = PUNOPAM->GetMark()->nNode.GetIndex(),
+		ULONG nSttNd = PUNOPAM->GetMark()->nNode.GetIndex(),
 			  nEndNd = PUNOPAM->GetPoint()->nNode.GetIndex();
 		xub_StrLen nSttCnt = PUNOPAM->GetMark()->nContent.GetIndex(),
 				nEndCnt = PUNOPAM->GetPoint()->nContent.GetIndex();
 
 		if( nSttNd > nEndNd || ( nSttNd == nEndNd && nSttCnt > nEndCnt ))
 		{
-			sal_uInt32 nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
+			ULONG nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
 			nTmp = nSttCnt; nSttCnt = nEndCnt; nEndCnt = (sal_uInt16)nTmp;
 		}
 
@@ -931,7 +931,7 @@ SwFmtColl* SwXTextCursor::GetCurTxtFmtCo
 		}
 
 		const SwNodes& rNds = rPam.GetDoc()->GetNodes();
-		for( sal_uInt32 n = nSttNd; n <= nEndNd; ++n )
+		for( ULONG n = nSttNd; n <= nEndNd; ++n )
 		{
 			const SwTxtNode* pNd = rNds[ n ]->GetTxtNode();
 			if( pNd )
Index: sw/source/core/unocore/unoobj2.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unoobj2.cxx,v
retrieving revision 1.49
retrieving revision 1.48.66.2
diff -u -p -u -p -r1.49 -r1.48.66.2
--- sw/source/core/unocore/unoobj2.cxx	27 Jan 2005 12:37:42 -0000	1.49
+++ sw/source/core/unocore/unoobj2.cxx	10 Mar 2005 01:59:27 -0000	1.48.66.2
@@ -1051,14 +1051,14 @@ void SwXTextCursor::GetCrsrAttr(SwPaM& r
 	SwPaM *_pStartCrsr = &rPam;
 	do
 	{
-		sal_uInt32 nSttNd = _pStartCrsr->GetMark()->nNode.GetIndex(),
+		ULONG nSttNd = _pStartCrsr->GetMark()->nNode.GetIndex(),
 					nEndNd = _pStartCrsr->GetPoint()->nNode.GetIndex();
 			xub_StrLen nSttCnt = _pStartCrsr->GetMark()->nContent.GetIndex(),
 					nEndCnt = _pStartCrsr->GetPoint()->nContent.GetIndex();
 
 			if( nSttNd > nEndNd || ( nSttNd == nEndNd && nSttCnt > nEndCnt ))
 			{
-				sal_uInt32 nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
+				ULONG nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
 				nTmp = nSttCnt; nSttCnt = nEndCnt; nEndCnt = (sal_uInt16)nTmp;
 			}
 
@@ -1071,7 +1071,7 @@ void SwXTextCursor::GetCrsrAttr(SwPaM& r
 
 			// beim 1.Node traegt der Node die Werte in den GetSet ein (Initial)
 			// alle weiteren Nodes werden zum GetSet zu gemergt
-			for( sal_uInt32 n = nSttNd; n <= nEndNd; ++n )
+			for( ULONG n = nSttNd; n <= nEndNd; ++n )
 			{
 				SwNode* pNd = rPam.GetDoc()->GetNodes()[ n ];
 				switch( pNd->GetNodeType() )
Index: sw/source/core/unocore/unosett.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unosett.cxx,v
retrieving revision 1.40
retrieving revision 1.37.62.3
diff -u -p -u -p -r1.40 -r1.37.62.3
--- sw/source/core/unocore/unosett.cxx	26 Nov 2004 13:27:57 -0000	1.40
+++ sw/source/core/unocore/unosett.cxx	18 Jan 2005 16:42:15 -0000	1.37.62.3
@@ -1124,7 +1124,7 @@ void SwXLineNumberingProperties::setProp
 				{
 					INT32 nVal;
 					aValue >>= nVal;
-					aInfo.SetPosFromLeft(Min(MM100_TO_TWIP(nVal), sal_Int32(0xffff)));
+					aInfo.SetPosFromLeft(Min((sal_Int32)MM100_TO_TWIP(nVal), sal_Int32(0xffff)));
 				}
 				break;
 				case WID_INTERVAL   :
Index: sw/source/filter/excel/exctools.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/excel/exctools.cxx,v
retrieving revision 1.6
retrieving revision 1.6.96.1
diff -u -p -u -p -r1.6 -r1.6.96.1
--- sw/source/filter/excel/exctools.cxx	12 Aug 2004 12:46:36 -0000	1.6
+++ sw/source/filter/excel/exctools.cxx	21 Jan 2005 16:59:15 -0000	1.6.96.1
@@ -1353,14 +1353,14 @@ void ValueFormBuffer::_NewValueFormat5( 
 	}
 
 //------------------------------------------------------------------------
-UINT32 ValueFormBuffer::__GetValueFormat( UINT16 nExcIndex )
+sal_uInt32 ValueFormBuffer::__GetValueFormat( UINT16 nExcIndex )
 	{
 	Init();
 	return ( this->*_GetValueFormat )( nExcIndex );
 	}
 
 //------------------------------------------------------------------------
-UINT32 ValueFormBuffer::_GetValueFormatX5( UINT16 nExcIndex )
+sal_uInt32 ValueFormBuffer::_GetValueFormatX5( UINT16 nExcIndex )
 	{
 	DBG_ASSERT( nExcIndex < nCount,
 		"+ValueFormBuffer::GetValueFormat(): Da kann ich auch nichts fuer!" );
Index: sw/source/filter/excel/excvfbff.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/excel/excvfbff.hxx,v
retrieving revision 1.2
retrieving revision 1.2.96.1
diff -u -p -u -p -r1.2 -r1.2.96.1
--- sw/source/filter/excel/excvfbff.hxx	12 Aug 2004 12:46:49 -0000	1.2
+++ sw/source/filter/excel/excvfbff.hxx	21 Jan 2005 16:59:22 -0000	1.2.96.1
@@ -76,18 +76,18 @@ typedef ULONG				( ValueFormBuffer::*Fkt
 #endif
 
 class ValueFormBuffer
-	{
+{
 	private:
 #if !defined(BLC) && !defined(MAC)
-// MSC will es auf jeden Fall hier
+		// MSC will es auf jeden Fall hier
 		typedef void		( ValueFormBuffer::*Fkt_rString )( String & );
-		typedef ULONG		( ValueFormBuffer::*Fkt_USHORT )( USHORT );
+		typedef sal_uInt32	( ValueFormBuffer::*Fkt_USHORT )( USHORT );
 #endif
 
-		ULONG				*pHandles;		// Array mit Handles...
+		sal_uInt32			*pHandles;		// Array mit Handles...
 		USHORT				nMax;  			// Groesse des Arrays
 		USHORT				nCount;			// Index des naechsten freien Eintrags
-		ULONG				nDefaultHandle;
+		sal_uInt32			nDefaultHandle;
 
 		// nur fuer Excel5
 		static const USHORT nAnzBuiltin;	// bekannte Formate
@@ -100,17 +100,17 @@ class ValueFormBuffer
 		void				Init( void );
 							// fuer 1. Nutzung
 		void				__NewValueFormat( String &rFormString );
-		ULONG				__GetValueFormat( USHORT nExcIndex );
+		sal_uInt32			__GetValueFormat( USHORT nExcIndex );
 							// fuer n-te Nutzung
 		void				_NewValueFormatX( String &rFormString );
 		void				_NewValueFormat5( String &rFormString );
-		ULONG				_GetValueFormatX5( USHORT nExcIndex );
+		sal_uInt32			_GetValueFormatX5( USHORT nExcIndex );
 	public:
 		ValueFormBuffer( const USHORT nSize = 2048 );
 		~ValueFormBuffer();
 
 		inline void			NewValueFormat( String &rFormString );
-		inline ULONG		GetValueFormat( USHORT nExcIndex );
+		inline sal_uInt32	GetValueFormat( USHORT nExcIndex );
 	};
 
 inline void ValueFormBuffer::NewValueFormat( String &rFormString )
@@ -118,7 +118,7 @@ inline void ValueFormBuffer::NewValueFor
 	( this->*_NewValueFormat )( rFormString );
 	}
 
-inline ULONG ValueFormBuffer::GetValueFormat( USHORT nExcIndex )
+inline sal_uInt32 ValueFormBuffer::GetValueFormat( USHORT nExcIndex )
 	{
 	return ( this->*_GetValueFormat )( nExcIndex );
 	}
Index: sw/source/filter/html/css1atr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/css1atr.cxx,v
retrieving revision 1.29
retrieving revision 1.29.8.1
diff -u -p -u -p -r1.29 -r1.29.8.1
--- sw/source/filter/html/css1atr.cxx	11 Jan 2005 12:25:00 -0000	1.29
+++ sw/source/filter/html/css1atr.cxx	21 Jan 2005 16:59:40 -0000	1.29.8.1
@@ -2246,7 +2246,7 @@ Writer& OutCSS1_NumBulListStyleOpt( Writ
 //-----------------------------------------------------------------------
 
 void SwHTMLWriter::OutCSS1_FrmFmtOptions( const SwFrmFmt& rFrmFmt,
-										  ULONG nFrmOpts,
+										  sal_uInt32 nFrmOpts,
 										  const SdrObject *pSdrObj,
 										  const SfxItemSet *pItemSet )
 {
Index: sw/source/filter/html/htmlatr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlatr.cxx,v
retrieving revision 1.26
retrieving revision 1.26.34.1
diff -u -p -u -p -r1.26 -r1.26.34.1
--- sw/source/filter/html/htmlatr.cxx	5 Jan 2005 13:40:52 -0000	1.26
+++ sw/source/filter/html/htmlatr.cxx	21 Jan 2005 16:59:53 -0000	1.26.34.1
@@ -2905,7 +2905,7 @@ Writer& OutHTML_SwTxtNode( Writer& rWrt,
 }
 
 
-ULONG SwHTMLWriter::ToPixel( ULONG nVal ) const
+sal_uInt32 SwHTMLWriter::ToPixel( sal_uInt32 nVal ) const
 {
 	if( Application::GetDefaultDevice() && nVal )
 	{
Index: sw/source/filter/html/htmlcss1.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlcss1.cxx,v
retrieving revision 1.17
retrieving revision 1.16.8.2
diff -u -p -u -p -r1.17 -r1.16.8.2
--- sw/source/filter/html/htmlcss1.cxx	25 Jan 2005 14:42:45 -0000	1.17
+++ sw/source/filter/html/htmlcss1.cxx	10 Mar 2005 02:03:18 -0000	1.16.8.2
@@ -209,7 +209,7 @@ void SwCSS1Parser::ChgPageDesc( const Sw
 	ASSERT( i<nPageDescs, "Seitenvorlage nicht gefunden" );
 }
 
-SwCSS1Parser::SwCSS1Parser( SwDoc *pD, ULONG aFHeights[7], const String& rBaseURL, BOOL bNewDoc ) :
+SwCSS1Parser::SwCSS1Parser( SwDoc *pD, sal_uInt32 aFHeights[7], const String& rBaseURL, BOOL bNewDoc ) :
     SvxCSS1Parser( pD->GetAttrPool(), rBaseURL, MM50/2,
 				   (USHORT*)&aItemIds, sizeof(aItemIds) / sizeof(USHORT) ),
 	nDropCapCnt( 0 ), bIsNewDoc( bNewDoc ), pDoc( pD ),
@@ -1239,7 +1239,7 @@ BOOL SwCSS1Parser::StyleParsed( const CS
 	return TRUE;
 }
 
-ULONG SwCSS1Parser::GetFontHeight( USHORT nSize ) const
+sal_uInt32 SwCSS1Parser::GetFontHeight( USHORT nSize ) const
 {
 	return aFontHeights[ nSize>6 ? 6 : nSize ];
 }
Index: sw/source/filter/html/htmlfly.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlfly.cxx,v
retrieving revision 1.20
retrieving revision 1.20.8.1
diff -u -p -u -p -r1.20 -r1.20.8.1
--- sw/source/filter/html/htmlfly.cxx	11 Jan 2005 12:25:53 -0000	1.20
+++ sw/source/filter/html/htmlfly.cxx	21 Jan 2005 17:00:20 -0000	1.20.8.1
@@ -466,7 +466,7 @@ void SwHTMLWriter::CollectFlyFrms()
 	}
 }
 
-BOOL SwHTMLWriter::OutFlyFrm( ULONG nNdIdx, xub_StrLen nCntntIdx, BYTE nPos, 
+BOOL SwHTMLWriter::OutFlyFrm( sal_uInt32 nNdIdx, xub_StrLen nCntntIdx, BYTE nPos,
 							  HTMLOutContext *pContext )
 {
 	BOOL bFlysLeft = FALSE;	// Noch Flys an aktueller Node-Position da?
@@ -636,7 +636,7 @@ void SwHTMLWriter::OutFrmFmt( BYTE nMode
 void SwHTMLWriter::OutFrmFmtOptions( const SwFrmFmt &rFrmFmt,
 									 const String& rAlternateTxt,
 									 ByteString &rEndTags,
-									 ULONG nFrmOpts )
+									 sal_uInt32 nFrmOpts )
 {
 	ByteString sOut;
 	const SfxPoolItem* pItem;
@@ -907,7 +907,7 @@ void SwHTMLWriter::OutFrmFmtOptions( con
 
 Writer& OutHTML_Image( Writer& rWrt, const SwFrmFmt &rFrmFmt,
 					   const String &rGrfName, const String& rAlternateTxt,
-					   const Size &rRealSize, ULONG nFrmOpts,
+					   const Size &rRealSize, sal_uInt32 nFrmOpts,
 					   const sal_Char *pMarkType,
 					   const ImageMap *pAltImgMap )
 {
@@ -1651,7 +1651,7 @@ static Writer & OutHTML_FrmFmtAsImage( W
         INetURLObject(rWrt.GetBaseURL()), aGrfNm,
         URIHelper::GetMaybeFileHdl() );
 	Size aSz( 0, 0 );
-	ULONG nFrmFlags = bInCntnr ? HTML_FRMOPTS_GENIMG_CNTNR
+	sal_uInt32 nFrmFlags = bInCntnr ? HTML_FRMOPTS_GENIMG_CNTNR
 								: HTML_FRMOPTS_GENIMG;
 	OutHTML_Image( rWrt, rFrmFmt, aGrfNm, rFrmFmt.GetName(), aSz,
 					HTML_FRMOPTS_GENIMG, pMarkToFrame,
@@ -1716,7 +1716,7 @@ static Writer& OutHTML_FrmFmtGrfNode( Wr
 			rWrt.CopyLocalFileToINet( aGrfNm );
 	}
 
-	ULONG nFrmFlags = bInCntnr ? HTML_FRMOPTS_IMG_CNTNR : HTML_FRMOPTS_IMG;
+	sal_uInt32 nFrmFlags = bInCntnr ? HTML_FRMOPTS_IMG_CNTNR : HTML_FRMOPTS_IMG;
 	if( rHTMLWrt.IsHTMLMode( HTMLMODE_ABS_POS_FLY ) && !bInCntnr )
 		nFrmFlags |= HTML_FRMOPTS_IMG_CSS1;
 	OutHTML_Image( rWrt, rFrmFmt, aGrfNm, pGrfNd->GetAlternateText(),
Index: sw/source/filter/html/htmlforw.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlforw.cxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/htmlforw.cxx	11 Jan 2005 12:26:29 -0000	1.12
+++ sw/source/filter/html/htmlforw.cxx	21 Jan 2005 17:00:33 -0000	1.12.8.1
@@ -444,7 +444,7 @@ void SwHTMLWriter::OutForm( sal_Bool bTa
             aHTMLControls[i]->nNdIdx <= nEndIdx; i++ )
         {
             const SwStartNode *pCntrlStNd =
-                pDoc->GetNodes()[aHTMLControls[i]->nNdIdx]->FindStartNode();
+                pDoc->GetNodes()[ ULONG( aHTMLControls[i]->nNdIdx ) ]->FindStartNode();
 
             if( xCurrentFormComps.is() )
             {
Index: sw/source/filter/html/htmlnum.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlnum.cxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/htmlnum.cxx	11 Jan 2005 12:26:57 -0000	1.12
+++ sw/source/filter/html/htmlnum.cxx	21 Jan 2005 17:00:41 -0000	1.12.8.1
@@ -748,7 +748,7 @@ void SwHTMLWriter::FillNextNumInfo()
 {
 	pNextNumRuleInfo = 0;
 
-	sal_uInt32 nPos = pCurPam->GetPoint()->nNode.GetIndex() + 1;
+	ULONG nPos = pCurPam->GetPoint()->nNode.GetIndex() + 1;
 
 	sal_Bool bDone = sal_False;
 	sal_Bool bTable = sal_False;
@@ -823,7 +823,7 @@ Writer& OutHTML_NumBulListStart( SwHTMLW
 				bStartValue = sal_True;
 				if( rInfo.GetDepth() > 1 )
 				{
-					sal_uInt32 nPos =
+					ULONG nPos =
 						rWrt.pCurPam->GetPoint()->nNode.GetIndex() + 1;
 					do
 					{
Index: sw/source/filter/html/htmlsect.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlsect.cxx,v
retrieving revision 1.11
retrieving revision 1.11.8.1
diff -u -p -u -p -r1.11 -r1.11.8.1
--- sw/source/filter/html/htmlsect.cxx	11 Jan 2005 12:27:24 -0000	1.11
+++ sw/source/filter/html/htmlsect.cxx	21 Jan 2005 17:00:48 -0000	1.11.8.1
@@ -506,7 +506,7 @@ void SwHTMLParser::FixHeaderFooterDistan
 	const SwFmtCntnt& rFlyCntnt = pHdFtFmt->GetCntnt();
 	const SwNodeIndex& rCntntStIdx = *rFlyCntnt.GetCntntIdx();
 
-	sal_uInt32 nPrvNxtIdx;
+	ULONG nPrvNxtIdx;
 	if( bHeader )
 	{
 		nPrvNxtIdx = pDoc->GetNodes()[rCntntStIdx]->EndOfSectionIndex()-1;
@@ -881,7 +881,7 @@ void SwHTMLParser::InsertFlyFrame( const
 /*  */
 
 void SwHTMLParser::MovePageDescAttrs( SwNode *pSrcNd,
-									  sal_uInt32 nDestIdx,
+									  ULONG nDestIdx,
 									  sal_Bool bFmtBreak )
 {
 	SwCntntNode* pDestCntntNd =
Index: sw/source/filter/html/htmltabw.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmltabw.cxx,v
retrieving revision 1.10
retrieving revision 1.10.84.1
diff -u -p -u -p -r1.10 -r1.10.84.1
--- sw/source/filter/html/htmltabw.cxx	3 May 2004 13:49:32 -0000	1.10
+++ sw/source/filter/html/htmltabw.cxx	21 Jan 2005 17:00:56 -0000	1.10.84.1
@@ -415,7 +415,7 @@ void SwHTMLWrtTable::OutTableCell( SwHTM
 	sal_Bool bHead = sal_False;
 	if( pSttNd )
 	{
-		sal_uInt32 nNdPos = pSttNd->GetIndex()+1;
+		ULONG nNdPos = pSttNd->GetIndex()+1;
 
 		// Art der Zelle (TD/TH) bestimmen
 		SwNode* pNd;
Index: sw/source/filter/html/svxcss1.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/svxcss1.cxx,v
retrieving revision 1.8
retrieving revision 1.8.8.1
diff -u -p -u -p -r1.8 -r1.8.8.1
--- sw/source/filter/html/svxcss1.cxx	11 Jan 2005 12:28:00 -0000	1.8
+++ sw/source/filter/html/svxcss1.cxx	21 Jan 2005 17:01:04 -0000	1.8.8.1
@@ -1066,7 +1066,7 @@ void SvxCSS1Parser::SetBorderWidth( SvxB
 	aBorderLine.SetDistance( aWidths[i+3] );
 }
 
-ULONG SvxCSS1Parser::GetFontHeight( USHORT nSize ) const
+sal_uInt32 SvxCSS1Parser::GetFontHeight( USHORT nSize ) const
 {
 	USHORT nHeight;
 
Index: sw/source/filter/html/swcss1.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/swcss1.hxx,v
retrieving revision 1.3
retrieving revision 1.3.8.1
diff -u -p -u -p -r1.3 -r1.3.8.1
--- sw/source/filter/html/swcss1.hxx	11 Jan 2005 12:28:27 -0000	1.3
+++ sw/source/filter/html/swcss1.hxx	21 Jan 2005 17:01:09 -0000	1.3.8.1
@@ -85,7 +85,7 @@ class SwCSS1Parser : public SvxCSS1Parse
 {
 	SwDoc *pDoc;
 
-	ULONG aFontHeights[7];
+	sal_uInt32 aFontHeights[7];
 
 	USHORT nDropCapCnt;
 
@@ -118,13 +118,13 @@ protected:
 							  SfxItemSet& rItemSet,
 							  SvxCSS1PropertyInfo& rPropInfo );
 public:
-    SwCSS1Parser( SwDoc *pDoc, ULONG aFHeight[7], const String& rBaseURL, BOOL bNewDoc );
+    SwCSS1Parser( SwDoc *pDoc, sal_uInt32 aFHeight[7], const String& rBaseURL, BOOL bNewDoc );
 	virtual ~SwCSS1Parser();
 
 	virtual BOOL ParseStyleSheet( const String& rIn );
 
 	// Die Font-Hoehe fuer eine bestimmte Font-Groesse (0-6) ermitteln
-	virtual ULONG GetFontHeight( USHORT nSize ) const;
+	virtual sal_uInt32 GetFontHeight( USHORT nSize ) const;
 
 	// Die aktuelle Font-Liste holen (auch 0 ist erlaubt)
 	virtual const FontList *GetFontList() const;
Index: sw/source/filter/html/swhtml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/swhtml.hxx,v
retrieving revision 1.10
retrieving revision 1.10.8.1
diff -u -p -u -p -r1.10 -r1.10.8.1
--- sw/source/filter/html/swhtml.hxx	11 Jan 2005 12:28:56 -0000	1.10
+++ sw/source/filter/html/swhtml.hxx	21 Jan 2005 17:01:23 -0000	1.10.8.1
@@ -638,7 +638,7 @@ class SwHTMLParser : public SfxHTMLParse
 	void GetULSpaceFromContext( sal_uInt16 &rUpper, sal_uInt16 &rLower ) const;
 
 
-	void MovePageDescAttrs( SwNode *pSrcNd, sal_uInt32 nDestIdx, sal_Bool bFmtBreak );
+	void MovePageDescAttrs( SwNode *pSrcNd, ULONG nDestIdx, sal_Bool bFmtBreak );
 
 	// Behandlung von Tags auf Absatz-Ebene
 
Index: sw/source/filter/html/wrthtml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/wrthtml.cxx,v
retrieving revision 1.29
retrieving revision 1.29.8.1
diff -u -p -u -p -r1.29 -r1.29.8.1
--- sw/source/filter/html/wrthtml.cxx	11 Jan 2005 12:29:10 -0000	1.29
+++ sw/source/filter/html/wrthtml.cxx	21 Jan 2005 17:01:35 -0000	1.29.8.1
@@ -288,7 +288,7 @@ __EXPORT SwHTMLWriter::~SwHTMLWriter()
 	delete pNumRuleInfo;
 }
 
-sal_uInt32 SwHTMLWriter::WriteStream()
+ULONG SwHTMLWriter::WriteStream()
 {
 	// neue Konfiguration setzen
 	SvxHtmlOptions* pHtmlOptions = SvxHtmlOptions::Get();
@@ -657,7 +657,7 @@ const SwFmtCol *lcl_html_GetFmtCol( cons
 	return pCol;
 }
 
-sal_Bool lcl_html_IsMultiColStart( const SwHTMLWriter& rHTMLWrt, sal_uInt32 nIndex )
+sal_Bool lcl_html_IsMultiColStart( const SwHTMLWriter& rHTMLWrt, ULONG nIndex )
 {
 	sal_Bool bRet = sal_False;
 	const SwSectionNode *pSectNd =
@@ -673,7 +673,7 @@ sal_Bool lcl_html_IsMultiColStart( const
 	return bRet;
 }
 
-sal_Bool lcl_html_IsMultiColEnd( const SwHTMLWriter& rHTMLWrt, sal_uInt32 nIndex )
+sal_Bool lcl_html_IsMultiColEnd( const SwHTMLWriter& rHTMLWrt, ULONG nIndex )
 {
 	sal_Bool bRet = sal_False;
 	const SwEndNode *pEndNd = rHTMLWrt.pDoc->GetNodes()[nIndex]->GetEndNode();
@@ -827,8 +827,8 @@ static Writer& OutHTML_Section( Writer& 
 	const SwSection *pSurrSection = 0;
 	const SwFmtCol *pSurrCol = 0;
 
-	sal_uInt32 nSectSttIdx = rSectNd.GetIndex();
-	sal_uInt32 nSectEndIdx = rSectNd.EndOfSectionIndex();
+	ULONG nSectSttIdx = rSectNd.GetIndex();
+	ULONG nSectEndIdx = rSectNd.EndOfSectionIndex();
 	const SwFmtCol *pCol = lcl_html_GetFmtCol( rHTMLWrt, rSection, *pFmt );
 	if( pCol )
 	{
@@ -1037,8 +1037,8 @@ static void OutBodyColor( const sal_Char
 
 sal_uInt16 SwHTMLWriter::OutHeaderAttrs()
 {
-	sal_uInt32 nIdx = pCurPam->GetPoint()->nNode.GetIndex();
-	sal_uInt32 nEndIdx = pCurPam->GetMark()->nNode.GetIndex();
+	ULONG nIdx = pCurPam->GetPoint()->nNode.GetIndex();
+	ULONG nEndIdx = pCurPam->GetMark()->nNode.GetIndex();
 
 	SwTxtNode *pTxtNd = 0;
 	while( nIdx<=nEndIdx &&
@@ -1112,7 +1112,7 @@ const SwPageDesc *SwHTMLWriter::MakeHead
 	//{
 		// In Nicht-HTML-Dokumenten wird die erste gesetzte Seitenvorlage
 		// exportiert und wenn keine gesetzt ist die Standard-Vorlage
-		sal_uInt32 nNodeIdx = pCurPam->GetPoint()->nNode.GetIndex();
+		ULONG nNodeIdx = pCurPam->GetPoint()->nNode.GetIndex();
 
 		while( nNodeIdx < pDoc->GetNodes().Count() )
 		{
@@ -1495,8 +1495,8 @@ sal_uInt16 SwHTMLWriter::GetHTMLFontSize
 
 // Struktur speichert die aktuellen Daten des Writers zwischen, um
 // einen anderen Dokument-Teil auszugeben, wie z.B. Header/Footer
-HTMLSaveData::HTMLSaveData( SwHTMLWriter& rWriter, sal_uInt32 nStt,
-							sal_uInt32 nEnd, sal_Bool bSaveNum,
+HTMLSaveData::HTMLSaveData( SwHTMLWriter& rWriter, ULONG nStt,
+							ULONG nEnd, sal_Bool bSaveNum,
 	   					 	const SwFrmFmt *pFrmFmt	)
 	: rWrt( rWriter ),
 	pOldPam( rWrt.pCurPam ), pOldEnd( rWrt.GetEndPaM() ),
Index: sw/source/filter/html/wrthtml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/wrthtml.hxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/wrthtml.hxx	11 Jan 2005 12:29:25 -0000	1.12
+++ sw/source/filter/html/wrthtml.hxx	21 Jan 2005 17:01:49 -0000	1.12.8.1
@@ -260,7 +260,7 @@ class SwHTMLWriter : public Writer
 	void CollectLinkTargets();
 
 protected:
-	sal_uInt32 WriteStream();
+	ULONG WriteStream();
 
 public:
 #if defined(MAC) || defined(UNX)
@@ -588,7 +588,7 @@ struct HTMLSaveData
 	sal_Bool bOldOutFlyFrame : 1;
 	const SwFlyFrmFmt* pOldFlyFmt;
 
-	HTMLSaveData( SwHTMLWriter&, sal_uInt32 nStt, sal_uInt32 nEnd,
+	HTMLSaveData( SwHTMLWriter&, ULONG nStt, ULONG nEnd,
 				  sal_Bool bSaveNum=sal_True,
 		   		  const SwFrmFmt *pFrmFmt=0	);
 	~HTMLSaveData();
Index: sw/source/filter/ww8/wrtw8esh.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtw8esh.cxx,v
retrieving revision 1.83
retrieving revision 1.77.8.5
diff -u -p -u -p -r1.83 -r1.77.8.5
--- sw/source/filter/ww8/wrtw8esh.cxx	22 Feb 2005 08:22:24 -0000	1.83
+++ sw/source/filter/ww8/wrtw8esh.cxx	10 Mar 2005 02:01:29 -0000	1.77.8.5
@@ -571,7 +571,7 @@ bool RTLGraphicsHack(long &rLeft, long n
     return bRet;
 }
 
-bool RTLDrawingsHack(long &rLeft, long nWidth,
+bool RTLDrawingsHack(long &rLeft, long nWidth, 
     SwHoriOrient eHoriOri, SwRelationOrient eHoriRel, SwTwips nPageLeft,
     SwTwips nPageRight, SwTwips nPageSize)
 {
@@ -603,7 +603,7 @@ bool SwWW8Writer::MiserableRTLFrmFmtHack
     if (FRMDIR_HORI_RIGHT_TOP != pDoc->GetTextDirection(rFrmFmt.GetPosition()))
         return false;
 
-    long nWidth = rRight - rLeft;
+    sal_Int32 nWidth = rRight - rLeft;
     SwTwips nPageLeft, nPageRight;
     SwTwips nPageSize = CurrentPageWidth(nPageLeft, nPageRight);
 
@@ -729,8 +729,8 @@ void PlcDrawObj::WritePlc(SwWW8Writer& r
             // spid
             SwWW8Writer::WriteLong(*rWrt.pTableStrm, aIter->mnShapeId);
 
-            sal_Int32 nLeft = aRect.Left() + nThick;
-            sal_Int32 nRight = aRect.Right() - nThick;
+            long nLeft = aRect.Left() + nThick;
+            long nRight = aRect.Right() - nThick;
 
             //Nasty swap for bidi if neccessary
             rWrt.MiserableRTLFrmFmtHack(nLeft, nRight, rFrmFmt);
@@ -883,7 +883,7 @@ bool WW8_WrPlcTxtBoxes::WriteTxt(SwWW8Wr
 {
     bool bRet = false;
     rWrt.bInWriteEscher = true;
-    long& rccp=TXT_TXTBOX == nTyp ? rWrt.pFib->ccpTxbx : rWrt.pFib->ccpHdrTxbx;
+    sal_Int32& rccp=TXT_TXTBOX == nTyp ? rWrt.pFib->ccpTxbx : rWrt.pFib->ccpHdrTxbx;
 
     bRet = WriteGenericTxt( rWrt, nTyp, rccp );
 
@@ -2085,13 +2085,13 @@ SwEscherEx::SwEscherEx(SvStream* pStrm, 
 
         EnterGroup( 0 );
 
-        ULONG nSecondShapeId = pSdrObjs == rWrt.pSdrObjs ? GetShapeID() : 0;
+        sal_uInt32 nSecondShapeId = pSdrObjs == rWrt.pSdrObjs ? GetShapeID() : 0;
 
         // write now all Writer-/DrawObjects
         DrawObjPointerVector aSorted;
         MakeZOrderArrAndFollowIds(pSdrObjs->GetObjArr(), aSorted);
 
-        ULONG nShapeId=0;
+        sal_uInt32 nShapeId=0;
         DrawObjPointerIter aEnd = aSorted.end();
         for (DrawObjPointerIter aIter = aSorted.begin(); aIter != aEnd; ++aIter)
         {
Index: sw/source/filter/ww8/wrtw8sty.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtw8sty.cxx,v
retrieving revision 1.33
retrieving revision 1.33.64.1
diff -u -p -u -p -r1.33 -r1.33.64.1
--- sw/source/filter/ww8/wrtw8sty.cxx	25 May 2004 15:11:16 -0000	1.33
+++ sw/source/filter/ww8/wrtw8sty.cxx	9 Sep 2004 09:53:06 -0000	1.33.64.1
@@ -1765,7 +1765,7 @@ void WW8_WrPlcPostIt::Append( WW8_CP nCp
 }
 
 bool WW8_WrPlcSubDoc::WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, 
-    long& rCount)
+    sal_Int32& rCount)
 {
     bool bRet = false;
     USHORT nLen = aCntnt.Count();
@@ -1862,7 +1862,7 @@ bool WW8_WrPlcSubDoc::WriteGenericTxt(Sw
 }
 
 void WW8_WrPlcSubDoc::WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp,
-    long& rTxtStart, long& rTxtCount, long& rRefStart, long& rRefCount ) const
+    WW8_FC& rTxtStart, sal_Int32& rTxtCount, WW8_FC& rRefStart, sal_Int32& rRefCount ) const
 {
     typedef ::std::vector<String>::iterator myiter;
 
Index: sw/source/filter/ww8/wrtww8.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtww8.cxx,v
retrieving revision 1.71
retrieving revision 1.67.8.4
diff -u -p -u -p -r1.71 -r1.67.8.4
--- sw/source/filter/ww8/wrtww8.cxx	18 Jan 2005 14:28:38 -0000	1.71
+++ sw/source/filter/ww8/wrtww8.cxx	10 Mar 2005 02:01:46 -0000	1.67.8.4
@@ -748,7 +748,7 @@ bool WW8_WrPlcFld::Write(SwWW8Writer& rW
     if( WW8_WrPlc1::Count() <= 1 )
         return false;
 
-    long *pfc, *plc;
+    sal_Int32 *pfc, *plc;
     switch (nTxtTyp)
     {
         case TXT_MAINTEXT:
Index: sw/source/filter/ww8/wrtww8.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtww8.hxx,v
retrieving revision 1.64
retrieving revision 1.59.96.4
diff -u -p -u -p -r1.64 -r1.59.96.4
--- sw/source/filter/ww8/wrtww8.hxx	11 Jan 2005 12:35:05 -0000	1.64
+++ sw/source/filter/ww8/wrtww8.hxx	21 Jan 2005 17:02:05 -0000	1.59.96.4
@@ -765,9 +765,9 @@ protected:
     WW8_WrPlcSubDoc();
     virtual ~WW8_WrPlcSubDoc();
 
-    bool WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, long& rCount);
-    void WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp, long& rTxtStt,
-        long& rTxtCnt, long& rRefStt, long& rRefCnt ) const;
+    bool WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, sal_Int32& rCount);
+    void WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp, WW8_FC& rTxtStt,
+        sal_Int32& rTxtCnt, WW8_FC& rRefStt, sal_Int32& rRefCnt ) const;
 
     virtual const SvULongs* GetShapeIdArr() const;
 };
Index: sw/source/filter/ww8/ww8glsy.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8glsy.cxx,v
retrieving revision 1.20
retrieving revision 1.18.238.3
diff -u -p -u -p -r1.20 -r1.18.238.3
--- sw/source/filter/ww8/ww8glsy.cxx	11 Jan 2005 12:35:37 -0000	1.20
+++ sw/source/filter/ww8/ww8glsy.cxx	18 Jan 2005 16:53:00 -0000	1.18.238.3
@@ -355,7 +355,7 @@ UINT32 WW8GlossaryFib::FindGlossaryFibOf
         SvStream &rStrm, const WW8Fib &rFib)
 {
     WW8PLCF aPlc( &rTableStrm, rFib.fcPlcfsed, rFib.lcbPlcfsed, 12 );
-    long start,ende;
+    WW8_CP start,ende;
     void *pData;
     aPlc.Get(start,ende,pData);
     UINT32 nPo = SVBT32ToLong((BYTE *)pData+2);
Index: sw/source/filter/ww8/ww8graf.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8graf.cxx,v
retrieving revision 1.129
retrieving revision 1.118.8.4
diff -u -p -u -p -r1.129 -r1.118.8.4
--- sw/source/filter/ww8/ww8graf.cxx	16 Feb 2005 17:02:17 -0000	1.129
+++ sw/source/filter/ww8/ww8graf.cxx	10 Mar 2005 02:00:44 -0000	1.118.8.4
@@ -978,7 +978,7 @@ void SwWW8ImplReader::InsertTxbxAttrs(lo
     aSave.Restore(this);
 }
 
-bool SwWW8ImplReader::GetTxbxTextSttEndCp(long& rStartCp, long& rEndCp,
+bool SwWW8ImplReader::GetTxbxTextSttEndCp(WW8_CP& rStartCp, WW8_CP& rEndCp,
     USHORT nTxBxS, USHORT nSequence)
 {
     // rasch den TextBox-PLCF greifen
@@ -1113,7 +1113,7 @@ SwFrmFmt* SwWW8ImplReader::InsertTxbxTex
     rbEraseTextObj = false;
 
     String aString;
-    long nStartCp, nEndCp;
+    WW8_CP nStartCp, nEndCp;
     bool bContainsGraphics = false;
     bool bTextWasRead = GetTxbxTextSttEndCp( nStartCp, nEndCp, nTxBxS,
         nSequence ) && GetTxbxText( aString, nStartCp, nEndCp );
@@ -1515,7 +1515,7 @@ SdrObject* SwWW8ImplReader::ReadGrafPrim
 void SwWW8ImplReader::ReadGrafLayer1( WW8PLCFspecial* pPF, long nGrafAnchorCp )
 {
     pPF->SeekPos( nGrafAnchorCp );
-    long nStartFc;
+    WW8_CP nStartFc;
     void* pF0;
     if( !pPF->Get( nStartFc, pF0 ) )
     {
@@ -2618,7 +2618,7 @@ SwFrmFmt* SwWW8ImplReader::Read_GrafLaye
     //Normal case of Word 8+ version stuff
     pPF->SeekPos( nGrafAnchorCp );
 
-    long nStartFc;
+    WW8_CP nStartFc;
     void* pF0;
     if( !pPF->Get( nStartFc, pF0 ) ){
         ASSERT( !this, "+Wo ist die Grafik (2) ?" );
Index: sw/source/filter/ww8/ww8par.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par.cxx,v
retrieving revision 1.151
retrieving revision 1.136.64.5
diff -u -p -u -p -r1.151 -r1.136.64.5
--- sw/source/filter/ww8/ww8par.cxx	22 Feb 2005 10:03:56 -0000	1.151
+++ sw/source/filter/ww8/ww8par.cxx	10 Mar 2005 02:01:38 -0000	1.136.64.5
@@ -2787,7 +2787,7 @@ bool SwWW8ImplReader::ReadChar(long nPos
                 if (pTest && pTest->SeekPosExact(nPosCp+1+nCpOfs) &&
                     pTest->Where() == nPosCp+1+nCpOfs)
                 {
-                    long nPos;
+                    WW8_CP nPos;
                     void *pData;
                     pTest->Get(nPos, pData);
                     sal_uInt32 nData = SVBT32ToLong(*(SVBT32*)pData);
@@ -3036,14 +3036,14 @@ bool SwWW8ImplReader::ReadText(long nSta
     pPlcxMan = new WW8PLCFMan( pSBase, nType, nStartCp );
     long nCpOfs = pPlcxMan->GetCpOfs(); // Offset fuer Header/Footer, Footnote
 
-    WW8_CP nNext = pPlcxMan->Where();
+    long nNext = pPlcxMan->Where();
     SwTxtNode* pPreviousNode = 0;
     BYTE nDropLines = 0;
     SwCharFmt* pNewSwCharFmt = 0;
     const SwCharFmt* pFmt = 0;
     pStrm->Seek( pSBase->WW8Cp2Fc( nStartCp + nCpOfs, &bIsUnicode ) );
 
-    WW8_CP l = nStartCp;
+    long l = nStartCp;
     while ( l<nStartCp+nTextLen )
     {
 
@@ -4727,7 +4727,7 @@ BOOL SwMSDffManager::GetOLEStorageName(l
             // wasn't successful. Thus, continue in this case.
             // Note: Ask MM for initialization of <nStartCp> and <nEndCp>.
             // Note: Ask MM about assertions in method <rReader.GetTxbxTextSttEndCp(..)>.
-            long nStartCp, nEndCp;
+            WW8_CP nStartCp, nEndCp;
             if ( rReader.GetTxbxTextSttEndCp(nStartCp, nEndCp,
                             static_cast<sal_uInt16>((nOLEId >> 16) & 0xFFFF),
                             static_cast<sal_uInt16>(nOLEId & 0xFFFF)) )
Index: sw/source/filter/ww8/ww8par.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par.hxx,v
retrieving revision 1.135
retrieving revision 1.128.64.4
diff -u -p -u -p -r1.135 -r1.128.64.4
--- sw/source/filter/ww8/ww8par.hxx	11 Jan 2005 13:26:42 -0000	1.135
+++ sw/source/filter/ww8/ww8par.hxx	21 Jan 2005 17:03:22 -0000	1.128.64.4
@@ -1293,7 +1293,7 @@ private:
     void InsertTxbxStyAttrs( SfxItemSet& rS, USHORT nColl );
     void InsertTxbxAttrs(long nStartCp, long nEndCp, bool bONLYnPicLocFc);
 
-    bool GetTxbxTextSttEndCp(long& rStartCp, long& rEndCp, USHORT nTxBxS,
+    bool GetTxbxTextSttEndCp(WW8_CP& rStartCp, WW8_CP& rEndCp, USHORT nTxBxS,
         USHORT nSequence);
     bool GetTxbxText(String& rString, long StartCp, long nEndCp);
     SwFrmFmt* InsertTxbxText(SdrTextObj* pTextObj, Size* pObjSiz,
@@ -1516,7 +1516,7 @@ public:     // eigentlich private, geht 
     eF_ResT Read_F_DocInfo( WW8FieldDesc* pF, String& rStr );
     eF_ResT Read_F_Author( WW8FieldDesc*, String& );
     eF_ResT Read_F_TemplName( WW8FieldDesc*, String& );
-    short GetTimeDatePara(String& rStr, ULONG& rFormat, USHORT &rLang,
+    short GetTimeDatePara(String& rStr, sal_uInt32& rFormat, USHORT &rLang,
         int nWhichDefault, bool bHijri = false);
     bool ForceFieldLanguage(SwField &rFld, USHORT nLang);
     eF_ResT Read_F_DateTime( WW8FieldDesc*, String& rStr );
Index: sw/source/filter/ww8/ww8par5.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par5.cxx,v
retrieving revision 1.87
retrieving revision 1.86.8.2
diff -u -p -u -p -r1.87 -r1.86.8.2
--- sw/source/filter/ww8/ww8par5.cxx	16 Feb 2005 17:47:49 -0000	1.87
+++ sw/source/filter/ww8/ww8par5.cxx	10 Mar 2005 02:00:53 -0000	1.86.8.2
@@ -707,7 +707,7 @@ String GetWordDefaultDateStringAsUS(SvNu
     return sParams;
 }
 
-short SwWW8ImplReader::GetTimeDatePara(String& rStr, ULONG& rFormat,
+short SwWW8ImplReader::GetTimeDatePara(String& rStr, sal_uInt32& rFormat,
     USHORT &rLang, int nWhichDefault, bool bHijri)
 {
     bool bRTL = false;
Index: sw/source/filter/ww8/ww8par6.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par6.cxx,v
retrieving revision 1.161
retrieving revision 1.153.62.4
diff -u -p -u -p -r1.161 -r1.153.62.4
--- sw/source/filter/ww8/ww8par6.cxx	27 Jan 2005 11:12:38 -0000	1.161
+++ sw/source/filter/ww8/ww8par6.cxx	10 Mar 2005 02:01:01 -0000	1.153.62.4
@@ -1003,7 +1003,7 @@ void wwSectionManager::CreateSep(const l
             pWkb->Where() == nTxtPos)
     {
         void* pData;
-        long nTest;
+        WW8_CP nTest;
         pWkb->Get(nTest, pData);
         String sSectionName = mrReader.aLinkStringMap[SVBT16ToShort( ((WW8_WKB*)pData)->nLinkId) ];
         mrReader.ConvertFFileName(sSectionName, sSectionName);
Index: sw/source/filter/ww8/ww8scan.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8scan.cxx,v
retrieving revision 1.114
retrieving revision 1.110.8.2
diff -u -p -u -p -r1.114 -r1.110.8.2
--- sw/source/filter/ww8/ww8scan.cxx	20 Sep 2004 15:21:14 -0000	1.114
+++ sw/source/filter/ww8/ww8scan.cxx	20 Oct 2004 12:29:24 -0000	1.110.8.2
@@ -1140,7 +1140,7 @@ WW8_CP WW8PLCFx_PCD::Where()
     return pPcdI ? pPcdI->Where() : LONG_MAX;
 }
 
-long WW8PLCFx_PCD::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+long WW8PLCFx_PCD::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, long& rLen )
 {
     void* pData;
     rLen = 0;
@@ -1190,7 +1190,7 @@ WW8_FC WW8PLCFx_PCD::AktPieceStartCp2Fc(
 }
 
 
-void WW8PLCFx_PCD::AktPieceFc2Cp( long& rStartPos, long& rEndPos,
+void WW8PLCFx_PCD::AktPieceFc2Cp( WW8_CP& rStartPos, WW8_CP& rEndPos,
     const WW8ScannerBase *pSBase )
 {
     //No point going anywhere with this
@@ -1460,7 +1460,7 @@ WW8_CP WW8ScannerBase::WW8Fc2Cp( WW8_FC 
         for (pPieceIter->SetIdx(0);
             pPieceIter->GetIdx() < pPieceIter->GetIMax();(*pPieceIter)++)
         {
-            long nCpStart, nCpEnd;
+            WW8_CP nCpStart, nCpEnd;
             void* pData;
             if( !pPieceIter->Get( nCpStart, nCpEnd, pData ) )
             {   // ausserhalb PLCFfpcd ?
@@ -1535,7 +1535,7 @@ WW8_FC WW8ScannerBase::WW8Cp2Fc(WW8_CP n
                 ASSERT( !this, "Falscher CP an WW8Cp2Fc() uebergeben" );
             return LONG_MAX;
         }
-        long nCpStart, nCpEnd;
+        WW8_CP nCpStart, nCpEnd;
         void* pData;
         if( !pPieceIter->Get( nCpStart, nCpEnd, pData ) )
         {
@@ -1813,7 +1813,7 @@ WW8ScannerBase::~WW8ScannerBase()
 static bool WW8SkipField(WW8PLCFspecial& rPLCF)
 {
     void* pData;
-    long nP;
+    WW8_CP nP;
 
     if (!rPLCF.Get(nP, pData))              // Ende des PLCFspecial ?
         return false;
@@ -2164,12 +2164,12 @@ bool WW8PLCFspecial::SeekPosExact(long n
     return false;
 }
 
-bool WW8PLCFspecial::Get(long& rPos, void*& rpValue) const
+bool WW8PLCFspecial::Get(WW8_CP& rPos, void*& rpValue) const
 {
     return GetData( nIdx, rPos, rpValue );
 }
 
-bool WW8PLCFspecial::GetData(long nInIdx, long& rPos, void*& rpValue) const
+bool WW8PLCFspecial::GetData(WW8_CP nInIdx, WW8_CP& rPos, void*& rpValue) const
 {
     if ( nInIdx >= nIMax )
     {
@@ -2313,7 +2313,7 @@ bool WW8PLCF::SeekPos(long nPos)
     return false;
 }
 
-bool WW8PLCF::Get(long& rStart, long& rEnd, void*& rpValue) const
+bool WW8PLCF::Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const
 {
     if ( nIdx >= nIMax )
     {
@@ -2326,7 +2326,7 @@ bool WW8PLCF::Get(long& rStart, long& rE
     return true;
 }
 
-long WW8PLCF::Where() const
+WW8_CP WW8PLCF::Where() const
 {
     if ( nIdx >= nIMax )
         return LONG_MAX;
@@ -2400,7 +2400,7 @@ bool WW8PLCFpcd_Iter::SeekPos(long nPos)
     return false;
 }
 
-bool WW8PLCFpcd_Iter::Get(long& rStart, long& rEnd, void*& rpValue) const
+bool WW8PLCFpcd_Iter::Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const
 {
     if( nIdx >= rPLCF.nIMax )
     {
@@ -2413,7 +2413,7 @@ bool WW8PLCFpcd_Iter::Get(long& rStart, 
     return true;
 }
 
-long WW8PLCFpcd_Iter::Where() const
+WW8_FC WW8PLCFpcd_Iter::Where() const
 {
     if ( nIdx >= rPLCF.nIMax )
         return LONG_MAX;
@@ -2621,7 +2621,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::SeekPos(WW
     return false;
 }
 
-BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Get(WW8_FC& rStart, WW8_FC& rEnd, long& rLen)
+BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Get(WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen)
     const
 {
     rLen = 0;
@@ -2649,7 +2649,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::SetIdx(sal
     return false;
 }
 
-BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::GetLenAndIStdAndSprms(long& rLen) const
+BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::GetLenAndIStdAndSprms(WW8_CP& rLen) const
 {
     rLen = maEntries[mnIdx].mnLen;
     return maEntries[mnIdx].mpData;
@@ -2660,7 +2660,7 @@ const BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Has
     if (mnIdx >= mnIMax)
         return 0;
 
-    long nLen;
+    WW8_CP nLen;
     BYTE* pSprms = GetLenAndIStdAndSprms( nLen );
 
     WW8SprmIter aIter(pSprms, nLen, maSprmParser);
@@ -2673,7 +2673,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::HasSprm(US
     if (mnIdx >= mnIMax)
        return false;
 
-    long nLen;
+    WW8_CP nLen;
     BYTE* pSprms = GetLenAndIStdAndSprms( nLen );
 
     WW8SprmIter aIter(pSprms, nLen, maSprmParser);
@@ -2698,7 +2698,7 @@ void WW8PLCFx::GetSprms( WW8PLCFxDesc* p
     return;
 }
 
-long WW8PLCFx::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+WW8_CP WW8PLCFx::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen )
 {
     ASSERT( !this, "Falsches GetNoSprms gerufen" );
     rStart = rEnd = LONG_MAX;
@@ -2730,7 +2730,7 @@ public:
 //-----------------------------------------
 bool WW8PLCFx_Fc_FKP::NewFkp()
 {
-    long nPLCFStart, nPLCFEnd;
+    WW8_CP nPLCFStart, nPLCFEnd;
     void* pPage;
 
     static const int WW8FkpSizeTabVer6[ PLCF_END ] =
@@ -2859,7 +2859,7 @@ bool WW8PLCFx_Fc_FKP::SeekPos(WW8_FC nFc
     bool bRet = pPLCF->SeekPos(nFcPos);
 
     // make FKP invalid?
-    long nPLCFStart, nPLCFEnd;
+    WW8_CP nPLCFStart, nPLCFEnd;
     void* pPage;
     if( pFkp && pPLCF->Get( nPLCFStart, nPLCFEnd, pPage ) )
     {
@@ -2888,7 +2888,7 @@ WW8_FC WW8PLCFx_Fc_FKP::Where()
     return Where();                     // am einfachsten rekursiv
 }
 
-BYTE* WW8PLCFx_Fc_FKP::GetSprmsAndPos(WW8_FC& rStart, WW8_FC& rEnd, long& rLen)
+BYTE* WW8PLCFx_Fc_FKP::GetSprmsAndPos(WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen)
 {
     rLen = 0;                               // Default
     rStart = rEnd = LONG_MAX;
@@ -3155,7 +3155,7 @@ void WW8PLCFx_Cp_FKP::GetSprms(WW8PLCFxD
                 FC of the piece, the end of the paragraph that contains the
                 character is at the FKP FC minus 1.
                 */
-                long nCpStart, nCpEnd;
+                WW8_CP nCpStart, nCpEnd;
                 void* pData;
                 pPieceIter->Get(nCpStart, nCpEnd, pData);
 
@@ -3271,7 +3271,7 @@ WW8PLCFx& WW8PLCFx_Cp_FKP::operator ++( 
         return *this;
     }
 
-    long nFkpLen;                               // Fkp-Eintrag
+    WW8_CP nFkpLen;                               // Fkp-Eintrag
     // Fkp-Eintrag holen
     WW8PLCFx_Fc_FKP::GetSprmsAndPos(nAttrStart, nAttrEnd, nFkpLen);
 
@@ -3511,7 +3511,7 @@ void WW8PLCFx_SubDoc::GetSprms(WW8PLCFxD
     ULONG nNr = pRef->GetIdx();
 
     void *pData;
-    long nFoo;
+    WW8_CP nFoo;
     if (!pRef->Get(p->nStartPos, nFoo, pData))
     {
         p->nEndPos = p->nStartPos = LONG_MAX;
@@ -3619,7 +3619,7 @@ WW8_CP WW8PLCFx_FLD::Where()
 bool WW8PLCFx_FLD::StartPosIsFieldStart()
 {
     void* pData;
-    long nTest;
+    WW8_CP nTest;
     if (
          (!pPLCF || !pPLCF->Get(nTest, pData) ||
          ((((BYTE*)pData)[0] & 0x1f) != 0x13))
@@ -3639,7 +3639,7 @@ bool WW8PLCFx_FLD::EndPosIsFieldEnd()
         (*pPLCF)++;
 
         void* pData;
-        long nTest;
+        WW8_CP nTest;
         if ( pPLCF->Get(nTest, pData) && ((((BYTE*)pData)[0] & 0x1f) == 0x15) )
             bRet = true;
 
@@ -3664,7 +3664,7 @@ void WW8PLCFx_FLD::GetSprms(WW8PLCFxDesc
 
     long n = pPLCF->GetIdx();
 
-    long nP;
+    WW8_CP nP;
     void *pData;
     if (!pPLCF->Get(nP, pData))             // Ende des PLCFspecial ?
     {
@@ -3902,7 +3902,7 @@ WW8_CP WW8PLCFx_Book::Where()
     return pBook[nIsEnd]->Where();
 }
 
-long WW8PLCFx_Book::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+WW8_CP WW8PLCFx_Book::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen )
 {
     void* pData;
     rEnd = LONG_MAX;
Index: sw/source/filter/ww8/ww8scan.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8scan.hxx,v
retrieving revision 1.69
retrieving revision 1.67.216.2
diff -u -p -u -p -r1.69 -r1.67.216.2
--- sw/source/filter/ww8/ww8scan.hxx	20 Sep 2004 15:21:29 -0000	1.69
+++ sw/source/filter/ww8/ww8scan.hxx	20 Oct 2004 12:26:50 -0000	1.67.216.2
@@ -223,9 +223,9 @@ struct WW8FieldDesc
 {
     long nLen;              // Gesamtlaenge ( zum Text ueberlesen )
     WW8_CP nSCode;           // Anfang Befehlscode
-    long nLCode;            // Laenge
+    WW8_CP nLCode;            // Laenge
     WW8_CP nSRes;           // Anfang Ergebnis
-    long nLRes;             // Laenge ( == 0, falls kein Ergebnis )
+    WW8_CP nLRes;             // Laenge ( == 0, falls kein Ergebnis )
     USHORT nId;             // WW-Id fuer Felder
     BYTE nOpt;              // WW-Flags ( z.B.: vom User geaendert )
     BYTE bCodeNest:1;       // Befehl rekursiv verwendet
@@ -255,7 +255,7 @@ private:
     INT32* pPLCF_PosArray;  // Pointer auf Pos-Array und auf ganze Struktur
     BYTE*  pPLCF_Contents;  // Pointer auf Inhalts-Array-Teil des Pos-Array
     long nIMax;             // Anzahl der Elemente
-    long nIdx;              // Merker, wo wir gerade sind
+    WW8_CP nIdx;              // Merker, wo wir gerade sind
     long nStru;
 public:
     WW8PLCFspecial( SvStream* pSt, long nFilePos, long nPLCF,
@@ -267,10 +267,10 @@ public:
     bool SeekPos(long nPos);            // geht ueber FC- bzw. CP-Wert
                                         // bzw. naechste groesseren Wert
     bool SeekPosExact(long nPos);
-    long Where() const 
+    WW8_FC Where() const 
         { return ( nIdx >= nIMax ) ? LONG_MAX : pPLCF_PosArray[nIdx]; }
-    bool Get(long& rStart, void*& rpValue) const;
-    bool GetData(long nIdx, long& rPos, void*& rpValue) const;
+    bool Get(WW8_CP& rStart, void*& rpValue) const;
+    bool GetData(WW8_CP nIdx, WW8_CP& rPos, void*& rpValue) const;
 
     const void* GetData( long nInIdx ) const 
     {
@@ -346,8 +346,8 @@ public:
     void SetIdx( long nI ) { nIdx = nI; }
     long GetIMax() const { return nIMax; }
     bool SeekPos(long nPos);
-    long Where() const;
-    bool Get(long& rStart, long& rEnd, void*& rpValue) const;
+    WW8_FC Where() const;
+    bool Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const;
     WW8PLCF& operator ++( int ) { if( nIdx < nIMax ) nIdx++; return *this; }
 
     const void* GetData( long nInIdx ) const 
@@ -386,8 +386,8 @@ public:
     void SetIdx( long nI ) { nIdx = nI; }
     long GetIMax() const { return rPLCF.nIMax; }
     bool SeekPos(long nPos);
-    long Where() const;
-    bool Get(long& rStart, long& rEnd, void*& rpValue) const;
+    WW8_FC Where() const;
+    bool Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const;
     WW8PLCFpcd_Iter& operator ++( int ) 
     { 
         if( nIdx < rPLCF.nIMax ) 
@@ -425,9 +425,9 @@ public:
     virtual ULONG GetIdx2() const;
     virtual void SetIdx2( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos) = 0;
-    virtual long Where() = 0;
+    virtual WW8_FC Where() = 0;
     virtual void GetSprms( WW8PLCFxDesc* p );
-    virtual long GetNoSprms( long& rStart, long&, long& rLen );
+    virtual WW8_CP GetNoSprms( WW8_CP& rStart, WW8_CP&, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int ) = 0;
     virtual USHORT GetIstd() const { return 0xffff; }
     virtual void Save( WW8PLCFxSave1& rSave ) const;
@@ -458,7 +458,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nI );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms( WW8PLCFxDesc* p );
     virtual WW8PLCFx& operator ++( int );
 
@@ -483,12 +483,12 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nI );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
-    virtual long GetNoSprms( long& rStart, long&, long& rLen );
+    virtual WW8_FC Where();
+    virtual long GetNoSprms( WW8_CP& rStart, WW8_CP&, long& rLen );
     virtual WW8PLCFx& operator ++( int );
     WW8_CP AktPieceStartFc2Cp( WW8_FC nStartPos );
     WW8_FC AktPieceStartCp2Fc( WW8_CP nCp );
-    void AktPieceFc2Cp(long& rStartPos, long& rEndPos, 
+    void AktPieceFc2Cp(WW8_CP& rStartPos, WW8_CP& rEndPos, 
         const WW8ScannerBase *pSBase);
     WW8PLCFpcd_Iter* GetPLCFIter() { return pPcdI; }
     void SetClipStart(WW8_CP nIn) { nClipStart = nIn; }
@@ -559,14 +559,14 @@ public:
                 mnIdx++;
             return *this; 
         }
-        BYTE* Get( WW8_FC& rStart, WW8_FC& rEnd, long& rLen ) const;
+        BYTE* Get( WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen ) const;
         sal_uInt16 GetIstd() const { return maEntries[mnIdx].mnIStd; }
 
         /*
             liefert einen echten Pointer auf das Sprm vom Typ nId,
             falls ein solches im Fkp drin ist.
         */
-        BYTE* GetLenAndIStdAndSprms(long& rLen) const;
+        BYTE* GetLenAndIStdAndSprms(WW8_CP& rLen) const;
 
         /*
             ruft GetLenAndIStdAndSprms() auf...
@@ -615,7 +615,7 @@ public:
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_FC nFcPos);
     virtual WW8_FC Where();
-    BYTE* GetSprmsAndPos( WW8_FC& rStart, WW8_FC& rEnd, long& rLen );
+    BYTE* GetSprmsAndPos( WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int );
     virtual USHORT GetIstd() const;
     void GetPCDSprms( WW8PLCFxDesc& rDesc );
@@ -678,7 +678,7 @@ public:
     virtual void SetIdx( ULONG nIdx );
     long GetIMax() const { return ( pPLCF ) ? pPLCF->GetIMax() : 0; }
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms( WW8PLCFxDesc* p );
     virtual WW8PLCFx& operator ++( int );
     const BYTE* HasSprm( USHORT nId ) const;
@@ -706,7 +706,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
 
     // liefert Reference Descriptoren
     const void* GetData( long nIdx = -1 ) const
@@ -736,7 +736,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms(WW8PLCFxDesc* p);
     virtual WW8PLCFx& operator ++( int );
     bool StartPosIsFieldStart();
@@ -768,8 +768,8 @@ public:
     virtual ULONG GetIdx2() const;
     virtual void SetIdx2( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
-    virtual long GetNoSprms( long& rStart, long& rEnd, long& rLen );
+    virtual WW8_FC Where();
+    virtual WW8_CP GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int );
     const String* GetName() const;
     WW8_CP GetStartPos() const
@@ -821,8 +821,8 @@ struct WW8PLCFxDesc
     const BYTE* pMemPos;// wo liegen die Sprm(s)
     long nOrigSprmsLen;
 
-    long nStartPos;
-    long nEndPos;
+    WW8_CP nStartPos;
+    WW8_CP nEndPos;
 
     long nOrigStartPos;
     long nOrigEndPos;   // The ending character position of a paragraph is
@@ -836,8 +836,8 @@ struct WW8PLCFxDesc
                         // it can be used as the beginning cp of the next set
                         // of properties
 
-    long nCp2OrIdx;     // wo liegen die NoSprm(s)
-    long nSprmsLen;     // wie viele Bytes fuer weitere Sprms / Laenge Fussnote
+    WW8_CP nCp2OrIdx;     // wo liegen die NoSprm(s)
+    WW8_CP nSprmsLen;     // wie viele Bytes fuer weitere Sprms / Laenge Fussnote
     long nCpOfs;        // fuer Offset Header .. Footnote
     bool bFirstSprm;    // fuer Erkennung erster Sprm einer Gruppe
     bool bRealLineEnd;  // false bei Pap-Piece-Ende
@@ -897,7 +897,7 @@ public:
         Where fragt, an welcher naechsten Position sich irgendein
         Attr aendert...
     */
-    long Where() const;
+    WW8_FC Where() const;
 
     bool Get(WW8PLCFManResult* pResult) const;
     WW8PLCFMan& operator ++( int );
Index: sw/source/filter/xml/swxml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/swxml.cxx,v
retrieving revision 1.60
retrieving revision 1.60.8.1
diff -u -p -u -p -r1.60 -r1.60.8.1
--- sw/source/filter/xml/swxml.cxx	11 Jan 2005 12:37:05 -0000	1.60
+++ sw/source/filter/xml/swxml.cxx	21 Jan 2005 17:04:29 -0000	1.60.8.1
@@ -447,7 +447,7 @@ sal_Int32 ReadThroughComponent(
     }
 }
 
-sal_uInt32 XMLReader::Read( SwDoc &rDoc, const String& rBaseURL, SwPaM &rPaM, const String & rName )
+ULONG XMLReader::Read( SwDoc &rDoc, const String& rBaseURL, SwPaM &rPaM, const String & rName )
 {
 	// Get service factory
 	Reference< lang::XMultiServiceFactory > xServiceFactory =
Index: sw/source/filter/xml/wrtxml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/wrtxml.cxx,v
retrieving revision 1.48
retrieving revision 1.48.8.1
diff -u -p -u -p -r1.48 -r1.48.8.1
--- sw/source/filter/xml/wrtxml.cxx	11 Jan 2005 12:37:19 -0000	1.48
+++ sw/source/filter/xml/wrtxml.cxx	21 Jan 2005 17:04:49 -0000	1.48.8.1
@@ -167,7 +167,7 @@ __EXPORT SwXMLWriter::~SwXMLWriter()
 }
 
 
-sal_uInt32 SwXMLWriter::_Write( SfxMedium* pTargetMedium )
+ULONG SwXMLWriter::_Write( SfxMedium* pTargetMedium )
 {
 	DBG_ASSERT( pTargetMedium, "No medium is provided!" );
 	// Get service factory
@@ -545,16 +545,16 @@ sal_uInt32 SwXMLWriter::_Write()
 	return 0;
 }
 
-sal_uInt32 SwXMLWriter::WriteStorage()
+ULONG SwXMLWriter::WriteStorage()
 {
 	return _Write();
 }
 
-sal_uInt32 SwXMLWriter::WriteMedium( SfxMedium& aTargetMedium )
+ULONG SwXMLWriter::WriteMedium( SfxMedium& aTargetMedium )
 {
 	return _Write( &aTargetMedium );
 }
 
-sal_uInt32 SwXMLWriter::Write( SwPaM& rPaM, SfxMedium& rMed,
+ULONG SwXMLWriter::Write( SwPaM& rPaM, SfxMedium& rMed,
 							   const String* pFileName )
 {
 	return IsStgWriter()
Index: sw/source/filter/xml/wrtxml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/wrtxml.hxx,v
retrieving revision 1.8
retrieving revision 1.8.8.1
diff -u -p -u -p -r1.8 -r1.8.8.1
--- sw/source/filter/xml/wrtxml.hxx	11 Jan 2005 12:37:33 -0000	1.8
+++ sw/source/filter/xml/wrtxml.hxx	21 Jan 2005 17:05:05 -0000	1.8.8.1
@@ -81,11 +81,11 @@ namespace com { namespace sun { namespac
 
 class SwXMLWriter : public StgWriter
 {
-	sal_uInt32 _Write( SfxMedium* pTargetMedium = NULL );
+	ULONG _Write( SfxMedium* pTargetMedium = NULL );
 
 protected:
-	virtual sal_uInt32 WriteStorage();
-	virtual sal_uInt32 WriteMedium( SfxMedium& aTargetMedium );
+	virtual ULONG WriteStorage();
+	virtual ULONG WriteMedium( SfxMedium& aTargetMedium );
 
 public:
 
Index: sw/source/filter/xml/xmlimp.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlimp.cxx,v
retrieving revision 1.86
retrieving revision 1.86.98.1
diff -u -p -u -p -r1.86 -r1.86.98.1
--- sw/source/filter/xml/xmlimp.cxx	26 Nov 2004 13:30:12 -0000	1.86
+++ sw/source/filter/xml/xmlimp.cxx	21 Jan 2005 17:05:15 -0000	1.86.98.1
@@ -843,7 +843,7 @@ void SwXMLImport::endDocument( void )
 		if( !pPos->nContent.GetIndex() )
 		{
 			SwTxtNode* pCurrNd;
-			sal_uInt32 nNodeIdx = pPos->nNode.GetIndex();
+			ULONG nNodeIdx = pPos->nNode.GetIndex();
 			pDoc = pPaM->GetDoc();
 
 			DBG_ASSERT( pPos->nNode.GetNode().IsCntntNode(),
Index: sw/source/filter/xml/xmlimpit.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlimpit.cxx,v
retrieving revision 1.12
retrieving revision 1.10.62.3
diff -u -p -u -p -r1.12 -r1.10.62.3
--- sw/source/filter/xml/xmlimpit.cxx	9 Nov 2004 12:34:35 -0000	1.12
+++ sw/source/filter/xml/xmlimpit.cxx	18 Jan 2005 16:54:58 -0000	1.10.62.3
@@ -798,7 +798,7 @@ sal_Bool SvXMLImportItemMapper::PutXMLVa
                         }
                         else if( -1 != aToken.indexOf( sal_Unicode('%') ) )
                         {
-                            long nPrc = 50;
+                            sal_Int32 nPrc = 50;
                             if( rUnitConverter.convertPercent( nPrc, aToken ) )
                             {
                                 if( !bHori )
Index: sw/source/filter/xml/xmlithlp.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlithlp.cxx,v
retrieving revision 1.1
retrieving revision 1.1.766.1
diff -u -p -u -p -r1.1 -r1.1.766.1
--- sw/source/filter/xml/xmlithlp.cxx	9 Jul 2001 20:10:43 -0000	1.1
+++ sw/source/filter/xml/xmlithlp.cxx	9 Sep 2004 09:53:11 -0000	1.1.766.1
@@ -224,7 +224,7 @@ sal_Bool lcl_frmitems_parseXMLBorder( co
     rWidth = 0;
     rNamedWidth = USHRT_MAX;
 
-    long nTemp;
+    sal_Int32 nTemp;
     while( aTokens.getNextToken( aToken ) && aToken.getLength() != 0 )
     {
         if( !rHasWidth &&
Index: sw/source/filter/xml/xmltble.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmltble.cxx,v
retrieving revision 1.31
retrieving revision 1.31.98.1
diff -u -p -u -p -r1.31 -r1.31.98.1
--- sw/source/filter/xml/xmltble.cxx	26 Nov 2004 13:30:27 -0000	1.31
+++ sw/source/filter/xml/xmltble.cxx	21 Jan 2005 17:05:24 -0000	1.31.98.1
@@ -746,7 +746,7 @@ void SwXMLExport::ExportTableLinesAutoSt
 				pColumn->SetWidthOpt( (sal_uInt16)nColAbsWidth, sal_False );
 			}
 
-			sal_uInt32 nExpPos = 0;
+			ULONG nExpPos = 0;
 			if( rExpCols.Seek_Entry( pColumn, &nExpPos ) )
 			{
 				pColumn->SetStyleName(
Index: sw/source/filter/xml/xmltexti.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmltexti.cxx,v
retrieving revision 1.40
retrieving revision 1.33.304.4
diff -u -p -u -p -r1.40 -r1.33.304.4
--- sw/source/filter/xml/xmltexti.cxx	25 Feb 2005 09:28:02 -0000	1.40
+++ sw/source/filter/xml/xmltexti.cxx	10 Mar 2005 02:02:32 -0000	1.33.304.4
@@ -216,7 +216,7 @@ const XMLServiceMapEntry_Impl aServiceMa
 };
 static void lcl_putHeightAndWidth ( SfxItemSet &rItemSet,
 		sal_Int32 nHeight, sal_Int32 nWidth,
-		sal_Int32 *pTwipHeight=0, sal_Int32 *pTwipWidth=0 )
+		long *pTwipHeight=0, long *pTwipWidth=0 )
 {
 	if( nWidth > 0 && nHeight > 0 )
 	{
Index: sw/source/ui/app/docsh2.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/app/docsh2.cxx,v
retrieving revision 1.74
retrieving revision 1.64.62.5
diff -u -p -u -p -r1.74 -r1.64.62.5
--- sw/source/ui/app/docsh2.cxx	22 Feb 2005 08:23:34 -0000	1.74
+++ sw/source/ui/app/docsh2.cxx	10 Mar 2005 01:26:00 -0000	1.64.62.5
@@ -1173,9 +1173,9 @@ void SwDocShell::Execute(SfxRequest& rRe
 								if ( aLockBytes.Stat( &aStat, SVSTATFLAG_DEFAULT ) == ERRCODE_NONE )
 								{
 									sal_uInt32 nLen = aStat.nSize;
-									ULONG nRead = 0;
+									sal_Size nRead = 0;
 									com::sun::star::uno::Sequence< sal_Int8 > aSeq( nLen );
-									aLockBytes.ReadAt( 0, aSeq.getArray(), nLen, &nRead );
+									aLockBytes.ReadAt( 0UL, aSeq.getArray(), nLen, &nRead );
 
 						        	::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue > aArgs(1);
 									aArgs[0].Name = ::rtl::OUString::createFromAscii("RtfOutline");
@@ -1244,7 +1244,7 @@ void SwDocShell::Execute(SfxRequest& rRe
 								if ( aLockBytes.Stat( &aStat, SVSTATFLAG_DEFAULT ) == ERRCODE_NONE )
 								{
 									sal_uInt32 nLen = aStat.nSize;
-									ULONG nRead = 0;
+									sal_Size nRead = 0;
 									com::sun::star::uno::Sequence< sal_Int8 > aSeq( nLen );
 									aLockBytes.ReadAt( 0, aSeq.getArray(), nLen, &nRead );
 
Index: sw/source/ui/shells/tabsh.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/shells/tabsh.cxx,v
retrieving revision 1.33
retrieving revision 1.33.124.1
diff -u -p -u -p -r1.33 -r1.33.124.1
--- sw/source/ui/shells/tabsh.cxx	9 Nov 2004 16:24:06 -0000	1.33
+++ sw/source/ui/shells/tabsh.cxx	21 Jan 2005 17:06:12 -0000	1.33.124.1
@@ -906,7 +906,7 @@ void SwTableShell::Execute(SfxRequest &r
 
 					if( pItem && 0 != ((SvxNumberInfoItem*)pItem)->GetDelCount() )
 					{
-						const ULONG* pDelArr = ((SvxNumberInfoItem*)
+						const sal_uInt32* pDelArr = ((SvxNumberInfoItem*)
 														pItem)->GetDelArray();
 
 						for ( USHORT i = 0; i < ((SvxNumberInfoItem*)pItem)->GetDelCount(); i++ )
Index: sw/source/ui/uiview/viewstat.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/uiview/viewstat.cxx,v
retrieving revision 1.32
retrieving revision 1.32.96.1
diff -u -p -u -p -r1.32 -r1.32.96.1
--- sw/source/ui/uiview/viewstat.cxx	26 Nov 2004 20:00:01 -0000	1.32
+++ sw/source/ui/uiview/viewstat.cxx	21 Jan 2005 17:06:38 -0000	1.32.96.1
@@ -615,7 +615,7 @@ void SwView::GetDrawState(SfxItemSet &rS
 	Beschreibung:
  --------------------------------------------------------------------*/
 
-sal_Bool SwView::HasUIFeature( sal_uInt32 nFeature )
+sal_Bool SwView::HasUIFeature( ULONG nFeature )
 {
     sal_Bool bRet = sal_False;
     switch(nFeature)
Index: sw/source/ui/utlui/content.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/utlui/content.cxx,v
retrieving revision 1.34
retrieving revision 1.34.76.1
diff -u -p -u -p -r1.34 -r1.34.76.1
--- sw/source/ui/utlui/content.cxx	8 Sep 2004 15:04:57 -0000	1.34
+++ sw/source/ui/utlui/content.cxx	21 Jan 2005 17:06:56 -0000	1.34.76.1
@@ -2327,7 +2327,7 @@ DragDropMode SwContentTree::NotifyStartD
 
 
 sal_Bool  SwContentTree::NotifyMoving( SvLBoxEntry*  pTarget,
-		SvLBoxEntry*  pEntry, SvLBoxEntry*& , sal_uInt32& )
+		SvLBoxEntry*  pEntry, SvLBoxEntry*& , ULONG& )
 {
 	if(!bDocChgdInDragging)
 	{
@@ -2367,7 +2367,7 @@ sal_Bool  SwContentTree::NotifyMoving( S
 
 
 sal_Bool  SwContentTree::NotifyCopying( SvLBoxEntry*  pTarget,
-		SvLBoxEntry*  pEntry, SvLBoxEntry*& , sal_uInt32& )
+		SvLBoxEntry*  pEntry, SvLBoxEntry*& , ULONG& )
 {
 	if(!bDocChgdInDragging)
 	{
Index: tools/bootstrp/command.cxx
===================================================================
RCS file: /cvs/util/tools/bootstrp/command.cxx,v
retrieving revision 1.8
retrieving revision 1.8.178.1
diff -u -p -u -p -r1.8 -r1.8.178.1
--- tools/bootstrp/command.cxx	28 Apr 2003 17:20:08 -0000	1.8
+++ tools/bootstrp/command.cxx	6 Oct 2004 11:42:55 -0000	1.8.178.1
@@ -59,10 +59,6 @@
  *
  ************************************************************************/
 
-#ifdef SCO
-#define _IOSTREAM_H
-#endif
-
 #ifdef PRECOMPILED
 #include "first.hxx"
 #endif
@@ -84,7 +80,7 @@
 
 //#define MH_TEST2	1			// fuers direkte Testen
 
-#if defined (DOS) || defined (WNT) || defined (WIN) || defined(OS2)
+#if defined (WNT)
 #include <process.h>    // for _SPAWN
 #endif
 #ifdef UNX
@@ -98,30 +94,20 @@
 #endif
 #define P_WAIT 1 		// erstmal einen dummz
 #endif
-#ifdef MAC
-#define P_WAIT 1 		// erstmal einen dummz
-#endif
 #ifdef WTC
 #define _spawnv spawnv
 #endif
 
-#ifdef OS2
-#include <svpm.h>
-#define _spawnv spawnv
-#endif
-#if defined (WIN) || defined (WNT)
+#if defined (WNT)
 #include <svwin.h>
 #endif
 
-#if defined( WNT ) || defined ( OS2 ) || defined ( WIN ) || defined (DOS )
+#if defined( WNT )
 #define  	cPathSeperator ';'
 #endif
 #ifdef UNX
 #define	 	cPathSeperator	':'
 #endif
-#ifdef MAC
-#define	 	cPathSeperator	','
-#endif
 
 /*****************************************************************************/
 CommandLine::CommandLine(BOOL bWrite)
@@ -471,15 +457,8 @@ CCommand::operator const int()
 {
 	int nRet;
 #ifndef UNX
-#if defined( WNT ) || defined( DOS ) || defined( WIN )
+#if defined( WNT )
 	nRet = _spawnv( P_WAIT, ppArgv[0], (const char **) ppArgv );
-#else
-#if defined( UNX ) || defined( OS2 )
-	nRet = _spawnv( P_WAIT, ppArgv[0], ppArgv );
-#endif
-#ifdef MAC
-//Mac-Implem.
-#endif
 #endif
 #else
 #ifdef UNX
@@ -505,14 +484,8 @@ CCommand::operator const int()
 	}
 #endif
 
-#ifdef MAC
-//Mac_impl
-=======
 #endif
 
-#endif
-
-#ifndef MAC
 	switch ( errno )
 	{
 		case	E2BIG :
@@ -533,7 +506,6 @@ CCommand::operator const int()
 		default:
 				nError = COMMAND_UNKNOWN;
 	}
-#endif
 
 	if ( nRet )
 		fprintf( stderr, "Program returned with errros\n");
Index: tools/inc/bigint.hxx
===================================================================
RCS file: /cvs/util/tools/inc/bigint.hxx,v
retrieving revision 1.3
retrieving revision 1.3.4.1
diff -u -p -u -p -r1.3 -r1.3.4.1
--- tools/inc/bigint.hxx	17 Jun 2004 13:08:56 -0000	1.3
+++ tools/inc/bigint.hxx	21 Jan 2005 17:22:40 -0000	1.3.4.1
@@ -112,8 +112,10 @@ public:
     operator        int()   const;
     operator        double() const;
     operator        USHORT() const;
+#if SAL_TYPE_SIZEOFLONG == 8
     operator        ULONG() const;
-
+#endif
+    operator        sal_uInt32() const;
     void            Set( sal_Bool bSet ) { bIsSet = bSet; }
     ByteString      GetByteString() const;
     UniString       GetString() const;
Index: tools/inc/date.hxx
===================================================================
RCS file: /cvs/util/tools/inc/date.hxx,v
retrieving revision 1.2
retrieving revision 1.2.108.1
diff -u -p -u -p -r1.2 -r1.2.108.1
--- tools/inc/date.hxx	4 Sep 2003 07:44:38 -0000	1.2
+++ tools/inc/date.hxx	21 Jan 2005 17:23:54 -0000	1.2.108.1
@@ -86,21 +86,21 @@ enum DayOfWeek { MONDAY, TUESDAY, WEDNES
 class Date
 {
 private:
-	ULONG			nDate;
+	sal_uInt32		nDate;
 
 public:
 					Date();
 					Date( const ResId & rResId );
-					Date( ULONG _nDate ) { Date::nDate = _nDate; }
+					Date( sal_uInt32 _nDate ) { Date::nDate = _nDate; }
 					Date( const Date& rDate )
 						{ nDate = rDate.nDate; }
 					Date( USHORT nDay, USHORT nMonth, USHORT nYear )
-						{ nDate = ((ULONG)(nDay%100)) +
-								  (((ULONG)(nMonth%100))*100) +
-								  (((ULONG)nYear%10000)*10000); }
+						{ nDate = ((sal_uInt32)(nDay%100)) +
+								  (((sal_uInt32)(nMonth%100))*100) +
+								  (((sal_uInt32)nYear%10000)*10000); }
 
-	void			SetDate( ULONG nNewDate ) { nDate = nNewDate; }
-	ULONG			GetDate() const { return nDate; }
+	void			SetDate( sal_uInt32 nNewDate ) { nDate = nNewDate; }
+	sal_uInt32		GetDate() const { return nDate; }
 
 	void			SetDay( USHORT nNewDay );
 	void			SetMonth( USHORT nNewMonth );
Index: tools/inc/fsys.hxx
===================================================================
RCS file: /cvs/util/tools/inc/fsys.hxx,v
retrieving revision 1.6
retrieving revision 1.6.98.1
diff -u -p -u -p -r1.6 -r1.6.98.1
--- tools/inc/fsys.hxx	20 Oct 2003 15:39:20 -0000	1.6
+++ tools/inc/fsys.hxx	10 Sep 2004 13:46:10 -0000	1.6.98.1
@@ -81,6 +81,8 @@
 #include <errcode.hxx>
 #endif
 
+#include <stdarg.h>
+
 #define FEAT_FSYS_DOUBLESPEED
 
 // --------------
Index: tools/inc/solar.h
===================================================================
RCS file: /cvs/util/tools/inc/solar.h,v
retrieving revision 1.39
retrieving revision 1.36.4.4
diff -u -p -u -p -r1.39 -r1.36.4.4
--- tools/inc/solar.h	18 Jan 2005 14:51:52 -0000	1.39
+++ tools/inc/solar.h	10 Mar 2005 02:04:10 -0000	1.36.4.4
@@ -299,8 +299,12 @@ inline USHORT	Min( USHORT a, USHORT b )	
 inline USHORT	Max( USHORT a, USHORT b )	{ return (a>b?a:b); }
 inline long 	Min( long a, long b )		{ return (a<b?a:b); }
 inline long 	Max( long a, long b )		{ return (a>b?a:b); }
+#if SAL_TYPES_SIZEOFLONG == 8
 inline ULONG	Min( ULONG a, ULONG b ) 	{ return (a<b?a:b); }
 inline ULONG	Max( ULONG a, ULONG b ) 	{ return (a>b?a:b); }
+#endif 
+inline sal_uInt32	Min( sal_uInt32 a, sal_uInt32 b ) 	{ return (a<b?a:b); }
+inline sal_uInt32	Max( sal_uInt32 a, sal_uInt32 b ) 	{ return (a>b?a:b); }
 
 inline char 	Abs( char a )				{ return (a>=0?a:-a); }
 inline int		Abs( int a )				{ return (a>=0?a:-a); }
Index: tools/inc/stream.hxx
===================================================================
RCS file: /cvs/util/tools/inc/stream.hxx,v
retrieving revision 1.7
retrieving revision 1.6.4.4
diff -u -p -u -p -r1.7 -r1.6.4.4
--- tools/inc/stream.hxx	11 Oct 2004 12:27:17 -0000	1.7
+++ tools/inc/stream.hxx	18 Jan 2005 10:50:48 -0000	1.6.4.4
@@ -78,6 +78,8 @@
 #include <rtti.hxx>
 #endif
 
+#include <limits>
+
 class StreamData;
 
 // ------------------------
@@ -92,6 +94,30 @@ inline rtl_TextEncoding GetStoreCharSet(
 		return eEncoding;
 }
 
+// ------------------
+// - 64-bit helpers -
+// ------------------
+
+// The only reason these inlines exist is to make conversion
+// to full 64-bit stream APIs easier later on.  If all places
+// that make direct use of the stream APIs use these inlines
+// to convert back to 32-bit numbers, we should
+// just be able to grep the code for places that depend on
+// 32-bit interaction with SvStream.
+
+inline sal_uInt32 svstream_Size_to_u32( sal_Size n )
+{
+	OSL_ENSURE((sal_uInt32)n <= ::std::numeric_limits< sal_uInt32 >::max(),
+		"svstream_Size_to_u32(): WARNING! truncation will during cast from 64-bit to 32-bit.");
+	return (sal_uInt32) n;
+}
+
+inline sal_Size svstream_u32_to_Size( sal_uInt32 n )
+{
+	return (sal_Size) n;
+}
+
+
 // ---------------
 // - StreamTypes -
 // ---------------
@@ -398,6 +424,9 @@ public:
 	SvStream&		operator>>( sal_uInt16& rUInt16 );
 	SvStream&		operator>>( sal_uInt32& rUInt32 );
 	SvStream&		operator>>( long& rLong );
+#if SAL_TYPES_SIZEOFLONG == 8
+	SvStream&		operator>>( sal_Size& rSize );
+#endif
 	SvStream&		operator>>( short& rShort );
 	SvStream&		operator>>( int& rInt );
 	SvStream&		operator>>( signed char& rChar );
@@ -416,6 +445,9 @@ public:
 	SvStream&		operator<<( sal_uInt16 nUInt16 );
 	SvStream&		operator<<( sal_uInt32 nUInt32 );
 	SvStream&		operator<<( long nLong );
+#if SAL_TYPES_SIZEOFLONG == 8
+	SvStream&		operator<<( sal_Size nSize );
+#endif
 	SvStream&		operator<<( short nShort );
 	SvStream&		operator<<( int nInt );
 	SvStream&		operator<<( signed char nChar );
Index: tools/source/debug/debug.cxx
===================================================================
RCS file: /cvs/util/tools/source/debug/debug.cxx,v
retrieving revision 1.7
retrieving revision 1.7.120.3
diff -u -p -u -p -r1.7 -r1.7.120.3
--- tools/source/debug/debug.cxx	7 Aug 2003 11:57:20 -0000	1.7
+++ tools/source/debug/debug.cxx	10 Sep 2004 13:42:45 -0000	1.7.120.3
@@ -71,6 +71,7 @@
 
 #include <time.h>
 #include <cstdarg>  // combinations
+#include <stdarg.h> // some platforms need cstdarg, other stdarg.h
 #include <stdlib.h>
 #include <string.h>
 #include <stdio.h>
Index: tools/source/ref/pstm.cxx
===================================================================
RCS file: /cvs/util/tools/source/ref/pstm.cxx,v
retrieving revision 1.3
retrieving revision 1.3.64.2
diff -u -p -u -p -r1.3 -r1.3.64.2
--- tools/source/ref/pstm.cxx	26 Feb 2004 13:21:01 -0000	1.3
+++ tools/source/ref/pstm.cxx	21 Jan 2005 17:24:22 -0000	1.3.64.2
@@ -113,12 +113,12 @@ void SvPersistBaseMemberList::WriteObjec
 	rStm << bTmp;
 #endif
 	UINT32 nCount = Count();
-	ULONG  nCountPos = rStm.Tell();
+	sal_Size  nCountPos = rStm.Tell();
 	UINT32 nWriteCount = 0;
 	rStm << nCount;
 	//bloss die Liste nicht veraendern,
 	//wegen Seiteneffekten beim Save
-	for( ULONG n = 0; n < nCount; n++ )
+	for( UINT32 n = 0; n < nCount; n++ )
 	{
 		SvPersistBase * pObj = GetObject( n );
 		if( !bOnlyStreamed || rStm.IsStreamed( pObj ) )
@@ -130,7 +130,7 @@ void SvPersistBaseMemberList::WriteObjec
 	if( nWriteCount != nCount )
 	{
 		// nicht alle Objekte geschrieben, Count anpassen
-		ULONG nPos = rStm.Tell();
+		sal_Size nPos = rStm.Tell();
 		rStm.Seek( nCountPos );
 		rStm << nWriteCount;
 		rStm.Seek( nPos );
@@ -169,9 +169,9 @@ SvPersistStream& operator >> ( SvPersist
 	if( nVer & PERSIST_LIST_DBGUTIL )
 		nObjLen = rStm.ReadLen( &nObjPos );
 
-	ULONG nCount;
+	UINT32 nCount;
 	rStm >> nCount;
-	for( ULONG n = 0; n < nCount && rStm.GetError() == SVSTREAM_OK; n++ )
+	for( UINT32 n = 0; n < nCount && rStm.GetError() == SVSTREAM_OK; n++ )
 	{
 		SvPersistBase * pObj;
 		rStm >> pObj;
@@ -341,7 +341,7 @@ void SvPersistStream::ResetError()
 /*************************************************************************
 |*	  SvPersistStream::GetData()
 *************************************************************************/
-ULONG SvPersistStream::GetData( void* pData, ULONG nSize )
+sal_Size SvPersistStream::GetData( void* pData, sal_Size nSize )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Read( pData, nSize );
@@ -352,7 +352,7 @@ ULONG SvPersistStream::GetData( void* pD
 /*************************************************************************
 |*	  SvPersistStream::PutData()
 *************************************************************************/
-ULONG SvPersistStream::PutData( const void* pData, ULONG nSize )
+sal_Size SvPersistStream::PutData( const void* pData, sal_Size nSize )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Write( pData, nSize );
@@ -363,7 +363,7 @@ ULONG SvPersistStream::PutData( const vo
 /*************************************************************************
 |*	  SvPersistStream::Seek()
 *************************************************************************/
-ULONG SvPersistStream::SeekPos( ULONG nPos )
+sal_Size SvPersistStream::SeekPos( sal_Size nPos )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Seek( nPos );
Index: tools/source/stream/stream.cxx
===================================================================
RCS file: /cvs/util/tools/source/stream/stream.cxx,v
retrieving revision 1.18
retrieving revision 1.16.4.5
diff -u -p -u -p -r1.18 -r1.16.4.5
--- tools/source/stream/stream.cxx	11 Oct 2004 12:27:31 -0000	1.18
+++ tools/source/stream/stream.cxx	18 Jan 2005 10:53:14 -0000	1.16.4.5
@@ -120,6 +120,10 @@ inline static void SwapLong( long& r )
     {   r = SWAPLONG(r);   }
 inline static void SwapULong( sal_uInt32& r )
     {   r = SWAPLONG(r);   }
+#if SAL_TYPES_SIZEOFLONG == 8
+inline static void SwapSize( sal_Size& r )
+    {   r = SWAPLONG(r);   }
+#endif
 inline static void SwapLongInt( int& r )
     {   r = SWAPLONG(r);   }
 inline static void SwapLongUInt( unsigned int& r )
@@ -178,7 +182,7 @@ int tmp = eIOMode; \
 if( (tmp == STREAM_IO_READ) && sizeof(datatype)<=nBufFree) \
 {\
     for (int i = 0; i < sizeof(datatype); i++)\
-        ((char *)&r)[i] = pBufPos[i];\
+        ((char *)&value)[i] = pBufPos[i];\
     nBufActualPos += sizeof(datatype);\
     pBufPos += sizeof(datatype);\
     nBufFree -= sizeof(datatype);\
@@ -1235,6 +1239,7 @@ SvStream& SvStream::operator>> ( sal_uIn
     return *this;
 }
 
+
 SvStream& SvStream::operator >> ( long& r )
 {
 #if(SAL_TYPES_SIZEOFLONG != 4)
@@ -1251,6 +1256,29 @@ SvStream& SvStream::operator >> ( long& 
     return *this;
 }
 
+#if SAL_TYPES_SIZEOFLONG == 8
+SvStream& SvStream::operator >> ( sal_Size& r )
+{
+
+    DBG_ASSERT( FALSE, "SvStream operator >> sal_Size not yet implemented!\n" );
+/*
+#if(SAL_TYPES_SIZEOFLONG != 4)
+    int tmp = r;
+    READNUMBER_WITHOUT_SWAP(sal_Size,tmp)
+    r = tmp;
+    if( bSwap )
+        SwapLong(r);
+#else
+    READNUMBER_WITHOUT_SWAP(long,r)
+    if( bSwap )
+        SwapLong(r);
+#endif
+*/
+    return *this;
+}
+
+#endif // SAL_TYPES_SIZEOFLONG == 8
+
 SvStream& SvStream::operator >> ( short& r )
 {
     READNUMBER_WITHOUT_SWAP(short,r)
@@ -1392,6 +1420,24 @@ SvStream& SvStream::operator<< ( long v 
     return *this;
 }
 
+#if(SAL_TYPES_SIZEOFLONG == 8)
+SvStream& SvStream::operator<< ( sal_Size v )
+{
+#if(SAL_TYPES_SIZEOFLONG != 4)
+    int tmp = v;
+    if( bSwap )
+        SwapInt(tmp);
+    WRITENUMBER_WITHOUT_SWAP(int,tmp)
+#else
+    if( bSwap )
+        SwapSize(v);
+    WRITENUMBER_WITHOUT_SWAP(long,v)
+#endif
+    return *this;
+}
+
+#endif
+
 SvStream& SvStream::operator<<  ( short v )
 {
     if( bSwap )
--- registry/tools/regcompare.cxx	31 Jan 2005 15:48:37 -0000	1.19
+++ registry/tools/regcompare.cxx	9 Mar 2005 20:21:53 -0000	1.18.8.2
@@ -473,25 +483,25 @@ static sal_Char* getTypeClass(RTTypeClas
 	switch (typeClass)
 	{
 		case RT_TYPE_INTERFACE:
-			return "INTERFACE";
+			return (sal_Char*)"INTERFACE";
 		case RT_TYPE_MODULE:
-			return "MODULE";
+			return (sal_Char*)"MODULE";
 		case RT_TYPE_STRUCT:
-			return "STRUCT";
+			return (sal_Char*)"STRUCT";
 		case RT_TYPE_ENUM:
-			return "ENUM";
+			return (sal_Char*)"ENUM";
 		case RT_TYPE_EXCEPTION:
-			return "EXCEPTION";
+			return (sal_Char*)"EXCEPTION";
 		case RT_TYPE_TYPEDEF:
-			return "TYPEDEF";
+			return (sal_Char*)"TYPEDEF";
 		case RT_TYPE_SERVICE:
-			return "SERVICE";
+			return (sal_Char*)"SERVICE";
 		case RT_TYPE_OBJECT:
-			return "OBJECT";
+			return (sal_Char*)"OBJECT";
 		case RT_TYPE_CONSTANTS:
-			return "CONSTANTS";
+			return (sal_Char*)"CONSTANTS";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 }	
 
 static OString getFieldAccess(RTFieldAccess fieldAccess)
@@ -561,29 +571,29 @@ static sal_Char* getConstValueType(RTCon
 	switch (constValue.m_type)
 	{
 		case RT_TYPE_BOOL:
-			return "sal_Bool";
+			return (sal_Char*)"sal_Bool";
 		case RT_TYPE_BYTE:
-			return "sal_uInt8";
+			return (sal_Char*)"sal_uInt8";
 		case RT_TYPE_INT16:
-			return "sal_Int16";
+			return (sal_Char*)"sal_Int16";
 		case RT_TYPE_UINT16:
-			return "sal_uInt16";
+			return (sal_Char*)"sal_uInt16";
 		case RT_TYPE_INT32:
-			return "sal_Int32";
+			return (sal_Char*)"sal_Int32";
 		case RT_TYPE_UINT32:
-			return "sal_uInt32";
+			return (sal_Char*)"sal_uInt32";
 //		case RT_TYPE_INT64:
-//			return "sal_Int64";
+//			return (sal_Char*)"sal_Int64";
 //		case RT_TYPE_UINT64:
-//			return "sal_uInt64";
+//			return (sal_Char*)"sal_uInt64";
 		case RT_TYPE_FLOAT:
-			return "float";
+			return (sal_Char*)"float";
 		case RT_TYPE_DOUBLE:
-			return "double";
+			return (sal_Char*)"double";
 		case RT_TYPE_STRING:
-			return "sal_Unicode*";
+			return (sal_Char*)"sal_Unicode*";
 	}	
-	return "NONE";
+	return (sal_Char*)"NONE";
 }	
 static void printConstValue(RTConstValue& constValue)
 {
@@ -912,15 +922,15 @@ static sal_Char* getMethodMode(RTMethodM
 	switch ( methodMode )
 	{
 		case RT_MODE_ONEWAY:
-			return "ONEWAY";
+			return (sal_Char*)"ONEWAY";
 		case RT_MODE_ONEWAY_CONST:
-			return "ONEWAY,CONST";
+			return (sal_Char*)"ONEWAY,CONST";
 		case RT_MODE_TWOWAY:
-			return "NONE";
+			return (sal_Char*)"NONE";
 		case RT_MODE_TWOWAY_CONST:
-			return "CONST";
+			return (sal_Char*)"CONST";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 } 
 
 static sal_Char* getParamMode(RTParamMode paramMode)
@@ -928,13 +938,13 @@ static sal_Char* getParamMode(RTParamMod
 	switch ( paramMode )
 	{
 		case RT_PARAM_IN:
-			return "IN";
+			return (sal_Char*)"IN";
 		case RT_PARAM_OUT:
-			return "OUT";
+			return (sal_Char*)"OUT";
 		case RT_PARAM_INOUT:
-			return "INOUT";
+			return (sal_Char*)"INOUT";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 } 
 
 static sal_uInt32 checkMethod(const OUString& keyName,
@@ -1155,15 +1165,15 @@ static sal_Char* getReferenceType(RTRefe
 	switch (refType)
 	{
 		case RT_REF_SUPPORTS:
-			return "RT_REF_SUPPORTS";
+			return (sal_Char*)"RT_REF_SUPPORTS";
 		case RT_REF_OBSERVES:
-			return "RT_REF_OBSERVES";
+			return (sal_Char*)"RT_REF_OBSERVES";
 		case RT_REF_EXPORTS:
-			return "RT_REF_EXPORTS";
+			return (sal_Char*)"RT_REF_EXPORTS";
 		case RT_REF_NEEDS:
-			return "RT_REF_NEEDS";
+			return (sal_Char*)"RT_REF_NEEDS";
 	}
-	return "RT_REF_INVALID";
+	return (sal_Char*)"RT_REF_INVALID";
 }
 
 static sal_uInt32 checkReference(const OUString& keyName,
Index: rdbmaker/source/codemaker/global.cxx
===================================================================
RCS file: /cvs/udk/rdbmaker/source/codemaker/global.cxx,v
retrieving revision 1.9
retrieving revision 1.9.66.1
diff -u -p -u -p -r1.9 -r1.9.66.1
--- rdbmaker/source/codemaker/global.cxx	26 Mar 2003 14:28:43 -0000	1.9
+++ rdbmaker/source/codemaker/global.cxx	27 Aug 2004 14:21:41 -0000	1.9.66.1
@@ -75,6 +75,7 @@
 #include    <osl/file.hxx>
 #endif
 
+#include <string.h>
 #include <stdlib.h>
 #include <stdio.h>
 #if defined(SAL_W32) || defined(SAL_OS2)
@@ -287,8 +288,8 @@ sal_Bool checkFileContent(const OString&
 		sal_Bool 	bFindChanges = sal_False;
 		sal_Char 	buffer1[1024+1];
 		sal_Char 	buffer2[1024+1];
-		sal_Int32 	n1 = 0;
-		sal_Int32 	n2 = 0;
+		size_t 	    n1 = 0;
+		size_t 	    n2 = 0;
 
 		while ( !bFindChanges && !feof(target) && !feof(tmp))
 		{
@@ -420,8 +421,8 @@ void FileStream::close()
 
 sal_Int32 FileStream::getSize()
 {
-    sal_Int32 pos = 0;
-    sal_Int32 size = 0;
+    long pos = 0;
+    long size = 0;
     if ( isValid() )
     {
         fflush(m_pFile);
@@ -430,7 +431,7 @@ sal_Int32 FileStream::getSize()
             size = ftell(m_pFile);
         fseek(m_pFile, pos, SEEK_SET);
     }
-    return size;
+    return sal_Int32(size);
 }
 
 const sal_Char* FileStream::checkAccessMode(FileAccessMode mode)
Index: xmloff/source/style/XMLFontAutoStylePool.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/XMLFontAutoStylePool.cxx,v
retrieving revision 1.4
retrieving revision 1.4.86.1
diff -u -p -u -p -r1.4 -r1.4.86.1
--- xmloff/source/style/XMLFontAutoStylePool.cxx	13 Jul 2004 08:22:31 -0000	1.4
+++ xmloff/source/style/XMLFontAutoStylePool.cxx	21 Jan 2005 15:12:55 -0000	1.4.86.1
@@ -221,7 +221,7 @@ OUString XMLFontAutoStylePool::Add(
 	OUString sName;
 	XMLFontAutoStylePoolEntry_Impl aTmp( rFamilyName, rStyleName, nFamily,
 									 	 nPitch, eEnc );
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( pPool->Seek_Entry( &aTmp, &nPos ) )
 	{
 		sName = pPool->GetObject( nPos )->GetName();
@@ -275,7 +275,7 @@ OUString XMLFontAutoStylePool::Add(
 	OUString sName;
 	XMLFontAutoStylePoolEntry_Impl aTmp( rFamilyName, rStyleName, nFamily,
 									 	 nPitch, eEnc );
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( pPool->Seek_Entry( &aTmp, &nPos ) )
 	{
 		sName = pPool->GetObject( nPos )->GetName();
@@ -291,6 +291,7 @@ void XMLFontAutoStylePool::exportXML()
 							  XML_FONT_FACE_DECLS,
 							  sal_True, sal_True );
 	Any aAny;
+
 	OUString sTmp;
 	XMLFontFamilyNamePropHdl aFamilyNameHdl;
 	XMLFontFamilyPropHdl aFamilyHdl;
Index: xmloff/source/style/impastp4.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/impastp4.cxx,v
retrieving revision 1.14
retrieving revision 1.12.162.4
diff -u -p -u -p -r1.14 -r1.12.162.4
--- xmloff/source/style/impastp4.cxx	5 Jan 2005 11:36:18 -0000	1.14
+++ xmloff/source/style/impastp4.cxx	21 Jan 2005 15:12:40 -0000	1.12.162.4
@@ -135,7 +135,7 @@ void SvXMLAutoStylePoolP_Impl::AddFamily
 		sal_Bool bAsFamily )
 {
 	// store family in a list if not already stored
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl *pFamily = new XMLFamilyData_Impl( nFamily, rStrName, rMapper, rStrPrefix, bAsFamily );
 	if( !maFamilyList.Seek_Entry( pFamily, &nPos ) )
 		maFamilyList.Insert( pFamily );
@@ -152,7 +152,7 @@ void SvXMLAutoStylePoolP_Impl::RegisterN
 {
 	SvXMLAutoStylePoolNamesP_Impl *pNames = 0;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
 		pNames = maFamilyList.GetObject( nPos )->mpNameList;
@@ -222,7 +222,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
 				sal_Bool bCache)
 {
 	sal_Bool bRet(sal_False);
-	sal_uInt32 nPos;
+	ULONG nPos;
 
 	XMLFamilyData_Impl *pFamily = 0;
 	XMLFamilyData_Impl aTmp( nFamily );
@@ -270,7 +270,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
 OUString SvXMLAutoStylePoolP_Impl::AddToCache( sal_Int32 nFamily,
 							 		    const OUString& rParent )
 {
-	sal_uInt32 nPos;
+	ULONG nPos;
 
 	XMLFamilyData_Impl *pFamily = 0;
 	XMLFamilyData_Impl aTmp( nFamily );
@@ -302,7 +302,7 @@ OUString SvXMLAutoStylePoolP_Impl::Find(
 {
 	OUString sName;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
@@ -329,7 +329,7 @@ OUString SvXMLAutoStylePoolP_Impl::FindA
 {
 	OUString sName;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
@@ -371,7 +371,7 @@ void SvXMLAutoStylePoolP_Impl::exportXML
 	sal_uInt32 nCount = 0;
 
 	// Get list of parents for current family (nFamily)
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
Index: xmloff/source/style/xmlstyle.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/xmlstyle.cxx,v
retrieving revision 1.35
retrieving revision 1.32.130.4
diff -u -p -u -p -r1.35 -r1.32.130.4
--- xmloff/source/style/xmlstyle.cxx	26 Nov 2004 13:04:53 -0000	1.35
+++ xmloff/source/style/xmlstyle.cxx	21 Jan 2005 15:13:36 -0000	1.32.130.4
@@ -475,7 +475,7 @@ const SvXMLStyleContext *SvXMLStylesCont
 	if( pIndices )
 	{
 		SvXMLStyleIndex_Impl aIndex( nFamily, rName );
-		sal_uInt32 nPos = 0;
+		ULONG nPos = 0;
 		if( pIndices->Seek_Entry( &aIndex, &nPos ) )
 			pStyle = pIndices->GetObject( nPos )->GetStyle();
 	}
Index: xmloff/source/text/XMLTextListAutoStylePool.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/text/XMLTextListAutoStylePool.cxx,v
retrieving revision 1.4
retrieving revision 1.4.242.1
diff -u -p -u -p -r1.4 -r1.4.242.1
--- xmloff/source/text/XMLTextListAutoStylePool.cxx	8 Apr 2003 15:30:28 -0000	1.4
+++ xmloff/source/text/XMLTextListAutoStylePool.cxx	21 Jan 2005 15:13:50 -0000	1.4.242.1
@@ -251,7 +251,7 @@ sal_Bool XMLTextListAutoStylePool::HasNa
 
 sal_uInt32 XMLTextListAutoStylePool::Find( XMLTextListAutoStylePoolEntry_Impl* pEntry ) const
 {
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( !pEntry->IsNamed() && mxNumRuleCompare.is() )
 	{
 		const sal_uInt32 nCount = pPool->Count();
Index: svtools/inc/calendar.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/calendar.hxx,v
retrieving revision 1.2
retrieving revision 1.1.1.1.650.2
diff -u -p -u -p -r1.2 -r1.1.1.1.650.2
--- svtools/inc/calendar.hxx	28 Jun 2004 17:06:00 -0000	1.2
+++ svtools/inc/calendar.hxx	19 Oct 2004 16:31:48 -0000	1.1.1.1.650.2
@@ -222,7 +222,7 @@ private:
 	Rectangle		maPrevRect;
 	Rectangle		maNextRect;
 	String			maDayOfWeekText;
-	long			mnDayOfWeekAry[7];
+	sal_Int32		mnDayOfWeekAry[7];
 	Date			maOldFormatFirstDate;
 	Date			maOldFormatLastDate;
 	Date			maFirstDate;
Index: svtools/inc/filerec.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/filerec.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/inc/filerec.hxx	18 Sep 2000 16:58:50 -0000	1.1.1.1
+++ svtools/inc/filerec.hxx	21 Jul 2004 17:34:07 -0000	1.1.1.1.650.1
@@ -72,24 +72,24 @@
 
 #include <tools/stream.hxx>
 
-SV_DECL_VARARR( SfxUINT32s, UINT32, 8, 8 );
+SV_DECL_VARARR( SfxUINT32s, sal_uInt32, 8, 8 );
 
 //------------------------------------------------------------------------
 
-#define SFX_BOOL_DONTCARE				BOOL(2) 	// Don't-Care-Wert f"ur BOOLs
+#define SFX_BOOL_DONTCARE				sal_Bool(2) 	// Don't-Care-Wert f"ur BOOLs
 
-#define SFX_REC_PRETAG_EXT				BYTE(0x00)	// Pre-Tag f"ur Extended-Records
-#define SFX_REC_PRETAG_EOR				BYTE(0xFF)	// Pre-Tag f"ur End-Of-Records
+#define SFX_REC_PRETAG_EXT				sal_uInt8(0x00)	// Pre-Tag f"ur Extended-Records
+#define SFX_REC_PRETAG_EOR				sal_uInt8(0xFF)	// Pre-Tag f"ur End-Of-Records
 
-#define SFX_REC_TYPE_NONE				BYTE(0x00)	// unbekannter Record-Typ
-#define SFX_REC_TYPE_FIRST				BYTE(0x01)
-#define SFX_REC_TYPE_SINGLE 			BYTE(0x01)	// Single-Content-Record
-#define SFX_REC_TYPE_FIXSIZE			BYTE(0x02)	// Fix-Size-Multi-Content-Record
-#define SFX_REC_TYPE_VARSIZE_RELOC      BYTE(0x03)	// variable Rec-Size
-#define SFX_REC_TYPE_VARSIZE            BYTE(0x04)	// alt (nicht verschiebbar)
-#define SFX_REC_TYPE_MIXTAGS_RELOC  	BYTE(0x07)	// Mixed Tag Content-Record
-#define SFX_REC_TYPE_MIXTAGS			BYTE(0x08)	// alt (nicht verschiebbar)
-#define SFX_REC_TYPE_LAST				BYTE(0x08)
+#define SFX_REC_TYPE_NONE				sal_uInt8(0x00)	// unbekannter Record-Typ
+#define SFX_REC_TYPE_FIRST				sal_uInt8(0x01)
+#define SFX_REC_TYPE_SINGLE 			sal_uInt8(0x01)	// Single-Content-Record
+#define SFX_REC_TYPE_FIXSIZE			sal_uInt8(0x02)	// Fix-Size-Multi-Content-Record
+#define SFX_REC_TYPE_VARSIZE_RELOC      sal_uInt8(0x03)	// variable Rec-Size
+#define SFX_REC_TYPE_VARSIZE            sal_uInt8(0x04)	// alt (nicht verschiebbar)
+#define SFX_REC_TYPE_MIXTAGS_RELOC  	sal_uInt8(0x07)	// Mixed Tag Content-Record
+#define SFX_REC_TYPE_MIXTAGS			sal_uInt8(0x08)	// alt (nicht verschiebbar)
+#define SFX_REC_TYPE_LAST				sal_uInt8(0x08)
 #define SFX_REC_TYPE_MINI					0x100	// Mini-Record
 #define SFX_REC_TYPE_DRAWENG				0x400	// Drawing-Engine-Record
 #define SFX_REC_TYPE_EOR					0xF00	// End-Of-Records
@@ -263,18 +263,18 @@ class SfxMiniRecordWriter
 {
 protected:
 	SvStream*		_pStream;	//	<SvStream>, in dem der Record liegt
-	UINT32			_nStartPos; //	Start-Position des Gesamt-Records im Stream
+	sal_uInt32	_nStartPos; //	Start-Position des Gesamt-Records im Stream
 	FASTBOOL		_bHeaderOk; /*	TRUE, wenn der Header schon geschrieben ist;
 									bei DBG_UTIL wird SFX_BOOL_DONTCARE ver-
 									wendet, um die Gr"o\se von Fix-Sized-Records
 									zu pr"ufen. */
-	BYTE			_nPreTag;	//	in den Header zu schreibendes 'Pre-Tag'
+	sal_uInt8			_nPreTag;	//	in den Header zu schreibendes 'Pre-Tag'
 
 public:
 	inline			SfxMiniRecordWriter( SvStream *pStream,
-										 BYTE nTag );
-	inline			SfxMiniRecordWriter( SvStream *pStream, BYTE nTag,
-										 UINT32 nSize );
+										 sal_uInt8 nTag );
+	inline			SfxMiniRecordWriter( SvStream *pStream, sal_uInt8 nTag,
+										 sal_uInt32 nSize );
 
 	inline			~SfxMiniRecordWriter();
 
@@ -282,7 +282,7 @@ public:
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 
 private:
 					// not implementend, not allowed
@@ -322,35 +322,35 @@ class SfxMiniRecordReader
 {
 protected:
 	SvStream*			_pStream;	//	<SvStream>, aus dem gelesen wird
-	UINT32				_nEofRec;	//	Position direkt hinter dem Record
+	sal_uInt32		_nEofRec;	//	Position direkt hinter dem Record
 	FASTBOOL			_bSkipped;	//	TRUE: der Record wurde explizit geskippt
-	BYTE				_nPreTag;	//	aus dem Header gelesenes Pre-Tag
+	sal_uInt8			_nPreTag;	//	aus dem Header gelesenes Pre-Tag
 
 						// Drei-Phasen-Ctor f"ur Subklassen
 						SfxMiniRecordReader() {}
-   void 				Construct_Impl( SvStream *pStream, BYTE nTag )
+   void 				Construct_Impl( SvStream *pStream, sal_uInt8 nTag )
 						{
 							_pStream = pStream;
 							_bSkipped = FALSE;
 							_nPreTag = nTag;
 						}
-	inline FASTBOOL 	SetHeader_Impl( UINT32 nHeader );
+	inline FASTBOOL 	SetHeader_Impl( sal_uInt32 nHeader );
 
 						// als ung"ultig markieren und zur"uck-seeken
-	void				SetInvalid_Impl( UINT32 nRecordStartPos )
+	void				SetInvalid_Impl( sal_uInt32 nRecordStartPos )
 						{
 							_nPreTag = SFX_REC_PRETAG_EOR;
 							_pStream->Seek( nRecordStartPos );
 						}
 
 public:
-	static USHORT   	ScanRecordType( SvStream *pStream );
+	static sal_uInt16   	ScanRecordType( SvStream *pStream );
 
 						SfxMiniRecordReader( SvStream *pStream );
-						SfxMiniRecordReader( SvStream *pStream, BYTE nTag );
+						SfxMiniRecordReader( SvStream *pStream, sal_uInt8 nTag );
 	inline				~SfxMiniRecordReader();
 
-	inline BYTE 		GetTag() const;
+	inline sal_uInt8 		GetTag() const;
 	inline FASTBOOL 	IsValid() const;
 
 	inline SvStream&	operator*() const;
@@ -405,20 +405,20 @@ class SfxSingleRecordWriter: public SfxM
 
 {
 protected:
-					SfxSingleRecordWriter( BYTE nRecordType,
+					SfxSingleRecordWriter( sal_uInt8 nRecordType,
 										   SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer );
 
 public:
 					SfxSingleRecordWriter( SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer );
 					SfxSingleRecordWriter( SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer,
-										   UINT32 nSize );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer,
+										   sal_uInt32 nSize );
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -454,9 +454,9 @@ class SfxSingleRecordReader: public SfxM
 
 {
 protected:
-	UINT16				_nRecordTag;	// Art des Gesamt-Inhalts
-	BYTE				_nRecordVer;	// Version des Gesamt-Inhalts
-	BYTE				_nRecordType;	// Record Type aus dem Header
+	sal_uInt16		_nRecordTag;	// Art des Gesamt-Inhalts
+	sal_uInt8			_nRecordVer;	// Version des Gesamt-Inhalts
+	sal_uInt8			_nRecordType;	// Record Type aus dem Header
 
 						// Drei-Phasen-Ctor f"ur Subklassen
 						SfxSingleRecordReader() {}
@@ -465,17 +465,17 @@ protected:
 							SfxMiniRecordReader::Construct_Impl(
 									pStream, SFX_REC_PRETAG_EXT );
 						}
-	FASTBOOL			FindHeader_Impl( UINT16 nTypes, UINT16 nTag );
-	FASTBOOL            ReadHeader_Impl( USHORT nTypes );
+	FASTBOOL			FindHeader_Impl( sal_uInt16 nTypes, sal_uInt16 nTag );
+	FASTBOOL            ReadHeader_Impl( sal_uInt16 nTypes );
 
 public:
 						SfxSingleRecordReader( SvStream *pStream );
-						SfxSingleRecordReader( SvStream *pStream, USHORT nTag );
+						SfxSingleRecordReader( SvStream *pStream, sal_uInt16 nTag );
 
-	inline UINT16		GetTag() const;
+	inline sal_uInt16		GetTag() const;
 
-	inline BYTE 		GetVersion() const;
-	inline FASTBOOL 	HasVersion( USHORT nVersion ) const;
+	inline sal_uInt8 		GetVersion() const;
+	inline FASTBOOL 	HasVersion( sal_uInt16 nVersion ) const;
 };
 
 //------------------------------------------------------------------------
@@ -520,7 +520,7 @@ class SfxMultiFixRecordWriter: public Sf
 
 	{
 		SfxMultiFixRecordWriter aRecord( pStream, MY_TAG_X, MY_VERSION );
-		for ( USHORT n = 0; n < Count(); ++n )
+		for ( sal_uInt16 n = 0; n < Count(); ++n )
 		{
 			aRecord.NewContent();
 			*aRecord << aMember1[n];
@@ -531,28 +531,28 @@ class SfxMultiFixRecordWriter: public Sf
 
 {
 protected:
-	UINT32			_nContentStartPos;	/*	Startposition des jeweiligen
+	sal_uInt32			_nContentStartPos;	/*	Startposition des jeweiligen
 											Contents - nur bei DBG_UTIL
 											und f"ur Subklassen */
-	UINT32			_nContentSize;		//	Gr"o\se jedes Contents
-	UINT16			_nContentCount; 	//	jeweilige Anzahl der Contents
+	sal_uInt32			_nContentSize;		//	Gr"o\se jedes Contents
+	sal_uInt16			_nContentCount; 	//	jeweilige Anzahl der Contents
 
-					SfxMultiFixRecordWriter( BYTE nRecordType,
+					SfxMultiFixRecordWriter( sal_uInt8 nRecordType,
 											 SvStream *pStream,
-											 UINT16 nTag, BYTE nCurVer,
-											 UINT32 nContentSize );
+											 sal_uInt16 nTag, sal_uInt8 nCurVer,
+											 sal_uInt32 nContentSize );
 
 public:
 					SfxMultiFixRecordWriter( SvStream *pStream,
-											 UINT16 nTag, BYTE nCurVer,
-											 UINT32 nContentSize );
+											 sal_uInt16 nTag, sal_uInt8 nCurVer,
+											 sal_uInt32 nContentSize );
 	inline			~SfxMultiFixRecordWriter();
 
 	inline void 	NewContent();
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -596,7 +596,7 @@ class SfxMultiVarRecordWriter: public Sf
 
 	{
 		SfxMultiVarRecordWriter aRecord( pStream, MY_TAG_X, MY_VERSION );
-		for ( USHORT n = 0; n < Count(); ++n )
+		for ( sal_uInt16 n = 0; n < Count(); ++n )
 		{
 			aRecord.NewContent();
 			*aRecord << aMember1[n];
@@ -608,24 +608,24 @@ class SfxMultiVarRecordWriter: public Sf
 {
 protected:
 	SfxUINT32s  		_aContentOfs;
-	USHORT              _nContentVer;   // nur f"ur SfxMultiMixRecordWriter
+	sal_uInt16              _nContentVer;   // nur f"ur SfxMultiMixRecordWriter
 
-						SfxMultiVarRecordWriter( BYTE nRecordType,
+						SfxMultiVarRecordWriter( sal_uInt8 nRecordType,
 												 SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 
 	void                FlushContent_Impl();
 
 public:
 						SfxMultiVarRecordWriter( SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 						~SfxMultiVarRecordWriter();
 
 	void				NewContent();
 
-	virtual UINT32		Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	virtual sal_uInt32		Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -668,10 +668,10 @@ class SfxMultiMixRecordWriter: public Sf
 {
 public:
 	inline				SfxMultiMixRecordWriter( SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 
-	void				NewContent( USHORT nTag, BYTE nVersion );
+	void				NewContent( sal_uInt16 nTag, sal_uInt8 nVersion );
 
 // private: geht nicht, da einige Compiler dann auch vorherige privat machen
 	void                NewContent()
@@ -697,7 +697,7 @@ class SfxMultiRecordReader: public SfxSi
 
 	{
 		SfxMultiRecordReader aRecord( pStream );
-		for ( USHORT nRecNo = 0; aRecord.GetContent(); ++nRecNo )
+		for ( sal_uInt16 nRecNo = 0; aRecord.GetContent(); ++nRecNo )
 		{
 			switch ( aRecord.GetTag() )
 			{
@@ -716,30 +716,30 @@ class SfxMultiRecordReader: public SfxSi
 */
 
 {
-	UINT32				_nStartPos;		//	Start-Position des Records
-	UINT32* 			_pContentOfs;	//	Offsets der Startpositionen
-	UINT32				_nContentSize;	//	Size jedes einzelnen / Tabellen-Pos
-	UINT16				_nContentCount; //	Anzahl der Contents im Record
-	UINT16				_nContentNo;	/*	der Index des aktuellen Contents
+	sal_uInt32				_nStartPos;		//	Start-Position des Records
+	sal_uInt32* 			_pContentOfs;	//	Offsets der Startpositionen
+	sal_uInt32				_nContentSize;	//	Size jedes einzelnen / Tabellen-Pos
+	sal_uInt16				_nContentCount; //	Anzahl der Contents im Record
+	sal_uInt16				_nContentNo;	/*	der Index des aktuellen Contents
 											enth"alt jeweils den Index des
 											Contents, der beim n"achsten
 											GetContent() geholt wird */
-	UINT16				_nContentTag;	//	Art-Kennung des aktuellen Contents
-	BYTE				_nContentVer;	//	Versions-Kennung des akt. Contents
+	sal_uInt16				_nContentTag;	//	Art-Kennung des aktuellen Contents
+	sal_uInt8				_nContentVer;	//	Versions-Kennung des akt. Contents
 
 	FASTBOOL			ReadHeader_Impl();
 
 public:
 						SfxMultiRecordReader( SvStream *pStream );
-						SfxMultiRecordReader( SvStream *pStream, UINT16 nTag );
+						SfxMultiRecordReader( SvStream *pStream, sal_uInt16 nTag );
 						~SfxMultiRecordReader();
 
 	FASTBOOL			GetContent();
-	inline UINT16		GetContentTag();
-	inline BYTE 		GetContentVersion() const;
-	inline FASTBOOL 	HasContentVersion( USHORT nVersion ) const;
+	inline sal_uInt16		GetContentTag();
+	inline sal_uInt8 		GetContentVersion() const;
+	inline FASTBOOL 	HasContentVersion( sal_uInt16 nVersion ) const;
 
-	inline UINT32		ContentCount() const;
+	inline sal_uInt32		ContentCount() const;
 };
 
 //=========================================================================
@@ -747,7 +747,7 @@ public:
 inline SfxMiniRecordWriter::SfxMiniRecordWriter
 (
 	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	BYTE            nTag            // Record-Tag zwischen 0x01 und 0xFE
+	sal_uInt8            nTag            // Record-Tag zwischen 0x01 und 0xFE
 )
 
 /*  [Beschreibung]
@@ -773,8 +773,8 @@ inline SfxMiniRecordWriter::SfxMiniRecor
 inline SfxMiniRecordWriter::SfxMiniRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	BYTE			nTag,			// Record-Tag zwischen 0x01 und 0xFE
-	UINT32			nSize			// Gr"o\se der Daten in Bytes
+	sal_uInt8			nTag,			// Record-Tag zwischen 0x01 und 0xFE
+	sal_uInt32			nSize			// Gr"o\se der Daten in Bytes
 )
 
 /*	[Beschreibung]
@@ -869,7 +869,7 @@ inline void SfxMiniRecordReader::Skip()
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxMiniRecordReader::GetTag() const
+inline sal_uInt8 SfxMiniRecordReader::GetTag() const
 
 /*	[Beschreibung]
 
@@ -916,18 +916,18 @@ inline SvStream& SfxMiniRecordReader::op
 
 //=========================================================================
 
-inline UINT32 SfxSingleRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+inline sal_uInt32 SfxSingleRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 //	siehe <SfxMiniRecordWriter::Close(FASTBOOL)>
 
 {
-	UINT32 nRet = 0;
+	sal_uInt32 nRet = 0;
 
 	// wurde der Header noch nicht geschrieben?
 	if ( !_bHeaderOk )
 	{
 		// Basisklassen-Header schreiben
-		UINT32 nEndPos = SfxMiniRecordWriter::Close( bSeekToEndOfRec );
+		sal_uInt32 nEndPos = SfxMiniRecordWriter::Close( bSeekToEndOfRec );
 
 		// ggf. ans Ende des eigenen Headers seeken oder hinter Rec bleiben
 		if ( !bSeekToEndOfRec )
@@ -956,7 +956,7 @@ inline void	SfxSingleRecordWriter::Reset
 
 //=========================================================================
 
-inline UINT16 SfxSingleRecordReader::GetTag() const
+inline sal_uInt16 SfxSingleRecordReader::GetTag() const
 
 /*  [Beschreibung]
 
@@ -969,7 +969,7 @@ inline UINT16 SfxSingleRecordReader::Get
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxSingleRecordReader::GetVersion() const
+inline sal_uInt8 SfxSingleRecordReader::GetVersion() const
 
 /*	[Beschreibung]
 
@@ -982,7 +982,7 @@ inline BYTE SfxSingleRecordReader::GetVe
 
 //-------------------------------------------------------------------------
 
-inline FASTBOOL SfxSingleRecordReader::HasVersion( USHORT nVersion ) const
+inline FASTBOOL SfxSingleRecordReader::HasVersion( sal_uInt16 nVersion ) const
 
 /*	[Beschreibung]
 
@@ -1048,8 +1048,8 @@ inline void SfxMultiFixRecordWriter::New
 inline SfxMultiMixRecordWriter::SfxMultiMixRecordWriter
 (
 	SvStream*		pStream,	// Stream, in dem der Record angelegt wird
-	USHORT			nRecordTag, // Gesamt-Record-Art-Kennung
-	BYTE			nRecordVer	// Gesamt-Record-Versions-Kennung
+	sal_uInt16			nRecordTag, // Gesamt-Record-Art-Kennung
+	sal_uInt8			nRecordVer	// Gesamt-Record-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -1076,7 +1076,7 @@ inline void	SfxMultiFixRecordWriter::Res
 
 //=========================================================================
 
-inline UINT16 SfxMultiRecordReader::GetContentTag()
+inline sal_uInt16 SfxMultiRecordReader::GetContentTag()
 
 /*	[Beschreibung]
 
@@ -1090,7 +1090,7 @@ inline UINT16 SfxMultiRecordReader::GetC
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxMultiRecordReader::GetContentVersion() const
+inline sal_uInt8 SfxMultiRecordReader::GetContentVersion() const
 
 /*  [Beschreibung]
 
@@ -1104,7 +1104,7 @@ inline BYTE SfxMultiRecordReader::GetCon
 
 //-------------------------------------------------------------------------
 
-inline FASTBOOL SfxMultiRecordReader::HasContentVersion( USHORT nVersion ) const
+inline FASTBOOL SfxMultiRecordReader::HasContentVersion( sal_uInt16 nVersion ) const
 
 /*  [Beschreibung]
 
@@ -1119,7 +1119,7 @@ inline FASTBOOL SfxMultiRecordReader::Ha
 
 //-------------------------------------------------------------------------
 
-inline UINT32 SfxMultiRecordReader::ContentCount() const
+inline sal_uInt32 SfxMultiRecordReader::ContentCount() const
 
 /*	[Beschreibung]
 
Index: svtools/inc/flbytes.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/flbytes.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/inc/flbytes.hxx	18 Sep 2000 16:58:50 -0000	1.1.1.1
+++ svtools/inc/flbytes.hxx	21 Jul 2004 17:34:07 -0000	1.1.1.1.650.1
@@ -73,7 +73,7 @@
 class SvFillLockBytes : public SvLockBytes
 {
 	SvLockBytesRef xLockBytes;
-	ULONG nFilledSize;
+	sal_Size nFilledSize;
 	BOOL bTerminated;
 	BOOL bSync;
 public:
@@ -81,17 +81,17 @@ public:
 
 	SvFillLockBytes( SvLockBytes* pLockBytes );
 	virtual ErrCode ReadAt(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const;
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const;
 	virtual ErrCode WriteAt(
-		ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten );
+		sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten );
 	virtual ErrCode Flush() const;
-	virtual ErrCode SetSize( ULONG nSize );
-	virtual ErrCode LockRegion( ULONG nPos, ULONG nCount, LockType );
-	virtual ErrCode UnlockRegion( ULONG nPos, ULONG nCount, LockType );
+	virtual ErrCode SetSize( sal_Size nSize );
+	virtual ErrCode LockRegion( sal_Size nPos, sal_Size nCount, LockType );
+	virtual ErrCode UnlockRegion( sal_Size nPos, sal_Size nCount, LockType );
 	virtual ErrCode Stat( SvLockBytesStat*, SvLockBytesStatFlag ) const;
-	ErrCode FillAppend( const void* pBuffer, ULONG nCount, ULONG *pWritten );
-	ULONG   Tell() const { return nFilledSize; }
-	void    Seek( ULONG nPos ) { nFilledSize = nPos; }
+	ErrCode FillAppend( const void* pBuffer, sal_Size nCount, sal_Size *pWritten );
+	sal_Size   Tell() const { return nFilledSize; }
+	void    Seek( sal_Size nPos ) { nFilledSize = nPos; }
 
 	void Terminate();
 };
@@ -133,34 +133,34 @@ public:
 	virtual BOOL IsSynchronMode() const
 	{ return m_xAsyncLockBytes->IsSynchronMode(); }
 
-	virtual ErrCode ReadAt(ULONG nPos, void * pBuffer, ULONG nCount,
-						   ULONG * pRead) const;
+	virtual ErrCode ReadAt(sal_Size nPos, void * pBuffer, sal_Size nCount,
+						   sal_Size * pRead) const;
 
-	virtual ErrCode WriteAt(ULONG nPos, const void * pBuffer, ULONG nCount,
-							ULONG * pWritten);
+	virtual ErrCode WriteAt(sal_Size nPos, const void * pBuffer, sal_Size nCount,
+							sal_Size * pWritten);
 
 	virtual ErrCode Flush() const { return m_xAsyncLockBytes->Flush(); }
 
-	virtual ErrCode SetSize(ULONG nSize)
+	virtual ErrCode SetSize(sal_Size nSize)
 	{ return m_xAsyncLockBytes->SetSize(nSize); }
 
-	virtual ErrCode LockRegion(ULONG nPos, ULONG nCount, LockType eType)
+	virtual ErrCode LockRegion(sal_Size nPos, sal_Size nCount, LockType eType)
 	{ return m_xAsyncLockBytes->LockRegion(nPos, nCount, eType); }
 
-	virtual ErrCode UnlockRegion(ULONG nPos, ULONG nCount, LockType eType)
+	virtual ErrCode UnlockRegion(sal_Size nPos, sal_Size nCount, LockType eType)
 	{ return m_xAsyncLockBytes->UnlockRegion(nPos, nCount, eType); }
 
 	virtual ErrCode Stat(SvLockBytesStat * pStat, SvLockBytesStatFlag eFlag)
 		const
 	{ return m_xAsyncLockBytes->Stat(pStat, eFlag); }
 
-	virtual ErrCode FillAppend(const void * pBuffer, ULONG nCount,
-							   ULONG * pWritten)
+	virtual ErrCode FillAppend(const void * pBuffer, sal_Size nCount,
+							   sal_Size * pWritten)
 	{ return m_xAsyncLockBytes->FillAppend(pBuffer, nCount, pWritten); }
 
-	virtual ULONG Tell() const { return m_xAsyncLockBytes->Tell(); }
+	virtual sal_Size Tell() const { return m_xAsyncLockBytes->Tell(); }
 
-	virtual ULONG Seek(ULONG nPos)
+	virtual sal_Size Seek(sal_Size nPos)
 	{ return m_xAsyncLockBytes->Seek(nPos); }
 
 	virtual void Terminate() { m_xAsyncLockBytes->Terminate(); }
@@ -187,19 +187,19 @@ public:
 	SvCompositeLockBytes( );
 	~SvCompositeLockBytes();
 
-	void Append( SvLockBytes* pLockBytes, ULONG nPos, ULONG nOffset );
-	ULONG RelativeOffset( ULONG nPos ) const;
+	void Append( SvLockBytes* pLockBytes, sal_Size nPos, sal_Size nOffset );
+	sal_Size RelativeOffset( sal_Size nPos ) const;
 	void  SetIsPending( BOOL bSet );
 	SvLockBytes*    GetLastLockBytes() const;
 
 	virtual ErrCode ReadAt(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const;
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const;
 	virtual ErrCode WriteAt(
-		ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten );
+		sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten );
 	virtual ErrCode Flush() const;
-	virtual ErrCode SetSize( ULONG nSize );
-	virtual ErrCode LockRegion( ULONG nPos, ULONG nCount, LockType );
-	virtual ErrCode UnlockRegion( ULONG nPos, ULONG nCount, LockType );
+	virtual ErrCode SetSize( sal_Size nSize );
+	virtual ErrCode LockRegion( sal_Size nPos, sal_Size nCount, LockType );
+	virtual ErrCode UnlockRegion( sal_Size nPos, sal_Size nCount, LockType );
 	virtual ErrCode Stat( SvLockBytesStat*, SvLockBytesStatFlag ) const;
 };
 
Index: svtools/inc/itempool.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/itempool.hxx,v
retrieving revision 1.3
retrieving revision 1.3.464.1
diff -u -p -u -p -r1.3 -r1.3.464.1
--- svtools/inc/itempool.hxx	27 Mar 2003 14:36:20 -0000	1.3
+++ svtools/inc/itempool.hxx	21 Jan 2005 17:19:38 -0000	1.3.464.1
@@ -164,9 +164,9 @@ public:
 	//---------------------------------------------------------------------
 
 protected:
-	static inline void				SetRefCount( SfxPoolItem& rItem, ULONG n );
-	static inline ULONG				AddRef( const SfxPoolItem& rItem, ULONG n = 1 );
-	static inline ULONG				ReleaseRef( const SfxPoolItem& rItem, ULONG n = 1);
+	static inline void				SetRefCount( SfxPoolItem& rItem, sal_uInt32 n );
+	static inline sal_uInt32				AddRef( const SfxPoolItem& rItem, sal_uInt32 n = 1 );
+	static inline sal_uInt32				ReleaseRef( const SfxPoolItem& rItem, sal_uInt32 n = 1);
 
 public:
 									SfxItemPool( const SfxItemPool &rPool,
@@ -290,19 +290,19 @@ private:
 // --------------- Inline Implementierungen ------------------------------
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline void SfxItemPool::SetRefCount( SfxPoolItem& rItem, ULONG n )
+inline void SfxItemPool::SetRefCount( SfxPoolItem& rItem, sal_uInt32 n )
 {
 	rItem.SetRefCount(n);
 }
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline ULONG SfxItemPool::AddRef( const SfxPoolItem& rItem, ULONG n )
+inline sal_uInt32 SfxItemPool::AddRef( const SfxPoolItem& rItem, sal_uInt32 n )
 {
 	return rItem.AddRef(n);
 }
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline ULONG SfxItemPool::ReleaseRef( const SfxPoolItem& rItem, ULONG n )
+inline sal_uInt32 SfxItemPool::ReleaseRef( const SfxPoolItem& rItem, sal_uInt32 n )
 {
 	return rItem.ReleaseRef(n);
 }
Index: svtools/inc/roadmap.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/roadmap.hxx,v
retrieving revision 1.5
retrieving revision 1.2.52.3
diff -u -p -u -p -r1.5 -r1.2.52.3
--- svtools/inc/roadmap.hxx	17 Feb 2005 11:14:47 -0000	1.5
+++ svtools/inc/roadmap.hxx	9 Mar 2005 23:06:05 -0000	1.2.52.3
@@ -196,7 +196,7 @@ namespace svt
 
 
     protected:
-        sal_Int32       PreNotify( NotifyEvent& rNEvt );
+        long            PreNotify( NotifyEvent& rNEvt );
 
     protected:
         /// called when an item has been selected by any means
Index: svtools/inc/strmadpt.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/strmadpt.hxx,v
retrieving revision 1.2
retrieving revision 1.2.628.1
diff -u -p -u -p -r1.2 -r1.2.628.1
--- svtools/inc/strmadpt.hxx	28 Sep 2001 13:02:30 -0000	1.2
+++ svtools/inc/strmadpt.hxx	21 Jul 2004 17:34:08 -0000	1.2.628.1
@@ -83,7 +83,7 @@ class SvOutputStreamOpenLockBytes: publi
 {
 	com::sun::star::uno::Reference< com::sun::star::io::XOutputStream >
 	    m_xOutputStream;
-	sal_uInt32 m_nPosition;
+	sal_Size m_nPosition;
 
 public:
 	TYPEINFO();
@@ -94,23 +94,23 @@ public:
 			    rTheOutputStream):
 		m_xOutputStream(rTheOutputStream), m_nPosition(0) {}
 
-	virtual ErrCode ReadAt(ULONG, void *, ULONG, ULONG *) const;
+	virtual ErrCode ReadAt(sal_Size, void *, sal_Size, sal_Size *) const;
 
-	virtual ErrCode WriteAt(ULONG nPos, const void * pBuffer, ULONG nCount,
-							ULONG * pWritten);
+	virtual ErrCode WriteAt(sal_Size nPos, const void * pBuffer, sal_Size nCount,
+							sal_Size * pWritten);
 
 	virtual ErrCode Flush() const;
 
-	virtual ErrCode SetSize(ULONG);
+	virtual ErrCode SetSize(sal_Size);
 
 	virtual ErrCode Stat(SvLockBytesStat * pStat, SvLockBytesStatFlag) const;
 
-	virtual ErrCode FillAppend(const void * pBuffer, ULONG nCount,
-							   ULONG * pWritten);
+	virtual ErrCode FillAppend(const void * pBuffer, sal_Size nCount,
+							   sal_Size * pWritten);
 
-	virtual ULONG Tell() const;
+	virtual sal_Size Tell() const;
 
-	virtual ULONG Seek(ULONG);
+	virtual sal_Size Seek(sal_Size);
 
 	virtual void Terminate();
 };
Index: svtools/source/control/roadmap.cxx
===================================================================
RCS file: /cvs/util/svtools/source/control/roadmap.cxx,v
retrieving revision 1.6
retrieving revision 1.2.52.4
diff -u -p -u -p -r1.6 -r1.2.52.4
--- svtools/source/control/roadmap.cxx	17 Feb 2005 11:15:55 -0000	1.6
+++ svtools/source/control/roadmap.cxx	9 Mar 2005 23:09:59 -0000	1.2.52.4
@@ -689,7 +689,7 @@ namespace svt
     }
 
 	//---------------------------------------------------------------------
-    sal_Int32 ORoadmap::PreNotify( NotifyEvent& _rNEvt )
+    long ORoadmap::PreNotify( NotifyEvent& _rNEvt )
     {
         // capture KeyEvents for taskpane cycling
         if ( _rNEvt.GetType() == EVENT_KEYINPUT )
Index: svtools/source/filerec/filerec.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filerec/filerec.cxx,v
retrieving revision 1.4
retrieving revision 1.4.8.1
diff -u -p -u -p -r1.4 -r1.4.8.1
--- svtools/source/filerec/filerec.cxx	17 Jun 2004 13:18:52 -0000	1.4
+++ svtools/source/filerec/filerec.cxx	21 Jul 2004 17:34:10 -0000	1.4.8.1
@@ -68,7 +68,7 @@
 
 //========================================================================
 
-SV_IMPL_VARARR( SfxUINT32s, UINT32 );
+SV_IMPL_VARARR( SfxUINT32s, sal_uInt32 );
 
 //========================================================================
 
@@ -94,21 +94,21 @@ SV_IMPL_VARARR( SfxUINT32s, UINT32 );
 */
 
 #define SFX_REC_MINI_HEADER(nPreTag,nStartPos,nEndPos) \
-					( UINT32(nPreTag) | \
-					  UINT32(nEndPos-nStartPos-SFX_REC_HEADERSIZE_MINI) << 8 )
+					( sal_uInt32(nPreTag) | \
+					  sal_uInt32(nEndPos-nStartPos-SFX_REC_HEADERSIZE_MINI) << 8 )
 
 #define SFX_REC_HEADER(nRecType,nContentTag,nContentVer) \
-					( UINT32(nRecType) | \
-					  ( UINT32(nContentVer) << 8 ) | \
-					  ( UINT32(nContentTag) << 16 ) )
+					( sal_uInt32(nRecType) | \
+					  ( sal_uInt32(nContentVer) << 8 ) | \
+					  ( sal_uInt32(nContentTag) << 16 ) )
 
 #define SFX_REC_CONTENT_HEADER(nContentVer,n1StStartPos,nCurStartPos) \
-					( UINT32(nContentVer) | \
-					  UINT32( nCurStartPos - n1StStartPos ) << 8 )
+					( sal_uInt32(nContentVer) | \
+					  sal_uInt32( nCurStartPos - n1StStartPos ) << 8 )
 
 //=========================================================================
 
-UINT32 SfxMiniRecordWriter::Close
+sal_uInt32 SfxMiniRecordWriter::Close
 (
 	FASTBOOL	bSeekToEndOfRec 	/*	TRUE (default)
 										Der Stream wird an das Ende des Records
@@ -131,7 +131,7 @@ UINT32 SfxMiniRecordWriter::Close
 
 	[R"uckgabewert]
 
-	UINT32		!= 0
+	sal_uInt32	!= 0
 				Position im Stream, die direkt hinter dem Record liegt.
 				'bSeekToEndOfRecord==TRUE'
 				=> R"uckgabewert == aktuelle Stream-Position nach Aufruf
@@ -145,13 +145,13 @@ UINT32 SfxMiniRecordWriter::Close
 	if ( !_bHeaderOk )
 	{
 		// Header an den Anfang des Records schreiben
-		UINT32 nEndPos = _pStream->Tell();
-		_pStream->Seek( _nStartPos );
+		sal_uInt32 nEndPos = svstream_Size_to_u32( _pStream->Tell() );
+		_pStream->Seek( svstream_u32_to_Size(_nStartPos) );
 		*_pStream << SFX_REC_MINI_HEADER( _nPreTag, _nStartPos, nEndPos );
 
 		// je nachdem ans Ende des Records seeken oder hinter Header bleiben
 		if ( bSeekToEndOfRec )
-			_pStream->Seek( nEndPos );
+			_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 
 		// Header wurde JETZT geschrieben
 		_bHeaderOk = TRUE;
@@ -162,14 +162,14 @@ UINT32 SfxMiniRecordWriter::Close
 	else if ( SFX_BOOL_DONTCARE == _bHeaderOk )
 	{
 		// Header auslesen, um Soll-Gr"o\se zu bestimmen
-		UINT32 nEndPos = _pStream->Tell();
-		_pStream->Seek( _nStartPos );
-		ULONG nHeader;
+		sal_uInt32 nEndPos = svstream_Size_to_u32( _pStream->Tell() );
+		_pStream->Seek( svstream_u32_to_Size(_nStartPos) );
+		sal_uInt32 nHeader;
 		*_pStream >> nHeader;
-		_pStream->Seek( nEndPos );
+		_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 
 		// Soll-Gr"o\se mit Ist-Gr"o\se vergleichen
-		DBG_ASSERT( nEndPos - SFX_REC_OFS(nHeader) == _nStartPos + sizeof(UINT32),
+		DBG_ASSERT( nEndPos - SFX_REC_OFS(nHeader) == _nStartPos + sizeof(sal_uInt32),
 					"fixed record size incorrect" );
 		DbgOutf( "SfxFileRec: written record until %ul", nEndPos );
 	}
@@ -211,7 +211,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 	[R"uckgabewert]
 
-	USHORT							SFX_REC_TYPE_EOR
+	sal_uInt16						SFX_REC_TYPE_EOR
 									An der aktuellen Position des Streams
 									steht eine End-Of-Records-Kennung.
 
@@ -256,11 +256,11 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 {
 	// die ersten 4 Bytes als Mini-Header lesen
-	ULONG nHeader;
+	sal_uInt32 nHeader;
 	*pStream >> nHeader;
 
 	// k"onnte es sich um einen extended-Record handeln?
-	USHORT nPreTag = SFX_REC_PRE(nHeader);
+	sal_uInt16 nPreTag = SFX_REC_PRE(nHeader);
 	if ( SFX_REC_PRETAG_EXT == nPreTag )
 	{
 		// die n"achsten 4 Bytes als extended-Header lesen
@@ -270,7 +270,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 		pStream->SeekRel(-8);
 
 		// liegt eine g"ultige Record-Kennung vor?
-		USHORT nType = SFX_REC_TYP(nHeader);
+		sal_uInt16 nType = SFX_REC_TYP(nHeader);
 		if ( nType >= SFX_REC_TYPE_FIRST && nType <= SFX_REC_TYPE_LAST )
 			// entsprechenden extended-Record-Typ zur"uckliefern
 			return nType;
@@ -287,7 +287,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 		return nPreTag;
 
 	// liegt ein Drawin-Engine-Record vor?
-	if ( nHeader == UINT32(*"DRMD") || nHeader == UINT32(*"DRVW") )
+	if ( nHeader == sal_uInt32(*"DRMD") || nHeader == sal_uInt32(*"DRVW") )
 		return SFX_REC_TYPE_DRAWENG;
 
 	// alle anderen sind grunds"atzlich g"ultige Mini-Records
@@ -296,7 +296,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 //-------------------------------------------------------------------------
 
-FASTBOOL SfxMiniRecordReader::SetHeader_Impl( UINT32 nHeader )
+FASTBOOL SfxMiniRecordReader::SetHeader_Impl( sal_uInt32 nHeader )
 
 /*	[Beschreibung]
 
@@ -311,7 +311,7 @@ FASTBOOL SfxMiniRecordReader::SetHeader_
 	FASTBOOL bRet = TRUE;
 
 	// Record-Ende und Pre-Tag aus dem Header ermitteln
-	_nEofRec = _pStream->Tell() + SFX_REC_OFS(nHeader);
+	_nEofRec = svstream_Size_to_u32(_pStream->Tell()) + SFX_REC_OFS(nHeader);
 	_nPreTag = SFX_REC_PRE(nHeader);
 
 	// wenn End-Of-Record-Kennung, dann Fehler
@@ -348,9 +348,9 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	_bSkipped( FALSE )
 {
 	// Header einlesen
-	UINT32 nStartPos = pStream->Tell(); // um im Fehlerfall zur"uck zu-seeken
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() ); // um im Fehlerfall zur"uck zu-seeken
 	DBG( DbgOutf( "SfxFileRec: reading record at %ul", nStartPos ) );
-	UINT32 nHeader;
+	sal_uInt32 nHeader;
 	*pStream >> nHeader;
 
 	// Headerdaten extrahieren
@@ -362,7 +362,7 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	else if ( _nPreTag == SFX_REC_PRETAG_EOR )
 		pStream->SetError( ERRCODE_IO_WRONGFORMAT );
 	if ( !IsValid() )
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 }
 
 //-------------------------------------------------------------------------
@@ -373,7 +373,7 @@ SfxMiniRecordReader::SfxMiniRecordReader
 										Position sich ein <SfxMiniRecord>
 										befindet.
 									*/
-	BYTE			nTag			//	Pre-Tag des gew"unschten Records
+	sal_uInt8		nTag			//	Pre-Tag des gew"unschten Records
 )
 
 /*	[Beschreibung]
@@ -420,14 +420,14 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	}
 
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// passenden Record suchen
 	while(TRUE)
 	{
 		// Header lesen
 		DBG( DbgOutf( "SfxFileRec: searching record at %ul", pStream->Tell() ) );
-		UINT32 nHeader;
+		sal_uInt32 nHeader;
 		*pStream >> nHeader;
 
 		// Headerdaten von Basisklasse extrahieren lassen
@@ -445,12 +445,12 @@ SfxMiniRecordReader::SfxMiniRecordReader
 				break;
 
 			// sonst skippen und weitersuchen
-			pStream->Seek( _nEofRec );
+			pStream->Seek( svstream_u32_to_Size(_nEofRec) );
 			continue;
 		}
 
 		// Fehler => zur"uck-seeken
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 		break;
 	}
 }
@@ -459,10 +459,10 @@ SfxMiniRecordReader::SfxMiniRecordReader
 
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
-	BYTE			nRecordType,	// f"ur Subklassen
+	sal_uInt8		nRecordType,	// f"ur Subklassen
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer 	// Inhalts-Versions-Kennung
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer 	// Inhalts-Versions-Kennung
 )
 
 /*	[Beschreibung]
@@ -481,8 +481,8 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer 	// Inhalts-Versions-Kennung
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer 	// Inhalts-Versions-Kennung
 )
 
 /*	[Beschreibung]
@@ -503,9 +503,9 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer,	// Inhalts-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se des Inhalts in Bytes
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer,	// Inhalts-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se des Inhalts in Bytes
 )
 
 /*  [Beschreibung]
@@ -523,7 +523,7 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 
 //=========================================================================
 
-inline FASTBOOL SfxSingleRecordReader::ReadHeader_Impl( USHORT nTypes )
+inline FASTBOOL SfxSingleRecordReader::ReadHeader_Impl( sal_uInt16 nTypes )
 
 /*  [Beschreibung]
 
@@ -537,7 +537,7 @@ inline FASTBOOL SfxSingleRecordReader::R
 	FASTBOOL bRet;
 
 	// Basisklassen-Header einlesen
-	UINT32 nHeader;
+	sal_uInt32 nHeader;
 	*_pStream >> nHeader;
 	if ( !SetHeader_Impl( nHeader ) )
 		bRet = FALSE;
@@ -561,7 +561,7 @@ SfxSingleRecordReader::SfxSingleRecordRe
 :	SfxMiniRecordReader()
 {
 	// Startposition merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 	DBG( DbgOutf( "SfxFileRec: reading record at %ul", nStartPos ) );
 
 	// Basisklasse initialisieren (nicht via Ctor, da der nur MiniRecs akzept.)
@@ -578,17 +578,17 @@ SfxSingleRecordReader::SfxSingleRecordRe
 
 //-------------------------------------------------------------------------
 
-SfxSingleRecordReader::SfxSingleRecordReader( SvStream *pStream, USHORT nTag )
+SfxSingleRecordReader::SfxSingleRecordReader( SvStream *pStream, sal_uInt16 nTag )
 {
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// richtigen Record suchen, ggf. Error-Code setzen und zur"uck-seeken
 	Construct_Impl( pStream );
 	if ( !FindHeader_Impl( SFX_REC_TYPE_SINGLE, nTag ) )
 	{
 		// Error-Code setzen und zur"uck-seeken
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 		pStream->SetError( ERRCODE_IO_WRONGFORMAT );
 	}
 }
@@ -597,8 +597,8 @@ SfxSingleRecordReader::SfxSingleRecordRe
 
 FASTBOOL SfxSingleRecordReader::FindHeader_Impl
 (
-	UINT16		nTypes, 	// arithm. Veroderung erlaubter Record-Typen
-	UINT16		nTag		// zu findende Record-Art-Kennung
+	sal_uInt16		nTypes, 	// arithm. Veroderung erlaubter Record-Typen
+	sal_uInt16		nTag		// zu findende Record-Art-Kennung
 )
 
 /*	[Beschreibung]
@@ -613,13 +613,13 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 {
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = _pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( _pStream->Tell() );
 
 	// richtigen Record suchen
 	while ( !_pStream->IsEof() )
 	{
 		// Header lesen
-		UINT32 nHeader;
+		sal_uInt32 nHeader;
 		DBG( DbgOutf( "SfxFileRec: searching record at %ul", _pStream->Tell() ) );
 		*_pStream >> nHeader;
 		if ( !SetHeader_Impl( nHeader ) )
@@ -649,12 +649,12 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 		// sonst skippen
 		if ( !_pStream->IsEof() )
-			_pStream->Seek( _nEofRec );
+			_pStream->Seek( svstream_u32_to_Size(_nEofRec) );
 	}
 
 	// Fehler setzen und zur"uck-seeken
 	_pStream->SetError( ERRCODE_IO_WRONGFORMAT );
-	_pStream->Seek( nStartPos );
+	_pStream->Seek( svstream_u32_to_Size(nStartPos) );
 	return FALSE;
 }
 
@@ -662,11 +662,11 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 SfxMultiFixRecordWriter::SfxMultiFixRecordWriter
 (
-	BYTE			nRecordType,	// Subklassen Record-Kennung
+	sal_uInt8		nRecordType,	// Subklassen Record-Kennung
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Content-Art-Kennung
-	BYTE			nContentVer,	// Content-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
+	sal_uInt16	nContentTag,	// Content-Art-Kennung
+	sal_uInt8		nContentVer,	// Content-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
 )
 
 /*  [Beschreibung]
@@ -686,9 +686,9 @@ SfxMultiFixRecordWriter::SfxMultiFixReco
 SfxMultiFixRecordWriter::SfxMultiFixRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Content-Art-Kennung
-	BYTE			nContentVer,	// Content-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
+	sal_uInt16	nContentTag,	// Content-Art-Kennung
+	sal_uInt8		nContentVer,	// Content-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
 )
 
 /*  [Beschreibung]
@@ -707,7 +707,7 @@ SfxMultiFixRecordWriter::SfxMultiFixReco
 
 //------------------------------------------------------------------------
 
-UINT32 SfxMultiFixRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+sal_uInt32 SfxMultiFixRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 //	siehe <SfxMiniRecordWriter>
 
@@ -716,7 +716,7 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 	if ( !_bHeaderOk )
 	{
 		// Position hinter Record merken, um sie restaurieren zu k"onnen
-		UINT32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
+		sal_uInt32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
 
 		// gegen"uber SfxSingleRecord erweiterten Header schreiben
 		*_pStream << _nContentCount;
@@ -724,7 +724,7 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 
 		// je nachdem ans Ende des Records seeken oder hinter Header bleiben
 		if ( bSeekToEndOfRec )
-			_pStream->Seek(nEndPos);
+			_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 		return nEndPos;
 	}
 
@@ -736,10 +736,10 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 
 SfxMultiVarRecordWriter::SfxMultiVarRecordWriter
 (
-	BYTE			nRecordType,	// Record-Kennung der Subklasse
-	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	UINT16			nRecordTag, 	// Gesamt-Art-Kennung
-	BYTE			nRecordVer		// Gesamt-Versions-Kennung
+	sal_uInt8		nRecordType,	// Record-Kennung der Subklasse
+	SvStream*		pStream,        // Stream, in dem der Record angelegt wird
+	sal_uInt16	nRecordTag, 	// Gesamt-Art-Kennung
+	sal_uInt8		nRecordVer		// Gesamt-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -757,8 +757,8 @@ SfxMultiVarRecordWriter::SfxMultiVarReco
 SfxMultiVarRecordWriter::SfxMultiVarRecordWriter
 (
 	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	UINT16			nRecordTag, 	// Gesamt-Art-Kennung
-	BYTE			nRecordVer		// Gesamt-Versions-Kennung
+	sal_uInt16	nRecordTag, 	// Gesamt-Art-Kennung
+	sal_uInt8		nRecordVer		// Gesamt-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -826,13 +826,13 @@ void SfxMultiVarRecordWriter::NewContent
 		FlushContent_Impl();
 
 	// neuen Content beginnen
-	_nContentStartPos = _pStream->Tell();
+	_nContentStartPos = svstream_Size_to_u32( _pStream->Tell() );
 	++_nContentCount;
 }
 
 //-------------------------------------------------------------------------
 
-UINT32 SfxMultiVarRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+sal_uInt32 SfxMultiVarRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 // siehe <SfxMiniRecordWriter>
 
@@ -845,30 +845,30 @@ UINT32 SfxMultiVarRecordWriter::Close( F
 			FlushContent_Impl();
 
 		// Content-Offset-Tabelle schreiben
-		UINT32 nContentOfsPos = _pStream->Tell();
+		sal_uInt32 nContentOfsPos = svstream_Size_to_u32( _pStream->Tell() );
 		//! darf man das so einr"ucken?
 		#if defined(OSL_LITENDIAN)
 			_pStream->Write( _aContentOfs.GetData(),
-							 sizeof(UINT32)*_nContentCount );
+							 svstream_u32_to_Size(sizeof(sal_uInt32)*_nContentCount) );
 		#else
-			for ( USHORT n = 0; n < _nContentCount; ++n )
-				*_pStream << UINT32(_aContentOfs[n]);
+			for ( sal_uInt16 n = 0; n < _nContentCount; ++n )
+				*_pStream << sal_uInt32(_aContentOfs[n]);
 		#endif
 
 		// SfxMultiFixRecordWriter::Close() "uberspringen!
-		UINT32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
+		sal_uInt32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
 
 		// eigenen Header schreiben
 		*_pStream << _nContentCount;
 		if ( SFX_REC_TYPE_VARSIZE_RELOC == _nPreTag ||
 			 SFX_REC_TYPE_MIXTAGS_RELOC == _nPreTag )
-			*_pStream << nContentOfsPos - ( _pStream->Tell() + sizeof(UINT32) );
+			*_pStream << nContentOfsPos - (sal_uInt32)( svstream_Size_to_u32(_pStream->Tell()) + sizeof(sal_uInt32) );
 		else
 			*_pStream << nContentOfsPos;
 
 		// ans Ende des Records seeken bzw. am Ende des Headers bleiben
 		if ( bSeekToEndOfRec )
-			 _pStream->Seek(nEndPos);
+			 _pStream->Seek(svstream_u32_to_Size(nEndPos));
 		return nEndPos;
 	}
 
@@ -880,8 +880,8 @@ UINT32 SfxMultiVarRecordWriter::Close( F
 
 void SfxMultiMixRecordWriter::NewContent
 (
-	UINT16		nContentTag,	// Kennung f"ur die Art des Contents
-	BYTE		nContentVer 	// Kennung f"ur die Version des Contents
+	sal_uInt16	nContentTag,	// Kennung f"ur die Art des Contents
+	sal_uInt8		nContentVer 	// Kennung f"ur die Version des Contents
 )
 
 /*	[Beschreibung]
@@ -897,7 +897,7 @@ void SfxMultiMixRecordWriter::NewContent
 		FlushContent_Impl();
 
 	// Tag vor den Content schreiben, Version und Startposition merken
-	_nContentStartPos = _pStream->Tell();
+	_nContentStartPos = svstream_Size_to_u32( _pStream->Tell() );
 	++_nContentCount;
 	*_pStream << nContentTag;
 	_nContentVer = nContentVer;
@@ -924,21 +924,21 @@ FASTBOOL SfxMultiRecordReader::ReadHeade
 	if ( _nRecordType != SFX_REC_TYPE_FIXSIZE )
 	{
 		// Tabelle aus dem Stream einlesen
-		UINT32 nContentPos = _pStream->Tell();
+		sal_uInt32 nContentPos = svstream_Size_to_u32( _pStream->Tell() );
 		if ( _nRecordType == SFX_REC_TYPE_VARSIZE_RELOC ||
 			 _nRecordType == SFX_REC_TYPE_MIXTAGS_RELOC )
-			_pStream->SeekRel( + _nContentSize );
+			_pStream->SeekRel( + svstream_u32_to_Size(_nContentSize) );
 		else
-			_pStream->Seek( _nContentSize );
-		_pContentOfs = new UINT32[_nContentCount];
+			_pStream->Seek( svstream_u32_to_Size(_nContentSize) );
+		_pContentOfs = new sal_uInt32[_nContentCount];
 		//! darf man jetzt so einr"ucken
 		#if defined(OSL_LITENDIAN)
-			_pStream->Read( _pContentOfs, sizeof(UINT32)*_nContentCount );
+			_pStream->Read( _pContentOfs, svstream_u32_to_Size(sizeof(sal_uInt32)*_nContentCount) );
 		#else
-			for ( USHORT n = 0; n < _nContentCount; ++n )
+			for ( sal_uInt16 n = 0; n < _nContentCount; ++n )
 				*_pStream >> _pContentOfs[n];
 		#endif
-		_pStream->Seek( nContentPos );
+		_pStream->Seek( svstream_u32_to_Size(nContentPos) );
 	}
 
 	// Header konnte gelesen werden, wenn am Stream kein Error gesetzt ist
@@ -951,7 +951,7 @@ SfxMultiRecordReader::SfxMultiRecordRead
 :	_nContentNo(0), _pContentOfs( NULL )
 {
 	// Position im Stream merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	_nStartPos = pStream->Tell();
+	_nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// Basisklasse konstruieren (normaler Ctor w"urde nur SingleRecs lesen)
 	SfxSingleRecordReader::Construct_Impl( pStream );
@@ -971,7 +971,7 @@ SfxMultiRecordReader::SfxMultiRecordRead
 :	_nContentNo(0)
 {
 	// Position im Stream merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	_nStartPos = pStream->Tell();
+	_nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// passenden Record suchen und Basisklasse initialisieren
 	SfxSingleRecordReader::Construct_Impl( pStream );
@@ -1015,10 +1015,10 @@ FASTBOOL SfxMultiRecordReader::GetConten
 	if ( _nContentNo < _nContentCount )
 	{
 		// den Stream an den Anfang des Contents positionieren
-		UINT32 nOffset = _nRecordType == SFX_REC_TYPE_FIXSIZE
+		sal_uInt32 nOffset = _nRecordType == SFX_REC_TYPE_FIXSIZE
 					? _nContentNo * _nContentSize
 					: SFX_REC_CONTENT_OFS(_pContentOfs[_nContentNo]);
-		UINT32 nNewPos = _nStartPos + nOffset;
+		sal_uInt32 nNewPos = _nStartPos + nOffset;
 		DBG_ASSERT( nNewPos >= _pStream->Tell(), "SfxMultiRecordReader::GetContent() - New position before current, to much data red!" );
 
 		// #99366#: correct stream pos in every case;
@@ -1027,7 +1027,7 @@ FASTBOOL SfxMultiRecordReader::GetConten
         // gives errors when writing with 5.1 and reading with current
         // versions, so we decided to remove the if clause (KA-05/17/2002)
         // if ( nNewPos > _pStream->Tell() )
-		_pStream->Seek( nNewPos );
+		_pStream->Seek( svstream_u32_to_Size(nNewPos) );
 
 		// ggf. Content-Header lesen
 		if ( _nRecordType == SFX_REC_TYPE_MIXTAGS ||
Index: svtools/source/filter.vcl/filter/dlgexpor.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/filter/dlgexpor.cxx,v
retrieving revision 1.4
retrieving revision 1.4.16.1
diff -u -p -u -p -r1.4 -r1.4.16.1
--- svtools/source/filter.vcl/filter/dlgexpor.cxx	16 Jun 2004 10:16:20 -0000	1.4
+++ svtools/source/filter.vcl/filter/dlgexpor.cxx	21 Jul 2004 17:34:11 -0000	1.4.16.1
@@ -208,7 +208,7 @@ IMPL_LINK( DlgExportPix, OK, void *, EMP
 {
 	// Config-Parameter schreiben
 
-	sal_Int32	nRes = Max( Min( aCbbRes.GetText().ToInt32(), 600L), 75L );
+	sal_Int32	nRes = Max( Min( aCbbRes.GetText().ToInt32(), (sal_Int32)600), (sal_Int32)75 );
 	::com::sun::star::awt::Size aSize(
 		(long)MetricField::ConvertDoubleValue( aMtfSizeX.GetValue(), 2, aMtfSizeX.GetUnit(), MAP_100TH_MM ),
 			(long)MetricField::ConvertDoubleValue( aMtfSizeY.GetValue(), 2, aMtfSizeY.GetUnit(), MAP_100TH_MM ) );
Index: svtools/source/filter.vcl/filter/filter.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/filter/filter.cxx,v
retrieving revision 1.54
retrieving revision 1.48.16.4
diff -u -p -u -p -r1.54 -r1.48.16.4
--- svtools/source/filter.vcl/filter/filter.cxx	16 Feb 2005 18:01:48 -0000	1.54
+++ svtools/source/filter.vcl/filter/filter.cxx	9 Mar 2005 23:15:12 -0000	1.48.16.4
@@ -894,7 +894,7 @@ static Graphic ImpGetScaledGraphic( cons
 				MapMode		aMap( MAP_100TH_INCH );
 
 				sal_Int32	nDPI = rConfigItem.ReadInt32( String( ResId( KEY_RES, pResMgr ) ), 75 );
-				Fraction	aFrac( 1, Min( Max( nDPI, 75L ), 600L ) );
+				Fraction	aFrac( 1, Min( Max( nDPI, 75 ), 600 ) );
 
 				aMap.SetScaleX( aFrac );
 				aMap.SetScaleY( aFrac );
Index: svtools/source/filter.vcl/wmf/wmfwr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/wmfwr.cxx,v
retrieving revision 1.20
retrieving revision 1.19.8.3
diff -u -p -u -p -r1.20 -r1.19.8.3
--- svtools/source/filter.vcl/wmf/wmfwr.cxx	6 Jul 2004 12:12:30 -0000	1.20
+++ svtools/source/filter.vcl/wmf/wmfwr.cxx	21 Jan 2005 17:16:36 -0000	1.19.8.3
@@ -920,7 +920,7 @@ void WMFWriter::WMFRecord_StretchDIB( co
 	// erzeugt, schreiben wir zuerst die Bitmap an die richtige Position
 	// Und ueberschreiben hinterher den FILEHEADER mit den Parametern.
 	nPosAnf=pWMF->Tell(); // Position merken, wo Parameter hin sollen
-	*pWMF << (long)0 << (long)0; // 8 bytes auffuellen (diese 8 bytes +
+	*pWMF << (sal_Int32)0 << (sal_Int32)0; // 8 bytes auffuellen (diese 8 bytes +
 								 // 14 bytes ueberfluessigen FILEHEADER
 								 // = 22 bytes Parameter)
 	*pWMF << rBitmap; // Bitmap schreiben
Index: svtools/source/items/rectitem.cxx
===================================================================
RCS file: /cvs/util/svtools/source/items/rectitem.cxx,v
retrieving revision 1.5
retrieving revision 1.5.614.1
diff -u -p -u -p -r1.5 -r1.5.614.1
--- svtools/source/items/rectitem.cxx	28 May 2002 14:17:17 -0000	1.5
+++ svtools/source/items/rectitem.cxx	21 Jul 2004 17:34:13 -0000	1.5.614.1
@@ -194,10 +194,10 @@ BOOL SfxRectangleItem::QueryValue( com::
 											 aVal.getHeight() );
             break;
         }
-        case MID_RECT_LEFT:  rVal <<= aVal.getX(); break;
-        case MID_RECT_RIGHT: rVal <<= aVal.getY(); break;
-        case MID_WIDTH: rVal <<= aVal.getWidth(); break;
-        case MID_HEIGHT: rVal <<= aVal.getHeight(); break;
+        case MID_RECT_LEFT:  rVal <<= (sal_Int32)aVal.getX(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_RECT_RIGHT: rVal <<= (sal_Int32)aVal.getY(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_WIDTH: rVal <<=  (sal_Int32)aVal.getWidth(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_HEIGHT: rVal <<= (sal_Int32)aVal.getHeight(); break;	// FIXME: possible truncation in 64-bit mode
         default: DBG_ERROR("Wrong MemberID!"); return FALSE;
     }
 
Index: svtools/source/items/szitem.cxx
===================================================================
RCS file: /cvs/util/svtools/source/items/szitem.cxx,v
retrieving revision 1.4
retrieving revision 1.4.614.1
diff -u -p -u -p -r1.4 -r1.4.614.1
--- svtools/source/items/szitem.cxx	28 May 2002 11:37:16 -0000	1.4
+++ svtools/source/items/szitem.cxx	21 Jul 2004 17:34:13 -0000	1.4.614.1
@@ -198,9 +198,9 @@ BOOL  SfxSizeItem::QueryValue( com::sun:
             break;
         }
         case MID_WIDTH:
-            rVal <<= aTmp.getWidth(); break;
+            rVal <<= (sal_Int32)aTmp.getWidth(); break;	// FIXME: possible truncation in 64-bit mode
         case MID_HEIGHT:
-            rVal <<= aTmp.getHeight(); break;
+            rVal <<= (sal_Int32)aTmp.getHeight(); break;	// FIXME: possible truncation in 64-bit mode
         default: DBG_ERROR("Wrong MemberId!"); return FALSE;
     }
 
Index: svtools/source/misc/flbytes.cxx
===================================================================
RCS file: /cvs/util/svtools/source/misc/flbytes.cxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/source/misc/flbytes.cxx	18 Sep 2000 16:59:02 -0000	1.1.1.1
+++ svtools/source/misc/flbytes.cxx	21 Jul 2004 17:34:14 -0000	1.1.1.1.650.1
@@ -79,9 +79,9 @@ namespace unnamed_svtools_flbytes {} usi
 //============================================================================
 namespace unnamed_svtools_flbytes {
 
-inline ULONG MyMin( long a, long b )
+inline sal_Int32 MyMin( sal_Int32 a, sal_Int32 b )
 {
-	return Max( long( Min(  a ,  b ) ), 0L );
+	return Max( sal_Int32( Min(  a ,  b ) ), 0 );
 }
 
 }
@@ -103,14 +103,14 @@ SvFillLockBytes::SvFillLockBytes( SvLock
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::ReadAt( ULONG nPos, void* pBuffer, ULONG nCount,
-							 ULONG *pRead ) const
+ErrCode SvFillLockBytes::ReadAt( sal_Size nPos, void* pBuffer, sal_Size nCount,
+							 sal_Size *pRead ) const
 {
 	if( bTerminated )
 		return xLockBytes->ReadAt( nPos, pBuffer, nCount, pRead );
 	else
 	{
-		ULONG nWanted = nPos + nCount;
+		sal_Size nWanted = nPos + nCount;
 		if( IsSynchronMode() )
 		{
 			while( nWanted > nFilledSize && !bTerminated )
@@ -119,8 +119,8 @@ ErrCode SvFillLockBytes::ReadAt( ULONG n
 		}
 		else
 		{
-			ULONG nRead = MyMin( nCount, long( nFilledSize ) - nPos );
-			ULONG nErr = xLockBytes->ReadAt( nPos, pBuffer, nRead, pRead );
+			sal_Size nRead = MyMin( nCount, sal_Size( nFilledSize ) - nPos );
+			sal_Size nErr = xLockBytes->ReadAt( nPos, pBuffer, nRead, pRead );
 			return ( !nCount || nRead == nCount || nErr ) ?
 				nErr : ERRCODE_IO_PENDING;
 		}
@@ -128,14 +128,14 @@ ErrCode SvFillLockBytes::ReadAt( ULONG n
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::WriteAt( ULONG nPos, const void* pBuffer,
-								  ULONG nCount, ULONG *pWritten )
+ErrCode SvFillLockBytes::WriteAt( sal_Size nPos, const void* pBuffer,
+								  sal_Size nCount, sal_Size *pWritten )
 {
 	if( bTerminated )
 		return xLockBytes->WriteAt( nPos, pBuffer, nCount, pWritten );
 	else
 	{
-		ULONG nWanted = nPos + nCount;
+		sal_Size nWanted = nPos + nCount;
 		if( IsSynchronMode() )
 		{
 			while( nWanted > nFilledSize && !bTerminated )
@@ -144,8 +144,8 @@ ErrCode SvFillLockBytes::WriteAt( ULONG 
 		}
 		else
 		{
-			ULONG nRead = MyMin( nCount, long( nFilledSize ) - nPos );
-			ULONG nErr = xLockBytes->WriteAt( nPos, pBuffer, nRead, pWritten );
+			sal_Size nRead = MyMin( nCount, sal_Size( nFilledSize ) - nPos );
+			sal_Size nErr = xLockBytes->WriteAt( nPos, pBuffer, nRead, pWritten );
 			return ( !nCount || nRead == nCount || nErr ) ?
 				nErr : ERRCODE_IO_PENDING;
 		}
@@ -159,20 +159,20 @@ ErrCode SvFillLockBytes::Flush() const
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::SetSize( ULONG nSize )
+ErrCode SvFillLockBytes::SetSize( sal_Size nSize )
 {
 	return xLockBytes->SetSize( nSize );
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::LockRegion( ULONG nPos, ULONG nCount, LockType eType)
+ErrCode SvFillLockBytes::LockRegion( sal_Size nPos, sal_Size nCount, LockType eType)
 {
 	return xLockBytes->LockRegion( nPos, nCount, eType );
 }
 
 //============================================================================
 ErrCode SvFillLockBytes::UnlockRegion(
-	ULONG nPos, ULONG nCount, LockType eType)
+	sal_Size nPos, sal_Size nCount, LockType eType)
 {
 	return xLockBytes->UnlockRegion( nPos, nCount, eType );
 }
@@ -185,7 +185,7 @@ ErrCode SvFillLockBytes::Stat(
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::FillAppend( const void* pBuffer, ULONG nCount, ULONG *pWritten )
+ErrCode SvFillLockBytes::FillAppend( const void* pBuffer, sal_Size nCount, sal_Size *pWritten )
 {
 	ErrCode nRet = xLockBytes->WriteAt(
 		nFilledSize, pBuffer, nCount, pWritten );
@@ -212,12 +212,12 @@ TYPEINIT1(SvSyncLockBytes, SvOpenLockByt
 
 //============================================================================
 // virtual
-ErrCode SvSyncLockBytes::ReadAt(ULONG nPos, void * pBuffer, ULONG nCount,
-								ULONG * pRead) const
+ErrCode SvSyncLockBytes::ReadAt(sal_Size nPos, void * pBuffer, sal_Size nCount,
+								sal_Size * pRead) const
 {
-	for (ULONG nReadTotal = 0;;)
+	for (sal_Size nReadTotal = 0;;)
 	{
-		ULONG nReadCount = 0;
+		sal_Size nReadCount = 0;
 		ErrCode nError = m_xAsyncLockBytes->ReadAt(nPos, pBuffer, nCount,
 												   &nReadCount);
 		nReadTotal += nReadCount;
@@ -236,12 +236,12 @@ ErrCode SvSyncLockBytes::ReadAt(ULONG nP
 
 //============================================================================
 // virtual
-ErrCode SvSyncLockBytes::WriteAt(ULONG nPos, const void * pBuffer,
-								 ULONG nCount, ULONG * pWritten)
+ErrCode SvSyncLockBytes::WriteAt(sal_Size nPos, const void * pBuffer,
+								 sal_Size nCount, sal_Size * pWritten)
 {
-	for (ULONG nWrittenTotal = 0;;)
+	for (sal_Size nWrittenTotal = 0;;)
 	{
-		ULONG nWrittenCount = 0;
+		sal_Size nWrittenCount = 0;
 		ErrCode nError = m_xAsyncLockBytes->WriteAt(nPos, pBuffer, nCount,
 													&nWrittenCount);
 		nWrittenTotal += nWrittenCount;
@@ -270,34 +270,34 @@ struct SvCompositeLockBytes_Impl
 	SvULongs              aPositions;
 	SvULongs              aOffsets;
 	BOOL                  bPending;
-	ULONG RelativeOffset( ULONG nPos ) const;
+	sal_Size RelativeOffset( sal_Size nPos ) const;
 	ErrCode ReadWrite_Impl(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pProcessed,
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pProcessed,
 		BOOL bRead );
 	SvCompositeLockBytes_Impl() : bPending( FALSE ){}
 };
 
 //============================================================================
-ULONG SvCompositeLockBytes_Impl::RelativeOffset( ULONG nPos ) const
+sal_Size SvCompositeLockBytes_Impl::RelativeOffset( sal_Size nPos ) const
 {
 	const SvULongs& rPositions = aPositions;
 	const SvULongs& rOffsets = aOffsets;
 
-	USHORT nMinPos = 0;
-	USHORT nListCount = rPositions.Count();
+	sal_uInt16 nMinPos = 0;
+	sal_uInt16 nListCount = rPositions.Count();
 
 	// Erster Lockbytes, der bearbeitet werden muss
 	while( nMinPos + 1 < nListCount && rPositions[ nMinPos + 1 ] <= nPos )
 		nMinPos ++;
-	ULONG nSectionStart = rPositions[ nMinPos ];
+	sal_Size nSectionStart = rPositions[ nMinPos ];
 	if( nSectionStart > nPos )
-		return ULONG_MAX;
+		return SAL_MAX_SIZE;
 	return rOffsets[ nMinPos ] + nPos - nSectionStart;
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes_Impl::ReadWrite_Impl(
-	ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pProcessed,
+	sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pProcessed,
 	BOOL bRead )
 {
 	ErrCode nErr = ERRCODE_NONE;
@@ -305,14 +305,14 @@ ErrCode SvCompositeLockBytes_Impl::ReadW
 	SvULongs& rOffsets = aOffsets;
 	SvLockBytesMemberList& rLockBytes = aLockBytes;
 
-	ULONG nBytes = nCount;
-	USHORT nListCount = rPositions.Count();
-	USHORT nMinPos = 0;
+	sal_Size nBytes = nCount;
+	sal_uInt16 nListCount = rPositions.Count();
+	sal_uInt16 nMinPos = 0;
 
 	// Erster Lockbytes, der bearbeitet werden muss
 	while( nMinPos + 1 < nListCount && rPositions[ nMinPos + 1 ] <= nPos )
 		nMinPos ++;
-	ULONG nSectionStart = rPositions[ nMinPos ];
+	sal_Size nSectionStart = rPositions[ nMinPos ];
 
 	if( nSectionStart > nPos )
 	{
@@ -321,22 +321,22 @@ ErrCode SvCompositeLockBytes_Impl::ReadW
 		return ERRCODE_IO_CANTREAD;
 	}
 
-	ULONG nDone;
+	sal_Size nDone;
 	while( nMinPos < nListCount )
 	{
-		ULONG nToProcess;
-		ULONG nSectionStop;
+		sal_Size nToProcess;
+		sal_Size nSectionStop;
 		if( nMinPos + 1 < nListCount )
 		{
 			nSectionStop = rPositions[ nMinPos + 1 ];
-			nToProcess = MyMin( long( nSectionStop ) - nPos, nBytes );
+			nToProcess = MyMin( sal_sSize( nSectionStop ) - nPos, nBytes );
 		}
 		else
 		{
 			nToProcess = nBytes;
 			nSectionStop = 0;
 		}
-		ULONG nAbsPos = nPos - nSectionStart + rOffsets[ nMinPos ];
+		sal_Size nAbsPos = nPos - nSectionStart + rOffsets[ nMinPos ];
 		SvLockBytes* pLB = rLockBytes.GetObject( nMinPos );
 		if( bRead )
 			nErr = pLB->ReadAt( nAbsPos, pBuffer, nToProcess, &nDone );
@@ -382,21 +382,21 @@ void  SvCompositeLockBytes::SetIsPending
 }
 
 //============================================================================
-ULONG SvCompositeLockBytes::RelativeOffset( ULONG nPos ) const
+sal_Size SvCompositeLockBytes::RelativeOffset( sal_Size nPos ) const
 {
 	return  pImpl->RelativeOffset( nPos );
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes::ReadAt(
-	ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const
+	sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const
 {
 	return pImpl->ReadWrite_Impl( nPos, pBuffer, nCount, pRead, TRUE );
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes::WriteAt(
-	ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten )
+	sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten )
 {
 	return pImpl->ReadWrite_Impl(
 		nPos, const_cast< void * >(pBuffer), nCount, pWritten, FALSE );
@@ -407,20 +407,20 @@ ErrCode SvCompositeLockBytes::Flush() co
 {
 	SvLockBytesMemberList& rLockBytes = pImpl->aLockBytes;
 	ErrCode nErr = ERRCODE_NONE;
-	for( USHORT nCount = (USHORT)rLockBytes.Count(); !nErr && nCount--; )
+	for( sal_uInt16 nCount = (sal_uInt16)rLockBytes.Count(); !nErr && nCount--; )
 		nErr = rLockBytes.GetObject( nCount )->Flush();
 	return nErr;
 }
 
 //============================================================================
-ErrCode SvCompositeLockBytes::SetSize( ULONG nSize )
+ErrCode SvCompositeLockBytes::SetSize( sal_Size nSize )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
 }
 
 //============================================================================
-ErrCode SvCompositeLockBytes::LockRegion( ULONG nPos, ULONG nCount, LockType )
+ErrCode SvCompositeLockBytes::LockRegion( sal_Size nPos, sal_Size nCount, LockType )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
@@ -428,7 +428,7 @@ ErrCode SvCompositeLockBytes::LockRegion
 
 //============================================================================
 ErrCode SvCompositeLockBytes::UnlockRegion(
-	ULONG nPos, ULONG nCount, LockType )
+	sal_Size nPos, sal_Size nCount, LockType )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
@@ -438,7 +438,7 @@ ErrCode SvCompositeLockBytes::UnlockRegi
 ErrCode SvCompositeLockBytes::Stat(
 	SvLockBytesStat* pStat, SvLockBytesStatFlag eFlag) const
 {
-	USHORT nMax = pImpl->aPositions.Count() - 1;
+	sal_uInt16 nMax = pImpl->aPositions.Count() - 1;
 
 	SvLockBytesStat aStat;
 	ErrCode nErr = pImpl->aLockBytes.GetObject( nMax )->Stat( &aStat, eFlag );
@@ -449,9 +449,9 @@ ErrCode SvCompositeLockBytes::Stat(
 
 //============================================================================
 void SvCompositeLockBytes::Append(
-	SvLockBytes* pLockBytes, ULONG nPos, ULONG nOffset )
+	SvLockBytes* pLockBytes, sal_Size nPos, sal_Size nOffset )
 {
-	USHORT nCount = pImpl->aOffsets.Count();
+	sal_uInt16 nCount = pImpl->aOffsets.Count();
 	pImpl->aLockBytes.Insert( pLockBytes, nCount );
 	pImpl->aPositions.Insert( nPos, nCount );
 	pImpl->aOffsets.Insert( nOffset, nCount );
Index: svtools/source/misc/graphictools.cxx
===================================================================
RCS file: /cvs/util/svtools/source/misc/graphictools.cxx,v
retrieving revision 1.6
retrieving revision 1.6.8.1
diff -u -p -u -p -r1.6 -r1.6.8.1
--- svtools/source/misc/graphictools.cxx	17 Jun 2004 13:21:09 -0000	1.6
+++ svtools/source/misc/graphictools.cxx	21 Jul 2004 17:34:14 -0000	1.6.8.1
@@ -361,13 +361,13 @@ SvStream& operator<<( SvStream& rOStm, c
     rClass.maEndArrow.Write( rOStm );
     rOStm << rClass.mfTransparency;
     rOStm << rClass.mfStrokeWidth;
-    UINT16 nTmp = rClass.maCapType;
+    sal_uInt16 nTmp = rClass.maCapType;
     rOStm << nTmp;
     nTmp = rClass.maJoinType;
     rOStm << nTmp;
     rOStm << rClass.mfMiterLimit;
 
-    rOStm << (sal_Size)rClass.maDashArray.size();
+    rOStm << svstream_Size_to_u32( rClass.maDashArray.size() );
     size_t i;
     for(i=0; i<rClass.maDashArray.size(); ++i)
         rOStm << rClass.maDashArray[i];
@@ -384,15 +384,16 @@ SvStream& operator>>( SvStream& rIStm, S
     rClass.maEndArrow.Read( rIStm );
     rIStm >> rClass.mfTransparency;
     rIStm >> rClass.mfStrokeWidth;
-    UINT16 nTmp;
+    sal_uInt16 nTmp;
     rIStm >> nTmp;
     rClass.maCapType = SvtGraphicStroke::CapType(nTmp);
     rIStm >> nTmp;
     rClass.maJoinType = SvtGraphicStroke::JoinType(nTmp);
     rIStm >> rClass.mfMiterLimit;
 
-    sal_Size nSize;
-    rIStm >> nSize;
+    sal_uInt32 nTemp;
+    rIStm >> nTemp;
+    sal_Size nSize = svstream_u32_to_Size(nTemp);
     rClass.maDashArray.resize(nSize);
     size_t i;
     for(i=0; i<rClass.maDashArray.size(); ++i)
Index: svtools/source/numbers/numhead.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numhead.cxx,v
retrieving revision 1.4
retrieving revision 1.4.16.3
diff -u -p -u -p -r1.4 -r1.4.16.3
--- svtools/source/numbers/numhead.cxx	16 Jun 2004 10:27:57 -0000	1.4
+++ svtools/source/numbers/numhead.cxx	21 Jan 2005 17:16:49 -0000	1.4.16.3
@@ -82,7 +82,7 @@
 SvNumReadHeader::SvNumReadHeader(SvStream& rNewStream) :
 	rStream( rNewStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
 	nDataEnd = rStream.Tell() + nDataSize;
 }
@@ -91,7 +91,7 @@ SvNumReadHeader::SvNumReadHeader(SvStrea
 
 SvNumReadHeader::~SvNumReadHeader()
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = rStream.Tell();
 	DBG_ASSERT( nReadEnd <= nDataEnd, "zuviele Bytes gelesen" );
 	if ( nReadEnd != nDataEnd )
 		rStream.Seek(nDataEnd); 					// Rest ueberspringen
@@ -99,9 +99,9 @@ SvNumReadHeader::~SvNumReadHeader()
 
 //#pragma SEG_FUNCDEF(numhead_03)
 
-ULONG SvNumReadHeader::BytesLeft() const
+sal_uInt32 SvNumReadHeader::BytesLeft() const
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = rStream.Tell();
 	if (nReadEnd <= nDataEnd)
 		return nDataEnd-nReadEnd;
 
@@ -113,7 +113,7 @@ ULONG SvNumReadHeader::BytesLeft() const
 
 //#pragma SEG_FUNCDEF(numhead_04)
 
-SvNumWriteHeader::SvNumWriteHeader(SvStream& rNewStream, ULONG nDefault) :
+SvNumWriteHeader::SvNumWriteHeader(SvStream& rNewStream, sal_uInt32 nDefault) :
 	rStream( rNewStream )
 {
 	nDataSize = nDefault;
@@ -125,12 +125,12 @@ SvNumWriteHeader::SvNumWriteHeader(SvStr
 
 SvNumWriteHeader::~SvNumWriteHeader()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = rStream.Tell();
 
 	if ( nPos - nDataPos != nDataSize )				// Default getroffen?
 	{
 		nDataSize = nPos - nDataPos;
-		rStream.Seek(nDataPos - sizeof(ULONG));
+		rStream.Seek(nDataPos - sizeof(sal_uInt32));
 		rStream << nDataSize;						// Groesse am Anfang eintragen
 		rStream.Seek(nPos);
 	}
@@ -145,26 +145,26 @@ SvNumWriteHeader::~SvNumWriteHeader()
 ImpSvNumMultipleReadHeader::ImpSvNumMultipleReadHeader(SvStream& rNewStream) :
 	rStream( rNewStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
-	ULONG nDataPos = rStream.Tell();
+	sal_uInt32 nDataPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryEnd = nDataPos;
 
-	rStream.SeekRel(nDataSize);
-	USHORT nID;
+	rStream.SeekRel(svstream_u32_to_Size(nDataSize));
+	sal_uInt16 nID;
 	rStream >> nID;
 	if (nID != SV_NUMID_SIZES)
 	{
 		DBG_ERROR("SV_NUMID_SIZES nicht gefunden");
 	}
-	ULONG nSizeTableLen;
+	sal_uInt32 nSizeTableLen;
 	rStream >> nSizeTableLen;
 	pBuf = new char[nSizeTableLen];
-	rStream.Read( pBuf, nSizeTableLen );
-	pMemStream = new SvMemoryStream( pBuf, nSizeTableLen, STREAM_READ );
+	rStream.Read( pBuf, svstream_u32_to_Size(nSizeTableLen) );
+	pMemStream = new SvMemoryStream( pBuf, svstream_u32_to_Size(nSizeTableLen), STREAM_READ );
 
-	nEndPos = rStream.Tell();
-	rStream.Seek( nDataPos );
+	nEndPos = svstream_Size_to_u32( rStream.Tell() );
+	rStream.Seek( svstream_u32_to_Size(nDataPos) );
 }
 
 //#pragma SEG_FUNCDEF(numhead_07)
@@ -176,43 +176,43 @@ ImpSvNumMultipleReadHeader::~ImpSvNumMul
 	delete pMemStream;
 	delete [] pBuf;
 
-	rStream.Seek(nEndPos);
+	rStream.Seek(svstream_u32_to_Size(nEndPos));
 }
 
 //! mit ctor synchron
 // static
 void ImpSvNumMultipleReadHeader::Skip( SvStream& rStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
-	rStream.SeekRel( nDataSize );
-	USHORT nID;
+	rStream.SeekRel( svstream_u32_to_Size(nDataSize) );
+	sal_uInt16 nID;
 	rStream >> nID;
 	if ( nID != SV_NUMID_SIZES )
 	{
 		DBG_ERROR("SV_NUMID_SIZES nicht gefunden");
 	}
-	ULONG nSizeTableLen;
+	sal_uInt32 nSizeTableLen;
 	rStream >> nSizeTableLen;
-	rStream.SeekRel( nSizeTableLen );
+	rStream.SeekRel( svstream_u32_to_Size(nSizeTableLen) );
 }
 
 //#pragma SEG_FUNCDEF(numhead_08)
 
 void ImpSvNumMultipleReadHeader::EndEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	DBG_ASSERT( nPos <= nEntryEnd, "zuviel gelesen" );
 	if ( nPos != nEntryEnd )
-		rStream.Seek( nEntryEnd );			// Rest ueberspringen
+		rStream.Seek( svstream_u32_to_Size(nEntryEnd) );	// Rest ueberspringen
 }
 
 //#pragma SEG_FUNCDEF(numhead_0d)
 
 void ImpSvNumMultipleReadHeader::StartEntry()
 {
-	ULONG nPos = rStream.Tell();
-	ULONG nEntrySize;
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
+	sal_uInt32 nEntrySize;
 	(*pMemStream) >> nEntrySize;
 
 	nEntryEnd = nPos + nEntrySize;
@@ -220,9 +220,9 @@ void ImpSvNumMultipleReadHeader::StartEn
 
 //#pragma SEG_FUNCDEF(numhead_09)
 
-ULONG ImpSvNumMultipleReadHeader::BytesLeft() const
+sal_uInt32 ImpSvNumMultipleReadHeader::BytesLeft() const
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = svstream_Size_to_u32( rStream.Tell() );
 	if (nReadEnd <= nEntryEnd)
 		return nEntryEnd-nReadEnd;
 
@@ -235,14 +235,14 @@ ULONG ImpSvNumMultipleReadHeader::BytesL
 //#pragma SEG_FUNCDEF(numhead_0a)
 
 ImpSvNumMultipleWriteHeader::ImpSvNumMultipleWriteHeader(SvStream& rNewStream,
-												   ULONG nDefault) :
+												   sal_uInt32 nDefault) :
 	rStream( rNewStream ),
 	aMemStream( 4096, 4096 )
 {
 	nDataSize = nDefault;
 	rStream << nDataSize;
 
-	nDataPos = rStream.Tell();
+	nDataPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryStart = nDataPos;
 }
 
@@ -250,19 +250,19 @@ ImpSvNumMultipleWriteHeader::ImpSvNumMul
 
 ImpSvNumMultipleWriteHeader::~ImpSvNumMultipleWriteHeader()
 {
-	ULONG nDataEnd = rStream.Tell();
+	sal_uInt32 nDataEnd = svstream_Size_to_u32( rStream.Tell() );
 
-	rStream << (USHORT) SV_NUMID_SIZES;
-	rStream << aMemStream.Tell();
+	rStream << (sal_uInt16) SV_NUMID_SIZES;
+	rStream << svstream_Size_to_u32( aMemStream.Tell() );
 	rStream.Write( aMemStream.GetData(), aMemStream.Tell() );
 
 	if ( nDataEnd - nDataPos != nDataSize )					// Default getroffen?
 	{
 		nDataSize = nDataEnd - nDataPos;
-		ULONG nPos = rStream.Tell();
-		rStream.Seek(nDataPos-sizeof(ULONG));
+		sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
+		rStream.Seek(svstream_u32_to_Size(nDataPos-sizeof(sal_uInt32)));
 		rStream << nDataSize;								// Groesse am Anfang eintragen
-		rStream.Seek(nPos);
+		rStream.Seek(svstream_u32_to_Size(nPos));
 	}
 }
 
@@ -270,7 +270,7 @@ ImpSvNumMultipleWriteHeader::~ImpSvNumMu
 
 void ImpSvNumMultipleWriteHeader::EndEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	aMemStream << nPos - nEntryStart;
 }
 
@@ -278,7 +278,7 @@ void ImpSvNumMultipleWriteHeader::EndEnt
 
 void ImpSvNumMultipleWriteHeader::StartEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryStart = nPos;
 }
 
Index: svtools/source/numbers/numhead.hxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numhead.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.2
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.2
--- svtools/source/numbers/numhead.hxx	18 Sep 2000 16:59:03 -0000	1.1.1.1
+++ svtools/source/numbers/numhead.hxx	21 Jan 2005 17:16:54 -0000	1.1.1.1.650.2
@@ -115,7 +115,7 @@ public:
 
 	void	StartEntry();
 	void	EndEntry();
-	ULONG	BytesLeft() const;
+	sal_uInt32	BytesLeft() const;
 
 	static void Skip( SvStream& );		// komplett ueberspringen
 };
@@ -130,7 +130,7 @@ private:
 	ULONG			nEntryStart;
 
 public:
-	ImpSvNumMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault = 0);
+	ImpSvNumMultipleWriteHeader(SvStream& rNewStream, sal_uInt32 nDefault = 0);
 	~ImpSvNumMultipleWriteHeader();
 
 	void	StartEntry();
Index: svtools/source/svhtml/parhtml.cxx
===================================================================
RCS file: /cvs/util/svtools/source/svhtml/parhtml.cxx,v
retrieving revision 1.7
retrieving revision 1.6.16.4
diff -u -p -u -p -r1.7 -r1.6.16.4
--- svtools/source/svhtml/parhtml.cxx	5 Jan 2005 13:29:27 -0000	1.7
+++ svtools/source/svhtml/parhtml.cxx	22 Jan 2005 10:40:03 -0000	1.6.16.4
@@ -191,7 +191,7 @@ HTMLOption::HTMLOption( USHORT nTok, con
 		"HTMLOption: unbekanntes Token" );
 }
 
-ULONG HTMLOption::GetNumber() const
+sal_uInt32 HTMLOption::GetNumber() const
 {
 	DBG_ASSERT( (nToken>=HTML_OPTION_NUMBER_START &&
 				 nToken<HTML_OPTION_NUMBER_END) ||
@@ -202,7 +202,7 @@ ULONG HTMLOption::GetNumber() const
 	String aTmp( aValue );
 	aTmp.EraseLeadingChars();
 	sal_Int32 nTmp = aTmp.ToInt32();
-	return nTmp >= 0L ? (sal_uInt32)nTmp : 0UL;
+	return nTmp >= 0U ? (sal_uInt32)nTmp : 0U;
 }
 
 INT32 HTMLOption::GetSNumber() const
@@ -251,7 +251,7 @@ void HTMLOption::GetNumbers( SvULongs &r
 	{
 		// hier wird auf die korrekte Trennung der Zahlen durch ',' geachtet
 		// und auch mal eine 0 eingefuegt
-		sal_uInt32 nPos = 0UL;
+		ULONG nPos = 0UL;
 		while( nPos < aValue.Len() )
 		{
 			register sal_Unicode c;
Index: svtools/source/uno/unoiface.cxx
===================================================================
RCS file: /cvs/util/svtools/source/uno/unoiface.cxx,v
retrieving revision 1.16
retrieving revision 1.12.48.5
diff -u -p -u -p -r1.16 -r1.12.48.5
--- svtools/source/uno/unoiface.cxx	26 Nov 2004 16:06:31 -0000	1.16
+++ svtools/source/uno/unoiface.cxx	21 Jan 2005 17:17:32 -0000	1.12.48.5
@@ -1750,7 +1750,7 @@ void SVTXRoadmap::setColorModel( sal_Int
 {
 	::vos::OGuard aGuard( GetMutex() );
 
-	maImageConsumer.SetColorModel( BitCount, RGBAPal.getLength(), (const unsigned long*) RGBAPal.getConstArray(), RedMask, GreenMask, BlueMask, AlphaMask );
+	maImageConsumer.SetColorModel( BitCount, RGBAPal.getLength(), (const sal_uInt32*) RGBAPal.getConstArray(), RedMask, GreenMask, BlueMask, AlphaMask );
 }
 
 
@@ -1766,7 +1766,7 @@ void SVTXRoadmap::setPixelsByLongs( sal_
 {
 	::vos::OGuard aGuard( GetMutex() );
 
-	maImageConsumer.SetPixelsByLongs( X, Y, Width, Height, (const unsigned long*) ProducerData.getConstArray(), Offset, Scansize );
+	maImageConsumer.SetPixelsByLongs( X, Y, Width, Height, (const sal_uInt32*) ProducerData.getConstArray(), Offset, Scansize );
 	ImplUpdateImage( sal_True );
 }
 
Index: svtools/workben/svdem.cxx
===================================================================
RCS file: /cvs/util/svtools/workben/svdem.cxx,v
retrieving revision 1.5
retrieving revision 1.4.208.3
diff -u -p -u -p -r1.5 -r1.4.208.3
--- svtools/workben/svdem.cxx	30 Jul 2004 15:20:26 -0000	1.5
+++ svtools/workben/svdem.cxx	24 Feb 2005 20:02:07 -0000	1.4.208.3
@@ -59,8 +59,11 @@
  *
  ************************************************************************/
 #include <stdio.h>
-#include <cppuhelper/servicefactory.hxx>
+#include <sal/main.h>
+#include <com/sun/star/lang/XMultiServiceFactory.hpp>
 #include <comphelper/processfactory.hxx>
+#include <cppuhelper/servicefactory.hxx>
+#include <cppuhelper/bootstrap.hxx>
 
 #include <vcl/wrkwin.hxx>
 #include <vcl/dialog.hxx>
@@ -86,13 +89,13 @@
 #include <prnsetup.hxx>
 #include <printdlg.hxx>
 
+
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::lang;
 // -----------------------------------------------------------------------
 
-class MyApp : public Application
-{
-public:
-	void Main();
-};
+// Forward declaration
+void Main();
 
 // -----------------------------------------------------------------------
 
@@ -254,21 +257,37 @@ public:
 	void			Paint( const Rectangle& rRect );
 	void			Resize();
 };
-
 // -----------------------------------------------------------------------
 
-void MyApp::Main()
+SAL_IMPLEMENT_MAIN()
 {
     try
     {
-        ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >
-              xMSF = cppu::createRegistryServiceFactory(
-                  rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "applicat.rdb" ) ), sal_True );
+        Reference< XMultiServiceFactory > xMS;
+        xMS = cppu::createRegistryServiceFactory( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "applicat.rdb" ) ), sal_True );
+ 
+        ::comphelper::setProcessServiceFactory( xMS );
+
+        InitVCL( xMS );
+        ::Main();
+        DeInitVCL();
+    }
+    catch ( com::sun::star::uno::Exception & e )
+    {
+        fprintf( stderr, "Error during bootstrapping servicemanager: %s\n" ,
+                 rtl::OUStringToOString( e.Message, RTL_TEXTENCODING_ASCII_US ).getStr() );
+    }
+    return 0;
+}
+
 
-        ::comphelper::setProcessServiceFactory( xMSF );
+// -----------------------------------------------------------------------
+
+void Main()
+{
 
         Help aHelp;
-        SetHelp( &aHelp );
+        Application::SetHelp( &aHelp );
         Help::EnableContextHelp();
         Help::EnableExtHelp();
         Help::EnableBalloonHelp();
@@ -277,15 +296,9 @@ void MyApp::Main()
         MyWin aMainWin( NULL, WinBits( WB_APP | WB_STDWORK | WB_CLIPCHILDREN ) );
         aMainWin.SetText( XubString( RTL_CONSTASCII_USTRINGPARAM( "SVTOOLS - Workbench" ) ) );
         aMainWin.GrabFocus();
-        aMainWin.Show();
-        
-        Execute();
-    }
-    catch ( com::sun::star::uno::Exception & e )
-    {
-        fprintf( stderr, "Error during bootstrapping servicemanager: %s\n" ,
-                 rtl::OUStringToOString( e.Message, RTL_TEXTENCODING_ASCII_US ).getStr() );
-    }
+	aMainWin.Show();
+
+	Application::Execute();
 }
 
 // -----------------------------------------------------------------------
@@ -1142,4 +1155,3 @@ void MyWin::Resize()
 
 // -----------------------------------------------------------------------
 
-MyApp aMyApp;
? config_office/autom4te.cache
? config_office/config.log
? config_office/config.parms
? config_office/config.status
? config_office/oowintool
? config_office/set_soenv
? config_office/warn
Index: sc/inc/address.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/address.hxx,v
retrieving revision 1.4
retrieving revision 1.4.78.1
diff -u -p -u -p -r1.4 -r1.4.78.1
--- sc/inc/address.hxx	23 Aug 2004 09:22:05 -0000	1.4
+++ sc/inc/address.hxx	21 Jan 2005 16:33:04 -0000	1.4.78.1
@@ -147,7 +147,7 @@ typedef sal_Int32 SCsCOLROW;
 // size_t typedef to be able to find places where code was changed from USHORT
 // to size_t and is used to read/write from/to streams.
 typedef size_t SCSIZE;
-#ifndef MACOSX
+#if !defined( MACOSX ) && !defined( __x86_64__ )
 // resolve ambiguity, TODO: move to tools/solar.h, or even better use ::std::min/max
 inline size_t Min( size_t a, size_t b) { return a<b ? a : b; }
 inline size_t Max( size_t a, size_t b) { return a<b ? a : b; }
Index: sc/inc/rechead.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rechead.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.522.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.522.1
--- sc/inc/rechead.hxx	18 Sep 2000 16:44:49 -0000	1.1.1.1
+++ sc/inc/rechead.hxx	9 Sep 2004 11:02:22 -0000	1.1.1.1.522.1
@@ -221,7 +221,7 @@ private:
 	ULONG			nEntryStart;
 
 public:
-	ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault = 0);
+	ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault = 0);
 	~ScMultipleWriteHeader();
 
 	void	StartEntry();
Index: sc/source/core/data/table3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table3.cxx,v
retrieving revision 1.20
retrieving revision 1.16.42.4
diff -u -p -u -p -r1.20 -r1.16.42.4
--- sc/source/core/data/table3.cxx	15 Nov 2004 16:34:51 -0000	1.20
+++ sc/source/core/data/table3.cxx	21 Jan 2005 16:36:18 -0000	1.16.42.4
@@ -1090,7 +1090,7 @@ BOOL ScTable::ValidQuery(SCROW nRow, con
                         bOk = pTransliteration->isEqual( aCellStr, *rEntry.pStr );
 					else
 					{
-                        ::com::sun::star::uno::Sequence< long > xOff;
+                        ::com::sun::star::uno::Sequence< sal_Int32 > xOff;
                         String aCell( pTransliteration->transliterate(
                             aCellStr, ScGlobal::eLnge, 0, aCellStr.Len(),
                             &xOff ) );
Index: sc/source/core/tool/chartarr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chartarr.cxx,v
retrieving revision 1.13
retrieving revision 1.13.76.1
diff -u -p -u -p -r1.13 -r1.13.76.1
--- sc/source/core/tool/chartarr.cxx	20 Aug 2004 09:11:50 -0000	1.13
+++ sc/source/core/tool/chartarr.cxx	21 Jan 2005 16:37:52 -0000	1.13.76.1
@@ -93,14 +93,14 @@ void ScChartArray::CopySettings( SchMemC
 	rDest.SetYAxisTitle( rSource.GetYAxisTitle() );
 	rDest.SetZAxisTitle( rSource.GetZAxisTitle() );
 
-	const long* pArr;
+	sal_Int32* pArr;
 	if ( rSource.GetRowCount() == rDest.GetRowCount() &&
 		 rSource.GetColCount() == rDest.GetColCount() )
 	{
 		//	don't copy column/row number formats here (are set in new MemChart object)
 
-		if ( (pArr = rSource.GetRowTranslation()) ) rDest.SetRowTranslation( pArr );
-		if ( (pArr = rSource.GetColTranslation()) ) rDest.SetColTranslation( pArr );
+		if ( (pArr = (sal_Int32 *) rSource.GetRowTranslation()) ) rDest.SetRowTranslation( pArr );
+		if ( (pArr = (sal_Int32 *) rSource.GetColTranslation()) ) rDest.SetColTranslation( pArr );
 		rDest.SetTranslation( rSource.GetTranslation() );
 	}
 }
Index: sc/source/core/tool/rechead.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rechead.cxx,v
retrieving revision 1.2
retrieving revision 1.2.378.1
diff -u -p -u -p -r1.2 -r1.2.378.1
--- sc/source/core/tool/rechead.cxx	26 Mar 2003 18:04:18 -0000	1.2
+++ sc/source/core/tool/rechead.cxx	9 Sep 2004 11:02:24 -0000	1.2.378.1
@@ -217,7 +217,7 @@ ULONG ScMultipleReadHeader::BytesLeft() 
 
 // -----------------------------------------------------------------------
 
-ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault) :
+ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault) :
 	rStream( rNewStream ),
 	aMemStream( 4096, 4096 )
 {
Index: sc/source/filter/excel/excrecds.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/excrecds.cxx,v
retrieving revision 1.78
retrieving revision 1.76.82.2
diff -u -p -u -p -r1.78 -r1.76.82.2
--- sc/source/filter/excel/excrecds.cxx	21 Feb 2005 13:25:15 -0000	1.78
+++ sc/source/filter/excel/excrecds.cxx	9 Mar 2005 21:17:30 -0000	1.76.82.2
@@ -466,7 +466,7 @@ ExcBundlesheetBase::ExcBundlesheetBase()
 void ExcBundlesheetBase::UpdateStreamPos( XclExpStream& rStrm )
 {
 	rStrm.SetStreamPos( nOwnPos );
-	rStrm << nStrPos;
+	rStrm << (sal_uInt32)nStrPos;
 }
 
 
Index: sc/source/filter/excel/xiescher.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xiescher.cxx,v
retrieving revision 1.33
retrieving revision 1.30.6.2
diff -u -p -u -p -r1.33 -r1.30.6.2
--- sc/source/filter/excel/xiescher.cxx	21 Feb 2005 13:31:50 -0000	1.33
+++ sc/source/filter/excel/xiescher.cxx	9 Mar 2005 21:16:20 -0000	1.30.6.2
@@ -1532,7 +1532,7 @@ SdrObject* XclImpDffManager::ProcessObj(
             // automatic margin is handled by host
             if( GetPropertyBool( DFF_Prop_AutoTextMargin ) )
             {
-                long nMargin = EXC_ESCHER_AUTOMARGIN;
+                sal_Int32 nMargin = EXC_ESCHER_AUTOMARGIN;
                 ScaleEmu( nMargin );
                 pRetSdrObj->SetMergedItem( SdrTextLeftDistItem( nMargin ) );
                 pRetSdrObj->SetMergedItem( SdrTextRightDistItem( nMargin ) );
Index: sc/source/filter/excel/xlstyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xlstyle.cxx,v
retrieving revision 1.15
retrieving revision 1.10.54.4
diff -u -p -u -p -r1.15 -r1.10.54.4
--- sc/source/filter/excel/xlstyle.cxx	21 Feb 2005 13:35:22 -0000	1.15
+++ sc/source/filter/excel/xlstyle.cxx	9 Mar 2005 21:16:28 -0000	1.10.54.4
@@ -355,7 +355,7 @@ FontStrikeout XclFontData::GetScStrikeou
 
 void XclFontData::SetScHeight( sal_Int32 nTwips )
 {
-    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, 0x7FFFL ) );
+    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, (sal_Int32)0x7FFF ) );
 }
 
 void XclFontData::SetScFamily( FontFamily eScFamily )
Index: sc/source/filter/html/htmlpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/html/htmlpars.cxx,v
retrieving revision 1.24
retrieving revision 1.20.42.5
diff -u -p -u -p -r1.24 -r1.20.42.5
--- sc/source/filter/html/htmlpars.cxx	21 Feb 2005 13:36:40 -0000	1.24
+++ sc/source/filter/html/htmlpars.cxx	9 Mar 2005 21:09:11 -0000	1.20.42.5
@@ -192,7 +192,7 @@ ScHTMLLayoutParser::~ScHTMLLayoutParser(
 }
 
 
-ULONG ScHTMLLayoutParser::Read( SvStream& rStream, const String& rBaseURL )
+sal_uInt32 ScHTMLLayoutParser::Read( SvStream& rStream, const String& rBaseURL )
 {
     Link aOldLink = pEdit->GetImportHdl();
     pEdit->SetImportHdl( LINK( this, ScHTMLLayoutParser, HTMLImportHdl ) );
@@ -221,7 +221,7 @@ ULONG ScHTMLLayoutParser::Read( SvStream
         }
     }
 
-    ULONG nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_HTML, pAttributes );
+    sal_uInt32 nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_HTML, pAttributes );
 
     pEdit->SetImportHdl( aOldLink );
     // Spaltenbreiten erzeugen
@@ -2194,10 +2194,10 @@ void ScHTMLTable::DataOn( const ImportIn
             switch( aIter->GetToken() )
             {
                 case HTML_O_COLSPAN:
-                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_ROWSPAN:
-                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_SDVAL:
                     pValStr.reset( new String( aIter->GetString() ) );
@@ -2993,7 +2993,7 @@ void ScHTMLQueryParser::FontOn( const Im
             break;
             case HTML_O_SIZE :
             {
-                sal_uInt32 nSize = bound( aIter->GetNumber(), 1UL, SC_HTML_FONTSIZES );
+                sal_uInt32 nSize = bound( aIter->GetNumber(), (sal_uInt32)1, SC_HTML_FONTSIZES );
                 mpCurrTable->PutItem( SvxFontHeightItem( maFontHeights[ nSize - 1 ], 100, ATTR_FONT_HEIGHT ) );
             }
             break;
Index: sc/source/filter/inc/eeparser.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/eeparser.hxx,v
retrieving revision 1.4
retrieving revision 1.4.6.1
diff -u -p -u -p -r1.4 -r1.4.6.1
--- sc/source/filter/inc/eeparser.hxx	11 Jan 2005 13:17:58 -0000	1.4
+++ sc/source/filter/inc/eeparser.hxx	21 Jan 2005 16:41:18 -0000	1.4.6.1
@@ -184,7 +184,7 @@ public:
 						ScEEParser( EditEngine* );
 	virtual				~ScEEParser();
 
-    virtual ULONG       Read( SvStream&, const String& rBaseURL ) = 0;
+	virtual sal_uInt32		Read( SvStream&, const String& rBaseURL ) = 0;
 
 	void				GetDimensions( SCCOL& nCols, SCROW& nRows ) const
 							{ nCols = nColMax; nRows = nRowMax; }
Index: sc/source/filter/inc/htmlpars.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/htmlpars.hxx,v
retrieving revision 1.11
retrieving revision 1.11.6.1
diff -u -p -u -p -r1.11 -r1.11.6.1
--- sc/source/filter/inc/htmlpars.hxx	11 Jan 2005 13:18:25 -0000	1.11
+++ sc/source/filter/inc/htmlpars.hxx	21 Jan 2005 16:41:34 -0000	1.11.6.1
@@ -231,7 +231,7 @@ private:
 public:
                         ScHTMLLayoutParser( EditEngine*, const String& rBaseURL, const Size& aPageSize, ScDocument* );
     virtual             ~ScHTMLLayoutParser();
-    virtual ULONG       Read( SvStream&, const String& rBaseURL  );
+    virtual sal_uInt32       Read( SvStream&, const String& rBaseURL  );
     virtual const ScHTMLTable*  GetGlobalTable() const;
 };
 
Index: sc/source/filter/inc/rtfparse.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/rtfparse.hxx,v
retrieving revision 1.3
retrieving revision 1.3.6.1
diff -u -p -u -p -r1.3 -r1.3.6.1
--- sc/source/filter/inc/rtfparse.hxx	11 Jan 2005 13:18:39 -0000	1.3
+++ sc/source/filter/inc/rtfparse.hxx	21 Jan 2005 16:41:49 -0000	1.3.6.1
@@ -116,7 +116,7 @@ private:
 public:
 						ScRTFParser( EditEngine* );
 	virtual				~ScRTFParser();
-    virtual ULONG       Read( SvStream&, const String& rBaseURL );
+	virtual sal_uInt32		Read( SvStream&, const String& rBaseURL );
 };
 
 
Index: sc/source/filter/rtf/eeimpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/rtf/eeimpars.cxx,v
retrieving revision 1.12
retrieving revision 1.12.6.1
diff -u -p -u -p -r1.12 -r1.12.6.1
--- sc/source/filter/rtf/eeimpars.cxx	11 Jan 2005 13:18:53 -0000	1.12
+++ sc/source/filter/rtf/eeimpars.cxx	21 Jan 2005 16:42:00 -0000	1.12.6.1
@@ -252,7 +252,7 @@ void ScEEImport::WriteToDocument( BOOL b
 			// HTML
 			String aValStr, aNumStr;
 			double fVal;
-			ULONG nNumForm;
+			sal_uInt32 nNumForm;
 			LanguageType eNumLang;
 			if ( pE->pNumStr )
 			{	// SDNUM muss sein wenn SDVAL
Index: sc/source/filter/rtf/rtfparse.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/rtf/rtfparse.cxx,v
retrieving revision 1.4
retrieving revision 1.4.6.1
diff -u -p -u -p -r1.4 -r1.4.6.1
--- sc/source/filter/rtf/rtfparse.cxx	11 Jan 2005 13:19:20 -0000	1.4
+++ sc/source/filter/rtf/rtfparse.cxx	21 Jan 2005 16:42:09 -0000	1.4.6.1
@@ -119,11 +119,11 @@ ScRTFParser::~ScRTFParser()
 }
 
 
-ULONG ScRTFParser::Read( SvStream& rStream, const String& rBaseURL )
+sal_uInt32 ScRTFParser::Read( SvStream& rStream, const String& rBaseURL )
 {
 	Link aOldLink = pEdit->GetImportHdl();
 	pEdit->SetImportHdl( LINK( this, ScRTFParser, RTFImportHdl ) );
-    ULONG nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_RTF );
+	sal_uInt32 nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_RTF );
 	if ( nLastToken == RTF_PAR )
 	{
 		ScEEParseEntry* pE = pList->Last();
Index: sc/source/filter/xcl97/XclImpChangeTrack.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/XclImpChangeTrack.cxx,v
retrieving revision 1.26
retrieving revision 1.25.82.2
diff -u -p -u -p -r1.26 -r1.25.82.2
--- sc/source/filter/xcl97/XclImpChangeTrack.cxx	21 Feb 2005 13:49:20 -0000	1.26
+++ sc/source/filter/xcl97/XclImpChangeTrack.cxx	9 Mar 2005 21:19:48 -0000	1.25.82.2
@@ -169,7 +169,7 @@ void XclImpChangeTrack::DoInsertRange( c
 
 void XclImpChangeTrack::DoDeleteRange( const ScRange& rRange )
 {
-	sal_uInt32 nFirst, nLast;
+	ULONG nFirst, nLast;
 	pChangeTrack->AppendDeleteRange( rRange, NULL, nFirst, nLast );
 	DoAcceptRejectAction( nFirst, nLast );
 }
Index: sc/source/filter/xcl97/xcl97rec.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/xcl97rec.cxx,v
retrieving revision 1.76
retrieving revision 1.67.40.5
diff -u -p -u -p -r1.76 -r1.67.40.5
--- sc/source/filter/xcl97/xcl97rec.cxx	21 Feb 2005 13:50:03 -0000	1.76
+++ sc/source/filter/xcl97/xcl97rec.cxx	9 Mar 2005 21:19:29 -0000	1.67.40.5
@@ -284,7 +284,7 @@ ULONG XclMsodrawinggroup::GetLen() const
 
 // --- class XclMsodrawing --------------------------------------
 
-XclMsodrawing::XclMsodrawing( const XclExpRoot& rRoot, UINT16 nEscherType, UINT32 nInitialSize ) :
+XclMsodrawing::XclMsodrawing( const XclExpRoot& rRoot, UINT16 nEscherType, ULONG nInitialSize ) :
     XclMsodrawing_Base( *rRoot.GetOldRoot().pEscher, nInitialSize )
 {
 	if ( nEscherType )
@@ -590,7 +590,7 @@ void XclObjComment::ProcessEscherObj( co
 	pEx->OpenContainer( ESCHER_SpContainer );
 	pEx->AddShape( ESCHER_ShpInst_TextBox, SHAPEFLAG_HAVEANCHOR | SHAPEFLAG_HAVESPT );
     sal_uInt32 nFlags = 0x000A0000;
-    ::set_flag( nFlags, 2UL, !bVisible );
+    ::set_flag( nFlags, (sal_uInt32)2, !bVisible );
     aPropOpt.AddOpt( ESCHER_Prop_fPrint, nFlags );                  // bool field
 	aPropOpt.Commit( pEx->GetStream() );
 
Index: sc/source/ui/Accessibility/AccessibleCsvControl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleCsvControl.cxx,v
retrieving revision 1.16
retrieving revision 1.15.206.2
diff -u -p -u -p -r1.16 -r1.15.206.2
--- sc/source/ui/Accessibility/AccessibleCsvControl.cxx	23 Aug 2004 09:27:42 -0000	1.16
+++ sc/source/ui/Accessibility/AccessibleCsvControl.cxx	19 Oct 2004 13:27:42 -0000	1.15.206.2
@@ -407,7 +407,7 @@ sal_Int32 lcl_GetApiPos( sal_Int32 nRule
         nApiPos += nStart - nExp + 1;
         nExp *= 10;
     }
-    return ::std::max( nApiPos, 0L );
+    return ::std::max( nApiPos, (sal_Int32)0 );
 }
 
 /** Converts an API text index to a ruler cursor position. */
@@ -626,7 +626,7 @@ sal_Int32 SAL_CALL ScAccessibleCsvRuler:
     ensureAlive();
     ScCsvRuler& rRuler = implGetRuler();
     // #107054# use object's coordinate system, convert to API position
-    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), 0L ), rRuler.GetPosCount() ) );
+    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), (sal_Int32)0 ), rRuler.GetPosCount() ) );
 }
 
 OUString SAL_CALL ScAccessibleCsvRuler::getSelectedText() throw( RuntimeException )
Index: sc/source/ui/dbgui/csvgrid.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvgrid.cxx,v
retrieving revision 1.21
retrieving revision 1.19.42.3
diff -u -p -u -p -r1.21 -r1.19.42.3
--- sc/source/ui/dbgui/csvgrid.cxx	11 Oct 2004 12:28:48 -0000	1.21
+++ sc/source/ui/dbgui/csvgrid.cxx	18 Jan 2005 04:32:56 -0000	1.19.42.3
@@ -179,7 +179,7 @@ void ScCsvGrid::UpdateOffsetX()
     sal_Int32 nLastLine = GetLastVisLine() + 1;
     sal_Int32 nDigits = 2;
     while( nLastLine /= 10 ) ++nDigits;
-    nDigits = Max( nDigits, 3L );
+    nDigits = Max( nDigits, (sal_Int32)3 );
     Execute( CSVCMD_SETHDRWIDTH, GetTextWidth( String( '0' ) ) * nDigits );
 }
 
@@ -704,8 +704,8 @@ void ScCsvGrid::MoveCursor( sal_uInt32 n
     {
         sal_Int32 nPosBeg = GetColumnPos( nColIndex );
         sal_Int32 nPosEnd = GetColumnPos( nColIndex + 1 );
-        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, 0L );
-        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + 1L, nMinPos );
+        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, (sal_Int32)0 );
+        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + (sal_Int32)1, nMinPos );
         if( nPosBeg - CSV_SCROLL_DIST + 1 <= GetFirstVisPos() )
             Execute( CSVCMD_SETPOSOFFSET, nMinPos );
         else if( nPosEnd + CSV_SCROLL_DIST >= GetLastVisPos() )
@@ -787,7 +787,7 @@ void ScCsvGrid::ImplSetTextLineSep(
         pChar = ScImportExport::ScanNextFieldFromString( pChar, aCellText, cTextSep, pSepChars, bMergeSep );
 
         // update column width
-        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + 1L );
+        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + (sal_Int32)1 );
         if( IsValidColumn( nColIx ) )
         {
             // expand existing column
@@ -918,7 +918,7 @@ void ScCsvGrid::Tracking( const Tracking
 
         sal_Int32 nPos = (rMEvt.GetPosPixel().X() - GetFirstX()) / GetCharWidth() + GetFirstVisPos();
         // on mouse tracking: keep position valid
-        nPos = Max( Min( nPos, GetPosCount() - 1L ), 0L );
+        nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)0 );
         Execute( CSVCMD_MAKEPOSVISIBLE, nPos );
 
         sal_uInt32 nColIx = GetColumnFromPos( nPos );
@@ -1366,7 +1366,7 @@ void ScCsvGrid::ImplDrawTrackingRect( sa
     if( HasFocus() && IsVisibleColumn( nColIndex ) )
     {
         sal_Int32 nX1 = Max( GetColumnX( nColIndex ), GetFirstX() ) + 1;
-        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - 1L, GetLastX() );
+        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - (sal_Int32)1, GetLastX() );
         sal_Int32 nY2 = Min( GetY( GetLastVisLine() + 1 ), GetHeight() ) - 1;
         InvertTracking( Rectangle( nX1, 0, nX2, nY2 ), SHOWTRACK_SMALL | SHOWTRACK_WINDOW );
     }
Index: sc/source/ui/dbgui/csvruler.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvruler.cxx,v
retrieving revision 1.9
retrieving revision 1.9.378.1
diff -u -p -u -p -r1.9 -r1.9.378.1
--- sc/source/ui/dbgui/csvruler.cxx	26 Mar 2003 18:05:52 -0000	1.9
+++ sc/source/ui/dbgui/csvruler.cxx	9 Sep 2004 11:02:30 -0000	1.9.378.1
@@ -231,7 +231,7 @@ sal_Int32 ScCsvRuler::GetNoScrollPos( sa
         else if( nNewPos > GetLastVisPos() - CSV_SCROLL_DIST - 1L )
         {
             sal_Int32 nScroll = (GetFirstVisPos() < GetMaxPosOffset()) ? CSV_SCROLL_DIST : 0;
-            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - 1L );
+            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - (sal_Int32)1 );
         }
     }
     return nNewPos;
@@ -374,7 +374,7 @@ void ScCsvRuler::MouseMove( const MouseE
         if( IsTracking() )
         {
             // on mouse tracking: keep position valid
-            nPos = Max( Min( nPos, GetPosCount() - 1L ), 1L );
+            nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)1 );
             MoveMouseTracking( nPos );
         }
         else
@@ -513,7 +513,7 @@ void ScCsvRuler::ImplDrawArea( sal_Int32
 
     aRect = maActiveRect;
     aRect.Left() = Max( GetFirstX(), nPosX );
-    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - 1L );
+    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - (sal_Int32)1 );
     if( aRect.Left() <= aRect.Right() )
     {
         maBackgrDev.SetFillColor( maActiveColor );
Index: sc/source/ui/dbgui/csvtablebox.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvtablebox.cxx,v
retrieving revision 1.8
retrieving revision 1.7.378.2
diff -u -p -u -p -r1.8 -r1.7.378.2
--- sc/source/ui/dbgui/csvtablebox.cxx	23 Aug 2004 09:29:32 -0000	1.8
+++ sc/source/ui/dbgui/csvtablebox.cxx	19 Oct 2004 13:19:12 -0000	1.7.378.2
@@ -409,33 +409,33 @@ IMPL_LINK( ScCsvTableBox, CsvCmdHdl, ScC
     switch( eType )
     {
         case CSVCMD_SETPOSCOUNT:
-            maData.mnPosCount = Max( nParam1, 1L );
+            maData.mnPosCount = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETPOSOFFSET:
             ImplSetPosOffset( nParam1 );
         break;
         case CSVCMD_SETHDRWIDTH:
-            maData.mnHdrWidth = Max( nParam1, 0L );
+            maData.mnHdrWidth = Max( nParam1, (sal_Int32)0 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETCHARWIDTH:
-            maData.mnCharWidth = Max( nParam1, 1L );
+            maData.mnCharWidth = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETLINECOUNT:
-            maData.mnLineCount = Max( nParam1, 1L );
+            maData.mnLineCount = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEOFFSET:
             ImplSetLineOffset( nParam1 );
         break;
         case CSVCMD_SETHDRHEIGHT:
-            maData.mnHdrHeight = Max( nParam1, 0L );
+            maData.mnHdrHeight = Max( nParam1, (sal_Int32)0 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEHEIGHT:
-            maData.mnLineHeight = Max( nParam1, 1L );
+            maData.mnLineHeight = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_MOVERULERCURSOR:
Index: sc/source/ui/inc/csvtablebox.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/csvtablebox.hxx,v
retrieving revision 1.5
retrieving revision 1.4.484.2
diff -u -p -u -p -r1.5 -r1.4.484.2
--- sc/source/ui/inc/csvtablebox.hxx	23 Aug 2004 09:33:53 -0000	1.5
+++ sc/source/ui/inc/csvtablebox.hxx	19 Oct 2004 12:49:53 -0000	1.4.484.2
@@ -143,10 +143,10 @@ private:
 
     /** Calculates and sets valid position offset nearest to nPos. */
     SC_DLLPRIVATE inline void                 ImplSetPosOffset( sal_Int32 nPos )
-                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), 0L ); }
+                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), (sal_Int32)0 ); }
     /** Calculates and sets valid line offset nearest to nLine. */
     SC_DLLPRIVATE inline void                 ImplSetLineOffset( sal_Int32 nLine )
-                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), 0L ); }
+                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), (sal_Int32)0 ); }
     /** Moves controls (not cursors!) so that nPos becomes visible. */
     SC_DLLPRIVATE void                        MakePosVisible( sal_Int32 nPos );
 
Index: sc/source/ui/inc/viewdata.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/viewdata.hxx,v
retrieving revision 1.18
retrieving revision 1.14.42.4
diff -u -p -u -p -r1.18 -r1.14.42.4
--- sc/source/ui/inc/viewdata.hxx	21 Feb 2005 13:52:01 -0000	1.18
+++ sc/source/ui/inc/viewdata.hxx	9 Mar 2005 20:38:49 -0000	1.14.42.4
@@ -350,7 +350,7 @@ public:
 	BYTE			GetFillMode()				{ return nFillMode; }
 
 					// TRUE: Zelle ist zusammengefasst
-	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix );
+	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix );
 	BOOL			GetPosFromPixel( long nClickX, long nClickY, ScSplitPos eWhich,
 										SCsCOL& rPosX, SCsROW& rPosY,
 										BOOL bTestMerge = TRUE, BOOL bRepair = FALSE,
Index: sc/source/ui/view/gridwin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin.cxx,v
retrieving revision 1.67
retrieving revision 1.55.36.4
diff -u -p -u -p -r1.67 -r1.55.36.4
--- sc/source/ui/view/gridwin.cxx	15 Nov 2004 16:38:47 -0000	1.67
+++ sc/source/ui/view/gridwin.cxx	21 Jan 2005 16:46:06 -0000	1.55.36.4
@@ -604,8 +604,8 @@ void ScGridWindow::DoPageFieldMenue( SCC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -759,8 +759,8 @@ void ScGridWindow::DoScenarioMenue( cons
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -902,8 +902,8 @@ void ScGridWindow::DoAutoFilterMenue( SC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -1443,8 +1443,8 @@ BOOL ScGridWindow::TestMouse( const Mous
 				SCROW nY = aMarkRange.aEnd.Row();
 
 				Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 				aFillPos.X() += nSizeXPix * nLayoutSign;
 				aFillPos.Y() += nSizeYPix;
@@ -1726,8 +1726,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 		if (pAttr->HasAutoFilter())
 		{
 			Point	aScrPos  = pViewData->GetScrPos(nPosX,nPosY,eWhich);
-			long	nSizeX;
-			long	nSizeY;
+			sal_Int32	nSizeX;
+			sal_Int32	nSizeY;
 			Point	aDiffPix = aPos;
 
 			aDiffPix -= aScrPos;
@@ -1739,8 +1739,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 
 			//	Breite des Buttons ist nicht von der Zellhoehe abhaengig
 			Size aButSize = aComboButton.GetSizePixel();
-			long nButWidth  = Min( aButSize.Width(),  nSizeX );
-			long nButHeight = Min( aButSize.Height(), nSizeY );
+			long nButWidth  = Min( (sal_Int32)aButSize.Width(),  nSizeX );
+			long nButHeight = Min( (sal_Int32)aButSize.Height(), nSizeY );
 
 			if ( aDiffPix.X() >= nSizeX - nButWidth &&
 				 aDiffPix.Y() >= nSizeY - nButHeight )
@@ -2817,8 +2817,8 @@ void __EXPORT ScGridWindow::Command( con
 			SCCOL nCurX = pViewData->GetCurX();
 			SCROW nCurY = pViewData->GetCurY();
 			aMenuPos = pViewData->GetScrPos( nCurX, nCurY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nCurX, nCurY, nSizeXPix, nSizeYPix );
 			aMenuPos.X() += nSizeXPix;
 			aMenuPos.Y() += nSizeYPix;
@@ -4079,8 +4079,8 @@ void ScGridWindow::HideCursor()
 			SCROW nY = pViewData->GetCurY();
 
 			Point aScrPos = pViewData->GetScrPos( nX, nY, eWhich );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 			aScrPos.X() -= 2;
 			aScrPos.Y() -= 2;
@@ -4116,8 +4116,8 @@ void ScGridWindow::HideCursor()
 					SCCOL nAutoX = aAutoMarkPos.Col();
 					SCROW nAutoY = aAutoMarkPos.Row();
 					Point aFillPos = pViewData->GetScrPos( nAutoX, nAutoY, eWhich, TRUE );
-					long nSizeXPix;
-					long nSizeYPix;
+					sal_Int32 nSizeXPix;
+					sal_Int32 nSizeYPix;
 					pViewData->GetMergeSizePixel( nAutoX, nAutoY, nSizeXPix, nSizeYPix );
 					aFillPos.X() += nSizeXPix;
 					aFillPos.Y() += nSizeYPix;
@@ -4225,8 +4225,8 @@ BOOL ScGridWindow::HitRangeFinder( const
 //			Point aNext = pViewData->GetScrPos( nPosX+1, nPosY+1, eWhich );
 
 			Point aNext = pViewData->GetScrPos( nPosX, nPosY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nPosX, nPosY, nSizeXPix, nSizeYPix );
 			aNext.X() += nSizeXPix * nLayoutSign;
 			aNext.Y() += nSizeYPix;
@@ -4629,8 +4629,8 @@ BOOL ScGridWindow::GetEditUrlOrError( BO
     Size aPaperSize = Size( 1000000, 1000000 );
     if(pCell->GetCellType() == CELLTYPE_FORMULA)
     {
-        long nSizeX  = 0;
-        long nSizeY  = 0;
+        sal_Int32 nSizeX  = 0;
+        sal_Int32 nSizeY  = 0;
         pViewData->GetMergeSizePixel( nPosX, nPosY, nSizeX, nSizeY );
         aPaperSize = Size(nSizeX, nSizeY );
         aPaperSize = PixelToLogic(aPaperSize);
Index: sc/source/ui/view/gridwin4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin4.cxx,v
retrieving revision 1.26
retrieving revision 1.23.40.3
diff -u -p -u -p -r1.26 -r1.23.40.3
--- sc/source/ui/view/gridwin4.cxx	4 Oct 2004 20:23:40 -0000	1.26
+++ sc/source/ui/view/gridwin4.cxx	21 Jan 2005 16:46:26 -0000	1.23.40.3
@@ -1253,8 +1253,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 						}
 
                     bool bArrowState = bSimpleQuery && bColumnFound;
-					long	nSizeX;
-					long	nSizeY;
+					sal_Int32	nSizeX;
+					sal_Int32	nSizeY;
 
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					aComboButton.SetOptSizePixel();
@@ -1277,8 +1277,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 				if ( pInfo->bPushButton && !pInfo->bHOverlapped && !pInfo->bVOverlapped )
 				{
 					Point aScrPos = pViewData->GetScrPos( nCol, nRow, eWhich );
-					long nSizeX;
-					long nSizeY;
+					sal_Int32 nSizeX;
+					sal_Int32 nSizeY;
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					long nPosX = aScrPos.X();
 					long nPosY = aScrPos.Y();
@@ -1329,8 +1329,8 @@ Rectangle ScGridWindow::GetListValButton
     SCCOL nCol = rButtonPos.Col();
     SCROW nRow = rButtonPos.Row();
 
-    long nCellSizeX;    // width of this cell, including merged
-    long nDummy;
+    sal_Int32 nCellSizeX;    // width of this cell, including merged
+    sal_Int32 nDummy;
     pViewData->GetMergeSizePixel( nCol, nRow, nCellSizeX, nDummy );
 
     // for height, only the cell's row is used, excluding merged cells
@@ -1749,8 +1749,8 @@ void ScGridWindow::DrawCursor()
 		}
 		if ( bMaybeVisible )
 		{
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 
 			if ( bLayoutRTL )
@@ -1797,8 +1797,8 @@ void ScGridWindow::DrawAutoFillMark()
 		BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
 		Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-		long nSizeXPix;
-		long nSizeYPix;
+		sal_Int32 nSizeXPix;
+		sal_Int32 nSizeYPix;
 		pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 		if ( bLayoutRTL )
 			aFillPos.X() -= nSizeXPix + 3;
Index: sc/source/ui/view/tabview3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview3.cxx,v
retrieving revision 1.44
retrieving revision 1.37.40.3
diff -u -p -u -p -r1.44 -r1.37.40.3
--- sc/source/ui/view/tabview3.cxx	12 Oct 2004 10:28:29 -0000	1.44
+++ sc/source/ui/view/tabview3.cxx	18 Jan 2005 04:29:52 -0000	1.37.40.3
@@ -590,8 +590,8 @@ void ScTabView::TestHintWindow()
 				 aPos.X() < aWinSize.Width() && aPos.Y() < aWinSize.Height() )
 			{
 				aPos += pWin->GetPosPixel();								// Position auf Frame
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				aViewData.GetMergeSizePixel( nCol, nRow, nSizeXPix, nSizeYPix );
 
 				// HintWindow anlegen, bestimmt seine Groesse selbst
@@ -737,8 +737,8 @@ void ScTabView::AlignToCursor( SCsCOL nC
 		SCsCOL nSizeX = (SCsCOL) aViewData.VisibleCellsX(eAlignX);
 		SCsROW nSizeY = (SCsROW) aViewData.VisibleCellsY(eAlignY);
 
-		long nCellSizeX;
-		long nCellSizeY;
+		sal_Int32 nCellSizeX;
+		sal_Int32 nCellSizeY;
 		if ( nCurX >= 0 && nCurY >= 0 )
 			aViewData.GetMergeSizePixel( (SCCOL)nCurX, (SCROW)nCurY, nCellSizeX, nCellSizeY );
 		else
@@ -781,7 +781,7 @@ void ScTabView::AlignToCursor( SCsCOL nC
 						{
 							//	Cursor ist auf dem Bildschirm
 							Point aStart = aViewData.GetScrPos( nCurX, nCurY, eAlign );
-							long nCSX, nCSY;
+							sal_Int32 nCSX, nCSY;
 							aViewData.GetMergeSizePixel( nCurX, nCurY, nCSX, nCSY );
 							Rectangle aCursor( aStart, Size( nCSX, nCSY ) );
 							if ( aCursor.IsOver( aDlgPixel ) )
Index: sc/source/ui/view/viewdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewdata.cxx,v
retrieving revision 1.50
retrieving revision 1.45.42.4
diff -u -p -u -p -r1.50 -r1.45.42.4
--- sc/source/ui/view/viewdata.cxx	21 Feb 2005 13:55:14 -0000	1.50
+++ sc/source/ui/view/viewdata.cxx	9 Mar 2005 20:42:57 -0000	1.45.42.4
@@ -1637,7 +1637,7 @@ SCROW ScViewData::LastCellsY( ScVSplitPo
 	return CellsAtY( MAXROW+1, -1, eWhichY, SC_SIZE_NONE );
 }
 
-BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix )
+BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix )
 {
 	const ScMergeAttr* pMerge = (const ScMergeAttr*) pDoc->GetAttr( nX,nY,nTabNo, ATTR_MERGE );
 	if ( pMerge->GetColMerge() > 1 || pMerge->GetRowMerge() > 1 )
@@ -1789,8 +1789,8 @@ void ScViewData::GetMouseQuadrant( const
 	long nLayoutSign = bLayoutRTL ? -1 : 1;
 
 	Point aCellStart = GetScrPos( nPosX, nPosY, eWhich, TRUE );
-	long nSizeX;
-	long nSizeY;
+	sal_Int32 nSizeX;
+	sal_Int32 nSizeY;
 	GetMergeSizePixel( nPosX, nPosY, nSizeX, nSizeY );
 	rLeft = ( rClickPos.X() - aCellStart.X() ) * nLayoutSign <= nSizeX / 2;
 	rTop  = rClickPos.Y() - aCellStart.Y() <= nSizeY / 2;
Index: comphelper/inc/comphelper/basicio.hxx
===================================================================
RCS file: /cvs/util/comphelper/inc/comphelper/basicio.hxx,v
retrieving revision 1.2
retrieving revision 1.1.1.1.232.2
diff -u -p -u -p -r1.2 -r1.1.1.1.232.2
--- comphelper/inc/comphelper/basicio.hxx	16 Feb 2005 15:53:11 -0000	1.2
+++ comphelper/inc/comphelper/basicio.hxx	9 Mar 2005 18:20:21 -0000	1.1.1.1.232.2
@@ -102,10 +102,18 @@ COMPHELPER_DLLPUBLIC const staruno::Refe
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt32& _rValue);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt32 _nValue);
 
-// sal_Int16
+// sal_Int32
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int32& _rValue);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int32 _nValue);
 
+// sal_uInt64
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt64& _rValue);
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt64 _nValue);
+
+// sal_Int64
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int64& _rValue);
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int64 _nValue);
+
 // FontDescriptor
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& InStream, starawt::FontDescriptor& rVal);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& OutStream, const starawt::FontDescriptor& rVal);
Index: comphelper/source/streaming/basicio.cxx
===================================================================
RCS file: /cvs/util/comphelper/source/streaming/basicio.cxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.232.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.232.1
--- comphelper/source/streaming/basicio.cxx	29 Sep 2000 11:28:15 -0000	1.1.1.1
+++ comphelper/source/streaming/basicio.cxx	9 Sep 2004 11:07:59 -0000	1.1.1.1.232.1
@@ -193,8 +193,40 @@ const staruno::Reference<stario::XObject
 {
 	_rValue = _rxInStream->readLong();
 	return _rxInStream;
+
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt64 _nValue)
+{
+	_rxOutStream->writeLong(_nValue);
+	return _rxOutStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt64& _rValue)
+{
+	_rValue = _rxInStream->readLong();
+	return _rxInStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int64 _nValue)
+{
+	_rxOutStream->writeLong(_nValue);
+	return _rxOutStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int64& _rValue)
+{
+	_rValue = _rxInStream->readLong();
+	return _rxInStream;
 }
 
+
+
+
 //------------------------------------------------------------------------------
 const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int32 _nValue)
 {
