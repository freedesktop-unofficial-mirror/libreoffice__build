Index: psprint/inc/psprint/printergfx.hxx
===================================================================
RCS file: /cvs/gsl/psprint/inc/psprint/printergfx.hxx,v
retrieving revision 1.14
retrieving revision 1.13.42.2
diff -u -p -u -p -r1.14 -r1.13.42.2
--- psprint/inc/psprint/printergfx.hxx	8 Sep 2004 14:00:04 -0000	1.14
+++ psprint/inc/psprint/printergfx.hxx	18 Oct 2004 14:57:06 -0000	1.13.42.2
@@ -397,7 +397,7 @@ public:
     void            DrawPolyLine (sal_uInt32 nPoints, const Point* pPath );
     void            DrawPolygon  (sal_uInt32 nPoints, const Point* pPath);
     void            DrawPolyPolygon (sal_uInt32 nPoly, 
-                                     const sal_uInt32 *pPolygonSize, 
+                                     const unsigned long *pPolygonSize, 
                                      const Point** pPolygonList);
     void            DrawPolyLineBezier (sal_uInt32 nPoints, 
                                      const Point* pPath,
@@ -406,7 +406,7 @@ public:
                                      const Point* pPath,
                                      const BYTE* pFlgAry);
     void            DrawPolyPolygonBezier  (sal_uInt32 nPoly,
-                                     const sal_uInt32* pPoints, 
+                                     const unsigned long* pPoints, 
                                      const Point* const* pPtAry,
                                      const BYTE* const* pFlgAry);
 
Index: psprint/source/helper/helper.cxx
===================================================================
RCS file: /cvs/gsl/psprint/source/helper/helper.cxx,v
retrieving revision 1.20
retrieving revision 1.20.16.1
diff -u -p -u -p -r1.20 -r1.20.16.1
--- psprint/source/helper/helper.cxx	1 Jun 2004 08:58:42 -0000	1.20
+++ psprint/source/helper/helper.cxx	6 Oct 2004 12:15:23 -0000	1.20.16.1
@@ -59,9 +59,10 @@
  *
  ************************************************************************/
 
-#include <cstring>
+#include <string.h>
 #include <sys/stat.h>
 #include <unistd.h>
+#include <limits.h>
 
 #include <psprint/helper.hxx>
 #include <tools/string.hxx>
Index: psprint/source/printergfx/bitmap_gfx.cxx
===================================================================
RCS file: /cvs/gsl/psprint/source/printergfx/bitmap_gfx.cxx,v
retrieving revision 1.8
retrieving revision 1.8.26.1
diff -u -p -u -p -r1.8 -r1.8.26.1
--- psprint/source/printergfx/bitmap_gfx.cxx	17 Mar 2004 10:51:59 -0000	1.8
+++ psprint/source/printergfx/bitmap_gfx.cxx	6 Oct 2004 11:45:35 -0000	1.8.26.1
@@ -69,6 +69,8 @@
 #include <psputil.hxx>
 #endif
 
+#include <string.h>
+
 namespace psp {
 
 const sal_uInt32 nLineLength = 80;
Index: psprint/source/printergfx/common_gfx.cxx
===================================================================
RCS file: /cvs/gsl/psprint/source/printergfx/common_gfx.cxx,v
retrieving revision 1.15
retrieving revision 1.15.16.1
diff -u -p -u -p -r1.15 -r1.15.16.1
--- psprint/source/printergfx/common_gfx.cxx	18 May 2004 10:46:21 -0000	1.15
+++ psprint/source/printergfx/common_gfx.cxx	10 Sep 2004 15:37:42 -0000	1.15.16.1
@@ -526,7 +526,7 @@ PrinterGfx::DrawPolygon (sal_uInt32 nPoi
 }
 
 void
-PrinterGfx::DrawPolyPolygon (sal_uInt32 nPoly, const sal_uInt32* pSizes, const Point** pPaths )
+PrinterGfx::DrawPolyPolygon (sal_uInt32 nPoly, const unsigned long* pSizes, const Point** pPaths )
 {
     // sanity check
     if ( !nPoly || !pPaths || !(maFillColor.Is() || maLineColor.Is()))
@@ -707,7 +707,7 @@ PrinterGfx::DrawPolygonBezier (sal_uInt3
 }
 
 void
-PrinterGfx::DrawPolyPolygonBezier (sal_uInt32 nPoly, const sal_uInt32 * pPoints, const Point* const * pPtAry, const BYTE* const* pFlgAry)
+PrinterGfx::DrawPolyPolygonBezier (sal_uInt32 nPoly, const unsigned long * pPoints, const Point* const * pPtAry, const BYTE* const* pFlgAry)
 {
     const sal_uInt32 nBezString = 1024;
     sal_Char pString[nBezString];
Index: extensions/source/bibliography/datman.hxx
===================================================================
RCS file: /cvs/util/extensions/source/bibliography/datman.hxx,v
retrieving revision 1.12
retrieving revision 1.11.6.2
diff -u -p -u -p -r1.12 -r1.11.6.2
--- extensions/source/bibliography/datman.hxx	5 Jan 2005 12:41:49 -0000	1.12
+++ extensions/source/bibliography/datman.hxx	17 Jan 2005 21:46:44 -0000	1.11.6.2
@@ -232,7 +232,7 @@ public:
 		void						saveCtrModel(const ::rtl::OUString& rName,
 													const ::com::sun::star::uno::Reference< ::com::sun::star::awt::XControlModel > & rCtrModel);
 
-		sal_Bool 						moveRelative(long nMove);
+		sal_Bool 						moveRelative(sal_Int32 nMove);
 
 		void						CreateMappingDialog(Window* pParent);
         ::rtl::OUString             CreateDBChangeDialog(Window* pParent);
Index: extensions/source/plugin/base/xplugin.cxx
===================================================================
RCS file: /cvs/util/extensions/source/plugin/base/xplugin.cxx,v
retrieving revision 1.16
retrieving revision 1.15.72.2
diff -u -p -u -p -r1.16 -r1.15.72.2
--- extensions/source/plugin/base/xplugin.cxx	21 Jan 2005 13:43:33 -0000	1.16
+++ extensions/source/plugin/base/xplugin.cxx	9 Mar 2005 16:02:51 -0000	1.15.72.2
@@ -117,7 +117,7 @@ void PluginDisposer::onShot()
     {
         if( m_pPlugin->isDisposable() )
         {
-            sal_uInt32 nEvent;
+            ULONG nEvent;
             Application::PostUserEvent( nEvent, LINK( m_pPlugin, XPlugin_Impl, secondLevelDispose ), (void*)m_pPlugin );
         }
     }
Index: extensions/source/plugin/unx/npnapi.cxx
===================================================================
RCS file: /cvs/util/extensions/source/plugin/unx/npnapi.cxx,v
retrieving revision 1.7
retrieving revision 1.7.62.1
diff -u -p -u -p -r1.7 -r1.7.62.1
--- extensions/source/plugin/unx/npnapi.cxx	13 Oct 2004 09:03:01 -0000	1.7
+++ extensions/source/plugin/unx/npnapi.cxx	21 Jan 2005 16:21:53 -0000	1.7.62.1
@@ -23,7 +23,7 @@ void* CreateNewShell( void**, XLIB_Windo
 // begin Netscape plugin api calls
 extern "C" {
 
-static void* l_NPN_MemAlloc( UINT32 nBytes )
+static void* l_NPN_MemAlloc( uint32 nBytes )
 {
 	void* pMem = new char[nBytes];
     return pMem;
@@ -34,7 +34,7 @@ static void l_NPN_MemFree( void* pMem )
     delete [] (char*)pMem;
 }
     
-static UINT32 l_NPN_MemFlush( UINT32 nSize )
+static uint32 l_NPN_MemFlush( uint32 nSize )
 {
     return 0;
 }
@@ -165,7 +165,7 @@ static NPError l_NPN_NewStream( NPP inst
 	return aRet;
 }
 
-static NPError l_NPN_PostURLNotify( NPP instance, const char* url, const char* target, UINT32 len, const char* buf, NPBool file, void* notifyData )
+static NPError l_NPN_PostURLNotify( NPP instance, const char* url, const char* target, uint32 len, const char* buf, NPBool file, void* notifyData )
 {
 	UINT32 nInstance = pConnector->GetNPPID( instance );
     if( nInstance == PluginConnector::UnknownNPPID )
@@ -190,7 +190,7 @@ static NPError l_NPN_PostURLNotify( NPP 
 	return aRet;
 }
 
-static NPError l_NPN_PostURL( NPP instance, const char* url, const char* window, UINT32 len, const char* buf, NPBool file )
+static NPError l_NPN_PostURL( NPP instance, const char* url, const char* window, uint32 len, const char* buf, NPBool file )
 {
 	UINT32 nInstance = pConnector->GetNPPID( instance );
     if( nInstance == PluginConnector::UnknownNPPID )
Index: extensions/source/propctrlr/browserlistbox.hxx
===================================================================
RCS file: /cvs/util/extensions/source/propctrlr/browserlistbox.hxx,v
retrieving revision 1.6
retrieving revision 1.5.72.2
diff -u -p -u -p -r1.6 -r1.5.72.2
--- extensions/source/propctrlr/browserlistbox.hxx	16 Nov 2004 12:01:00 -0000	1.6
+++ extensions/source/propctrlr/browserlistbox.hxx	17 Jan 2005 22:02:50 -0000	1.5.72.2
@@ -122,7 +122,7 @@ namespace pcr
 				void						UpdatePlayGround();
 				void						UpdateVScroll();
 				void						ShowEntry(sal_uInt16 nPos);
-				void						MoveThumbTo(long nNewThumbPos);
+				void						MoveThumbTo(sal_Int32 nNewThumbPos);
 				void						Resize();
 
 
Index: extensions/source/scanner/grid.cxx
===================================================================
RCS file: /cvs/util/extensions/source/scanner/grid.cxx,v
retrieving revision 1.3
retrieving revision 1.3.116.1
diff -u -p -u -p -r1.3 -r1.3.116.1
--- extensions/source/scanner/grid.cxx	27 Oct 2003 13:21:34 -0000	1.3
+++ extensions/source/scanner/grid.cxx	21 Jan 2005 16:22:16 -0000	1.3.116.1
@@ -63,7 +63,7 @@
 #include <cmath>
 #include <grid.hxx>
 
-ResId SaneResId( ULONG );
+ResId SaneResId( sal_uInt32 );
 
 /***********************************************************************
  *
Index: extensions/source/scanner/sanedlg.cxx
===================================================================
RCS file: /cvs/util/extensions/source/scanner/sanedlg.cxx,v
retrieving revision 1.8
retrieving revision 1.8.74.1
diff -u -p -u -p -r1.8 -r1.8.74.1
--- extensions/source/scanner/sanedlg.cxx	26 Feb 2004 13:12:12 -0000	1.8
+++ extensions/source/scanner/sanedlg.cxx	21 Jan 2005 16:22:34 -0000	1.8.74.1
@@ -74,7 +74,7 @@
 #define USE_SAVE_STATE
 #undef  SAVE_ALL_STATES
 
-ResId SaneResId( ULONG nID )
+ResId SaneResId( sal_uInt32 nID )
 {
 	static ResMgr* pResMgr = ResMgr::CreateResMgr( "san" MAKE_NUMSTR(SUPD) );
 	return ResId( nID, pResMgr );
Index: extensions/source/svg/svgaction.cxx
===================================================================
RCS file: /cvs/util/extensions/source/svg/svgaction.cxx,v
retrieving revision 1.7
retrieving revision 1.7.100.2
diff -u -p -u -p -r1.7 -r1.7.100.2
--- extensions/source/svg/svgaction.cxx	6 Jan 2004 12:41:25 -0000	1.7
+++ extensions/source/svg/svgaction.cxx	21 Jan 2005 16:22:53 -0000	1.7.100.2
@@ -802,7 +802,7 @@ void SVGActionWriter::ImplWriteGradientE
 // -----------------------------------------------------------------------------
 
 void SVGActionWriter::ImplWriteText( const Point& rPos, const String& rText, 
-									 const long* pDXArray, long nWidth,
+									 const sal_Int32* pDXArray, long nWidth,
 									 const NMSP_RTL::OUString* pStyle )
 {
 	String	aText( rText ); aText.EraseLeadingChars( ' ' );
@@ -811,19 +811,19 @@ void SVGActionWriter::ImplWriteText( con
 	if( nLen )
 	{
 		Size	aNormSize;
-		long*	pOwnArray;
-		long*	pDX;
+		sal_Int32*	pOwnArray;
+		sal_Int32*	pDX;
 
 		// get text sizes
 		if( pDXArray )
 		{
 			pOwnArray = NULL;
 			aNormSize = Size( mpVDev->GetTextWidth( aText ), 0 );
-			pDX = (long*) pDXArray;
+			pDX = const_cast< sal_Int32* >( pDXArray );
 		}
 		else
 		{	
-			pOwnArray = new long[ nLen ];
+			pOwnArray = new sal_Int32[ nLen ];
 			aNormSize = Size( mpVDev->GetTextArray( aText, pOwnArray ), 0 );
 			pDX = pOwnArray;
 		}
Index: extensions/source/svg/svgaction.hxx
===================================================================
RCS file: /cvs/util/extensions/source/svg/svgaction.hxx,v
retrieving revision 1.2
retrieving revision 1.2.346.1
diff -u -p -u -p -r1.2 -r1.2.346.1
--- extensions/source/svg/svgaction.hxx	22 Mar 2001 17:49:17 -0000	1.2
+++ extensions/source/svg/svgaction.hxx	9 Sep 2004 09:55:21 -0000	1.2.346.1
@@ -168,7 +168,7 @@ private:
 	void					ImplWritePolygon( const Polygon& rPoly, sal_Bool bLineOnly, const NMSP_RTL::OUString* pStyle = NULL );
 	void					ImplWritePolyPolygon( const PolyPolygon& rPolyPoly, sal_Bool bLineOnly, const NMSP_RTL::OUString* pStyle = NULL );
 	void					ImplWriteGradientEx( const PolyPolygon& rPolyPoly, const Gradient& rGradient, const NMSP_RTL::OUString* pStyle = NULL );
-	void					ImplWriteText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth, const NMSP_RTL::OUString* pStyle = NULL );
+	void					ImplWriteText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth, const NMSP_RTL::OUString* pStyle = NULL );
 	void					ImplWriteBmp( const BitmapEx& rBmpEx, const Point& rPt, const Size& rSz, const Point& rSrcPt, const Size& rSrcSz, const NMSP_RTL::OUString* pStyle = NULL );
 
 	void					ImplCheckFontAttributes();
Index: extensions/source/svg/svgprinter.cxx
===================================================================
RCS file: /cvs/util/extensions/source/svg/svgprinter.cxx,v
retrieving revision 1.5
retrieving revision 1.5.48.1
diff -u -p -u -p -r1.5 -r1.5.48.1
--- extensions/source/svg/svgprinter.cxx	3 May 2004 13:53:06 -0000	1.5
+++ extensions/source/svg/svgprinter.cxx	21 Jan 2005 16:23:07 -0000	1.5.48.1
@@ -106,7 +106,7 @@ protected:
 	virtual void			_ExportAutoStyles() {}
 	virtual void			_ExportContent() {}
 	virtual void			_ExportMasterStyles() {}
-	virtual ULONG			exportDoc( enum ::xmloff::token::XMLTokenEnum eClass = ::xmloff::token::XML_TOKEN_INVALID ) { return 0; }
+	virtual sal_uInt32		exportDoc( enum ::xmloff::token::XMLTokenEnum eClass = ::xmloff::token::XML_TOKEN_INVALID ) { return 0; }
 							
 public:						
 							
Index: extensions/source/svg/svgwriter.cxx
===================================================================
RCS file: /cvs/util/extensions/source/svg/svgwriter.cxx,v
retrieving revision 1.5
retrieving revision 1.5.48.1
diff -u -p -u -p -r1.5 -r1.5.48.1
--- extensions/source/svg/svgwriter.cxx	3 May 2004 13:53:17 -0000	1.5
+++ extensions/source/svg/svgwriter.cxx	21 Jan 2005 16:23:24 -0000	1.5.48.1
@@ -80,7 +80,7 @@ protected:
 	virtual void			_ExportAutoStyles() {}
 	virtual void			_ExportContent() {}
 	virtual void			_ExportMasterStyles() {}
-	virtual ULONG			exportDoc( enum ::xmloff::token::XMLTokenEnum eClass ) { return 0; }
+	virtual sal_uInt32		exportDoc( enum ::xmloff::token::XMLTokenEnum eClass ) { return 0; }
 							
 public:						
 							
Index: framework/inc/recording/dispatchrecorder.hxx
===================================================================
RCS file: /cvs/framework/framework/inc/recording/dispatchrecorder.hxx,v
retrieving revision 1.6
retrieving revision 1.6.222.1
diff -u -p -u -p -r1.6 -r1.6.222.1
--- framework/inc/recording/dispatchrecorder.hxx	25 Mar 2003 18:19:49 -0000	1.6
+++ framework/inc/recording/dispatchrecorder.hxx	21 Jul 2004 18:34:36 -0000	1.6.222.1
@@ -126,9 +126,9 @@ class DispatchRecorder
 
 	virtual sal_Int32 SAL_CALL getCount() throw (::com::sun::star::uno::RuntimeException);
 
-	virtual com::sun::star::uno::Any SAL_CALL getByIndex(long int)  throw (com::sun::star::uno::RuntimeException, com::sun::star::lang::WrappedTargetException, com::sun::star::lang::IndexOutOfBoundsException);
+	virtual com::sun::star::uno::Any SAL_CALL getByIndex(sal_Int32)  throw (com::sun::star::uno::RuntimeException, com::sun::star::lang::WrappedTargetException, com::sun::star::lang::IndexOutOfBoundsException);
 
-	virtual void SAL_CALL replaceByIndex(long int, const com::sun::star::uno::Any&)  throw (::com::sun::star::lang::IllegalArgumentException, ::com::sun::star::lang::IndexOutOfBoundsException, ::com::sun::star::lang::WrappedTargetException, ::com::sun::star::uno::RuntimeException);
+	virtual void SAL_CALL replaceByIndex(sal_Int32, const com::sun::star::uno::Any&)  throw (::com::sun::star::lang::IllegalArgumentException, ::com::sun::star::lang::IndexOutOfBoundsException, ::com::sun::star::lang::WrappedTargetException, ::com::sun::star::uno::RuntimeException);
 
     // private functions
     private:
Index: framework/inc/services/documentproperties.hxx
===================================================================
RCS file: /cvs/framework/framework/inc/services/documentproperties.hxx,v
retrieving revision 1.7
retrieving revision 1.7.22.1
diff -u -p -u -p -r1.7 -r1.7.22.1
--- framework/inc/services/documentproperties.hxx	8 Sep 2004 14:06:37 -0000	1.7
+++ framework/inc/services/documentproperties.hxx	21 Jan 2005 15:29:49 -0000	1.7.22.1
@@ -726,7 +726,8 @@ class DocumentProperties	:	public css::l
 		void impl_writeToStream( SvStream& aStream,	const	sal_uInt16&						nValue									);
 		void impl_writeToStream( SvStream& aStream,	const	sal_Int32&						nValue  								);
 		void impl_writeToStream( SvStream& aStream,	const	sal_uInt32&						nValue  								);
-
+		void impl_writeToStream( SvStream& aStream,	const	sal_Int64&						nValue  								);
+		void impl_writeToStream( SvStream& aStream,	const	sal_uInt64&						nValue  								);
 		/*-****************************************************************************************************//**
 			@short		convert a format-ID to right MIMEType
 			@descr		Use "aStaticConvertTable[]" to do that!
Index: framework/source/layoutmanager/layoutmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/layoutmanager/layoutmanager.cxx,v
retrieving revision 1.24
retrieving revision 1.16.14.2
diff -u -p -u -p -r1.24 -r1.16.14.2
--- framework/source/layoutmanager/layoutmanager.cxx	4 Mar 2005 00:14:17 -0000	1.24
+++ framework/source/layoutmanager/layoutmanager.cxx	9 Mar 2005 16:23:01 -0000	1.16.14.2
@@ -1499,7 +1499,7 @@ void LayoutManager::implts_findNextDocki
     sal_Int32 nFreeRowColPixelPos( 0 );
     sal_Int32 nMaxSpace( 0 );
     sal_Int32 nNeededSpace( 0 );
-    sal_Int32 nTopDockingAreaSize( 0 );
+    long nTopDockingAreaSize( 0 );
     sal_Bool  bFoundRowColumn( sal_False );
 
     if (( DockingArea == DockingArea_DOCKINGAREA_TOP ) ||
@@ -2016,7 +2016,7 @@ void LayoutManager::implts_getDockingAre
         return rMovedElementRect;
     else
     {
-        sal_Int32 nSpace( 0 );
+        long nSpace( 0 );
         ::Rectangle aFrontDockingRect( rMovedElementRect );
         for ( sal_uInt32 i = 0; i < aRowColumnWindowData.aRowColumnWindows.size(); i++ )
         {
@@ -2164,11 +2164,11 @@ LayoutManager::implts_determineDockingOp
     sal_Bool bHorizontalDockArea( ( eDockingArea == DockingArea_DOCKINGAREA_TOP ) ||
                                   ( eDockingArea == DockingArea_DOCKINGAREA_BOTTOM ));
 
-    sal_Int32 nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
-    sal_Int32 nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
+    long nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
+    long nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
 
     ::Size  aStatusBarSize( implts_getStatusBarSize() );
-    sal_Int32 nMaxLeftRightDockAreaSize = rContainerWinSize.Height() -
+    long nMaxLeftRightDockAreaSize = rContainerWinSize.Height() -
                                           nTopDockingAreaSize -
                                           nBottomDockingAreaSize -
                                           aStatusBarSize.Height();
@@ -2176,13 +2176,12 @@ LayoutManager::implts_determineDockingOp
     ::Rectangle aTrackingRect( rTrackingRect );
     if ( bHorizontalDockArea )
     {
-        sal_Int32 nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
+        long nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
         if (( nPosX + rTrackingRect.getWidth()) > rContainerWinSize.Width() )
             nPosX = std::min( nPosX,
-                                std::max( sal_Int32( rContainerWinSize.Width() - rTrackingRect.getWidth() ),
-                                          sal_Int32( 0 )));
+                                std::max( rContainerWinSize.Width() - rTrackingRect.getWidth() , 0L ));
 
-        sal_Int32 nSize = std::min( rContainerWinSize.Width(), rTrackingRect.getWidth() );
+        long nSize = std::min( rContainerWinSize.Width(), rTrackingRect.getWidth() );
 
         aTrackingRect.SetPos( ::Point( nPosX, rRowColumnRect.Top() ));
         aTrackingRect.setWidth( nSize );
@@ -2194,16 +2193,15 @@ LayoutManager::implts_determineDockingOp
     }
     else
     {
-        sal_Int32 nMaxDockingAreaHeight = std::max( sal_Int32( 0 ),
-                                                    sal_Int32( nMaxLeftRightDockAreaSize ));
+        long nMaxDockingAreaHeight = std::max( 0L, nMaxLeftRightDockAreaSize );
 
-        sal_Int32 nPosY( std::max( sal_Int32( aTrackingRect.Top()), sal_Int32( nTopDockingAreaSize )));
+        long nPosY( std::max( aTrackingRect.Top(), nTopDockingAreaSize ));
         if (( nPosY + aTrackingRect.getHeight()) > ( nTopDockingAreaSize + nMaxDockingAreaHeight ))
             nPosY = std::min( nPosY,
-                                std::max( sal_Int32( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() )),
-                                        sal_Int32( nTopDockingAreaSize )));
+                                std::max( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() ),
+                                          nTopDockingAreaSize ));
 
-        sal_Int32 nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
+        long nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
 
         aTrackingRect.SetPos( ::Point( rRowColumnRect.Left(), nPosY ));
         aTrackingRect.setWidth( rRowColumnRect.getWidth() );
@@ -2278,12 +2276,12 @@ void LayoutManager::implts_calcDockingPo
     Reference< css::awt::XWindow >          xDockingAreaWindow;
     ::Rectangle                             aTrackingRect( rTrackingRect );
     ::com::sun::star::ui::DockingArea eDockedArea( (::com::sun::star::ui::DockingArea)rUIElement.m_aDockedData.m_nDockedArea );
-    sal_Int32                               nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
-    sal_Int32                               nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
+    long                               nTopDockingAreaSize( implts_getTopBottomDockingAreaSizes().Width() );
+    long                               nBottomDockingAreaSize( implts_getTopBottomDockingAreaSizes().Height() );
     sal_Bool                                bHorizontalDockArea( ( eDockedArea == DockingArea_DOCKINGAREA_TOP ) ||
                                                                  ( eDockedArea == DockingArea_DOCKINGAREA_BOTTOM ));
     ::Size                                  aStatusBarSize( implts_getStatusBarSize() );
-    sal_Int32                               nMaxLeftRightDockAreaSize = aContainerWinSize.Height() -
+    long                               nMaxLeftRightDockAreaSize = aContainerWinSize.Height() -
                                                                         nTopDockingAreaSize -
                                                                         nBottomDockingAreaSize -
                                                                         aStatusBarSize.Height();
@@ -2378,8 +2376,7 @@ void LayoutManager::implts_calcDockingPo
                     {
                         if ( bHorizontalDockArea )
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32( aContainerWinSize.Width() -  aWindowRect.Left() ),
-                                                                                    sal_Int32( aTrackingRect.getWidth() )));
+                            long nSize = ::std::max( 0L, std::min( aContainerWinSize.Width() -  aWindowRect.Left(), aTrackingRect.getWidth() ));
                             if ( nSize == 0 )
                                 nSize = aWindowRect.getWidth();
 
@@ -2392,9 +2389,8 @@ void LayoutManager::implts_calcDockingPo
                         }
                         else
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32(
-                                                    nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Top() ),
-                                                    sal_Int32( aTrackingRect.getHeight() )));
+                            long nSize = ::std::max( 0L, std::min( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Top(),
+                                                    aTrackingRect.getHeight() ));
                             if ( nSize == 0 )
                                 nSize = aWindowRect.getHeight();
 
@@ -2415,8 +2411,7 @@ void LayoutManager::implts_calcDockingPo
                     {
                         if ( bHorizontalDockArea )
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32(( aContainerWinSize.Width() ) - aWindowRect.Right() ),
-                                                                                    sal_Int32( aTrackingRect.getWidth() )));
+                            long nSize = ::std::max( 0L, std::min( aContainerWinSize.Width() - aWindowRect.Right(), aTrackingRect.getWidth() ));
                             if ( nSize == 0 )
                             {
                                 aUIElementRect.SetPos( ::Point( aContainerWinSize.Width() - aTrackingRect.getWidth(), aWindowRect.Top() ));
@@ -2435,8 +2430,8 @@ void LayoutManager::implts_calcDockingPo
                         }
                         else
                         {
-                            sal_Int32 nSize = ::std::max( sal_Int32( 0 ), std::min( sal_Int32( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Bottom() ),
-                                                                                    sal_Int32( aTrackingRect.getHeight() )));
+                            long nSize = ::std::max( 0L, std::min( nTopDockingAreaSize + nMaxLeftRightDockAreaSize - aWindowRect.Bottom(),
+                                                                  aTrackingRect.getHeight() ));
                             aUIElementRect.SetPos( ::Point( aWindowRect.Left(), aWindowRect.Bottom() ));
                             aUIElementRect.SetSize( ::Size( aWindowRect.getWidth(), nSize ));
 
@@ -2532,14 +2527,12 @@ void LayoutManager::implts_calcDockingPo
 
         if ( bHorizontalDockArea )
         {
-            sal_Int32 nPosX( std::max( sal_Int32( rTrackingRect.Left()), sal_Int32( 0 )));
+            long nPosX( std::max( rTrackingRect.Left(), 0L ));
             if (( nPosX + rTrackingRect.getWidth()) > aContainerWinSize.Width() )
-                nPosX = std::min( nPosX,
-                                std::max( sal_Int32( aContainerWinSize.Width() - rTrackingRect.getWidth() ),
-                                          sal_Int32( 0 )));
+                nPosX = std::min( nPosX, std::max( aContainerWinSize.Width() - rTrackingRect.getWidth(), 0L ));
 
-            sal_Int32 nSize = std::min( aContainerWinSize.Width(), rTrackingRect.getWidth() );
-            sal_Int32 nDockHeight = std::max( aDockingAreaRect.getHeight(), sal_Int32( 0 ));
+            long nSize = std::min( aContainerWinSize.Width(), rTrackingRect.getWidth() );
+            long nDockHeight = std::max( aDockingAreaRect.getHeight(), 0L );
             if ( nDockHeight == 0 )
             {
                 sal_Int32 nPosY( std::max( aDockingAreaRect.Top(), aDockingAreaRect.Bottom() ));
@@ -2577,17 +2570,16 @@ void LayoutManager::implts_calcDockingPo
         }
         else
         {
-            sal_Int32 nMaxDockingAreaHeight = std::max( sal_Int32( 0 ),
-                                                        sal_Int32( nMaxLeftRightDockAreaSize ));
+            long nMaxDockingAreaHeight = std::max( 0L, nMaxLeftRightDockAreaSize );
 
-            sal_Int32 nPosY( std::max( sal_Int32( aTrackingRect.Top()), sal_Int32( nTopDockingAreaSize )));
+            long nPosY( std::max( aTrackingRect.Top(), nTopDockingAreaSize ) );
             if (( nPosY + aTrackingRect.getHeight()) > ( nTopDockingAreaSize + nMaxDockingAreaHeight ))
                 nPosY = std::min( nPosY,
-                                std::max( sal_Int32( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() )),
-                                        sal_Int32( nTopDockingAreaSize )));
+                                std::max( nTopDockingAreaSize + ( nMaxDockingAreaHeight - aTrackingRect.getHeight() ),
+                                          nTopDockingAreaSize ));
 
-            sal_Int32 nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
-            sal_Int32 nDockWidth = std::max( aDockingAreaRect.getWidth(), sal_Int32( 0 ));
+            long nSize = std::min( nMaxDockingAreaHeight, aTrackingRect.getHeight() );
+            long nDockWidth = std::max( aDockingAreaRect.getWidth(), 0L );
             if ( nDockWidth == 0 )
             {
                 sal_Int32 nPosX( std::max( aDockingAreaRect.Left(), aDockingAreaRect.Right() ));
@@ -4821,7 +4813,7 @@ void LayoutManager::implts_doLayout( sal
             // Position the status bar
             if ( aStatusBarSize.Height() > 0 )
             {
-                implts_setStatusBarPosSize( ::Point( 0, std::max(( aContainerSize.Height() ), sal_Int32( 0 ))),
+                implts_setStatusBarPosSize( ::Point( 0, std::max(( (sal_Int32) aContainerSize.Height() ), sal_Int32( 0 ))),
                                             ::Size( aContainerSize.Width(),aStatusBarSize.Height() ));
             }
 
@@ -4871,8 +4863,8 @@ void LayoutManager::implts_calcWindowPos
 {
     sal_Int32   nDiff( 0 );
     sal_Int32   nSpace( rRowColumnWindowData.nSpace );
-    sal_Int32   nTopDockingAreaSize;
-    sal_Int32   nBottomDockingAreaSize;
+    long        nTopDockingAreaSize;
+    long        nBottomDockingAreaSize;
     sal_Int32   nContainerClientSize;
 
     if ( rRowColumnWindowData.aRowColumnWindows.size() == 0 )
@@ -5214,7 +5206,7 @@ void LayoutManager::implts_setDockingAre
                                                                   aRectangle.Height - aInfo.TopInset  - aInfo.BottomInset );
     ::Size               aStatusBarSize         = implts_getStatusBarSize();
 
-    sal_Int32 nLeftRightDockingAreaHeight( aContainerClientSize.Height );
+    long nLeftRightDockingAreaHeight( aContainerClientSize.Height );
     if ( rBorderSpace.Y >= 0 )
     {
         // Top docking area window
@@ -5230,8 +5222,8 @@ void LayoutManager::implts_setDockingAre
     if ( rBorderSpace.Height >= 0 )
     {
         // Bottom docking area window
-        sal_Int32 nBottomPos = std::max( sal_Int32( aContainerClientSize.Height - rBorderSpace.Height - aStatusBarSize.Height() ), sal_Int32( 0 ));
-        sal_Int32 nHeight = ( nBottomPos == 0 ) ? 0 : rBorderSpace.Height;
+        long nBottomPos = std::max( aContainerClientSize.Height - rBorderSpace.Height - aStatusBarSize.Height(), 0L );
+        long nHeight = ( nBottomPos == 0 ) ? 0L : rBorderSpace.Height;
 
         ReadGuard aReadLock( m_aLock );
         Reference< css::awt::XWindow > xDockAreaWindow( m_xDockAreaWindows[DockingArea_DOCKINGAREA_BOTTOM] );
@@ -5251,7 +5243,7 @@ void LayoutManager::implts_setDockingAre
         aReadLock.unlock();
 
         // We also have to change our right docking area window if the top or bottom area has changed. They have a higher priority!
-        sal_Int32 nHeight = std::max( sal_Int32( 0 ), sal_Int32( nLeftRightDockingAreaHeight ));
+        long nHeight = std::max( 0L, nLeftRightDockingAreaHeight );
 
         xDockAreaWindow->setPosSize( 0, rBorderSpace.Y, rBorderSpace.X, nHeight, css::awt::PosSize::POSSIZE );
         xDockAreaWindow->setVisible( sal_True );
@@ -5264,9 +5256,9 @@ void LayoutManager::implts_setDockingAre
         aReadLock.unlock();
 
         // We also have to change our right docking area window if the top or bottom area has changed. They have a higher priority!
-        sal_Int32 nLeftPos  = std::max( sal_Int32( 0 ), sal_Int32( aContainerClientSize.Width - rBorderSpace.Width ));
-        sal_Int32 nHeight   = std::max( sal_Int32( 0 ), sal_Int32( nLeftRightDockingAreaHeight ));
-        sal_Int32 nWidth    = ( nLeftPos == 0 ) ? 0 : rBorderSpace.Width;
+        long nLeftPos  = std::max( 0, aContainerClientSize.Width - rBorderSpace.Width );
+        long nHeight   = std::max( 0L, nLeftRightDockingAreaHeight );
+        long nWidth    = ( nLeftPos == 0 ) ? 0L : rBorderSpace.Width;
 
         xDockAreaWindow->setPosSize( nLeftPos, rBorderSpace.Y, nWidth, nHeight, css::awt::PosSize::POSSIZE );
         xDockAreaWindow->setVisible( sal_True );
@@ -5275,7 +5267,7 @@ void LayoutManager::implts_setDockingAre
     // Position the status bar
     if ( aStatusBarSize.Height() > 0 )
     {
-        implts_setStatusBarPosSize( ::Point( 0, std::max(( aContainerClientSize.Height - aStatusBarSize.Height() ), sal_Int32( 0 ))),
+        implts_setStatusBarPosSize( ::Point( 0, std::max((sal_Int32) (aContainerClientSize.Height - aStatusBarSize.Height()), sal_Int32( 0 ))),
                                     ::Size( aContainerClientSize.Width, aStatusBarSize.Height() ));
     }
 }
Index: framework/source/services/documentproperties.cxx
===================================================================
RCS file: /cvs/framework/framework/source/services/documentproperties.cxx,v
retrieving revision 1.20
retrieving revision 1.20.22.1
diff -u -p -u -p -r1.20 -r1.20.22.1
--- framework/source/services/documentproperties.cxx	8 Sep 2004 14:11:36 -0000	1.20
+++ framework/source/services/documentproperties.cxx	21 Jan 2005 15:31:01 -0000	1.20.22.1
@@ -2190,6 +2190,30 @@ void DocumentProperties::impl_writeToStr
 //******************************************************************************************************************************
 //	private method
 //******************************************************************************************************************************
+void DocumentProperties::impl_writeToStream(			SvStream&	aStream	,
+												const	sal_Int64&	nValue	)
+{
+	aStream << nValue;
+	#ifdef ENABLE_STREAMCHECK
+	impldbg_checkSvStream( aStream, "impl_writeToStream( int64 )" );
+	#endif
+}
+
+//******************************************************************************************************************************
+//	private method
+//******************************************************************************************************************************
+void DocumentProperties::impl_writeToStream(			SvStream&	aStream	,
+												const	sal_uInt64&	nValue	)
+{
+	aStream << nValue;
+	#ifdef ENABLE_STREAMCHECK
+	impldbg_checkSvStream( aStream, "impl_writeToStream( unsigned int64 )" );
+	#endif
+}
+
+//******************************************************************************************************************************
+//	private method
+//******************************************************************************************************************************
 OUString DocumentProperties::impl_FormatID2MIMEType( sal_uInt32 nFormatID ) const
 {
 	const int nCount = sizeof( aStaticConvertTable ) / sizeof( tIMPL_ConverterItem );
Index: framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx,v
retrieving revision 1.13
retrieving revision 1.4.14.4
diff -u -p -u -p -r1.13 -r1.4.14.4
--- framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx	1 Mar 2005 19:40:15 -0000	1.13
+++ framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx	9 Mar 2005 16:19:18 -0000	1.4.14.4
@@ -914,7 +914,7 @@ void SAL_CALL ModuleUIConfigurationManag
             Reference< XPropertySet > xPropSet( m_xUserConfigStorage, UNO_QUERY );
             if ( xPropSet.is() )
             {
-                long nOpenMode;
+                sal_Int32 nOpenMode;
                 Any a = xPropSet->getPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OpenMode" )));
                 if ( a >>= nOpenMode )
                     m_bReadOnly = !( nOpenMode & ElementModes::WRITE );
Index: framework/source/uiconfiguration/uiconfigurationmanager.cxx
===================================================================
RCS file: /cvs/framework/framework/source/uiconfiguration/uiconfigurationmanager.cxx,v
retrieving revision 1.12
retrieving revision 1.4.14.4
diff -u -p -u -p -r1.12 -r1.4.14.4
--- framework/source/uiconfiguration/uiconfigurationmanager.cxx	1 Mar 2005 19:40:44 -0000	1.12
+++ framework/source/uiconfiguration/uiconfigurationmanager.cxx	9 Mar 2005 16:19:09 -0000	1.4.14.4
@@ -1243,7 +1243,7 @@ void SAL_CALL UIConfigurationManager::se
         {
             try
             {
-                long nOpenMode;
+                sal_Int32 nOpenMode;
                 Any a = xPropSet->getPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "OpenMode" )));
                 if ( a >>= nOpenMode )
                     m_bReadOnly = !( nOpenMode & ElementModes::WRITE );
Index: configmgr/source/data/types.cxx
===================================================================
RCS file: /cvs/util/configmgr/source/data/types.cxx,v
retrieving revision 1.1
retrieving revision 1.1.154.1
diff -u -p -u -p -r1.1 -r1.1.154.1
--- configmgr/source/data/types.cxx	11 Feb 2002 14:55:53 -0000	1.1
+++ configmgr/source/data/types.cxx	21 Sep 2004 09:04:08 -0000	1.1.154.1
@@ -87,8 +87,8 @@ namespace configmgr
         using memory::Allocator;
         using memory::Accessor;
 //-----------------------------------------------------------------------------	
-sal_Size const c_nDataOffset        = sizeof(sal_Int32);
-sal_Size const c_nStringCharSize    = sizeof(sal_Unicode);
+HeapSize const c_nDataOffset        = sizeof(sal_Int32);
+HeapSize const c_nStringCharSize    = sizeof(sal_Unicode);
 //-----------------------------------------------------------------------------	
 static inline
 sal_Int32& implGetLength(Allocator const& _anAllocator, String _aString)
@@ -142,7 +142,7 @@ NameChar const * accessName(Accessor con
 String allocString(Allocator const& _anAllocator, rtl::OUString const & _sString)
 {
     sal_Int32 nLength = _sString.getLength();
-    sal_Int32 nTextSize = (nLength + 1) * c_nStringCharSize;
+    HeapSize nTextSize = HeapSize(nLength + 1) * c_nStringCharSize;
 
     String anAddress = _anAllocator.allocate(c_nDataOffset + nTextSize);
     if (anAddress)
Index: configmgr/source/inc/heap.hxx
===================================================================
RCS file: /cvs/util/configmgr/source/inc/heap.hxx,v
retrieving revision 1.3
retrieving revision 1.3.154.1
diff -u -p -u -p -r1.3 -r1.3.154.1
--- configmgr/source/inc/heap.hxx	15 Mar 2002 11:39:06 -0000	1.3
+++ configmgr/source/inc/heap.hxx	21 Sep 2004 09:04:08 -0000	1.3.154.1
@@ -90,9 +90,6 @@ namespace configmgr
             typedef HeapManager::HeapIdParam HeapIdParam;
             typedef HeapManager::Address     Address;
 
-        //    typedef sal_uInt32 Size;
-        //    typedef sal_uInt32 Address;
-
             Heap(HeapManager& _impl);
             Heap(HeapManager& _impl, Size _nInitialSize);
             Heap(HeapManager& _impl, HeapIdParam _anId);
Index: configmgr/source/inc/heapmanager.hxx
===================================================================
RCS file: /cvs/util/configmgr/source/inc/heapmanager.hxx,v
retrieving revision 1.3
retrieving revision 1.3.154.1
diff -u -p -u -p -r1.3 -r1.3.154.1
--- configmgr/source/inc/heapmanager.hxx	15 Mar 2002 13:50:51 -0000	1.3
+++ configmgr/source/inc/heapmanager.hxx	21 Sep 2004 09:04:09 -0000	1.3.154.1
@@ -62,6 +62,9 @@
 #ifndef CONFIGMGR_DATAHEAPMANAGER_HXX
 #define CONFIGMGR_DATAHEAPMANAGER_HXX
 
+#ifndef CONFIGMGR_MEMORYMODEL_HXX
+#include "memorymodel.hxx"
+#endif
 #ifndef CONFIGMGR_DATALOCK_HXX
 #include "datalock.hxx"
 #endif
@@ -84,9 +87,9 @@ namespace configmgr
         public:
             typedef struct Opaque_ * Handle;
 
-            typedef sal_uInt32      Size;
-            typedef sal_uInt32      Address;
-            typedef rtl::OString    HeapId;
+            typedef memory::HeapSize    Size;
+            typedef memory::Address     Address;
+            typedef rtl::OString        HeapId;
             typedef rtl::OString const & HeapIdParam;
 
         //    virtual HeapId newHeapId() = 0;
Index: configmgr/source/inc/pointer.hxx
===================================================================
RCS file: /cvs/util/configmgr/source/inc/pointer.hxx,v
retrieving revision 1.3
retrieving revision 1.3.44.1
diff -u -p -u -p -r1.3 -r1.3.44.1
--- configmgr/source/inc/pointer.hxx	1 Dec 2003 16:05:48 -0000	1.3
+++ configmgr/source/inc/pointer.hxx	21 Sep 2004 09:04:09 -0000	1.3.44.1
@@ -62,12 +62,8 @@
 #ifndef CONFIGMGR_POINTER_HXX
 #define CONFIGMGR_POINTER_HXX
 
-#ifndef _SAL_TYPES_H_
-#include <sal/types.h>
-#endif
-
-#ifndef INCLUDED_SHARABLE_BASETYPES_HXX
-#include "types.hxx"
+#ifndef CONFIGMGR_MEMORYMODEL_HXX
+#include "memorymodel.hxx"
 #endif
 
 namespace configmgr
@@ -85,7 +81,7 @@ namespace configmgr
             friend class Accessor;
             friend class UpdateAccessor;
 
-            typedef sharable::Address AddressType;
+            typedef memory::Address AddressType;
 
             AddressType m_value;
 
Index: configmgr/source/inc/types.hxx
===================================================================
RCS file: /cvs/util/configmgr/source/inc/types.hxx,v
retrieving revision 1.1
retrieving revision 1.1.154.1
diff -u -p -u -p -r1.1 -r1.1.154.1
--- configmgr/source/inc/types.hxx	11 Feb 2002 14:29:07 -0000	1.1
+++ configmgr/source/inc/types.hxx	21 Sep 2004 09:04:09 -0000	1.1.154.1
@@ -62,6 +62,10 @@
 #ifndef INCLUDED_SHARABLE_BASETYPES_HXX
 #define INCLUDED_SHARABLE_BASETYPES_HXX
 
+#ifndef CONFIGMGR_MEMORYMODEL_HXX
+#include "memorymodel.hxx"
+#endif
+
 #ifndef _SAL_TYPES_H_
 #include <sal/types.h>
 #endif
@@ -81,7 +85,8 @@ namespace configmgr
     {
     //-----------------------------------------------------------------------------
     // some base types
-        typedef sal_uInt32 Address; // points to absolute location in memory segment
+        typedef memory::Address  Address;  // points to absolute location in memory segment
+        typedef memory::HeapSize HeapSize; // size of memory block within heap
         typedef sal_uInt16 Offset;  // Offset relative to 'this' in array of nodes
         typedef sal_uInt8  Byte;  
 
Index: configmgr/source/inc/updateaccessor.hxx
===================================================================
RCS file: /cvs/util/configmgr/source/inc/updateaccessor.hxx,v
retrieving revision 1.3
retrieving revision 1.3.110.1
diff -u -p -u -p -r1.3 -r1.3.110.1
--- configmgr/source/inc/updateaccessor.hxx	15 Apr 2003 17:17:28 -0000	1.3
+++ configmgr/source/inc/updateaccessor.hxx	21 Sep 2004 09:04:09 -0000	1.3.110.1
@@ -65,6 +65,9 @@
 #ifndef CONFIGMGR_UTILITY_HXX_
 #include "utility.hxx"
 #endif
+#ifndef CONFIGMGR_MEMORYMODEL_HXX
+#include "memorymodel.hxx"
+#endif
 #ifndef CONFIGMGR_ACCESSOR_HXX
 #include "accessor.hxx"
 #endif
@@ -84,8 +87,8 @@ namespace configmgr
             SegmentHeap *   m_heap;
 
         public:
-            typedef sal_uInt32 Address;
-            typedef sal_uInt32 Size;
+            typedef memory::Address Address;
+            typedef memory::HeapSize Size;
 
             Address allocate(Size _sz) const;
             void deallocate(Address _addr) const;
? bridges/source/mono_uno
Index: bridges/inc/bridges/remote/context.h
===================================================================
RCS file: /cvs/udk/bridges/inc/bridges/remote/context.h,v
retrieving revision 1.5
retrieving revision 1.4.168.2
diff -u -p -u -p -r1.5 -r1.4.168.2
--- bridges/inc/bridges/remote/context.h	23 Aug 2004 09:20:08 -0000	1.5
+++ bridges/inc/bridges/remote/context.h	13 Oct 2004 17:22:54 -0000	1.4.168.2
@@ -215,7 +215,7 @@ remote_removeContextListener( remote_con
 extern "C" rtl_uString ** SAL_CALL
 remote_getContextList(
 	sal_Int32 *pnStringCount,
-	void * ( SAL_CALL * memAlloc ) ( sal_uInt32 nBytesToAlloc ) );
+	void * ( SAL_CALL * memAlloc ) ( sal_Size nBytesToAlloc ) );
 
 
 struct remote_BridgeImpl;
Index: bridges/inc/bridges/remote/marshal.hxx
===================================================================
RCS file: /cvs/udk/bridges/inc/bridges/remote/marshal.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.196.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.196.1
--- bridges/inc/bridges/remote/marshal.hxx	18 Sep 2000 15:28:48 -0000	1.1.1.1
+++ bridges/inc/bridges/remote/marshal.hxx	29 Aug 2004 15:41:55 -0000	1.1.1.1.196.1
@@ -91,7 +91,7 @@ public:
 	::com::sun::star::uno::Sequence < sal_Int8 > remove();
 
 	inline sal_Int32 getPos()
-		{ return m_pos - m_base; }
+		{ return sal_Int32(m_pos - m_base); }
 	
 private:
 	inline void align( sal_Int32 nToAlign );
Index: bridges/source/cpp_uno/gcc3_linux_x86-64/except.cxx
===================================================================
RCS file: /cvs/udk/bridges/source/cpp_uno/gcc3_linux_x86-64/except.cxx,v
retrieving revision 1.2
retrieving revision 1.2.30.1
diff -u -p -u -p -r1.2 -r1.2.30.1
--- bridges/source/cpp_uno/gcc3_linux_x86-64/except.cxx	9 Mar 2004 12:11:06 -0000	1.2
+++ bridges/source/cpp_uno/gcc3_linux_x86-64/except.cxx	22 Jan 2005 23:55:03 -0000	1.2.30.1
@@ -93,7 +93,7 @@ void dummy_can_throw_anything( char cons
 //==================================================================================================
 static OUString toUNOname( char const * p ) SAL_THROW( () )
 {
-#ifdef DEBUG
+#if OSL_DEBUG_LEVEL > 1
     char const * start = p;
 #endif
     
@@ -118,7 +118,7 @@ static OUString toUNOname( char const * 
             buf.append( (sal_Unicode)'.' );
     }
     
-#ifdef DEBUG
+#if OSL_DEBUG_LEVEL > 1
     OUString ret( buf.makeStringAndClear() );
     OString c_ret( OUStringToOString( ret, RTL_TEXTENCODING_ASCII_US ) );
     fprintf( stderr, "> toUNOname(): %s => %s\n", start, c_ret.getStr() );
@@ -200,7 +200,7 @@ type_info * RTTI::getRTTI( typelib_Compo
                 // symbol and rtti-name is nearly identical,
                 // the symbol is prefixed with _ZTI
                 char const * rttiName = symName.getStr() +4;
-#ifdef DEBUG
+#if OSL_DEBUG_LEVEL > 1
                 fprintf( stderr,"generated rtti for %s\n", rttiName );
 #endif
                 if (pTypeDescr->pBaseTypeDescription)
@@ -253,6 +253,13 @@ static void deleteException( void * pExc
 //==================================================================================================
 void raiseException( uno_Any * pUnoExc, uno_Mapping * pUno2Cpp )
 {
+#if OSL_DEBUG_LEVEL > 1
+    OString cstr(
+        OUStringToOString(
+            *reinterpret_cast< OUString const * >( &pUnoExc->pType->pTypeName ),
+            RTL_TEXTENCODING_ASCII_US ) );
+    fprintf( stderr, "> uno exception occured: %s\n", cstr.getStr() );
+#endif
     void * pCppExc;
     type_info * rtti;
 
@@ -295,7 +302,7 @@ void raiseException( uno_Any * pUnoExc, 
 }
 
 //==================================================================================================
-void fillUnoException( __cxa_exception * header, uno_Any * pExc, uno_Mapping * pCpp2Uno )
+void fillUnoException( __cxa_exception * header, uno_Any * pUnoExc, uno_Mapping * pCpp2Uno )
 {
     OSL_ENSURE( header, "### no exception header!!!" );
     if (! header)
@@ -309,8 +316,8 @@ void fillUnoException( __cxa_exception *
         terminate();
     
     // construct uno exception any
-    ::uno_any_constructAndConvert( pExc, header->adjustedPtr, pExcTypeDescr, pCpp2Uno );
-    ::typelib_typedescription_release( pExcTypeDescr );
+    uno_any_constructAndConvert( pUnoExc, header->adjustedPtr, pExcTypeDescr, pCpp2Uno );
+    typelib_typedescription_release( pExcTypeDescr );
 }
 
 }
Index: bridges/source/cpp_uno/gcc3_linux_x86-64/share.hxx
===================================================================
RCS file: /cvs/udk/bridges/source/cpp_uno/gcc3_linux_x86-64/share.hxx,v
retrieving revision 1.2
retrieving revision 1.2.30.1
diff -u -p -u -p -r1.2 -r1.2.30.1
--- bridges/source/cpp_uno/gcc3_linux_x86-64/share.hxx	9 Mar 2004 12:11:26 -0000	1.2
+++ bridges/source/cpp_uno/gcc3_linux_x86-64/share.hxx	22 Jan 2005 23:55:22 -0000	1.2.30.1
@@ -59,6 +59,8 @@
  *
  ************************************************************************/
 
+#include "uno/mapping.h"
+
 #include <typeinfo>
 #include <exception>
 #include <cstddef>
@@ -66,6 +68,8 @@
 namespace CPPU_CURRENT_NAMESPACE
 {
 
+void dummy_can_throw_anything( char const * );
+
 // ----- following decl from libstdc++-v3/libsupc++/unwind-cxx.h and unwind.h
 
 struct _Unwind_Exception
Index: bridges/source/remote/context/context.cxx
===================================================================
RCS file: /cvs/udk/bridges/source/remote/context/context.cxx,v
retrieving revision 1.4
retrieving revision 1.3.24.2
diff -u -p -u -p -r1.4 -r1.3.24.2
--- bridges/source/remote/context/context.cxx	23 Aug 2004 09:20:33 -0000	1.4
+++ bridges/source/remote/context/context.cxx	13 Oct 2004 17:29:18 -0000	1.3.24.2
@@ -187,7 +187,7 @@ public:
 
 	rtl_uString ** getConnectionList(
 		sal_Int32 *pnStringCount ,
-		void * ( SAL_CALL * memAlloc ) ( sal_uInt32 nBytesToAlloc ) );
+		void * ( SAL_CALL * memAlloc ) ( sal_Size nBytesToAlloc ) );
 
 private:
 	::osl::Mutex          m_mutex;
@@ -312,7 +312,7 @@ uno_Context *ContextAdmin::get( rtl_uStr
 
 rtl_uString ** ContextAdmin::getConnectionList(
 	sal_Int32 *pnStringCount ,
-	void * ( SAL_CALL * memAlloc ) ( sal_uInt32 nBytesToAlloc ) )
+	void * ( SAL_CALL * memAlloc ) ( sal_Size nBytesToAlloc ) )
 {
 	::osl::MutexGuard guard( m_mutex );
 
@@ -545,7 +545,7 @@ remote_removeContextListener( remote_con
 extern "C" rtl_uString ** SAL_CALL
 remote_getContextList(
 	sal_Int32 *pnStringCount,
-	void * ( SAL_CALL * memAlloc ) ( sal_uInt32 nBytesToAlloc ) )
+	void * ( SAL_CALL * memAlloc ) ( sal_Size nBytesToAlloc ) )
 {
 	return ContextAdmin::getInstance()->getConnectionList( pnStringCount , memAlloc );
 }
Index: bridges/source/remote/iiop/marshal.cxx
===================================================================
RCS file: /cvs/udk/bridges/source/remote/iiop/marshal.cxx,v
retrieving revision 1.4
retrieving revision 1.4.24.1
diff -u -p -u -p -r1.4 -r1.4.24.1
--- bridges/source/remote/iiop/marshal.cxx	21 Apr 2004 13:42:56 -0000	1.4
+++ bridges/source/remote/iiop/marshal.cxx	29 Aug 2004 15:40:28 -0000	1.4.24.1
@@ -58,13 +58,20 @@
  *
  *
  ************************************************************************/
+
 #include <osl/diagnose.h>
+
 #include <bridges/remote/marshal.hxx>
 #include <bridges/remote/remote.hxx>
 #include <bridges/remote/helper.hxx>
 
 #include "conversion.h"
 
+#ifndef INCLUDED_STRING_H
+#include <string.h>
+#define INCLUDED_STRING_H
+#endif
+
 #ifdef major
 #undef major
 #undef minor
Index: bridges/source/remote/urp/urp_marshal.hxx
===================================================================
RCS file: /cvs/udk/bridges/source/remote/urp/urp_marshal.hxx,v
retrieving revision 1.6
retrieving revision 1.6.24.1
diff -u -p -u -p -r1.6 -r1.6.24.1
--- bridges/source/remote/urp/urp_marshal.hxx	21 Apr 2004 13:45:49 -0000	1.6
+++ bridges/source/remote/urp/urp_marshal.hxx	29 Aug 2004 15:40:28 -0000	1.6.24.1
@@ -60,6 +60,7 @@
  ************************************************************************/
 #ifndef _URP_MARSHAL_HXX_
 #define _URP_MARSHAL_HXX_
+
 #ifndef _RTL_USTRBUF_HXX_
 #include <rtl/ustrbuf.hxx>
 #endif
@@ -80,6 +81,11 @@
 #include "urp_marshal_decl.hxx"
 #endif
 
+#ifndef INCLUDED_STRING_H
+#include <string.h>
+#define INCLUDED_STRING_H
+#endif
+
 struct remote_Interface;
 
 namespace bridges_urp
@@ -87,7 +93,7 @@ namespace bridges_urp
 	// methods for accessing marshaling buffer
 	inline void Marshal::finish( sal_Int32 nMessageCount )
 	{
-		sal_Int32 nSize = getSize() - 2*sizeof( sal_Int32 ); 
+		sal_Int32 nSize = getSize() - 2*sal_Int32(sizeof( sal_Int32 ));
 
 		// save the state
 		sal_Int8 *pos = m_pos;
@@ -116,12 +122,12 @@ namespace bridges_urp
 
 	inline sal_Int32 Marshal::getSize()
 	{
-		return ((sal_Int32) (m_pos - m_base));
+		return sal_Int32(m_pos - m_base);
 	}
 	
 	inline void Marshal::ensureAdditionalMem( sal_Int32 nMemToAdd )
 	{
-		sal_Int32 nDiff = m_pos - m_base;
+		sal_Int32 nDiff = sal_Int32(m_pos - m_base);
 		if( nDiff + nMemToAdd > m_nBufferSize )
 		{
 			m_nBufferSize = m_nBufferSize * 2 > nDiff + nMemToAdd ?
Index: bridges/source/remote/urp/urp_marshal_decl.hxx
===================================================================
RCS file: /cvs/udk/bridges/source/remote/urp/urp_marshal_decl.hxx,v
retrieving revision 1.4
retrieving revision 1.4.174.1
diff -u -p -u -p -r1.4 -r1.4.174.1
--- bridges/source/remote/urp/urp_marshal_decl.hxx	31 Aug 2001 16:16:52 -0000	1.4
+++ bridges/source/remote/urp/urp_marshal_decl.hxx	29 Aug 2004 15:40:28 -0000	1.4.174.1
@@ -62,10 +62,16 @@
 #ifndef _URP_MARSHAL_DECL_HXX_
 #define _URP_MARSHAL_DECL_HXX_
 
+#ifndef _RTL_USTRING_HXX_
 #include <rtl/ustring.hxx>
+#endif
+#ifndef _RTL_BYTESEQ_HXX_
 #include <rtl/byteseq.hxx>
+#endif
 
+#ifndef _COM_SUN_STAR_UNO_TYPE_HXX_
 #include <com/sun/star/uno/Type.hxx>
+#endif
 
 namespace bridges_urp
 {
@@ -123,7 +129,7 @@ namespace bridges_urp
 		inline sal_Int32 getSize();
 		
 		inline sal_Int32 getPos()
-			{ return m_pos - m_base; }
+			{ return sal_Int32(m_pos - m_base); }
 	
 		inline sal_Bool isSystemLittleEndian()
 			{ return g_bMarshalSystemIsLittleEndian; }
Index: jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx
===================================================================
RCS file: /cvs/udk/jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx,v
retrieving revision 1.17
retrieving revision 1.13.10.5
diff -u -p -u -p -r1.17 -r1.13.10.5
--- jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx	18 Jan 2005 16:18:41 -0000	1.17
+++ jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx	9 Mar 2005 16:51:45 -0000	1.13.10.5
@@ -79,6 +79,11 @@
 #include "jni.h"
 #include "rtl/byteseq.hxx"
 #include "jvmfwk/vendorplugin.h"
+
+#ifndef INCLUDED_STRING_H
+#include <string.h>
+#define INCLUDED_STRING_H
+#endif
 #include "util.hxx"
 #include "sunversion.hxx"
 #include "vendorlist.hxx"
Index: jvmfwk/plugins/sunmajor/pluginlib/sunjre.cxx
===================================================================
RCS file: /cvs/udk/jvmfwk/plugins/sunmajor/pluginlib/sunjre.cxx,v
retrieving revision 1.3
retrieving revision 1.3.10.1
diff -u -p -u -p -r1.3 -r1.3.10.1
--- jvmfwk/plugins/sunmajor/pluginlib/sunjre.cxx	16 Dec 2004 11:44:52 -0000	1.3
+++ jvmfwk/plugins/sunmajor/pluginlib/sunjre.cxx	21 Jan 2005 15:45:21 -0000	1.3.10.1
@@ -102,6 +102,7 @@ char const* const* SunInfo::getRuntimePa
         "/bin/classic/jvm.dll"
 #elif UNX
         "/lib/" JFW_PLUGIN_ARCH "/client/libjvm.so",
+        "/lib/" JFW_PLUGIN_ARCH "/server/libjvm.so",
         "/lib/" JFW_PLUGIN_ARCH "/classic/libjvm.so"
 #endif
 
Index: jvmfwk/plugins/sunmajor/pluginlib/vendorbase.hxx
===================================================================
RCS file: /cvs/udk/jvmfwk/plugins/sunmajor/pluginlib/vendorbase.hxx,v
retrieving revision 1.3
retrieving revision 1.2.18.3
diff -u -p -u -p -r1.3 -r1.2.18.3
--- jvmfwk/plugins/sunmajor/pluginlib/vendorbase.hxx	16 Dec 2004 11:46:22 -0000	1.3
+++ jvmfwk/plugins/sunmajor/pluginlib/vendorbase.hxx	21 Jan 2005 15:43:48 -0000	1.2.18.3
@@ -83,6 +83,8 @@ namespace jfw_plugin
 #define JFW_PLUGIN_ARCH "mips"
 #elif defined S390
 #define JFW_PLUGIN_ARCH "s390"
+#elif defined X86_64
+#define JFW_PLUGIN_ARCH "amd64"
 #else // SPARC, INTEL, POWERPC, MIPS
 #error unknown plattform
 #endif // SPARC, INTEL, POWERPC, MIPS
Index: jvmfwk/source/elements.cxx
===================================================================
RCS file: /cvs/udk/jvmfwk/source/elements.cxx,v
retrieving revision 1.14
retrieving revision 1.12.10.2
diff -u -p -u -p -r1.14 -r1.12.10.2
--- jvmfwk/source/elements.cxx	16 Dec 2004 11:47:01 -0000	1.14
+++ jvmfwk/source/elements.cxx	18 Jan 2005 18:47:31 -0000	1.12.10.2
@@ -71,6 +71,12 @@
 #include "libxml/xpath.h"
 #include "libxml/xpathInternals.h"
 #include "rtl/bootstrap.hxx"
+
+#ifndef INCLUDED_STRING_H
+#include <string.h>
+#define INCLUDED_STRING_H
+#endif
+
 // #define NS_JAVA_FRAMEWORK "http://openoffice.org/2004/java/framework/1.0"
 // #define NS_SCHEMA_INSTANCE "http://www.w3.org/2001/XMLSchema-instance"
 
Index: jvmfwk/source/fwkutil.cxx
===================================================================
RCS file: /cvs/udk/jvmfwk/source/fwkutil.cxx,v
retrieving revision 1.21
retrieving revision 1.17.10.4
diff -u -p -u -p -r1.21 -r1.17.10.4
--- jvmfwk/source/fwkutil.cxx	31 Jan 2005 09:52:11 -0000	1.21
+++ jvmfwk/source/fwkutil.cxx	9 Mar 2005 16:49:48 -0000	1.17.10.4
@@ -79,6 +79,10 @@
 #include "framework.hxx"
 #include "fwkutil.hxx"
 
+#ifndef INCLUDED_STRINGS_H
+#include <strings.h>
+#define INCLUDED_STRINGS_H
+#endif
 using namespace rtl;
 using namespace osl;
 
@@ -100,7 +104,6 @@ osl::Mutex * getFwkMutex()
             Init(), ::osl::GetGlobalMutex());
 }
 
-
 bool isAccessibilitySupportDesired()
 {
     bool retVal = false;
Index: padmin/source/helper.cxx
===================================================================
RCS file: /cvs/gsl/padmin/source/helper.cxx,v
retrieving revision 1.15
retrieving revision 1.15.24.1
diff -u -p -u -p -r1.15 -r1.15.24.1
--- padmin/source/helper.cxx	26 Jun 2004 03:11:23 -0000	1.15
+++ padmin/source/helper.cxx	21 Jan 2005 15:36:36 -0000	1.15.24.1
@@ -131,7 +131,7 @@ using namespace com::sun::star::ui::dial
  *	PaResId
  */
 
-ResId padmin::PaResId( ULONG nId )
+ResId padmin::PaResId( sal_uInt32 nId )
 {
 	static ResMgr* pPaResMgr = NULL;
 	if( ! pPaResMgr )
Index: padmin/source/helper.hxx
===================================================================
RCS file: /cvs/gsl/padmin/source/helper.hxx,v
retrieving revision 1.5
retrieving revision 1.5.18.1
diff -u -p -u -p -r1.5 -r1.5.18.1
--- padmin/source/helper.hxx	30 Mar 2004 13:46:19 -0000	1.5
+++ padmin/source/helper.hxx	21 Jan 2005 15:36:50 -0000	1.5.18.1
@@ -156,7 +156,7 @@ public:
 
 BOOL AreYouSure( Window*, int nRid = -1 );
 
-ResId PaResId( ULONG nId );
+ResId PaResId( sal_uInt32 nId );
 
 void FindFiles( const String& rDirectory, ::std::list< String >& rResult, const String& rSuffixes, bool bRecursive = false );
 
Index: so3/inc/factory.hxx
===================================================================
RCS file: /cvs/oi/so3/inc/factory.hxx,v
retrieving revision 1.10
retrieving revision 1.9.50.2
diff -u -p -u -p -r1.10 -r1.9.50.2
--- so3/inc/factory.hxx	16 Feb 2005 17:18:15 -0000	1.10
+++ so3/inc/factory.hxx	9 Mar 2005 16:59:08 -0000	1.9.50.2
@@ -160,8 +160,8 @@ public:
 	static SvGlobalName GetSvClass( INT32 nFileFormat, const SvGlobalName & rClass );
 	static BOOL			IsIntern31( const SvGlobalName & rClass );
 	static BOOL			IsIntern( const SvGlobalName & rClass,
-							   	  long *pFileFormat	);
-	static SvGlobalName GetServerName( long nStorageFormat );
+							   	  sal_Int32 *pFileFormat	);
+	static SvGlobalName GetServerName( sal_Int32 nStorageFormat );
 	static String	    GetServiceName( const SvGlobalName& );
 
 private:
Index: so3/source/misc/factory.cxx
===================================================================
RCS file: /cvs/oi/so3/source/misc/factory.cxx,v
retrieving revision 1.19
retrieving revision 1.18.16.2
diff -u -p -u -p -r1.19 -r1.18.16.2
--- so3/source/misc/factory.cxx	16 Feb 2005 17:21:09 -0000	1.19
+++ so3/source/misc/factory.cxx	9 Mar 2005 17:00:27 -0000	1.18.16.2
@@ -936,7 +936,7 @@ SvGlobalName SvFactory::GetAutoConvertTo
 //=========================================================================
 SvGlobalName SvFactory::GetSvClass
 (
-	long nFileFormat,
+	sal_Int32 nFileFormat,
 	const SvGlobalName & rClass
 )
 /*  [Beschreibung]
@@ -1046,7 +1046,7 @@ BOOL SvFactory::IsIntern31
 BOOL SvFactory::IsIntern
 (
 	const SvGlobalName & rClass,
- 	long *pFileFormat
+ 	sal_Int32 *pFileFormat
 )
 /*  [Description]
 
@@ -1091,7 +1091,7 @@ BOOL SvFactory::IsIntern
 	return FALSE;
 }
 
-SvGlobalName SvFactory::GetServerName( long nStorageFormat )
+SvGlobalName SvFactory::GetServerName( sal_Int32 nStorageFormat )
 {
 	SvGlobalName aRet;
 
Index: so3/source/persist/persist.cxx
===================================================================
RCS file: /cvs/oi/so3/source/persist/persist.cxx,v
retrieving revision 1.59
retrieving revision 1.56.50.3
diff -u -p -u -p -r1.59 -r1.56.50.3
--- so3/source/persist/persist.cxx	21 Feb 2005 16:28:11 -0000	1.59
+++ so3/source/persist/persist.cxx	9 Mar 2005 17:00:58 -0000	1.56.50.3
@@ -850,7 +850,7 @@ BOOL SvPersist::ImplCopy( SvPersist* pSr
     SvStorageRef aSrcEleStor = pSrc->GetStorage();
     SvStorage* pStor = GetStorage();
 
-    long nObjVersion = aSrcEleStor->GetVersion();
+    sal_Int32 nObjVersion = aSrcEleStor->GetVersion();
     BOOL bIntern = SvFactory::IsIntern( aSrcEleStor->GetClassName(), &nObjVersion );
 	if( nObjVersion >= SOFFICE_FILEFORMAT_60 )
 	{
@@ -1872,7 +1872,7 @@ BOOL SvPersist::SaveElement( SvStorage* 
 		pEle->SetClassName( aSrcEleStor->GetClassName() );
 
 	DBG_ASSERT( aSrcEleStor.Is(), "no object storage" );
-    long nObjVersion = aSrcEleStor->GetVersion();
+    sal_Int32 nObjVersion = aSrcEleStor->GetVersion();
 
     // element must be saved as OLEStorage if it currently has an OLE storage or
     // the target storage is an OLEStorage
Index: so3/source/persist/transprt.cxx
===================================================================
RCS file: /cvs/oi/so3/source/persist/transprt.cxx,v
retrieving revision 1.5
retrieving revision 1.5.220.1
diff -u -p -u -p -r1.5 -r1.5.220.1
--- so3/source/persist/transprt.cxx	20 Nov 2001 17:16:56 -0000	1.5
+++ so3/source/persist/transprt.cxx	21 Jul 2004 18:50:24 -0000	1.5.220.1
@@ -1130,7 +1130,7 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 	sal_Int32 nSize = 0;
 	while (nSize < nBytesToRead)
 	{
-		ULONG nCount = 0;
+		sal_Size nCount = 0;
 		ErrCode nError = m_xLockBytes->ReadAt (
 			m_nPosition,
 			rData.getArray() + nSize,
@@ -1138,8 +1138,8 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 			&nCount);
 		if (nError != ERRCODE_NONE && nError != ERRCODE_IO_PENDING)
 			throw IOException();
-		m_nPosition += nCount;
-		nSize += nCount;
+		m_nPosition += svstream_Size_to_u32( nCount );
+		nSize += svstream_Size_to_u32( nCount );
 		if (nError == ERRCODE_NONE && nCount == 0)
 			break;
 	}
@@ -1159,7 +1159,7 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 		throw NotConnectedException();
 
 	rData.realloc(nMaxBytesToRead);
-	ULONG nCount;
+	sal_Size nCount;
 	ErrCode nError;
 	do
 	{
@@ -1170,12 +1170,12 @@ sal_Int32 SAL_CALL UcbTransportInputStre
 			&nCount);
 		if (nError != ERRCODE_NONE && nError != ERRCODE_IO_PENDING)
 			throw IOException();
-		m_nPosition += nCount;
+		m_nPosition += svstream_Size_to_u32( nCount );
 	}
 	while (nCount == 0 && nError == ERRCODE_IO_PENDING);
 
-	rData.realloc(sal_Int32(nCount));
-	return sal_Int32(nCount);
+	rData.realloc(sal_Int32(svstream_Size_to_u32(nCount)));
+	return sal_Int32(svstream_Size_to_u32(nCount));
 }
 
 /*
? sd/source/filter/html/htmltheme.cxx
? sd/source/filter/html/htmltheme.hxx
Index: sd/res/imagelst/sc27139.png
===================================================================
RCS file: sd/res/imagelst/sc27139.png
diff -N sd/res/imagelst/sc27139.png
Binary files /dev/null and /tmp/cvsmHDOE3 differ
Index: sd/res/imagelst/sc27142.png
===================================================================
RCS file: sd/res/imagelst/sc27142.png
diff -N sd/res/imagelst/sc27142.png
Binary files /dev/null and /tmp/cvsglER1D differ
Index: sd/source/filter/eppt/dinfos2.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/filter/eppt/dinfos2.cxx,v
retrieving revision 1.6
retrieving revision 1.6.26.1
diff -u -p -u -p -r1.6 -r1.6.26.1
--- sd/source/filter/eppt/dinfos2.cxx	4 Oct 2004 18:18:38 -0000	1.6
+++ sd/source/filter/eppt/dinfos2.cxx	21 Jan 2005 16:31:07 -0000	1.6.26.1
@@ -211,12 +211,12 @@ void PropItem::Write( DateTime& rDateTim
 				   60 * rDateTime.GetMin() +
 				   60L * 60 * rDateTime.GetHour() ) );
 
-	BigInt aUlongMax( (ULONG)ULONG_MAX );
-	aUlongMax += 1;
+	BigInt aUintMax( (sal_uInt32)0xFFFFFFFF );
+	aUintMax += 1;
 
 	*this	<< (UINT32)VT_FILETIME
-			<< (UINT32)( aTime % aUlongMax )
-			<< (UINT32)( aTime / aUlongMax );
+			<< (UINT32)( aTime % aUintMax )
+			<< (UINT32)( aTime / aUintMax );
 }
 
 //	-----------------------------------------------------------------------
Index: sd/source/ui/docshell/docshel4.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/docshell/docshel4.cxx,v
retrieving revision 1.66
retrieving revision 1.65.6.2
diff -u -p -u -p -r1.66 -r1.65.6.2
--- sd/source/ui/docshell/docshel4.cxx	18 Jan 2005 15:16:29 -0000	1.66
+++ sd/source/ui/docshell/docshel4.cxx	9 Mar 2005 22:12:37 -0000	1.65.6.2
@@ -983,7 +983,7 @@ BOOL DrawDocShell::SaveAsOwnFormat( SfxM
 \************************************************************************/
 
 void DrawDocShell::FillClass(SvGlobalName* pClassName,
-										ULONG*  pFormat,
+										sal_uInt32*  pFormat,
 										String* pAppName,
 										String* pFullTypeName,
                                         String* pShortTypeName,
Index: sd/source/ui/inc/AccessiblePageShape.hxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/inc/AccessiblePageShape.hxx,v
retrieving revision 1.6
retrieving revision 1.6.316.1
diff -u -p -u -p -r1.6 -r1.6.316.1
--- sd/source/ui/inc/AccessiblePageShape.hxx	24 Apr 2003 17:05:03 -0000	1.6
+++ sd/source/ui/inc/AccessiblePageShape.hxx	21 Jan 2005 16:31:37 -0000	1.6.316.1
@@ -139,7 +139,7 @@ public:
 	//=====  XAccessibleContext  ==============================================
 
     ///	Returns always 0 because there can be no children.
-    virtual long SAL_CALL
+    virtual sal_Int32 SAL_CALL
     	getAccessibleChildCount (void)
         throw ();
         
Index: sd/source/ui/inc/DrawDocShell.hxx
===================================================================
RCS file: /cvs/graphics/sd/source/ui/inc/DrawDocShell.hxx,v
retrieving revision 1.8
retrieving revision 1.8.6.1
diff -u -p -u -p -r1.8 -r1.8.6.1
--- sd/source/ui/inc/DrawDocShell.hxx	11 Jan 2005 12:12:23 -0000	1.8
+++ sd/source/ui/inc/DrawDocShell.hxx	21 Jan 2005 16:31:57 -0000	1.8.6.1
@@ -151,7 +151,7 @@ public:
 	virtual SfxStyleSheetBasePool* GetStyleSheetPool();
 	virtual void	        SetOrganizerSearchMask(SfxStyleSheetBasePool* pBasePool) const;
 	virtual Size	        GetFirstPageSize();
-    virtual void            FillClass(SvGlobalName* pClassName, ULONG*  pFormat, String* pAppName, String* pFullTypeName, String* pShortTypeName, sal_Int32 nFileFormat ) const;
+    virtual void            FillClass(SvGlobalName* pClassName, sal_uInt32*  pFormat, String* pAppName, String* pFullTypeName, String* pShortTypeName, sal_Int32 nFileFormat ) const;
 	virtual void            SetModified( BOOL = TRUE );
 
 
Index: sch/inc/chaxis.hxx
===================================================================
RCS file: /cvs/graphics/sch/inc/chaxis.hxx,v
retrieving revision 1.11
retrieving revision 1.10.182.2
diff -u -p -u -p -r1.11 -r1.10.182.2
--- sch/inc/chaxis.hxx	24 Feb 2005 14:05:15 -0000	1.11
+++ sch/inc/chaxis.hxx	9 Mar 2005 21:21:33 -0000	1.10.182.2
@@ -63,7 +63,7 @@
 
 class ChartModel;
 class SvNumberFormatter;
-class SvULONGTable;
+class Svsal_uInt32Table;
 class SdrObject;
 class SdrObjList;
 class XPolygon;
@@ -408,7 +408,7 @@ public:
 	//nDir ist Flag, kann sein CHAXIS_MARK_INNER und CHAXIS_MARK_OUTER (oder beides)
 	SdrObject *CreateMarks(long nPosition,long nLen,long nWhichTicks);
 
-	BOOL TranslateMergedNumFormat( SvULONGTable* pTransTable );
+	BOOL TranslateMergedNumFormat( Svsal_uInt32Table* pTransTable );
     long GetUniqueId() const    { return mnUId; }
 
     /** Converts a CHOBJID into an axis UId.
Index: sch/inc/chtmodel.hxx
===================================================================
RCS file: /cvs/graphics/sch/inc/chtmodel.hxx,v
retrieving revision 1.53
retrieving revision 1.51.28.2
diff -u -p -u -p -r1.53 -r1.51.28.2
--- sch/inc/chtmodel.hxx	3 Mar 2005 17:30:52 -0000	1.53
+++ sch/inc/chtmodel.hxx	9 Mar 2005 21:20:37 -0000	1.51.28.2
@@ -149,7 +149,7 @@ class SchModelData;
 class SchObjectId;
 class ChartAxis;
 class SvNumberFormatter;
-class SvULONGTable;
+class Svsal_uInt32Table;
 class SchItemPool;
 class SchMemChart;
 class Vector3D;
@@ -1000,7 +1000,7 @@ public:
 
 	void                SetNumberFormatter( SvNumberFormatter* );
 	void                DataRangeChanged( long _nOldRowCnt = 0, long _nOldColCnt = 0 );
-	void                TranslateAllNumFormatIds( SvULONGTable* );
+	void                TranslateAllNumFormatIds( Svsal_uInt32Table* );
 
 	/** set new doc shell if there was no one before
         returns true if new shell was set */
Index: sch/inc/memchrt.hxx
===================================================================
RCS file: /cvs/graphics/sch/inc/memchrt.hxx,v
retrieving revision 1.14
retrieving revision 1.13.68.2
diff -u -p -u -p -r1.14 -r1.13.68.2
--- sch/inc/memchrt.hxx	24 Feb 2005 14:06:15 -0000	1.14
+++ sch/inc/memchrt.hxx	9 Mar 2005 21:20:45 -0000	1.13.68.2
@@ -310,28 +310,28 @@ public:
 	// BM: Fix for #68864#
 	// Use these four methods with care! The arrays MUST have the correct size!
 	// ********************
-	void SetRowTranslation( const long* pTransTable )
+	void SetRowTranslation( const sal_Int32* pTransTable )
 	{
 		if( !pRowTable ) return;
-		for( long i=0; i<nRowCnt; i++ )
+		for( sal_Int32 i=0; i<nRowCnt; i++ )
 			pRowTable[ i ] = pTransTable[ i ];
 	}
-	void SetColTranslation( const long* pTransTable )
+	void SetColTranslation( const sal_Int32* pTransTable )
 	{
 		if( !pColTable ) return;
-		for( long i=0; i<nColCnt; i++ )
+		for( sal_Int32 i=0; i<nColCnt; i++ )
 			pColTable[ i ] = pTransTable[ i ];
 	}
-	void SetRowNumFmtTable( const long* pNumFmtTable )
+	void SetRowNumFmtTable( const sal_Int32* pNumFmtTable )
 	{
 		if( !pRowNumFmtId ) return;
-		for( long i=0; i<nRowCnt; i++ )
+		for( sal_Int32 i=0; i<nRowCnt; i++ )
 			pRowNumFmtId[ i ] = pNumFmtTable[ i ];
 	}
-	void SetColNumFmtTable( const long* pNumFmtTable )
+	void SetColNumFmtTable( const sal_Int32* pNumFmtTable )
 	{
 		if( !pColNumFmtId ) return;
-		for( long i=0; i<nColCnt; i++ )
+		for( sal_Int32 i=0; i<nColCnt; i++ )
 			pColNumFmtId[ i ] = pNumFmtTable[ i ];
 	}
 	// this is only valid if the corresponding translation table was set correctly!
Index: sch/source/core/chartdoc.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/core/chartdoc.cxx,v
retrieving revision 1.26
retrieving revision 1.24.30.2
diff -u -p -u -p -r1.26 -r1.24.30.2
--- sch/source/core/chartdoc.cxx	3 Mar 2005 17:31:24 -0000	1.26
+++ sch/source/core/chartdoc.cxx	9 Mar 2005 21:27:21 -0000	1.24.30.2
@@ -289,7 +289,7 @@ SdrModel* ChartModel::AllocModel() const
 	// merge numberformatters
 	if( pNewModel->pOwnNumFormatter && pNumFormatter )
 	{
-		SvULONGTable* pTransTable =
+		Svsal_uInt32Table* pTransTable =
 			pNewModel->pOwnNumFormatter->MergeFormatter( *pNumFormatter );
 
 		if( pTransTable && pTransTable->Count() )
Index: sch/source/core/chaxis.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/core/chaxis.cxx,v
retrieving revision 1.38
retrieving revision 1.37.76.2
diff -u -p -u -p -r1.38 -r1.37.76.2
--- sch/source/core/chaxis.cxx	24 Feb 2005 14:07:30 -0000	1.38
+++ sch/source/core/chaxis.cxx	9 Mar 2005 21:27:29 -0000	1.37.76.2
@@ -2781,7 +2781,7 @@ BOOL ChartAxis::IsValueInRange( double f
 	return  ((mfMin <= fValue) && (fValue <= mfMax));	
 }
 
-BOOL ChartAxis::TranslateMergedNumFormat( SvULONGTable* pTransTable )
+BOOL ChartAxis::TranslateMergedNumFormat( Svsal_uInt32Table* pTransTable )
 {
 	ULONG nFmt, nMrgFmt;
 	BOOL bRet =FALSE;
Index: sch/source/core/chtmode5.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/core/chtmode5.cxx,v
retrieving revision 1.8
retrieving revision 1.7.228.2
diff -u -p -u -p -r1.8 -r1.7.228.2
--- sch/source/core/chtmode5.cxx	24 Feb 2005 14:09:20 -0000	1.8
+++ sch/source/core/chtmode5.cxx	9 Mar 2005 21:27:37 -0000	1.7.228.2
@@ -383,7 +383,7 @@ void ChartModel::SetChartData(SchMemChar
 				// merge old one to new one and set new one as member
 				if( pNewFormatter && pNumFormatter )
 				{
-					SvULONGTable* pTransTable =
+					Svsal_uInt32Table* pTransTable =
 						pNewFormatter->MergeFormatter( *pNumFormatter );
 
 					SetNumberFormatter( pNewFormatter );
Index: sch/source/core/chtmode9.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/core/chtmode9.cxx,v
retrieving revision 1.43
retrieving revision 1.42.6.2
diff -u -p -u -p -r1.43 -r1.42.6.2
--- sch/source/core/chtmode9.cxx	24 Feb 2005 14:09:51 -0000	1.43
+++ sch/source/core/chtmode9.cxx	9 Mar 2005 21:24:53 -0000	1.42.6.2
@@ -1910,7 +1910,7 @@ void ChartModel::SetNumberFormatter( SvN
 	}
 }
 
-void ChartModel::TranslateAllNumFormatIds( SvULONGTable* pTransTable )
+void ChartModel::TranslateAllNumFormatIds( Svsal_uInt32Table* pTransTable )
 {
 	if( pChartXAxis->TranslateMergedNumFormat( pTransTable ) &&
         nXLastNumFmt >= 0 )
Index: sch/source/ui/dlg/databrws.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/ui/dlg/databrws.cxx,v
retrieving revision 1.13
retrieving revision 1.13.28.1
diff -u -p -u -p -r1.13 -r1.13.28.1
--- sch/source/ui/dlg/databrws.cxx	9 Nov 2004 18:31:45 -0000	1.13
+++ sch/source/ui/dlg/databrws.cxx	21 Jan 2005 16:18:53 -0000	1.13.28.1
@@ -736,7 +736,7 @@ sal_Bool ChartDataBrowseBox::SaveModifie
         if( aText.Len() > 0 )
         {
 			SvNumberFormatter* pFormatter = m_pModel->GetNumFormatter();
-			ULONG nFormat =
+			sal_uInt32 nFormat =
 				pFormatter->GetStandardFormat( m_apMemChart->GetDataType(),
                                                LANGUAGE_SYSTEM );
 			if( ! pFormatter->IsNumberFormat( aText, nFormat, fData ))
Index: sch/source/ui/dlg/tpscaley.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/ui/dlg/tpscaley.cxx,v
retrieving revision 1.6
retrieving revision 1.6.18.1
diff -u -p -u -p -r1.6 -r1.6.18.1
--- sch/source/ui/dlg/tpscaley.cxx	20 Aug 2004 08:44:18 -0000	1.6
+++ sch/source/ui/dlg/tpscaley.cxx	21 Jan 2005 16:19:03 -0000	1.6.18.1
@@ -343,7 +343,7 @@ void SchScaleYAxisTabPage::Reset(const S
 
 int SchScaleYAxisTabPage::DeactivatePage(SfxItemSet* pItemSet)
 {
-	ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+	sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 	Edit* pEdit = NULL;
 	USHORT nErrStrId = 0;
 	double fDummy;
@@ -471,7 +471,7 @@ IMPL_LINK( SchScaleYAxisTabPage, HandleL
 
 void SchScaleYAxisTabPage::CheckLogs ()
 {
-	ULONG  nIndex    = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+	sal_uInt32 nIndex    = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 	Edit   *pEdit    = NULL;
 	USHORT nErrStrId = 0;
 	String aNumStr;
@@ -606,7 +606,7 @@ void SchScaleYAxisTabPage::CheckLogContr
 
 	if (aCbxLogarithm.IsChecked ())
 	{
-		ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+		sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 
 		aFmtFldOrigin.Enable (FALSE);
 		aCbxAutoOrigin.Enable (FALSE);
@@ -660,7 +660,7 @@ BOOL SchScaleYAxisTabPage::GetHelpValue 
 	}
 	else
 	{
-		ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+		sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 		double fDummy;
 
 		fStepHelp = aFmtFldStepHelp.GetValue();
Index: sch/source/ui/unoidl/ChXChartDocument.cxx
===================================================================
RCS file: /cvs/graphics/sch/source/ui/unoidl/ChXChartDocument.cxx,v
retrieving revision 1.51
retrieving revision 1.51.22.2
diff -u -p -u -p -r1.51 -r1.51.22.2
--- sch/source/ui/unoidl/ChXChartDocument.cxx	26 May 2004 11:33:02 -0000	1.51
+++ sch/source/ui/unoidl/ChXChartDocument.cxx	21 Sep 2004 05:57:11 -0000	1.51.22.2
@@ -1734,7 +1734,7 @@ bool ChXChartDocument::SetTransSequence(
 
     if( pData )
     {
-        long nTranslation = pData->GetTranslation();
+        sal_Int32 nTranslation = pData->GetTranslation();
 
         if( bColumns )
         {
Index: sw/inc/chpfld.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/chpfld.hxx,v
retrieving revision 1.3
retrieving revision 1.3.256.1
diff -u -p -u -p -r1.3 -r1.3.256.1
--- sw/inc/chpfld.hxx	9 Dec 2003 11:36:02 -0000	1.3
+++ sw/inc/chpfld.hxx	21 Jan 2005 16:55:08 -0000	1.3.256.1
@@ -105,7 +105,7 @@ class SwChapterField : public SwField
 	BYTE nLevel;
 	String sTitle, sNumber, sPre, sPost;
 public:
-	SwChapterField(SwChapterFieldType*, ULONG nFmt = 0);
+	SwChapterField(SwChapterFieldType*, sal_uInt32 nFmt = 0);
 
 	void ChangeExpansion(const SwFrm*, const SwTxtNode*, 
 		BOOL bSrchNum = FALSE);
Index: sw/inc/doc.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/doc.hxx,v
retrieving revision 1.101
retrieving revision 1.97.26.2
diff -u -p -u -p -r1.101 -r1.97.26.2
--- sw/inc/doc.hxx	21 Feb 2005 16:01:55 -0000	1.101
+++ sw/inc/doc.hxx	10 Mar 2005 01:14:25 -0000	1.97.26.2
@@ -1100,7 +1100,7 @@ public:
 		// eine erzeugte Liste aller Felder mit uebergegeben werden.
 		// (ist die Adresse != 0, und der Pointer == 0 wird eine neue
 		// Liste returnt.)
-	void FldsToCalc( SwCalc& rCalc, sal_uInt32 nLastNd = ULONG_MAX,
+	void FldsToCalc( SwCalc& rCalc, ULONG nLastNd = ULONG_MAX,
 					sal_uInt16 nLastCntnt = USHRT_MAX );
 	void FldsToCalc( SwCalc& rCalc, const _SetGetExpFld& rToThisFld );
 	void FldsToExpand( SwHash**& ppTbl, sal_uInt16& rTblSize,
@@ -1529,7 +1529,7 @@ public:
 											const SwTOXBase& rTOX,
 											const SfxItemSet* pSet = 0,
 											sal_Bool bExpand = sal_False );
-	const SwTOXBaseSection* InsertTableOf( sal_uInt32 nSttNd, sal_uInt32 nEndNd,
+	const SwTOXBaseSection* InsertTableOf( ULONG nSttNd, ULONG nEndNd,
 											const SwTOXBase& rTOX,
 											const SfxItemSet* pSet = 0											);
 	const SwTOXBase* GetCurTOX( const SwPosition& rPos ) const;
@@ -1825,7 +1825,7 @@ public:
 	//Einfuegen einer Beschriftung - falls ein FlyFormat erzeugt wird, so
 	// returne dieses.
     SwFlyFrmFmt* InsertLabel( const SwLabelType eType, const String &rTxt, const String& rSeparator,
-					const sal_Bool bBefore, const sal_uInt16 nId, const sal_uInt32 nIdx,
+					const sal_Bool bBefore, const sal_uInt16 nId, const ULONG nIdx,
                     const String& rCharacterStyle,
 					const sal_Bool bCpyBrd = sal_True );
     SwFlyFrmFmt* InsertDrawLabel(
Index: sw/inc/docsh.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/docsh.hxx,v
retrieving revision 1.29
retrieving revision 1.29.8.1
diff -u -p -u -p -r1.29 -r1.29.8.1
--- sw/inc/docsh.hxx	11 Jan 2005 12:16:49 -0000	1.29
+++ sw/inc/docsh.hxx	21 Jan 2005 16:54:07 -0000	1.29.8.1
@@ -263,7 +263,7 @@ public:
 								const ::com::sun::star::uno::Any & rValue );
     virtual ::sfx2::SvLinkSource* DdeCreateLinkSource( const String& rItem );
 	virtual void FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
 								   String * pLongUserName,
                                    String * pUserName,
Index: sw/inc/docufld.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/docufld.hxx,v
retrieving revision 1.7
retrieving revision 1.7.76.1
diff -u -p -u -p -r1.7 -r1.7.76.1
--- sw/inc/docufld.hxx	8 Sep 2004 14:49:42 -0000	1.7
+++ sw/inc/docufld.hxx	21 Jan 2005 16:54:24 -0000	1.7.76.1
@@ -186,7 +186,7 @@ class SwPageNumberFieldType : public SwF
 public:
 	SwPageNumberFieldType();
 
-	String& Expand( ULONG nFmt, short nOff, const String&, String& rRet ) const;
+	String& Expand( sal_uInt32 nFmt, short nOff, const String&, String& rRet ) const;
 	void ChangeExpansion( SwDoc* pDoc, USHORT nNum, USHORT nMax,
 							BOOL bVirtPageNum, const sal_Int16* pNumFmt = 0 );
 	inline sal_Int16 GetNumFormat() const { return nNumberingType; }
@@ -205,7 +205,7 @@ class SwPageNumberField : public SwField
 
 public:
 	SwPageNumberField(SwPageNumberFieldType*, USHORT nSub = PG_RANDOM,
-					  ULONG nFmt = 0, short nOff = 0);
+					  sal_uInt32 nFmt = 0, short nOff = 0);
 
 	virtual String		Expand() const;
 	virtual SwField*	Copy() const;
@@ -231,7 +231,7 @@ class SwAuthorFieldType : public SwField
 public:
 	SwAuthorFieldType();
 
-	String 					Expand(ULONG) const;
+	String 					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -244,7 +244,7 @@ class SwAuthorField : public SwField
 	String	aContent;
 
 public:
-	SwAuthorField(SwAuthorFieldType*, ULONG nFmt = 0);
+	SwAuthorField(SwAuthorFieldType*, sal_uInt32 nFmt = 0);
 
 	virtual String	 	Expand() const;
 	virtual SwField* 	Copy() const;
@@ -266,7 +266,7 @@ class SwFileNameFieldType : public SwFie
 public:
 	SwFileNameFieldType(SwDoc*);
 
-	String					Expand(ULONG) const;
+	String					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -279,7 +279,7 @@ class SwFileNameField : public SwField
 	String aContent;
 
 public:
-	SwFileNameField(SwFileNameFieldType*, ULONG nFmt = 0);
+	SwFileNameField(SwFileNameFieldType*, sal_uInt32 nFmt = 0);
 
 	virtual String	 	Expand() const;
 	virtual SwField* 	Copy() const;
@@ -301,7 +301,7 @@ class SwTemplNameFieldType : public SwFi
 public:
 	SwTemplNameFieldType(SwDoc*);
 
-	String					Expand(ULONG) const;
+	String					Expand(sal_uInt32) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -312,7 +312,7 @@ public:
 class SwTemplNameField : public SwField
 {
 public:
-	SwTemplNameField(SwTemplNameFieldType*, ULONG nFmt = 0);
+	SwTemplNameField(SwTemplNameFieldType*, sal_uInt32 nFmt = 0);
 
 	virtual String	 	Expand() const;
 	virtual SwField* 	Copy() const;
@@ -332,7 +332,7 @@ class SwDocStatFieldType : public SwFiel
 
 public:
 	SwDocStatFieldType(SwDoc*);
-	String 					Expand(USHORT nSubType, ULONG nFmt) const;
+	String 					Expand(USHORT nSubType, sal_uInt32 nFmt) const;
 	virtual SwFieldType*    Copy() const;
 
 	inline sal_Int16 		GetNumFormat() const 		{ return nNumberingType; }
@@ -349,7 +349,7 @@ class SwDocStatField : public SwField
 
 public:
 	SwDocStatField( SwDocStatFieldType*,
-					USHORT nSubType = 0, ULONG nFmt = 0);
+					USHORT nSubType = 0, sal_uInt32 nFmt = 0);
 
 	void ChangeExpansion( const SwFrm* pFrm );
 
@@ -585,7 +585,7 @@ class SwDocInfoFieldType : public SwValu
 public:
 	SwDocInfoFieldType(SwDoc* pDc);
 
-	String					Expand(USHORT nSubType, ULONG nFormat, USHORT nLang) const;
+	String					Expand(USHORT nSubType, sal_uInt32 nFormat, USHORT nLang) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -595,7 +595,7 @@ class SwDocInfoField : public SwValueFie
 	String  aContent;
 
 public:
-	SwDocInfoField(SwDocInfoFieldType*, USHORT nSub, ULONG nFmt=0);
+	SwDocInfoField(SwDocInfoFieldType*, USHORT nSub, sal_uInt32 nFmt=0);
 
 	virtual void        	SetSubType(USHORT);
 	virtual USHORT	 		GetSubType() const;
@@ -623,7 +623,7 @@ public:
 	inline const String& 	GetData() const					{ return aData; }
 	inline void			 	SetData(const String& rStr)		{ aData = rStr; }
 
-	String					Expand(USHORT nSubType, ULONG nFormat) const;
+	String					Expand(USHORT nSubType, sal_uInt32 nFormat) const;
 	virtual SwFieldType*    Copy() const;
 };
 
@@ -633,7 +633,7 @@ class SwExtUserField : public SwField
 	USHORT 	nType;
 
 public:
-	SwExtUserField(SwExtUserFieldType*, USHORT nSub, ULONG nFmt=0);
+	SwExtUserField(SwExtUserFieldType*, USHORT nSub, sal_uInt32 nFmt=0);
 
 	virtual String		Expand() const;
 	virtual SwField*	Copy() const;
@@ -723,7 +723,7 @@ class SwRefPageGetField : public SwField
 {
 	String sTxt;
 public:
-	SwRefPageGetField( SwRefPageGetFieldType*, ULONG nFmt );
+	SwRefPageGetField( SwRefPageGetFieldType*, sal_uInt32 nFmt );
 
 	virtual String		Expand() const;
 	virtual SwField*	Copy() const;
@@ -759,7 +759,7 @@ class SwJumpEditField : public SwField
 {
 	String sTxt, sHelp;
 public:
-	SwJumpEditField( SwJumpEditFieldType*, ULONG nFormat,
+	SwJumpEditField( SwJumpEditFieldType*, sal_uInt32 nFormat,
 					const String& sText, const String& sHelp );
 
 	virtual String		Expand() const;
Index: sw/inc/fldbas.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/fldbas.hxx,v
retrieving revision 1.10
retrieving revision 1.10.76.1
diff -u -p -u -p -r1.10 -r1.10.76.1
--- sw/inc/fldbas.hxx	8 Sep 2004 14:50:07 -0000	1.10
+++ sw/inc/fldbas.hxx	21 Jan 2005 16:54:49 -0000	1.10.76.1
@@ -295,11 +295,11 @@ extern USHORT __FAR_DATA aTypeTab[];
 	Beschreibung: Allgemeine Tools
  --------------------------------------------------------------------*/
 
-String	GetResult(double nVal, ULONG nNumFmt, USHORT nLang = LANGUAGE_SYSTEM);
+String	GetResult(double nVal, sal_uInt32 nNumFmt, USHORT nLang = LANGUAGE_SYSTEM);
 void    SetErrorStr(const String& rStr);
 //String	ExpandDate(const Date& rDate, ULONG nFmt, USHORT nLang);
 //String 	ExpandTime(const Time& rTime, ULONG nFmt, USHORT nLang);
-String  FormatNumber(USHORT nNum, ULONG nFormat);
+String  FormatNumber(USHORT nNum, sal_uInt32 nFormat);
 
 /*--------------------------------------------------------------------
 	Beschreibung: 	Instanzen von SwFields und Abgeleiteten kommen 0-n mal vor.
@@ -360,14 +360,14 @@ class SW_DLLPUBLIC SwField
 {
 	USHORT				nLang;	// Immer ueber SetLanguage aendern!
     BOOL                bIsAutomaticLanguage;
-	ULONG 				nFormat;
+	sal_uInt32			nFormat;
 
 	SwFieldType* 		pType;
 
 protected:
-	void				SetFormat(ULONG nSet) {nFormat = nSet;}
+	void				SetFormat(sal_uInt32 nSet) {nFormat = nSet;}
 
-	SwField(SwFieldType* pTyp, ULONG nFmt = 0, USHORT nLang = LANGUAGE_SYSTEM);
+	SwField(SwFieldType* pTyp, sal_uInt32 nFmt = 0, USHORT nLang = LANGUAGE_SYSTEM);
 
 public:
 	virtual 			~SwField();
@@ -403,13 +403,13 @@ public:
 	virtual void		SetLanguage(USHORT nLng);
 
 	// Parameter fuer Dialog und BASIC erfragen
-	inline ULONG		GetFormat() const;
+	inline sal_uInt32	GetFormat() const;
 	virtual const String& GetPar1() const;
 	virtual String		GetPar2() 	const;
 
 	virtual String		GetFormula() const;
 
-	virtual void  		ChangeFormat(ULONG n);
+	virtual void  		ChangeFormat(sal_uInt32 n);
 	virtual void		SetPar1(const String& rStr);
 	virtual void		SetPar2(const String& rStr);
 
@@ -429,7 +429,7 @@ public:
 inline SwFieldType*	SwField::GetTyp() const
 	{ return pType; 	}
 
-inline ULONG SwField::GetFormat() const
+inline sal_uInt32 SwField::GetFormat() const
 	{ return nFormat; 	}
 
 inline USHORT SwField::GetLanguage() const
@@ -456,9 +456,9 @@ public:
 	inline BOOL		UseFormat() const					{ return bUseFormat; }
 	inline void		EnableFormat(BOOL bFormat = TRUE)	{ bUseFormat = bFormat; }
 
-	String			ExpandValue(const double& rVal, ULONG nFmt, USHORT nLng=0) const;
+	String			ExpandValue(const double& rVal, sal_uInt32 nFmt, USHORT nLng=0) const;
 	void			DoubleToString(String &rValue, const double &rVal, LanguageType eLng) const;
-	void			DoubleToString(String &rValue, const double &rVal, ULONG nFmt) const;
+	void			DoubleToString(String &rValue, const double &rVal, sal_uInt32 nFmt) const;
 };
 
 class SW_DLLPUBLIC SwValueField : public SwField
@@ -467,7 +467,7 @@ class SW_DLLPUBLIC SwValueField : public
 //	String sExpand;
 
 protected:
-	SwValueField( SwValueFieldType* pFldType, ULONG nFmt = 0, USHORT nLang = LANGUAGE_SYSTEM, const double fVal = 0.0 );
+	SwValueField( SwValueFieldType* pFldType, sal_uInt32 nFmt = 0, USHORT nLang = LANGUAGE_SYSTEM, const double fVal = 0.0 );
 	SwValueField( const SwValueField& rFld );
 
 public:
@@ -483,10 +483,10 @@ public:
 	virtual double			GetValue() const;
 	virtual void 			SetValue( const double& rVal );
 
-	inline String	ExpandValue(const double& rVal, ULONG nFmt, USHORT nLng=0) const
+	inline String	ExpandValue(const double& rVal, sal_uInt32 nFmt, USHORT nLng=0) const
 		{ return ((SwValueFieldType*)GetTyp())->ExpandValue(rVal, nFmt, nLng); }
 
-	static ULONG			GetSystemFormat(SvNumberFormatter* pFormatter, ULONG nFmt);
+	static sal_uInt32		GetSystemFormat(SvNumberFormatter* pFormatter, sal_uInt32 nFmt);
 };
 
 class SwFormulaField : public SwValueField
@@ -494,7 +494,7 @@ class SwFormulaField : public SwValueFie
 	String sFormula;
 
 protected:
-	SwFormulaField( SwValueFieldType* pFldType, ULONG nFmt = 0, const double fVal = 0.0 );
+	SwFormulaField( SwValueFieldType* pFldType, sal_uInt32 nFmt = 0, const double fVal = 0.0 );
 	SwFormulaField( const SwFormulaField& rFld );
 
 public:
Index: sw/inc/globdoc.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/globdoc.hxx,v
retrieving revision 1.5
retrieving revision 1.5.66.1
diff -u -p -u -p -r1.5 -r1.5.66.1
--- sw/inc/globdoc.hxx	4 Oct 2004 18:58:36 -0000	1.5
+++ sw/inc/globdoc.hxx	21 Jan 2005 16:55:02 -0000	1.5.66.1
@@ -77,7 +77,7 @@ public:
 	~SwGlobalDocShell();
 
 	virtual void	FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
 								   String * pLongUserName,
                                    String * pUserName,
Index: sw/inc/ndindex.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/ndindex.hxx,v
retrieving revision 1.2
retrieving revision 1.2.760.1
diff -u -p -u -p -r1.2 -r1.2.760.1
--- sw/inc/ndindex.hxx	28 Sep 2001 07:03:31 -0000	1.2
+++ sw/inc/ndindex.hxx	9 Sep 2004 09:53:00 -0000	1.2.760.1
@@ -94,8 +94,8 @@ class SwNodeIndex
 
 public:
 	SwNodeIndex( SwNodes& rNds, ULONG nIdx = 0 );
-	SwNodeIndex( const SwNodeIndex &, long nDiff = 0 );
-	SwNodeIndex( const SwNode&, long nDiff = 0 );
+	SwNodeIndex( const SwNodeIndex &, sal_Int32 nDiff = 0 );
+	SwNodeIndex( const SwNode&, sal_Int32 nDiff = 0 );
 	~SwNodeIndex() { Remove(); }
 
 	inline ULONG operator++();
@@ -133,7 +133,7 @@ public:
 
 	// ermoeglicht Zuweisungen ohne Erzeugen eines temporaeren Objektes
 	SwNodeIndex& Assign( SwNodes& rNds, ULONG );
-	SwNodeIndex& Assign( const SwNode& rNd, long nOffset = 0 );
+	SwNodeIndex& Assign( const SwNode& rNd, sal_Int32 nOffset = 0 );
 
 		// Herausgabe des Pointers auf das NodesArray,
 	inline const SwNodes& GetNodes() const;
Index: sw/inc/ndtxt.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/ndtxt.hxx,v
retrieving revision 1.35
retrieving revision 1.25.22.4
diff -u -p -u -p -r1.35 -r1.25.22.4
--- sw/inc/ndtxt.hxx	22 Feb 2005 08:16:28 -0000	1.35
+++ sw/inc/ndtxt.hxx	10 Mar 2005 01:14:17 -0000	1.25.22.4
@@ -259,7 +259,7 @@ public:
 	void Replace( const SwIndex& rStart, xub_Unicode cCh );
 	void Replace( const SwIndex& rStart, xub_StrLen nLen, const XubString& rText );
 	void ReplaceTextOnly( xub_StrLen nPos, xub_StrLen nLen, const XubString& rText,
-					const ::com::sun::star::uno::Sequence<long>& rOffsets );
+					const ::com::sun::star::uno::Sequence<sal_Int32>& rOffsets );
 
 	// virtuelle Methoden aus dem CntntNode
 	virtual SwCntntFrm *MakeFrm();
Index: sw/inc/swtable.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/swtable.hxx,v
retrieving revision 1.8
retrieving revision 1.8.92.1
diff -u -p -u -p -r1.8 -r1.8.92.1
--- sw/inc/swtable.hxx	23 Aug 2004 08:39:39 -0000	1.8
+++ sw/inc/swtable.hxx	21 Jan 2005 16:55:15 -0000	1.8.92.1
@@ -385,7 +385,7 @@ public:
 	BOOL IsInHeadline( const SwTable* pTbl = 0 ) const;
 
 	// enthaelt die Box Inhalt, der als Nummer formatiert werden kann?
-	BOOL HasNumCntnt( double& rNum, ULONG& rFmtIndex,
+	BOOL HasNumCntnt( double& rNum, sal_uInt32& rFmtIndex,
 					BOOL& rIsEmptyTxtNd ) const;
 	ULONG IsValidNumTxtNd( BOOL bCheckAttr = TRUE ) const;
 	// teste ob der BoxInhalt mit der Nummer uebereinstimmt, wenn eine
Index: sw/inc/undobj.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/undobj.hxx,v
retrieving revision 1.20
retrieving revision 1.9.64.4
diff -u -p -u -p -r1.20 -r1.9.64.4
--- sw/inc/undobj.hxx	25 Jan 2005 14:41:38 -0000	1.20
+++ sw/inc/undobj.hxx	10 Mar 2005 01:16:36 -0000	1.9.64.4
@@ -1730,7 +1730,7 @@ public:
 	virtual void Repeat( SwUndoIter& rUndoIter );
 
 	void AddChanges( const SwTxtNode& rTNd, xub_StrLen nStart, xub_StrLen nLen,
-		 			::com::sun::star::uno::Sequence <long>& rOffsets );
+		 			::com::sun::star::uno::Sequence <sal_Int32>& rOffsets );
 	BOOL HasData() const {return 0 != pData; }
 };
 
Index: sw/inc/usrfld.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/usrfld.hxx,v
retrieving revision 1.3
retrieving revision 1.3.92.1
diff -u -p -u -p -r1.3 -r1.3.92.1
--- sw/inc/usrfld.hxx	23 Aug 2004 08:42:14 -0000	1.3
+++ sw/inc/usrfld.hxx	21 Jan 2005 16:55:28 -0000	1.3.92.1
@@ -92,10 +92,10 @@ public:
 	virtual const String&	GetName() const;
 	virtual SwFieldType*	Copy() const;
 
-	String					Expand(ULONG nFmt, USHORT nSubType, USHORT nLng);
+	String					Expand(sal_uInt32 nFmt, USHORT nSubType, USHORT nLng);
 
-	String					GetContent( ULONG nFmt = 0 );
-		   void				SetContent( const String& rStr, ULONG nFmt = 0 );
+	String					GetContent( sal_uInt32 nFmt = 0 );
+		   void				SetContent( const String& rStr, sal_uInt32 nFmt = 0 );
 		   void				CtrlSetContent( const String& rStr );
 
 	inline BOOL 			IsValid() const;
@@ -147,7 +147,7 @@ class SwUserField : public SwValueField
 	USHORT  nSubType;
 
 public:
-	SwUserField(SwUserFieldType*, USHORT nSub = 0, ULONG nFmt = 0);
+	SwUserField(SwUserFieldType*, USHORT nSub = 0, sal_uInt32 nFmt = 0);
 
 	virtual USHORT	 		GetSubType() const;
 	virtual void	 		SetSubType(USHORT nSub);
Index: sw/inc/viewsh.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/viewsh.hxx,v
retrieving revision 1.44
retrieving revision 1.44.66.1
diff -u -p -u -p -r1.44 -r1.44.66.1
--- sw/inc/viewsh.hxx	4 Oct 2004 19:01:08 -0000	1.44
+++ sw/inc/viewsh.hxx	21 Jan 2005 16:55:43 -0000	1.44.66.1
@@ -338,7 +338,7 @@ public:
 
 	//Wird intern fuer die Shell gerufen die Druckt. Formatiert die Seiten.
 	void CalcPagesForPrint( sal_uInt16 nMax, SfxProgress* pProgress = 0,
-		const String* pStr = NULL, sal_uInt32 nMergeAct = 0, sal_uInt32 nMergeCnt = 0 );
+		const String* pStr = NULL, ULONG nMergeAct = 0, ULONG nMergeCnt = 0 );
 
 	//All about fields.
 	void UpdateFlds(sal_Bool bCloseDB = sal_False);
Index: sw/inc/wdocsh.hxx
===================================================================
RCS file: /cvs/sw/sw/inc/wdocsh.hxx,v
retrieving revision 1.6
retrieving revision 1.6.66.1
diff -u -p -u -p -r1.6 -r1.6.66.1
--- sw/inc/wdocsh.hxx	4 Oct 2004 19:01:20 -0000	1.6
+++ sw/inc/wdocsh.hxx	21 Jan 2005 16:55:59 -0000	1.6.66.1
@@ -85,7 +85,7 @@ public:
 	~SwWebDocShell();
 
 	virtual void		FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
                                    String * pLongUserName,
                                    String * pUserName,
Index: sw/source/core/access/acccontext.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/access/acccontext.cxx,v
retrieving revision 1.49
retrieving revision 1.47.20.3
diff -u -p -u -p -r1.49 -r1.47.20.3
--- sw/source/core/access/acccontext.cxx	3 Dec 2004 14:09:55 -0000	1.49
+++ sw/source/core/access/acccontext.cxx	18 Jan 2005 16:33:32 -0000	1.47.20.3
@@ -649,7 +649,7 @@ sal_Int32 SAL_CALL SwAccessibleContext::
 }
 
 Reference< XAccessible> SAL_CALL
-	SwAccessibleContext::getAccessibleChild( long nIndex )
+	SwAccessibleContext::getAccessibleChild( sal_Int32 nIndex )
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException)
 {
Index: sw/source/core/access/acccontext.hxx
===================================================================
RCS file: /cvs/sw/sw/source/core/access/acccontext.hxx,v
retrieving revision 1.34
retrieving revision 1.33.520.2
diff -u -p -u -p -r1.34 -r1.33.520.2
--- sw/source/core/access/acccontext.hxx	12 Aug 2004 12:10:26 -0000	1.34
+++ sw/source/core/access/acccontext.hxx	20 Oct 2004 12:08:55 -0000	1.33.520.2
@@ -260,12 +260,12 @@ public:
 	//=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL getAccessibleChildCount (void)
+    virtual sal_Int32 SAL_CALL getAccessibleChildCount (void)
         throw (::com::sun::star::uno::RuntimeException);
 
     ///	Return the specified child or NULL if index is invalid.
     virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-    	getAccessibleChild (long nIndex)
+    	getAccessibleChild (sal_Int32 nIndex)
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException);
 
Index: sw/source/core/access/accdoc.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/access/accdoc.cxx,v
retrieving revision 1.25
retrieving revision 1.23.538.3
diff -u -p -u -p -r1.25 -r1.23.538.3
--- sw/source/core/access/accdoc.cxx	23 Dec 2004 10:01:37 -0000	1.25
+++ sw/source/core/access/accdoc.cxx	18 Jan 2005 16:32:22 -0000	1.23.538.3
@@ -218,7 +218,7 @@ sal_Int32 SAL_CALL SwAccessibleDocumentB
 }
 
 Reference< XAccessible> SAL_CALL
-	SwAccessibleDocumentBase::getAccessibleChild( long nIndex )
+	SwAccessibleDocumentBase::getAccessibleChild( sal_Int32 nIndex )
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException)
 {
Index: sw/source/core/access/accdoc.hxx
===================================================================
RCS file: /cvs/sw/sw/source/core/access/accdoc.hxx,v
retrieving revision 1.17
retrieving revision 1.16.538.2
diff -u -p -u -p -r1.17 -r1.16.538.2
--- sw/source/core/access/accdoc.hxx	23 Dec 2004 10:01:52 -0000	1.17
+++ sw/source/core/access/accdoc.hxx	18 Jan 2005 16:32:54 -0000	1.16.538.2
@@ -105,12 +105,12 @@ public:
 	//=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL getAccessibleChildCount (void)
+    virtual sal_Int32 SAL_CALL getAccessibleChildCount (void)
         throw (::com::sun::star::uno::RuntimeException);
 
     ///	Return the specified child or NULL if index is invalid.
     virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-    	getAccessibleChild (long nIndex)
+    	getAccessibleChild (sal_Int32 nIndex)
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException);
 
Index: sw/source/core/doc/docedt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docedt.cxx,v
retrieving revision 1.22
retrieving revision 1.21.124.2
diff -u -p -u -p -r1.22 -r1.21.124.2
--- sw/source/core/doc/docedt.cxx	21 Jan 2005 10:28:58 -0000	1.22
+++ sw/source/core/doc/docedt.cxx	10 Mar 2005 01:46:07 -0000	1.21.124.2
@@ -1718,13 +1718,13 @@ uno::Any SwDoc::Spell( SwPaM& rPaM,
                             pSttPos->nNode.GetNode().GetTxtNode(), pSttPos->nContent,
                             pEndPos->nNode.GetNode().GetTxtNode(), pEndPos->nContent );
 
-	sal_uInt32 nCurrNd = pSttPos->nNode.GetIndex();
-	sal_uInt32 nEndNd = pEndPos->nNode.GetIndex();
+	ULONG nCurrNd = pSttPos->nNode.GetIndex();
+	ULONG nEndNd = pEndPos->nNode.GetIndex();
 
 	if( nCurrNd <= nEndNd )
 	{
 		SwCntntFrm* pCntFrm;
-		sal_uInt32 nCount = nEndNd - nCurrNd;
+		ULONG nCount = nEndNd - nCurrNd;
 		sal_Bool bGoOn = sal_True;
 		while( bGoOn )
 		{
@@ -2246,7 +2246,7 @@ sal_Bool SwDoc::DelFullPara( SwPaM& rPam
 
 	/* #i9185# This whould lead to a segmentation fault if not catched
        above. */
-	sal_uInt32 nNextNd = rEnd.nNode.GetIndex() + 1;
+	ULONG nNextNd = rEnd.nNode.GetIndex() + 1;
 	SwTableNode* pTblNd = aNodes[ nNextNd ]->GetTableNode();
 
 	if( pTblNd && pNd->IsCntntNode() )
Index: sw/source/core/doc/docfld.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docfld.cxx,v
retrieving revision 1.22
retrieving revision 1.22.66.1
diff -u -p -u -p -r1.22 -r1.22.66.1
--- sw/source/core/doc/docfld.cxx	4 Oct 2004 19:02:51 -0000	1.22
+++ sw/source/core/doc/docfld.cxx	21 Jan 2005 16:56:33 -0000	1.22.66.1
@@ -2221,7 +2221,7 @@ void SwDoc::SetFixFields( BOOL bOnlyTime
 		ResetModified();
 }
 
-BOOL SwDoc::SetFieldsDirty( BOOL b, const SwNode* pChk, ULONG nLen )
+BOOL SwDoc::SetFieldsDirty( BOOL b, const SwNode* pChk, sal_uInt32 nLen )
 {
 	// teste ggfs. mal, ob die angegbenen Nodes ueberhaupt Felder beinhalten.
 	// wenn nicht, braucht das Flag nicht veraendert werden.
Index: sw/source/core/doc/doclay.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/doclay.cxx,v
retrieving revision 1.32
retrieving revision 1.29.46.2
diff -u -p -u -p -r1.32 -r1.29.46.2
--- sw/source/core/doc/doclay.cxx	1 Mar 2005 15:23:43 -0000	1.32
+++ sw/source/core/doc/doclay.cxx	10 Mar 2005 01:46:19 -0000	1.29.46.2
@@ -1337,7 +1337,7 @@ void lcl_CpyAttr( SfxItemSet &rNewSet, c
 
 
 SwFlyFrmFmt* SwDoc::InsertLabel( const SwLabelType eType, const String &rTxt, const String& rSeparator,
-			const sal_Bool bBefore, const sal_uInt16 nId, const sal_uInt32 nNdIdx,
+			const sal_Bool bBefore, const sal_uInt16 nId, const ULONG nNdIdx,
             const String& rCharacterStyle,
 			const sal_Bool bCpyBrd )
 {
@@ -1390,7 +1390,7 @@ SwFlyFrmFmt* SwDoc::InsertLabel( const S
 			{
 				SwStartNode *pSttNd = GetNodes()[nNdIdx]->GetStartNode();
 				ASSERT( pSttNd, "Kein StartNode in InsertLabel." );
-				sal_uInt32 nNode;
+				ULONG nNode;
 				if( bBefore )
 				{
 					nNode = pSttNd->GetIndex();
Index: sw/source/core/doc/docnum.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/docnum.cxx,v
retrieving revision 1.46
retrieving revision 1.42.82.2
diff -u -p -u -p -r1.46 -r1.42.82.2
--- sw/source/core/doc/docnum.cxx	22 Feb 2005 10:02:43 -0000	1.46
+++ sw/source/core/doc/docnum.cxx	10 Mar 2005 01:45:29 -0000	1.42.82.2
@@ -2476,7 +2476,7 @@ void lcl_NodeNumReset(SwNodeNum & rNum, 
    @param rName           name of the numbering rule to search for
    @param nUpdatePos      document position to start at
  */
-void SwDoc::UpdateNumRule( const String& rName, ULONG nUpdatePos )
+void SwDoc::UpdateNumRule( const String& rName, sal_uInt32 nUpdatePos )
 {
     SwNumRule * pRule = FindNumRulePtr(rName);
     ASSERT(pRule, "numrule not found");
Index: sw/source/core/doc/swtable.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/swtable.cxx,v
retrieving revision 1.15
retrieving revision 1.15.104.1
diff -u -p -u -p -r1.15 -r1.15.104.1
--- sw/source/core/doc/swtable.cxx	16 Nov 2004 15:39:44 -0000	1.15
+++ sw/source/core/doc/swtable.cxx	21 Jan 2005 16:57:20 -0000	1.15.104.1
@@ -2011,7 +2011,7 @@ void SwTableBoxFmt::Modify( SfxPoolItem*
 							ULONG nNdPos = pBox->IsValidNumTxtNd( TRUE );
 							if( ULONG_MAX != nNdPos )
 							{
-								ULONG nTmpFmtIdx = nNewFmt;
+								sal_uInt32 nTmpFmtIdx = nNewFmt;
 								String aTxt( GetDoc()->GetNodes()[ nNdPos ]
 												->GetTxtNode()->GetRedlineTxt());
 								if( !aTxt.Len() )
@@ -2027,7 +2027,7 @@ void SwTableBoxFmt::Modify( SfxPoolItem*
 									if( NUMBERFORMAT_PERCENT ==
 										pNumFmtr->GetType( nNewFmt ))
 									{
-										ULONG nTmpFmt = 0;
+										sal_uInt32 nTmpFmt = 0;
 										if( pNumFmtr->IsNumberFormat(
 													aTxt, nTmpFmt, fVal ))
 										{
@@ -2097,7 +2097,7 @@ void SwTableBoxFmt::Modify( SfxPoolItem*
 	SwFrmFmt::Modify( pOld, pNew );
 }
 
-BOOL SwTableBox::HasNumCntnt( double& rNum, ULONG& rFmtIndex,
+BOOL SwTableBox::HasNumCntnt( double& rNum, sal_uInt32& rFmtIndex,
 							BOOL& rIsEmptyTxtNd ) const
 {
 	BOOL bRet = FALSE;
@@ -2120,7 +2120,7 @@ BOOL SwTableBox::HasNumCntnt( double& rN
 			if( !rIsEmptyTxtNd &&
 				NUMBERFORMAT_PERCENT == pNumFmtr->GetType( rFmtIndex ))
 			{
-				ULONG nTmpFmt = 0;
+				sal_uInt32 nTmpFmt = 0;
 				if( pNumFmtr->IsNumberFormat( aTxt, nTmpFmt, rNum ) &&
 					NUMBERFORMAT_NUMBER == pNumFmtr->GetType( nTmpFmt ))
 					aTxt += '%';
Index: sw/source/core/doc/tblafmt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/doc/tblafmt.cxx,v
retrieving revision 1.14
retrieving revision 1.14.8.1
diff -u -p -u -p -r1.14 -r1.14.8.1
--- sw/source/core/doc/tblafmt.cxx	11 Jan 2005 12:18:41 -0000	1.14
+++ sw/source/core/doc/tblafmt.cxx	21 Jan 2005 16:57:27 -0000	1.14.8.1
@@ -782,7 +782,7 @@ void SwTableAutoFmt::UpdateToSet( BYTE n
 			rChg.GetValueFormat( sFmt, eLng, eSys );
 			if( sFmt.Len() )
 			{
-				ULONG nKey = 0;
+				sal_uInt32 nKey = 0;
 				if ( eLng == LANGUAGE_SYSTEM && eSys != ::GetAppLanguage() )
 				{
 					//	#53381# wenn System beim Speichern etwas anderes war,
Index: sw/source/core/docnode/ndindex.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/docnode/ndindex.cxx,v
retrieving revision 1.2
retrieving revision 1.2.574.1
diff -u -p -u -p -r1.2 -r1.2.574.1
--- sw/source/core/docnode/ndindex.cxx	17 Apr 2003 13:56:15 -0000	1.2
+++ sw/source/core/docnode/ndindex.cxx	9 Sep 2004 09:53:02 -0000	1.2.574.1
@@ -106,7 +106,7 @@ SwNodeIndex::SwNodeIndex( SwNodes& rNds,
 }
 
 
-SwNodeIndex::SwNodeIndex( const SwNodeIndex& rIdx, long nDiff )
+SwNodeIndex::SwNodeIndex( const SwNodeIndex& rIdx, sal_Int32 nDiff )
 	: pNext( 0 ), pPrev( 0 )
 {
 	if( nDiff )
@@ -121,7 +121,7 @@ SwNodeIndex::SwNodeIndex( const SwNodeIn
 }
 
 
-SwNodeIndex::SwNodeIndex( const SwNode& rNd, long nDiff )
+SwNodeIndex::SwNodeIndex( const SwNode& rNd, sal_Int32 nDiff )
 	: pNext( 0 ), pPrev( 0 )
 {
 	if( nDiff )
@@ -180,7 +180,7 @@ SwNodeIndex& SwNodeIndex::Assign( SwNode
 	return *this;
 }
 
-SwNodeIndex& SwNodeIndex::Assign( const SwNode& rNd, long nOffset )
+SwNodeIndex& SwNodeIndex::Assign( const SwNode& rNd, sal_Int32 nOffset )
 {
 	if( &pNd->GetNodes() != &rNd.GetNodes() )
 	{
Index: sw/source/core/docnode/ndtbl.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/docnode/ndtbl.cxx,v
retrieving revision 1.26
retrieving revision 1.25.98.2
diff -u -p -u -p -r1.26 -r1.25.98.2
--- sw/source/core/docnode/ndtbl.cxx	21 Jan 2005 10:30:20 -0000	1.26
+++ sw/source/core/docnode/ndtbl.cxx	10 Mar 2005 01:52:59 -0000	1.25.98.2
@@ -3699,7 +3699,7 @@ void SwDoc::ChkBoxNumFmt( SwTableBox& rB
 	SwUndoTblNumFmt* pUndo = 0;
 
 	BOOL bIsEmptyTxtNd, bChgd = TRUE;
-	ULONG nFmtIdx;
+	sal_uInt32 nFmtIdx;
 	double fNumber;
 	if( rBox.HasNumCntnt( fNumber, nFmtIdx, bIsEmptyTxtNd ) )
 	{
Index: sw/source/core/edit/edtab.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/edit/edtab.cxx,v
retrieving revision 1.11
retrieving revision 1.11.180.1
diff -u -p -u -p -r1.11 -r1.11.180.1
--- sw/source/core/edit/edtab.cxx	22 Oct 2004 08:12:34 -0000	1.11
+++ sw/source/core/edit/edtab.cxx	21 Jan 2005 16:57:42 -0000	1.11.180.1
@@ -440,7 +440,7 @@ BOOL SwEditShell::IsTableBoxTextFormat()
 	if( !pBox )
 		return FALSE;
 
-	ULONG nFmt;
+	sal_uInt32 nFmt;
 	const SfxPoolItem* pItem;
 	if( SFX_ITEM_SET == pBox->GetFrmFmt()->GetAttrSet().GetItemState(
 		RES_BOXATR_FORMAT, TRUE, &pItem ))
Index: sw/source/core/fields/cellfml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/fields/cellfml.cxx,v
retrieving revision 1.6
retrieving revision 1.6.34.1
diff -u -p -u -p -r1.6 -r1.6.34.1
--- sw/source/core/fields/cellfml.cxx	5 Jan 2005 15:59:52 -0000	1.6
+++ sw/source/core/fields/cellfml.cxx	21 Jan 2005 16:57:50 -0000	1.6.34.1
@@ -287,7 +287,7 @@ double SwTableBox::GetValue( SwTblCalcPa
 
 			double aNum;
 			String sTxt( rTxt.Copy( nSttPos ) );
-			ULONG nFmtIndex = GetFrmFmt()->GetTblBoxNumFmt().GetValue();
+			sal_uInt32 nFmtIndex = GetFrmFmt()->GetTblBoxNumFmt().GetValue();
 
 			SvNumberFormatter* pNumFmtr = pDoc->GetNumberFormatter();
 
@@ -297,7 +297,7 @@ double SwTableBox::GetValue( SwTblCalcPa
 			else if( sTxt.Len() &&
 					NUMBERFORMAT_PERCENT == pNumFmtr->GetType( nFmtIndex ))
 			{
-				ULONG nTmpFmt = 0;
+				sal_uInt32 nTmpFmt = 0;
 				if( pNumFmtr->IsNumberFormat( sTxt, nTmpFmt, aNum ) &&
 					NUMBERFORMAT_NUMBER == pNumFmtr->GetType( nTmpFmt ))
 					sTxt += '%';
Index: sw/source/core/fields/dbfld.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/fields/dbfld.cxx,v
retrieving revision 1.18
retrieving revision 1.18.126.1
diff -u -p -u -p -r1.18 -r1.18.126.1
--- sw/source/core/fields/dbfld.cxx	2 Aug 2004 14:19:12 -0000	1.18
+++ sw/source/core/fields/dbfld.cxx	21 Jan 2005 16:57:56 -0000	1.18.126.1
@@ -434,7 +434,7 @@ void SwDBField::Evaluate()
     if(!pMgr || !pMgr->IsDataSourceOpen(aTmpData.sDataSource, aTmpData.sCommand, sal_True))
 		return ;
 
-	ULONG nFmt;
+	sal_uInt32 nFmt;
 
 	// Passenden Spaltennamen suchen
 	String aColNm( ((SwDBFieldType*)GetTyp())->GetColumnName() );
Index: sw/source/core/fields/fldbas.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/fields/fldbas.cxx,v
retrieving revision 1.17
retrieving revision 1.17.76.1
diff -u -p -u -p -r1.17 -r1.17.76.1
--- sw/source/core/fields/fldbas.cxx	8 Sep 2004 14:55:34 -0000	1.17
+++ sw/source/core/fields/fldbas.cxx	21 Jan 2005 16:58:05 -0000	1.17.76.1
@@ -273,7 +273,7 @@ BOOL SwFieldType::PutValue( const uno::A
 					Felder sind n-mal vorhanden, Feldtypen nur einmal
  --------------------------------------------------------------------*/
 
-SwField::SwField(SwFieldType* pTyp, ULONG nFmt, USHORT nLng) :
+SwField::SwField(SwFieldType* pTyp, sal_uInt32 nFmt, USHORT nLng) :
 	nFormat(nFmt),
     nLang(nLng),
     bIsAutomaticLanguage(TRUE)
@@ -484,7 +484,7 @@ void SwField::SetLanguage(USHORT nLng)
 	nLang = nLng;
 }
 
-void SwField::ChangeFormat(ULONG n)
+void SwField::ChangeFormat(sal_uInt32 n)
 {
 	nFormat = n;
 }
@@ -523,7 +523,7 @@ FASTBOOL SwField::IsFixed() const
 	Beschreibung: Numerierung expandieren
  --------------------------------------------------------------------*/
 
-String FormatNumber(USHORT nNum, ULONG nFormat)
+String FormatNumber(USHORT nNum, sal_uInt32 nFormat)
 {
     if(SVX_NUM_PAGEDESC == nFormat)
         return  String::CreateFromInt32( nNum );
@@ -558,7 +558,7 @@ SwValueFieldType::SwValueFieldType( cons
  --------------------------------------------------------------------*/
 
 String SwValueFieldType::ExpandValue( const double& rVal,
-										ULONG nFmt, USHORT nLng) const
+										sal_uInt32 nFmt, USHORT nLng) const
 {
 	if (rVal >= DBL_MAX)		// FehlerString fuer Calculator
 		return ViewShell::GetShellRes()->aCalc_Error;
@@ -579,7 +579,7 @@ String SwValueFieldType::ExpandValue( co
 
 		if (pEntry && nLng != pEntry->GetLanguage())
 		{
-			ULONG nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(nFmt,
+			sal_uInt32 nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(nFmt,
 													(LanguageType)nFmtLng);
 
 			if (nNewFormat == nFmt)
@@ -613,7 +613,7 @@ String SwValueFieldType::ExpandValue( co
  --------------------------------------------------------------------*/
 
 void SwValueFieldType::DoubleToString( String &rValue, const double &rVal,
-										ULONG nFmt) const
+										sal_uInt32 nFmt) const
 {
 	SvNumberFormatter* pFormatter = pDoc->GetNumberFormatter();
 	const SvNumberformat* pEntry = pFormatter->GetEntry(nFmt);
@@ -644,7 +644,7 @@ void SwValueFieldType::DoubleToString( S
 	Beschreibung: CTOR SwValueField
  --------------------------------------------------------------------*/
 
-SwValueField::SwValueField( SwValueFieldType* pFldType, ULONG nFmt,
+SwValueField::SwValueField( SwValueFieldType* pFldType, sal_uInt32 nFmt,
 							USHORT nLang, const double fVal )
 	: SwField(pFldType, nFmt, nLang),
 	fValue(fVal)
@@ -697,14 +697,14 @@ void SwValueField::ChangeFormat(ULONG n)
 	Beschreibung: Format in Office-Sprache ermitteln
  --------------------------------------------------------------------*/
 
-ULONG SwValueField::GetSystemFormat(SvNumberFormatter* pFormatter, ULONG nFmt)
+sal_uInt32 SwValueField::GetSystemFormat(SvNumberFormatter* pFormatter, sal_uInt32 nFmt)
 {
 	const SvNumberformat* pEntry = pFormatter->GetEntry(nFmt);
 	USHORT nLng = SvxLocaleToLanguage( GetAppLocaleData().getLocale() );
 
 	if (pEntry && nLng != pEntry->GetLanguage())
 	{
-		ULONG nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(nFmt,
+		sal_uInt32 nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(nFmt,
 														(LanguageType)nLng);
 
 		if (nNewFormat == nFmt)
@@ -715,7 +715,7 @@ ULONG SwValueField::GetSystemFormat(SvNu
 
 			String sFmt(pEntry->GetFormatstring());
 
-			ULONG nFormat = nFmt;
+			sal_uInt32 nFormat = nFmt;
 			pFormatter->PutandConvertEntry(sFmt, nDummy, nType,
 								nFormat, pEntry->GetLanguage(), nLng);
 			nFmt = nFormat;
@@ -735,7 +735,7 @@ void SwValueField::SetLanguage( USHORT n
 {
     if( IsAutomaticLanguage() && 
             ((SwValueFieldType *)GetTyp())->UseFormat() &&
-		GetFormat() != ULONG_MAX )
+		GetFormat() != SAL_MAX_UINT32 )
 	{
 		// wegen Bug #60010
 		SvNumberFormatter* pFormatter = GetDoc()->GetNumberFormatter();
@@ -750,7 +750,7 @@ void SwValueField::SetLanguage( USHORT n
 
 			if( pEntry && nFmtLng != pEntry->GetLanguage() )
 			{
-				ULONG nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(
+				sal_uInt32 nNewFormat = pFormatter->GetFormatForLanguageIfBuiltIn(
 										GetFormat(), (LanguageType)nFmtLng );
 
 				if( nNewFormat == GetFormat() )
@@ -791,7 +791,7 @@ void SwValueField::SetValue( const doubl
 	Beschreibung: SwFormulaField
  --------------------------------------------------------------------*/
 
-SwFormulaField::SwFormulaField( SwValueFieldType* pFldType, ULONG nFmt, const double fVal)
+SwFormulaField::SwFormulaField( SwValueFieldType* pFldType, sal_uInt32 nFmt, const double fVal)
 	: SwValueField(pFldType, nFmt, LANGUAGE_SYSTEM, fVal)
 {
 }
@@ -821,7 +821,7 @@ void SwFormulaField::SetFormula(const St
 
 	ULONG nFmt(GetFormat());
 
-	if( nFmt && ULONG_MAX != nFmt )
+	if( nFmt && SAL_MAX_UINT32 != nFmt )
 	{
 		xub_StrLen nPos = 0;
 		double fValue;
@@ -836,9 +836,9 @@ void SwFormulaField::SetFormula(const St
 
 void SwFormulaField::SetExpandedFormula( const String& rStr )
 {
-	ULONG nFmt(GetFormat());
+	sal_uInt32 nFmt(GetFormat());
 
-	if (nFmt && nFmt != ULONG_MAX && ((SwValueFieldType *)GetTyp())->UseFormat())
+	if (nFmt && nFmt != SAL_MAX_UINT32 && ((SwValueFieldType *)GetTyp())->UseFormat())
 	{
 		double fValue;
 
@@ -862,9 +862,9 @@ void SwFormulaField::SetExpandedFormula(
 
 String SwFormulaField::GetExpandedFormula() const
 {
-	ULONG nFmt(GetFormat());
+	sal_uInt32 nFmt(GetFormat());
 
-	if (nFmt && nFmt != ULONG_MAX && ((SwValueFieldType *)GetTyp())->UseFormat())
+	if (nFmt && nFmt != SAL_MAX_UINT32 && ((SwValueFieldType *)GetTyp())->UseFormat())
 	{
 		String sFormattedValue;
 		Color* pCol = 0;
Index: sw/source/core/fields/usrfld.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/fields/usrfld.cxx,v
retrieving revision 1.9
retrieving revision 1.9.574.1
diff -u -p -u -p -r1.9 -r1.9.574.1
--- sw/source/core/fields/usrfld.cxx	17 Apr 2003 14:07:33 -0000	1.9
+++ sw/source/core/fields/usrfld.cxx	21 Jan 2005 16:58:11 -0000	1.9.574.1
@@ -321,7 +321,7 @@ double SwUserFieldType::GetValue( SwCalc
 
 String SwUserFieldType::GetContent( sal_uInt32 nFmt )
 {
-	if (nFmt && nFmt != ULONG_MAX)
+	if (nFmt && nFmt != SAL_MAX_UINT32)
 	{
 		String sFormattedValue;
 		Color* pCol = 0;
@@ -341,7 +341,7 @@ void SwUserFieldType::SetContent( const 
 	{
 		aContent = rStr;
 
-		if (nFmt && nFmt != ULONG_MAX)
+		if (nFmt && nFmt != SAL_MAX_UINT32)
 		{
 			double fValue;
 
Index: sw/source/core/inc/frmtool.hxx
===================================================================
RCS file: /cvs/sw/sw/source/core/inc/frmtool.hxx,v
retrieving revision 1.20
retrieving revision 1.20.84.1
diff -u -p -u -p -r1.20 -r1.20.84.1
--- sw/source/core/inc/frmtool.hxx	9 Dec 2004 16:41:01 -0000	1.20
+++ sw/source/core/inc/frmtool.hxx	21 Jan 2005 16:58:17 -0000	1.20.84.1
@@ -121,7 +121,7 @@ void SwAlignGrfRect( SwRect *pGrfRect, c
 SwFlyFrm *GetFlyFromMarked( const SdrMarkList *pLst, ViewShell *pSh );
 
 //Nicht gleich die math.lib anziehen.
-ULONG MA_FASTCALL SqRt( BigInt nX );
+sal_uInt32 MA_FASTCALL SqRt( BigInt nX );
 
 //CntntNodes besorgen, CntntFrms erzeugen und in den LayFrm haengen.
 void MA_FASTCALL _InsertCnt( SwLayoutFrm *pLay, SwDoc *pDoc, ULONG nIndex,
Index: sw/source/core/inc/scriptinfo.hxx
===================================================================
RCS file: /cvs/sw/sw/source/core/inc/scriptinfo.hxx,v
retrieving revision 1.10
retrieving revision 1.4.94.3
diff -u -p -u -p -r1.10 -r1.4.94.3
--- sw/source/core/inc/scriptinfo.hxx	26 Nov 2004 14:27:05 -0000	1.10
+++ sw/source/core/inc/scriptinfo.hxx	18 Jan 2005 15:47:29 -0000	1.4.94.3
@@ -267,7 +267,7 @@ public:
     USHORT HasKana( xub_StrLen nStart, const xub_StrLen nEnd ) const;
 
     // modifies the kerning array according to a given compress value
-    long Compress( long* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
+    long Compress( sal_Int32* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
                    const USHORT nCompress, const USHORT nFontHeight,
                    Point* pPoint = NULL ) const;
 
@@ -287,7 +287,7 @@ public:
                 The value which has to be added to a kashida opportunity.
     @return The number of kashida opportunities in the given range
 */
-    USHORT KashidaJustify( long* pKernArray ,long* pScrArray,
+    USHORT KashidaJustify( sal_Int32* pKernArray ,sal_Int32* pScrArray,
                            xub_StrLen nIdx, xub_StrLen nLen,
                            USHORT nSpace = 0 ) const;
 
@@ -318,8 +318,8 @@ public:
                 The value which has to be added to the cells.
     @return The number of extra spaces in the given range
 */
-    static USHORT ThaiJustify( const XubString& rTxt, long* pKernArray,
-                               long* pScrArray, xub_StrLen nIdx,
+    static USHORT ThaiJustify( const XubString& rTxt, sal_Int32* pKernArray,
+                               sal_Int32* pScrArray, xub_StrLen nIdx,
                                xub_StrLen nLen, xub_StrLen nNumberOfBlanks = 0,
                                long nSpaceAdd = 0 );
 
Index: sw/source/core/layout/flycnt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/flycnt.cxx,v
retrieving revision 1.46
retrieving revision 1.45.48.2
diff -u -p -u -p -r1.46 -r1.45.48.2
--- sw/source/core/layout/flycnt.cxx	27 Jan 2005 11:11:12 -0000	1.46
+++ sw/source/core/layout/flycnt.cxx	10 Mar 2005 01:55:28 -0000	1.45.48.2
@@ -868,7 +868,7 @@ ULONG MA_FASTCALL lcl_FindCntDiff( const
 		{
 			//Jetzt die Entfernung zwischen den beiden Punkten berechnen.
 			//'Delta' X^2 + 'Delta'Y^2 = 'Entfernung'^2
-			ULONG dX = Max( pCnt->Frm().Left(), rPt.X() ) -
+			sal_uInt32 dX = Max( pCnt->Frm().Left(), rPt.X() ) -
 					   Min( pCnt->Frm().Left(), rPt.X() ),
 				  dY = Max( pCnt->Frm().Top(), rPt.Y() ) -
 					   Min( pCnt->Frm().Top(), rPt.Y() );
Index: sw/source/core/layout/frmtool.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/frmtool.cxx,v
retrieving revision 1.74
retrieving revision 1.72.48.2
diff -u -p -u -p -r1.74 -r1.72.48.2
--- sw/source/core/layout/frmtool.cxx	27 Jan 2005 11:11:28 -0000	1.74
+++ sw/source/core/layout/frmtool.cxx	10 Mar 2005 01:55:20 -0000	1.72.48.2
@@ -2720,7 +2720,7 @@ void RestoreCntnt( SwFrm *pSav, SwLayout
 |*
 |*************************************************************************/
 
-ULONG MA_FASTCALL SqRt( BigInt nX )
+sal_uInt32 MA_FASTCALL SqRt( BigInt nX )
 {
 	BigInt nErg = 1;
 
@@ -2733,7 +2733,7 @@ ULONG MA_FASTCALL SqRt( BigInt nX )
 			nOldErg = nErg;
 		}
 	}
-	return nErg >= BigInt((ULONG)ULONG_MAX) ? ULONG_MAX : (ULONG)nErg;
+	return nErg >= BigInt(SAL_MAX_UINT32) ? SAL_MAX_UINT32 : (sal_uInt32)nErg;
 }
 
 /*************************************************************************
Index: sw/source/core/layout/trvlfrm.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/layout/trvlfrm.cxx,v
retrieving revision 1.43
retrieving revision 1.41.76.2
diff -u -p -u -p -r1.43 -r1.41.76.2
--- sw/source/core/layout/trvlfrm.cxx	28 Jan 2005 15:27:06 -0000	1.43
+++ sw/source/core/layout/trvlfrm.cxx	10 Mar 2005 01:56:49 -0000	1.41.76.2
@@ -1143,11 +1143,11 @@ BOOL GetFrmInPage( const SwCntntFrm *pCn
 |*	Letzte Aenderung	MA 09. Jan. 97
 |*
 |*************************************************************************/
-ULONG CalcDiff( const Point &rPt1, const Point &rPt2 )
+sal_uInt32 CalcDiff( const Point &rPt1, const Point &rPt2 )
 {
 	//Jetzt die Entfernung zwischen den beiden Punkten berechnen.
 	//'Delta' X^2 + 'Delta'Y^2 = 'Entfernung'^2
-	ULONG dX = Max( rPt1.X(), rPt2.X() ) -
+	sal_uInt32 dX = Max( rPt1.X(), rPt2.X() ) -
 			   Min( rPt1.X(), rPt2.X() ),
 		  dY = Max( rPt1.Y(), rPt2.Y() ) -
 			   Min( rPt1.Y(), rPt2.Y() );
@@ -1208,7 +1208,7 @@ const SwCntntFrm *SwLayoutFrm::GetCntntP
 	const SwLayoutFrm *pInside = NULL;
 	USHORT nMaxPage = GetPhyPageNum() + (bDefaultExpand ? 1 : 0);
 	Point aPoint = rPoint;
-	ULONG nDistance = ULONG_MAX;
+	sal_uInt32 nDistance = SAL_MAX_UINT32;
 
 	while ( TRUE ) 	//Sicherheitsschleifchen, damit immer einer gefunden wird.
 	{
@@ -1261,7 +1261,7 @@ const SwCntntFrm *SwLayoutFrm::GetCntntP
 					if( !pInside || ( pInside->IsAnLower( pCntnt ) &&
 						( !pCntnt->IsInFtn() || pInside->IsFtnContFrm() ) ) )
 					{
-						const ULONG nDiff = ::CalcDiff( aCntntPoint, rPoint );
+						const sal_uInt32 nDiff = ::CalcDiff( aCntntPoint, rPoint );
 						BOOL bBetter = nDiff < nDistance;  // Dichter dran
 						if( !pInside )
 						{
@@ -1422,7 +1422,7 @@ void SwPageFrm::GetCntntPosition( const 
 
 	const SwCntntFrm *pAct = pCntnt;
 	Point aAct 		 = rPt;
-	ULONG nDist		 = ULONG_MAX;
+	sal_uInt32 nDist = SAL_MAX_UINT32;
 
 	while ( pCntnt )
 	{
@@ -1449,7 +1449,7 @@ void SwPageFrm::GetCntntPosition( const 
 		else if ( aCntFrm.Right() < rPt.X() )
 			aPoint.X() = aCntFrm.Right();
 
-		const ULONG nDiff = ::CalcDiff( aPoint, rPt );
+		const sal_uInt32 nDiff = ::CalcDiff( aPoint, rPt );
 		if ( nDiff < nDist )
 		{
 			aAct	= aPoint;
Index: sw/source/core/text/porlay.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/text/porlay.cxx,v
retrieving revision 1.53
retrieving revision 1.48.94.3
diff -u -p -u -p -r1.53 -r1.48.94.3
--- sw/source/core/text/porlay.cxx	22 Oct 2004 08:13:56 -0000	1.53
+++ sw/source/core/text/porlay.cxx	18 Jan 2005 16:22:15 -0000	1.48.94.3
@@ -1503,7 +1503,7 @@ USHORT SwScriptInfo::HasKana( xub_StrLen
  *                      SwScriptInfo::Compress()
  *************************************************************************/
 
-long SwScriptInfo::Compress( long* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
+long SwScriptInfo::Compress( sal_Int32* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
                              const USHORT nCompress, const USHORT nFontHeight,
                              Point* pPoint ) const
 {
@@ -1619,7 +1619,7 @@ long SwScriptInfo::Compress( long* pKern
  *                      SwScriptInfo::KashidaJustify()
  *************************************************************************/
 
-USHORT SwScriptInfo::KashidaJustify( long* pKernArray, long* pScrArray,
+USHORT SwScriptInfo::KashidaJustify( sal_Int32* pKernArray, sal_Int32* pScrArray,
                                      xub_StrLen nStt, xub_StrLen nLen,
                                      USHORT nSpace ) const
 {
@@ -1706,8 +1706,8 @@ sal_Bool SwScriptInfo::IsArabicLanguage(
  *                      SwScriptInfo::ThaiJustify()
  *************************************************************************/
 
-USHORT SwScriptInfo::ThaiJustify( const XubString& rTxt, long* pKernArray,
-                                  long* pScrArray, xub_StrLen nStt,
+USHORT SwScriptInfo::ThaiJustify( const XubString& rTxt, sal_Int32* pKernArray,
+                                  sal_Int32* pScrArray, xub_StrLen nStt,
                                   xub_StrLen nLen, xub_StrLen nNumberOfBlanks,
                                   long nSpaceAdd )
 {
Index: sw/source/core/txtnode/fntcache.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/txtnode/fntcache.cxx,v
retrieving revision 1.77
retrieving revision 1.76.270.2
diff -u -p -u -p -r1.77 -r1.76.270.2
--- sw/source/core/txtnode/fntcache.cxx	12 Aug 2004 12:39:51 -0000	1.77
+++ sw/source/core/txtnode/fntcache.cxx	20 Oct 2004 12:19:12 -0000	1.76.270.2
@@ -1018,7 +1018,7 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         if ( pGrid && GRID_LINES_CHARS == pGrid->GetGridType() )
         {
             const USHORT nGridWidth = pGrid->GetBaseHeight();
-            long* pKernArray = new long[rInf.GetLen()];
+            sal_Int32* pKernArray = new sal_Int32[rInf.GetLen()];
 
             if ( pPrinter )
                 pPrinter->GetTextArray( rInf.GetText(), pKernArray,
@@ -1119,7 +1119,7 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         // Simple kerning is handled by DrawStretchText
         if( rInf.GetSpace() || rInf.GetKanaComp() )
         {
-            long *pKernArray = new long[ rInf.GetLen() ];
+            sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                        rInf.GetIdx(), rInf.GetLen() );
 
@@ -1330,12 +1330,12 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         BOOL bBullet = rInf.GetBullet();
         if( bSymbol )
             bBullet = FALSE;
-        long *pKernArray = new long[ rInf.GetLen() ];
+        sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
         CreateScrFont( *rInf.GetShell(), rInf.GetOut() );
         long nScrPos;
 
         // get screen array
-        long* pScrArray = new long[ rInf.GetLen() ];
+        sal_Int32* pScrArray = new sal_Int32[ rInf.GetLen() ];
         rInf.GetOut().GetTextArray( rInf.GetText(), pScrArray,
                                     rInf.GetIdx(), rInf.GetLen() );
 
@@ -1902,7 +1902,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
 		aTxtSize.Width() = pPrinter->GetTextWidth( rInf.GetText(),
                                                    rInf.GetIdx(), nLn );
 		aTxtSize.Height() = pPrinter->GetTextHeight();
-		long *pKernArray = new long[nLn];
+		sal_Int32 *pKernArray = new sal_Int32[nLn];
         CreateScrFont( *rInf.GetShell(), rInf.GetOut() );
         if( !GetScrFont()->IsSameInstance( rInf.GetOut().GetFont() ) )
             rInf.GetOut().SetFont( *pScrFont );
@@ -1920,7 +1920,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
             nScrPos = pKernArray[ nLn - 1 ];
         else
         {
-            long* pScrArray = new long[ rInf.GetLen() ];
+            sal_Int32* pScrArray = new sal_Int32[ rInf.GetLen() ];
             rInf.GetOut().GetTextArray( rInf.GetText(), pScrArray,
                                         rInf.GetIdx(), rInf.GetLen() );
             nScrPos = pScrArray[ 0 ];
@@ -1971,7 +1971,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
             rInf.GetOut().SetFont( *pPrtFont );
 		if( bCompress )
 		{
-			long *pKernArray = new long[nLn];
+			sal_Int32 *pKernArray = new sal_Int32[nLn];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                         rInf.GetIdx(), nLn );
             rInf.SetKanaDiff( rInf.GetScriptInfo()->Compress( pKernArray,
@@ -2032,7 +2032,7 @@ xub_StrLen SwFntObj::GetCrsrOfst( SwDraw
     if( 0 != nSperren )
         nKern -= nSperren;
 
-    long *pKernArray = new long[ rInf.GetLen() ];
+    sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
 
     if ( pPrinter )
     {
@@ -2329,7 +2329,7 @@ xub_StrLen SwFont::GetTxtBreak( SwDrawTe
         {
             const USHORT nGridWidth = pGrid->GetBaseHeight();
 
-            long* pKernArray = new long[rInf.GetLen()];
+            sal_Int32* pKernArray = new sal_Int32[rInf.GetLen()];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                         rInf.GetIdx(), rInf.GetLen() );
 
@@ -2431,7 +2431,7 @@ xub_StrLen SwFont::GetTxtBreak( SwDrawTe
 			nLn = 1;
 		else if( nLn > 2 * nTxtBreak )
 			nLn = 2 * nTxtBreak;
-		long *pKernArray = new long[ nLn ];
+		sal_Int32 *pKernArray = new sal_Int32[ nLn ];
 		rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
 									rInf.GetIdx(), nLn );
         if( rInf.GetScriptInfo()->Compress( pKernArray, rInf.GetIdx(), nLn,
Index: sw/source/core/txtnode/txtedt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/txtnode/txtedt.cxx,v
retrieving revision 1.63
retrieving revision 1.53.92.4
diff -u -p -u -p -r1.63 -r1.53.92.4
--- sw/source/core/txtnode/txtedt.cxx	1 Mar 2005 15:24:39 -0000	1.63
+++ sw/source/core/txtnode/txtedt.cxx	10 Mar 2005 01:58:06 -0000	1.53.92.4
@@ -623,12 +623,12 @@ BOOL SwScanner::NextWord()
                 pBreakIt->xBreak->getScriptType( rText, nBegin );
 
         XubString aTmpWord = rText.Copy( nBegin, static_cast<xub_StrLen>(aBound.endPos - nBegin) );
-        const long nScriptEnd = nBegin +
+        const sal_Int32 nScriptEnd = nBegin +
             pBreakIt->xBreak->endOfScript( aTmpWord, 0, nCurrScript );
         const long nEnd = Min( aBound.endPos, nScriptEnd );
 
         // restrict word start to last script change position
-        long nScriptBegin = 0;
+        sal_Int32 nScriptBegin = 0;
         if ( aBound.startPos < nBegin )
         {
             // search from nBegin backwards until the next script change
@@ -646,7 +646,7 @@ BOOL SwScanner::NextWord()
                 pBreakIt->xBreak->getScriptType( rText, aBound.startPos );
         XubString aTmpWord = rText.Copy( static_cast<xub_StrLen>(aBound.startPos),
                                          static_cast<xub_StrLen>(aBound.endPos - aBound.startPos) );
-        const long nScriptEnd = aBound.startPos +
+        const sal_Int32 nScriptEnd = aBound.startPos +
             pBreakIt->xBreak->endOfScript( aTmpWord, 0, nCurrScript );
         const long nEnd = Min( aBound.endPos, nScriptEnd );
         nBegin = (xub_StrLen)aBound.startPos;
@@ -1349,7 +1349,7 @@ void SwTxtNode::TransliterateText( utl::
 			}
 			xub_StrLen nLen = nEndPos - nStart;
 
-			Sequence <long> aOffsets;
+			Sequence <sal_Int32> aOffsets;
 			String sChgd( rTrans.transliterate( aText, nLang, nStart, nLen,
 													&aOffsets ));
 			if( !aText.Equals( sChgd, nStart, nLen ) )
@@ -1367,12 +1367,12 @@ void SwTxtNode::TransliterateText( utl::
 
 void SwTxtNode::ReplaceTextOnly( xub_StrLen nPos, xub_StrLen nLen,
 								const XubString& rText,
-								const Sequence<long>& rOffsets )
+								const Sequence<sal_Int32>& rOffsets )
 {
 	aText.Replace( nPos, nLen, rText );
 
 	xub_StrLen nTLen = rText.Len();
-	const long* pOffsets = rOffsets.getConstArray();
+	const sal_Int32* pOffsets = rOffsets.getConstArray();
 	// now look for no 1-1 mapping -> move the indizies!
 	xub_StrLen nI, nMyOff;
 	for( nI = 0, nMyOff = nPos; nI < nTLen; ++nI, ++nMyOff )
Index: sw/source/core/undo/unovwr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/undo/unovwr.cxx,v
retrieving revision 1.13
retrieving revision 1.12.64.2
diff -u -p -u -p -r1.13 -r1.12.64.2
--- sw/source/core/undo/unovwr.cxx	8 Sep 2004 15:00:49 -0000	1.13
+++ sw/source/core/undo/unovwr.cxx	20 Oct 2004 12:00:44 -0000	1.12.64.2
@@ -411,7 +411,7 @@ struct _UndoTransliterate_Data
 	String sText;
 	_UndoTransliterate_Data* pNext;
 	SwHistory* pHistory;
-	Sequence <long>* pOffsets;
+	Sequence <sal_Int32>* pOffsets;
 	ULONG nNdIdx;
 	xub_StrLen nStart, nLen;
 
@@ -478,7 +478,7 @@ void SwUndoTransliterate::Repeat( SwUndo
 
 void SwUndoTransliterate::AddChanges( const SwTxtNode& rTNd,
 					xub_StrLen nStart, xub_StrLen nLen,
-		 			::com::sun::star::uno::Sequence <long>& rOffsets )
+		 			::com::sun::star::uno::Sequence <sal_Int32>& rOffsets )
 {
 	long nOffsLen = rOffsets.getLength();
 	_UndoTransliterate_Data* pNew = new _UndoTransliterate_Data(
@@ -490,17 +490,17 @@ void SwUndoTransliterate::AddChanges( co
 		pData = pNew;
 	pLastData = pNew;
 
-	const long* pOffsets = rOffsets.getConstArray();
+	const sal_Int32* pOffsets = rOffsets.getConstArray();
 	// where did we need less memory ?
 	// check for 1-1 mappings:
 	BOOL bOneToOne = TRUE;
-	const long* p = pOffsets;
+	const sal_Int32* p = pOffsets;
 	for( long n = 0; n < nOffsLen; ++n, ++p )
 		if( *p != ( nStart + n ))
 		{
 			// create the Offset array
-			pNew->pOffsets = new Sequence <long> ( nLen );
-			long* pIdx = pNew->pOffsets->getArray();
+			pNew->pOffsets = new Sequence <sal_Int32> ( nLen );
+			sal_Int32* pIdx = pNew->pOffsets->getArray();
 			p = pOffsets;
 			long nMyOff, nNewVal = nStart;
 			for( n = 0, nMyOff = nStart; n < nOffsLen; ++p, ++n, ++nMyOff )
@@ -554,12 +554,12 @@ void _UndoTransliterate_Data::SetChangeA
 	SwTxtNode* pTNd = rDoc.GetNodes()[ nNdIdx ]->GetTxtNode();
 	if( pTNd )
 	{
-		Sequence <long> aOffsets( pOffsets ? pOffsets->getLength() : nLen );
+		Sequence <sal_Int32> aOffsets( pOffsets ? pOffsets->getLength() : nLen );
 		if( pOffsets )
 			aOffsets = *pOffsets;
 		else
 		{
-			long* p = aOffsets.getArray();
+			sal_Int32* p = aOffsets.getArray();
 			for( xub_StrLen n = 0; n < nLen; ++n, ++p )
 				*p = n + nStart;
 		}
Index: sw/source/core/unocore/unoobj.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unoobj.cxx,v
retrieving revision 1.84
retrieving revision 1.82.8.2
diff -u -p -u -p -r1.84 -r1.82.8.2
--- sw/source/core/unocore/unoobj.cxx	22 Feb 2005 10:03:29 -0000	1.84
+++ sw/source/core/unocore/unoobj.cxx	10 Mar 2005 01:58:48 -0000	1.82.8.2
@@ -913,14 +913,14 @@ SwFmtColl* SwXTextCursor::GetCurTxtFmtCo
 	sal_Bool bError = sal_False;
 	FOREACHUNOPAM_START(&rPam)
 
-		sal_uInt32 nSttNd = PUNOPAM->GetMark()->nNode.GetIndex(),
+		ULONG nSttNd = PUNOPAM->GetMark()->nNode.GetIndex(),
 			  nEndNd = PUNOPAM->GetPoint()->nNode.GetIndex();
 		xub_StrLen nSttCnt = PUNOPAM->GetMark()->nContent.GetIndex(),
 				nEndCnt = PUNOPAM->GetPoint()->nContent.GetIndex();
 
 		if( nSttNd > nEndNd || ( nSttNd == nEndNd && nSttCnt > nEndCnt ))
 		{
-			sal_uInt32 nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
+			ULONG nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
 			nTmp = nSttCnt; nSttCnt = nEndCnt; nEndCnt = (sal_uInt16)nTmp;
 		}
 
@@ -931,7 +931,7 @@ SwFmtColl* SwXTextCursor::GetCurTxtFmtCo
 		}
 
 		const SwNodes& rNds = rPam.GetDoc()->GetNodes();
-		for( sal_uInt32 n = nSttNd; n <= nEndNd; ++n )
+		for( ULONG n = nSttNd; n <= nEndNd; ++n )
 		{
 			const SwTxtNode* pNd = rNds[ n ]->GetTxtNode();
 			if( pNd )
Index: sw/source/core/unocore/unoobj2.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unoobj2.cxx,v
retrieving revision 1.49
retrieving revision 1.48.66.2
diff -u -p -u -p -r1.49 -r1.48.66.2
--- sw/source/core/unocore/unoobj2.cxx	27 Jan 2005 12:37:42 -0000	1.49
+++ sw/source/core/unocore/unoobj2.cxx	10 Mar 2005 01:59:27 -0000	1.48.66.2
@@ -1051,14 +1051,14 @@ void SwXTextCursor::GetCrsrAttr(SwPaM& r
 	SwPaM *_pStartCrsr = &rPam;
 	do
 	{
-		sal_uInt32 nSttNd = _pStartCrsr->GetMark()->nNode.GetIndex(),
+		ULONG nSttNd = _pStartCrsr->GetMark()->nNode.GetIndex(),
 					nEndNd = _pStartCrsr->GetPoint()->nNode.GetIndex();
 			xub_StrLen nSttCnt = _pStartCrsr->GetMark()->nContent.GetIndex(),
 					nEndCnt = _pStartCrsr->GetPoint()->nContent.GetIndex();
 
 			if( nSttNd > nEndNd || ( nSttNd == nEndNd && nSttCnt > nEndCnt ))
 			{
-				sal_uInt32 nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
+				ULONG nTmp = nSttNd; nSttNd = nEndNd; nEndNd = nTmp;
 				nTmp = nSttCnt; nSttCnt = nEndCnt; nEndCnt = (sal_uInt16)nTmp;
 			}
 
@@ -1071,7 +1071,7 @@ void SwXTextCursor::GetCrsrAttr(SwPaM& r
 
 			// beim 1.Node traegt der Node die Werte in den GetSet ein (Initial)
 			// alle weiteren Nodes werden zum GetSet zu gemergt
-			for( sal_uInt32 n = nSttNd; n <= nEndNd; ++n )
+			for( ULONG n = nSttNd; n <= nEndNd; ++n )
 			{
 				SwNode* pNd = rPam.GetDoc()->GetNodes()[ n ];
 				switch( pNd->GetNodeType() )
Index: sw/source/core/unocore/unosett.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/unocore/unosett.cxx,v
retrieving revision 1.40
retrieving revision 1.37.62.3
diff -u -p -u -p -r1.40 -r1.37.62.3
--- sw/source/core/unocore/unosett.cxx	26 Nov 2004 13:27:57 -0000	1.40
+++ sw/source/core/unocore/unosett.cxx	18 Jan 2005 16:42:15 -0000	1.37.62.3
@@ -1124,7 +1124,7 @@ void SwXLineNumberingProperties::setProp
 				{
 					INT32 nVal;
 					aValue >>= nVal;
-					aInfo.SetPosFromLeft(Min(MM100_TO_TWIP(nVal), sal_Int32(0xffff)));
+					aInfo.SetPosFromLeft(Min((sal_Int32)MM100_TO_TWIP(nVal), sal_Int32(0xffff)));
 				}
 				break;
 				case WID_INTERVAL   :
Index: sw/source/filter/excel/exctools.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/excel/exctools.cxx,v
retrieving revision 1.6
retrieving revision 1.6.96.1
diff -u -p -u -p -r1.6 -r1.6.96.1
--- sw/source/filter/excel/exctools.cxx	12 Aug 2004 12:46:36 -0000	1.6
+++ sw/source/filter/excel/exctools.cxx	21 Jan 2005 16:59:15 -0000	1.6.96.1
@@ -857,7 +857,7 @@ void XF_Buffer::SetItemSets(UINT16 nCol,
 }
 
 // --------------------------------------------- XF_Buffer::GetNumFormat -
-UINT32 XF_Buffer::GetNumFormat( UINT16 nIndex )
+sal_uInt32 XF_Buffer::GetNumFormat( UINT16 nIndex )
 	{
 //	DBG_ASSERT( nIndex < nCount ,
 //		"+XF_Buffer::GetNumFormat(): das ist zuviel des Guten!" );
@@ -1353,14 +1353,14 @@ void ValueFormBuffer::_NewValueFormat5( 
 	}
 
 //------------------------------------------------------------------------
-UINT32 ValueFormBuffer::__GetValueFormat( UINT16 nExcIndex )
+sal_uInt32 ValueFormBuffer::__GetValueFormat( UINT16 nExcIndex )
 	{
 	Init();
 	return ( this->*_GetValueFormat )( nExcIndex );
 	}
 
 //------------------------------------------------------------------------
-UINT32 ValueFormBuffer::_GetValueFormatX5( UINT16 nExcIndex )
+sal_uInt32 ValueFormBuffer::_GetValueFormatX5( UINT16 nExcIndex )
 	{
 	DBG_ASSERT( nExcIndex < nCount,
 		"+ValueFormBuffer::GetValueFormat(): Da kann ich auch nichts fuer!" );
Index: sw/source/filter/excel/excvfbff.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/excel/excvfbff.hxx,v
retrieving revision 1.2
retrieving revision 1.2.96.1
diff -u -p -u -p -r1.2 -r1.2.96.1
--- sw/source/filter/excel/excvfbff.hxx	12 Aug 2004 12:46:49 -0000	1.2
+++ sw/source/filter/excel/excvfbff.hxx	21 Jan 2005 16:59:22 -0000	1.2.96.1
@@ -76,18 +76,18 @@ typedef ULONG				( ValueFormBuffer::*Fkt
 #endif
 
 class ValueFormBuffer
-	{
+{
 	private:
 #if !defined(BLC) && !defined(MAC)
-// MSC will es auf jeden Fall hier
+		// MSC will es auf jeden Fall hier
 		typedef void		( ValueFormBuffer::*Fkt_rString )( String & );
-		typedef ULONG		( ValueFormBuffer::*Fkt_USHORT )( USHORT );
+		typedef sal_uInt32	( ValueFormBuffer::*Fkt_USHORT )( USHORT );
 #endif
 
-		ULONG				*pHandles;		// Array mit Handles...
+		sal_uInt32			*pHandles;		// Array mit Handles...
 		USHORT				nMax;  			// Groesse des Arrays
 		USHORT				nCount;			// Index des naechsten freien Eintrags
-		ULONG				nDefaultHandle;
+		sal_uInt32			nDefaultHandle;
 
 		// nur fuer Excel5
 		static const USHORT nAnzBuiltin;	// bekannte Formate
@@ -100,17 +100,17 @@ class ValueFormBuffer
 		void				Init( void );
 							// fuer 1. Nutzung
 		void				__NewValueFormat( String &rFormString );
-		ULONG				__GetValueFormat( USHORT nExcIndex );
+		sal_uInt32			__GetValueFormat( USHORT nExcIndex );
 							// fuer n-te Nutzung
 		void				_NewValueFormatX( String &rFormString );
 		void				_NewValueFormat5( String &rFormString );
-		ULONG				_GetValueFormatX5( USHORT nExcIndex );
+		sal_uInt32			_GetValueFormatX5( USHORT nExcIndex );
 	public:
 		ValueFormBuffer( const USHORT nSize = 2048 );
 		~ValueFormBuffer();
 
 		inline void			NewValueFormat( String &rFormString );
-		inline ULONG		GetValueFormat( USHORT nExcIndex );
+		inline sal_uInt32	GetValueFormat( USHORT nExcIndex );
 	};
 
 inline void ValueFormBuffer::NewValueFormat( String &rFormString )
@@ -118,7 +118,7 @@ inline void ValueFormBuffer::NewValueFor
 	( this->*_NewValueFormat )( rFormString );
 	}
 
-inline ULONG ValueFormBuffer::GetValueFormat( USHORT nExcIndex )
+inline sal_uInt32 ValueFormBuffer::GetValueFormat( USHORT nExcIndex )
 	{
 	return ( this->*_GetValueFormat )( nExcIndex );
 	}
Index: sw/source/filter/excel/excxfbuf.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/excel/excxfbuf.hxx,v
retrieving revision 1.2
retrieving revision 1.2.96.1
diff -u -p -u -p -r1.2 -r1.2.96.1
--- sw/source/filter/excel/excxfbuf.hxx	12 Aug 2004 12:47:02 -0000	1.2
+++ sw/source/filter/excel/excxfbuf.hxx	21 Jan 2005 16:59:28 -0000	1.2.96.1
@@ -232,7 +232,7 @@ class XF_Buffer
 		inline void		GetItemSets( USHORT nIndex, const SfxItemSet *pTxtAttr,
 							const SfxItemSet *pBoxAttr );
 
-		ULONG			GetNumFormat( USHORT nIndex );
+		sal_uInt32		GetNumFormat( USHORT nIndex );
 		void			SetItemSets( USHORT nCol, USHORT nSR, USHORT nER,
 							USHORT nXF );
 	};
Index: sw/source/filter/html/css1atr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/css1atr.cxx,v
retrieving revision 1.29
retrieving revision 1.29.8.1
diff -u -p -u -p -r1.29 -r1.29.8.1
--- sw/source/filter/html/css1atr.cxx	11 Jan 2005 12:25:00 -0000	1.29
+++ sw/source/filter/html/css1atr.cxx	21 Jan 2005 16:59:40 -0000	1.29.8.1
@@ -2246,7 +2246,7 @@ Writer& OutCSS1_NumBulListStyleOpt( Writ
 //-----------------------------------------------------------------------
 
 void SwHTMLWriter::OutCSS1_FrmFmtOptions( const SwFrmFmt& rFrmFmt,
-										  ULONG nFrmOpts,
+										  sal_uInt32 nFrmOpts,
 										  const SdrObject *pSdrObj,
 										  const SfxItemSet *pItemSet )
 {
Index: sw/source/filter/html/htmlatr.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlatr.cxx,v
retrieving revision 1.26
retrieving revision 1.26.34.1
diff -u -p -u -p -r1.26 -r1.26.34.1
--- sw/source/filter/html/htmlatr.cxx	5 Jan 2005 13:40:52 -0000	1.26
+++ sw/source/filter/html/htmlatr.cxx	21 Jan 2005 16:59:53 -0000	1.26.34.1
@@ -2905,7 +2905,7 @@ Writer& OutHTML_SwTxtNode( Writer& rWrt,
 }
 
 
-ULONG SwHTMLWriter::ToPixel( ULONG nVal ) const
+sal_uInt32 SwHTMLWriter::ToPixel( sal_uInt32 nVal ) const
 {
 	if( Application::GetDefaultDevice() && nVal )
 	{
Index: sw/source/filter/html/htmlcss1.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlcss1.cxx,v
retrieving revision 1.17
retrieving revision 1.16.8.2
diff -u -p -u -p -r1.17 -r1.16.8.2
--- sw/source/filter/html/htmlcss1.cxx	25 Jan 2005 14:42:45 -0000	1.17
+++ sw/source/filter/html/htmlcss1.cxx	10 Mar 2005 02:03:18 -0000	1.16.8.2
@@ -209,7 +209,7 @@ void SwCSS1Parser::ChgPageDesc( const Sw
 	ASSERT( i<nPageDescs, "Seitenvorlage nicht gefunden" );
 }
 
-SwCSS1Parser::SwCSS1Parser( SwDoc *pD, ULONG aFHeights[7], const String& rBaseURL, BOOL bNewDoc ) :
+SwCSS1Parser::SwCSS1Parser( SwDoc *pD, sal_uInt32 aFHeights[7], const String& rBaseURL, BOOL bNewDoc ) :
     SvxCSS1Parser( pD->GetAttrPool(), rBaseURL, MM50/2,
 				   (USHORT*)&aItemIds, sizeof(aItemIds) / sizeof(USHORT) ),
 	nDropCapCnt( 0 ), bIsNewDoc( bNewDoc ), pDoc( pD ),
@@ -1239,7 +1239,7 @@ BOOL SwCSS1Parser::StyleParsed( const CS
 	return TRUE;
 }
 
-ULONG SwCSS1Parser::GetFontHeight( USHORT nSize ) const
+sal_uInt32 SwCSS1Parser::GetFontHeight( USHORT nSize ) const
 {
 	return aFontHeights[ nSize>6 ? 6 : nSize ];
 }
Index: sw/source/filter/html/htmlfld.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlfld.cxx,v
retrieving revision 1.7
retrieving revision 1.7.262.1
diff -u -p -u -p -r1.7 -r1.7.262.1
--- sw/source/filter/html/htmlfld.cxx	1 Dec 2003 17:25:47 -0000	1.7
+++ sw/source/filter/html/htmlfld.cxx	21 Jan 2005 17:00:10 -0000	1.7.262.1
@@ -429,7 +429,7 @@ void SwHTMLParser::NewField()
 			USHORT nSub = 0;
 
 			SvNumberFormatter *pFormatter =	pDoc->GetNumberFormatter();
-			ULONG nNumFmt;
+			sal_uInt32 nNumFmt;
 			LanguageType eLang;
 			double dValue = GetTableDataOptionsValNum(
 								nNumFmt, eLang, aNumValue, aNumFmt,
@@ -500,7 +500,7 @@ void SwHTMLParser::NewField()
 					nSub |= nExtSub;
 				}
 
-				ULONG nNumFmt = 0;
+				sal_uInt32 nNumFmt = 0;
 				double dValue = 0;
 				if( bHasNumFmt && (DI_SUB_DATE==nExtSub || DI_SUB_TIME==nExtSub) )
 				{
Index: sw/source/filter/html/htmlfly.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlfly.cxx,v
retrieving revision 1.20
retrieving revision 1.20.8.1
diff -u -p -u -p -r1.20 -r1.20.8.1
--- sw/source/filter/html/htmlfly.cxx	11 Jan 2005 12:25:53 -0000	1.20
+++ sw/source/filter/html/htmlfly.cxx	21 Jan 2005 17:00:20 -0000	1.20.8.1
@@ -466,7 +466,7 @@ void SwHTMLWriter::CollectFlyFrms()
 	}
 }
 
-BOOL SwHTMLWriter::OutFlyFrm( ULONG nNdIdx, xub_StrLen nCntntIdx, BYTE nPos, 
+BOOL SwHTMLWriter::OutFlyFrm( sal_uInt32 nNdIdx, xub_StrLen nCntntIdx, BYTE nPos,
 							  HTMLOutContext *pContext )
 {
 	BOOL bFlysLeft = FALSE;	// Noch Flys an aktueller Node-Position da?
@@ -636,7 +636,7 @@ void SwHTMLWriter::OutFrmFmt( BYTE nMode
 void SwHTMLWriter::OutFrmFmtOptions( const SwFrmFmt &rFrmFmt,
 									 const String& rAlternateTxt,
 									 ByteString &rEndTags,
-									 ULONG nFrmOpts )
+									 sal_uInt32 nFrmOpts )
 {
 	ByteString sOut;
 	const SfxPoolItem* pItem;
@@ -907,7 +907,7 @@ void SwHTMLWriter::OutFrmFmtOptions( con
 
 Writer& OutHTML_Image( Writer& rWrt, const SwFrmFmt &rFrmFmt,
 					   const String &rGrfName, const String& rAlternateTxt,
-					   const Size &rRealSize, ULONG nFrmOpts,
+					   const Size &rRealSize, sal_uInt32 nFrmOpts,
 					   const sal_Char *pMarkType,
 					   const ImageMap *pAltImgMap )
 {
@@ -1651,7 +1651,7 @@ static Writer & OutHTML_FrmFmtAsImage( W
         INetURLObject(rWrt.GetBaseURL()), aGrfNm,
         URIHelper::GetMaybeFileHdl() );
 	Size aSz( 0, 0 );
-	ULONG nFrmFlags = bInCntnr ? HTML_FRMOPTS_GENIMG_CNTNR
+	sal_uInt32 nFrmFlags = bInCntnr ? HTML_FRMOPTS_GENIMG_CNTNR
 								: HTML_FRMOPTS_GENIMG;
 	OutHTML_Image( rWrt, rFrmFmt, aGrfNm, rFrmFmt.GetName(), aSz,
 					HTML_FRMOPTS_GENIMG, pMarkToFrame,
@@ -1716,7 +1716,7 @@ static Writer& OutHTML_FrmFmtGrfNode( Wr
 			rWrt.CopyLocalFileToINet( aGrfNm );
 	}
 
-	ULONG nFrmFlags = bInCntnr ? HTML_FRMOPTS_IMG_CNTNR : HTML_FRMOPTS_IMG;
+	sal_uInt32 nFrmFlags = bInCntnr ? HTML_FRMOPTS_IMG_CNTNR : HTML_FRMOPTS_IMG;
 	if( rHTMLWrt.IsHTMLMode( HTMLMODE_ABS_POS_FLY ) && !bInCntnr )
 		nFrmFlags |= HTML_FRMOPTS_IMG_CSS1;
 	OutHTML_Image( rWrt, rFrmFmt, aGrfNm, pGrfNd->GetAlternateText(),
Index: sw/source/filter/html/htmlforw.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlforw.cxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/htmlforw.cxx	11 Jan 2005 12:26:29 -0000	1.12
+++ sw/source/filter/html/htmlforw.cxx	21 Jan 2005 17:00:33 -0000	1.12.8.1
@@ -444,7 +444,7 @@ void SwHTMLWriter::OutForm( sal_Bool bTa
             aHTMLControls[i]->nNdIdx <= nEndIdx; i++ )
         {
             const SwStartNode *pCntrlStNd =
-                pDoc->GetNodes()[aHTMLControls[i]->nNdIdx]->FindStartNode();
+                pDoc->GetNodes()[ ULONG( aHTMLControls[i]->nNdIdx ) ]->FindStartNode();
 
             if( xCurrentFormComps.is() )
             {
Index: sw/source/filter/html/htmlnum.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlnum.cxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/htmlnum.cxx	11 Jan 2005 12:26:57 -0000	1.12
+++ sw/source/filter/html/htmlnum.cxx	21 Jan 2005 17:00:41 -0000	1.12.8.1
@@ -748,7 +748,7 @@ void SwHTMLWriter::FillNextNumInfo()
 {
 	pNextNumRuleInfo = 0;
 
-	sal_uInt32 nPos = pCurPam->GetPoint()->nNode.GetIndex() + 1;
+	ULONG nPos = pCurPam->GetPoint()->nNode.GetIndex() + 1;
 
 	sal_Bool bDone = sal_False;
 	sal_Bool bTable = sal_False;
@@ -823,7 +823,7 @@ Writer& OutHTML_NumBulListStart( SwHTMLW
 				bStartValue = sal_True;
 				if( rInfo.GetDepth() > 1 )
 				{
-					sal_uInt32 nPos =
+					ULONG nPos =
 						rWrt.pCurPam->GetPoint()->nNode.GetIndex() + 1;
 					do
 					{
Index: sw/source/filter/html/htmlsect.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmlsect.cxx,v
retrieving revision 1.11
retrieving revision 1.11.8.1
diff -u -p -u -p -r1.11 -r1.11.8.1
--- sw/source/filter/html/htmlsect.cxx	11 Jan 2005 12:27:24 -0000	1.11
+++ sw/source/filter/html/htmlsect.cxx	21 Jan 2005 17:00:48 -0000	1.11.8.1
@@ -506,7 +506,7 @@ void SwHTMLParser::FixHeaderFooterDistan
 	const SwFmtCntnt& rFlyCntnt = pHdFtFmt->GetCntnt();
 	const SwNodeIndex& rCntntStIdx = *rFlyCntnt.GetCntntIdx();
 
-	sal_uInt32 nPrvNxtIdx;
+	ULONG nPrvNxtIdx;
 	if( bHeader )
 	{
 		nPrvNxtIdx = pDoc->GetNodes()[rCntntStIdx]->EndOfSectionIndex()-1;
@@ -881,7 +881,7 @@ void SwHTMLParser::InsertFlyFrame( const
 /*  */
 
 void SwHTMLParser::MovePageDescAttrs( SwNode *pSrcNd,
-									  sal_uInt32 nDestIdx,
+									  ULONG nDestIdx,
 									  sal_Bool bFmtBreak )
 {
 	SwCntntNode* pDestCntntNd =
Index: sw/source/filter/html/htmltabw.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/htmltabw.cxx,v
retrieving revision 1.10
retrieving revision 1.10.84.1
diff -u -p -u -p -r1.10 -r1.10.84.1
--- sw/source/filter/html/htmltabw.cxx	3 May 2004 13:49:32 -0000	1.10
+++ sw/source/filter/html/htmltabw.cxx	21 Jan 2005 17:00:56 -0000	1.10.84.1
@@ -415,7 +415,7 @@ void SwHTMLWrtTable::OutTableCell( SwHTM
 	sal_Bool bHead = sal_False;
 	if( pSttNd )
 	{
-		sal_uInt32 nNdPos = pSttNd->GetIndex()+1;
+		ULONG nNdPos = pSttNd->GetIndex()+1;
 
 		// Art der Zelle (TD/TH) bestimmen
 		SwNode* pNd;
Index: sw/source/filter/html/svxcss1.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/svxcss1.cxx,v
retrieving revision 1.8
retrieving revision 1.8.8.1
diff -u -p -u -p -r1.8 -r1.8.8.1
--- sw/source/filter/html/svxcss1.cxx	11 Jan 2005 12:28:00 -0000	1.8
+++ sw/source/filter/html/svxcss1.cxx	21 Jan 2005 17:01:04 -0000	1.8.8.1
@@ -1066,7 +1066,7 @@ void SvxCSS1Parser::SetBorderWidth( SvxB
 	aBorderLine.SetDistance( aWidths[i+3] );
 }
 
-ULONG SvxCSS1Parser::GetFontHeight( USHORT nSize ) const
+sal_uInt32 SvxCSS1Parser::GetFontHeight( USHORT nSize ) const
 {
 	USHORT nHeight;
 
Index: sw/source/filter/html/swcss1.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/swcss1.hxx,v
retrieving revision 1.3
retrieving revision 1.3.8.1
diff -u -p -u -p -r1.3 -r1.3.8.1
--- sw/source/filter/html/swcss1.hxx	11 Jan 2005 12:28:27 -0000	1.3
+++ sw/source/filter/html/swcss1.hxx	21 Jan 2005 17:01:09 -0000	1.3.8.1
@@ -85,7 +85,7 @@ class SwCSS1Parser : public SvxCSS1Parse
 {
 	SwDoc *pDoc;
 
-	ULONG aFontHeights[7];
+	sal_uInt32 aFontHeights[7];
 
 	USHORT nDropCapCnt;
 
@@ -118,13 +118,13 @@ protected:
 							  SfxItemSet& rItemSet,
 							  SvxCSS1PropertyInfo& rPropInfo );
 public:
-    SwCSS1Parser( SwDoc *pDoc, ULONG aFHeight[7], const String& rBaseURL, BOOL bNewDoc );
+    SwCSS1Parser( SwDoc *pDoc, sal_uInt32 aFHeight[7], const String& rBaseURL, BOOL bNewDoc );
 	virtual ~SwCSS1Parser();
 
 	virtual BOOL ParseStyleSheet( const String& rIn );
 
 	// Die Font-Hoehe fuer eine bestimmte Font-Groesse (0-6) ermitteln
-	virtual ULONG GetFontHeight( USHORT nSize ) const;
+	virtual sal_uInt32 GetFontHeight( USHORT nSize ) const;
 
 	// Die aktuelle Font-Liste holen (auch 0 ist erlaubt)
 	virtual const FontList *GetFontList() const;
Index: sw/source/filter/html/swhtml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/swhtml.hxx,v
retrieving revision 1.10
retrieving revision 1.10.8.1
diff -u -p -u -p -r1.10 -r1.10.8.1
--- sw/source/filter/html/swhtml.hxx	11 Jan 2005 12:28:56 -0000	1.10
+++ sw/source/filter/html/swhtml.hxx	21 Jan 2005 17:01:23 -0000	1.10.8.1
@@ -638,7 +638,7 @@ class SwHTMLParser : public SfxHTMLParse
 	void GetULSpaceFromContext( sal_uInt16 &rUpper, sal_uInt16 &rLower ) const;
 
 
-	void MovePageDescAttrs( SwNode *pSrcNd, sal_uInt32 nDestIdx, sal_Bool bFmtBreak );
+	void MovePageDescAttrs( SwNode *pSrcNd, ULONG nDestIdx, sal_Bool bFmtBreak );
 
 	// Behandlung von Tags auf Absatz-Ebene
 
Index: sw/source/filter/html/wrthtml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/wrthtml.cxx,v
retrieving revision 1.29
retrieving revision 1.29.8.1
diff -u -p -u -p -r1.29 -r1.29.8.1
--- sw/source/filter/html/wrthtml.cxx	11 Jan 2005 12:29:10 -0000	1.29
+++ sw/source/filter/html/wrthtml.cxx	21 Jan 2005 17:01:35 -0000	1.29.8.1
@@ -288,7 +288,7 @@ __EXPORT SwHTMLWriter::~SwHTMLWriter()
 	delete pNumRuleInfo;
 }
 
-sal_uInt32 SwHTMLWriter::WriteStream()
+ULONG SwHTMLWriter::WriteStream()
 {
 	// neue Konfiguration setzen
 	SvxHtmlOptions* pHtmlOptions = SvxHtmlOptions::Get();
@@ -657,7 +657,7 @@ const SwFmtCol *lcl_html_GetFmtCol( cons
 	return pCol;
 }
 
-sal_Bool lcl_html_IsMultiColStart( const SwHTMLWriter& rHTMLWrt, sal_uInt32 nIndex )
+sal_Bool lcl_html_IsMultiColStart( const SwHTMLWriter& rHTMLWrt, ULONG nIndex )
 {
 	sal_Bool bRet = sal_False;
 	const SwSectionNode *pSectNd =
@@ -673,7 +673,7 @@ sal_Bool lcl_html_IsMultiColStart( const
 	return bRet;
 }
 
-sal_Bool lcl_html_IsMultiColEnd( const SwHTMLWriter& rHTMLWrt, sal_uInt32 nIndex )
+sal_Bool lcl_html_IsMultiColEnd( const SwHTMLWriter& rHTMLWrt, ULONG nIndex )
 {
 	sal_Bool bRet = sal_False;
 	const SwEndNode *pEndNd = rHTMLWrt.pDoc->GetNodes()[nIndex]->GetEndNode();
@@ -827,8 +827,8 @@ static Writer& OutHTML_Section( Writer& 
 	const SwSection *pSurrSection = 0;
 	const SwFmtCol *pSurrCol = 0;
 
-	sal_uInt32 nSectSttIdx = rSectNd.GetIndex();
-	sal_uInt32 nSectEndIdx = rSectNd.EndOfSectionIndex();
+	ULONG nSectSttIdx = rSectNd.GetIndex();
+	ULONG nSectEndIdx = rSectNd.EndOfSectionIndex();
 	const SwFmtCol *pCol = lcl_html_GetFmtCol( rHTMLWrt, rSection, *pFmt );
 	if( pCol )
 	{
@@ -1037,8 +1037,8 @@ static void OutBodyColor( const sal_Char
 
 sal_uInt16 SwHTMLWriter::OutHeaderAttrs()
 {
-	sal_uInt32 nIdx = pCurPam->GetPoint()->nNode.GetIndex();
-	sal_uInt32 nEndIdx = pCurPam->GetMark()->nNode.GetIndex();
+	ULONG nIdx = pCurPam->GetPoint()->nNode.GetIndex();
+	ULONG nEndIdx = pCurPam->GetMark()->nNode.GetIndex();
 
 	SwTxtNode *pTxtNd = 0;
 	while( nIdx<=nEndIdx &&
@@ -1112,7 +1112,7 @@ const SwPageDesc *SwHTMLWriter::MakeHead
 	//{
 		// In Nicht-HTML-Dokumenten wird die erste gesetzte Seitenvorlage
 		// exportiert und wenn keine gesetzt ist die Standard-Vorlage
-		sal_uInt32 nNodeIdx = pCurPam->GetPoint()->nNode.GetIndex();
+		ULONG nNodeIdx = pCurPam->GetPoint()->nNode.GetIndex();
 
 		while( nNodeIdx < pDoc->GetNodes().Count() )
 		{
@@ -1495,8 +1495,8 @@ sal_uInt16 SwHTMLWriter::GetHTMLFontSize
 
 // Struktur speichert die aktuellen Daten des Writers zwischen, um
 // einen anderen Dokument-Teil auszugeben, wie z.B. Header/Footer
-HTMLSaveData::HTMLSaveData( SwHTMLWriter& rWriter, sal_uInt32 nStt,
-							sal_uInt32 nEnd, sal_Bool bSaveNum,
+HTMLSaveData::HTMLSaveData( SwHTMLWriter& rWriter, ULONG nStt,
+							ULONG nEnd, sal_Bool bSaveNum,
 	   					 	const SwFrmFmt *pFrmFmt	)
 	: rWrt( rWriter ),
 	pOldPam( rWrt.pCurPam ), pOldEnd( rWrt.GetEndPaM() ),
Index: sw/source/filter/html/wrthtml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/html/wrthtml.hxx,v
retrieving revision 1.12
retrieving revision 1.12.8.1
diff -u -p -u -p -r1.12 -r1.12.8.1
--- sw/source/filter/html/wrthtml.hxx	11 Jan 2005 12:29:25 -0000	1.12
+++ sw/source/filter/html/wrthtml.hxx	21 Jan 2005 17:01:49 -0000	1.12.8.1
@@ -260,7 +260,7 @@ class SwHTMLWriter : public Writer
 	void CollectLinkTargets();
 
 protected:
-	sal_uInt32 WriteStream();
+	ULONG WriteStream();
 
 public:
 #if defined(MAC) || defined(UNX)
@@ -588,7 +588,7 @@ struct HTMLSaveData
 	sal_Bool bOldOutFlyFrame : 1;
 	const SwFlyFrmFmt* pOldFlyFmt;
 
-	HTMLSaveData( SwHTMLWriter&, sal_uInt32 nStt, sal_uInt32 nEnd,
+	HTMLSaveData( SwHTMLWriter&, ULONG nStt, ULONG nEnd,
 				  sal_Bool bSaveNum=sal_True,
 		   		  const SwFrmFmt *pFrmFmt=0	);
 	~HTMLSaveData();
Index: sw/source/filter/w4w/w4wpar1.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/w4w/w4wpar1.cxx,v
retrieving revision 1.27
retrieving revision 1.26.8.2
diff -u -p -u -p -r1.27 -r1.26.8.2
--- sw/source/filter/w4w/w4wpar1.cxx	16 Feb 2005 17:47:34 -0000	1.27
+++ sw/source/filter/w4w/w4wpar1.cxx	10 Mar 2005 01:59:38 -0000	1.26.8.2
@@ -1951,7 +1951,7 @@ void SwW4WParser::Read_DateTime()			// (
 		// tell the Formatter about the new entry
 		UINT16 nCheckPos = 0;
 		INT16  nType = NUMBERFORMAT_DEFINED;
-		ULONG  nKey;
+		sal_uInt32 nKey;
 
 		pFormatter->PutandConvertEntry( *pFirst, nCheckPos, nType, nKey,
 										LANGUAGE_GERMAN,
Index: sw/source/filter/ww8/writerwordglue.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/writerwordglue.cxx,v
retrieving revision 1.13
retrieving revision 1.13.106.1
diff -u -p -u -p -r1.13 -r1.13.106.1
--- sw/source/filter/ww8/writerwordglue.cxx	16 Nov 2004 12:53:22 -0000	1.13
+++ sw/source/filter/ww8/writerwordglue.cxx	2 Mar 2005 15:55:09 -0000	1.13.106.1
@@ -931,8 +931,8 @@ namespace sw
         {
             // tell the Formatter about the new entry
             UINT16 nCheckPos = 0;
-            INT16  nType = NUMBERFORMAT_DEFINED;
-            ULONG  nKey = 0;
+            short  nType = NUMBERFORMAT_DEFINED;
+            sal_uInt32  nKey = 0;
 
             SwapQuotesInField(rParams);
 
Index: sw/source/filter/ww8/wrtw8esh.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtw8esh.cxx,v
retrieving revision 1.83
retrieving revision 1.77.8.5
diff -u -p -u -p -r1.83 -r1.77.8.5
--- sw/source/filter/ww8/wrtw8esh.cxx	22 Feb 2005 08:22:24 -0000	1.83
+++ sw/source/filter/ww8/wrtw8esh.cxx	10 Mar 2005 02:01:29 -0000	1.77.8.5
@@ -571,7 +571,7 @@ bool RTLGraphicsHack(long &rLeft, long n
     return bRet;
 }
 
-bool RTLDrawingsHack(long &rLeft, long nWidth,
+bool RTLDrawingsHack(long &rLeft, long nWidth, 
     SwHoriOrient eHoriOri, SwRelationOrient eHoriRel, SwTwips nPageLeft,
     SwTwips nPageRight, SwTwips nPageSize)
 {
@@ -603,7 +603,7 @@ bool SwWW8Writer::MiserableRTLFrmFmtHack
     if (FRMDIR_HORI_RIGHT_TOP != pDoc->GetTextDirection(rFrmFmt.GetPosition()))
         return false;
 
-    long nWidth = rRight - rLeft;
+    sal_Int32 nWidth = rRight - rLeft;
     SwTwips nPageLeft, nPageRight;
     SwTwips nPageSize = CurrentPageWidth(nPageLeft, nPageRight);
 
@@ -729,8 +729,8 @@ void PlcDrawObj::WritePlc(SwWW8Writer& r
             // spid
             SwWW8Writer::WriteLong(*rWrt.pTableStrm, aIter->mnShapeId);
 
-            sal_Int32 nLeft = aRect.Left() + nThick;
-            sal_Int32 nRight = aRect.Right() - nThick;
+            long nLeft = aRect.Left() + nThick;
+            long nRight = aRect.Right() - nThick;
 
             //Nasty swap for bidi if neccessary
             rWrt.MiserableRTLFrmFmtHack(nLeft, nRight, rFrmFmt);
@@ -883,7 +883,7 @@ bool WW8_WrPlcTxtBoxes::WriteTxt(SwWW8Wr
 {
     bool bRet = false;
     rWrt.bInWriteEscher = true;
-    long& rccp=TXT_TXTBOX == nTyp ? rWrt.pFib->ccpTxbx : rWrt.pFib->ccpHdrTxbx;
+    sal_Int32& rccp=TXT_TXTBOX == nTyp ? rWrt.pFib->ccpTxbx : rWrt.pFib->ccpHdrTxbx;
 
     bRet = WriteGenericTxt( rWrt, nTyp, rccp );
 
@@ -2085,13 +2085,13 @@ SwEscherEx::SwEscherEx(SvStream* pStrm, 
 
         EnterGroup( 0 );
 
-        ULONG nSecondShapeId = pSdrObjs == rWrt.pSdrObjs ? GetShapeID() : 0;
+        sal_uInt32 nSecondShapeId = pSdrObjs == rWrt.pSdrObjs ? GetShapeID() : 0;
 
         // write now all Writer-/DrawObjects
         DrawObjPointerVector aSorted;
         MakeZOrderArrAndFollowIds(pSdrObjs->GetObjArr(), aSorted);
 
-        ULONG nShapeId=0;
+        sal_uInt32 nShapeId=0;
         DrawObjPointerIter aEnd = aSorted.end();
         for (DrawObjPointerIter aIter = aSorted.begin(); aIter != aEnd; ++aIter)
         {
Index: sw/source/filter/ww8/wrtw8sty.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtw8sty.cxx,v
retrieving revision 1.33
retrieving revision 1.33.64.1
diff -u -p -u -p -r1.33 -r1.33.64.1
--- sw/source/filter/ww8/wrtw8sty.cxx	25 May 2004 15:11:16 -0000	1.33
+++ sw/source/filter/ww8/wrtw8sty.cxx	9 Sep 2004 09:53:06 -0000	1.33.64.1
@@ -1765,7 +1765,7 @@ void WW8_WrPlcPostIt::Append( WW8_CP nCp
 }
 
 bool WW8_WrPlcSubDoc::WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, 
-    long& rCount)
+    sal_Int32& rCount)
 {
     bool bRet = false;
     USHORT nLen = aCntnt.Count();
@@ -1862,7 +1862,7 @@ bool WW8_WrPlcSubDoc::WriteGenericTxt(Sw
 }
 
 void WW8_WrPlcSubDoc::WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp,
-    long& rTxtStart, long& rTxtCount, long& rRefStart, long& rRefCount ) const
+    WW8_FC& rTxtStart, sal_Int32& rTxtCount, WW8_FC& rRefStart, sal_Int32& rRefCount ) const
 {
     typedef ::std::vector<String>::iterator myiter;
 
Index: sw/source/filter/ww8/wrtww8.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtww8.cxx,v
retrieving revision 1.71
retrieving revision 1.67.8.4
diff -u -p -u -p -r1.71 -r1.67.8.4
--- sw/source/filter/ww8/wrtww8.cxx	18 Jan 2005 14:28:38 -0000	1.71
+++ sw/source/filter/ww8/wrtww8.cxx	10 Mar 2005 02:01:46 -0000	1.67.8.4
@@ -748,7 +748,7 @@ bool WW8_WrPlcFld::Write(SwWW8Writer& rW
     if( WW8_WrPlc1::Count() <= 1 )
         return false;
 
-    long *pfc, *plc;
+    sal_Int32 *pfc, *plc;
     switch (nTxtTyp)
     {
         case TXT_MAINTEXT:
Index: sw/source/filter/ww8/wrtww8.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/wrtww8.hxx,v
retrieving revision 1.64
retrieving revision 1.59.96.4
diff -u -p -u -p -r1.64 -r1.59.96.4
--- sw/source/filter/ww8/wrtww8.hxx	11 Jan 2005 12:35:05 -0000	1.64
+++ sw/source/filter/ww8/wrtww8.hxx	21 Jan 2005 17:02:05 -0000	1.59.96.4
@@ -765,9 +765,9 @@ protected:
     WW8_WrPlcSubDoc();
     virtual ~WW8_WrPlcSubDoc();
 
-    bool WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, long& rCount);
-    void WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp, long& rTxtStt,
-        long& rTxtCnt, long& rRefStt, long& rRefCnt ) const;
+    bool WriteGenericTxt(SwWW8Writer& rWrt, BYTE nTTyp, sal_Int32& rCount);
+    void WriteGenericPlc( SwWW8Writer& rWrt, BYTE nTTyp, WW8_FC& rTxtStt,
+        sal_Int32& rTxtCnt, WW8_FC& rRefStt, sal_Int32& rRefCnt ) const;
 
     virtual const SvULongs* GetShapeIdArr() const;
 };
Index: sw/source/filter/ww8/ww8glsy.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8glsy.cxx,v
retrieving revision 1.20
retrieving revision 1.18.238.3
diff -u -p -u -p -r1.20 -r1.18.238.3
--- sw/source/filter/ww8/ww8glsy.cxx	11 Jan 2005 12:35:37 -0000	1.20
+++ sw/source/filter/ww8/ww8glsy.cxx	18 Jan 2005 16:53:00 -0000	1.18.238.3
@@ -355,7 +355,7 @@ UINT32 WW8GlossaryFib::FindGlossaryFibOf
         SvStream &rStrm, const WW8Fib &rFib)
 {
     WW8PLCF aPlc( &rTableStrm, rFib.fcPlcfsed, rFib.lcbPlcfsed, 12 );
-    long start,ende;
+    WW8_CP start,ende;
     void *pData;
     aPlc.Get(start,ende,pData);
     UINT32 nPo = SVBT32ToLong((BYTE *)pData+2);
Index: sw/source/filter/ww8/ww8graf.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8graf.cxx,v
retrieving revision 1.129
retrieving revision 1.118.8.4
diff -u -p -u -p -r1.129 -r1.118.8.4
--- sw/source/filter/ww8/ww8graf.cxx	16 Feb 2005 17:02:17 -0000	1.129
+++ sw/source/filter/ww8/ww8graf.cxx	10 Mar 2005 02:00:44 -0000	1.118.8.4
@@ -978,7 +978,7 @@ void SwWW8ImplReader::InsertTxbxAttrs(lo
     aSave.Restore(this);
 }
 
-bool SwWW8ImplReader::GetTxbxTextSttEndCp(long& rStartCp, long& rEndCp,
+bool SwWW8ImplReader::GetTxbxTextSttEndCp(WW8_CP& rStartCp, WW8_CP& rEndCp,
     USHORT nTxBxS, USHORT nSequence)
 {
     // rasch den TextBox-PLCF greifen
@@ -1113,7 +1113,7 @@ SwFrmFmt* SwWW8ImplReader::InsertTxbxTex
     rbEraseTextObj = false;
 
     String aString;
-    long nStartCp, nEndCp;
+    WW8_CP nStartCp, nEndCp;
     bool bContainsGraphics = false;
     bool bTextWasRead = GetTxbxTextSttEndCp( nStartCp, nEndCp, nTxBxS,
         nSequence ) && GetTxbxText( aString, nStartCp, nEndCp );
@@ -1515,7 +1515,7 @@ SdrObject* SwWW8ImplReader::ReadGrafPrim
 void SwWW8ImplReader::ReadGrafLayer1( WW8PLCFspecial* pPF, long nGrafAnchorCp )
 {
     pPF->SeekPos( nGrafAnchorCp );
-    long nStartFc;
+    WW8_CP nStartFc;
     void* pF0;
     if( !pPF->Get( nStartFc, pF0 ) )
     {
@@ -2618,7 +2618,7 @@ SwFrmFmt* SwWW8ImplReader::Read_GrafLaye
     //Normal case of Word 8+ version stuff
     pPF->SeekPos( nGrafAnchorCp );
 
-    long nStartFc;
+    WW8_CP nStartFc;
     void* pF0;
     if( !pPF->Get( nStartFc, pF0 ) ){
         ASSERT( !this, "+Wo ist die Grafik (2) ?" );
Index: sw/source/filter/ww8/ww8par.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par.cxx,v
retrieving revision 1.151
retrieving revision 1.136.64.5
diff -u -p -u -p -r1.151 -r1.136.64.5
--- sw/source/filter/ww8/ww8par.cxx	22 Feb 2005 10:03:56 -0000	1.151
+++ sw/source/filter/ww8/ww8par.cxx	10 Mar 2005 02:01:38 -0000	1.136.64.5
@@ -2787,7 +2787,7 @@ bool SwWW8ImplReader::ReadChar(long nPos
                 if (pTest && pTest->SeekPosExact(nPosCp+1+nCpOfs) &&
                     pTest->Where() == nPosCp+1+nCpOfs)
                 {
-                    long nPos;
+                    WW8_CP nPos;
                     void *pData;
                     pTest->Get(nPos, pData);
                     sal_uInt32 nData = SVBT32ToLong(*(SVBT32*)pData);
@@ -3036,14 +3036,14 @@ bool SwWW8ImplReader::ReadText(long nSta
     pPlcxMan = new WW8PLCFMan( pSBase, nType, nStartCp );
     long nCpOfs = pPlcxMan->GetCpOfs(); // Offset fuer Header/Footer, Footnote
 
-    WW8_CP nNext = pPlcxMan->Where();
+    long nNext = pPlcxMan->Where();
     SwTxtNode* pPreviousNode = 0;
     BYTE nDropLines = 0;
     SwCharFmt* pNewSwCharFmt = 0;
     const SwCharFmt* pFmt = 0;
     pStrm->Seek( pSBase->WW8Cp2Fc( nStartCp + nCpOfs, &bIsUnicode ) );
 
-    WW8_CP l = nStartCp;
+    long l = nStartCp;
     while ( l<nStartCp+nTextLen )
     {
 
@@ -4727,7 +4727,7 @@ BOOL SwMSDffManager::GetOLEStorageName(l
             // wasn't successful. Thus, continue in this case.
             // Note: Ask MM for initialization of <nStartCp> and <nEndCp>.
             // Note: Ask MM about assertions in method <rReader.GetTxbxTextSttEndCp(..)>.
-            long nStartCp, nEndCp;
+            WW8_CP nStartCp, nEndCp;
             if ( rReader.GetTxbxTextSttEndCp(nStartCp, nEndCp,
                             static_cast<sal_uInt16>((nOLEId >> 16) & 0xFFFF),
                             static_cast<sal_uInt16>(nOLEId & 0xFFFF)) )
Index: sw/source/filter/ww8/ww8par.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par.hxx,v
retrieving revision 1.135
retrieving revision 1.128.64.4
diff -u -p -u -p -r1.135 -r1.128.64.4
--- sw/source/filter/ww8/ww8par.hxx	11 Jan 2005 13:26:42 -0000	1.135
+++ sw/source/filter/ww8/ww8par.hxx	21 Jan 2005 17:03:22 -0000	1.128.64.4
@@ -262,7 +262,7 @@ private:
     WW8LFOInfos* pLFOInfos;// D. aus PLF LFO, sortiert genau wie im WW8 Stream
     USHORT       nUniqueList; // current number for creating unique list names
     BYTE* GrpprlHasSprm(USHORT nId, BYTE& rSprms, BYTE nLen);
-    WW8LSTInfo* GetLSTByListId(    ULONG  nIdLst     ) const;
+    WW8LSTInfo* GetLSTByListId(    sal_uInt32  nIdLst     ) const;
     //the rParaSprms returns back the original word paragraph indent
     //sprms which are attached to this numbering level
     bool ReadLVL(SwNumFmt& rNumFmt, SfxItemSet*& rpItemSet, USHORT nLevelStyle,
@@ -1293,7 +1293,7 @@ private:
     void InsertTxbxStyAttrs( SfxItemSet& rS, USHORT nColl );
     void InsertTxbxAttrs(long nStartCp, long nEndCp, bool bONLYnPicLocFc);
 
-    bool GetTxbxTextSttEndCp(long& rStartCp, long& rEndCp, USHORT nTxBxS,
+    bool GetTxbxTextSttEndCp(WW8_CP& rStartCp, WW8_CP& rEndCp, USHORT nTxBxS,
         USHORT nSequence);
     bool GetTxbxText(String& rString, long StartCp, long nEndCp);
     SwFrmFmt* InsertTxbxText(SdrTextObj* pTextObj, Size* pObjSiz,
@@ -1516,7 +1516,7 @@ public:     // eigentlich private, geht 
     eF_ResT Read_F_DocInfo( WW8FieldDesc* pF, String& rStr );
     eF_ResT Read_F_Author( WW8FieldDesc*, String& );
     eF_ResT Read_F_TemplName( WW8FieldDesc*, String& );
-    short GetTimeDatePara(String& rStr, ULONG& rFormat, USHORT &rLang,
+    short GetTimeDatePara(String& rStr, sal_uInt32& rFormat, USHORT &rLang,
         int nWhichDefault, bool bHijri = false);
     bool ForceFieldLanguage(SwField &rFld, USHORT nLang);
     eF_ResT Read_F_DateTime( WW8FieldDesc*, String& rStr );
Index: sw/source/filter/ww8/ww8par5.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par5.cxx,v
retrieving revision 1.87
retrieving revision 1.86.8.2
diff -u -p -u -p -r1.87 -r1.86.8.2
--- sw/source/filter/ww8/ww8par5.cxx	16 Feb 2005 17:47:49 -0000	1.87
+++ sw/source/filter/ww8/ww8par5.cxx	10 Mar 2005 02:00:53 -0000	1.86.8.2
@@ -707,7 +707,7 @@ String GetWordDefaultDateStringAsUS(SvNu
     return sParams;
 }
 
-short SwWW8ImplReader::GetTimeDatePara(String& rStr, ULONG& rFormat,
+short SwWW8ImplReader::GetTimeDatePara(String& rStr, sal_uInt32& rFormat,
     USHORT &rLang, int nWhichDefault, bool bHijri)
 {
     bool bRTL = false;
@@ -1700,7 +1700,7 @@ eF_ResT SwWW8ImplReader::Read_F_DocInfo(
             break;
     }
 
-    ULONG nFormat = 0;
+    sal_uInt32 nFormat = 0;
 
     USHORT nLang(0);
     if (bDateTime)
@@ -1777,7 +1777,7 @@ eF_ResT SwWW8ImplReader::Read_F_DateTime
         }
     }
 
-    ULONG nFormat = 0;
+    sal_uInt32 nFormat = 0;
 
     USHORT nLang(0);
     short nDT = GetTimeDatePara(rStr, nFormat, nLang, ww::eDATE, bHijri);
Index: sw/source/filter/ww8/ww8par6.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8par6.cxx,v
retrieving revision 1.161
retrieving revision 1.153.62.4
diff -u -p -u -p -r1.161 -r1.153.62.4
--- sw/source/filter/ww8/ww8par6.cxx	27 Jan 2005 11:12:38 -0000	1.161
+++ sw/source/filter/ww8/ww8par6.cxx	10 Mar 2005 02:01:01 -0000	1.153.62.4
@@ -1003,7 +1003,7 @@ void wwSectionManager::CreateSep(const l
             pWkb->Where() == nTxtPos)
     {
         void* pData;
-        long nTest;
+        WW8_CP nTest;
         pWkb->Get(nTest, pData);
         String sSectionName = mrReader.aLinkStringMap[SVBT16ToShort( ((WW8_WKB*)pData)->nLinkId) ];
         mrReader.ConvertFFileName(sSectionName, sSectionName);
Index: sw/source/filter/ww8/ww8scan.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8scan.cxx,v
retrieving revision 1.114
retrieving revision 1.110.8.2
diff -u -p -u -p -r1.114 -r1.110.8.2
--- sw/source/filter/ww8/ww8scan.cxx	20 Sep 2004 15:21:14 -0000	1.114
+++ sw/source/filter/ww8/ww8scan.cxx	20 Oct 2004 12:29:24 -0000	1.110.8.2
@@ -1140,7 +1140,7 @@ WW8_CP WW8PLCFx_PCD::Where()
     return pPcdI ? pPcdI->Where() : LONG_MAX;
 }
 
-long WW8PLCFx_PCD::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+long WW8PLCFx_PCD::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, long& rLen )
 {
     void* pData;
     rLen = 0;
@@ -1190,7 +1190,7 @@ WW8_FC WW8PLCFx_PCD::AktPieceStartCp2Fc(
 }
 
 
-void WW8PLCFx_PCD::AktPieceFc2Cp( long& rStartPos, long& rEndPos,
+void WW8PLCFx_PCD::AktPieceFc2Cp( WW8_CP& rStartPos, WW8_CP& rEndPos,
     const WW8ScannerBase *pSBase )
 {
     //No point going anywhere with this
@@ -1460,7 +1460,7 @@ WW8_CP WW8ScannerBase::WW8Fc2Cp( WW8_FC 
         for (pPieceIter->SetIdx(0);
             pPieceIter->GetIdx() < pPieceIter->GetIMax();(*pPieceIter)++)
         {
-            long nCpStart, nCpEnd;
+            WW8_CP nCpStart, nCpEnd;
             void* pData;
             if( !pPieceIter->Get( nCpStart, nCpEnd, pData ) )
             {   // ausserhalb PLCFfpcd ?
@@ -1535,7 +1535,7 @@ WW8_FC WW8ScannerBase::WW8Cp2Fc(WW8_CP n
                 ASSERT( !this, "Falscher CP an WW8Cp2Fc() uebergeben" );
             return LONG_MAX;
         }
-        long nCpStart, nCpEnd;
+        WW8_CP nCpStart, nCpEnd;
         void* pData;
         if( !pPieceIter->Get( nCpStart, nCpEnd, pData ) )
         {
@@ -1813,7 +1813,7 @@ WW8ScannerBase::~WW8ScannerBase()
 static bool WW8SkipField(WW8PLCFspecial& rPLCF)
 {
     void* pData;
-    long nP;
+    WW8_CP nP;
 
     if (!rPLCF.Get(nP, pData))              // Ende des PLCFspecial ?
         return false;
@@ -2164,12 +2164,12 @@ bool WW8PLCFspecial::SeekPosExact(long n
     return false;
 }
 
-bool WW8PLCFspecial::Get(long& rPos, void*& rpValue) const
+bool WW8PLCFspecial::Get(WW8_CP& rPos, void*& rpValue) const
 {
     return GetData( nIdx, rPos, rpValue );
 }
 
-bool WW8PLCFspecial::GetData(long nInIdx, long& rPos, void*& rpValue) const
+bool WW8PLCFspecial::GetData(WW8_CP nInIdx, WW8_CP& rPos, void*& rpValue) const
 {
     if ( nInIdx >= nIMax )
     {
@@ -2313,7 +2313,7 @@ bool WW8PLCF::SeekPos(long nPos)
     return false;
 }
 
-bool WW8PLCF::Get(long& rStart, long& rEnd, void*& rpValue) const
+bool WW8PLCF::Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const
 {
     if ( nIdx >= nIMax )
     {
@@ -2326,7 +2326,7 @@ bool WW8PLCF::Get(long& rStart, long& rE
     return true;
 }
 
-long WW8PLCF::Where() const
+WW8_CP WW8PLCF::Where() const
 {
     if ( nIdx >= nIMax )
         return LONG_MAX;
@@ -2400,7 +2400,7 @@ bool WW8PLCFpcd_Iter::SeekPos(long nPos)
     return false;
 }
 
-bool WW8PLCFpcd_Iter::Get(long& rStart, long& rEnd, void*& rpValue) const
+bool WW8PLCFpcd_Iter::Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const
 {
     if( nIdx >= rPLCF.nIMax )
     {
@@ -2413,7 +2413,7 @@ bool WW8PLCFpcd_Iter::Get(long& rStart, 
     return true;
 }
 
-long WW8PLCFpcd_Iter::Where() const
+WW8_FC WW8PLCFpcd_Iter::Where() const
 {
     if ( nIdx >= rPLCF.nIMax )
         return LONG_MAX;
@@ -2621,7 +2621,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::SeekPos(WW
     return false;
 }
 
-BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Get(WW8_FC& rStart, WW8_FC& rEnd, long& rLen)
+BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Get(WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen)
     const
 {
     rLen = 0;
@@ -2649,7 +2649,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::SetIdx(sal
     return false;
 }
 
-BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::GetLenAndIStdAndSprms(long& rLen) const
+BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::GetLenAndIStdAndSprms(WW8_CP& rLen) const
 {
     rLen = maEntries[mnIdx].mnLen;
     return maEntries[mnIdx].mpData;
@@ -2660,7 +2660,7 @@ const BYTE* WW8PLCFx_Fc_FKP::WW8Fkp::Has
     if (mnIdx >= mnIMax)
         return 0;
 
-    long nLen;
+    WW8_CP nLen;
     BYTE* pSprms = GetLenAndIStdAndSprms( nLen );
 
     WW8SprmIter aIter(pSprms, nLen, maSprmParser);
@@ -2673,7 +2673,7 @@ bool WW8PLCFx_Fc_FKP::WW8Fkp::HasSprm(US
     if (mnIdx >= mnIMax)
        return false;
 
-    long nLen;
+    WW8_CP nLen;
     BYTE* pSprms = GetLenAndIStdAndSprms( nLen );
 
     WW8SprmIter aIter(pSprms, nLen, maSprmParser);
@@ -2698,7 +2698,7 @@ void WW8PLCFx::GetSprms( WW8PLCFxDesc* p
     return;
 }
 
-long WW8PLCFx::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+WW8_CP WW8PLCFx::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen )
 {
     ASSERT( !this, "Falsches GetNoSprms gerufen" );
     rStart = rEnd = LONG_MAX;
@@ -2730,7 +2730,7 @@ public:
 //-----------------------------------------
 bool WW8PLCFx_Fc_FKP::NewFkp()
 {
-    long nPLCFStart, nPLCFEnd;
+    WW8_CP nPLCFStart, nPLCFEnd;
     void* pPage;
 
     static const int WW8FkpSizeTabVer6[ PLCF_END ] =
@@ -2859,7 +2859,7 @@ bool WW8PLCFx_Fc_FKP::SeekPos(WW8_FC nFc
     bool bRet = pPLCF->SeekPos(nFcPos);
 
     // make FKP invalid?
-    long nPLCFStart, nPLCFEnd;
+    WW8_CP nPLCFStart, nPLCFEnd;
     void* pPage;
     if( pFkp && pPLCF->Get( nPLCFStart, nPLCFEnd, pPage ) )
     {
@@ -2888,7 +2888,7 @@ WW8_FC WW8PLCFx_Fc_FKP::Where()
     return Where();                     // am einfachsten rekursiv
 }
 
-BYTE* WW8PLCFx_Fc_FKP::GetSprmsAndPos(WW8_FC& rStart, WW8_FC& rEnd, long& rLen)
+BYTE* WW8PLCFx_Fc_FKP::GetSprmsAndPos(WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen)
 {
     rLen = 0;                               // Default
     rStart = rEnd = LONG_MAX;
@@ -3155,7 +3155,7 @@ void WW8PLCFx_Cp_FKP::GetSprms(WW8PLCFxD
                 FC of the piece, the end of the paragraph that contains the
                 character is at the FKP FC minus 1.
                 */
-                long nCpStart, nCpEnd;
+                WW8_CP nCpStart, nCpEnd;
                 void* pData;
                 pPieceIter->Get(nCpStart, nCpEnd, pData);
 
@@ -3271,7 +3271,7 @@ WW8PLCFx& WW8PLCFx_Cp_FKP::operator ++( 
         return *this;
     }
 
-    long nFkpLen;                               // Fkp-Eintrag
+    WW8_CP nFkpLen;                               // Fkp-Eintrag
     // Fkp-Eintrag holen
     WW8PLCFx_Fc_FKP::GetSprmsAndPos(nAttrStart, nAttrEnd, nFkpLen);
 
@@ -3511,7 +3511,7 @@ void WW8PLCFx_SubDoc::GetSprms(WW8PLCFxD
     ULONG nNr = pRef->GetIdx();
 
     void *pData;
-    long nFoo;
+    WW8_CP nFoo;
     if (!pRef->Get(p->nStartPos, nFoo, pData))
     {
         p->nEndPos = p->nStartPos = LONG_MAX;
@@ -3619,7 +3619,7 @@ WW8_CP WW8PLCFx_FLD::Where()
 bool WW8PLCFx_FLD::StartPosIsFieldStart()
 {
     void* pData;
-    long nTest;
+    WW8_CP nTest;
     if (
          (!pPLCF || !pPLCF->Get(nTest, pData) ||
          ((((BYTE*)pData)[0] & 0x1f) != 0x13))
@@ -3639,7 +3639,7 @@ bool WW8PLCFx_FLD::EndPosIsFieldEnd()
         (*pPLCF)++;
 
         void* pData;
-        long nTest;
+        WW8_CP nTest;
         if ( pPLCF->Get(nTest, pData) && ((((BYTE*)pData)[0] & 0x1f) == 0x15) )
             bRet = true;
 
@@ -3664,7 +3664,7 @@ void WW8PLCFx_FLD::GetSprms(WW8PLCFxDesc
 
     long n = pPLCF->GetIdx();
 
-    long nP;
+    WW8_CP nP;
     void *pData;
     if (!pPLCF->Get(nP, pData))             // Ende des PLCFspecial ?
     {
@@ -3902,7 +3902,7 @@ WW8_CP WW8PLCFx_Book::Where()
     return pBook[nIsEnd]->Where();
 }
 
-long WW8PLCFx_Book::GetNoSprms( long& rStart, long& rEnd, long& rLen )
+WW8_CP WW8PLCFx_Book::GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen )
 {
     void* pData;
     rEnd = LONG_MAX;
Index: sw/source/filter/ww8/ww8scan.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/ww8/ww8scan.hxx,v
retrieving revision 1.69
retrieving revision 1.67.216.2
diff -u -p -u -p -r1.69 -r1.67.216.2
--- sw/source/filter/ww8/ww8scan.hxx	20 Sep 2004 15:21:29 -0000	1.69
+++ sw/source/filter/ww8/ww8scan.hxx	20 Oct 2004 12:26:50 -0000	1.67.216.2
@@ -223,9 +223,9 @@ struct WW8FieldDesc
 {
     long nLen;              // Gesamtlaenge ( zum Text ueberlesen )
     WW8_CP nSCode;           // Anfang Befehlscode
-    long nLCode;            // Laenge
+    WW8_CP nLCode;            // Laenge
     WW8_CP nSRes;           // Anfang Ergebnis
-    long nLRes;             // Laenge ( == 0, falls kein Ergebnis )
+    WW8_CP nLRes;             // Laenge ( == 0, falls kein Ergebnis )
     USHORT nId;             // WW-Id fuer Felder
     BYTE nOpt;              // WW-Flags ( z.B.: vom User geaendert )
     BYTE bCodeNest:1;       // Befehl rekursiv verwendet
@@ -255,7 +255,7 @@ private:
     INT32* pPLCF_PosArray;  // Pointer auf Pos-Array und auf ganze Struktur
     BYTE*  pPLCF_Contents;  // Pointer auf Inhalts-Array-Teil des Pos-Array
     long nIMax;             // Anzahl der Elemente
-    long nIdx;              // Merker, wo wir gerade sind
+    WW8_CP nIdx;              // Merker, wo wir gerade sind
     long nStru;
 public:
     WW8PLCFspecial( SvStream* pSt, long nFilePos, long nPLCF,
@@ -267,10 +267,10 @@ public:
     bool SeekPos(long nPos);            // geht ueber FC- bzw. CP-Wert
                                         // bzw. naechste groesseren Wert
     bool SeekPosExact(long nPos);
-    long Where() const 
+    WW8_FC Where() const 
         { return ( nIdx >= nIMax ) ? LONG_MAX : pPLCF_PosArray[nIdx]; }
-    bool Get(long& rStart, void*& rpValue) const;
-    bool GetData(long nIdx, long& rPos, void*& rpValue) const;
+    bool Get(WW8_CP& rStart, void*& rpValue) const;
+    bool GetData(WW8_CP nIdx, WW8_CP& rPos, void*& rpValue) const;
 
     const void* GetData( long nInIdx ) const 
     {
@@ -346,8 +346,8 @@ public:
     void SetIdx( long nI ) { nIdx = nI; }
     long GetIMax() const { return nIMax; }
     bool SeekPos(long nPos);
-    long Where() const;
-    bool Get(long& rStart, long& rEnd, void*& rpValue) const;
+    WW8_FC Where() const;
+    bool Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const;
     WW8PLCF& operator ++( int ) { if( nIdx < nIMax ) nIdx++; return *this; }
 
     const void* GetData( long nInIdx ) const 
@@ -386,8 +386,8 @@ public:
     void SetIdx( long nI ) { nIdx = nI; }
     long GetIMax() const { return rPLCF.nIMax; }
     bool SeekPos(long nPos);
-    long Where() const;
-    bool Get(long& rStart, long& rEnd, void*& rpValue) const;
+    WW8_FC Where() const;
+    bool Get(WW8_CP& rStart, WW8_CP& rEnd, void*& rpValue) const;
     WW8PLCFpcd_Iter& operator ++( int ) 
     { 
         if( nIdx < rPLCF.nIMax ) 
@@ -425,9 +425,9 @@ public:
     virtual ULONG GetIdx2() const;
     virtual void SetIdx2( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos) = 0;
-    virtual long Where() = 0;
+    virtual WW8_FC Where() = 0;
     virtual void GetSprms( WW8PLCFxDesc* p );
-    virtual long GetNoSprms( long& rStart, long&, long& rLen );
+    virtual WW8_CP GetNoSprms( WW8_CP& rStart, WW8_CP&, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int ) = 0;
     virtual USHORT GetIstd() const { return 0xffff; }
     virtual void Save( WW8PLCFxSave1& rSave ) const;
@@ -458,7 +458,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nI );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms( WW8PLCFxDesc* p );
     virtual WW8PLCFx& operator ++( int );
 
@@ -483,12 +483,12 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nI );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
-    virtual long GetNoSprms( long& rStart, long&, long& rLen );
+    virtual WW8_FC Where();
+    virtual long GetNoSprms( WW8_CP& rStart, WW8_CP&, long& rLen );
     virtual WW8PLCFx& operator ++( int );
     WW8_CP AktPieceStartFc2Cp( WW8_FC nStartPos );
     WW8_FC AktPieceStartCp2Fc( WW8_CP nCp );
-    void AktPieceFc2Cp(long& rStartPos, long& rEndPos, 
+    void AktPieceFc2Cp(WW8_CP& rStartPos, WW8_CP& rEndPos, 
         const WW8ScannerBase *pSBase);
     WW8PLCFpcd_Iter* GetPLCFIter() { return pPcdI; }
     void SetClipStart(WW8_CP nIn) { nClipStart = nIn; }
@@ -559,14 +559,14 @@ public:
                 mnIdx++;
             return *this; 
         }
-        BYTE* Get( WW8_FC& rStart, WW8_FC& rEnd, long& rLen ) const;
+        BYTE* Get( WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen ) const;
         sal_uInt16 GetIstd() const { return maEntries[mnIdx].mnIStd; }
 
         /*
             liefert einen echten Pointer auf das Sprm vom Typ nId,
             falls ein solches im Fkp drin ist.
         */
-        BYTE* GetLenAndIStdAndSprms(long& rLen) const;
+        BYTE* GetLenAndIStdAndSprms(WW8_CP& rLen) const;
 
         /*
             ruft GetLenAndIStdAndSprms() auf...
@@ -615,7 +615,7 @@ public:
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_FC nFcPos);
     virtual WW8_FC Where();
-    BYTE* GetSprmsAndPos( WW8_FC& rStart, WW8_FC& rEnd, long& rLen );
+    BYTE* GetSprmsAndPos( WW8_FC& rStart, WW8_FC& rEnd, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int );
     virtual USHORT GetIstd() const;
     void GetPCDSprms( WW8PLCFxDesc& rDesc );
@@ -678,7 +678,7 @@ public:
     virtual void SetIdx( ULONG nIdx );
     long GetIMax() const { return ( pPLCF ) ? pPLCF->GetIMax() : 0; }
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms( WW8PLCFxDesc* p );
     virtual WW8PLCFx& operator ++( int );
     const BYTE* HasSprm( USHORT nId ) const;
@@ -706,7 +706,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
 
     // liefert Reference Descriptoren
     const void* GetData( long nIdx = -1 ) const
@@ -736,7 +736,7 @@ public:
     virtual ULONG GetIdx() const;
     virtual void SetIdx( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
+    virtual WW8_FC Where();
     virtual void GetSprms(WW8PLCFxDesc* p);
     virtual WW8PLCFx& operator ++( int );
     bool StartPosIsFieldStart();
@@ -768,8 +768,8 @@ public:
     virtual ULONG GetIdx2() const;
     virtual void SetIdx2( ULONG nIdx );
     virtual bool SeekPos(WW8_CP nCpPos);
-    virtual long Where();
-    virtual long GetNoSprms( long& rStart, long& rEnd, long& rLen );
+    virtual WW8_FC Where();
+    virtual WW8_CP GetNoSprms( WW8_CP& rStart, WW8_CP& rEnd, WW8_CP& rLen );
     virtual WW8PLCFx& operator ++( int );
     const String* GetName() const;
     WW8_CP GetStartPos() const
@@ -821,8 +821,8 @@ struct WW8PLCFxDesc
     const BYTE* pMemPos;// wo liegen die Sprm(s)
     long nOrigSprmsLen;
 
-    long nStartPos;
-    long nEndPos;
+    WW8_CP nStartPos;
+    WW8_CP nEndPos;
 
     long nOrigStartPos;
     long nOrigEndPos;   // The ending character position of a paragraph is
@@ -836,8 +836,8 @@ struct WW8PLCFxDesc
                         // it can be used as the beginning cp of the next set
                         // of properties
 
-    long nCp2OrIdx;     // wo liegen die NoSprm(s)
-    long nSprmsLen;     // wie viele Bytes fuer weitere Sprms / Laenge Fussnote
+    WW8_CP nCp2OrIdx;     // wo liegen die NoSprm(s)
+    WW8_CP nSprmsLen;     // wie viele Bytes fuer weitere Sprms / Laenge Fussnote
     long nCpOfs;        // fuer Offset Header .. Footnote
     bool bFirstSprm;    // fuer Erkennung erster Sprm einer Gruppe
     bool bRealLineEnd;  // false bei Pap-Piece-Ende
@@ -897,7 +897,7 @@ public:
         Where fragt, an welcher naechsten Position sich irgendein
         Attr aendert...
     */
-    long Where() const;
+    WW8_FC Where() const;
 
     bool Get(WW8PLCFManResult* pResult) const;
     WW8PLCFMan& operator ++( int );
Index: sw/source/filter/xml/swxml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/swxml.cxx,v
retrieving revision 1.60
retrieving revision 1.60.8.1
diff -u -p -u -p -r1.60 -r1.60.8.1
--- sw/source/filter/xml/swxml.cxx	11 Jan 2005 12:37:05 -0000	1.60
+++ sw/source/filter/xml/swxml.cxx	21 Jan 2005 17:04:29 -0000	1.60.8.1
@@ -447,7 +447,7 @@ sal_Int32 ReadThroughComponent(
     }
 }
 
-sal_uInt32 XMLReader::Read( SwDoc &rDoc, const String& rBaseURL, SwPaM &rPaM, const String & rName )
+ULONG XMLReader::Read( SwDoc &rDoc, const String& rBaseURL, SwPaM &rPaM, const String & rName )
 {
 	// Get service factory
 	Reference< lang::XMultiServiceFactory > xServiceFactory =
Index: sw/source/filter/xml/wrtxml.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/wrtxml.cxx,v
retrieving revision 1.48
retrieving revision 1.48.8.1
diff -u -p -u -p -r1.48 -r1.48.8.1
--- sw/source/filter/xml/wrtxml.cxx	11 Jan 2005 12:37:19 -0000	1.48
+++ sw/source/filter/xml/wrtxml.cxx	21 Jan 2005 17:04:49 -0000	1.48.8.1
@@ -167,7 +167,7 @@ __EXPORT SwXMLWriter::~SwXMLWriter()
 }
 
 
-sal_uInt32 SwXMLWriter::_Write()
+ULONG SwXMLWriter::_Write()
 {
 	// Get service factory
 	Reference< lang::XMultiServiceFactory > xServiceFactory =
@@ -545,12 +545,12 @@ sal_uInt32 SwXMLWriter::_Write()
 	return 0;
 }
 
-sal_uInt32 SwXMLWriter::WriteStorage()
+ULONG SwXMLWriter::WriteStorage()
 {
 	return _Write();
 }
 
-sal_uInt32 SwXMLWriter::Write( SwPaM& rPaM, SfxMedium& rMed,
+ULONG SwXMLWriter::Write( SwPaM& rPaM, SfxMedium& rMed,
 							   const String* pFileName )
 {
 	return IsStgWriter()
Index: sw/source/filter/xml/wrtxml.hxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/wrtxml.hxx,v
retrieving revision 1.8
retrieving revision 1.8.8.1
diff -u -p -u -p -r1.8 -r1.8.8.1
--- sw/source/filter/xml/wrtxml.hxx	11 Jan 2005 12:37:33 -0000	1.8
+++ sw/source/filter/xml/wrtxml.hxx	21 Jan 2005 17:05:05 -0000	1.8.8.1
@@ -81,10 +81,10 @@ namespace com { namespace sun { namespac
 
 class SwXMLWriter : public StgWriter
 {
-	sal_uInt32 _Write();
+	ULONG _Write();
 
 protected:
-	virtual sal_uInt32 WriteStorage();
+	virtual ULONG WriteStorage();
 
 public:
 
Index: sw/source/filter/xml/xmlimp.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlimp.cxx,v
retrieving revision 1.86
retrieving revision 1.86.98.1
diff -u -p -u -p -r1.86 -r1.86.98.1
--- sw/source/filter/xml/xmlimp.cxx	26 Nov 2004 13:30:12 -0000	1.86
+++ sw/source/filter/xml/xmlimp.cxx	21 Jan 2005 17:05:15 -0000	1.86.98.1
@@ -843,7 +843,7 @@ void SwXMLImport::endDocument( void )
 		if( !pPos->nContent.GetIndex() )
 		{
 			SwTxtNode* pCurrNd;
-			sal_uInt32 nNodeIdx = pPos->nNode.GetIndex();
+			ULONG nNodeIdx = pPos->nNode.GetIndex();
 			pDoc = pPaM->GetDoc();
 
 			DBG_ASSERT( pPos->nNode.GetNode().IsCntntNode(),
Index: sw/source/filter/xml/xmlimpit.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlimpit.cxx,v
retrieving revision 1.12
retrieving revision 1.10.62.3
diff -u -p -u -p -r1.12 -r1.10.62.3
--- sw/source/filter/xml/xmlimpit.cxx	9 Nov 2004 12:34:35 -0000	1.12
+++ sw/source/filter/xml/xmlimpit.cxx	18 Jan 2005 16:54:58 -0000	1.10.62.3
@@ -798,7 +798,7 @@ sal_Bool SvXMLImportItemMapper::PutXMLVa
                         }
                         else if( -1 != aToken.indexOf( sal_Unicode('%') ) )
                         {
-                            long nPrc = 50;
+                            sal_Int32 nPrc = 50;
                             if( rUnitConverter.convertPercent( nPrc, aToken ) )
                             {
                                 if( !bHori )
Index: sw/source/filter/xml/xmlithlp.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmlithlp.cxx,v
retrieving revision 1.1
retrieving revision 1.1.766.1
diff -u -p -u -p -r1.1 -r1.1.766.1
--- sw/source/filter/xml/xmlithlp.cxx	9 Jul 2001 20:10:43 -0000	1.1
+++ sw/source/filter/xml/xmlithlp.cxx	9 Sep 2004 09:53:11 -0000	1.1.766.1
@@ -224,7 +224,7 @@ sal_Bool lcl_frmitems_parseXMLBorder( co
     rWidth = 0;
     rNamedWidth = USHRT_MAX;
 
-    long nTemp;
+    sal_Int32 nTemp;
     while( aTokens.getNextToken( aToken ) && aToken.getLength() != 0 )
     {
         if( !rHasWidth &&
Index: sw/source/filter/xml/xmltble.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmltble.cxx,v
retrieving revision 1.31
retrieving revision 1.31.98.1
diff -u -p -u -p -r1.31 -r1.31.98.1
--- sw/source/filter/xml/xmltble.cxx	26 Nov 2004 13:30:27 -0000	1.31
+++ sw/source/filter/xml/xmltble.cxx	21 Jan 2005 17:05:24 -0000	1.31.98.1
@@ -746,7 +746,7 @@ void SwXMLExport::ExportTableLinesAutoSt
 				pColumn->SetWidthOpt( (sal_uInt16)nColAbsWidth, sal_False );
 			}
 
-			sal_uInt32 nExpPos = 0;
+			ULONG nExpPos = 0;
 			if( rExpCols.Seek_Entry( pColumn, &nExpPos ) )
 			{
 				pColumn->SetStyleName(
Index: sw/source/filter/xml/xmltexti.cxx
===================================================================
RCS file: /cvs/sw/sw/source/filter/xml/xmltexti.cxx,v
retrieving revision 1.40
retrieving revision 1.33.304.4
diff -u -p -u -p -r1.40 -r1.33.304.4
--- sw/source/filter/xml/xmltexti.cxx	25 Feb 2005 09:28:02 -0000	1.40
+++ sw/source/filter/xml/xmltexti.cxx	10 Mar 2005 02:02:32 -0000	1.33.304.4
@@ -216,7 +216,7 @@ const XMLServiceMapEntry_Impl aServiceMa
 };
 static void lcl_putHeightAndWidth ( SfxItemSet &rItemSet,
 		sal_Int32 nHeight, sal_Int32 nWidth,
-		sal_Int32 *pTwipHeight=0, sal_Int32 *pTwipWidth=0 )
+		long *pTwipHeight=0, long *pTwipWidth=0 )
 {
 	if( nWidth > 0 && nHeight > 0 )
 	{
Index: sw/source/ui/app/docsh2.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/app/docsh2.cxx,v
retrieving revision 1.74
retrieving revision 1.64.62.5
diff -u -p -u -p -r1.74 -r1.64.62.5
--- sw/source/ui/app/docsh2.cxx	22 Feb 2005 08:23:34 -0000	1.74
+++ sw/source/ui/app/docsh2.cxx	10 Mar 2005 01:26:00 -0000	1.64.62.5
@@ -1173,9 +1173,9 @@ void SwDocShell::Execute(SfxRequest& rRe
 								if ( aLockBytes.Stat( &aStat, SVSTATFLAG_DEFAULT ) == ERRCODE_NONE )
 								{
 									sal_uInt32 nLen = aStat.nSize;
-									ULONG nRead = 0;
+									sal_Size nRead = 0;
 									com::sun::star::uno::Sequence< sal_Int8 > aSeq( nLen );
-									aLockBytes.ReadAt( 0, aSeq.getArray(), nLen, &nRead );
+									aLockBytes.ReadAt( 0UL, aSeq.getArray(), nLen, &nRead );
 
 						        	::com::sun::star::uno::Sequence< ::com::sun::star::beans::PropertyValue > aArgs(1);
 									aArgs[0].Name = ::rtl::OUString::createFromAscii("RtfOutline");
@@ -1244,7 +1244,7 @@ void SwDocShell::Execute(SfxRequest& rRe
 								if ( aLockBytes.Stat( &aStat, SVSTATFLAG_DEFAULT ) == ERRCODE_NONE )
 								{
 									sal_uInt32 nLen = aStat.nSize;
-									ULONG nRead = 0;
+									sal_Size nRead = 0;
 									com::sun::star::uno::Sequence< sal_Int8 > aSeq( nLen );
 									aLockBytes.ReadAt( 0, aSeq.getArray(), nLen, &nRead );
 
@@ -1613,7 +1613,7 @@ long SwDocShell::DdeSetData( const Strin
  --------------------------------------------------------------------*/
 
 void SwDocShell::FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
 								   String * pLongUserName,
                                    String * pUserName,
Index: sw/source/ui/globdoc/globdoc.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/globdoc/globdoc.cxx,v
retrieving revision 1.11
retrieving revision 1.11.66.1
diff -u -p -u -p -r1.11 -r1.11.66.1
--- sw/source/ui/globdoc/globdoc.cxx	4 Oct 2004 19:27:59 -0000	1.11
+++ sw/source/ui/globdoc/globdoc.cxx	21 Jan 2005 17:05:46 -0000	1.11.66.1
@@ -92,7 +92,7 @@ SwGlobalDocShell::~SwGlobalDocShell()
 }
 
 void SwGlobalDocShell::FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
 								   String * pLongUserName,
                                    String * pUserName,
Index: sw/source/ui/inc/dbinsdlg.hxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/inc/dbinsdlg.hxx,v
retrieving revision 1.8
retrieving revision 1.8.768.1
diff -u -p -u -p -r1.8 -r1.8.768.1
--- sw/source/ui/inc/dbinsdlg.hxx	7 Jun 2001 16:20:19 -0000	1.8
+++ sw/source/ui/inc/dbinsdlg.hxx	21 Jan 2005 17:05:55 -0000	1.8.768.1
@@ -123,7 +123,7 @@ struct SwInsDBColumn
 {
 	rtl::OUString sColumn, sUsrNumFmt;
 	sal_Int32 nDBNumFmt;
-	ULONG nUsrNumFmt;
+	sal_uInt32 nUsrNumFmt;
 	LanguageType eUsrNumFmtLng;
 	USHORT nCol;
 	BOOL bHasFmt : 1;
Index: sw/source/ui/shells/tabsh.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/shells/tabsh.cxx,v
retrieving revision 1.33
retrieving revision 1.33.124.1
diff -u -p -u -p -r1.33 -r1.33.124.1
--- sw/source/ui/shells/tabsh.cxx	9 Nov 2004 16:24:06 -0000	1.33
+++ sw/source/ui/shells/tabsh.cxx	21 Jan 2005 17:06:12 -0000	1.33.124.1
@@ -906,7 +906,7 @@ void SwTableShell::Execute(SfxRequest &r
 
 					if( pItem && 0 != ((SvxNumberInfoItem*)pItem)->GetDelCount() )
 					{
-						const ULONG* pDelArr = ((SvxNumberInfoItem*)
+						const sal_uInt32* pDelArr = ((SvxNumberInfoItem*)
 														pItem)->GetDelArray();
 
 						for ( USHORT i = 0; i < ((SvxNumberInfoItem*)pItem)->GetDelCount(); i++ )
@@ -1662,7 +1662,7 @@ void SwTableShell::ExecNumberFormat(SfxR
 	//	Sprache immer von Cursorposition besorgen
 	LanguageType eLang = rSh.GetCurLang();
 	SvNumberFormatter* pFormatter = rSh.GetNumberFormatter();
-	ULONG nNumberFormat = NUMBERFORMAT_ENTRY_NOT_FOUND;
+	sal_uInt32 nNumberFormat = NUMBERFORMAT_ENTRY_NOT_FOUND;
 	USHORT nFmtType = 0, nOffset = 0;
 
 	switch ( nSlot )
Index: sw/source/ui/table/tautofmt.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/table/tautofmt.cxx,v
retrieving revision 1.15
retrieving revision 1.15.92.1
diff -u -p -u -p -r1.15 -r1.15.92.1
--- sw/source/ui/table/tautofmt.cxx	23 Aug 2004 09:10:40 -0000	1.15
+++ sw/source/ui/table/tautofmt.cxx	21 Jan 2005 17:06:27 -0000	1.15.92.1
@@ -799,7 +799,7 @@ MAKENUMSTR:
 				String sFmt; LanguageType eLng, eSys;
 				aCurData.GetBoxFmt( (BYTE)nNum ).GetValueFormat( sFmt, eLng, eSys );
 
-				ULONG nKey = 0;
+				sal_uInt32 nKey = 0;
 				if ( eLng == LANGUAGE_SYSTEM && eSys != ::GetAppLanguage() )
 				{
 					//	#53381# wenn System beim Speichern etwas anderes war,
Index: sw/source/ui/uiview/viewstat.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/uiview/viewstat.cxx,v
retrieving revision 1.32
retrieving revision 1.32.96.1
diff -u -p -u -p -r1.32 -r1.32.96.1
--- sw/source/ui/uiview/viewstat.cxx	26 Nov 2004 20:00:01 -0000	1.32
+++ sw/source/ui/uiview/viewstat.cxx	21 Jan 2005 17:06:38 -0000	1.32.96.1
@@ -615,7 +615,7 @@ void SwView::GetDrawState(SfxItemSet &rS
 	Beschreibung:
  --------------------------------------------------------------------*/
 
-sal_Bool SwView::HasUIFeature( sal_uInt32 nFeature )
+sal_Bool SwView::HasUIFeature( ULONG nFeature )
 {
     sal_Bool bRet = sal_False;
     switch(nFeature)
Index: sw/source/ui/utlui/content.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/utlui/content.cxx,v
retrieving revision 1.34
retrieving revision 1.34.76.1
diff -u -p -u -p -r1.34 -r1.34.76.1
--- sw/source/ui/utlui/content.cxx	8 Sep 2004 15:04:57 -0000	1.34
+++ sw/source/ui/utlui/content.cxx	21 Jan 2005 17:06:56 -0000	1.34.76.1
@@ -2327,7 +2327,7 @@ DragDropMode SwContentTree::NotifyStartD
 
 
 sal_Bool  SwContentTree::NotifyMoving( SvLBoxEntry*  pTarget,
-		SvLBoxEntry*  pEntry, SvLBoxEntry*& , sal_uInt32& )
+		SvLBoxEntry*  pEntry, SvLBoxEntry*& , ULONG& )
 {
 	if(!bDocChgdInDragging)
 	{
@@ -2367,7 +2367,7 @@ sal_Bool  SwContentTree::NotifyMoving( S
 
 
 sal_Bool  SwContentTree::NotifyCopying( SvLBoxEntry*  pTarget,
-		SvLBoxEntry*  pEntry, SvLBoxEntry*& , sal_uInt32& )
+		SvLBoxEntry*  pEntry, SvLBoxEntry*& , ULONG& )
 {
 	if(!bDocChgdInDragging)
 	{
Index: sw/source/ui/utlui/numfmtlb.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/utlui/numfmtlb.cxx,v
retrieving revision 1.14
retrieving revision 1.14.96.1
diff -u -p -u -p -r1.14 -r1.14.96.1
--- sw/source/ui/utlui/numfmtlb.cxx	12 Aug 2004 13:13:32 -0000	1.14
+++ sw/source/ui/utlui/numfmtlb.cxx	21 Jan 2005 17:07:08 -0000	1.14.96.1
@@ -519,7 +519,7 @@ IMPL_LINK( NumFormatListBox, SelectHdl, 
 
 			if( pItem && 0 != ((SvxNumberInfoItem*)pItem)->GetDelCount() )
 			{
-				const ULONG* pDelArr = ((SvxNumberInfoItem*)pItem)->GetDelArray();
+				const sal_uInt32* pDelArr = ((SvxNumberInfoItem*)pItem)->GetDelArray();
 
 				for ( USHORT i = 0; i < ((SvxNumberInfoItem*)pItem)->GetDelCount(); i++ )
 					pFormatter->DeleteEntry( pDelArr[i] );
Index: sw/source/ui/web/wdocsh.cxx
===================================================================
RCS file: /cvs/sw/sw/source/ui/web/wdocsh.cxx,v
retrieving revision 1.11
retrieving revision 1.11.66.1
diff -u -p -u -p -r1.11 -r1.11.66.1
--- sw/source/ui/web/wdocsh.cxx	4 Oct 2004 19:35:24 -0000	1.11
+++ sw/source/ui/web/wdocsh.cxx	21 Jan 2005 17:07:18 -0000	1.11.66.1
@@ -120,7 +120,7 @@ SwWebDocShell::~SwWebDocShell()
 
 
 void SwWebDocShell::FillClass( SvGlobalName * pClassName,
-								   ULONG * pClipFormat,
+								   sal_uInt32 * pClipFormat,
 								   String * pAppName,
 								   String * pLongUserName,
                                    String * pUserName,
Index: nas/nas-1.6.patch
===================================================================
RCS file: /cvs/external/nas/nas-1.6.patch,v
retrieving revision 1.8
retrieving revision 1.5.20.4
diff -u -p -u -p -r1.8 -r1.5.20.4
--- nas/nas-1.6.patch	18 Jan 2005 14:56:01 -0000	1.8
+++ nas/nas-1.6.patch	9 Mar 2005 20:20:58 -0000	1.5.20.4
@@ -130,7 +130,7 @@
   unsigned int    which;
   {
       XGCValues       gcv;
-! #if !defined(__alpha__) && !defined(__x86_64__)
+! #if !defined(__alpha__) && !defined(__x86_64__) && !defined(__sparcv9)
       unsigned long   commonMask;
 ! #else
       unsigned int  commonMask;
@@ -271,7 +271,7 @@
   #define B16
   #endif
   
-! #if !defined(__alpha__) && !defined(__x86_64__)
+! #if !defined(__alpha__) && !defined(__x86_64__) && !defined(__sparcv9)
   typedef long		INT32;
   typedef unsigned long	CARD32;
   typedef unsigned long	BITS32;
Index: boost/boost_1_27_0.patch
===================================================================
RCS file: /cvs/external/boost/boost_1_27_0.patch,v
retrieving revision 1.9
retrieving revision 1.8.20.2
diff -u -p -u -p -r1.9 -r1.8.20.2
--- boost/boost_1_27_0.patch	15 Nov 2004 16:43:34 -0000	1.9
+++ boost/boost_1_27_0.patch	10 Mar 2005 15:06:24 -0000	1.8.20.2
@@ -151,7 +151,7 @@
 ! #define atomic_read(p) ((p)->aVal)
 ! 
 ! 
-! #if defined ( X86 ) || defined(__x86__)
+! #if defined ( X86 ) || defined(__x86__) || defined ( X86_64 )
 ! 
 ! static __inline__ int atomic_inc (atomic_t * pCount)
 ! {
@@ -160,7 +160,7 @@
 ! 	__asm__ __volatile__ (
 ! 		"movl $1, %0\n\t"
 ! 		"lock\n\t" 
-! 		"xadd %0, %2\n\t"
+! 		"xaddl %0, %2\n\t"
 ! 		"incl %0"
 ! 	:	"=&r" (nCount), "=m" (pCount->aVal)
 ! 	:	"m" (pCount->aVal)
@@ -176,7 +176,7 @@
 ! 	__asm__ __volatile__ (
 ! 		"movl $-1, %0\n\t"
 ! 		"lock\n\t"
-! 		"xadd %0, %2\n\t"
+! 		"xaddl %0, %2\n\t"
 ! 		"decl %0"
 ! 	:	"=&r" (nCount), "=m" (pCount->aVal)
 ! 	:	"m" (pCount->aVal)
Index: cppu/inc/uno/environment.h
===================================================================
RCS file: /cvs/udk/cppu/inc/uno/environment.h,v
retrieving revision 1.8
retrieving revision 1.8.18.1
diff -u -p -u -p -r1.8 -r1.8.18.1
--- cppu/inc/uno/environment.h	21 Apr 2004 12:56:31 -0000	1.8
+++ cppu/inc/uno/environment.h	26 Aug 2004 17:05:59 -0000	1.8.18.1
@@ -172,7 +172,7 @@ typedef void (SAL_CALL * uno_freeProxyFu
 	@param nBytes amount of memory in bytes
 	@return pointer to allocated memory
 */
-typedef void * (SAL_CALL * uno_memAlloc)( sal_uInt32 nBytes );
+typedef void * (SAL_CALL * uno_memAlloc)( sal_Size nBytes );
 
 /** The binary specification of an UNO environment supporting interface registration.
 */
Index: tools/bootstrp/command.cxx
===================================================================
RCS file: /cvs/util/tools/bootstrp/command.cxx,v
retrieving revision 1.8
retrieving revision 1.8.178.1
diff -u -p -u -p -r1.8 -r1.8.178.1
--- tools/bootstrp/command.cxx	28 Apr 2003 17:20:08 -0000	1.8
+++ tools/bootstrp/command.cxx	6 Oct 2004 11:42:55 -0000	1.8.178.1
@@ -59,10 +59,6 @@
  *
  ************************************************************************/
 
-#ifdef SCO
-#define _IOSTREAM_H
-#endif
-
 #ifdef PRECOMPILED
 #include "first.hxx"
 #endif
@@ -84,7 +80,7 @@
 
 //#define MH_TEST2	1			// fuers direkte Testen
 
-#if defined (DOS) || defined (WNT) || defined (WIN) || defined(OS2)
+#if defined (WNT)
 #include <process.h>    // for _SPAWN
 #endif
 #ifdef UNX
@@ -98,30 +94,20 @@
 #endif
 #define P_WAIT 1 		// erstmal einen dummz
 #endif
-#ifdef MAC
-#define P_WAIT 1 		// erstmal einen dummz
-#endif
 #ifdef WTC
 #define _spawnv spawnv
 #endif
 
-#ifdef OS2
-#include <svpm.h>
-#define _spawnv spawnv
-#endif
-#if defined (WIN) || defined (WNT)
+#if defined (WNT)
 #include <svwin.h>
 #endif
 
-#if defined( WNT ) || defined ( OS2 ) || defined ( WIN ) || defined (DOS )
+#if defined( WNT )
 #define  	cPathSeperator ';'
 #endif
 #ifdef UNX
 #define	 	cPathSeperator	':'
 #endif
-#ifdef MAC
-#define	 	cPathSeperator	','
-#endif
 
 /*****************************************************************************/
 CommandLine::CommandLine(BOOL bWrite)
@@ -471,15 +457,8 @@ CCommand::operator const int()
 {
 	int nRet;
 #ifndef UNX
-#if defined( WNT ) || defined( DOS ) || defined( WIN )
+#if defined( WNT )
 	nRet = _spawnv( P_WAIT, ppArgv[0], (const char **) ppArgv );
-#else
-#if defined( UNX ) || defined( OS2 )
-	nRet = _spawnv( P_WAIT, ppArgv[0], ppArgv );
-#endif
-#ifdef MAC
-//Mac-Implem.
-#endif
 #endif
 #else
 #ifdef UNX
@@ -505,14 +484,8 @@ CCommand::operator const int()
 	}
 #endif
 
-#ifdef MAC
-//Mac_impl
-=======
 #endif
 
-#endif
-
-#ifndef MAC
 	switch ( errno )
 	{
 		case	E2BIG :
@@ -533,7 +506,6 @@ CCommand::operator const int()
 		default:
 				nError = COMMAND_UNKNOWN;
 	}
-#endif
 
 	if ( nRet )
 		fprintf( stderr, "Program returned with errros\n");
Index: tools/inc/bigint.hxx
===================================================================
RCS file: /cvs/util/tools/inc/bigint.hxx,v
retrieving revision 1.3
retrieving revision 1.3.4.1
diff -u -p -u -p -r1.3 -r1.3.4.1
--- tools/inc/bigint.hxx	17 Jun 2004 13:08:56 -0000	1.3
+++ tools/inc/bigint.hxx	21 Jan 2005 17:22:40 -0000	1.3.4.1
@@ -112,8 +112,10 @@ public:
     operator        int()   const;
     operator        double() const;
     operator        USHORT() const;
+#if SAL_TYPE_SIZEOFLONG == 8
     operator        ULONG() const;
-
+#endif
+    operator        sal_uInt32() const;
     void            Set( sal_Bool bSet ) { bIsSet = bSet; }
     ByteString      GetByteString() const;
     UniString       GetString() const;
Index: tools/inc/date.hxx
===================================================================
RCS file: /cvs/util/tools/inc/date.hxx,v
retrieving revision 1.2
retrieving revision 1.2.108.1
diff -u -p -u -p -r1.2 -r1.2.108.1
--- tools/inc/date.hxx	4 Sep 2003 07:44:38 -0000	1.2
+++ tools/inc/date.hxx	21 Jan 2005 17:23:54 -0000	1.2.108.1
@@ -86,21 +86,21 @@ enum DayOfWeek { MONDAY, TUESDAY, WEDNES
 class Date
 {
 private:
-	ULONG			nDate;
+	sal_uInt32		nDate;
 
 public:
 					Date();
 					Date( const ResId & rResId );
-					Date( ULONG _nDate ) { Date::nDate = _nDate; }
+					Date( sal_uInt32 _nDate ) { Date::nDate = _nDate; }
 					Date( const Date& rDate )
 						{ nDate = rDate.nDate; }
 					Date( USHORT nDay, USHORT nMonth, USHORT nYear )
-						{ nDate = ((ULONG)(nDay%100)) +
-								  (((ULONG)(nMonth%100))*100) +
-								  (((ULONG)nYear%10000)*10000); }
+						{ nDate = ((sal_uInt32)(nDay%100)) +
+								  (((sal_uInt32)(nMonth%100))*100) +
+								  (((sal_uInt32)nYear%10000)*10000); }
 
-	void			SetDate( ULONG nNewDate ) { nDate = nNewDate; }
-	ULONG			GetDate() const { return nDate; }
+	void			SetDate( sal_uInt32 nNewDate ) { nDate = nNewDate; }
+	sal_uInt32		GetDate() const { return nDate; }
 
 	void			SetDay( USHORT nNewDay );
 	void			SetMonth( USHORT nNewMonth );
Index: tools/inc/fsys.hxx
===================================================================
RCS file: /cvs/util/tools/inc/fsys.hxx,v
retrieving revision 1.6
retrieving revision 1.6.98.1
diff -u -p -u -p -r1.6 -r1.6.98.1
--- tools/inc/fsys.hxx	20 Oct 2003 15:39:20 -0000	1.6
+++ tools/inc/fsys.hxx	10 Sep 2004 13:46:10 -0000	1.6.98.1
@@ -81,6 +81,8 @@
 #include <errcode.hxx>
 #endif
 
+#include <stdarg.h>
+
 #define FEAT_FSYS_DOUBLESPEED
 
 // --------------
Index: tools/inc/solar.h
===================================================================
RCS file: /cvs/util/tools/inc/solar.h,v
retrieving revision 1.39
retrieving revision 1.36.4.4
diff -u -p -u -p -r1.39 -r1.36.4.4
--- tools/inc/solar.h	18 Jan 2005 14:51:52 -0000	1.39
+++ tools/inc/solar.h	10 Mar 2005 02:04:10 -0000	1.36.4.4
@@ -299,8 +299,12 @@ inline USHORT	Min( USHORT a, USHORT b )	
 inline USHORT	Max( USHORT a, USHORT b )	{ return (a>b?a:b); }
 inline long 	Min( long a, long b )		{ return (a<b?a:b); }
 inline long 	Max( long a, long b )		{ return (a>b?a:b); }
+#if SAL_TYPES_SIZEOFLONG == 8
 inline ULONG	Min( ULONG a, ULONG b ) 	{ return (a<b?a:b); }
 inline ULONG	Max( ULONG a, ULONG b ) 	{ return (a>b?a:b); }
+#endif 
+inline sal_uInt32	Min( sal_uInt32 a, sal_uInt32 b ) 	{ return (a<b?a:b); }
+inline sal_uInt32	Max( sal_uInt32 a, sal_uInt32 b ) 	{ return (a>b?a:b); }
 
 inline char 	Abs( char a )				{ return (a>=0?a:-a); }
 inline int		Abs( int a )				{ return (a>=0?a:-a); }
Index: tools/inc/stream.hxx
===================================================================
RCS file: /cvs/util/tools/inc/stream.hxx,v
retrieving revision 1.7
retrieving revision 1.6.4.4
diff -u -p -u -p -r1.7 -r1.6.4.4
--- tools/inc/stream.hxx	11 Oct 2004 12:27:17 -0000	1.7
+++ tools/inc/stream.hxx	18 Jan 2005 10:50:48 -0000	1.6.4.4
@@ -78,6 +78,8 @@
 #include <rtti.hxx>
 #endif
 
+#include <limits>
+
 class StreamData;
 
 // ------------------------
@@ -92,6 +94,30 @@ inline rtl_TextEncoding GetStoreCharSet(
 		return eEncoding;
 }
 
+// ------------------
+// - 64-bit helpers -
+// ------------------
+
+// The only reason these inlines exist is to make conversion
+// to full 64-bit stream APIs easier later on.  If all places
+// that make direct use of the stream APIs use these inlines
+// to convert back to 32-bit numbers, we should
+// just be able to grep the code for places that depend on
+// 32-bit interaction with SvStream.
+
+inline sal_uInt32 svstream_Size_to_u32( sal_Size n )
+{
+	OSL_ENSURE((sal_uInt32)n <= ::std::numeric_limits< sal_uInt32 >::max(),
+		"svstream_Size_to_u32(): WARNING! truncation will during cast from 64-bit to 32-bit.");
+	return (sal_uInt32) n;
+}
+
+inline sal_Size svstream_u32_to_Size( sal_uInt32 n )
+{
+	return (sal_Size) n;
+}
+
+
 // ---------------
 // - StreamTypes -
 // ---------------
@@ -398,6 +424,9 @@ public:
 	SvStream&		operator>>( sal_uInt16& rUInt16 );
 	SvStream&		operator>>( sal_uInt32& rUInt32 );
 	SvStream&		operator>>( long& rLong );
+#if SAL_TYPES_SIZEOFLONG == 8
+	SvStream&		operator>>( sal_Size& rSize );
+#endif
 	SvStream&		operator>>( short& rShort );
 	SvStream&		operator>>( int& rInt );
 	SvStream&		operator>>( signed char& rChar );
@@ -416,6 +445,9 @@ public:
 	SvStream&		operator<<( sal_uInt16 nUInt16 );
 	SvStream&		operator<<( sal_uInt32 nUInt32 );
 	SvStream&		operator<<( long nLong );
+#if SAL_TYPES_SIZEOFLONG == 8
+	SvStream&		operator<<( sal_Size nSize );
+#endif
 	SvStream&		operator<<( short nShort );
 	SvStream&		operator<<( int nInt );
 	SvStream&		operator<<( signed char nChar );
Index: tools/source/debug/debug.cxx
===================================================================
RCS file: /cvs/util/tools/source/debug/debug.cxx,v
retrieving revision 1.7
retrieving revision 1.7.120.3
diff -u -p -u -p -r1.7 -r1.7.120.3
--- tools/source/debug/debug.cxx	7 Aug 2003 11:57:20 -0000	1.7
+++ tools/source/debug/debug.cxx	10 Sep 2004 13:42:45 -0000	1.7.120.3
@@ -71,6 +71,7 @@
 
 #include <time.h>
 #include <cstdarg>  // combinations
+#include <stdarg.h> // some platforms need cstdarg, other stdarg.h
 #include <stdlib.h>
 #include <string.h>
 #include <stdio.h>
Index: tools/source/generic/bigint.cxx
===================================================================
RCS file: /cvs/util/tools/source/generic/bigint.cxx,v
retrieving revision 1.3
retrieving revision 1.3.4.1
diff -u -p -u -p -r1.3 -r1.3.4.1
--- tools/source/generic/bigint.cxx	17 Jun 2004 13:11:15 -0000	1.3
+++ tools/source/generic/bigint.cxx	21 Jan 2005 17:23:10 -0000	1.3.4.1
@@ -686,10 +686,25 @@ BigInt::BigInt( sal_uInt32 nValue )
 }
 
 // -----------------------------------------------------------------------
-
+#if SAL_TYPE_SIZEOFLONG == 8
 BigInt::operator ULONG() const
 {
     if ( !bIsBig )
+        return nVal;
+    else if ( nLen == 2 )
+    {
+        ULONG nRet;
+        nRet  = (nNum[1]) << 16;
+        nRet += nNum[0];
+        return nRet;
+    }
+    return 0;
+}
+#endif
+// -----------------------------------------------------------------------
+BigInt::operator sal_uInt32() const
+{
+    if ( !bIsBig )
         return (sal_uInt32)nVal;
     else if ( nLen == 2 )
     {
Index: tools/source/generic/line.cxx
===================================================================
RCS file: /cvs/util/tools/source/generic/line.cxx,v
retrieving revision 1.2
retrieving revision 1.2.194.1
diff -u -p -u -p -r1.2 -r1.2.194.1
--- tools/source/generic/line.cxx	27 Mar 2003 17:04:14 -0000	1.2
+++ tools/source/generic/line.cxx	10 Sep 2004 14:02:48 -0000	1.2.194.1
@@ -74,7 +74,7 @@
 #endif
 
 #include <cstdlib>
-#include <cmath>
+#include <math.h>
 
 inline long FRound( double fVal )
 {
Index: tools/source/ref/pstm.cxx
===================================================================
RCS file: /cvs/util/tools/source/ref/pstm.cxx,v
retrieving revision 1.3
retrieving revision 1.3.64.2
diff -u -p -u -p -r1.3 -r1.3.64.2
--- tools/source/ref/pstm.cxx	26 Feb 2004 13:21:01 -0000	1.3
+++ tools/source/ref/pstm.cxx	21 Jan 2005 17:24:22 -0000	1.3.64.2
@@ -113,12 +113,12 @@ void SvPersistBaseMemberList::WriteObjec
 	rStm << bTmp;
 #endif
 	UINT32 nCount = Count();
-	ULONG  nCountPos = rStm.Tell();
+	sal_Size  nCountPos = rStm.Tell();
 	UINT32 nWriteCount = 0;
 	rStm << nCount;
 	//bloss die Liste nicht veraendern,
 	//wegen Seiteneffekten beim Save
-	for( ULONG n = 0; n < nCount; n++ )
+	for( UINT32 n = 0; n < nCount; n++ )
 	{
 		SvPersistBase * pObj = GetObject( n );
 		if( !bOnlyStreamed || rStm.IsStreamed( pObj ) )
@@ -130,7 +130,7 @@ void SvPersistBaseMemberList::WriteObjec
 	if( nWriteCount != nCount )
 	{
 		// nicht alle Objekte geschrieben, Count anpassen
-		ULONG nPos = rStm.Tell();
+		sal_Size nPos = rStm.Tell();
 		rStm.Seek( nCountPos );
 		rStm << nWriteCount;
 		rStm.Seek( nPos );
@@ -169,9 +169,9 @@ SvPersistStream& operator >> ( SvPersist
 	if( nVer & PERSIST_LIST_DBGUTIL )
 		nObjLen = rStm.ReadLen( &nObjPos );
 
-	ULONG nCount;
+	UINT32 nCount;
 	rStm >> nCount;
-	for( ULONG n = 0; n < nCount && rStm.GetError() == SVSTREAM_OK; n++ )
+	for( UINT32 n = 0; n < nCount && rStm.GetError() == SVSTREAM_OK; n++ )
 	{
 		SvPersistBase * pObj;
 		rStm >> pObj;
@@ -341,7 +341,7 @@ void SvPersistStream::ResetError()
 /*************************************************************************
 |*	  SvPersistStream::GetData()
 *************************************************************************/
-ULONG SvPersistStream::GetData( void* pData, ULONG nSize )
+sal_Size SvPersistStream::GetData( void* pData, sal_Size nSize )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Read( pData, nSize );
@@ -352,7 +352,7 @@ ULONG SvPersistStream::GetData( void* pD
 /*************************************************************************
 |*	  SvPersistStream::PutData()
 *************************************************************************/
-ULONG SvPersistStream::PutData( const void* pData, ULONG nSize )
+sal_Size SvPersistStream::PutData( const void* pData, sal_Size nSize )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Write( pData, nSize );
@@ -363,7 +363,7 @@ ULONG SvPersistStream::PutData( const vo
 /*************************************************************************
 |*	  SvPersistStream::Seek()
 *************************************************************************/
-ULONG SvPersistStream::SeekPos( ULONG nPos )
+sal_Size SvPersistStream::SeekPos( sal_Size nPos )
 {
 	DBG_ASSERT( pStm, "stream not set" )
 	ULONG nRet = pStm->Seek( nPos );
Index: tools/source/stream/stream.cxx
===================================================================
RCS file: /cvs/util/tools/source/stream/stream.cxx,v
retrieving revision 1.18
retrieving revision 1.16.4.5
diff -u -p -u -p -r1.18 -r1.16.4.5
--- tools/source/stream/stream.cxx	11 Oct 2004 12:27:31 -0000	1.18
+++ tools/source/stream/stream.cxx	18 Jan 2005 10:53:14 -0000	1.16.4.5
@@ -120,6 +120,10 @@ inline static void SwapLong( long& r )
     {   r = SWAPLONG(r);   }
 inline static void SwapULong( sal_uInt32& r )
     {   r = SWAPLONG(r);   }
+#if SAL_TYPES_SIZEOFLONG == 8
+inline static void SwapSize( sal_Size& r )
+    {   r = SWAPLONG(r);   }
+#endif
 inline static void SwapLongInt( int& r )
     {   r = SWAPLONG(r);   }
 inline static void SwapLongUInt( unsigned int& r )
@@ -178,7 +182,7 @@ int tmp = eIOMode; \
 if( (tmp == STREAM_IO_READ) && sizeof(datatype)<=nBufFree) \
 {\
     for (int i = 0; i < sizeof(datatype); i++)\
-        ((char *)&r)[i] = pBufPos[i];\
+        ((char *)&value)[i] = pBufPos[i];\
     nBufActualPos += sizeof(datatype);\
     pBufPos += sizeof(datatype);\
     nBufFree -= sizeof(datatype);\
@@ -1235,6 +1239,7 @@ SvStream& SvStream::operator>> ( sal_uIn
     return *this;
 }
 
+
 SvStream& SvStream::operator >> ( long& r )
 {
 #if(SAL_TYPES_SIZEOFLONG != 4)
@@ -1251,6 +1256,29 @@ SvStream& SvStream::operator >> ( long& 
     return *this;
 }
 
+#if SAL_TYPES_SIZEOFLONG == 8
+SvStream& SvStream::operator >> ( sal_Size& r )
+{
+
+    DBG_ASSERT( FALSE, "SvStream operator >> sal_Size not yet implemented!\n" );
+/*
+#if(SAL_TYPES_SIZEOFLONG != 4)
+    int tmp = r;
+    READNUMBER_WITHOUT_SWAP(sal_Size,tmp)
+    r = tmp;
+    if( bSwap )
+        SwapLong(r);
+#else
+    READNUMBER_WITHOUT_SWAP(long,r)
+    if( bSwap )
+        SwapLong(r);
+#endif
+*/
+    return *this;
+}
+
+#endif // SAL_TYPES_SIZEOFLONG == 8
+
 SvStream& SvStream::operator >> ( short& r )
 {
     READNUMBER_WITHOUT_SWAP(short,r)
@@ -1392,6 +1420,24 @@ SvStream& SvStream::operator<< ( long v 
     return *this;
 }
 
+#if(SAL_TYPES_SIZEOFLONG == 8)
+SvStream& SvStream::operator<< ( sal_Size v )
+{
+#if(SAL_TYPES_SIZEOFLONG != 4)
+    int tmp = v;
+    if( bSwap )
+        SwapInt(tmp);
+    WRITENUMBER_WITHOUT_SWAP(int,tmp)
+#else
+    if( bSwap )
+        SwapSize(v);
+    WRITENUMBER_WITHOUT_SWAP(long,v)
+#endif
+    return *this;
+}
+
+#endif
+
 SvStream& SvStream::operator<<  ( short v )
 {
     if( bSwap )
Index: store/inc/store/types.h
===================================================================
RCS file: /cvs/ucb/store/inc/store/types.h,v
retrieving revision 1.5
retrieving revision 1.5.96.1
diff -u -p -u -p -r1.5 -r1.5.96.1
--- store/inc/store/types.h	26 Nov 2001 20:52:57 -0000	1.5
+++ store/inc/store/types.h	25 Aug 2004 18:58:28 -0000	1.5.96.1
@@ -97,9 +97,9 @@ extern "C" {
 /** Attributes (predefined).
     @see store_attrib()
  */
-#define STORE_ATTRIB_ISLINK  0x10000000UL
-#define STORE_ATTRIB_ISDIR   0x20000000UL
-#define STORE_ATTRIB_ISFILE  0x40000000UL
+#define STORE_ATTRIB_ISLINK  ((sal_uInt32)0x10000000)
+#define STORE_ATTRIB_ISDIR   ((sal_uInt32)0x20000000)
+#define STORE_ATTRIB_ISFILE  ((sal_uInt32)0x40000000)
 
 
 /** Access Mode enumeration.
Index: store/source/storbase.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storbase.cxx,v
retrieving revision 1.7
retrieving revision 1.5.84.3
diff -u -p -u -p -r1.7 -r1.5.84.3
--- store/source/storbase.cxx	23 Dec 2004 11:33:02 -0000	1.7
+++ store/source/storbase.cxx	18 Jan 2005 23:57:54 -0000	1.5.84.3
@@ -217,12 +217,12 @@ const sal_uInt32 store::OStorePageGuard:
  * crc32.
  */
 sal_uInt32 OStorePageGuard::crc32 (
-	sal_uInt32 nCRC32, const void *pData, sal_uInt32 nSize)
+	sal_uInt32 nCRC32, const void *pData, sal_Size nSize)
 {
 	if (pData)
 	{
 		register const sal_uInt8 *p = (const sal_uInt8*)pData;
-		register sal_uInt32       n;
+		register sal_Size         n;
 
 		nCRC32 = ~nCRC32;
 		for (n = nSize; n > 0; n--)
@@ -275,7 +275,7 @@ storeError OStorePageObject::verify (con
  * OStoreSuperBlock.
  *
  *======================================================================*/
-#define STORE_MAGIC_SUPERBLOCK 0x484D5343UL
+#define STORE_MAGIC_SUPERBLOCK sal_uInt32(0x484D5343)
 
 struct OStoreSuperBlock
 {
@@ -296,7 +296,8 @@ struct OStoreSuperBlock
 	 */
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(D) + 2 * (sizeof(L) + sizeof(sal_uInt32)));
+		return sal_uInt16(sizeof(G) + sizeof(D) +
+						  2 * (sizeof(L) + sizeof(sal_uInt32)));
 	}
 
 	/** Construction.
@@ -456,7 +457,7 @@ struct OStoreStateBlock
 	 */
 	static sal_uInt16 size (void)
 	{
-		return sizeof(sal_uInt32);
+		return sal_uInt16(sizeof(sal_uInt32));
 	}
 
 	/** Construction.
Index: store/source/storbase.hxx
===================================================================
RCS file: /cvs/ucb/store/source/storbase.hxx,v
retrieving revision 1.6
retrieving revision 1.6.22.1
diff -u -p -u -p -r1.6 -r1.6.22.1
--- store/source/storbase.hxx	6 Oct 2003 17:31:55 -0000	1.6
+++ store/source/storbase.hxx	25 Aug 2004 18:58:29 -0000	1.6.22.1
@@ -122,7 +122,7 @@
 /*
  * __store_memcpy.
  */
-inline void __store_memcpy (void * dst, const void * src, sal_uInt32 n)
+inline void __store_memcpy (void * dst, const void * src, sal_Size n)
 {
 	__STORE_CSTD::memcpy (dst, src, n);
 }
@@ -130,7 +130,7 @@ inline void __store_memcpy (void * dst, 
 /*
  * __store_memmove.
  */
-inline void __store_memmove (void * dst, const void * src, sal_uInt32 n)
+inline void __store_memmove (void * dst, const void * src, sal_Size n)
 {
 	__STORE_CSTD::memmove (dst, src, n);
 }
@@ -138,7 +138,7 @@ inline void __store_memmove (void * dst,
 /*
  * __store_memset.
  */
-inline void __store_memset (void * dst, int val, sal_uInt32 n)
+inline void __store_memset (void * dst, int val, sal_Size n)
 {
 	__STORE_CSTD::memset (dst, val, n);
 }
@@ -205,7 +205,7 @@ struct OStorePageGuard
 	}
 
 	static sal_uInt32 crc32 (
-		sal_uInt32 nCRC32, const void *pData, sal_uInt32 nSize);
+		sal_uInt32 nCRC32, const void *pData, sal_Size nSize);
 };
 	
 /*========================================================================
@@ -423,8 +423,8 @@ struct OStorePageNameBlock
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(K) + sizeof(sal_uInt32) +
-				sizeof(sal_Char[STORE_MAXIMUM_NAMESIZE]));
+		return sal_uInt16(sizeof(G) + sizeof(K) + sizeof(sal_uInt32) +
+						  sizeof(sal_Char[STORE_MAXIMUM_NAMESIZE]));
 	}
 
 	/** initialize.
@@ -536,7 +536,7 @@ struct OStorePageData
 	 */
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(D) + 2 * sizeof(L));
+		return sal_uInt16(sizeof(G) + sizeof(D) + 2 * sizeof(L));
 	}
 
 	/** location.
@@ -558,7 +558,7 @@ struct OStorePageData
 		return rtl_allocateMemory (n);
 	}
 
-	static void* operator new (size_t n, sal_uInt16 nPageSize)
+	static void* operator new (size_t, sal_uInt16 nPageSize)
 	{
 		return rtl_allocateMemory (nPageSize);
 	}
Index: store/source/stordata.hxx
===================================================================
RCS file: /cvs/ucb/store/source/stordata.hxx,v
retrieving revision 1.2
retrieving revision 1.2.112.1
diff -u -p -u -p -r1.2 -r1.2.112.1
--- store/source/stordata.hxx	13 Mar 2001 20:59:02 -0000	1.2
+++ store/source/stordata.hxx	25 Aug 2004 18:58:29 -0000	1.2.112.1
@@ -93,7 +93,7 @@ namespace store
  * OStoreDataPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_DATAPAGE 0x94190310UL
+#define STORE_MAGIC_DATAPAGE sal_uInt32(0x94190310)
 
 struct OStoreDataPageData : public store::OStorePageData
 {
@@ -110,7 +110,7 @@ struct OStoreDataPageData : public store
 	*/
 	static sal_uInt16 size (void)
 	{
-		return 0;
+		return sal_uInt16(0);
 	}
 
 	/** capacity.
@@ -186,7 +186,7 @@ inline OStoreDataPageObject::OStoreDataP
  * OStoreIndirectionPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_INDIRECTPAGE 0x89191107UL
+#define STORE_MAGIC_INDIRECTPAGE sal_uInt32(0x89191107)
 
 struct OStoreIndirectionPageData : public store::OStorePageData
 {
@@ -205,7 +205,7 @@ struct OStoreIndirectionPageData : publi
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G));
+		return sal_uInt16(sizeof(G));
 	}
 
 	/** capacity.
@@ -223,11 +223,11 @@ struct OStoreIndirectionPageData : publi
 	*/
 	static sal_uInt16 capacityCount (const D& rDescr)
 	{
-		return (capacity(rDescr) / sizeof(sal_uInt32));
+		return sal_uInt16(capacity(rDescr) / sizeof(sal_uInt32));
 	}
 	sal_uInt16 capacityCount (void) const
 	{
-		return (capacity() / sizeof(sal_uInt32));
+		return sal_uInt16(capacity() / sizeof(sal_uInt32));
 	}
 
 	/** Construction.
@@ -454,7 +454,7 @@ struct OStoreDirectoryDataBlock
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(LinkTable) + sizeof(sal_uInt32));
+		return sal_uInt16(sizeof(G) + sizeof(LinkTable) + sizeof(sal_uInt32));
 	}
 
 	/** initialize.
@@ -601,7 +601,7 @@ struct OStoreDirectoryDataBlock
  * OStoreDirectoryPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_DIRECTORYPAGE 0x62190120UL
+#define STORE_MAGIC_DIRECTORYPAGE sal_uInt32(0x62190120)
 
 struct OStoreDirectoryPageData : public store::OStorePageData
 {
Index: store/source/storlckb.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storlckb.cxx,v
retrieving revision 1.4
retrieving revision 1.4.14.1
diff -u -p -u -p -r1.4 -r1.4.14.1
--- store/source/storlckb.cxx	9 Mar 2004 12:26:55 -0000	1.4
+++ store/source/storlckb.cxx	25 Aug 2004 18:58:29 -0000	1.4.14.1
@@ -119,10 +119,10 @@ using namespace store;
 /*
  * __store_convertTextToUnicode.
  */
-inline sal_Int32 __store_convertTextToUnicode (
+inline sal_Size __store_convertTextToUnicode (
 	rtl_TextToUnicodeConverter  hConverter,
-	const sal_Char *pSrcBuffer, sal_Int32 nSrcLength,
-	sal_Unicode    *pDstBuffer, sal_Int32 nDstLength)
+	const sal_Char *pSrcBuffer, sal_Size nSrcLength,
+	sal_Unicode    *pDstBuffer, sal_Size nDstLength)
 {
 	sal_uInt32 nCvtInfo = 0;
 	sal_Size nCvtBytes = 0;
@@ -351,8 +351,8 @@ storeError OStoreDirectory::iterate (sto
 			{
 				// Setup FindData.
 				sal_Char *p = m_pNode->m_aNameBlock.m_pData;
-				sal_Int32 n = rtl_str_getLength (p);
-				sal_Int32 k = rFindData.m_nLength;
+				sal_Size  n = rtl_str_getLength (p);
+				sal_Size  k = rFindData.m_nLength;
 
 				n = __store_convertTextToUnicode (
 					m_hTextCvt, p, n,
Index: store/source/storpage.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storpage.cxx,v
retrieving revision 1.3
retrieving revision 1.3.68.1
diff -u -p -u -p -r1.3 -r1.3.68.1
--- store/source/storpage.cxx	27 Mar 2003 14:06:37 -0000	1.3
+++ store/source/storpage.cxx	25 Aug 2004 18:58:29 -0000	1.3.68.1
@@ -994,7 +994,7 @@ storeError OStorePageManager::symlink (
 	// Mark 'Source' as symbolic link to 'Destination'.
 	OStoreDirectoryPageObject aPage (*m_pDirect);
 	aPage.attrib (STORE_ATTRIB_ISLINK);
-	aPage.dataLength (sizeof (aDstKey));
+	aPage.dataLength (sal_uInt32(sizeof(aDstKey)));
 
 	// Allocate and save 'Source' directory page.
 	eErrCode = base::allocate (aPage);
Index: store/source/stortree.cxx
===================================================================
RCS file: /cvs/ucb/store/source/stortree.cxx,v
retrieving revision 1.3
retrieving revision 1.3.96.1
diff -u -p -u -p -r1.3 -r1.3.96.1
--- store/source/stortree.cxx	26 Nov 2001 21:42:55 -0000	1.3
+++ store/source/stortree.cxx	25 Aug 2004 18:58:29 -0000	1.3.96.1
@@ -130,7 +130,7 @@ void OStoreBTreeNodeData::swap (const D&
 #ifdef OSL_BIGENDIAN
 	m_aGuard.swap();
 
-	sal_uInt16 i, n = capacity(rDescr) / sizeof(T);
+	sal_uInt16 i, n = sal_uInt16(capacity(rDescr) / sizeof(T));
 	for (i = 0; i < n; i++)
 		m_pData[i].swap();
 #endif /* OSL_BIGENDIAN */
@@ -177,7 +177,7 @@ void OStoreBTreeNodeData::insert (sal_uI
 
 		// insert.
 		m_pData[i] = t;
-		base::m_aDescr.m_nUsed += sizeof(T);
+		base::m_aDescr.m_nUsed += sal_uInt16(sizeof(T));
 	}
 }
 
@@ -195,7 +195,7 @@ void OStoreBTreeNodeData::remove (sal_uI
 
 		// truncate.
 		m_pData[n - 1] = T();
-		base::m_aDescr.m_nUsed -= sizeof(T);
+		base::m_aDescr.m_nUsed -= sal_uInt16(sizeof(T));
 	}
 }
 
Index: store/source/stortree.hxx
===================================================================
RCS file: /cvs/ucb/store/source/stortree.hxx,v
retrieving revision 1.2
retrieving revision 1.2.112.1
diff -u -p -u -p -r1.2 -r1.2.112.1
--- store/source/stortree.hxx	13 Mar 2001 21:03:26 -0000	1.2
+++ store/source/stortree.hxx	25 Aug 2004 18:58:30 -0000	1.2.112.1
@@ -160,7 +160,7 @@ struct OStoreBTreeEntry
  * OStoreBTreeNodeData.
  *
  *======================================================================*/
-#define STORE_MAGIC_BTREENODE 0x58190322UL
+#define STORE_MAGIC_BTREENODE sal_uInt32(0x58190322)
 
 struct OStoreBTreeNodeData : public store::OStorePageData
 {
@@ -179,7 +179,7 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G));
+		return sal_uInt16(sizeof(G));
 	}
 
 	/** capacity.
@@ -197,7 +197,7 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	sal_uInt16 capacityCount (void) const
 	{
-		return (capacity() / sizeof(T));
+		return sal_uInt16(capacity() / sizeof(T));
 	}
 
 	/** usage.
@@ -215,12 +215,12 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	sal_uInt16 usageCount (void) const
 	{
-		return (usage() / sizeof(T));
+		return sal_uInt16(usage() / sizeof(T));
 	}
 	void usageCount (sal_uInt16 nCount)
 	{
 		base::m_aDescr.m_nUsed  = base::size() + self::size();
-		base::m_aDescr.m_nUsed += nCount * sizeof(T);
+		base::m_aDescr.m_nUsed += sal_uInt16(nCount * sizeof(T));
 	}
 
 	/** Construction.
Index: store/workben/t_base.cxx
===================================================================
RCS file: /cvs/ucb/store/workben/t_base.cxx,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -u -p -r1.4 -r1.4.4.1
--- store/workben/t_base.cxx	17 Jun 2004 12:50:00 -0000	1.4
+++ store/workben/t_base.cxx	25 Aug 2004 18:58:30 -0000	1.4.4.1
@@ -372,13 +372,13 @@ static storeError __store_namei (
 	return eErrCode;
 }
 
-static sal_Int32 __store_convertTextToUnicode (
+static sal_Size __store_convertTextToUnicode (
 	rtl_TextToUnicodeConverter hConvert,
-	const sal_Char *pszText, sal_Int32 nTextLen,
-	sal_Unicode    *pBuffer, sal_Int32 nBuffer)
+	const sal_Char *pszText, sal_Size nTextLen,
+	sal_Unicode    *pBuffer, sal_Size nBuffer)
 {
 	sal_uInt32 nInfo = 0;
-	sal_uInt32 nSrcLen = 0;
+	sal_Size   nSrcLen = 0;
 
 	sal_Int32 nDstLen = rtl_convertTextToUnicode (
 		hConvert, 0,
@@ -461,6 +461,7 @@ static void __store_testUnicode (const s
  *======================================================================*/
 int SAL_CALL main (int argc, char **argv)
 {
+	OSL_PRECOND(argc > 1, "t_base: error: insufficient number of arguments.");
 	if (argc < 2)
 		return 0;
 
Index: registry/tools/checksingleton.cxx
===================================================================
RCS file: /cvs/udk/registry/tools/checksingleton.cxx,v
retrieving revision 1.6
retrieving revision 1.6.82.1
diff -u -p -u -p -r1.6 -r1.6.82.1
--- registry/tools/checksingleton.cxx	26 Mar 2003 15:37:48 -0000	1.6
+++ registry/tools/checksingleton.cxx	25 Aug 2004 12:44:14 -0000	1.6.82.1
@@ -59,6 +59,7 @@
  *
  ************************************************************************/
 #include <stdio.h>
+#include <strings.h>
 
 #include <set>
 
Index: registry/tools/regcompare.cxx
===================================================================
RCS file: /cvs/udk/registry/tools/regcompare.cxx,v
retrieving revision 1.19
retrieving revision 1.18.8.2
diff -u -p -u -p -r1.19 -r1.18.8.2
--- registry/tools/regcompare.cxx	31 Jan 2005 15:48:37 -0000	1.19
+++ registry/tools/regcompare.cxx	9 Mar 2005 20:21:53 -0000	1.18.8.2
@@ -90,6 +90,9 @@
 #ifndef _OSL_FILE_HXX_
 #include <osl/file.hxx>
 #endif
+#ifndef _SAL_TYPES_H_
+#include <sal/types.h>
+#endif
 
 #ifdef SAL_UNX
 #define SEPARATOR '/'
@@ -97,6 +100,13 @@
 #define SEPARATOR '\\'
 #endif
 
+#if SAL_TYPES_SIZEOFPOINTER == 8
+#define PRIdINTPTR "ld"
+#else
+#define PRIdINTPTR "d"
+#endif
+
+
 using namespace ::rtl;
 using namespace ::osl;
 
@@ -473,25 +483,25 @@ static sal_Char* getTypeClass(RTTypeClas
 	switch (typeClass)
 	{
 		case RT_TYPE_INTERFACE:
-			return "INTERFACE";
+			return (sal_Char*)"INTERFACE";
 		case RT_TYPE_MODULE:
-			return "MODULE";
+			return (sal_Char*)"MODULE";
 		case RT_TYPE_STRUCT:
-			return "STRUCT";
+			return (sal_Char*)"STRUCT";
 		case RT_TYPE_ENUM:
-			return "ENUM";
+			return (sal_Char*)"ENUM";
 		case RT_TYPE_EXCEPTION:
-			return "EXCEPTION";
+			return (sal_Char*)"EXCEPTION";
 		case RT_TYPE_TYPEDEF:
-			return "TYPEDEF";
+			return (sal_Char*)"TYPEDEF";
 		case RT_TYPE_SERVICE:
-			return "SERVICE";
+			return (sal_Char*)"SERVICE";
 		case RT_TYPE_OBJECT:
-			return "OBJECT";
+			return (sal_Char*)"OBJECT";
 		case RT_TYPE_CONSTANTS:
-			return "CONSTANTS";
+			return (sal_Char*)"CONSTANTS";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 }	
 
 static OString getFieldAccess(RTFieldAccess fieldAccess)
@@ -561,29 +571,29 @@ static sal_Char* getConstValueType(RTCon
 	switch (constValue.m_type)
 	{
 		case RT_TYPE_BOOL:
-			return "sal_Bool";
+			return (sal_Char*)"sal_Bool";
 		case RT_TYPE_BYTE:
-			return "sal_uInt8";
+			return (sal_Char*)"sal_uInt8";
 		case RT_TYPE_INT16:
-			return "sal_Int16";
+			return (sal_Char*)"sal_Int16";
 		case RT_TYPE_UINT16:
-			return "sal_uInt16";
+			return (sal_Char*)"sal_uInt16";
 		case RT_TYPE_INT32:
-			return "sal_Int32";
+			return (sal_Char*)"sal_Int32";
 		case RT_TYPE_UINT32:
-			return "sal_uInt32";
+			return (sal_Char*)"sal_uInt32";
 //		case RT_TYPE_INT64:
-//			return "sal_Int64";
+//			return (sal_Char*)"sal_Int64";
 //		case RT_TYPE_UINT64:
-//			return "sal_uInt64";
+//			return (sal_Char*)"sal_uInt64";
 		case RT_TYPE_FLOAT:
-			return "float";
+			return (sal_Char*)"float";
 		case RT_TYPE_DOUBLE:
-			return "double";
+			return (sal_Char*)"double";
 		case RT_TYPE_STRING:
-			return "sal_Unicode*";
+			return (sal_Char*)"sal_Unicode*";
 	}	
-	return "NONE";
+	return (sal_Char*)"NONE";
 }	
 static void printConstValue(RTConstValue& constValue)
 {
@@ -912,15 +922,15 @@ static sal_Char* getMethodMode(RTMethodM
 	switch ( methodMode )
 	{
 		case RT_MODE_ONEWAY:
-			return "ONEWAY";
+			return (sal_Char*)"ONEWAY";
 		case RT_MODE_ONEWAY_CONST:
-			return "ONEWAY,CONST";
+			return (sal_Char*)"ONEWAY,CONST";
 		case RT_MODE_TWOWAY:
-			return "NONE";
+			return (sal_Char*)"NONE";
 		case RT_MODE_TWOWAY_CONST:
-			return "CONST";
+			return (sal_Char*)"CONST";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 } 
 
 static sal_Char* getParamMode(RTParamMode paramMode)
@@ -928,13 +938,13 @@ static sal_Char* getParamMode(RTParamMod
 	switch ( paramMode )
 	{
 		case RT_PARAM_IN:
-			return "IN";
+			return (sal_Char*)"IN";
 		case RT_PARAM_OUT:
-			return "OUT";
+			return (sal_Char*)"OUT";
 		case RT_PARAM_INOUT:
-			return "INOUT";
+			return (sal_Char*)"INOUT";
 	}
-	return "INVALID";
+	return (sal_Char*)"INVALID";
 } 
 
 static sal_uInt32 checkMethod(const OUString& keyName,
@@ -1155,15 +1165,15 @@ static sal_Char* getReferenceType(RTRefe
 	switch (refType)
 	{
 		case RT_REF_SUPPORTS:
-			return "RT_REF_SUPPORTS";
+			return (sal_Char*)"RT_REF_SUPPORTS";
 		case RT_REF_OBSERVES:
-			return "RT_REF_OBSERVES";
+			return (sal_Char*)"RT_REF_OBSERVES";
 		case RT_REF_EXPORTS:
-			return "RT_REF_EXPORTS";
+			return (sal_Char*)"RT_REF_EXPORTS";
 		case RT_REF_NEEDS:
-			return "RT_REF_NEEDS";
+			return (sal_Char*)"RT_REF_NEEDS";
 	}
-	return "RT_REF_INVALID";
+	return (sal_Char*)"RT_REF_INVALID";
 }
 
 static sal_uInt32 checkReference(const OUString& keyName,
Index: canvas/source/vcl/textlayout.cxx
===================================================================
RCS file: /cvs/gsl/canvas/source/vcl/textlayout.cxx,v
retrieving revision 1.2
retrieving revision 1.2.8.1
diff -u -p -u -p -r1.2 -r1.2.8.1
--- canvas/source/vcl/textlayout.cxx	26 Nov 2004 17:16:04 -0000	1.2
+++ canvas/source/vcl/textlayout.cxx	21 Jan 2005 15:48:09 -0000	1.2.8.1
@@ -240,7 +240,7 @@ namespace vclcanvas
         rOutDev.SetLayoutMode( nLayoutMode );
 
         // TODO(P2): cache that
-        ::boost::scoped_array< long > aOffsets(new long[maLogicalAdvancements.getLength()]);
+        ::boost::scoped_array< sal_Int32 > aOffsets(new sal_Int32[maLogicalAdvancements.getLength()]);
         setupTextOffsets( aOffsets.get(), maLogicalAdvancements, viewState, renderState );
 
         rOutDev.DrawTextArray( rOutpos,
@@ -284,7 +284,7 @@ namespace vclcanvas
         };
     }
 
-    void TextLayout::setupTextOffsets( long*							outputOffsets,
+    void TextLayout::setupTextOffsets( sal_Int32*							outputOffsets,
                                        const uno::Sequence< double >& 	inputOffsets,
                                        const rendering::ViewState& 		viewState,
                                        const rendering::RenderState& 	renderState		) const
Index: canvas/source/vcl/textlayout.hxx
===================================================================
RCS file: /cvs/gsl/canvas/source/vcl/textlayout.hxx,v
retrieving revision 1.2
retrieving revision 1.2.8.1
diff -u -p -u -p -r1.2 -r1.2.8.1
--- canvas/source/vcl/textlayout.hxx	26 Nov 2004 17:16:16 -0000	1.2
+++ canvas/source/vcl/textlayout.hxx	21 Jan 2005 15:48:36 -0000	1.2.8.1
@@ -140,7 +140,7 @@ namespace vclcanvas
         TextLayout(const TextLayout&);
         TextLayout& operator=( const TextLayout& );
 
-        void setupTextOffsets( long*													outputOffsets,
+        void setupTextOffsets( sal_Int32*													outputOffsets,
                                const ::com::sun::star::uno::Sequence< double >& 		inputOffsets,
                                const ::drafts::com::sun::star::rendering::ViewState& 	viewState, 
                                const ::drafts::com::sun::star::rendering::RenderState& 	renderState		) const;
? svx/inc/zoomtbxctrl.hxx
? svx/res/openintro_ark.bmp
? svx/res/openintro_kde.bmp
? svx/res/openintro_nld.bmp
? svx/res/openintro_pld.bmp
? svx/res/openintro_redhat.bmp
? svx/res/openintro_suse.bmp
? svx/source/gengal
? svx/source/tbxctrls/zoomtbxctrl.cxx
Index: svx/inc/editeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/editeng.hxx,v
retrieving revision 1.45
retrieving revision 1.41.138.5
diff -u -p -u -p -r1.45 -r1.41.138.5
--- svx/inc/editeng.hxx	21 Jan 2005 14:23:04 -0000	1.45
+++ svx/inc/editeng.hxx	9 Mar 2005 23:51:42 -0000	1.41.138.5
@@ -235,19 +235,19 @@ public:
 
 	String			GetText( LineEnd eEnd = LINEEND_LF ) const;
 	String			GetText( const ESelection& rSelection, const LineEnd eEnd = LINEEND_LF ) const;
-	ULONG			GetTextLen() const;
-	ULONG			GetTextHeight() const;
-	ULONG			CalcTextWidth();
+	sal_uInt32		GetTextLen() const;
+	sal_uInt32		GetTextHeight() const;
+	sal_uInt32		CalcTextWidth();
 
 	String 			GetText( USHORT nParagraph ) const;
 	xub_StrLen			GetTextLen( USHORT nParagraph ) const;
-	ULONG			GetTextHeight( USHORT nParagraph ) const;
+	sal_uInt32		GetTextHeight( USHORT nParagraph ) const;
 
 	USHORT 			GetParagraphCount() const;
 
 	USHORT			GetLineCount( USHORT nParagraph ) const;
 	xub_StrLen		GetLineLen( USHORT nParagraph, USHORT nLine ) const;
-	ULONG			GetLineHeight( USHORT nParagraph, USHORT nLine = 0 );
+	sal_uInt32		GetLineHeight( USHORT nParagraph, USHORT nLine = 0 );
 	USHORT			GetFirstLineOffset( USHORT nParagraph );
 	ParagraphInfos 	GetParagraphInfos( USHORT nPara );
 	USHORT			FindParagraph( long nDocPosY );
@@ -329,9 +329,9 @@ public:
 	void			Draw( OutputDevice* pOutDev, const Rectangle& rOutRect, const Point& rStartDocPos, BOOL bClip );
 	void			Draw( OutputDevice* pOutDev, const Point& rStartPos, short nOrientation = 0 );
 
-//  ULONG: Fehlercode des Streams.
-    ULONG           Read( SvStream& rInput, const String& rBaseURL, EETextFormat, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
-	ULONG			Write( SvStream& rOutput, EETextFormat );
+//  sal_uInt32: Fehlercode des Streams.
+	sal_uInt32		Read( SvStream& rInput, const String& rBaseURL, EETextFormat, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
+	sal_uInt32		Write( SvStream& rOutput, EETextFormat );
 
 	void			SetStatusEventHdl( const Link& rLink );
 	Link			GetStatusEventHdl() const;
@@ -346,8 +346,8 @@ public:
 	BOOL			IsFlatMode() const;
 	void			SetFlatMode( BOOL bFlat );
 
-	void			SetControlWord( ULONG nWord );
-	ULONG			GetControlWord() const;
+	void			SetControlWord( sal_uInt32 nWord );
+	sal_uInt32		GetControlWord() const;
 
 	void			QuickSetAttribs( const SfxItemSet& rSet, const ESelection& rSel );
 	void 			QuickRemoveCharAttribs( USHORT nPara, USHORT nWhich = 0 );
@@ -464,7 +464,7 @@ public:
 	virtual	void	ParagraphHeightChanged( USHORT nPara );
 
 	// #101498#
-	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
+	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	virtual String	GetUndoComment( USHORT nUndoId ) const;
 	virtual BOOL	FormattingParagraph( USHORT nPara );
@@ -475,7 +475,7 @@ public:
 	virtual Rectangle GetBulletArea( USHORT nPara );
 
 	static SfxItemPool*	CreatePool( BOOL bLoadRefCounts = TRUE );
-	static ULONG	RegisterClipboardFormatName();
+	static sal_uInt32	RegisterClipboardFormatName();
 	static BOOL		DoesKeyChangeText( const KeyEvent& rKeyEvent );
 	static BOOL		DoesKeyMoveCursor( const KeyEvent& rKeyEvent );
 	static BOOL		IsSimpleCharInput( const KeyEvent& rKeyEvent );
Index: svx/inc/editstat.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/editstat.hxx,v
retrieving revision 1.4
retrieving revision 1.4.828.1
diff -u -p -u -p -r1.4 -r1.4.828.1
--- svx/inc/editstat.hxx	27 Aug 2002 14:28:31 -0000	1.4
+++ svx/inc/editstat.hxx	21 Jan 2005 16:03:42 -0000	1.4.828.1
@@ -127,7 +127,7 @@
 	EE_STAT_CRSRLEFTPARA zur Zeit bei Cursorbewegungen und Return.
 */
 
-inline void SetFlags( ULONG& rBits, const ULONG nMask, FASTBOOL bOn )
+inline void SetFlags( sal_uInt32& rBits, const sal_uInt32 nMask, FASTBOOL bOn )
 {
 	if ( bOn )
 		rBits |= nMask;
@@ -138,22 +138,22 @@ inline void SetFlags( ULONG& rBits, cons
 class EditStatus
 {
 protected:
-	ULONG	nStatusBits;
-	ULONG	nControlBits;
+	sal_uInt32	nStatusBits;
+	sal_uInt32	nControlBits;
 	USHORT	nPrevPara;					// fuer EE_STAT_CRSRLEFTPARA
 
 public:
 			EditStatus()				{ nStatusBits = 0; nControlBits = 0; nPrevPara = 0xFFFF; }
 
 	void	Clear() 					{ nStatusBits = 0; }
-	void	SetControlBits( ULONG nMask, FASTBOOL bOn )
+	void	SetControlBits( sal_uInt32 nMask, FASTBOOL bOn )
 				{ SetFlags( nControlBits, nMask, bOn ); }
 
-	ULONG	GetStatusWord() const		{ return nStatusBits; }
-	ULONG&	GetStatusWord() 			{ return nStatusBits; }
+	sal_uInt32	GetStatusWord() const		{ return nStatusBits; }
+	sal_uInt32&	GetStatusWord() 			{ return nStatusBits; }
 
-	ULONG	GetControlWord() const		{ return nControlBits; }
-	ULONG&	GetControlWord() 			{ return nControlBits; }
+	sal_uInt32	GetControlWord() const		{ return nControlBits; }
+	sal_uInt32&	GetControlWord() 			{ return nControlBits; }
 
 	USHORT	GetPrevParagraph() const	{ return nPrevPara; }
 	USHORT&	GetPrevParagraph() 			{ return nPrevPara; }
Index: svx/inc/editview.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/editview.hxx,v
retrieving revision 1.14
retrieving revision 1.13.26.2
diff -u -p -u -p -r1.14 -r1.13.26.2
--- svx/inc/editview.hxx	21 Jan 2005 14:23:44 -0000	1.14
+++ svx/inc/editview.hxx	9 Mar 2005 23:46:36 -0000	1.13.26.2
@@ -225,14 +225,14 @@ public:
 	void				RemoveAttribs( BOOL bRemoveParaAttribs = FALSE, USHORT nWhich = 0 );
 	void 				RemoveCharAttribs( USHORT nPara, USHORT nWhich = 0 );
 
-    ULONG           Read( SvStream& rInput, const String& rBaseURL, EETextFormat eFormat, BOOL bSelect = FALSE, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
-	ULONG			Write( SvStream& rOutput, EETextFormat eFormat );
+	sal_uInt32		Read( SvStream& rInput, const String& rBaseURL, EETextFormat eFormat, BOOL bSelect = FALSE, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
+	sal_uInt32		Write( SvStream& rOutput, EETextFormat eFormat );
 
 	void 			SetBackgroundColor( const Color& rColor );
 	Color			GetBackgroundColor() const;
 
-	void			SetControlWord( ULONG nWord );
-	ULONG			GetControlWord() const;
+	void			SetControlWord( sal_uInt32 nWord );
+	sal_uInt32		GetControlWord() const;
 
 	EditTextObject*	CreateTextObject();
 	void			InsertText( const EditTextObject& rTextObject );
Index: svx/inc/lrspitem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/lrspitem.hxx,v
retrieving revision 1.5
retrieving revision 1.4.854.2
diff -u -p -u -p -r1.5 -r1.4.854.2
--- svx/inc/lrspitem.hxx	21 Jan 2005 14:55:17 -0000	1.5
+++ svx/inc/lrspitem.hxx	9 Mar 2005 23:50:59 -0000	1.4.854.2
@@ -127,8 +127,8 @@ public:
 	TYPEINFO();
 
 	SvxLRSpaceItem( const USHORT nId = ITEMID_LRSPACE );
-	SvxLRSpaceItem( const long nLeft, const long nRight,
-					const long nTLeft = 0, const short nOfset = 0,
+	SvxLRSpaceItem( const sal_Int32 nLeft, const sal_Int32 nRight,
+					const sal_Int32 nTLeft = 0, const short nOfset = 0,
 					const USHORT nId = ITEMID_LRSPACE );
 	inline SvxLRSpaceItem& operator=( const SvxLRSpaceItem &rCpy );
 
Index: svx/inc/msdffimp.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/msdffimp.hxx,v
retrieving revision 1.26
retrieving revision 1.20.98.5
diff -u -p -u -p -r1.26 -r1.20.98.5
--- svx/inc/msdffimp.hxx	21 Feb 2005 16:16:53 -0000	1.26
+++ svx/inc/msdffimp.hxx	9 Mar 2005 23:30:24 -0000	1.20.98.5
@@ -540,9 +540,9 @@ public:
 	static BOOL ReadCommonRecordHeader( DffRecordHeader& rRec, SvStream& rIn );
 	static BOOL ReadCommonRecordHeader( SvStream& rSt,
 										BYTE&     rVer,
-										USHORT&   rInst,
-										USHORT&   rFbt,
-										ULONG&    rLength );
+										sal_uInt16& rInst,
+										sal_uInt16& rFbt,
+										sal_uInt32& rLength );
 /*
 	Konstruktor
 	===========
@@ -590,7 +590,7 @@ public:
 
 	void SetModel(SdrModel* pModel, long nApplicationScale);
 	SdrModel*  GetModel() const { return pSdrModel; }
-	void Scale(long& rVal) const;
+	void Scale(sal_Int32& rVal) const;
 	void Scale(Point& rPos) const;
 	void Scale(Size& rSiz) const;
 	void Scale(Rectangle& rRect) const;
@@ -598,7 +598,7 @@ public:
 	void Scale(PolyPolygon& rPoly) const;
 	void Scale(XPolygon& rPoly) const;
 	void Scale(XPolyPolygon& rPoly) const;
-	void ScaleEmu(long& rVal) const;
+	void ScaleEmu(sal_Int32& rVal) const;
 	UINT32 ScalePt( UINT32 nPt ) const;
 	INT32 ScalePoint( INT32 nVal ) const;
 
Index: svx/inc/numfmtsh.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/numfmtsh.hxx,v
retrieving revision 1.5
retrieving revision 1.4.832.2
diff -u -p -u -p -r1.5 -r1.4.832.2
--- svx/inc/numfmtsh.hxx	21 Jan 2005 14:59:45 -0000	1.5
+++ svx/inc/numfmtsh.hxx	9 Mar 2005 23:41:25 -0000	1.4.832.2
@@ -139,12 +139,12 @@ class SVX_DLLPUBLIC SvxNumberFormatShell
 {
 public:
 						SvxNumberFormatShell( SvNumberFormatter* pNumFormatter,
-											  ULONG              nFormatKey,
+											  sal_uInt32		 nFormatKey,
 											  SvxNumberValueType eNumValType,
 											  const String&		 rNumStr );
 
 						SvxNumberFormatShell( SvNumberFormatter* pNumFormatter,
-											  ULONG				 nFormatKey,
+											  sal_uInt32		 nFormatKey,
 											  SvxNumberValueType eNumValType,
 											  double			 nNumVal,
 											  const String*		 pNumStr = NULL );
@@ -153,12 +153,12 @@ public:
 
 
 	static SvxNumberFormatShell*	Create( SvNumberFormatter* pNumFormatter,
-											  ULONG              nFormatKey,
+											  sal_uInt32		 nFormatKey,
 											  SvxNumberValueType eNumValType,
 											  const String&		 rNumStr );
 
 	static SvxNumberFormatShell*	Create( SvNumberFormatter* pNumFormatter,
-											  ULONG				 nFormatKey,
+											  sal_uInt32		 nFormatKey,
 											  SvxNumberValueType eNumValType,
 											  double			 nNumVal,
 											  const String*		 pNumStr = NULL );
@@ -184,7 +184,7 @@ public:
                                        Color*& rpFontColor );
 
 	BOOL				AddFormat( String&    rFormat,
-								   ULONG&     rErrPos,
+								   sal_uInt32& rErrPos,
 								   USHORT&    rCatLbSelPos,
 								   short&     rFmtSelPos,
 								   SvStrings& rFmtEntries );
@@ -219,15 +219,15 @@ public:
 
 	BOOL				IsUserDefined( const String& rFmtString );
 	BOOL				IsTmpCurrencyFormat( const String& rFmtString );
-	BOOL				FindEntry( const String& rFmtString, ULONG* pAt = NULL );
+	BOOL				FindEntry( const String& rFmtString, sal_uInt32* pAt = NULL );
 
 	void				ValidateNewEntries( BOOL bValidate = TRUE ) { bUndoAddList = !bValidate; }
-	ULONG				GetUpdateDataCount() const;
-	void				GetUpdateData( ULONG* pDelArray, const ULONG nSize );
+	sal_uInt32			GetUpdateDataCount() const;
+	void				GetUpdateData( sal_uInt32* pDelArray, const sal_uInt32 nSize );
 
-	void				SetCurNumFmtKey( ULONG nNew )		{ nCurFormatKey = nNew; }
+	void				SetCurNumFmtKey( sal_uInt32 nNew )	{ nCurFormatKey = nNew; }
 	void				SetCurLanguage( LanguageType eNew ) { eCurLanguage = eNew; }
-	ULONG				GetCurNumFmtKey() const				{ return nCurFormatKey; }
+	sal_uInt32			GetCurNumFmtKey() const				{ return nCurFormatKey; }
 	LanguageType		GetCurLanguage() const				{ return eCurLanguage; }
 
 	String				GetComment4Entry(short nEntry);
@@ -238,12 +238,12 @@ public:
 
 	BOOL				IsBankingSymbol(USHORT nPos);
 	void				SetCurrencySymbol(USHORT nPos);
-	ULONG				GetCurrencySymbol();
+	sal_uInt32			GetCurrencySymbol();
 	USHORT				FindCurrencyFormat( const String& rFmtString );
 	USHORT				FindCurrencyFormat(const NfCurrencyEntry* pTmpCurrencyEntry,BOOL bTmpBanking);
 	NfCurrencyEntry*	GetCurCurrencyEntry();
 	void				SetCurCurrencyEntry(NfCurrencyEntry*);
-	short				GetListPos4Entry(ULONG nIdx);
+	short				GetListPos4Entry(sal_uInt32 nIdx);
 	short				GetListPos4Entry( const String& rFmtString );
 
 	void				GetCurrencySymbols(SvStringsDtor& rList,const XubString& rStrEurope,USHORT* pPos);
@@ -266,8 +266,8 @@ private:
 	SvULongs				aAddList;
 	SvULongs				aDelList;
 	SvULongs				aCurEntryList;
-	ULONG					nInitFormatKey;
-	ULONG					nCurFormatKey;
+	sal_uInt32				nInitFormatKey;
+	sal_uInt32				nCurFormatKey;
 	short					nCurCategory;
 	LanguageType			eCurLanguage;
 	SvUShorts				aCurCurrencyList;
@@ -290,8 +290,8 @@ private:
 	SVX_DLLPRIVATE short					FillEListWithUserCurrencys( SvStrings& rList,short nSelPos);
 
 	SVX_DLLPRIVATE short					FillEListWithUsD_Impl( SvStrings& rList, sal_uInt16 nPrivCat, short Pos );
-	SVX_DLLPRIVATE BOOL					IsRemoved_Impl( ULONG nKey );
-	SVX_DLLPRIVATE BOOL					IsAdded_Impl( ULONG nKey );
+	SVX_DLLPRIVATE BOOL					IsRemoved_Impl( sal_uInt32 nKey );
+	SVX_DLLPRIVATE BOOL					IsAdded_Impl( sal_uInt32 nKey );
 	SVX_DLLPRIVATE void					GetPreviewString_Impl( String& rString,
                                                    Color*& rpColor );
 	SVX_DLLPRIVATE void					PosToCategory_Impl( USHORT nPos, short& rCategory );
Index: svx/inc/numinf.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/numinf.hxx,v
retrieving revision 1.4
retrieving revision 1.3.858.2
diff -u -p -u -p -r1.4 -r1.3.858.2
--- svx/inc/numinf.hxx	21 Jan 2005 15:00:01 -0000	1.4
+++ svx/inc/numinf.hxx	10 Mar 2005 00:14:22 -0000	1.3.858.2
@@ -118,12 +118,12 @@ public:
 	double					GetValueDouble() const 	{ return nDoubleVal; }
 	void					SetDoubleValue( const double& rNewVal );
 
-	const ULONG*			GetDelArray() const { return pDelFormatArr; }
-	void					SetDelFormatArray( const ULONG* pData,
-											   const ULONG  nCount );
+	const sal_uInt32*		GetDelArray() const { return pDelFormatArr; }
+	void					SetDelFormatArray( const sal_uInt32* pData,
+											   const sal_uInt32  nCount );
 
 	SvxNumberValueType		GetValueType() const { return eValueType; }
-	ULONG					GetDelCount() const  { return nDelCount; }
+	sal_uInt32				GetDelCount() const  { return nDelCount; }
 
 private:
 	SvNumberFormatter*	pFormatter;
@@ -131,8 +131,8 @@ private:
 	String				aStringVal;
 	double				nDoubleVal;
 
-	ULONG*				pDelFormatArr;
-	ULONG				nDelCount;
+	sal_uInt32*			pDelFormatArr;
+	sal_uInt32			nDelCount;
 };
 
 #endif
Index: svx/inc/outliner.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/outliner.hxx,v
retrieving revision 1.51
retrieving revision 1.46.138.4
diff -u -p -u -p -r1.51 -r1.46.138.4
--- svx/inc/outliner.hxx	21 Jan 2005 15:04:09 -0000	1.51
+++ svx/inc/outliner.hxx	10 Mar 2005 00:13:02 -0000	1.46.138.4
@@ -438,7 +438,7 @@ public:
 
     const SvxFont&  rFont;
 
-    const long*     pDXArray;
+    const sal_Int32*     pDXArray;
 
 	// #101498# BiDi level needs to be transported, too.
 	BYTE			mnBiDiLevel;
@@ -447,8 +447,8 @@ public:
 	sal_Bool IsRTL() const;
 
     DrawPortionInfo( const Point& rPos, const String& rTxt, USHORT nTxtStart, USHORT nTxtLen,
- 		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const long* pDXArr, BYTE nBiDiLevel)
-         :	rStartPos(rPos), rText(rTxt), nPara(nPar), nIndex(nIdx),
+		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const sal_Int32* pDXArr, BYTE nBiDiLevel)
+        :	rStartPos(rPos), rText(rTxt), nPara(nPar), nIndex(nIdx), 
 			rFont(rFnt), pDXArray(pDXArr), mnBiDiLevel(nBiDiLevel)
 	    {
             nTextStart = nTxtStart;
@@ -834,7 +839,7 @@ public:
 
 	// #101498#
 	virtual void    DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen,
-						const long* pDXArray, const SvxFont& rFont,
+						const sal_Int32* pDXArray, const SvxFont& rFont,
 						USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	Size            CalcTextSize();
@@ -875,7 +880,7 @@ public:
 	ULONG           GetLineHeight( ULONG nParagraph, ULONG nLine = 0 );
 
 	// nFormat muss ein Wert aus dem enum EETextFormat sein (wg.CLOOKS)
-    ULONG           Read( SvStream& rInput, const String& rBaseURL, USHORT, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
+	ULONG			Read( SvStream& rInput, const String& rBaseURL, USHORT, SvKeyValueIterator* pHTTPHeaderAttrs = NULL );
 
 	SfxUndoManager& GetUndoManager();
 
Index: svx/inc/rulritem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/rulritem.hxx,v
retrieving revision 1.7
retrieving revision 1.6.222.2
diff -u -p -u -p -r1.7 -r1.6.222.2
--- svx/inc/rulritem.hxx	21 Jan 2005 15:11:35 -0000	1.7
+++ svx/inc/rulritem.hxx	10 Mar 2005 00:03:20 -0000	1.6.222.2
@@ -229,7 +229,7 @@ typedef SvPtrarr SvxColumns;
 class SVX_DLLPUBLIC SvxColumnItem : public SfxPoolItem
 {
 	SvxColumns aColumns;// Spaltenarray
-	long	nLeft,		// Linker Rand bei Tabelle
+	sal_Int32	nLeft,		// Linker Rand bei Tabelle
 		   nRight;		// Rechter Rand bei Tabelle; bei Spalten immer gleich
 						// zum umgebenden Rahmen
 	USHORT nActColumn;	// die aktuelle Spalte
@@ -297,10 +297,10 @@ public:
 class SVX_DLLPUBLIC SvxObjectItem : public SfxPoolItem
 {
 private:
-	long   nStartX;					   /* Beginn in X-Richtung */
-	long   nEndX;					   /* Ende in X-Richtung */
-	long   nStartY;                    /* Beginn in Y-Richtung */
-	long   nEndY;                      /* Ende in Y-Richtung */
+	sal_Int32   nStartX;					   /* Beginn in X-Richtung */
+	sal_Int32   nEndX;					   /* Ende in X-Richtung */
+	sal_Int32   nStartY;                    /* Beginn in Y-Richtung */
+	sal_Int32   nEndY;                      /* Ende in Y-Richtung */
 	BOOL   bLimits;					   /* Grenzwertkontrolle durch die Applikation */
 protected:
 	virtual int 			 operator==( const SfxPoolItem& ) const;
@@ -325,10 +325,10 @@ public:
 
 	BOOL   HasLimits() const { return bLimits; }
 
-	long   GetStartX() const { return nStartX; }
-	long   GetEndX() const { return nEndX; }
-	long   GetStartY() const { return nStartY; }
-	long   GetEndY() const { return nEndY; }
+	sal_Int32   GetStartX() const { return nStartX; }
+	sal_Int32   GetEndX() const { return nEndX; }
+	sal_Int32   GetStartY() const { return nStartY; }
+	sal_Int32   GetEndY() const { return nEndY; }
 
 	void   SetStartX(long l) { nStartX = l; }
 	void   SetEndX(long l) { nEndX = l; }
Index: svx/inc/svdmodel.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/svdmodel.hxx,v
retrieving revision 1.47
retrieving revision 1.42.108.4
diff -u -p -u -p -r1.47 -r1.42.108.4
--- svx/inc/svdmodel.hxx	16 Feb 2005 17:54:17 -0000	1.47
+++ svx/inc/svdmodel.hxx	9 Mar 2005 23:27:32 -0000	1.42.108.4
@@ -422,10 +422,10 @@ public:
 	// Zeichenobjekte verwenden moechte. Setzt man degegen nur vom abstrakten
 	// Basisobjekt SdrObject abgeleitete Objekte ein, so ist man frei in der
 	// Wahl des Pools.
-	SdrModel(SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(const String& rPath, SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(const String& rPath, SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
 	virtual ~SdrModel();
 
 	// #116168#
Index: svx/inc/svxfont.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/svxfont.hxx,v
retrieving revision 1.3
retrieving revision 1.2.848.2
diff -u -p -u -p -r1.3 -r1.2.848.2
--- svx/inc/svxfont.hxx	21 Jan 2005 15:34:41 -0000	1.3
+++ svx/inc/svxfont.hxx	9 Mar 2005 23:34:40 -0000	1.2.848.2
@@ -149,10 +149,10 @@ public:
 			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN ) const;
 
 	void QuickDrawText( OutputDevice *pOut, const Point &rPos, const String &rTxt,
-			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const long* pDXArray = NULL ) const;
+			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const sal_Int32* pDXArray = NULL ) const;
 
 	Size QuickGetTextSize( const OutputDevice *pOut, const String &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray = NULL ) const;
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray = NULL ) const;
 
 	void DrawPrev( OutputDevice* pOut, Printer* pPrinter,
 				   const Point &rPos, const String &rTxt,
Index: svx/inc/tstpitem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/tstpitem.hxx,v
retrieving revision 1.5
retrieving revision 1.4.676.2
diff -u -p -u -p -r1.5 -r1.4.676.2
--- svx/inc/tstpitem.hxx	21 Jan 2005 15:40:13 -0000	1.5
+++ svx/inc/tstpitem.hxx	10 Mar 2005 00:07:00 -0000	1.4.676.2
@@ -88,7 +88,7 @@
 class SVX_DLLPUBLIC SvxTabStop
 {
 private:
-	long            nTabPos;
+	sal_Int32            nTabPos;
 
 	SvxTabAdjust    eAdjustment;
 	sal_Unicode		cDecimal;
@@ -110,8 +110,8 @@ public:
 				const sal_Unicode cFil = cDfltFillChar );
 #endif
 
-	long&           GetTabPos() { return nTabPos; }
-	long            GetTabPos() const { return nTabPos; }
+	sal_Int32&           GetTabPos() { return nTabPos; }
+	sal_Int32            GetTabPos() const { return nTabPos; }
 
 	SvxTabAdjust&   GetAdjustment() { return eAdjustment; }
 	SvxTabAdjust    GetAdjustment() const { return eAdjustment; }
Index: svx/inc/xhatch.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/xhatch.hxx,v
retrieving revision 1.3
retrieving revision 1.2.298.2
diff -u -p -u -p -r1.3 -r1.2.298.2
--- svx/inc/xhatch.hxx	21 Jan 2005 16:09:16 -0000	1.3
+++ svx/inc/xhatch.hxx	9 Mar 2005 23:32:17 -0000	1.2.298.2
@@ -81,8 +81,8 @@ class SVX_DLLPUBLIC XHatch
 protected:
 	XHatchStyle		eStyle;
 	Color			aColor;
-	long			nDistance;
-	long			nAngle;
+	sal_Int32		nDistance;
+	sal_Int32			nAngle;
 
 public:
 					XHatch() {}
@@ -98,8 +98,8 @@ public:
 
 	XHatchStyle		GetHatchStyle() const { return eStyle; }
 	Color			GetColor() const { return aColor; }
-	long			GetDistance() const { return nDistance; }
-	long			GetAngle() const { return nAngle; }
+	sal_Int32			GetDistance() const { return nDistance; }
+	sal_Int32			GetAngle() const { return nAngle; }
 };
 
 #endif
Index: svx/source/accessibility/AccessibleContextBase.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleContextBase.cxx,v
retrieving revision 1.20
retrieving revision 1.20.642.1
diff -u -p -u -p -r1.20 -r1.20.642.1
--- svx/source/accessibility/AccessibleContextBase.cxx	24 Apr 2003 16:52:52 -0000	1.20
+++ svx/source/accessibility/AccessibleContextBase.cxx	9 Sep 2004 09:39:57 -0000	1.20.642.1
@@ -287,7 +287,7 @@ sal_Int32 SAL_CALL
     an exception for a wrong index.
 */
 uno::Reference<XAccessible> SAL_CALL
-    AccessibleContextBase::getAccessibleChild (long nIndex)
+    AccessibleContextBase::getAccessibleChild (sal_Int32 nIndex)
     throw (::com::sun::star::lang::IndexOutOfBoundsException, ::com::sun::star::uno::RuntimeException)
 {
     ThrowIfDisposed ();
Index: svx/source/accessibility/AccessibleShape.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleShape.cxx,v
retrieving revision 1.46
retrieving revision 1.44.222.2
diff -u -p -u -p -r1.46 -r1.44.222.2
--- svx/source/accessibility/AccessibleShape.cxx	26 Nov 2004 18:11:37 -0000	1.46
+++ svx/source/accessibility/AccessibleShape.cxx	19 Jan 2005 02:06:54 -0000	1.44.222.2
@@ -1080,7 +1080,7 @@ void AccessibleShape::ViewForwarderChang
     // of the same type.  If such an index where not given to the
     // constructor then use the z-order instead.  If even that does not exist
     // we throw an exception.
-    long nIndex = mnIndex;
+    sal_Int32 nIndex = mnIndex;
     if (nIndex == -1)
     {
         try
Index: svx/source/accessibility/AccessibleStringWrap.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleStringWrap.cxx,v
retrieving revision 1.3
retrieving revision 1.3.642.1
diff -u -p -u -p -r1.3 -r1.3.642.1
--- svx/source/accessibility/AccessibleStringWrap.cxx	24 Apr 2003 16:55:35 -0000	1.3
+++ svx/source/accessibility/AccessibleStringWrap.cxx	9 Sep 2004 09:39:57 -0000	1.3.642.1
@@ -104,7 +104,7 @@ sal_Bool AccessibleStringWrap::GetCharac
     }
     else
     {
-        long aXArray[2];
+        sal_Int32 aXArray[2];
         mrDev.GetCaretPositions( maText, aXArray, static_cast< USHORT >(nIndex), 1 );
         rRect.Left() = 0;
         rRect.Top() = 0;
Index: svx/source/accessibility/DGColorNameLookUp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/DGColorNameLookUp.cxx,v
retrieving revision 1.2
retrieving revision 1.2.600.1
diff -u -p -u -p -r1.2 -r1.2.600.1
--- svx/source/accessibility/DGColorNameLookUp.cxx	26 May 2003 09:05:12 -0000	1.2
+++ svx/source/accessibility/DGColorNameLookUp.cxx	9 Sep 2004 09:39:57 -0000	1.2.600.1
@@ -112,7 +112,7 @@ DGColorNameLookUp& DGColorNameLookUp::In
 
 
 
-OUString DGColorNameLookUp::LookUpColor (long int nColor) const
+OUString DGColorNameLookUp::LookUpColor (sal_Int32 nColor) const
 {
     OUString sColorName;
     tColorValueToNameMap::const_iterator I;
@@ -172,7 +172,7 @@ DGColorNameLookUp::DGColorNameLookUp (vo
             try
             {
                 uno::Any aColor (xNA->getByName (aNames[i]));
-                long nColor;
+                sal_Int32 nColor;
                 aColor >>= nColor;
                 maColorValueToNameMap[nColor] = aNames[i];
             }
Index: svx/source/accessibility/DescriptionGenerator.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/DescriptionGenerator.cxx,v
retrieving revision 1.6
retrieving revision 1.6.600.1
diff -u -p -u -p -r1.6 -r1.6.600.1
--- svx/source/accessibility/DescriptionGenerator.cxx	26 May 2003 09:05:24 -0000	1.6
+++ svx/source/accessibility/DescriptionGenerator.cxx	9 Sep 2004 09:39:58 -0000	1.6.600.1
@@ -354,7 +354,7 @@ void DescriptionGenerator::AddColor (con
     try
     {
         
-        long nValue;
+        sal_Int32 nValue;
         if (mxSet.is())
         {
             uno::Any aValue = mxSet->getPropertyValue (sPropertyName);
@@ -394,7 +394,7 @@ void DescriptionGenerator::AddInteger (c
         if (mxSet.is())
         {
             uno::Any aValue = mxSet->getPropertyValue (sPropertyName);
-            long nValue;
+            sal_Int32 nValue;
             aValue >>= nValue;
             msDescription.append (nValue);
         }
Index: svx/source/customshapes/EnhancedCustomShapeFontWork.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/customshapes/EnhancedCustomShapeFontWork.cxx,v
retrieving revision 1.7
retrieving revision 1.2.174.3
diff -u -p -u -p -r1.7 -r1.2.174.3
--- svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	21 Feb 2005 16:17:39 -0000	1.7
+++ svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	10 Mar 2005 00:35:59 -0000	1.2.174.3
@@ -345,7 +345,7 @@ void GetTextAreaOutline( const FWData& r
 
 			SvxCharScaleWidthItem& rCharScaleWidthItem = (SvxCharScaleWidthItem&)pCustomShape->GetMergedItem( EE_CHAR_FONTWIDTH );
 			sal_uInt16 nCharScaleWidth = rCharScaleWidthItem.GetValue();
-			long* pDXArry = NULL;
+			sal_Int32* pDXArry = NULL;
 			sal_Int32 nWidth = 0;
 
 			// VERTICAL
@@ -410,7 +410,7 @@ void GetTextAreaOutline( const FWData& r
 			{
 				if ( ( nCharScaleWidth != 100 ) && nCharScaleWidth )
 				{	// applying character spacing
-					pDXArry = new long[ rText.getLength() ];
+					pDXArry = new sal_Int32[ rText.getLength() ];
 					aVirDev.GetTextArray( rText, pDXArry, 0, STRING_LEN );
 					FontMetric aFontMetric( aVirDev.GetFontMetric() );
 					aFont.SetWidth( (sal_Int32)( (double)aFontMetric.GetWidth() * ( (double)100 / (double)nCharScaleWidth ) ) );
Index: svx/source/dialog/connpooloptions.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/connpooloptions.cxx,v
retrieving revision 1.4
retrieving revision 1.3.94.2
diff -u -p -u -p -r1.4 -r1.3.94.2
--- svx/source/dialog/connpooloptions.cxx	21 Jan 2005 16:29:51 -0000	1.4
+++ svx/source/dialog/connpooloptions.cxx	10 Mar 2005 00:58:45 -0000	1.3.94.2
@@ -142,7 +142,7 @@ namespace offapp
 		virtual void CursorMoved();
 
 	protected:
-		virtual ULONG GetTotalCellWidth(long nRow, USHORT nColId);
+		virtual sal_uInt32 GetTotalCellWidth(long nRow, USHORT nColId);
 
 
 	private:
@@ -261,7 +261,7 @@ namespace offapp
 	}
 
 	//--------------------------------------------------------------------
-	ULONG DriverListControl::GetTotalCellWidth(long nRow, USHORT nColId)
+	sal_uInt32 DriverListControl::GetTotalCellWidth(long nRow, USHORT nColId)
 	{
 		return GetDataWindow().GetTextWidth(GetCellText(nRow, nColId));
 	}
Index: svx/source/dialog/numfmt.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/numfmt.cxx,v
retrieving revision 1.20
retrieving revision 1.19.226.2
diff -u -p -u -p -r1.20 -r1.19.226.2
--- svx/source/dialog/numfmt.cxx	21 Jan 2005 16:42:35 -0000	1.20
+++ svx/source/dialog/numfmt.cxx	10 Mar 2005 00:42:04 -0000	1.19.226.2
@@ -857,7 +857,7 @@ BOOL SvxNumberFormatTabPage::FillItemSet
         // OK chosen - Is format code input entered already taken over?
         // If not, simulate Add. Upon syntax error ignore input and prevent Put.
 		String		aFormat	= aEdFormat.GetText();
-		ULONG nCurKey = pNumFmtShell->GetCurNumFmtKey();
+		sal_uInt32 nCurKey = pNumFmtShell->GetCurNumFmtKey();
 
         if ( aIbAdd.IsEnabled() || pNumFmtShell->IsTmpCurrencyFormat(aFormat) )
         {   // #79599# It is not sufficient to just add the format code (or
@@ -892,11 +892,11 @@ BOOL SvxNumberFormatTabPage::FillItemSet
 		// --------------------------------------------------------------
         // List of changed user defined formats:
         // -------------------------------------
-		const ULONG nDelCount = pNumFmtShell->GetUpdateDataCount();
+		const sal_uInt32 nDelCount = pNumFmtShell->GetUpdateDataCount();
 
 		if ( nDelCount > 0 )
 		{
-			ULONG*			pDelArr = new ULONG[nDelCount];
+			sal_uInt32*			pDelArr = new sal_uInt32[nDelCount];
 
 			pNumFmtShell->GetUpdateData( pDelArr, nDelCount );
 			pNumItem->SetDelFormatArray( pDelArr, nDelCount );
@@ -1137,7 +1137,7 @@ void SvxNumberFormatTabPage::UpdateOptio
 	}
 	else if ( aLbFormat.GetEntryCount() > 0 )
 	{
-		ULONG nCurEntryKey=NUMKEY_UNDEFINED;
+		sal_uInt32 nCurEntryKey=NUMKEY_UNDEFINED;
 		if(!pNumFmtShell->FindEntry( aEdFormat.GetText(),&nCurEntryKey))
 		{
 			aLbFormat.SetNoSelection();
@@ -1514,7 +1514,7 @@ IMPL_LINK( SvxNumberFormatTabPage, Click
 		SvxDelStrgs	a2EntryList;
 		USHORT		nCatLbSelPos = 0;
 		short		nFmtLbSelPos = SELPOS_NONE;
-		ULONG		nErrPos=0;
+		sal_uInt32	nErrPos=0;
 
 		pNumFmtShell->SetCurCurrencyEntry(NULL);
 		bAdded = pNumFmtShell->AddFormat( aFormat, nErrPos,
@@ -1669,7 +1669,7 @@ IMPL_LINK( SvxNumberFormatTabPage, Click
 
 IMPL_LINK( SvxNumberFormatTabPage, EditHdl_Impl, Edit*, pEdFormat )
 {
-	ULONG nCurKey = NUMKEY_UNDEFINED;
+	sal_uInt32 nCurKey = NUMKEY_UNDEFINED;
 
 	if ( aEdFormat.GetText().Len() == 0 )
 	{
Index: svx/source/dialog/optdict.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optdict.cxx,v
retrieving revision 1.4
retrieving revision 1.3.110.3
diff -u -p -u -p -r1.4 -r1.3.110.3
--- svx/source/dialog/optdict.cxx	21 Jan 2005 16:44:23 -0000	1.4
+++ svx/source/dialog/optdict.cxx	10 Mar 2005 00:50:37 -0000	1.3.110.3
@@ -612,8 +612,8 @@ void SvxEditDictionaryDialog::ShowWords_
 
 	if (aWordsLB.GetEntryCount())
 	{
-		aWordED	  .SetText( aWordsLB.GetEntryText(0LU, 0) );
-		aReplaceED.SetText( aWordsLB.GetEntryText(0LU, 1) );
+		aWordED	  .SetText( aWordsLB.GetEntryText(0UL, 0) );
+		aReplaceED.SetText( aWordsLB.GetEntryText(0UL, 1) );
 	}
 
 	LeaveWait();
Index: svx/source/dialog/optmemory.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optmemory.cxx,v
retrieving revision 1.6
retrieving revision 1.4.130.3
diff -u -p -u -p -r1.6 -r1.4.130.3
--- svx/source/dialog/optmemory.cxx	21 Jan 2005 16:46:26 -0000	1.6
+++ svx/source/dialog/optmemory.cxx	10 Mar 2005 00:57:06 -0000	1.4.130.3
@@ -199,34 +199,34 @@ using namespace ::sfx2;
 #define BYTES2NF		(1.0/NF2BYTES)					// 10/2^20
 
 
-inline long OfaMemoryOptionsPage::GetNfGraphicCacheVal( void ) const
+inline sal_Size OfaMemoryOptionsPage::GetNfGraphicCacheVal( void ) const
 {
 	return aNfGraphicCache.GetValue() << 20;
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicCacheVal( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicCacheVal( sal_Size nSizeInBytes )
 {
 	aNfGraphicCache.SetValue( nSizeInBytes >> 20 );
 }
 
-long OfaMemoryOptionsPage::GetNfGraphicObjectCacheVal( void ) const
+sal_Size OfaMemoryOptionsPage::GetNfGraphicObjectCacheVal( void ) const
 {
-	return long( ::rtl::math::round( double( aNfGraphicObjectCache.GetValue() ) * NF2BYTES ) );
+	return sal_Size( ::rtl::math::round( double( aNfGraphicObjectCache.GetValue() ) * NF2BYTES ) );
 }
 
-void OfaMemoryOptionsPage::SetNfGraphicObjectCacheVal( long nSizeInBytes )
+void OfaMemoryOptionsPage::SetNfGraphicObjectCacheVal( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetValue( long( ::rtl::math::round( double( nSizeInBytes ) * BYTES2NF ) ) );
+	aNfGraphicObjectCache.SetValue( sal_Size( ::rtl::math::round( double( nSizeInBytes ) * BYTES2NF ) ) );
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheMax( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheMax( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetMax( long( double( nSizeInBytes ) * BYTES2NF ) );
+	aNfGraphicObjectCache.SetMax( sal_Size( double( nSizeInBytes ) * BYTES2NF ) );
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheLast( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheLast( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetLast( long( double( nSizeInBytes ) * BYTES2NF ) );
+	aNfGraphicObjectCache.SetLast( sal_Size( double( nSizeInBytes ) * BYTES2NF ) );
 }
 
 int OfaMemoryOptionsPage::DeactivatePage( SfxItemSet* pSet )
@@ -341,7 +341,7 @@ void OfaMemoryOptionsPage::Reset( const 
     aUndoEdit.SaveValue();
 
     // GraphicCache
-	long	n = aCacheOptions.GetGraphicManagerTotalCacheSize();
+	sal_Int32	n = aCacheOptions.GetGraphicManagerTotalCacheSize();
 	SetNfGraphicCacheVal( n );
 	SetNfGraphicObjectCacheVal( Min( GetNfGraphicCacheVal(), aCacheOptions.GetGraphicManagerObjectCacheSize() ) );
 
@@ -363,7 +363,7 @@ void OfaMemoryOptionsPage::Reset( const 
 
 IMPL_LINK( OfaMemoryOptionsPage, GraphicCacheConfigHdl, NumericField*, pEd )
 {
-	long	n = GetNfGraphicCacheVal();
+	sal_Int32	n = GetNfGraphicCacheVal();
 	SetNfGraphicObjectCacheMax( n );
 	SetNfGraphicObjectCacheLast( n );
 
Index: svx/source/dialog/optmemory.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optmemory.hxx,v
retrieving revision 1.3
retrieving revision 1.3.264.1
diff -u -p -u -p -r1.3 -r1.3.264.1
--- svx/source/dialog/optmemory.hxx	11 Feb 2004 16:40:13 -0000	1.3
+++ svx/source/dialog/optmemory.hxx	9 Sep 2004 09:39:59 -0000	1.3.264.1
@@ -110,13 +110,13 @@ private:
 
 	DECL_LINK( GraphicCacheConfigHdl, NumericField* );
 
-	inline long			GetNfGraphicCacheVal( void ) const;					// returns # of Bytes
-	inline void			SetNfGraphicCacheVal( long nSizeInBytes );
+	inline sal_Size			GetNfGraphicCacheVal( void ) const;					// returns # of Bytes
+	inline void			SetNfGraphicCacheVal( sal_Size nSizeInBytes );
 
-	long				GetNfGraphicObjectCacheVal( void ) const;			// returns # of Bytes
-	void				SetNfGraphicObjectCacheVal( long nSizeInBytes );
-	inline void			SetNfGraphicObjectCacheMax( long nSizeInBytes );
-	inline void			SetNfGraphicObjectCacheLast( long nSizeInBytes );
+	sal_Size				GetNfGraphicObjectCacheVal( void ) const;			// returns # of Bytes
+	void				SetNfGraphicObjectCacheVal( sal_Size nSizeInBytes );
+	inline void			SetNfGraphicObjectCacheMax( sal_Size nSizeInBytes );
+	inline void			SetNfGraphicObjectCacheLast( sal_Size nSizeInBytes );
 protected:
 	virtual int         DeactivatePage( SfxItemSet* pSet = NULL );
 
Index: svx/source/dialog/swpossizetabpage.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/swpossizetabpage.cxx,v
retrieving revision 1.6
retrieving revision 1.5.152.2
diff -u -p -u -p -r1.6 -r1.5.152.2
--- svx/source/dialog/swpossizetabpage.cxx	21 Jan 2005 16:50:41 -0000	1.6
+++ svx/source/dialog/swpossizetabpage.cxx	10 Mar 2005 00:40:14 -0000	1.5.152.2
@@ -1004,12 +1004,12 @@ void SvxSwPosSizeTabPage::Reset( const S
     }
 
     pItem = GetItem( rSet, SID_ATTR_TRANSFORM_WIDTH );
-    sal_Int32 nWidth = Max( pItem ? ( static_cast<const SfxUInt32Item*>(pItem)->GetValue()) : 0, (UINT32)1 );
+    sal_Int32 nWidth = Max( pItem ? ( static_cast<const SfxUInt32Item*>(pItem)->GetValue()) : 0, sal_uInt32( 1 ) );
 
     m_aWidthMF.SetValue(m_aWidthMF.Normalize(nWidth), FUNIT_TWIP);
 
     pItem = GetItem( rSet, SID_ATTR_TRANSFORM_HEIGHT );
-    sal_Int32 nHeight = Max( pItem ? ( static_cast<const SfxUInt32Item*>(pItem)->GetValue()) : 0, (UINT32)1 );
+    sal_Int32 nHeight = Max( pItem ? ( static_cast<const SfxUInt32Item*>(pItem)->GetValue()) : 0, sal_uInt32( 1 ) );
     m_aHeightMF.SetValue(m_aHeightMF.Normalize(nHeight), FUNIT_TWIP);
     m_fWidthHeightRatio = nHeight ? double(nWidth) / double(nHeight) : 1.0;
 
Index: svx/source/dialog/tpline.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/tpline.cxx,v
retrieving revision 1.28
retrieving revision 1.23.270.4
diff -u -p -u -p -r1.28 -r1.23.270.4
--- svx/source/dialog/tpline.cxx	21 Jan 2005 16:53:26 -0000	1.28
+++ svx/source/dialog/tpline.cxx	10 Mar 2005 00:47:23 -0000	1.23.270.4
@@ -1040,7 +1040,7 @@ void SvxLineTabPage::Reset( const SfxIte
 		VirtualDevice aVDev;
 		aVDev.SetMapMode(MapMode(MAP_100TH_MM));
 
-		SdrModel* pModel = new SdrModel(NULL, NULL, LOADREFCOUNTS);
+		SdrModel* pModel = new SdrModel((SfxItemPool*)NULL, (SfxObjectShell*)NULL, (sal_Bool)LOADREFCOUNTS);
 		pModel->GetItemPool().FreezeIdRanges();
 		SdrPage* pPage = new SdrPage( *pModel, FALSE );
 		pPage->SetSize(Size(1000,1000));
Index: svx/source/dialog/transfrm.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/transfrm.cxx,v
retrieving revision 1.18
retrieving revision 1.15.316.4
diff -u -p -u -p -r1.18 -r1.15.316.4
--- svx/source/dialog/transfrm.cxx	21 Jan 2005 16:54:37 -0000	1.18
+++ svx/source/dialog/transfrm.cxx	10 Mar 2005 00:55:22 -0000	1.15.316.4
@@ -1197,10 +1197,10 @@ void SvxPositionSizeTabPage::Reset( cons
 */  }
 
 	pItem = GetItem( mrOutAttrs, SID_ATTR_TRANSFORM_WIDTH );
-	mlOldWidth = Max( pItem ? ( (const SfxUInt32Item*)pItem )->GetValue() : 0, (UINT32)1 );
+	mlOldWidth = Max( pItem ? ( (const SfxUInt32Item*)pItem )->GetValue() : 0, sal_uInt32( 1 ) );
 
 	pItem = GetItem( mrOutAttrs, SID_ATTR_TRANSFORM_HEIGHT );
-	mlOldHeight = Max( pItem ? ( (const SfxUInt32Item*)pItem )->GetValue() : 0, (UINT32)1 );
+	mlOldHeight = Max( pItem ? ( (const SfxUInt32Item*)pItem )->GetValue() : 0, sal_uInt32( 1 ) );
 
 	Fraction aUIScale = mpView->GetModel()->GetUIScale();
 
@@ -1305,8 +1305,8 @@ int SvxPositionSizeTabPage::DeactivatePa
 {
 	if( pSet )
 	{
-		INT32 lX = maMtrPosX.GetValue();
-		INT32 lY = maMtrPosY.GetValue();
+		long lX = maMtrPosX.GetValue();
+		long lY = maMtrPosY.GetValue();
 
 		// #106330#
 		// The below BugFix assumed that GetTopLeftPosition()
@@ -1601,7 +1601,7 @@ void SvxPositionSizeTabPage::SetMinMaxPo
 
 //------------------------------------------------------------------------
 
-void SvxPositionSizeTabPage::GetTopLeftPosition( INT32& rX, INT32& rY,
+void SvxPositionSizeTabPage::GetTopLeftPosition( long& rX, long& rY,
 												const Rectangle& rRect )
 {
 	switch ( maCtlPos.GetActualRP() )
Index: svx/source/dialog/transfrm.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/transfrm.hxx,v
retrieving revision 1.3
retrieving revision 1.2.270.2
diff -u -p -u -p -r1.3 -r1.2.270.2
--- svx/source/dialog/transfrm.hxx	28 Jun 2004 14:07:02 -0000	1.3
+++ svx/source/dialog/transfrm.hxx	19 Oct 2004 18:45:16 -0000	1.2.270.2
@@ -185,7 +185,7 @@ private:
 //  DECL_LINK( SetOrientHdl, ListBox * );
 
 	void SetMinMaxPosition();
-	void GetTopLeftPosition( INT32& rX, INT32& rY, const Rectangle& rRect );
+	void GetTopLeftPosition( long& rX, long& rY, const Rectangle& rRect );
 #endif
 
 #if _SOLAR__PRIVATE
Index: svx/source/editeng/editdoc.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc.hxx,v
retrieving revision 1.20
retrieving revision 1.20.364.2
diff -u -p -u -p -r1.20 -r1.20.364.2
--- svx/source/editeng/editdoc.hxx	1 Sep 2003 12:00:48 -0000	1.20
+++ svx/source/editeng/editdoc.hxx	21 Jan 2005 16:09:43 -0000	1.20.364.2
@@ -403,13 +403,13 @@ struct ExtraPortionInfo
     BOOL    bFirstCharIsRightPunktuation;
     BOOL    bCompressed;
 
-    long*    pOrgDXArray;
+    sal_Int32*    pOrgDXArray;
 
 
             ExtraPortionInfo();
             ~ExtraPortionInfo();
 
-    void    SaveOrgDXArray( const long* pDXArray, USHORT nLen );
+    void    SaveOrgDXArray( const sal_Int32* pDXArray, USHORT nLen );
     void    DestroyOrgDXArray();
 };
 
@@ -484,7 +484,7 @@ public:
 
 class ParaPortion;
 
-SV_DECL_VARARR( CharPosArray, long, 0, CHARPOSGROW );
+SV_DECL_VARARR( CharPosArray, sal_Int32, 0, CHARPOSGROW );
 
 // ------------------------------------------------------------------------
 // class EditLine
Index: svx/source/editeng/editdoc2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc2.cxx,v
retrieving revision 1.11
retrieving revision 1.11.826.2
diff -u -p -u -p -r1.11 -r1.11.826.2
--- svx/source/editeng/editdoc2.cxx	28 Aug 2002 15:20:19 -0000	1.11
+++ svx/source/editeng/editdoc2.cxx	21 Jan 2005 16:10:20 -0000	1.11.826.2
@@ -98,7 +98,7 @@
 
 DBG_NAME( EE_ParaPortion );
 
-SV_IMPL_VARARR( CharPosArray, long );
+SV_IMPL_VARARR( CharPosArray, sal_Int32 );
 
 /*
 
@@ -200,11 +200,11 @@ ExtraPortionInfo::~ExtraPortionInfo()
     delete[] pOrgDXArray;
 }
 
-void ExtraPortionInfo::SaveOrgDXArray( const long* pDXArray, USHORT nLen ) 
+void ExtraPortionInfo::SaveOrgDXArray( const sal_Int32* pDXArray, USHORT nLen ) 
 {
     delete[] pOrgDXArray;
-    pOrgDXArray = new long[nLen];
-    memcpy( pOrgDXArray, pDXArray, nLen*sizeof(long) );
+    pOrgDXArray = new sal_Int32[nLen];
+    memcpy( pOrgDXArray, pDXArray, nLen*sizeof(sal_Int32) );
 }
 
 void ExtraPortionInfo::DestroyOrgDXArray()
Index: svx/source/editeng/editeng.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editeng.cxx,v
retrieving revision 1.93
retrieving revision 1.90.138.3
diff -u -p -u -p -r1.93 -r1.90.138.3
--- svx/source/editeng/editeng.cxx	11 Jan 2005 12:58:08 -0000	1.93
+++ svx/source/editeng/editeng.cxx	19 Jan 2005 02:05:11 -0000	1.90.138.3
@@ -2416,7 +2416,7 @@ BOOL EditEngine::IsVerboseTextComments()
 // =====================================================================
 // ======================   Virtuelle Methoden   =======================
 // =====================================================================
-void __EXPORT EditEngine::DrawingText( const Point&, const XubString&, USHORT nTextStart, USHORT nTextLen, const long*, const SvxFont&, sal_uInt16 nPara, sal_uInt16 nIndex, BYTE nRightToLeft )
+void __EXPORT EditEngine::DrawingText( const Point&, const XubString&, USHORT nTextStart, USHORT nTextLen, const sal_Int32*, const SvxFont&, sal_uInt16 nPara, sal_uInt16 nIndex, BYTE nRightToLeft )
 {
 	DBG_CHKTHIS( EditEngine, 0 );
 }
Index: svx/source/editeng/impedit.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit.hxx,v
retrieving revision 1.69
retrieving revision 1.69.26.1
diff -u -p -u -p -r1.69 -r1.69.26.1
--- svx/source/editeng/impedit.hxx	11 Jan 2005 12:59:27 -0000	1.69
+++ svx/source/editeng/impedit.hxx	21 Jan 2005 16:10:55 -0000	1.69.26.1
@@ -680,7 +680,7 @@ private:
 	BOOL				IsScriptChange( const EditPaM& rPaM ) const;
     BOOL                HasScriptType( USHORT nPara, USHORT nType ) const;
 
-    BOOL                ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, long* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray );
+    BOOL                ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, sal_Int32* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray );
     void                ImplExpandCompressedPortions( EditLine* pLine, ParaPortion* pParaPortion, long nRemainingWidth );
 
     void                ImplInitLayoutMode( OutputDevice* pOutDev, USHORT nPara, USHORT nIndex );
@@ -757,7 +757,7 @@ private:
                                               const String&							rTxt,
                                               const USHORT 							nIdx, 
                                               const USHORT 							nLen, 
-                                              const long* 							pDXArray ) const;
+                                              const sal_Int32* 							pDXArray ) const;
 
 protected:
 	virtual void			Notify( SfxBroadcaster& rBC, const SfxHint& rHint );
Index: svx/source/editeng/impedit2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit2.cxx,v
retrieving revision 1.98
retrieving revision 1.95.138.4
diff -u -p -u -p -r1.98 -r1.95.138.4
--- svx/source/editeng/impedit2.cxx	11 Jan 2005 12:59:41 -0000	1.98
+++ svx/source/editeng/impedit2.cxx	21 Jan 2005 16:11:54 -0000	1.95.138.4
@@ -2827,14 +2827,14 @@ EditPaM ImpEditEngine::GetPaM( Point aDo
 	return aPaM;
 }
 
-ULONG ImpEditEngine::GetTextHeight() const
+sal_uInt32 ImpEditEngine::GetTextHeight() const
 {
 	DBG_ASSERT( GetUpdateMode(), "Sollte bei Update=FALSE nicht verwendet werden: GetTextHeight" );
 	DBG_ASSERT( IsFormatted() || IsFormatting(), "GetTextHeight: Nicht formatiert" );
 	return nCurTextHeight;
 }
 
-ULONG ImpEditEngine::CalcTextWidth( BOOL bIgnoreExtraSpace )
+sal_uInt32 ImpEditEngine::CalcTextWidth( BOOL bIgnoreExtraSpace )
 {
 	// Wenn noch nicht formatiert und nicht gerade dabei.
 	// Wird in der Formatierung bei AutoPageSize gerufen.
@@ -2897,20 +2897,20 @@ ULONG ImpEditEngine::CalcTextWidth( BOOL
 		nMaxWidth = 0;
 
 	nMaxWidth++; // Ein breiter, da in CreateLines bei >= umgebrochen wird.
-	return (ULONG)nMaxWidth;
+	return (sal_uInt32)nMaxWidth;
 }
 
-ULONG ImpEditEngine::CalcLineWidth( ParaPortion* pPortion, EditLine* pLine, BOOL bIgnoreExtraSpace )
+sal_uInt32 ImpEditEngine::CalcLineWidth( ParaPortion* pPortion, EditLine* pLine, BOOL bIgnoreExtraSpace )
 {
 	USHORT nPara = GetEditDoc().GetPos( pPortion->GetNode() );
-    ULONG nOldLayoutMode = GetRefDevice()->GetLayoutMode();
+    sal_uInt32 nOldLayoutMode = GetRefDevice()->GetLayoutMode();
 
     ImplInitLayoutMode( GetRefDevice(), nPara, 0xFFFF );
 
     SvxAdjust eJustification = GetJustification( nPara );
 
     // Berechnung der Breite ohne die Indents...
-	ULONG nWidth = 0;
+	sal_uInt32 nWidth = 0;
     USHORT nPos = pLine->GetStart();
 	for ( USHORT nTP = pLine->GetStartPortion(); nTP <= pLine->GetEndPortion(); nTP++ )
 	{
@@ -2948,10 +2948,10 @@ ULONG ImpEditEngine::CalcLineWidth( Para
     return nWidth;
 }
 
-ULONG ImpEditEngine::CalcTextHeight()
+sal_uInt32 ImpEditEngine::CalcTextHeight()
 {
 	DBG_ASSERT( GetUpdateMode(), "Sollte bei Update=FALSE nicht verwendet werden: CalcTextHeight" );
-	ULONG nY = 0;
+	sal_uInt32 nY = 0;
 	for ( USHORT nPortion = 0; nPortion < GetParaPortions().Count(); nPortion++ )
 		nY += GetParaPortions()[nPortion]->GetHeight();
 	return nY;
@@ -2998,9 +2998,9 @@ USHORT ImpEditEngine::GetLineHeight( USH
 	return 0xFFFF;
 }
 
-ULONG ImpEditEngine::GetParaHeight( USHORT nParagraph )
+sal_uInt32 ImpEditEngine::GetParaHeight( USHORT nParagraph )
 {
-	ULONG nHeight = 0;
+	sal_uInt32 nHeight = 0;
 
 	ParaPortion* pPPortion = GetParaPortions().SaveGetObject( nParagraph );
 	DBG_ASSERT( pPPortion, "Absatz nicht gefunden: GetParaHeight" );
@@ -3833,7 +3833,7 @@ long ImpEditEngine::GetXPos( ParaPortion
                     if ( nType == CHAR_PUNCTUATIONRIGHT )
                     {
                         USHORT n = nIndex - nTextPortionStart;
-                        const long* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
+                        const sal_Int32* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
                         long nCharWidth = ( ( (n+1) < pPortion->GetLen() ) ? pDXArray[n] : pPortion->GetSize().Width() )
                                                         - ( n ? pDXArray[n-1] : 0 );
                         if ( (n+1) < pPortion->GetLen() )
Index: svx/source/editeng/impedit3.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit3.cxx,v
retrieving revision 1.94
retrieving revision 1.91.220.4
diff -u -p -u -p -r1.94 -r1.91.220.4
--- svx/source/editeng/impedit3.cxx	26 Nov 2004 18:12:55 -0000	1.94
+++ svx/source/editeng/impedit3.cxx	21 Jan 2005 16:12:20 -0000	1.91.220.4
@@ -211,7 +211,7 @@ BYTE GetCharTypeForCompression( xub_Unic
     }
 }
 
-void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const long* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
+void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const sal_Int32* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
 {
 #ifndef SVX_LIGHT
 	// Aber nur, wenn Font nicht zu klein...
@@ -482,7 +482,7 @@ void ImpEditEngine::FormatDoc()
 			aStatus.GetStatusWord() |= !IsVertical() ? EE_STAT_TEXTHEIGHTCHANGED : EE_STAT_TEXTWIDTHCHANGED;
 		if ( nNewHeight < nCurTextHeight )
 		{
-			aInvalidRec.Bottom() = (long)Max( nNewHeight, nCurTextHeight );
+			aInvalidRec.Bottom() = Max( long(nNewHeight), long(nCurTextHeight) );
 			if ( aInvalidRec.IsEmpty() )
 			{
 				aInvalidRec.Top() = 0;
@@ -773,7 +773,7 @@ sal_Bool ImpEditEngine::CreateLines( USH
 	SvxFont aTmpFont( pNode->GetCharAttribs().GetDefFont() );
 
 	sal_Bool bCalcCharPositions = sal_True;
-	long* pBuf = new long[ pNode->Len() ];
+	sal_Int32* pBuf = new sal_Int32[ pNode->Len() ];
 
 	sal_Bool bSameLineAgain = sal_False;	// Fuer TextRanger, wenn sich die Hoehe aendert.
 	TabInfo aCurrentTab;
@@ -1085,7 +1085,7 @@ sal_Bool ImpEditEngine::CreateLines( USH
 
                 // And now check for Compression:
                 if ( pPortion->GetLen() && GetAsianCompressionMode() )
-                    bCompressedChars |= ImplCalcAsianCompression( pNode, pPortion, nTmpPos, (long*)pLine->GetCharPosArray().GetData() + (nTmpPos-pLine->GetStart()), 10000, FALSE );
+                    bCompressedChars |= ImplCalcAsianCompression( pNode, pPortion, nTmpPos, const_cast< sal_Int32* >( pLine->GetCharPosArray().GetData() + (nTmpPos-pLine->GetStart()) ), 10000, FALSE );
 
 				nTmpWidth += pPortion->GetSize().Width();
 
@@ -1258,7 +1258,7 @@ sal_Bool ImpEditEngine::CreateLines( USH
             if ( bCompressedChars && ( pPortion->GetLen() > 1 ) && pPortion->GetExtraInfos() && pPortion->GetExtraInfos()->bCompressed )
             {
                 // I need the manipulated DXArray for determining the break postion...
-                ImplCalcAsianCompression( pNode, pPortion, nPortionStart, (long*)pLine->GetCharPosArray().GetData() + (nPortionStart-pLine->GetStart()), 10000, TRUE );
+                ImplCalcAsianCompression( pNode, pPortion, nPortionStart, const_cast< sal_Int32* >( pLine->GetCharPosArray().GetData() + (nPortionStart-pLine->GetStart()) ), 10000, TRUE );
             }
 			ImpBreakLine( pParaPortion, pLine, pPortion, nPortionStart,
 											nRemainingWidth, bCanHyphenate && bHyphenatePara );
@@ -3004,8 +3004,8 @@ void ImpEditEngine::Paint( OutputDevice*
 								XubString aText;
                                 USHORT nTextStart = 0;
                                 USHORT nTextLen = 0;
-								const long* pDXArray = 0;
-								long* pTmpDXArray = 0;
+								const sal_Int32* pDXArray = 0;
+								sal_Int32* pTmpDXArray = 0;
 
 								if ( pTextPortion->GetKind() == PORTIONKIND_TEXT )
 								{
@@ -3023,7 +3023,7 @@ void ImpEditEngine::Paint( OutputDevice*
                                     nTextStart = 0;
                                     nTextLen = aText.Len();
 
-									pTmpDXArray = new long[ aText.Len() ];
+									pTmpDXArray = new sal_Int32[ aText.Len() ];
 									pDXArray = pTmpDXArray;
 									Font aOldFont( GetRefDevice()->GetFont() );
 									aTmpFont.SetPhysFont( GetRefDevice() );
@@ -4108,7 +4108,7 @@ Color ImpEditEngine::GetAutoColor() cons
 }
 
 
-BOOL ImpEditEngine::ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, long* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray )
+BOOL ImpEditEngine::ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, sal_Int32* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray )
 {
     DBG_ASSERT( GetAsianCompressionMode(), "ImplCalcAsianCompression - Why?" );
     DBG_ASSERT( pTextPortion->GetLen(), "ImplCalcAsianCompression - Empty Portion?" );
@@ -4279,9 +4279,9 @@ void ImpEditEngine::ImplExpandCompressed
                 USHORT nTxtPortion = pParaPortion->GetTextPortions().GetPos( pTP );
                 USHORT nTxtPortionStart = pParaPortion->GetTextPortions().GetStartPos( nTxtPortion );
                 DBG_ASSERT( nTxtPortionStart >= pLine->GetStart(), "Portion doesn't belong to the line!!!" );
-                long* pDXArray = (long*)pLine->GetCharPosArray().GetData()+( nTxtPortionStart-pLine->GetStart() );
+                sal_Int32* pDXArray = const_cast< sal_Int32* >( pLine->GetCharPosArray().GetData()+( nTxtPortionStart-pLine->GetStart() ) );
                 if ( pTP->GetExtraInfos()->pOrgDXArray )
-                    memcpy( pDXArray, pTP->GetExtraInfos()->pOrgDXArray, (pTP->GetLen()-1)*sizeof(long) );
+                    memcpy( pDXArray, pTP->GetExtraInfos()->pOrgDXArray, (pTP->GetLen()-1)*sizeof(sal_Int32) );
                 ImplCalcAsianCompression( pParaPortion->GetNode(), pTP, nTxtPortionStart, pDXArray, (USHORT)nCompressPercent, TRUE );
             }
         }
@@ -4299,7 +4299,7 @@ void ImpEditEngine::ImplDrawWithComments
                                           const String&			rTxt,
                                           const USHORT 			nIdx, 
                                           const USHORT 			nLen, 
-                                          const long* 			pDXArray ) const
+                                          const sal_Int32* 			pDXArray ) const
 {
     Reference< i18n::XBreakIterator > xBI( ImplGetBreakIterator() );
 
Index: svx/source/editeng/impedit4.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit4.cxx,v
retrieving revision 1.55
retrieving revision 1.52.136.3
diff -u -p -u -p -r1.55 -r1.52.136.3
--- svx/source/editeng/impedit4.cxx	11 Jan 2005 12:59:55 -0000	1.55
+++ svx/source/editeng/impedit4.cxx	19 Jan 2005 02:06:20 -0000	1.52.136.3
@@ -2669,7 +2669,7 @@ EditSelection ImpEditEngine::Translitera
 
 			xub_StrLen nLen = nCurrentEnd - nCurrentStart;
 
-			Sequence <long> aOffsets;
+			Sequence <sal_Int32> aOffsets;
 			String aNewText( aTranslitarationWrapper.transliterate( *pNode, nLanguage, nCurrentStart, nLen, &aOffsets ) );
 
 			if( ( nLen != aNewText.Len() ) || !pNode->Equals( aNewText, nCurrentStart, nLen ) )
@@ -2694,7 +2694,7 @@ EditSelection ImpEditEngine::Translitera
 
                 // Change text without loosing the attributes
                 USHORT nCharsAfterTransliteration = aOffsets.getLength();
-                const long* pOffsets = aOffsets.getConstArray();
+                const sal_Int32* pOffsets = aOffsets.getConstArray();
                 short nDiffs = 0;
                 for ( USHORT n = 0; n < nCharsAfterTransliteration; n++ )
                 {
Index: svx/source/fmcomp/fmgridcl.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/fmcomp/fmgridcl.cxx,v
retrieving revision 1.46
retrieving revision 1.43.108.4
diff -u -p -u -p -r1.46 -r1.43.108.4
--- svx/source/fmcomp/fmgridcl.cxx	17 Feb 2005 10:54:24 -0000	1.46
+++ svx/source/fmcomp/fmgridcl.cxx	10 Mar 2005 01:01:04 -0000	1.43.108.4
@@ -2207,7 +2207,7 @@ void FmGridControl::Select()
 	}
 }
 // -----------------------------------------------------------------------------
-long FmGridControl::GetSelectedColumn() const		
+sal_Int32 FmGridControl::GetSelectedColumn() const		
 { 
 	return m_nCurrentSelectedColumn; 
 }
Index: svx/source/form/filtnav.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/form/filtnav.cxx,v
retrieving revision 1.37
retrieving revision 1.37.94.1
diff -u -p -u -p -r1.37 -r1.37.94.1
--- svx/source/form/filtnav.cxx	8 Sep 2004 14:40:16 -0000	1.37
+++ svx/source/form/filtnav.cxx	21 Jan 2005 16:12:44 -0000	1.37.94.1
@@ -1373,7 +1373,7 @@ sal_Bool FmFilterNavigator::EditedEntry(
 	if (aText.Len() == 0)
 	{
 		// deleting the entry asynchron
-		sal_uInt32 nEvent;
+		ULONG nEvent;
 		PostUserEvent(nEvent, LINK(this, FmFilterNavigator, OnRemove), pEntry);
 	}
 	else
Index: svx/source/form/fmexpl.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/form/fmexpl.cxx,v
retrieving revision 1.31
retrieving revision 1.31.156.1
diff -u -p -u -p -r1.31 -r1.31.156.1
--- svx/source/form/fmexpl.cxx	16 Nov 2004 11:23:04 -0000	1.31
+++ svx/source/form/fmexpl.cxx	21 Jan 2005 16:13:05 -0000	1.31.156.1
@@ -411,7 +411,7 @@ FmEntryData::FmEntryData( const FmEntryD
 void FmEntryData::Clear()
 {
     FmEntryData* pEntryData;
-    while( pEntryData = GetChildList()->Remove(sal_uInt32(0)) )
+    while( pEntryData = GetChildList()->Remove(0UL) )
         delete pEntryData;
 }
 
Index: svx/source/form/fmvwimp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/form/fmvwimp.cxx,v
retrieving revision 1.42
retrieving revision 1.33.104.4
diff -u -p -u -p -r1.42 -r1.33.104.4
--- svx/source/form/fmvwimp.cxx	17 Feb 2005 10:56:51 -0000	1.42
+++ svx/source/form/fmvwimp.cxx	10 Mar 2005 00:31:19 -0000	1.33.104.4
@@ -1696,8 +1696,8 @@ void FmXFormView::createControlLabelPair
 	aRealSize.Height()= aDefSize.Height();
 
 	// je nach Skalierung des Zieldevices muss die Groesse noch normiert werden (#53523#)
-	aRealSize.Width() = sal_Int32(Fraction(aRealSize.Width(), 1) * eTargetMode.GetScaleX());
-	aRealSize.Height() = sal_Int32(Fraction(aRealSize.Height(), 1) * eTargetMode.GetScaleY());
+	aRealSize.Width() = Fraction(aRealSize.Width(), 1) * eTargetMode.GetScaleX();
+	aRealSize.Height() = Fraction(aRealSize.Height(), 1) * eTargetMode.GetScaleY();
 	_rpLabel->SetLogicRect(
 		::Rectangle(	_pOutDev->LogicToLogic(Point(0, _nYOffsetMM), eSourceMode, eTargetMode),
 					_pOutDev->LogicToLogic(aRealSize, eSourceMode, eTargetMode)
@@ -1717,8 +1717,8 @@ void FmXFormView::createControlLabelPair
 		szControlSize = aDefSize;
 
 	// normieren wie oben
-	szControlSize.Width() = sal_Int32(Fraction(szControlSize.Width(), 1) * eTargetMode.GetScaleX());
-	szControlSize.Height() = sal_Int32(Fraction(szControlSize.Height(), 1) * eTargetMode.GetScaleY());
+	szControlSize.Width() = Fraction(szControlSize.Width(), 1) * eTargetMode.GetScaleX();
+	szControlSize.Height() = Fraction(szControlSize.Height(), 1) * eTargetMode.GetScaleY();
 	_rpControl->SetLogicRect(
 		::Rectangle(	_pOutDev->LogicToLogic(Point(aRealSize.Width(), _nYOffsetMM), eSourceMode, eTargetMode),
 					_pOutDev->LogicToLogic(szControlSize, eSourceMode, eTargetMode)
Index: svx/source/inc/DGColorNameLookUp.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/DGColorNameLookUp.hxx,v
retrieving revision 1.2
retrieving revision 1.2.600.1
diff -u -p -u -p -r1.2 -r1.2.600.1
--- svx/source/inc/DGColorNameLookUp.hxx	26 May 2003 09:05:56 -0000	1.2
+++ svx/source/inc/DGColorNameLookUp.hxx	9 Sep 2004 09:40:03 -0000	1.2.600.1
@@ -102,7 +102,7 @@ public:
             color or, when no name exists, a string of the form "#RRGGBB"
             with two hexadecimal digits for each color component.
     */
-    ::rtl::OUString LookUpColor (long int nColor) const;
+    ::rtl::OUString LookUpColor (sal_Int32 nColor) const;
 
 private:
     /// Define hash map type to convert numerical color values to names.
Index: svx/source/inc/GraphCtlAccessibleContext.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/GraphCtlAccessibleContext.hxx,v
retrieving revision 1.9
retrieving revision 1.9.546.1
diff -u -p -u -p -r1.9 -r1.9.546.1
--- svx/source/inc/GraphCtlAccessibleContext.hxx	26 Jun 2003 11:10:37 -0000	1.9
+++ svx/source/inc/GraphCtlAccessibleContext.hxx	9 Sep 2004 09:40:03 -0000	1.9.546.1
@@ -210,8 +210,8 @@ public:
 
 	//=====  XAccessibleContext  ==============================================
 
-    virtual long SAL_CALL getAccessibleChildCount (void) throw (::com::sun::star::uno::RuntimeException);
-    virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleChild (long nIndex) throw (::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException);
+    virtual sal_Int32 SAL_CALL getAccessibleChildCount (void) throw (::com::sun::star::uno::RuntimeException);
+    virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleChild (sal_Int32 nIndex) throw (::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException);
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleParent (void) throw (::com::sun::star::uno::RuntimeException);
 	virtual	sal_Int32 SAL_CALL getAccessibleIndexInParent (void) throw (::com::sun::star::uno::RuntimeException);
 	virtual sal_Int16 SAL_CALL getAccessibleRole (void) throw (::com::sun::star::uno::RuntimeException);
Index: svx/source/inc/svxrectctaccessiblecontext.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/svxrectctaccessiblecontext.hxx,v
retrieving revision 1.9
retrieving revision 1.9.606.1
diff -u -p -u -p -r1.9 -r1.9.606.1
--- svx/source/inc/svxrectctaccessiblecontext.hxx	22 May 2003 12:55:19 -0000	1.9
+++ svx/source/inc/svxrectctaccessiblecontext.hxx	9 Sep 2004 09:40:03 -0000	1.9.606.1
@@ -225,11 +225,11 @@ public:
 
 	//=====  XAccessibleContext  ==============================================
 
-	virtual long SAL_CALL
+	virtual sal_Int32 SAL_CALL
 		getAccessibleChildCount( void ) throw( ::com::sun::star::uno::RuntimeException );
 
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-		getAccessibleChild( long nIndex )
+		getAccessibleChild( sal_Int32 nIndex )
 			throw( ::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException );
 
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
Index: svx/source/items/flditem.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/flditem.cxx,v
retrieving revision 1.17
retrieving revision 1.17.26.1
diff -u -p -u -p -r1.17 -r1.17.26.1
--- svx/source/items/flditem.cxx	11 Jan 2005 13:01:25 -0000	1.17
+++ svx/source/items/flditem.cxx	21 Jan 2005 16:13:23 -0000	1.17.26.1
@@ -802,7 +802,7 @@ String SvxExtTimeField::GetFormatted( Ti
         break;
 	}
 
-    ULONG nFormatKey;
+    sal_uInt32 nFormatKey;
 
 	switch( eFormat )
 	{
Index: svx/source/items/paraitem.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/paraitem.cxx,v
retrieving revision 1.27
retrieving revision 1.27.664.1
diff -u -p -u -p -r1.27 -r1.27.664.1
--- svx/source/items/paraitem.cxx	4 Apr 2003 18:03:45 -0000	1.27
+++ svx/source/items/paraitem.cxx	9 Sep 2004 09:40:04 -0000	1.27.664.1
@@ -148,8 +148,8 @@ using namespace ::rtl;
 using namespace ::com::sun::star;
 
 // Konvertierung fuer UNO
-#define TWIP_TO_MM100(TWIP) 	((TWIP) >= 0 ? (((TWIP)*127L+36L)/72L) : (((TWIP)*127L-36L)/72L))
-#define MM100_TO_TWIP(MM100)	((MM100) >= 0 ? (((MM100)*72L+63L)/127L) : (((MM100)*72L-63L)/127L))
+#define TWIP_TO_MM100(TWIP) 	((TWIP) >= 0 ? (((TWIP)*127+36)/72) : (((TWIP)*127-36)/72))
+#define MM100_TO_TWIP(MM100)	((MM100) >= 0 ? (((MM100)*72+63)/127) : (((MM100)*72-63)/127))
 
 
 // STATIC DATA -----------------------------------------------------------
Index: svx/source/items/svxfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/svxfont.cxx,v
retrieving revision 1.7
retrieving revision 1.7.298.1
diff -u -p -u -p -r1.7 -r1.7.298.1
--- svx/source/items/svxfont.cxx	6 Jan 2004 15:36:05 -0000	1.7
+++ svx/source/items/svxfont.cxx	9 Sep 2004 09:40:04 -0000	1.7.298.1
@@ -503,7 +503,7 @@ Size SvxFont::GetPhysTxtSize( const Outp
 }
 
 Size SvxFont::QuickGetTextSize( const OutputDevice *pOut, const XubString &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray ) const
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray ) const
 {
 	if ( !IsCaseMap() && !IsKern() )
 		return Size( pOut->GetTextArray( rTxt, pDXArray, nIdx, nLen ),
@@ -590,7 +590,7 @@ void SvxFont::DrawText( OutputDevice *pO
 
 void SvxFont::QuickDrawText( OutputDevice *pOut,
 	const Point &rPos, const XubString &rTxt,
-	const xub_StrLen nIdx, const xub_StrLen nLen, const long* pDXArray ) const
+	const xub_StrLen nIdx, const xub_StrLen nLen, const sal_Int32* pDXArray ) const
 {
 	// Font muss ins OutputDevice selektiert sein...
 	if ( !IsCaseMap() && !IsCapital() && !IsKern() && !IsEsc() )
Index: svx/source/msfilter/msdffimp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/msfilter/msdffimp.cxx,v
retrieving revision 1.118
retrieving revision 1.97.10.5
diff -u -p -u -p -r1.118 -r1.97.10.5
--- svx/source/msfilter/msdffimp.cxx	2 Mar 2005 09:21:14 -0000	1.118
+++ svx/source/msfilter/msdffimp.cxx	10 Mar 2005 01:09:38 -0000	1.97.10.5
@@ -3448,7 +3448,7 @@ struct EscherBlipCacheEntry
         aUniqueID( rUniqueID ) {}
 };
 
-void SvxMSDffManager::Scale( long& rVal ) const
+void SvxMSDffManager::Scale( sal_Int32& rVal ) const
 {
 	if ( bNeedMap )
 		rVal = BigMulDiv( rVal, nMapMul, nMapDiv );
@@ -3522,7 +3522,7 @@ void SvxMSDffManager::Scale( XPolyPolygo
 		Scale( rPoly[ nPolyNum ] );
 }
 
-void SvxMSDffManager::ScaleEmu( long& rVal ) const
+void SvxMSDffManager::ScaleEmu( sal_Int32& rVal ) const
 {
 	rVal = BigMulDiv( rVal, nEmuMul, nEmuDiv );
 }
@@ -4803,7 +4803,7 @@ SdrObject* SvxMSDffManager::ImportShape(
 	aObjData.bChildAnchor = maShapeRecords.SeekToContent( rSt, DFF_msofbtChildAnchor, SEEK_FROM_CURRENT_AND_RESTART );
 	if ( aObjData.bChildAnchor )
 	{
-        INT32 l, o, r, u;
+        sal_Int32 l, o, r, u;
         rSt >> l >> o >> r >> u;
         Scale( l );
         Scale( o );
@@ -5408,7 +5408,7 @@ Rectangle SvxMSDffManager::GetGlobalChil
 					{
 						sal_Int16 ls, os, rs, us;
 						rSt >> os >> ls >> rs >> us; // etwas seltsame Koordinatenreihenfolge ...
-						long l = ls, o = os, r = rs, u = us;
+						sal_Int32 l = ls, o = os, r = rs, u = us;
 						Scale( l );
 						Scale( o );
 						Scale( r );
@@ -6344,9 +6344,9 @@ void SvxMSDffManager::GetCtrlData( long 
 	rStCtrl.Seek( nOffsDgg );
 
 	BYTE   nVer;
-	USHORT nInst;
-	USHORT nFbt;
-	ULONG  nLength;
+	sal_uInt16 nInst;
+	sal_uInt16 nFbt;
+	sal_uInt32 nLength;
 	if( !this->ReadCommonRecordHeader( rStCtrl, nVer, nInst, nFbt, nLength ) ) return;
 
 	BOOL bOk;
@@ -6389,9 +6389,9 @@ void SvxMSDffManager::GetCtrlData( long 
 void SvxMSDffManager::GetDrawingGroupContainerData( SvStream& rSt, ULONG nLenDgg )
 {
 	BYTE   nVer;
-	USHORT nInst;
-	USHORT nFbt;
-	ULONG  nLength;
+	sal_uInt16 nInst;
+	sal_uInt16 nFbt;
+	sal_uInt32 nLength;
 
 	ULONG nLenBStoreCont = 0, nLenFBSE = 0, nRead = 0;
 
@@ -6476,7 +6476,10 @@ void SvxMSDffManager::GetDrawingGroupCon
 //
 void SvxMSDffManager::GetDrawingContainerData( SvStream& rSt, ULONG nLenDg )
 {
-	BYTE nVer;USHORT nInst;USHORT nFbt;ULONG nLength;
+	BYTE nVer;
+	sal_uInt16 nInst;
+	sal_uInt16 nFbt;
+	sal_uInt32 nLength;
 
 	ULONG nReadDg = 0;
 
@@ -6509,7 +6512,10 @@ BOOL SvxMSDffManager::GetShapeGroupConta
 												  ULONG nLenShapeGroupCont,
 												  BOOL bPatriarch )
 {
-	BYTE nVer;USHORT nInst;USHORT nFbt;ULONG nLength;
+	BYTE nVer;
+	sal_uInt16 nInst;
+	sal_uInt16 nFbt;
+	sal_uInt32 nLength;
 	long nStartShapeGroupCont = rSt.Tell();
 	// Wir stehen in einem Shape Group Container (ggfs. mehrere pro Seite)
 	// und muessen nun
@@ -6548,7 +6554,10 @@ BOOL SvxMSDffManager::GetShapeGroupConta
 
 BOOL SvxMSDffManager::GetShapeContainerData( SvStream& rSt, ULONG nLenShapeCont, ULONG nPosGroup )
 {
-	BYTE nVer;USHORT nInst;USHORT nFbt;ULONG nLength;
+	BYTE nVer;
+	sal_uInt16 nInst;
+	sal_uInt16 nFbt;
+	sal_uInt32 nLength;
 	long  nStartShapeCont = rSt.Tell();
 	// Wir stehen in einem Shape Container (ggfs. mehrere pro Sh. Group)
 	// und muessen nun
@@ -6911,9 +6920,9 @@ BOOL SvxMSDffManager::GetBLIPDirect(SvSt
 	int nRes = GRFILTER_OPENERROR;  // Fehlervariable initialisieren
 
 	// nachschauen, ob es sich auch wirklich um ein BLIP handelt
-	ULONG  nLength;
-	USHORT nInst, nFbt;
 	BYTE   nVer;
+	sal_uInt16 nInst, nFbt;
+	sal_uInt32 nLength;
 	if( ReadCommonRecordHeader( rBLIPStream, nVer, nInst, nFbt, nLength) && ( 0xF018 <= nFbt ) && ( 0xF117 >= nFbt ) )
 	{
 		Size		aMtfSize100;
@@ -7081,9 +7090,9 @@ BOOL SvxMSDffManager::ReadCommonRecordHe
 /* auch static */
 BOOL SvxMSDffManager::ReadCommonRecordHeader( SvStream& rSt,
 											  BYTE&     rVer,
-											  USHORT&   rInst,
-											  USHORT&   rFbt,
-											  ULONG&    rLength )
+											  sal_uInt16& rInst,
+											  sal_uInt16& rFbt,
+											  sal_uInt32& rLength )
 {
 	sal_uInt16 nTmp;
 	rSt >> nTmp >> rFbt >> rLength;
Index: svx/source/outliner/outleeng.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.cxx,v
retrieving revision 1.9
retrieving revision 1.9.140.1
diff -u -p -u -p -r1.9 -r1.9.140.1
--- svx/source/outliner/outleeng.cxx	27 Apr 2004 15:49:36 -0000	1.9
+++ svx/source/outliner/outleeng.cxx	9 Sep 2004 09:40:05 -0000	1.9.140.1
@@ -173,7 +173,7 @@ XubString OutlinerEditEng::GetUndoCommen
 }
 
 // #101498#
-void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	if ( nIndex == 0 )
 	{
Index: svx/source/outliner/outleeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.hxx,v
retrieving revision 1.7
retrieving revision 1.7.140.1
diff -u -p -u -p -r1.7 -r1.7.140.1
--- svx/source/outliner/outleeng.hxx	27 Apr 2004 15:49:53 -0000	1.7
+++ svx/source/outliner/outleeng.hxx	9 Sep 2004 09:40:05 -0000	1.7.140.1
@@ -85,7 +85,7 @@ public:
 	virtual void 		ParagraphDeleted( USHORT nDeletedParagraph );
 	
 	// #101498#
-	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
+	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
 
 	virtual	void 		StyleSheetChanged( SfxStyleSheet* pStyle );
 	virtual void 		ParaAttribsChanged( USHORT nPara );
Index: svx/source/outliner/outliner.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outliner.cxx,v
retrieving revision 1.58
retrieving revision 1.56.298.2
diff -u -p -u -p -r1.58 -r1.56.298.2
--- svx/source/outliner/outliner.cxx	11 Jan 2005 13:02:09 -0000	1.58
+++ svx/source/outliner/outliner.cxx	19 Jan 2005 02:31:52 -0000	1.56.298.2
@@ -1197,14 +1197,14 @@ void Outliner::PaintBullet( USHORT nPara
 				else
 				{
 					Font aSvxFont( aBulletFont );
-					long* pBuf = new long[ pPara->GetText().Len() ];
+					sal_Int32* pBuf = new sal_Int32[ pPara->GetText().Len() ];
 					pOutDev->GetTextArray( pPara->GetText(), pBuf );
 					// aTextPos ist Bottom, jetzt die Baseline liefern:
 					FontMetric aMetric( pOutDev->GetFontMetric() );
 					aTextPos.Y() -= aMetric.GetDescent();
 
 					// #101498#
-					DrawingText( aTextPos, pPara->GetText(), 0, pPara->GetText().Len(), pBuf, aSvxFont, nPara, 0xFFFF, 0xFF);
+					DrawingText( aTextPos, pPara->GetText(), (USHORT)0, pPara->GetText().Len(), pBuf, aSvxFont, nPara, 0xFFFF, 0xFF);
 
 					delete[] pBuf;
 				}
@@ -2050,7 +2050,7 @@ void Outliner::StripPortions()
 }
 
 // #101498#
-void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	DBG_CHKTHIS(Outliner,0);
 	
Index: svx/source/svdraw/svdedtv2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdedtv2.cxx,v
retrieving revision 1.17
retrieving revision 1.17.154.1
diff -u -p -u -p -r1.17 -r1.17.154.1
--- svx/source/svdraw/svdedtv2.cxx	18 Nov 2004 11:03:53 -0000	1.17
+++ svx/source/svdraw/svdedtv2.cxx	21 Jan 2005 16:14:26 -0000	1.17.154.1
@@ -913,7 +913,7 @@ void SdrEditView::DistributeMarkedObject
 
 					// clear list
 					while(aEntryList.Count())
-						delete aEntryList.Remove((UINT32)0L);
+						delete aEntryList.Remove(0UL);
 				}
 
 				if(eVer != SvxDistributeVerticalNone)
@@ -1001,7 +1001,7 @@ void SdrEditView::DistributeMarkedObject
 
 					// clear list
 					while(aEntryList.Count())
-						delete aEntryList.Remove((UINT32)0L);
+						delete aEntryList.Remove(0UL);
 				}
 
 				// UNDO-Comment and end of UNDO
Index: svx/source/svdraw/svdfppt.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdfppt.cxx,v
retrieving revision 1.130
retrieving revision 1.122.10.3
diff -u -p -u -p -r1.130 -r1.122.10.3
--- svx/source/svdraw/svdfppt.cxx	11 Jan 2005 13:02:57 -0000	1.130
+++ svx/source/svdraw/svdfppt.cxx	19 Jan 2005 02:40:56 -0000	1.122.10.3
@@ -830,7 +830,7 @@ void SdrEscherImport::ProcessClientAncho
 {
 	INT16 ls, os, rs, us;
 	rSt >> os >> ls >> rs >> us; // etwas seltsame Koordinatenreihenfolge ...
-	long l = ls, o = os, r = rs, u = us;
+	sal_Int32 l = ls, o = os, r = rs, u = us;
 	Scale( l );
 	Scale( o );
 	Scale( r );
Index: svx/source/svdraw/svdmodel.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdmodel.cxx,v
retrieving revision 1.60
retrieving revision 1.56.8.3
diff -u -p -u -p -r1.60 -r1.56.8.3
--- svx/source/svdraw/svdmodel.cxx	3 Nov 2004 10:57:13 -0000	1.60
+++ svx/source/svdraw/svdmodel.cxx	19 Jan 2005 02:45:36 -0000	1.56.8.3
@@ -456,7 +456,7 @@ void SdrModel::ImpCtor(SfxItemPool* pPoo
 	ImpCreateTables();
 }
 
-SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, INT32 bLoadRefCounts):
+SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32)
@@ -469,7 +469,7 @@ SdrModel::SdrModel(SfxItemPool* pPool, S
 	ImpCtor(pPool,pPers,FALSE, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, INT32 bLoadRefCounts):
+SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32),
@@ -483,7 +483,7 @@ SdrModel::SdrModel(const String& rPath, 
 	ImpCtor(pPool,pPers,FALSE, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts):
+SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32)
@@ -496,7 +496,7 @@ SdrModel::SdrModel(SfxItemPool* pPool, S
 	ImpCtor(pPool,pPers,bUseExtColorTable, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts):
+SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32),
Index: svx/source/svdraw/svdoattr.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdoattr.cxx,v
retrieving revision 1.41
retrieving revision 1.39.320.3
diff -u -p -u -p -r1.41 -r1.39.320.3
--- svx/source/svdraw/svdoattr.cxx	3 Nov 2004 10:58:05 -0000	1.41
+++ svx/source/svdraw/svdoattr.cxx	19 Jan 2005 02:42:27 -0000	1.39.320.3
@@ -570,11 +570,11 @@ INT32 SdrAttrObj::ImpGetLineEndAdd() con
 	nSttWdt /= 2;
 
 	// Lieber etwas mehr, dafuer keine Wurzel ziehen
-	long nSttAdd = Max(nSttWdt, nSttHgt);
+	sal_Int32 nSttAdd = Max(nSttWdt, nSttHgt);
 	nSttAdd *= 3;
 	nSttAdd /= 2;
 
-	long nEndWdt = ((const XLineEndWidthItem&)(rSet.Get(XATTR_LINEENDWIDTH))).GetValue();
+	sal_Int32 nEndWdt = ((const XLineEndWidthItem&)(rSet.Get(XATTR_LINEENDWIDTH))).GetValue();
 
 	if(nEndWdt < 0)
 		nEndWdt = -nLineWdt * nEndWdt / 100; // <0 = relativ
Index: svx/source/svdraw/svdopath.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdopath.cxx,v
retrieving revision 1.27
retrieving revision 1.25.32.2
diff -u -p -u -p -r1.27 -r1.25.32.2
--- svx/source/svdraw/svdopath.cxx	3 Nov 2004 11:01:41 -0000	1.27
+++ svx/source/svdraw/svdopath.cxx	19 Jan 2005 02:37:29 -0000	1.25.32.2
@@ -104,6 +104,8 @@
 // #104018# replace macros above with type-safe methods
 inline sal_Int32 ImplTwipsToMM(sal_Int32 nVal) { return ((nVal * 127 + 36) / 72); }
 inline sal_Int32 ImplMMToTwips(sal_Int32 nVal) { return ((nVal * 72 + 63) / 127); }
+inline long ImplTwipsToMM(long nVal) { return ((nVal * 127 + 36) / 72); }
+inline long ImplMMToTwips(long nVal) { return ((nVal * 72 + 63) / 127); }
 inline double ImplTwipsToMM(double fVal) { return (fVal * (127.0 / 72.0)); }
 inline double ImplMMToTwips(double fVal) { return (fVal * (72.0 / 127.0)); }
 
Index: svx/source/xoutdev/_xfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/xoutdev/_xfont.cxx,v
retrieving revision 1.13
retrieving revision 1.13.298.1
diff -u -p -u -p -r1.13 -r1.13.298.1
--- svx/source/xoutdev/_xfont.cxx	6 Jan 2004 15:46:20 -0000	1.13
+++ svx/source/xoutdev/_xfont.cxx	9 Sep 2004 09:40:07 -0000	1.13.298.1
@@ -205,7 +205,7 @@ sal_Bool XOutGetTextOutlines(PolyPolyVec
 
 // #101498# Helper method ImpGetTextLength to get text length taking into account
 // hor/vertical and BIDI, especially right-to-left.
-sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, long* pDXArray, 
+sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft = pInfo->IsRTL();
@@ -236,7 +236,7 @@ sal_Int32 ImpGetTextLength(OutputDevice*
 
 // #101498# Helper method ImpDrawTextArray to draw text taking into account
 // hor/vertical and BIDI, especially right-to-left.
-void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, long* pDXArray, 
+void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft(pInfo->IsRTL());
@@ -284,7 +284,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 	sal_Bool bToLastPoint, sal_Bool bDraw, sal_Bool bIsShadow)
 {
 	Font aFont = pInfo->rFont;
-	const long* pDXArray = pInfo->pDXArray;
+	const sal_Int32* pDXArray = pInfo->pDXArray;
 	sal_Bool bUseBreakIterator(sal_False);
 
 	Reference < com::sun::star::i18n::XBreakIterator > xBreak;
@@ -366,7 +366,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		pDXArray = NULL;
 	}
 
-	nTextWidth = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, 0, pInfo->nTextLen);
+	nTextWidth = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, 0, pInfo->nTextLen);
 
 	if ( eFormTextAdjust != XFT_LEFT && nAbsStart <= 0 )
 	{
@@ -461,7 +461,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		fLen = sqrt(fDx * fDx + fDy * fDy);
 		nLen = (long) (fLen + 0.5);
 
-		nChar1Len = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nGlyphLen);
+		nChar1Len = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nGlyphLen);
 
 		double fXDist, fYDist;
 		double fCos = fDx;
@@ -516,7 +516,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						CharacterIteratorMode::SKIPCELL, 1, nDone) - (nChar + pInfo->nTextStart + nCnt);
 				}
 
-				nTextLen = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nCnt + nNextGlyphLen);
+				nTextLen = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nCnt + nNextGlyphLen);
 
 				nCnt += nNextGlyphLen;
 			}
@@ -585,7 +585,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 					else
@@ -597,7 +597,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 				}
@@ -624,7 +624,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, i);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, i);
 
 						aPolyPos.X() += (long) (fDx * nW / fLen);
 						aPolyPos.Y() += (long) (fDy * nW / fLen);
@@ -675,7 +675,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar + i, nNextGlyphLen);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar + i, nNextGlyphLen);
 
 						aPolyPos.X() -= nW / 2;
 
@@ -696,7 +696,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 							DrawXPolyPolygon(aChar);
 						else
 						{
-							ImpDrawTextArray(pOut, aPolyPos, pInfo, (long*)pDXArray, nChar + i, nNextGlyphLen);
+							ImpDrawTextArray(pOut, aPolyPos, pInfo, (sal_Int32*)pDXArray, nChar + i, nNextGlyphLen);
 						}
 					}
 
Index: dbaccess/source/ui/tabledesign/TEditControl.hxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/tabledesign/TEditControl.hxx,v
retrieving revision 1.13
retrieving revision 1.13.212.1
diff -u -p -u -p -r1.13 -r1.13.212.1
--- dbaccess/source/ui/tabledesign/TEditControl.hxx	19 Mar 2003 17:53:02 -0000	1.13
+++ dbaccess/source/ui/tabledesign/TEditControl.hxx	21 Jan 2005 15:02:50 -0000	1.13.212.1
@@ -132,7 +132,7 @@ namespace dbaui
 			OTableEditorCtrl* m_pOwner;
 
 		public:
-			ClipboardInvalidator(ULONG nTimeout,OTableEditorCtrl*);
+			ClipboardInvalidator(sal_uInt32 nTimeout,OTableEditorCtrl*);
 			~ClipboardInvalidator();
 
 		protected:
@@ -160,7 +160,7 @@ namespace dbaui
 		virtual void Undo();
 		virtual void Redo();
 		virtual String GetCellText(long nRow, USHORT nColId) const;
-		virtual ULONG GetTotalCellWidth(long nRow, USHORT nColId);
+		virtual sal_uInt32 GetTotalCellWidth(long nRow, USHORT nColId);
 
 		virtual void CopyRows();
 		virtual void InsertRows( long nRow );
? filter/source/xsltfilter/Base64.java
Index: filter/source/flash/swfwriter.hxx
===================================================================
RCS file: /cvs/framework/filter/source/flash/swfwriter.hxx,v
retrieving revision 1.5
retrieving revision 1.5.88.1
diff -u -p -u -p -r1.5 -r1.5.88.1
--- filter/source/flash/swfwriter.hxx	6 Jan 2004 16:48:59 -0000	1.5
+++ filter/source/flash/swfwriter.hxx	21 Jan 2005 16:48:50 -0000	1.5.88.1
@@ -433,8 +433,8 @@ private:
 	void Impl_writePolygon( const Polygon& rPoly, sal_Bool bFilled, const Color& rFillColor, const Color& rLineColor );
 	void Impl_writePolyPolygon( const PolyPolygon& rPolyPoly, sal_Bool bFilled, sal_uInt8 nTransparence = 0);
 	void Impl_writePolyPolygon( const PolyPolygon& rPolyPoly, sal_Bool bFilled, const Color& rFillColor, const Color& rLineColor );
-	void Impl_writeText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth );
-	void Impl_writeText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth, Color aTextColor );
+	void Impl_writeText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth );
+	void Impl_writeText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth, Color aTextColor );
 	void Impl_writeGradientEx( const PolyPolygon& rPolyPoly, const Gradient& rGradient );
 	void Impl_writeLine( const Point& rPt1, const Point& rPt2, const Color* pLineColor = NULL );
 	void Impl_writeRect( const Rectangle& rRect, long nRadX, long nRadY );
Index: filter/source/flash/swfwriter1.cxx
===================================================================
RCS file: /cvs/framework/filter/source/flash/swfwriter1.cxx,v
retrieving revision 1.15
retrieving revision 1.15.40.1
diff -u -p -u -p -r1.15 -r1.15.40.1
--- filter/source/flash/swfwriter1.cxx	21 Apr 2004 14:00:55 -0000	1.15
+++ filter/source/flash/swfwriter1.cxx	21 Jan 2005 16:49:00 -0000	1.15.40.1
@@ -469,7 +469,7 @@ FlashFont& Writer::Impl_getFont( const F
 
 // -----------------------------------------------------------------------------
 
-void Writer::Impl_writeText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth )
+void Writer::Impl_writeText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth )
 {
 	const FontMetric aMetric( mpVDev->GetFontMetric() );
 
@@ -557,26 +557,26 @@ void Writer::Impl_writeText( const Point
 	}
 }
 
-void Writer::Impl_writeText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth, Color aTextColor )
+void Writer::Impl_writeText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth, Color aTextColor )
 {
 	sal_uInt32 nLen = rText.Len();
 
 	if( nLen )
 	{
 		Size	aNormSize;
-		long*	pOwnArray;
-		long*	pDX;
+		sal_Int32* pOwnArray;
+		sal_Int32* pDX;
 
 		// get text sizes
 		if( pDXArray )
 		{
 			pOwnArray = NULL;
 			aNormSize = Size( mpVDev->GetTextWidth( rText ), 0 );
-			pDX = (long*) pDXArray;
+			pDX = (sal_Int32*) pDXArray;
 		}
 		else
 		{	
-			pOwnArray = new long[ nLen ];
+			pOwnArray = new sal_Int32[ nLen ];
 			aNormSize = Size( mpVDev->GetTextArray( rText, pOwnArray ), 0 );
 			pDX = pOwnArray;
 		}
@@ -872,7 +872,7 @@ sal_uInt16 Writer::defineBitmap( const B
 
 	getBitmapData( bmpSource, pImageData, pAlphaData, width, height );
 	sal_uInt32 raw_size = width * height * 4;
-	sal_uInt32 compressed_size = raw_size + (sal_uInt32)(raw_size/100) + 12;
+	uLongf compressed_size = uLongf( raw_size + (sal_uInt32)(raw_size/100) + 12 );
 	sal_uInt8 *pCompressed = new sal_uInt8[ compressed_size ];
 	
 	if(compress2(pCompressed, &compressed_size, pImageData, raw_size, Z_BEST_COMPRESSION) != Z_OK)
@@ -880,11 +880,11 @@ sal_uInt16 Writer::defineBitmap( const B
 
 	// AS: SWF files let you provide an Alpha mask for JPEG images, but we have 
 	//  to ZLIB compress the alpha channel seperately.
-	sal_uInt32 alpha_compressed_size = 0;
+	uLongf alpha_compressed_size = 0;
 	sal_uInt8 *pAlphaCompressed = NULL;
 	if (bmpSource.IsAlpha() || bmpSource.IsTransparent())
 	{
-		alpha_compressed_size = width * height + (sal_uInt32)(raw_size/100) + 12;
+		alpha_compressed_size = uLongf( width * height + (sal_uInt32)(raw_size/100) + 12 );
 		pAlphaCompressed = new sal_uInt8[ compressed_size ];
 		
 		if(compress2(pAlphaCompressed, &alpha_compressed_size, pAlphaData, width * height, Z_BEST_COMPRESSION) != Z_OK)
Index: filter/source/pdf/pdfexport.cxx
===================================================================
RCS file: /cvs/framework/filter/source/pdf/pdfexport.cxx,v
retrieving revision 1.34
retrieving revision 1.34.12.1
diff -u -p -u -p -r1.34 -r1.34.12.1
--- filter/source/pdf/pdfexport.cxx	7 Jan 2005 09:20:01 -0000	1.34
+++ filter/source/pdf/pdfexport.cxx	21 Jan 2005 16:49:12 -0000	1.34.12.1
@@ -488,7 +488,7 @@ sal_Bool PDFExport::ImplWriteActions( PD
 {
     bool bAssertionFired( false );
 
-	for( ULONG i = 0, nCount = rMtf.GetActionCount(); i < nCount; )
+	for( sal_uInt32 i = 0, nCount = rMtf.GetActionCount(); i < nCount; )
 	{
 		if ( !pPDFExtOutDevData || !pPDFExtOutDevData->PlaySyncPageAct( rWriter, i ) )
 		{
Index: filter/source/svg/svgfilter.hxx
===================================================================
RCS file: /cvs/framework/filter/source/svg/svgfilter.hxx,v
retrieving revision 1.9
retrieving revision 1.8.38.2
diff -u -p -u -p -r1.9 -r1.8.38.2
--- filter/source/svg/svgfilter.hxx	21 Jan 2005 15:25:45 -0000	1.9
+++ filter/source/svg/svgfilter.hxx	9 Mar 2005 19:51:27 -0000	1.8.38.2
@@ -203,7 +203,7 @@ protected:
 	virtual void			_ExportAutoStyles() {}
 	virtual void			_ExportContent() {}
 	virtual void			_ExportMasterStyles() {}
-	virtual ULONG			exportDoc( enum ::xmloff::token::XMLTokenEnum eClass ) { return 0; }
+	virtual sal_uInt32		exportDoc( enum ::xmloff::token::XMLTokenEnum eClass ) { return 0; }
 							
 public:						
 							
Index: filter/source/svg/svgwriter.cxx
===================================================================
RCS file: /cvs/framework/filter/source/svg/svgwriter.cxx,v
retrieving revision 1.4
retrieving revision 1.3.88.2
diff -u -p -u -p -r1.4 -r1.3.88.2
--- filter/source/svg/svgwriter.cxx	21 Jan 2005 15:26:19 -0000	1.4
+++ filter/source/svg/svgwriter.cxx	9 Mar 2005 19:50:24 -0000	1.3.88.2
@@ -724,7 +724,7 @@ void SVGActionWriter::ImplWriteGradientE
 // -----------------------------------------------------------------------------
 
 void SVGActionWriter::ImplWriteText( const Point& rPos, const String& rText, 
-									 const long* pDXArray, long nWidth,
+									 const sal_Int32* pDXArray, long nWidth,
 									 const NMSP_RTL::OUString* pStyle )
 {
 	long nLen = rText.Len(), i;
@@ -732,19 +732,19 @@ void SVGActionWriter::ImplWriteText( con
 	if( nLen )
 	{
 		Size	aNormSize;
-		long*	pOwnArray;
-		long*	pDX;
+		sal_Int32*	pOwnArray;
+		sal_Int32*	pDX;
 
 		// get text sizes
 		if( pDXArray )
 		{
 			pOwnArray = NULL;
 			aNormSize = Size( mpVDev->GetTextWidth( rText ), 0 );
-			pDX = (long*) pDXArray;
+			pDX = (sal_Int32*) pDXArray;
 		}
 		else
 		{	
-			pOwnArray = new long[ nLen ];
+			pOwnArray = new sal_Int32[ nLen ];
 			aNormSize = Size( mpVDev->GetTextArray( rText, pOwnArray ), 0 );
 			pDX = pOwnArray;
 		}
Index: filter/source/svg/svgwriter.hxx
===================================================================
RCS file: /cvs/framework/filter/source/svg/svgwriter.hxx,v
retrieving revision 1.3
retrieving revision 1.2.90.2
diff -u -p -u -p -r1.3 -r1.2.90.2
--- filter/source/svg/svgwriter.hxx	21 Jan 2005 15:26:33 -0000	1.3
+++ filter/source/svg/svgwriter.hxx	9 Mar 2005 19:50:55 -0000	1.2.90.2
@@ -248,7 +248,7 @@ private:
 	void					ImplWriteEllipse( const Point& rCenter, long nRadX, long nRadY, const ::rtl::OUString* pStyle = NULL );
 	void					ImplWritePolyPolygon( const PolyPolygon& rPolyPoly, sal_Bool bLineOnly, const ::rtl::OUString* pStyle = NULL );
 	void					ImplWriteGradientEx( const PolyPolygon& rPolyPoly, const Gradient& rGradient, const ::rtl::OUString* pStyle, sal_uInt32 nWriteFlags );
-	void					ImplWriteText( const Point& rPos, const String& rText, const long* pDXArray, long nWidth, const ::rtl::OUString* pStyle = NULL );
+	void					ImplWriteText( const Point& rPos, const String& rText, const sal_Int32* pDXArray, long nWidth, const ::rtl::OUString* pStyle = NULL );
 	void					ImplWriteBmp( const BitmapEx& rBmpEx, const Point& rPt, const Size& rSz, const Point& rSrcPt, const Size& rSrcSz, const ::rtl::OUString* pStyle = NULL );
 
 	void					ImplCheckFontAttributes();
Index: starmath/inc/document.hxx
===================================================================
RCS file: /cvs/sw/starmath/inc/document.hxx,v
retrieving revision 1.21
retrieving revision 1.21.2.1
diff -u -p -u -p -r1.21 -r1.21.2.1
--- starmath/inc/document.hxx	11 Jan 2005 13:08:12 -0000	1.21
+++ starmath/inc/document.hxx	21 Jan 2005 15:57:12 -0000	1.21.2.1
@@ -185,7 +185,7 @@ class SmDocShell : public SfxObjectShell
 							 USHORT nAspect = ASPECT_CONTENT);
 
 	virtual void		FillClass(SvGlobalName* pClassName,
-								  ULONG*  pFormat,
+								  sal_uInt32*  pFormat,
 								  String* pAppName,
 								  String* pFullTypeName,
                                   String* pShortTypeName,
Index: starmath/source/accessibility.cxx
===================================================================
RCS file: /cvs/sw/starmath/source/accessibility.cxx,v
retrieving revision 1.26
retrieving revision 1.26.80.1
diff -u -p -u -p -r1.26 -r1.26.80.1
--- starmath/source/accessibility.cxx	7 Nov 2003 15:21:58 -0000	1.26
+++ starmath/source/accessibility.cxx	10 Sep 2004 13:53:27 -0000	1.26.80.1
@@ -638,7 +638,7 @@ awt::Rectangle SAL_CALL SmGraphicAccessi
                 aTLPos.X() -= 0;
                 Size  aSize (pNode->GetSize());
 
-                long *pXAry = new long[ aNodeText.Len() ];
+                sal_Int32 *pXAry = new sal_Int32[ aNodeText.Len() ];
                 pWin->SetFont( pNode->GetFont() );
                 pWin->GetTextArray( aNodeText, pXAry, 0, aNodeText.Len() );
                 aTLPos.X()    += nNodeIndex > 0 ? pXAry[nNodeIndex - 1] : 0;
@@ -721,7 +721,7 @@ sal_Int32 SAL_CALL SmGraphicAccessible::
 
                 long nNodeX = pNode->GetLeft();
 
-                long *pXAry = new long[ aTxt.Len() ];
+                sal_Int32 *pXAry = new sal_Int32[ aTxt.Len() ];
                 pWin->SetFont( pNode->GetFont() );
                 pWin->GetTextArray( aTxt, pXAry, 0, aTxt.Len() );
                 for (sal_Int32 i = 0;  i < aTxt.Len()  &&  nRes == -1;  ++i)
Index: starmath/source/document.cxx
===================================================================
RCS file: /cvs/sw/starmath/source/document.cxx,v
retrieving revision 1.73
retrieving revision 1.71.2.2
diff -u -p -u -p -r1.73 -r1.71.2.2
--- starmath/source/document.cxx	16 Feb 2005 17:58:16 -0000	1.73
+++ starmath/source/document.cxx	9 Mar 2005 23:04:29 -0000	1.71.2.2
@@ -1992,7 +1992,7 @@ void SmDocShell::UIActivate (BOOL bActiv
 }
 
 void SmDocShell::FillClass(SvGlobalName* pClassName,
-						   ULONG*  pFormat,
+						   sal_uInt32*  pFormat,
 						   String* pAppName,
 						   String* pFullTypeName,
                            String* pShortTypeName,
Index: starmath/source/parse.cxx
===================================================================
RCS file: /cvs/sw/starmath/source/parse.cxx,v
retrieving revision 1.27
retrieving revision 1.26.58.2
diff -u -p -u -p -r1.27 -r1.26.58.2
--- starmath/source/parse.cxx	11 Aug 2004 15:08:01 -0000	1.27
+++ starmath/source/parse.cxx	14 Oct 2004 02:21:56 -0000	1.26.58.2
@@ -620,7 +620,7 @@ void SmParser::NextToken()
 	}
 	else if (aRes.TokenType & KParseType::BOOLEAN)
 	{
-		long   &rnEndPos = aRes.EndPos;
+		sal_Int32   &rnEndPos = aRes.EndPos;
 		String	aName( BufferString.Copy( nRealStart, rnEndPos - nRealStart ) );
 		if (2 >= aName.Len())
 		{
@@ -724,7 +724,7 @@ void SmParser::NextToken()
 	}
 	else if (aRes.TokenType & KParseType::ONE_SINGLE_CHAR)
 	{
-		long   &rnEndPos = aRes.EndPos;
+		sal_Int32   &rnEndPos = aRes.EndPos;
 		String	aName( BufferString.Copy( nRealStart, rnEndPos - nRealStart ) );
 
 		if (1 == aName.Len())
Index: solenv/inc/_tg_shl.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/_tg_shl.mk,v
retrieving revision 1.86
retrieving revision 1.77.56.4
diff -u -p -u -p -r1.86 -r1.77.56.4
--- solenv/inc/_tg_shl.mk	10 Dec 2004 18:03:08 -0000	1.86
+++ solenv/inc/_tg_shl.mk	18 Jan 2005 10:04:59 -0000	1.77.56.4
@@ -332,6 +332,30 @@ $(SHL1TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL1TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -732,6 +756,30 @@ $(SHL2TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL2TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -1132,6 +1180,30 @@ $(SHL3TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL3TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -1532,6 +1604,30 @@ $(SHL4TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL4TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -1932,6 +2028,30 @@ $(SHL5TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL5TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -2332,6 +2452,30 @@ $(SHL6TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL6TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -2732,6 +2876,30 @@ $(SHL7TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL7TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -3132,6 +3300,30 @@ $(SHL8TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL8TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -3532,6 +3724,30 @@ $(SHL9TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL9TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
@@ -3932,6 +4148,30 @@ $(SHL10TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL10TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
Index: solenv/inc/tg_shl.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/tg_shl.mk,v
retrieving revision 1.88
retrieving revision 1.79.56.4
diff -u -p -u -p -r1.88 -r1.79.56.4
--- solenv/inc/tg_shl.mk	10 Dec 2004 18:04:24 -0000	1.88
+++ solenv/inc/tg_shl.mk	18 Jan 2005 10:03:54 -0000	1.79.56.4
@@ -432,6 +432,30 @@ $(SHL$(TNR)TARGETN) : \
 .ENDIF			# "$(linkinc)"==""
 .ENDIF			# "$(GUI)" == "WNT"
 .IF "$(GUI)"=="UNX"
+.IF "$(UPDATER)"=="YES"
+.IF "$(OS)"=="SOLARIS"
+.IF "$(COM)"=="GCC"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE		
+.IF "$(CPU)"=="S64B"
+		$(CC) -c -KPIC -xarch=v9 -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ELSE
+		$(CC) -c -KPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.ENDIF		
+.ENDIF
+.IF "$(OS)"=="MACOSX"
+		$(CC) -c -dynamic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="LINUX" || "$(OS)"=="NETBSD" || "$(OS)"=="FREEBSD"
+		$(CC) -c -fPIC -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+.ENDIF
+.IF "$(OS)"=="IRIX"
+		$(CC) -c -fpic -o $(SLO)$/{$(subst,$(UPD)$(DLLPOSTFIX),_dflt $(SHL$(TNR)TARGET))}_version.o -DUNX $(ENVCDEFS) -I$(INCCOM) $(SOLARENV)$/src$/version.c
+		@+if ( ! -e $(SOLARLIBDIR) ) mkdir $(SOLARLIBDIR)
+		@+if ( ! -e $(SOLARLIBDIR)/so_locations ) touch $(SOLARLIBDIR)/so_locations
+.ENDIF			# "$(OS)"=="IRIX"
+.ENDIF
 .IF "$(OS)"=="MACOSX"
 	@+-$(RM) $(MISC)$/$(@:b).list
 	@+-$(RM) $(MISC)$/$(@:b).cmd
Index: solenv/inc/unx.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/unx.mk,v
retrieving revision 1.27
retrieving revision 1.23.96.5
diff -u -p -u -p -r1.27 -r1.23.96.5
--- solenv/inc/unx.mk	18 Jan 2005 14:50:42 -0000	1.27
+++ solenv/inc/unx.mk	9 Mar 2005 22:56:44 -0000	1.23.96.5
@@ -96,6 +96,10 @@ OLE2DEF=
 .INCLUDE : unxsols4.mk
 .ENDIF
 
+.IF "$(OS)$(CPU)$(COMEX)" == "SOLARISS64B1"
+.INCLUDE : unxsols64b1.mk
+.ENDIF
+
 .IF "$(OS)$(CPU)$(COMEX)" == "SOLARISI4"
 .INCLUDE : unxsoli4.mk
 .ENDIF
Index: solenv/inc/unxlngx4.mk
===================================================================
RCS file: /cvs/tools/solenv/inc/unxlngx4.mk,v
retrieving revision 1.6
retrieving revision 1.5.24.4
diff -u -p -u -p -r1.6 -r1.5.24.4
--- solenv/inc/unxlngx4.mk	11 Feb 2005 15:30:40 -0000	1.6
+++ solenv/inc/unxlngx4.mk	12 Mar 2005 10:02:24 -0000	1.5.24.4
@@ -74,6 +74,11 @@ JAVAFLAGSDEBUG=-g
 # _PTHREADS is needed for the stl
 CDEFS+=-DGLIBC=2 -DX86_64 -D_PTHREADS -D_REENTRANT -DNEW_SOLAR -D_USE_NAMESPACE=1 -DSTLPORT_VERSION=400
 
+# enable visibility define in "sal/types.h"
+.IF "$(HAVE_GCC_VISIBILITY_FEATURE)" == "TRUE"
+CDEFS += -DHAVE_GCC_VISIBILITY_FEATURE
+.ENDIF # "$(HAVE_GCC_VISIBILITY_FEATURE)" == "TRUE"
+
 # this is a platform with JAVA support
 .IF "$(SOLAR_JAVA)"!=""
 JAVADEF=-DSOLAR_JAVA
@@ -108,6 +113,10 @@ CFLAGS_NO_EXCEPTIONS=-fno-exceptions
 CFLAGSCXX= -pipe -fno-use-cxa-atexit
 CFLAGSCXX+= -Wno-ctor-dtor-privacy
 
+.IF "$(HAVE_GCC_VISIBILITY_FEATURE)" == "TRUE"
+CFLAGSCXX += -fvisibility-inlines-hidden
+.ENDIF # "$(HAVE_GCC_VISIBILITY_FEATURE)" == "TRUE"
+
 # HACK: enable Hamburg developers to build on glibc-2.2 machines but compile vs. glibc-2.1 headers
 .IF "$(BUILD_SPECIAL)"==""
 CFLAGSCXX+=-include preinclude.h
@@ -147,7 +156,7 @@ STATIC		= -Wl,-Bstatic
 DYNAMIC		= -Wl,-Bdynamic
 
 # name of linker
-LINK*=$(CC)
+LINK*=$(CXX)
 
 # default linker flags
 LINKFLAGSDEFS*=-z defs
@@ -179,6 +188,7 @@ SONAME_SWITCH=-Wl,-h
 STDLIBCPP=-lstdc++
 
 # default objectfilenames to link
+STDOBJVCL=$(L)$/salmain.o
 STDOBJGUI=
 STDSLOGUI=
 STDOBJCUI=
Index: solenv/inc/unxsols64b1.mk
===================================================================
RCS file: solenv/inc/unxsols64b1.mk
diff -N solenv/inc/unxsols64b1.mk
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ solenv/inc/unxsols64b1.mk	26 Aug 2004 09:48:36 -0000	1.1.2.2
@@ -0,0 +1,213 @@
+#*************************************************************************
+#
+#   $RCSfile$
+#
+#   $Revision$
+#
+#   last change: $Author$ $Date$
+#
+#   The Contents of this file are made available subject to the terms of
+#   either of the following licenses
+#
+#          - GNU Lesser General Public License Version 2.1
+#          - Sun Industry Standards Source License Version 1.1
+#
+#   Sun Microsystems Inc., October, 2000
+#
+#   GNU Lesser General Public License Version 2.1
+#   =============================================
+#   Copyright 2000 by Sun Microsystems, Inc.
+#   901 San Antonio Road, Palo Alto, CA 94303, USA
+#
+#   This library is free software; you can redistribute it and/or
+#   modify it under the terms of the GNU Lesser General Public
+#   License version 2.1, as published by the Free Software Foundation.
+#
+#   This library is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+#   Lesser General Public License for more details.
+#
+#   You should have received a copy of the GNU Lesser General Public
+#   License along with this library; if not, write to the Free Software
+#   Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+#   MA  02111-1307  USA
+#
+#
+#   Sun Industry Standards Source License Version 1.1
+#   =================================================
+#   The contents of this file are subject to the Sun Industry Standards
+#   Source License Version 1.1 (the "License"); You may not use this file
+#   except in compliance with the License. You may obtain a copy of the
+#   License at http://www.openoffice.org/license.html.
+#
+#   Software provided under this License is provided on an "AS IS" basis,
+#   WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+#   WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+#   MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+#   See the License for the specific provisions governing your rights and
+#   obligations concerning the Software.
+#
+#   The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+#
+#   Copyright: 2000 by Sun Microsystems, Inc.
+#
+#   All Rights Reserved.
+#
+#   Contributor(s): _______________________________________
+#
+#
+#
+#*************************************************************************
+
+
+ASM=/usr/ccs/bin/as
+AFLAGS=-P -xarch=v9
+
+
+CDEFS+=-D_PTHREADS -DSYSV -DSUN -DSUN4 -D_REENTRANT -D_POSIX_PTHREAD_SEMANTICS -DSTLPORT_VERSION=400
+
+SOLAR_JAVA*=TRUE
+.IF "$(SOLAR_JAVA)"!=""
+JAVADEF=-DSOLAR_JAVA
+JAVAFLAGSDEBUG=-g
+.IF "$(debug)"==""
+JAVA_RUNTIME=-ljava
+.ELSE
+JAVA_RUNTIME=-ljava_g
+.ENDIF
+.ENDIF
+
+CXX*=CC
+CC*=cc
+
+CFLAGS=$(PREENVCFLAGS) -c -temp=/tmp $(INCLUDE) -xarch=v9 
+CFLAGSCC=-xCC
+CFLAGSCXX=-features=no%altspell -library=no%Cstd -xport64
+
+# flags to enable build with symbols; required for crashdump feature
+CFLAGSENABLESYMBOLS=-g0 -xs
+
+CFLAGSEXCEPTIONS=
+CFLAGS_NO_EXCEPTIONS=-noex
+
+CFLAGSOBJGUIST=-KPIC
+CFLAGSOBJCUIST=-KPIC
+CFLAGSOBJGUIMT=-KPIC -mt
+CFLAGSOBJCUIMT=-KPIC -mt
+CFLAGSSLOGUIMT=-KPIC -mt
+CFLAGSSLOCUIMT=-KPIC -mt
+CFLAGSPROF=-xpg
+CFLAGSDEBUG=-g
+CFLAGSDBGUTIL=
+CFLAGSOPT=-xO3 -xspace
+CFLAGSNOOPT=
+CFLAGSOUTOBJ=-o
+
+# Enable all warnings
+CFLAGSWALL=+w2
+# Set default warn level
+CFLAGSDFLTWARN=
+
+STDOBJVCL=$(L)$/salmain.o
+
+THREADLIB=
+.IF "$(PURIFY)"!=""
+LINK=/usr/local/purify-4.2-solaris2/purify CC
+.ELSE
+LINK=CC
+.ENDIF
+
+# -z combreloc combines multiple relocation sections. Reduces overhead on startup
+# -norunpath prevents the compiler from recording his own libs in the runpath
+LINKFLAGSRUNPATH*=-R\''$$ORIGIN'\'
+LINKFLAGS=-w -mt -xarch=v9 -z combreloc -PIC -temp=/tmp $(LINKFLAGSRUNPATH) -norunpath -library=no%Cstd
+
+# -z text force fatal error if non PIC code is linked into shared library. Such code 
+#    would be expensive on startup
+CHECKFORPIC =-z text
+LINKFLAGSSHLGUI=$(CHECKFORPIC) -G
+LINKFLAGSSHLCUI=$(CHECKFORPIC) -G
+
+# switches for dynamic and static linking
+LINKFLAGSDEFS*= -z defs
+STATIC		= -Bstatic
+DIRECT		= -Bdirect $(LINKFLAGSDEFS)
+DYNAMIC		= -Bdynamic
+
+LINKFLAGSAPPGUI+=$(DIRECT)
+LINKFLAGSAPPCUI+=$(DIRECT)
+LINKFLAGSSHLGUI+=$(DIRECT)
+LINKFLAGSSHLCUI+=$(DIRECT)
+
+LINKFLAGSTACK=
+LINKFLAGSPROF=-L$(COMPATH)/WS6U1/lib/libp -xpg -z allextract
+LINKFLAGSDEBUG=
+LINKFLAGSOPT=
+LINKVERSIONMAPFLAG=-M
+
+APPLINKSTATIC=$(STATIC)
+APPLINKSHARED=$(DIRECT)
+APP_LINKTYPE=
+
+# reihenfolge der libs NICHT egal!
+STDOBJGUI=
+.IF "DBG_UTIL" != ""
+STDSLOGUI=#-lpthread
+.ELSE
+STDSLOGUI=
+.ENDIF
+STDOBJCUI=
+STDSLOCUI=
+
+STDLIBGUIST=$(DYNAMIC) -lm
+STDLIBCUIST=$(DYNAMIC) -lm
+STDLIBGUIMT=$(DYNAMIC) -lpthread -lm
+STDLIBCUIMT=$(DYNAMIC) -lpthread -lm
+STDSHLGUIST=$(DYNAMIC) -lCrun -lm -lc
+STDSHLCUIST=$(DYNAMIC) -lCrun -lm -lc
+STDSHLGUIMT=$(DYNAMIC) -lpthread -lCrun -lm -lc
+STDSHLCUIMT=$(DYNAMIC) -lpthread -lCrun -lm -lc
+
+STDLIBGUIST+=-lX11
+STDLIBGUIMT+=-lX11
+STDSHLGUIST+=-lX11
+STDSHLGUIMT+=-lX11
+
+# @@@ interposer needed for -Bdirect @@@
+# LIBSALCPPRT*=-z allextract -lsalcpprt -z defaultextract
+LIBSALCPPRT=
+
+LIBSTLPORT=$(DYNAMIC) -lstlport_sunpro
+LIBSTLPORTST=$(STATIC) -lstlport_sunpro $(DYNAMIC)
+
+
+LIBMGR=CC
+LIBFLAGS=-xar -o 
+
+IMPLIB=
+IMPLIBFLAGS=
+
+MAPSYM=
+MAPSYMFLAGS=
+
+RC=irc
+RCFLAGS=-fo$@ $(RCFILES)
+RCLINK=
+RCLINKFLAGS=
+RCSETVERSION=
+
+DLLPOSTFIX=ss64b
+
+DLLPRE=lib
+DLLPOST=.so
+
+LDUMP=cppfilt /b /n /o /p
+
+CFLAGSCXXSLO +=
+CFLAGSCXXOBJ +=
+
+LINKFLAGSAPPGUI+=
+LINKFLAGSSHLGUI+=
+LINKFLAGSAPPCUI+=
+LINKFLAGSSHLCUI+=
Index: idlc/source/idlccompile.cxx
===================================================================
RCS file: /cvs/udk/idlc/source/idlccompile.cxx,v
retrieving revision 1.16
retrieving revision 1.15.4.2
diff -u -p -u -p -r1.16 -r1.15.4.2
--- idlc/source/idlccompile.cxx	31 Jan 2005 15:46:22 -0000	1.16
+++ idlc/source/idlccompile.cxx	9 Mar 2005 20:19:31 -0000	1.15.4.2
@@ -94,6 +94,8 @@
 #endif
 #endif
 
+#include <strings.h>
+
 using namespace ::rtl;
 using namespace ::osl;
 
Index: idlc/source/idlcproduce.cxx
===================================================================
RCS file: /cvs/udk/idlc/source/idlcproduce.cxx,v
retrieving revision 1.10
retrieving revision 1.10.6.1
diff -u -p -u -p -r1.10 -r1.10.6.1
--- idlc/source/idlcproduce.cxx	18 May 2004 13:41:10 -0000	1.10
+++ idlc/source/idlcproduce.cxx	19 Aug 2004 11:55:25 -0000	1.10.6.1
@@ -89,6 +89,8 @@
 #include <errno.h>
 #endif
 
+#include <strings.h>
+
 using namespace ::rtl;
 using namespace ::osl;
 
Index: vos/inc/vos/object.hxx
===================================================================
RCS file: /cvs/udk/vos/inc/vos/object.hxx,v
retrieving revision 1.2
retrieving revision 1.2.130.1
diff -u -p -u -p -r1.2 -r1.2.130.1
--- vos/inc/vos/object.hxx	16 Feb 2001 00:55:17 -0000	1.2
+++ vos/inc/vos/object.hxx	10 Sep 2004 13:48:40 -0000	1.2.130.1
@@ -110,13 +110,8 @@ public:
 	/** Define private new and delete operator because of compiler bug, 
 		when allocating and deleteing a exported class
 	*/
-#if defined MACOS || defined MACOSX || defined NETBSD
 	void* SAL_CALL operator new(size_t size);
 	void* SAL_CALL operator new(size_t size, void* p);
-#else
-	void* SAL_CALL operator new(unsigned int size);
-	void* SAL_CALL operator new(unsigned int size, void* p);
-#endif
 
 	void  SAL_CALL operator delete(void* p);
 
Index: vos/source/object.cxx
===================================================================
RCS file: /cvs/udk/vos/source/object.cxx,v
retrieving revision 1.3
retrieving revision 1.3.114.1
diff -u -p -u -p -r1.3 -r1.3.114.1
--- vos/source/object.cxx	26 Sep 2001 16:46:34 -0000	1.3
+++ vos/source/object.cxx	10 Sep 2004 13:58:50 -0000	1.3.114.1
@@ -95,11 +95,7 @@ OObject::~OObject()
 {
 }
 
-#if defined MACOS || defined MACOSX
 void* OObject::operator new(size_t size)
-#else
-void* OObject::operator new(unsigned int size)
-#endif
 {
    void* p = rtl_allocateMemory(size);
 
@@ -108,11 +104,7 @@ void* OObject::operator new(unsigned int
    return (p);
 }
 
-#if defined MACOS || defined MACOSX
 void* OObject::operator new(size_t size, void* p)
-#else
-void* OObject::operator new(unsigned int size, void* p)
-#endif
 {
    return (p);
 }
@@ -213,8 +205,3 @@ VOS_CLASSINIT::VOS_CLASSINIT(register OC
 
 	pClassRoot->m_pNextClass = pNewClass;
 }
-
-
-
-
-
Index: stlport/makefile.mk
===================================================================
RCS file: /cvs/external/stlport/makefile.mk,v
retrieving revision 1.29
retrieving revision 1.26.18.4
diff -u -p -u -p -r1.29 -r1.26.18.4
--- stlport/makefile.mk	24 Feb 2005 14:47:13 -0000	1.29
+++ stlport/makefile.mk	9 Mar 2005 23:04:45 -0000	1.26.18.4
@@ -159,14 +159,19 @@ BUILD_FLAGS=-f vc7.mak
 
 .IF "$(COM)"=="C52"
 BUILD_ACTION=make
+.IF "$(CPU)"=="S64B"
+TARFILE_NAME=STLport-4.5.3
+PATCH_FILE_NAME=STLport-4.5.3.patch
+BUILD_FLAGS=-f sunpro-64.mak
+.ELSE
 .IF "$(CCNUMVER)">="00050005"
 BUILD_FLAGS=-f sunpro8.mak
 .ELSE
 BUILD_FLAGS=-f sunpro6.mak
 .ENDIF # "$(CCNUMVER)">="00050005"
-
 OUT2INC= \
     stlport$/SC5$/*.SUNWCCh
+.ENDIF # "$(CPU)"=="S64B"
 .ENDIF
 
 .IF "$(OS)"=="IRIX"
Index: rdbmaker/source/codemaker/global.cxx
===================================================================
RCS file: /cvs/udk/rdbmaker/source/codemaker/global.cxx,v
retrieving revision 1.9
retrieving revision 1.9.66.1
diff -u -p -u -p -r1.9 -r1.9.66.1
--- rdbmaker/source/codemaker/global.cxx	26 Mar 2003 14:28:43 -0000	1.9
+++ rdbmaker/source/codemaker/global.cxx	27 Aug 2004 14:21:41 -0000	1.9.66.1
@@ -75,6 +75,7 @@
 #include    <osl/file.hxx>
 #endif
 
+#include <string.h>
 #include <stdlib.h>
 #include <stdio.h>
 #if defined(SAL_W32) || defined(SAL_OS2)
@@ -287,8 +288,8 @@ sal_Bool checkFileContent(const OString&
 		sal_Bool 	bFindChanges = sal_False;
 		sal_Char 	buffer1[1024+1];
 		sal_Char 	buffer2[1024+1];
-		sal_Int32 	n1 = 0;
-		sal_Int32 	n2 = 0;
+		size_t 	    n1 = 0;
+		size_t 	    n2 = 0;
 
 		while ( !bFindChanges && !feof(target) && !feof(tmp))
 		{
@@ -420,8 +421,8 @@ void FileStream::close()
 
 sal_Int32 FileStream::getSize()
 {
-    sal_Int32 pos = 0;
-    sal_Int32 size = 0;
+    long pos = 0;
+    long size = 0;
     if ( isValid() )
     {
         fflush(m_pFile);
@@ -430,7 +431,7 @@ sal_Int32 FileStream::getSize()
             size = ftell(m_pFile);
         fseek(m_pFile, pos, SEEK_SET);
     }
-    return size;
+    return sal_Int32(size);
 }
 
 const sal_Char* FileStream::checkAccessMode(FileAccessMode mode)
Index: rdbmaker/source/rdbmaker/rdboptions.cxx
===================================================================
RCS file: /cvs/udk/rdbmaker/source/rdbmaker/rdboptions.cxx,v
retrieving revision 1.4
retrieving revision 1.4.62.1
diff -u -p -u -p -r1.4 -r1.4.62.1
--- rdbmaker/source/rdbmaker/rdboptions.cxx	17 Apr 2003 10:24:04 -0000	1.4
+++ rdbmaker/source/rdbmaker/rdboptions.cxx	27 Aug 2004 14:21:42 -0000	1.4.62.1
@@ -59,6 +59,7 @@
  *
  ************************************************************************/
 #include 	<stdio.h>
+#include <string.h>
 
 #include	"rdboptions.hxx"
 
cvs diff: cannot open CVS/Entries for reading: No such file or directory
cvs [diff aborted]: no repository
? sal/rtl/source/guard.c
Index: sal/cpprt/operators_new_delete.cxx
===================================================================
RCS file: /cvs/porting/sal/cpprt/operators_new_delete.cxx,v
retrieving revision 1.3
retrieving revision 1.3.206.1
diff -u -p -u -p -r1.3 -r1.3.206.1
--- sal/cpprt/operators_new_delete.cxx	15 Apr 2003 17:40:45 -0000	1.3
+++ sal/cpprt/operators_new_delete.cxx	25 Aug 2004 16:46:45 -0000	1.3.206.1
@@ -180,7 +180,7 @@ static void* allocate (
 	n = rTraits.size (n);
 	for (;;)
 	{
-		void * p = rtl_allocateMemory (sal_uInt32(n));
+		void * p = rtl_allocateMemory (sal_Size(n));
 		if (p != 0)
 			return rTraits.init (p);
 
Index: sal/inc/sal/types.h
===================================================================
RCS file: /cvs/porting/sal/inc/sal/types.h,v
retrieving revision 1.25
retrieving revision 1.23.4.6
diff -u -p -u -p -r1.25 -r1.23.4.6
--- sal/inc/sal/types.h	27 Oct 2004 15:21:17 -0000	1.25
+++ sal/inc/sal/types.h	18 Jan 2005 19:57:05 -0000	1.23.4.6
@@ -121,7 +121,15 @@ typedef unsigned char       sal_uInt8;
 	#define SAL_CONST_INT64(x)       x##i64
 	#define SAL_CONST_UINT64(x)      x##ui64
 #elif defined(__SUNPRO_CC) || defined(__SUNPRO_C) || defined (__GNUC__) || defined(__hpux) || defined (sgi)
-	#if SAL_TYPES_SIZEOFLONGLONG == 8
+	#if SAL_TYPES_SIZEOFLONG == 8
+		typedef signed long int         sal_Int64;
+		typedef unsigned long int       sal_uInt64;
+
+
+		/*  The following are macros that will add the 64 bit constant suffix. */
+		#define SAL_CONST_INT64(x)       x##l
+		#define SAL_CONST_UINT64(x)      x##ul
+	#elif SAL_TYPES_SIZEOFLONGLONG == 8
 		typedef signed long long    sal_Int64;
 		typedef unsigned long long  sal_uInt64;
 
@@ -129,14 +137,6 @@ typedef unsigned char       sal_uInt8;
 		#define SAL_CONST_INT64(x)       x##ll
 		#define SAL_CONST_UINT64(x)      x##ull
 
-	#elif SAL_TYPES_SIZEOFLONG == 8
-		typedef signed long         sal_Int64;
-		typedef unsigned long       sal_uInt64;
-
-
-		/*  The following are macros that will add the 64 bit constant suffix. */
-		#define SAL_CONST_INT64(x)       x##l
-		#define SAL_CONST_UINT64(x)      x##ul
 	#else
 		#error "Could not find 64-bit type, add support for your architecture"
 	#endif
@@ -190,7 +211,15 @@ typedef void *                   sal_Han
 #define SAL_MIN_INT64         ((sal_Int64)  (SAL_CONST_INT64(-0x7FFFFFFFFFFFFFFF) - 1))
 #define SAL_MAX_INT64         ((sal_Int64)  SAL_CONST_INT64(0x7FFFFFFFFFFFFFFF))
 #define SAL_MAX_UINT64        ((sal_uInt64) SAL_CONST_UINT64(0xFFFFFFFFFFFFFFFF))
-  
+
+#if SAL_TYPES_SIZEOFLONG == 4
+#define SAL_MAX_SSIZE		SAL_MAX_INT32
+#define SAL_MAX_SIZE		SAL_MAX_UINT32
+#elif SAL_TYPES_SIZEOFLONG == 8
+#define SAL_MAX_SSIZE		SAL_MAX_INT64
+#define SAL_MAX_SIZE		SAL_MAX_UINT64
+#endif
+
 #if defined(SAL_W32) || defined(SAL_OS2) || defined(SAL_UNX)
 #   define SAL_MAX_ENUM 0x7fffffff
 #elif defined(SAL_W16)
Index: sal/osl/unx/backtrace.c
===================================================================
RCS file: /cvs/porting/sal/osl/unx/backtrace.c,v
retrieving revision 1.6
retrieving revision 1.6.62.1
diff -u -p -u -p -r1.6 -r1.6.62.1
--- sal/osl/unx/backtrace.c	4 Feb 2004 13:48:44 -0000	1.6
+++ sal/osl/unx/backtrace.c	25 Aug 2004 18:46:23 -0000	1.6.62.1
@@ -74,11 +74,19 @@
 #define FRAME_PTR_OFFSET 1
 #define FRAME_OFFSET 0
 
+#if defined(__sparcv9)
+#define STACK_BIAS 0x7ff
+#else
+#define STACK_BIAS 0
+#endif
+
 #elif defined( INTEL )
 
 #define FRAME_PTR_OFFSET 3
 #define FRAME_OFFSET 1
 
+#define STACK_BIAS 0
+
 #else
 
 #error Unknown Solaris target platform. 
@@ -88,27 +96,32 @@
 
 int backtrace( void **buffer, int max_frames )
 {
-	struct frame *fp;
-	jmp_buf ctx;
-	int i;
+	jmp_buf        ctx;
+    long           fpval;
+	struct frame * fp;
+	int            i;
 
 	/* flush register windows */
 #ifdef SPARC
 	asm("ta 3");
 #endif
+
 	/* get stack- and framepointer */
 	setjmp(ctx);
-	fp = (struct frame*)(((size_t*)(ctx))[FRAME_PTR_OFFSET]);
-	for ( i=0; (i<FRAME_OFFSET) && (fp!=0); i++)
-		fp = fp->fr_savfp;
+	fpval = ((long*)(ctx))[FRAME_PTR_OFFSET];
+
+	fp = (struct frame*)((char*)(fpval) + STACK_BIAS);
+	for ( i=0; (i < FRAME_OFFSET) && (fp != 0); i++)
+		fp = (struct frame*)((char*)(fp->fr_savfp) + STACK_BIAS);
 
 	/* iterate through backtrace */
-	for (i=0; fp && fp->fr_savpc && i<max_frames; i++)
+	for (i = 0; fp && fp->fr_savpc && i < max_frames; i++)
 	{
 		/* store frame */
-		*(buffer++) = (void *)fp->fr_savpc;
+		*(buffer++) = (void *)(fp->fr_savpc);
+
 		/* next frame */
-		fp=fp->fr_savfp;
+		fp = (struct frame*)((char*)(fp->fr_savfp) + STACK_BIAS);
 	}
 	return i;
 }
Index: sal/osl/unx/diagnose.c
===================================================================
RCS file: /cvs/porting/sal/osl/unx/diagnose.c,v
retrieving revision 1.13
retrieving revision 1.12.202.2
diff -u -p -u -p -r1.13 -r1.12.202.2
--- sal/osl/unx/diagnose.c	25 Jun 2004 18:36:24 -0000	1.13
+++ sal/osl/unx/diagnose.c	18 Oct 2004 16:31:47 -0000	1.12.202.2
@@ -186,32 +186,43 @@ static void osl_diagnose_backtrace_Impl 
 #define FRAME_PTR_OFFSET 1
 #define FRAME_OFFSET 0
 
+#if defined(__sparcv9)
+#define STACK_BIAS 0x7ff
+#else
+#define STACK_BIAS 0
+#endif
+
 #elif defined(INTEL)
 
 #define FRAME_PTR_OFFSET 3
 #define FRAME_OFFSET 1
 
+#define STACK_BIAS 0
+
 #endif /* (SPARC || INTEL) */
 
 static void osl_diagnose_backtrace_Impl (oslDebugMessageFunc f)
 {
-	struct frame * fp;
 	jmp_buf        ctx;
+	long           fpval;
+	struct frame * fp;
 	int            i;
 
 #if defined(SPARC)
 	asm("ta 3");
 #endif /* SPARC */
+
 	setjmp (ctx);
-	fp = (struct frame*)(((size_t*)(ctx))[FRAME_PTR_OFFSET]);
+	fpval = ((long*)(ctx))[FRAME_PTR_OFFSET];
 
+	fp = (struct frame*)((char*)(fpval) + STACK_BIAS);
 	for (i = 0; (i < FRAME_OFFSET) && (fp != 0); i++)
-		fp = fp->fr_savfp;
+		fp = (struct frame*)((char*)(fp->fr_savfp) + STACK_BIAS);
 
 	for (i = 0; fp && fp->fr_savpc; i++)
 	{
 		osl_diagnose_frame_Impl (f, i, (void*)(fp->fr_savpc));
-		fp = fp->fr_savfp;
+		fp = (struct frame*)((char*)(fp->fr_savfp) + STACK_BIAS);
 	}
 }
 
Index: sal/osl/unx/makefile.mk
===================================================================
RCS file: /cvs/porting/sal/osl/unx/makefile.mk,v
retrieving revision 1.25
retrieving revision 1.25.62.1
diff -u -p -u -p -r1.25 -r1.25.62.1
--- sal/osl/unx/makefile.mk	4 Feb 2004 15:30:47 -0000	1.25
+++ sal/osl/unx/makefile.mk	18 Aug 2004 13:19:07 -0000	1.25.62.1
@@ -150,7 +150,7 @@ APP1STDLIBS+=-lC
 
 .INCLUDE :  target.mk
 
-.IF "$(OS)$(CPU)"=="SOLARISS" || "$(OS)$(CPU)"=="NETBSDS" || "$(OS)$(CPU)"=="LINUXS"
+.IF "$(OS)$(CPU)"=="SOLARISS" || "$(OS)$(CPU)"=="SOLARISS64B" || "$(OS)$(CPU)"=="NETBSDS" || "$(OS)$(CPU)"=="LINUXS" 
 
 $(SLO)$/interlck.obj: $(SLO)$/interlck.o
 	 touch $(SLO)$/interlck.obj
Index: sal/rtl/source/macro.hxx
===================================================================
RCS file: /cvs/porting/sal/rtl/source/macro.hxx,v
retrieving revision 1.3
retrieving revision 1.3.12.1
diff -u -p -u -p -r1.3 -r1.3.12.1
--- sal/rtl/source/macro.hxx	11 Jun 2004 11:56:30 -0000	1.3
+++ sal/rtl/source/macro.hxx	1 Jul 2004 16:08:04 -0000	1.3.12.1
@@ -96,6 +96,8 @@ this is inserted for the case that the p
 #define THIS_ARCH "SPARC"
 #elif defined IRIX
 #define THIS_ARCH "MIPS"
+#elif defined X86_64
+#define THIS_ARCH "X86_64"
 #endif
 
 #if ! defined THIS_ARCH
Index: sal/textenc/convertsinglebytetobmpunicode.cxx
===================================================================
RCS file: /cvs/porting/sal/textenc/convertsinglebytetobmpunicode.cxx,v
retrieving revision 1.2
retrieving revision 1.2.4.1
diff -u -p -u -p -r1.2 -r1.2.4.1
--- sal/textenc/convertsinglebytetobmpunicode.cxx	17 Jun 2004 11:41:43 -0000	1.2
+++ sal/textenc/convertsinglebytetobmpunicode.cxx	1 Jul 2004 16:08:04 -0000	1.2.4.1
@@ -164,7 +164,8 @@ sal_Size rtl_textenc_convertBmpUnicodeTo
         }
         // Linearly searching through the ranges if probably fastest, assuming
         // that most converted characters belong to the ASCII subset:
-        for (std::size_t i = 0; i < entries; ++i) {
+	sal_Size i;
+        for (i = 0; i < entries; ++i) {
             if (c < ranges[i].unicode) {
                 break;
             } else if (c <= ranges[i].unicode + ranges[i].range) {
Index: sal/workben/makefile.mk
===================================================================
RCS file: /cvs/porting/sal/workben/makefile.mk,v
retrieving revision 1.12
retrieving revision 1.12.172.1
diff -u -p -u -p -r1.12 -r1.12.172.1
--- sal/workben/makefile.mk	12 Jun 2003 09:47:35 -0000	1.12
+++ sal/workben/makefile.mk	25 Aug 2004 16:34:21 -0000	1.12.172.1
@@ -66,29 +66,25 @@ PRJNAME=sal
 TARGET=workben
 LIBTARGET=NO
 TARGETTYPE=CUI
+NO_DEFAULT_STL=TRUE
 ENABLE_EXCEPTIONS=TRUE
 
-TESTAPP=test_osl_getVolInfo
-#TESTAPP=test_osl_joinProcess
-#TESTAPP=getlocaleinfotest
+#TESTAPP=test_osl_getVolInfo
 #TESTAPP=test_osl_joinProcess
 #TESTAPP=getlocaleinfotest
 #TESTAPP=salstattest
 #TESTAPP=saldyntest
 
+TESTAPP=t_alloc
 #TESTAPP=t_cipher
 #TESTAPP=t_digest
 #TESTAPP=t_random
-#TESTAPP=t_layer
-#TESTAPP=t_tls
-#TESTAPP=t_zip
 
 #TESTAPP=testfile
 #TESTAPP=testpipe
 #TESTAPP=testpip2
 #TESTAPP=testproc
 #TESTAPP=tgetpwnam
-#TESTAPP=salstattest
 
 # --- Settings -----------------------------------------------------
 
@@ -96,6 +92,9 @@ TESTAPP=test_osl_getVolInfo
 
 # --- Files --------------------------------------------------------
 
+#
+# test_osl_getVolInfo.
+#
 .IF "$(TESTAPP)" == "test_osl_getVolInfo"    
 
 SHL1OBJS=$(SLO)$/t_osl_getVolInfo.obj
@@ -111,14 +110,19 @@ SHL1STDLIBS+=$(SOLARLIBDIR)$/cppunit.lib
 SHL1STDLIBS=$(LB)$/libsal.so
 SHL1STDLIBS+=$(SOLARLIBDIR)$/libcppunit$(DLLPOSTFIX).a
 .ENDIF
-	
+
 SHL1IMPLIB=i$(SHL1TARGET) 
 SHL1DEF=$(MISC)$/$(SHL1TARGET).def
 DEF1NAME=$(SHL1TARGET) 
 DEF1EXPORTFILE=export.exp
-.ENDIF
 
+.ENDIF # test_osl_getVolInfo
+
+#
+# test_osl_joinProcess.
+#
 .IF "$(TESTAPP)" == "test_osl_joinProcess"    
+
 OBJFILES=$(OBJ)$/t_ojp_exe.obj 
 APP1TARGET=ojpx
 APP1OBJS=$(OBJFILES)
@@ -140,13 +144,17 @@ SHL1STDLIBS+=$(SOLARLIBDIR)$/cppunit.lib
 SHL1STDLIBS=$(LB)$/libsal.so
 SHL1STDLIBS+=$(SOLARLIBDIR)$/libcppunit$(DLLPOSTFIX).a
 .ENDIF
-	
+
 SHL1IMPLIB=i$(SHL1TARGET) 
 SHL1DEF=$(MISC)$/$(SHL1TARGET).def
 DEF1NAME=$(SHL1TARGET) 
 DEF1EXPORTFILE=export.exp
-.ENDIF
 
+.ENDIF # test_osl_joinProcess
+
+#
+# getlocaleinfotest.
+#
 .IF "$(TESTAPP)" == "getlocaleinfotest"
 
 	OBJFILES=$(OBJ)$/getlocaleinfotest.obj
@@ -163,8 +171,11 @@ DEF1EXPORTFILE=export.exp
 
 	APP1DEPN=$(LB)$/isal.lib
 
-.ENDIF
+.ENDIF # getlocaleinfotest
 
+#
+# salstattest.
+#
 .IF "$(TESTAPP)" == "salstattest"
 
 	CFLAGS+= -DUSE_SAL_STATIC
@@ -184,6 +195,9 @@ DEF1EXPORTFILE=export.exp
 
 .ENDIF # salstattest
 
+#
+# saldyntest.
+#
 .IF "$(TESTAPP)" == "saldyntest"
 
 	OBJFILES=	$(OBJ)$/saldyntest.obj
@@ -202,6 +216,25 @@ DEF1EXPORTFILE=export.exp
 .ENDIF # salstattest
 
 #
+# t_alloc.
+#
+.IF "$(TESTAPP)" == "t_alloc"
+
+CFILES=		t_alloc.c
+OBJFILES=	$(OBJ)$/t_alloc.obj
+
+APP1TARGET=	t_alloc
+APP1OBJS=	$(OBJFILES)
+APP1OBJS+=	$(SLO)$/alloc.o $(SLO)$/diagnose.o
+APP1STDLIBS=
+APP1DEPN=
+
+APP1LIBSALCPPRT=$(0)
+STDLIBCUIMT+=-lc -ldl
+
+.ENDIF # t_alloc
+
+#
 # t_cipher
 #
 .IF "$(TESTAPP)" == "t_cipher"
@@ -247,75 +280,6 @@ APP3DEPN=	$(SLB)$/sal.lib
 .ENDIF # t_random
 
 #
-# t_layer.
-#
-.IF "$(TESTAPP)" == "t_layer"
-
-CFILES=		t_layer.c
-OBJFILES=	$(OBJ)$/t_layer.obj
-
-APP4TARGET=	t_layer
-APP4OBJS=	$(OBJFILES)
-APP4STDLIBS=$(SALLIB)
-APP4DEPN=	$(SLB)$/sal.lib
-
-.ENDIF # t_layer
-
-#
-# t_tls.
-#
-.IF "$(TESTAPP)" == "t_tls"
-
-CFILES=		t_tls.c
-OBJFILES=	$(OBJ)$/t_tls.obj
-
-.IF "$(SALTLSLIB)" == ""
-
-.IF "$(GUI)" == "UNX"
-SALTLSLIB=		-lsaltls2
-.ENDIF # unx
-
-.IF "$(GUI)" == "WNT"
-SALTLSLIB=		isaltls.lib
-.ENDIF # wnt
-
-.ENDIF # saltlslib
-
-APP5TARGET=	t_tls
-APP5OBJS=	$(OBJFILES)
-APP5STDLIBS=$(SALTLSLIB) $(SALLIB)
-APP5DEPN=	$(SLB)$/sal.lib
-
-.ENDIF # t_tls
-
-#
-# t_zip.
-#
-.IF "$(TESTAPP)" == "t_zip"
-
-CFILES=		t_zip.c
-OBJFILES=	$(OBJ)$/t_zip.obj
-
-.IF "$(SALZIPLIB)" == ""
-
-.IF "$(GUI)" == "UNX"
-SALZIPLIB=	-lsalzip2
-.ENDIF # unx
-
-.IF "$(GUI)" == "WNT"
-SALZIPLIB=	isalzip.lib
-.ENDIF # wnt
-
-.ENDIF # salziplib
-
-APP6TARGET=	t_zip
-APP6OBJS=	$(OBJFILES)
-APP6STDLIBS=$(SALZIPLIB) $(SALLIB)
-APP6DEPN=	$(SLB)$/sal.lib
-
-.ENDIF # t_zip
-
-#
 # testfile
 #
 .IF "$(TESTAPP)" == "testfile"
@@ -338,10 +302,10 @@ APP1DEPN=	$(SLB)$/sal.lib
 CXXFILES=	testpipe.cxx
 OBJFILES=	$(OBJ)$/testpipe.obj
 
-APP2TARGET= testpipe
-APP2OBJS=   $(OBJFILES)
-APP2STDLIBS=$(SALLIB)
-APP2DEPN=	$(SLB)$/sal.lib
+APP1TARGET= testpipe
+APP1OBJS=   $(OBJFILES)
+APP1STDLIBS=$(SALLIB)
+APP1DEPN=	$(SLB)$/sal.lib
 
 .ENDIF # testpipe
 
@@ -353,10 +317,10 @@ APP2DEPN=	$(SLB)$/sal.lib
 CXXFILES=	testpip2.cxx
 OBJFILES=	$(OBJ)$/testpip2.obj
 
-APP3TARGET=	testpip2
-APP3OBJS=	$(OBJFILES)
-APP3STDLIBS=$(SALLIB)
-APP3DEPN=	$(SLB)$/sal.lib
+APP1TARGET=	testpip2
+APP1OBJS=	$(OBJFILES)
+APP1STDLIBS=$(SALLIB)
+APP1DEPN=	$(SLB)$/sal.lib
 
 .ENDIF # testpip2
 
@@ -368,10 +332,10 @@ APP3DEPN=	$(SLB)$/sal.lib
 CXXFILES=	testproc.cxx
 OBJFILES=	$(OBJ)$/testproc.obj
 
-APP4TARGET= testproc
-APP4OBJS=	$(OBJFILES)
-APP4STDLIBS=$(SALLIB)
-APP4DEPN=	$(SLB)$/sal.lib
+APP1TARGET= testproc
+APP1OBJS=	$(OBJFILES)
+APP1STDLIBS=$(SALLIB)
+APP1DEPN=	$(SLB)$/sal.lib
 
 .ENDIF # testproc
 
@@ -384,10 +348,10 @@ APP4DEPN=	$(SLB)$/sal.lib
 CXXFILES=	tgetpwnam.cxx
 OBJFILES=	$(OBJ)$/tgetpwnam.obj
 
-APP5TARGET= tgetpwnam
-APP5OBJS=	$(OBJFILES)
-APP5STDLIBS=$(SALLIB)
-APP5DEPN=	$(SLB)$/sal.lib
+APP1TARGET= tgetpwnam
+APP1OBJS=	$(OBJFILES)
+APP1STDLIBS=$(SALLIB)
+APP1DEPN=	$(SLB)$/sal.lib
 
 .ENDIF # (sco | netbsd | freebsd)
 .ENDIF # tgetpwname
Index: sal/workben/t_alloc.c
===================================================================
RCS file: sal/workben/t_alloc.c
diff -N sal/workben/t_alloc.c
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ sal/workben/t_alloc.c	25 Aug 2004 16:34:21 -0000	1.2.4.1
@@ -0,0 +1,508 @@
+/*************************************************************************
+ *
+ *  $RCSfile$
+ *
+ *  $Revision$
+ *
+ *  last change: $Author$ $Date$
+ *
+ *  The Contents of this file are made available subject to the terms of
+ *  either of the following licenses
+ *
+ *         - GNU Lesser General Public License Version 2.1
+ *         - Sun Industry Standards Source License Version 1.1
+ *
+ *  Sun Microsystems Inc., October, 2000
+ *
+ *  GNU Lesser General Public License Version 2.1
+ *  =============================================
+ *  Copyright 2000 by Sun Microsystems, Inc.
+ *  901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *  This library is free software; you can redistribute it and/or
+ *  modify it under the terms of the GNU Lesser General Public
+ *  License version 2.1, as published by the Free Software Foundation.
+ *
+ *  This library is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *  Lesser General Public License for more details.
+ *
+ *  You should have received a copy of the GNU Lesser General Public
+ *  License along with this library; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *  MA  02111-1307  USA
+ *
+ *
+ *  Sun Industry Standards Source License Version 1.1
+ *  =================================================
+ *  The contents of this file are subject to the Sun Industry Standards
+ *  Source License Version 1.1 (the "License"); You may not use this file
+ *  except in compliance with the License. You may obtain a copy of the
+ *  License at http://www.openoffice.org/license.html.
+ *
+ *  Software provided under this License is provided on an "AS IS" basis,
+ *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
+ *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
+ *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
+ *  See the License for the specific provisions governing your rights and
+ *  obligations concerning the Software.
+ *
+ *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
+ *
+ *  Copyright: 2000 by Sun Microsystems, Inc.
+ *
+ *  All Rights Reserved.
+ *
+ *  Contributor(s): Matthias Huetsch <matthias.huetsch@sun.com>
+ *
+ *
+ ************************************************************************/
+
+#ifndef _SAL_TYPES_H_
+#include <sal/types.h>
+#endif
+
+#ifndef _OSL_DIAGNOSE_H_
+#include <osl/diagnose.h>
+#endif
+
+#ifndef _RTL_ALLOC_H_
+#include <rtl/alloc.h>
+#endif
+
+#ifndef INCLUDED_STDLIB_H
+#include <stdlib.h>
+#define INCLUDED_STDLIB_H
+#endif
+
+#ifndef INCLUDED_STDIO_H
+#include <stdio.h>
+#define INCLUDED_STDIO_H
+#endif
+
+/*============================================================================
+ *
+ * Pseudo Random Number Generator.
+ *
+ *==========================================================================*/
+struct __random_generator_st
+{
+	sal_Int16 m_nX;
+	sal_Int16 m_nY;
+	sal_Int16 m_nZ;
+};
+
+struct __random_parameter_st
+{
+	sal_Int32 m_nA; /* lower bound */
+	sal_Int32 m_nB; /* upper bound */
+};
+
+/*
+ * __random_update.
+ */
+#define __random_update(x, y, z) \
+{ \
+	(x) = 170 * ((x) % 178) - 63 * ((x) / 178); \
+	if ((x) < 0) (x) += 30328L; \
+	\
+	(y) = 171 * ((y) % 177) -  2 * ((y) / 177); \
+	if ((y) < 0) (y) += 30269L; \
+	\
+	(z) = 172 * ((z) % 176) - 35 * ((z) / 176); \
+	if ((z) < 0) (z) += 30307L; \
+}
+
+/*
+ * __random_generate.
+ */
+static double __random_generate (struct __random_generator_st * state)
+{
+	register double random;
+
+	__random_update (state->m_nX, state->m_nY, state->m_nZ);
+	random = (((double)(state->m_nX) / 30328.0) +
+			  ((double)(state->m_nY) / 30269.0) +
+			  ((double)(state->m_nZ) / 30307.0)   );
+
+	random -= ((double)((sal_uInt32)(random)));
+	return (random);
+}
+
+/*
+ * __random.
+ */
+static struct __random_generator_st g_random =
+{
+	1, 1, 1
+};
+
+static double __random (struct __random_parameter_st * params)
+{
+	register double random;
+
+	random  = __random_generate (&(g_random));
+	if (params)
+	{
+		random *= (double)(params->m_nB - params->m_nA);
+		random += (double)(params->m_nA);
+	}
+	return (random);
+}
+
+/*============================================================================
+ *
+ * __memory_info_st.
+ *
+ *==========================================================================*/
+
+typedef struct __memory_info_st memory_type;
+struct __memory_info_st
+{
+	sal_Int32     m_ttl;
+
+	memory_type * m_flink;
+	memory_type * m_blink;
+};
+
+#define queue_start(entry) \
+{ \
+	(entry)->m_flink = (entry); \
+	(entry)->m_blink = (entry); \
+}
+
+#define queue_remove(entry) \
+{ \
+	(entry)->m_blink->m_flink = (entry)->m_flink; \
+	(entry)->m_flink->m_blink = (entry)->m_blink; \
+	queue_start(entry); \
+}
+
+#define queue_insert_head(head, entry) \
+{ \
+	(entry)->m_blink = (head); \
+	(entry)->m_flink = (head)->m_flink; \
+	(head)->m_flink = (entry); \
+	(entry)->m_flink->m_blink = (entry); \
+}
+
+#define queue_insert_tail(head, entry) \
+{ \
+	(entry)->m_flink = (head); \
+	(entry)->m_blink = (head)->m_blink; \
+	(head)->m_blink = (entry); \
+	(entry)->m_blink->m_flink = (entry); \
+}
+
+/*============================================================================
+ *
+ * __memory_global_st.
+ *
+ *==========================================================================*/
+struct __memory_global_st
+{
+	memory_type                  m_queue_head;
+	struct __random_parameter_st m_param_size;
+	struct __random_parameter_st m_param_ttl;
+};
+
+static struct __memory_global_st g_memory =
+{
+	{ 0, &(g_memory.m_queue_head), &(g_memory.m_queue_head) },
+	{ sizeof(memory_type), 2000 },
+	{ 1, 10 }
+};
+
+/*============================================================================
+ *
+ * __memory_tests.
+ *
+ *==========================================================================*/
+struct __memory_allocator_st
+{
+	/* 'malloc()' */
+	void * (SAL_CALL * m_create)(size_t);
+
+	/* 'realloc()' */
+	void * (SAL_CALL * m_resize)(void *, size_t);
+
+	/* 'free()' */
+	void (SAL_CALL * m_delete)(void *);
+};
+
+static void __memory_test_random (struct __memory_allocator_st * allocator)
+{
+	memory_type *head, *entry, *memory;
+	sal_uInt32   n;
+
+	n = (sal_uInt32)(__random (&(g_memory.m_param_size)));
+	memory = (allocator->m_create)(n);
+	if (memory)
+	{
+		sal_Int32 k;
+
+		k = (sal_Int32)(__random (&(g_memory.m_param_ttl)));
+		memory->m_ttl = k;
+
+		head = &(g_memory.m_queue_head);
+		for (entry = head->m_flink; entry != head; entry = entry->m_flink)
+		{
+			if (entry->m_ttl >= k)
+				break;
+		}
+		queue_insert_tail (entry, memory);
+	}
+
+	head = &(g_memory.m_queue_head);
+	for (entry = head->m_flink; entry != head; entry = entry->m_flink)
+	{
+		entry->m_ttl -= 1;
+	}
+
+	head = &(g_memory.m_queue_head);
+	while (((entry = head->m_flink) != head) && (entry->m_ttl <= 0))
+	{
+		queue_remove (entry);
+		(allocator->m_delete)(entry);
+	}
+}
+
+static void __memory_test_grow (struct __memory_allocator_st * allocator)
+{
+	memory_type *head, *entry, *memory;
+	sal_Int32    n = 10240;
+
+	head = &(g_memory.m_queue_head);
+	if ((entry = head->m_flink) != head)
+	{
+		n = entry->m_ttl + 1024;
+	}
+
+	memory = (allocator->m_create)(sizeof(memory_type));
+	if (memory != 0)
+	{
+		memory->m_ttl = sizeof(memory_type);
+		queue_insert_tail (head, memory);
+	}
+
+	if (allocator->m_resize)
+	{
+		memory = 0;
+		if (entry != head)
+		{
+			queue_remove (entry);
+			memory = entry;
+		}
+
+		memory = (allocator->m_resize)(memory, n);
+		if (memory != 0)
+		{
+			memory->m_ttl = n;
+			queue_insert_head (head, memory);
+		}
+	}
+	else
+	{
+		memory = (allocator->m_create)(n);
+		if (memory != 0)
+		{
+			memory->m_ttl = n;
+			queue_insert_head (head, memory);
+		}
+		if (entry != head)
+		{
+			queue_remove (entry);
+			(allocator->m_delete)(entry);
+		}
+	}
+}
+
+static void __memory_test_cleanup (struct __memory_allocator_st * allocator)
+{
+	memory_type *head, *entry;
+
+	head = &(g_memory.m_queue_head);
+	while ((entry = head->m_flink) != head)
+	{
+		queue_remove (entry);
+		(allocator->m_delete)(entry);
+	}
+}
+
+/*============================================================================
+ *
+ * heap.
+ *
+ *==========================================================================*/
+#ifdef HAVE_HEAP_H
+#include "heap.h"
+
+struct __heap_info_st
+{
+	union
+	{
+		heap_type m_heap;
+		char      m_data[0x10000];
+	} m_union;
+
+	int m_magic;
+};
+
+static struct __heap_info_st g_heap =
+{
+	{ HEAP_INITIALIZER },
+	0
+};
+
+static void * __heap_alloc (size_t n)
+{
+	if (g_heap.m_magic == 0)
+	{
+		heap_init (&(g_heap.m_union.m_heap), sizeof(g_heap.m_union));
+		g_heap.m_magic = 1;
+	}
+	return heap_alloc (&(g_heap.m_union.m_heap), n);
+}
+
+static void * __heap_realloc (void * p, size_t n)
+{
+	if (g_heap.m_magic == 0)
+	{
+		heap_init (&(g_heap.m_union.m_heap), sizeof(g_heap.m_union));
+		g_heap.m_magic = 1;
+	}
+	return heap_realloc (&(g_heap.m_union.m_heap), p, n);
+}
+
+static void __heap_free (void * p)
+{
+	if (g_heap.m_magic == 0)
+	{
+		heap_init (&(g_heap.m_union.m_heap), sizeof(g_heap.m_union));
+		g_heap.m_magic = 1;
+	}
+	heap_free (&(g_heap.m_union.m_heap), p);
+}
+
+static struct __memory_allocator_st g_heap_allocator =
+{
+	__heap_alloc,
+	__heap_realloc,
+	__heap_free
+};
+
+#endif /* HAVE_HEAP_H */
+
+/*============================================================================
+ *
+ * main.
+ *
+ *==========================================================================*/
+static struct __memory_allocator_st g_rtl_allocator =
+{
+	rtl_allocateMemory,
+	rtl_reallocateMemory,
+	rtl_freeMemory
+};
+
+static struct __memory_allocator_st g_std_allocator =
+{
+	malloc,
+	realloc,
+	free
+};
+
+enum __memory_options
+{
+	OPTION_TEST_RANDOM = 0x01,
+	OPTION_TEST_GROW   = 0x02
+};
+
+static void usage (void)
+{
+	printf ("Usage:\tt_alloc [-a <rtl|std>] [-n <num>]\n");
+
+	printf ("\nOptions:\n");
+	printf ("-a\tallocator  [default: rtl]\n");
+	printf ("-n\titerations [default: 10000]\n");
+	printf ("-h\thelp\n");
+
+	exit (0);
+}
+
+int SAL_CALL main (int argc, char **argv)
+{
+	struct __memory_allocator_st * allocator = &g_rtl_allocator;
+	int options = OPTION_TEST_RANDOM;
+	int i, n = 10000;
+
+	/* parse options */
+	for (i = 1; i < argc; i++)
+	{
+		const char *opt = argv[i]; char c;
+		switch (opt[0])
+		{
+			case '-':
+				switch (opt[1])
+				{
+					case 'a':
+						opt = argv[++i]; c = opt ? opt[0] : 0;
+						switch (c)
+						{
+							case 'r':
+								allocator = &g_rtl_allocator;
+								break;
+							case 's':
+								allocator = &g_std_allocator;
+								break;
+							default:
+								usage();
+								break;
+						}
+						break;
+
+					case 'n':
+						opt = argv[++i]; c = opt ? opt[0] : 0;
+						if (('0' <= c) && (c <= '9'))
+							n = atoi(opt);
+						else
+							usage();
+						break;
+
+					case 'h':
+					default:
+						usage();
+						break;
+				}
+				break;
+
+			default:
+				usage();
+				break;
+		}
+	}
+
+	/* execute options */
+	if (options & OPTION_TEST_RANDOM)
+	{
+		/* allocate/deallocate w/ random distribution */
+		for (i = n; i > 0; i--)
+			__memory_test_random (allocator);
+
+		/* free still allocated memory */
+		__memory_test_cleanup (allocator);
+	}
+	if (options & OPTION_TEST_GROW)
+	{
+		/* allocate w/ growing distribution */
+		for (i = n; i > 0; i--)
+			__memory_test_grow (allocator);
+
+		/* free still allocated memory */
+		__memory_test_cleanup (allocator);
+	}
+
+	/* finished */
+	return 0;
+}
Index: sal/workben/t_layer.c
===================================================================
RCS file: sal/workben/t_layer.c
diff -N sal/workben/t_layer.c
--- sal/workben/t_layer.c	15 Apr 2003 17:49:37 -0000	1.4
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,353 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile: t_layer.c,v $
- *
- *  $Revision: 1.4 $
- *
- *  last change: $Author: vg $ $Date: 2003/04/15 17:49:37 $
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-
-#ifndef _SAL_TYPES_H_
-#include <sal/types.h>
-#endif
-#ifndef _RTL_ALLOC_H_
-#include <rtl/alloc.h>
-#endif
-#ifndef _OSL_DIAGNOSE_H_
-#include <osl/diagnose.h>
-#endif
-#ifndef _OSL_INTERLCK_H_
-#include <osl/interlck.h>
-#endif
-#ifndef _OSL_ISOCKET_H_
-#include <osl/isocket.h>
-#endif
-
-/*========================================================================
- *
- * osl/debug.c
- *
- *======================================================================*/
-/*
- * __osl_debug_create.
- */
-static oslSocketResult SAL_CALL __osl_debug_create (
-	oslSocketDescriptor *socket,
-	oslAddrFamily        family,
-	oslSocketType        type,
-	oslProtocol          protocol)
-{
-	oslSocketResult result;
-
-	if (!(socket->m_lower))
-	{
-		oslSocketDescriptor *lower;
-		lower = osl_socket_createSocketLayer (osl_socket_getSocketMethods());
-		osl_socket_pushSocketLayer (socket, lower);
-	}
-
-	result = (socket->m_lower->m_methods->m_create)(
-		socket->m_lower, family, type, protocol);
-	if (!(result == osl_Socket_Ok))
-		return (result);
-
-	if (!(socket->m_private))
-	{
-		/* ... */
-	}
-	return (osl_Socket_Ok);
-}
-
-/*
- * __osl_debug_delete.
- */
-static void SAL_CALL __osl_debug_delete (oslSocketDescriptor *socket)
-{
-	if (socket->m_private)
-	{
-		/* ... */
-	}
-	if (socket->m_lower)
-	{
-		(socket->m_lower->m_methods->m_delete)(socket->m_lower);
-		osl_socket_deleteSocketLayer (socket->m_lower);
-	}
-}
-
-/*
- * __osl_debug_getOption.
- */
-static oslSocketResult SAL_CALL __osl_debug_getOption (
-	oslSocketDescriptor  *socket,
-	oslSocketOptionLevel  level,
-	oslSocketOption       option,
-	void                 *buffer,
-	sal_uInt32            length)
-{
-	if (level == osl_Socket_LevelSocketLayer)
-	{
-		/* ... */
-		return (osl_Socket_Ok);
-	}
-
-	return (socket->m_lower->m_methods->m_getoption)(
-		socket->m_lower, level, option, buffer, length);
-}
-
-/*
- * __osl_debug_setOption.
- */
-static oslSocketResult SAL_CALL __osl_debug_setOption (
-	oslSocketDescriptor  *socket,
-	oslSocketOptionLevel  level,
-	oslSocketOption       option,
-	const void           *buffer,
-	sal_uInt32            length)
-{
-	if (level == osl_Socket_LevelSocketLayer)
-	{
-		/* ... */
-		return (osl_Socket_Ok);
-	}
-
-	return (socket->m_lower->m_methods->m_setoption)(
-		socket->m_lower, level, option, buffer, length);
-}
-
-/*
- * __osl_debug_accept.
- */
-static oslSocketDescriptor* SAL_CALL __osl_debug_accept (
-	oslSocketDescriptor *socket, oslSocketAddr *fromaddr)
-{
-	oslSocketDescriptor *lower;
-	lower = (socket->m_lower->m_methods->m_accept)(socket->m_lower, fromaddr);
-	if (lower)
-	{
-		oslSocketDescriptor *upper;
-		upper = osl_socket_createSocketLayer (socket->m_methods);
-		osl_socket_pushSocketLayer (upper, lower);
-		return (upper);
-	}
-	return ((oslSocketDescriptor*)NULL);
-}
-
-/*
- * __osl_debug_connect.
- */
-static oslSocketResult SAL_CALL __osl_debug_connect (
-	oslSocketDescriptor *socket, oslSocketAddr addr)
-{
-	return (socket->m_lower->m_methods->m_connect)(socket->m_lower, addr);
-}
-
-/*
- * __osl_debug_close.
- */
-static void SAL_CALL __osl_debug_close (oslSocketDescriptor *socket)
-{
-	(socket->m_lower->m_methods->m_close)(socket->m_lower);
-}
-
-/*
- * __osl_shutdown.
- */
-static void SAL_CALL __osl_debug_shutdown (
-	oslSocketDescriptor *socket, oslSocketDirection direction)
-{
-	(socket->m_lower->m_methods->m_shutdown)(socket->m_lower, direction);
-}
-
-/*
- * __osl_debug_methods.
- */
-static oslSocketMethods __osl_debug_methods =
-{
-	NULL /* initialized on demand */
-};
-
-/*
- * osl_debug_getSocketMethods.
- */
-const oslSocketMethods* SAL_CALL osl_debug_getSocketMethods (void)
-{
-	static oslInterlockedCount nonce = 0;
-	if (osl_incrementInterlockedCount (&nonce) == 1)
-	{
-		const oslSocketMethods *methods = osl_socket_getDefaultSocketMethods();
-		__osl_debug_methods = *methods;
-
-		__osl_debug_methods.m_create    = __osl_debug_create;
-		__osl_debug_methods.m_delete    = __osl_debug_delete;
-
-		__osl_debug_methods.m_getoption = __osl_debug_getOption;
-		__osl_debug_methods.m_setoption = __osl_debug_setOption;
-
-		__osl_debug_methods.m_accept    = __osl_debug_accept;
-		__osl_debug_methods.m_connect   = __osl_debug_connect;
-		__osl_debug_methods.m_close     = __osl_debug_close;
-
-		__osl_debug_methods.m_shutdown  = __osl_debug_shutdown;
-
-		osl_incrementInterlockedCount (&nonce);
-	}
-
-	osl_decrementInterlockedCount (&nonce);
-	return (&__osl_debug_methods);
-}
-
-/*========================================================================
- *
- * osl/socket.c (physical, bottom layer).
- *
- *======================================================================*/
-#if 0  /* NYI */
-
-static oslSocketResult SAL_CALL __osl_socket_create (
-	oslSocketDescriptor *socket,
-	oslAddrFamily        family,
-	oslSocketType        type,
-	oslProtocol          protocol)
-{
-#if OSL_DEBUG_LEVEL > 1
-	const oslSocketMethods *debug = osl_debug_getSocketMethods();
-	if (!(socket->m_upper || socket->m_upper->m_methods == debug))
-	{
-		oslSocketDescriptor *upper;
-
-		upper = osl_socket_createSocketLayer (debug);
-		osl_socket_pushSocketLayer (upper, socket);
-
-		return (upper->m_methods->m_create)(upper, family, type, protocol);
-	}
-#endif /* OSL_DEBUG_LEVEL */
-	if (!(socket->m_private))
-	{
-		/* ... */
-		socket->m_private = osl_createSocket (family, type, protocol);
-	}
-	return (osl_Socket_Ok);
-}
-
-#endif /* NYI */
-
-/*========================================================================
- *
- * main.
- *
- *======================================================================*/
-int SAL_CALL main (int argc, char **argv)
-{
-	oslSocketDescriptor *socket;
-
-	socket = osl_socket_createSocketLayer (osl_debug_getSocketMethods());
-	if (socket)
-	{
-		oslSocketDescriptor *connection;
-		oslSocketResult      result;
-		oslSocketAddr        addr, from;
-		sal_Int32            option = 1;
-
-		result = osl_socket_create (
-			socket,
-			osl_Socket_FamilyInet,
-			osl_Socket_TypeStream,
-			osl_Socket_ProtocolIp);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		result = osl_socket_setOption (
-			socket,
-			osl_Socket_LevelSocket,
-			osl_Socket_OptionReuseAddr,
-			&option, sizeof(option));
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		addr = osl_createEmptySocketAddr (osl_Socket_FamilyInet);
-		osl_setInetPortOfSocketAddr (addr, 7777);
-
-		result = osl_socket_bind (socket, addr);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		result = osl_socket_listen (socket, 1);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		connection = osl_socket_accept (socket, &from);
-		if (connection)
-		{
-			sal_Char         buffer[1024];
-			sal_Int32        k, n = sizeof(buffer);
-			oslSocketMsgFlag flag = osl_Socket_MsgNormal;
-
-			while ((k = osl_socket_recv (connection, buffer, n, flag)) > 0)
-			{
-				if (osl_socket_send (connection, buffer, k, flag) < 0)
-					break;
-			}
-
-			osl_socket_close (connection);
-			osl_socket_delete (connection);
-
-			osl_socket_deleteSocketLayer (connection);
-		}
-
-		osl_socket_close (socket);
-		osl_socket_delete (socket);
-
-		osl_socket_deleteSocketLayer (socket);
-	}
-
-	return 0;
-}
-
Index: sal/workben/t_ojp_exe.cxx
===================================================================
RCS file: sal/workben/t_ojp_exe.cxx
diff -N sal/workben/t_ojp_exe.cxx
--- sal/workben/t_ojp_exe.cxx	26 Mar 2003 16:47:25 -0000	1.2
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,86 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile: t_ojp_exe.cxx,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: hr $ $Date: 2003/03/26 16:47:25 $
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-
-
-#ifdef WNT
-#	define WIN32_LEAN_AND_MEAN
-#	include <windows.h>
-#else
-#	include <unistd.h>
-#endif
-
-#include <stdio.h>
-
-int main(int argc, char* argv[])
-{
-    printf("osl process test executable started:\n");
-	
-#ifdef WNT	
-    Sleep(5000);
-#else
-	sleep(5);
-#endif
-
-    printf("osl process test executable ended:\n");
-
-    return (0);
-}
-
Index: sal/workben/t_tls.c
===================================================================
RCS file: sal/workben/t_tls.c
diff -N sal/workben/t_tls.c
--- sal/workben/t_tls.c	26 Mar 2003 16:47:27 -0000	1.3
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,301 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile: t_tls.c,v $
- *
- *  $Revision: 1.3 $
- *
- *  last change: $Author: hr $ $Date: 2003/03/26 16:47:27 $
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-
-#ifndef _SAL_TYPES_H_
-#include <sal/types.h>
-#endif
-#ifndef _RTL_ALLOC_H_
-#include <rtl/alloc.h>
-#endif
-#ifndef _RTL_USTRING_H_
-#include <rtl/ustring.h>
-#endif
-
-#ifndef _OSL_DIAGNOSE_H_
-#include <osl/diagnose.h>
-#endif
-#ifndef _OSL_FILE_H_
-#include <osl/file.h>
-#endif
-#ifndef _OSL_INTERLCK_H_
-#include <osl/interlck.h>
-#endif
-#ifndef _OSL_ISOCKET_H_
-#include <osl/isocket.h>
-#endif
-
-#ifndef _OSL_TLS_H_
-#include <osl/tls.h>
-#endif
-
-#include <string.h>
-#include <stdio.h>
-
-/*========================================================================
- *
- * Internals.
- *
- *======================================================================*/
-void SAL_CALL __rtl_sequence_release (sal_Sequence *value)
-{
-	if (value)
-	{
-		if (osl_decrementInterlockedCount (&(value->nRefCount)) == 0)
-			rtl_freeMemory (value);
-	}
-}
-
-void SAL_CALL __rtl_sequence_new (sal_Sequence **value, sal_Int32 length)
-{
-	if (value)
-	{
-		__rtl_sequence_release (*value);
-
-		*value = (sal_Sequence*)rtl_allocateMemory (
-			SAL_SEQUENCE_HEADER_SIZE + length);
-
-		(*value)->nRefCount = 1;
-		(*value)->nElements = 0;
-	}
-}
-
-void load_sequence (sal_Sequence **ppSequence, const sal_Char *name)
-{
-	oslFileError  result;
-	rtl_uString  *pName, *pPath;
-
-	if (ppSequence)
-	{
-		__rtl_sequence_release (*ppSequence);
-		*ppSequence = NULL;
-	}
-
-	pName = NULL;
-	rtl_uString_newFromAscii (&pName, name);
-
-	pPath = NULL;
-	result = osl_searchNormalizedPath (pName, NULL, &pPath);
-	if (result == osl_File_E_None)
-	{
-		oslFileHandle hFile;
-
-		result = osl_openFile (pPath, &hFile, osl_File_OpenFlag_Read);
-		if (result == osl_File_E_None)
-		{
-			sal_uInt64 nSize = 0, nRead = 0;
-
-			osl_setFilePos (hFile, osl_Pos_End, 0);
-			osl_getFilePos (hFile, &nSize);
-			osl_setFilePos (hFile, osl_Pos_Absolut, 0);
-
-			__rtl_sequence_new (ppSequence, (sal_Int32)nSize);
-
-			osl_readFile (hFile, (*ppSequence)->elements, nSize, &nRead);
-			(*ppSequence)->nElements = (sal_Int32)nRead;
-		}
-		osl_closeFile (hFile);
-
-		rtl_uString_release (pPath);
-	}
-
-	rtl_uString_release (pName);
-}
-
-/*========================================================================
- *
- * main.
- *
- *======================================================================*/
-int SAL_CALL main (int argc, char **argv)
-{
-	static const sal_Char p[] = "GET / HTTP/1.0\015\012\015\012";
-	oslSocketDescriptor  *socket;
-
-
-	socket = osl_socket_createSocketLayer (osl_tls_getSocketMethods());
-	if (socket)
-	{
-		oslSocketAddr     target;
-		oslSocketResult   result;
-		oslSocketMsgFlag  flag   = osl_Socket_MsgNormal;
-		rtl_uString      *dotted = NULL;
-
-
-		rtl_uString_newFromAscii (&dotted, argv[1]);
-		target = osl_createInetSocketAddr (dotted, 443);
-		rtl_uString_release (dotted);
-
-		result = osl_socket_create (
-			socket,
-			osl_Socket_FamilyInet,
-			osl_Socket_TypeStream,
-			osl_Socket_ProtocolIp);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		result = osl_socket_connect (socket, target);
-		osl_destroySocketAddr (target);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		result = osl_socket_connect_handshake (socket, target);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		if (osl_socket_send (socket, p, strlen(p), flag) > 0)
-		{
-			sal_Char  buffer[1024];
-			sal_Int32 k, n = sizeof(buffer);
-
-			while ((k = osl_socket_recv (socket, buffer, n, flag)) > 0)
-				fwrite (buffer, 1, k, stdout);
-		}
-
-		osl_socket_shutdown (socket, osl_Socket_DirReadWrite);
-		osl_socket_close (socket);
-	
-		osl_socket_delete (socket);
-		osl_socket_deleteSocketLayer (socket);
-	}
-
-
-	socket = osl_socket_createSocketLayer (osl_tls_getSocketMethods());
-	if (socket)
-	{
-		oslSocketDescriptor *connection;
-		oslSocketResult      result;
-		oslSocketAddr        addr, from;
-		sal_Int32            option = 1;
-		sal_Sequence        *data = NULL;
-
-
-		result = osl_socket_create (
-			socket,
-			osl_Socket_FamilyInet,
-			osl_Socket_TypeStream,
-			osl_Socket_ProtocolIp);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		result = osl_socket_setOption (
-			socket,
-			osl_Socket_LevelSocket,
-			osl_Socket_OptionReuseAddr,
-			&option, sizeof(option));
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		addr = osl_createEmptySocketAddr (osl_Socket_FamilyInet);
-		osl_setInetPortOfSocketAddr (addr, 7777);
-
-		result = osl_socket_bind (socket, addr);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		load_sequence (&data, "s_cert.der");
-		if (data && data->nElements)
-		{
-			result = osl_socket_setOption (
-				socket,
-				osl_Socket_LevelTLS,
-				osl_Socket_OptionCertificate,
-				data->elements, data->nElements);
-			OSL_ASSERT(result == osl_Socket_Ok);
-		}
-
-		load_sequence (&data, "s_pkey.der");
-		if (data && data->nElements)
-		{
-			result = osl_socket_setOption (
-				socket,
-				osl_Socket_LevelTLS,
-				osl_Socket_OptionPrivateKey,
-				data->elements, data->nElements);
-			OSL_ASSERT(result == osl_Socket_Ok);
-		}
-		__rtl_sequence_release (data);
-
-		result = osl_socket_listen (socket, 1);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		connection = osl_socket_accept (socket, &from);
-		if (connection)
-		{
-			sal_Char  buffer[1024];
-			sal_Int32 k, n = sizeof(buffer);
-			oslSocketMsgFlag flag = osl_Socket_MsgNormal;
-
-			result = osl_socket_accept_handshake (connection, from);
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			while ((k = osl_socket_recv (connection, buffer, n, flag)) > 0)
-			{
-				if (osl_socket_send (connection, buffer, k, flag) < 0)
-					break;
-			}
-
-			osl_socket_close (connection);
-
-			osl_socket_delete (connection);
-			osl_socket_deleteSocketLayer (connection);
-		}
-
-		osl_socket_delete (socket);
-		osl_socket_deleteSocketLayer (socket);
-	}
-
-	return 0;
-}
-
Index: sal/workben/t_zip.c
===================================================================
RCS file: sal/workben/t_zip.c
diff -N sal/workben/t_zip.c
--- sal/workben/t_zip.c	26 Mar 2003 16:47:27 -0000	1.3
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,223 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile: t_zip.c,v $
- *
- *  $Revision: 1.3 $
- *
- *  last change: $Author: hr $ $Date: 2003/03/26 16:47:27 $
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-
-#ifndef _SAL_TYPES_H_
-#include <sal/types.h>
-#endif
-#ifndef _RTL_USTRING_H_
-#include <rtl/ustring.h>
-#endif
-
-#ifndef _OSL_DIAGNOSE_H_
-#include <osl/diagnose.h>
-#endif
-#ifndef _OSL_THREAD_H_
-#include <osl/thread.h>
-#endif
-#ifndef _OSL_ZSOCKET_H_
-#include <osl/zsocket.h>
-#endif
-
-#include <stdio.h>
-
-/*========================================================================
- *
- * internals.
- *
- *======================================================================*/
-void SAL_CALL clientSocketReader (void *pData)
-{
-	oslSocketDescriptor *socket;
-
-	socket = (oslSocketDescriptor*)pData;
-	if (socket)
-	{
-		sal_Char         buffer[128];
-		sal_Int32        k, n = sizeof(buffer);
-		oslSocketMsgFlag flag = osl_Socket_MsgNormal;
-
-		while ((k = osl_socket_recv (socket, buffer, n, flag)) > 0)
-		{
-			fwrite (buffer, 1, k, stdout);
-			fflush (stdout);
-		}
-	}
-}
-
-/*========================================================================
- *
- * main.
- *
- *======================================================================*/
-int SAL_CALL main (int argc, char **argv)
-{
-	oslSocketDescriptor *socket;
-
-	socket = osl_socket_createSocketLayer (osl_zlib_getSocketMethods());
-	if (socket)
-	{
-		oslSocketAddr   addr = 0;
-		oslSocketResult result;
-
-		result = osl_socket_create (
-			socket,
-			osl_Socket_FamilyInet,
-			osl_Socket_TypeStream,
-			osl_Socket_ProtocolIp);
-		OSL_ASSERT(result == osl_Socket_Ok);
-
-		if (argc > 1)
-		{
-			rtl_uString *host = 0;
-
-			rtl_uString_newFromAscii (&host, argv[1]);
-			addr = osl_resolveHostname (host);
-			rtl_uString_release (host);
-		}
-
-		if (addr)
-		{
-			sal_Char         buffer[128];
-			sal_Int32        k, n = sizeof(buffer);
-			oslSocketMsgFlag flag = osl_Socket_MsgNormal;
-			oslThread        reader;
-
-			osl_setInetPortOfSocketAddr (addr, 7777);
-
-			result = osl_socket_connect (socket, addr);
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			result = osl_socket_connect_handshake (socket, addr);
-			osl_destroySocketAddr (addr);
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			reader = osl_createSuspendedThread (clientSocketReader, socket);
-			OSL_ASSERT(reader);
-			osl_resumeThread (reader);
-
-			while ((k = fread (buffer, 1, n, stdin)) > 0)
-			{
-				if (osl_socket_send (socket, buffer, k, flag) < 0)
-					break;
-			}
-
-			osl_socket_shutdown (socket, osl_Socket_DirReadWrite);
-			osl_socket_close (socket);
-
-			osl_joinWithThread (reader);
-			osl_destroyThread (reader);
-		}
-		else
-		{
-			oslSocketDescriptor *connection;
-			oslSocketAddr        from   = 0;
-			sal_Int32            option = 1;
-
-			addr = osl_createEmptySocketAddr (osl_Socket_FamilyInet);
-			osl_setInetPortOfSocketAddr (addr, 7777);
-
-			result = osl_socket_setOption (
-				socket,
-				osl_Socket_LevelSocket,
-				osl_Socket_OptionReuseAddr,
-				&option, sizeof(option));
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			result = osl_socket_bind (socket, addr);
-			osl_destroySocketAddr (addr);
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			result = osl_socket_listen (socket, 1);
-			OSL_ASSERT(result == osl_Socket_Ok);
-
-			connection = osl_socket_accept (socket, &from);
-			if (connection)
-			{
-				sal_Char         buffer[64];
-				sal_Int32        k, n = sizeof(buffer);
-				oslSocketMsgFlag flag = osl_Socket_MsgNormal;
-
-				result = osl_socket_accept_handshake (connection, from);
-				osl_destroySocketAddr (from);
-				OSL_ASSERT(result == osl_Socket_Ok);
-
-				while ((k = osl_socket_recv (connection, buffer, n, flag)) > 0)
-				{
-					if (osl_socket_send (connection, buffer, k, flag) < 0)
-						break;
-				}
-
-				osl_socket_close (connection);
-
-				osl_socket_delete (connection);
-				osl_socket_deleteSocketLayer (connection);
-			}
-
-			osl_socket_close (socket);
-		}
-
-		osl_socket_delete (socket);
-		osl_socket_deleteSocketLayer (socket);
-	}
-
-	return 0;
-}
-
Index: sal/workben/test.cxx
===================================================================
RCS file: sal/workben/test.cxx
diff -N sal/workben/test.cxx
--- sal/workben/test.cxx	1 Feb 2001 12:31:41 -0000	1.2
+++ /dev/null	1 Jan 1970 00:00:00 -0000
@@ -1,97 +0,0 @@
-/*************************************************************************
- *
- *  $RCSfile: test.cxx,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: mfe $ $Date: 2001/02/01 12:31:41 $
- *
- *  The Contents of this file are made available subject to the terms of
- *  either of the following licenses
- *
- *         - GNU Lesser General Public License Version 2.1
- *         - Sun Industry Standards Source License Version 1.1
- *
- *  Sun Microsystems Inc., October, 2000
- *
- *  GNU Lesser General Public License Version 2.1
- *  =============================================
- *  Copyright 2000 by Sun Microsystems, Inc.
- *  901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *  This library is free software; you can redistribute it and/or
- *  modify it under the terms of the GNU Lesser General Public
- *  License version 2.1, as published by the Free Software Foundation.
- *
- *  This library is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *  Lesser General Public License for more details.
- *
- *  You should have received a copy of the GNU Lesser General Public
- *  License along with this library; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *  MA  02111-1307  USA
- *
- *
- *  Sun Industry Standards Source License Version 1.1
- *  =================================================
- *  The contents of this file are subject to the Sun Industry Standards
- *  Source License Version 1.1 (the "License"); You may not use this file
- *  except in compliance with the License. You may obtain a copy of the
- *  License at http://www.openoffice.org/license.html.
- *
- *  Software provided under this License is provided on an "AS IS" basis,
- *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
- *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
- *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
- *  See the License for the specific provisions governing your rights and
- *  obligations concerning the Software.
- *
- *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
- *
- *  Copyright: 2000 by Sun Microsystems, Inc.
- *
- *  All Rights Reserved.
- *
- *  Contributor(s): _______________________________________
- *
- *
- ************************************************************************/
-
-#include <stdio.h>
-
-#if (defined UNX) || (defined OS2)
-int main( int argc, char * argv[] )
-#else
-int _cdecl main( int argc, char * argv[] )
-#endif
-{
-	void test_int64();
-	test_int64();
-
-	void test_profile(void);
-	test_profile();
-
-	void test_OString();
-	test_OString();
-
-/*  	void test_OWString(); */
-/*  	test_OWString(); */
-
-/*  	void test_OStringBuffer(); */
-/*  	test_OStringBuffer(); */
-
-/*  	void test_OWStringBuffer(); */
-/*  	test_OWStringBuffer(); */
-	
-/*  	void test_OString2OWStringAndViceVersa(); */
-/*  	test_OString2OWStringAndViceVersa(); */
-
-	void test_uuid();
-	test_uuid();
-
-	return(0);
-}
-
-
Index: i18npool/source/search/textsearch.cxx
===================================================================
RCS file: /cvs/l10n/i18npool/source/search/textsearch.cxx,v
retrieving revision 1.5
retrieving revision 1.5.4.1
diff -u -p -u -p -r1.5 -r1.5.4.1
--- i18npool/source/search/textsearch.cxx	17 Jun 2004 12:35:12 -0000	1.5
+++ i18npool/source/search/textsearch.cxx	7 Oct 2004 15:55:38 -0000	1.5.4.1
@@ -59,6 +59,8 @@
  *
  ************************************************************************/
 
+#include <string.h>
+
 #include "textsearch.hxx"
 #include "levdis.hxx"
 #include <regexp/reclass.hxx>
Index: desktop/source/deployment/gui/dp_gui_dialog.cxx
===================================================================
RCS file: /cvs/framework/desktop/source/deployment/gui/dp_gui_dialog.cxx,v
retrieving revision 1.8
retrieving revision 1.2.12.4
diff -u -p -u -p -r1.8 -r1.2.12.4
--- desktop/source/deployment/gui/dp_gui_dialog.cxx	2 Feb 2005 16:42:34 -0000	1.8
+++ desktop/source/deployment/gui/dp_gui_dialog.cxx	9 Mar 2005 19:42:54 -0000	1.2.12.4
@@ -238,14 +238,14 @@ DialogImpl::~DialogImpl()
     sal_Int32 statusWidth = that->m_treelb->GetTextWidth(
         that->m_treelb->m_strEnabled );
     statusWidth = ::std::max(
-        statusWidth, that->m_treelb->GetTextWidth(
+        statusWidth, (sal_Int32) that->m_treelb->GetTextWidth(
             that->m_treelb->m_strDisabled ) );
     statusWidth = ::std::max(
-        statusWidth, that->m_treelb->GetTextWidth(
+        statusWidth, (sal_Int32) that->m_treelb->GetTextWidth(
             that->m_treelb->m_strUnknown ) );
     String strStatus( getResourceString(RID_STR_PACKAGE_STATUS) );
     statusWidth = ::std::max(
-        statusWidth, that->m_treelb->GetTextWidth( strStatus ) );
+        statusWidth, (sal_Int32) that->m_treelb->GetTextWidth( strStatus ) );
     statusWidth += 1;
     
     that->m_headerBar->InsertItem(
@@ -253,7 +253,7 @@ DialogImpl::~DialogImpl()
         selWidth - statusWidth - vscrollWidth );
     that->m_headerBar->InsertItem( ITEM_ID_STATUS, strStatus, statusWidth );
     
-    sal_Int32 tabs[ 3 ];
+    long tabs[ 3 ];
     tabs[ 0 ] = 2; // two tabs
     tabs[ 1 ] = statusWidth;
     tabs[ 2 ] = selWidth - statusWidth - vscrollWidth;
Index: basic/source/app/app.cxx
===================================================================
RCS file: /cvs/script/basic/source/app/app.cxx,v
retrieving revision 1.58
retrieving revision 1.54.4.2
diff -u -p -u -p -r1.58 -r1.54.4.2
--- basic/source/app/app.cxx	20 Sep 2004 12:28:40 -0000	1.58
+++ basic/source/app/app.cxx	12 Oct 2004 18:13:04 -0000	1.54.4.2
@@ -1553,9 +1553,9 @@ long BasicFrame::Command( short nID, BOO
 				}
 
 
-				long nTitleHeight;
+				sal_Int32 nTitleHeight;
 				{
-					long nDummy1, nDummy2, nDummy3;
+					sal_Int32 nDummy1, nDummy2, nDummy3;
 					GetBorder( nDummy1, nTitleHeight, nDummy2, nDummy3 );
 				}
 
@@ -1577,9 +1577,9 @@ long BasicFrame::Command( short nID, BOO
 				}
 
 
-				long nTitleHeight;
+				sal_Int32 nTitleHeight;
 				{
-					long nDummy1, nDummy2, nDummy3;
+					sal_Int32 nDummy1, nDummy2, nDummy3;
 					GetBorder( nDummy1, nTitleHeight, nDummy2, nDummy3 );
 				}
 
@@ -1605,9 +1605,9 @@ long BasicFrame::Command( short nID, BOO
 				}
 
 
-				long nTitleHeight;
+				sal_Int32 nTitleHeight;
 				{
-					long nDummy1, nDummy2, nDummy3;
+					sal_Int32 nDummy1, nDummy2, nDummy3;
 					GetBorder( nDummy1, nTitleHeight, nDummy2, nDummy3 );
 				}
 
Index: basic/source/app/appwin.cxx
===================================================================
RCS file: /cvs/script/basic/source/app/appwin.cxx,v
retrieving revision 1.5
retrieving revision 1.5.4.1
diff -u -p -u -p -r1.5 -r1.5.4.1
--- basic/source/app/appwin.cxx	17 Jun 2004 11:45:56 -0000	1.5
+++ basic/source/app/appwin.cxx	21 Jul 2004 18:22:07 -0000	1.5.4.1
@@ -154,9 +154,9 @@ void AppWin::Maximize()
 		pFrame->nMaximizedWindows++;
 		nWinState = TT_WIN_STATE_MAX;
 	}
-	long nTitleHeight;
+	sal_Int32 nTitleHeight;
 	{
-		long nDummy1, nDummy2, nDummy3;
+		sal_Int32 nDummy1, nDummy2, nDummy3;
 		pFrame->GetBorder( nDummy1, nTitleHeight, nDummy2, nDummy3 );
 	}
 
@@ -198,9 +198,9 @@ void AppWin::Cascade( USHORT nNr )
 	nNr %= 10;
 	nNr++;
 
-	long nTitleHeight;
+	sal_Int32 nTitleHeight;
 	{
-		long nDummy1, nDummy2, nDummy3;
+		sal_Int32 nDummy1, nDummy2, nDummy3;
 		pFrame->GetBorder( nDummy1, nTitleHeight, nDummy2, nDummy3 );
 	}
 
Index: basic/source/inc/runtime.hxx
===================================================================
RCS file: /cvs/script/basic/source/inc/runtime.hxx,v
retrieving revision 1.20
retrieving revision 1.19.16.2
diff -u -p -u -p -r1.20 -r1.19.16.2
--- basic/source/inc/runtime.hxx	28 Jan 2005 16:07:49 -0000	1.20
+++ basic/source/inc/runtime.hxx	9 Mar 2005 18:01:30 -0000	1.19.16.2
@@ -242,7 +242,7 @@ class SbiInstance
 	SvNumberFormatter* pNumberFormatter;
     LanguageType    meFormatterLangType;
     DateFormat      meFormatterDateFormat;
-	ULONG 			nStdDateIdx, nStdTimeIdx, nStdDateTimeIdx;
+	sal_uInt32 		nStdDateIdx, nStdTimeIdx, nStdDateTimeIdx;
 
 	SbError      	nErr;     		// aktueller Fehlercode
 	String		    aErrorMsg;		// letzte Error-Message fuer $ARG
@@ -292,13 +292,13 @@ public:
 	SbiRTLData* GetRTLData() const { return (SbiRTLData*)&aRTLData; }
 
 	SvNumberFormatter* GetNumberFormatter();
-	ULONG GetStdDateIdx() const { return nStdDateIdx; }
-	ULONG GetStdTimeIdx() const { return nStdTimeIdx; }
-	ULONG GetStdDateTimeIdx() const { return nStdDateTimeIdx; }
+	sal_uInt32 GetStdDateIdx() const { return nStdDateIdx; }
+	sal_uInt32 GetStdTimeIdx() const { return nStdTimeIdx; }
+	sal_uInt32 GetStdDateTimeIdx() const { return nStdDateTimeIdx; }
 
 	// #39629# NumberFormatter auch statisch anbieten
 	static void PrepareNumberFormatter( SvNumberFormatter*& rpNumberFormatter,
-		ULONG &rnStdDateIdx, ULONG &rnStdTimeIdx, ULONG &rnStdDateTimeIdx,
+		sal_uInt32 &rnStdDateIdx, sal_uInt32 &rnStdTimeIdx, sal_uInt32 &rnStdDateTimeIdx,
         LanguageType* peFormatterLangType=NULL, DateFormat* peFormatterDateFormat=NULL );
 };
 
Index: basic/source/runtime/dllmgr.cxx
===================================================================
RCS file: /cvs/script/basic/source/runtime/dllmgr.cxx,v
retrieving revision 1.4
retrieving revision 1.4.148.1
diff -u -p -u -p -r1.4 -r1.4.148.1
--- basic/source/runtime/dllmgr.cxx	22 May 2003 11:01:28 -0000	1.4
+++ basic/source/runtime/dllmgr.cxx	21 Jul 2004 18:22:07 -0000	1.4.148.1
@@ -460,8 +460,12 @@ SbError SbiDllMgr::CallProc( SbiDllProc 
 			break;
 
 		case SbxINT:
+			// SbxINT is aliased to SbxLONG internally now, but we
+			// may still need to use CallINT() rather than CallLONG()
+			// since CallINT() returns a 16-bit Integer (not sure why
+			// SbxINT sues that though...)
 			nInt = CallINT(pProc, pStack, (short)nSize );
-			rResult.PutInt( nInt );
+			rResult.PutLong( nInt );
 			break;
 
 		case SbxLONG:
Index: basic/source/runtime/methods.cxx
===================================================================
RCS file: /cvs/script/basic/source/runtime/methods.cxx,v
retrieving revision 1.59
retrieving revision 1.59.16.1
diff -u -p -u -p -r1.59 -r1.59.16.1
--- basic/source/runtime/methods.cxx	15 Nov 2004 16:36:55 -0000	1.59
+++ basic/source/runtime/methods.cxx	21 Jan 2005 16:01:25 -0000	1.59.16.1
@@ -1753,11 +1753,11 @@ RTLFUNC(DateValue)
 			pFormatter = pINST->GetNumberFormatter();
 		else
 		{
-			ULONG n;	// Dummy
+			sal_uInt32 n;	// Dummy
 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
 		}
 
-		ULONG nIndex;
+		sal_uInt32 nIndex;
 		double fResult;
 		String aStr( rPar.Get(1)->GetString() );
 		BOOL bSuccess = pFormatter->IsNumberFormat( aStr, nIndex, fResult );
@@ -1796,11 +1796,11 @@ RTLFUNC(TimeValue)
 			pFormatter = pINST->GetNumberFormatter();
 		else
 		{
-			ULONG n;	// Dummy
+			sal_uInt32 n;	// Dummy
 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, n );
 		}
 
-		ULONG nIndex;
+		sal_uInt32 nIndex;
 		double fResult;
 		BOOL bSuccess = pFormatter->IsNumberFormat( rPar.Get(1)->GetString(),
 												   nIndex, fResult );
@@ -1977,7 +1977,7 @@ RTLFUNC(Time)
 
 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
 			SvNumberFormatter* pFormatter = NULL;
-			ULONG nIndex;
+			sal_uInt32 nIndex;
 			if( pINST )
 			{
 				pFormatter = pINST->GetNumberFormatter();
@@ -1985,7 +1985,7 @@ RTLFUNC(Time)
 			}
 			else
 			{
-				ULONG n;	// Dummy
+				sal_uInt32 n;	// Dummy
 				SbiInstance::PrepareNumberFormatter( pFormatter, n, nIndex, n );
 			}
 
@@ -2028,7 +2028,7 @@ RTLFUNC(Date)
 
 			// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
 			SvNumberFormatter* pFormatter = NULL;
-			ULONG nIndex;
+			sal_uInt32 nIndex;
 			if( pINST )
 			{
 				pFormatter = pINST->GetNumberFormatter();
@@ -2036,7 +2036,7 @@ RTLFUNC(Date)
 			}
 			else
 			{
-				ULONG n;	// Dummy
+				sal_uInt32 n;	// Dummy
 				SbiInstance::PrepareNumberFormatter( pFormatter, nIndex, n, n );
 			}
 
@@ -2922,7 +2922,7 @@ RTLFUNC(FileDateTime)
 
 		// #39629 pINST pruefen, kann aus URL-Zeile gerufen werden
 		SvNumberFormatter* pFormatter = NULL;
-		ULONG nIndex;
+		sal_uInt32 nIndex;
 		if( pINST )
 		{
 			pFormatter = pINST->GetNumberFormatter();
@@ -2930,7 +2930,7 @@ RTLFUNC(FileDateTime)
 		}
 		else
 		{
-			ULONG n;	// Dummy
+			sal_uInt32 n;	// Dummy
 			SbiInstance::PrepareNumberFormatter( pFormatter, n, n, nIndex );
 		}
 
Index: basic/source/runtime/runtime.cxx
===================================================================
RCS file: /cvs/script/basic/source/runtime/runtime.cxx,v
retrieving revision 1.20
retrieving revision 1.19.16.2
diff -u -p -u -p -r1.20 -r1.19.16.2
--- basic/source/runtime/runtime.cxx	28 Jan 2005 16:09:07 -0000	1.20
+++ basic/source/runtime/runtime.cxx	9 Mar 2005 18:04:13 -0000	1.19.16.2
@@ -368,7 +368,7 @@ SvNumberFormatter* SbiInstance::GetNumbe
 
 // #39629 NumberFormatter auch statisch anbieten
 void SbiInstance::PrepareNumberFormatter( SvNumberFormatter*& rpNumberFormatter,
-	ULONG &rnStdDateIdx, ULONG &rnStdTimeIdx, ULONG &rnStdDateTimeIdx,
+	sal_uInt32 &rnStdDateIdx, sal_uInt32 &rnStdTimeIdx, sal_uInt32 &rnStdDateTimeIdx,
     LanguageType* peFormatterLangType, DateFormat* peFormatterDateFormat )
 {
 	com::sun::star::uno::Reference< com::sun::star::lang::XMultiServiceFactory > 
Index: xmloff/inc/xmlehelp.hxx
===================================================================
RCS file: /cvs/xml/xmloff/inc/xmlehelp.hxx,v
retrieving revision 1.3
retrieving revision 1.3.352.1
diff -u -p -u -p -r1.3 -r1.3.352.1
--- xmloff/inc/xmlehelp.hxx	21 Mar 2001 16:49:06 -0000	1.3
+++ xmloff/inc/xmlehelp.hxx	21 Jul 2004 19:27:00 -0000	1.3.352.1
@@ -71,10 +71,10 @@ namespace rtl { class OUStringBuffer; }
 class SvXMLExportHelper
 {
 public:
-	static void AddLength( long nValue, MapUnit eValueUnit,
+	static void AddLength( sal_Int32 nValue, MapUnit eValueUnit,
 						   ::rtl::OUStringBuffer& rOut,
 						   MapUnit eOutUnit );
-	static void AddPercentage( long nVal, ::rtl::OUStringBuffer& rOut );
+	static void AddPercentage( sal_Int32 nVal, ::rtl::OUStringBuffer& rOut );
 	static double GetConversionFactor(::rtl::OUStringBuffer& rUnit, 
 		const MapUnit eCoreUnit, const MapUnit eDestUnit);
 	static MapUnit GetUnitFromString(const ::rtl::OUString& rString, 
Index: xmloff/source/core/xmlehelp.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/core/xmlehelp.cxx,v
retrieving revision 1.7
retrieving revision 1.6.346.2
diff -u -p -u -p -r1.7 -r1.6.346.2
--- xmloff/source/core/xmlehelp.cxx	13 Jul 2004 08:06:29 -0000	1.7
+++ xmloff/source/core/xmlehelp.cxx	20 Oct 2004 10:24:28 -0000	1.6.346.2
@@ -83,7 +83,7 @@
 using namespace ::rtl;
 using namespace ::xmloff::token;
 
-void SvXMLExportHelper::AddLength( long nValue, MapUnit eValueUnit,
+void SvXMLExportHelper::AddLength( sal_Int32 nValue, MapUnit eValueUnit,
 		   			  	   		   OUStringBuffer& rOut,
 								   MapUnit eOutUnit )
 {
@@ -95,9 +95,9 @@ void SvXMLExportHelper::AddLength( long 
 	}
 	
 	// The new length is (nVal * nMul)/(nDiv*nFac*10)
-	long nMul = 1000;
-	long nDiv = 1;
-	long nFac = 100;
+	sal_Int32 nMul = 1000;
+	sal_Int32 nDiv = 1;
+	sal_Int32 nFac = 100;
 	enum XMLTokenEnum eUnit = XML_TOKEN_INVALID;
 	switch( eValueUnit )
 	{
@@ -201,7 +201,7 @@ void SvXMLExportHelper::AddLength( long 
 	}
 
 
-	long nLongVal;
+	sal_Int32 nLongVal;
 	BOOL bOutLongVal = TRUE;
 	if( nValue > LONG_MAX / nMul )
 	{
@@ -215,8 +215,8 @@ void SvXMLExportHelper::AddLength( long 
 
 		if( nBigVal.IsLong() )
 		{
-			// To convert the value into a string a long is sufficient
-			nLongVal = (long)nBigVal;
+			// To convert the value into a string a sal_Int32 is sufficient
+			nLongVal = (sal_Int32)nBigVal;
 		}
 		else
 		{
@@ -262,7 +262,7 @@ void SvXMLExportHelper::AddLength( long 
 		rOut.append( GetXMLToken(eUnit) );
 #if 0
 	enum XMLTokenEnum eUnit;
-	long nFac = 1;
+	sal_Int32 nFac = 1;
 	switch( eOutUnit )
 	{
 	case MAP_100TH_MM:
@@ -338,7 +338,7 @@ void SvXMLExportHelper::AddLength( long 
 
 }
 
-void SvXMLExportHelper::AddPercentage( long nValue, OUStringBuffer& rOut )
+void SvXMLExportHelper::AddPercentage( sal_Int32 nValue, OUStringBuffer& rOut )
 {
 	rOut.append( nValue );
 	rOut.append( sal_Unicode('%' ) );
Index: xmloff/source/style/XMLBackgroundImageContext.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/XMLBackgroundImageContext.cxx,v
retrieving revision 1.10
retrieving revision 1.9.320.2
diff -u -p -u -p -r1.10 -r1.9.320.2
--- xmloff/source/style/XMLBackgroundImageContext.cxx	13 Jul 2004 08:22:00 -0000	1.10
+++ xmloff/source/style/XMLBackgroundImageContext.cxx	20 Oct 2004 11:06:49 -0000	1.9.320.2
@@ -273,7 +273,7 @@ void XMLBackgroundImageContext::ProcessA
 					}
 					else if( -1 != aToken.indexOf( sal_Unicode('%') ) )
 					{
-						long nPrc = 50;
+						sal_Int32 nPrc = 50;
 						if( rUnitConverter.convertPercent( nPrc, aToken ) )
 						{
 							if( !bHori )
Index: xmloff/source/style/XMLFontAutoStylePool.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/XMLFontAutoStylePool.cxx,v
retrieving revision 1.4
retrieving revision 1.4.86.1
diff -u -p -u -p -r1.4 -r1.4.86.1
--- xmloff/source/style/XMLFontAutoStylePool.cxx	13 Jul 2004 08:22:31 -0000	1.4
+++ xmloff/source/style/XMLFontAutoStylePool.cxx	21 Jan 2005 15:12:55 -0000	1.4.86.1
@@ -221,7 +221,7 @@ OUString XMLFontAutoStylePool::Add(
 	OUString sName;
 	XMLFontAutoStylePoolEntry_Impl aTmp( rFamilyName, rStyleName, nFamily,
 									 	 nPitch, eEnc );
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( pPool->Seek_Entry( &aTmp, &nPos ) )
 	{
 		sName = pPool->GetObject( nPos )->GetName();
@@ -275,7 +275,7 @@ OUString XMLFontAutoStylePool::Add(
 	OUString sName;
 	XMLFontAutoStylePoolEntry_Impl aTmp( rFamilyName, rStyleName, nFamily,
 									 	 nPitch, eEnc );
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( pPool->Seek_Entry( &aTmp, &nPos ) )
 	{
 		sName = pPool->GetObject( nPos )->GetName();
@@ -291,6 +291,7 @@ void XMLFontAutoStylePool::exportXML()
 							  XML_FONT_FACE_DECLS,
 							  sal_True, sal_True );
 	Any aAny;
+
 	OUString sTmp;
 	XMLFontFamilyNamePropHdl aFamilyNameHdl;
 	XMLFontFamilyPropHdl aFamilyHdl;
Index: xmloff/source/style/backhdl.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/backhdl.cxx,v
retrieving revision 1.3
retrieving revision 1.3.346.1
diff -u -p -u -p -r1.3 -r1.3.346.1
--- xmloff/source/style/backhdl.cxx	29 Jun 2001 21:07:17 -0000	1.3
+++ xmloff/source/style/backhdl.cxx	21 Jul 2004 19:27:02 -0000	1.3.346.1
@@ -132,7 +132,7 @@ sal_Bool XMLBackGraphicPositionPropHdl::
 		}
 		else if( -1 != aToken.indexOf( sal_Unicode('%') ) )
 		{
-			long nPrc = 50;
+			sal_Int32 nPrc = 50;
 			if( rUnitConverter.convertPercent( nPrc, aToken ) )
 			{
 				if( !bHori )
Index: xmloff/source/style/bordrhdl.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/bordrhdl.cxx,v
retrieving revision 1.4
retrieving revision 1.4.336.1
diff -u -p -u -p -r1.4 -r1.4.336.1
--- xmloff/source/style/bordrhdl.cxx	7 Dec 2001 13:14:53 -0000	1.4
+++ xmloff/source/style/bordrhdl.cxx	21 Jul 2004 19:27:02 -0000	1.4.336.1
@@ -380,7 +380,7 @@ sal_Bool XMLBorderHdl::importXML( const 
 	sal_uInt16 nNamedWidth = USHRT_MAX;
 	Color aColor;
 
-	long nTemp;
+	sal_Int32 nTemp;
 	while( aTokens.getNextToken( aToken ) && aToken.getLength() != 0 )
 	{
 		if( !bHasWidth &&
Index: xmloff/source/style/impastp4.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/impastp4.cxx,v
retrieving revision 1.14
retrieving revision 1.12.162.4
diff -u -p -u -p -r1.14 -r1.12.162.4
--- xmloff/source/style/impastp4.cxx	5 Jan 2005 11:36:18 -0000	1.14
+++ xmloff/source/style/impastp4.cxx	21 Jan 2005 15:12:40 -0000	1.12.162.4
@@ -135,7 +135,7 @@ void SvXMLAutoStylePoolP_Impl::AddFamily
 		sal_Bool bAsFamily )
 {
 	// store family in a list if not already stored
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl *pFamily = new XMLFamilyData_Impl( nFamily, rStrName, rMapper, rStrPrefix, bAsFamily );
 	if( !maFamilyList.Seek_Entry( pFamily, &nPos ) )
 		maFamilyList.Insert( pFamily );
@@ -152,7 +152,7 @@ void SvXMLAutoStylePoolP_Impl::RegisterN
 {
 	SvXMLAutoStylePoolNamesP_Impl *pNames = 0;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
 		pNames = maFamilyList.GetObject( nPos )->mpNameList;
@@ -222,7 +222,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
 				sal_Bool bCache)
 {
 	sal_Bool bRet(sal_False);
-	sal_uInt32 nPos;
+	ULONG nPos;
 
 	XMLFamilyData_Impl *pFamily = 0;
 	XMLFamilyData_Impl aTmp( nFamily );
@@ -270,7 +270,7 @@ sal_Bool SvXMLAutoStylePoolP_Impl::Add(O
 OUString SvXMLAutoStylePoolP_Impl::AddToCache( sal_Int32 nFamily,
 							 		    const OUString& rParent )
 {
-	sal_uInt32 nPos;
+	ULONG nPos;
 
 	XMLFamilyData_Impl *pFamily = 0;
 	XMLFamilyData_Impl aTmp( nFamily );
@@ -302,7 +302,7 @@ OUString SvXMLAutoStylePoolP_Impl::Find(
 {
 	OUString sName;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
@@ -329,7 +329,7 @@ OUString SvXMLAutoStylePoolP_Impl::FindA
 {
 	OUString sName;
 
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
@@ -371,7 +371,7 @@ void SvXMLAutoStylePoolP_Impl::exportXML
 	sal_uInt32 nCount = 0;
 
 	// Get list of parents for current family (nFamily)
-	sal_uInt32 nPos;
+	ULONG nPos;
 	XMLFamilyData_Impl aTmp( nFamily );
 	XMLFamilyData_Impl *pFamily = 0;
 	if( maFamilyList.Seek_Entry( &aTmp, &nPos ) )
Index: xmloff/source/style/xmlnume.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/xmlnume.cxx,v
retrieving revision 1.22
retrieving revision 1.20.44.3
diff -u -p -u -p -r1.22 -r1.20.44.3
--- xmloff/source/style/xmlnume.cxx	26 Nov 2004 13:04:39 -0000	1.22
+++ xmloff/source/style/xmlnume.cxx	18 Jan 2005 12:20:52 -0000	1.20.44.3
@@ -326,7 +326,7 @@ void SvxXMLNumRuleExport::exportLevelSty
 	
 	// text:level
 	OUStringBuffer sTmp;
-	sTmp.append( nLevel+1L );
+	sTmp.append( nLevel+1 );
 	GetExport().AddAttribute( XML_NAMESPACE_TEXT, XML_LEVEL, sTmp.makeStringAndClear() );
 	if( sTextStyleName.getLength() > 0 )
 		GetExport().AddAttribute( XML_NAMESPACE_TEXT, XML_STYLE_NAME, 
Index: xmloff/source/style/xmlnumfe.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/xmlnumfe.cxx,v
retrieving revision 1.40
retrieving revision 1.40.68.1
diff -u -p -u -p -r1.40 -r1.40.68.1
--- xmloff/source/style/xmlnumfe.cxx	9 Nov 2004 11:44:03 -0000	1.40
+++ xmloff/source/style/xmlnumfe.cxx	21 Jan 2005 15:13:09 -0000	1.40.68.1
@@ -1811,7 +1811,7 @@ const SvNumberformat* lcl_GetFormat( SvN
 
 sal_uInt32 SvXMLNumFmtExport::ForceSystemLanguage( sal_uInt32 nKey )
 {
-    sal_uInt32 nRet = nKey;
+    ULONG nRet = nKey;
 
     const SvNumberformat* pFormat = lcl_GetFormat( pFormatter, nKey );
     if( pFormat != NULL )
Index: xmloff/source/style/xmlstyle.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/style/xmlstyle.cxx,v
retrieving revision 1.35
retrieving revision 1.32.130.4
diff -u -p -u -p -r1.35 -r1.32.130.4
--- xmloff/source/style/xmlstyle.cxx	26 Nov 2004 13:04:53 -0000	1.35
+++ xmloff/source/style/xmlstyle.cxx	21 Jan 2005 15:13:36 -0000	1.32.130.4
@@ -475,7 +475,7 @@ const SvXMLStyleContext *SvXMLStylesCont
 	if( pIndices )
 	{
 		SvXMLStyleIndex_Impl aIndex( nFamily, rName );
-		sal_uInt32 nPos = 0;
+		ULONG nPos = 0;
 		if( pIndices->Seek_Entry( &aIndex, &nPos ) )
 			pStyle = pIndices->GetObject( nPos )->GetStyle();
 	}
Index: xmloff/source/text/XMLSectionExport.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/text/XMLSectionExport.cxx,v
retrieving revision 1.37
retrieving revision 1.35.36.2
diff -u -p -u -p -r1.37 -r1.35.36.2
--- xmloff/source/text/XMLSectionExport.cxx	8 Sep 2004 15:00:38 -0000	1.37
+++ xmloff/source/text/XMLSectionExport.cxx	20 Oct 2004 10:30:44 -0000	1.35.36.2
@@ -1934,7 +1934,7 @@ void XMLSectionExport::ExportMasterDocHe
 									  GetExport().EncodeStyleName( sStyle ) );
 
 			OUStringBuffer sTmp;
-			sTmp.append( nLevel+1L );
+			sTmp.append( nLevel+1 );
 			GetExport().AddAttribute( XML_NAMESPACE_TEXT, XML_LEVEL,
 								  	  sTmp.makeStringAndClear() );
 			SvXMLElementExport aElem( GetExport(), XML_NAMESPACE_TEXT, XML_H,
Index: xmloff/source/text/XMLTextListAutoStylePool.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/text/XMLTextListAutoStylePool.cxx,v
retrieving revision 1.4
retrieving revision 1.4.242.1
diff -u -p -u -p -r1.4 -r1.4.242.1
--- xmloff/source/text/XMLTextListAutoStylePool.cxx	8 Apr 2003 15:30:28 -0000	1.4
+++ xmloff/source/text/XMLTextListAutoStylePool.cxx	21 Jan 2005 15:13:50 -0000	1.4.242.1
@@ -251,7 +251,7 @@ sal_Bool XMLTextListAutoStylePool::HasNa
 
 sal_uInt32 XMLTextListAutoStylePool::Find( XMLTextListAutoStylePoolEntry_Impl* pEntry ) const
 {
-	sal_uInt32 nPos;
+	ULONG nPos;
 	if( !pEntry->IsNamed() && mxNumRuleCompare.is() )
 	{
 		const sal_uInt32 nCount = pPool->Count();
Index: xmloff/source/text/txtparae.cxx
===================================================================
RCS file: /cvs/xml/xmloff/source/text/txtparae.cxx,v
retrieving revision 1.120
retrieving revision 1.112.12.4
diff -u -p -u -p -r1.120 -r1.112.12.4
--- xmloff/source/text/txtparae.cxx	22 Feb 2005 09:59:18 -0000	1.120
+++ xmloff/source/text/txtparae.cxx	10 Mar 2005 02:55:48 -0000	1.112.12.4
@@ -1767,7 +1767,7 @@ void XMLTextParagraphExport::exportParag
 				if( -1 != nOutlineLevel )
 				{
 					OUStringBuffer sTmp;
-					sTmp.append( (sal_Int32)nOutlineLevel+1L );
+					sTmp.append( (sal_Int32)nOutlineLevel+1 );
 					GetExport().AddAttribute( XML_NAMESPACE_TEXT,
 											  XML_OUTLINE_LEVEL,
 								  sTmp.makeStringAndClear() );
cvs diff: cannot open CVS/Entries for reading: No such file or directory
cvs [diff aborted]: no repository
Index: vcl/inc/bitmap.hxx
===================================================================
RCS file: /cvs/gsl/vcl/inc/bitmap.hxx,v
retrieving revision 1.14
retrieving revision 1.13.14.2
diff -u -p -u -p -r1.14 -r1.13.14.2
--- vcl/inc/bitmap.hxx	13 Jan 2005 17:26:04 -0000	1.14
+++ vcl/inc/bitmap.hxx	10 Mar 2005 02:24:40 -0000	1.13.14.2
@@ -305,7 +305,7 @@ public:
     SAL_DLLPRIVATE static BOOL          ImplWriteDIBFileHeader( SvStream& rOStm, BitmapReadAccess& rAcc );
     SAL_DLLPRIVATE static BOOL          ImplWriteDIBPalette( SvStream& rOStm, BitmapReadAccess& rAcc );
     SAL_DLLPRIVATE static BOOL          ImplWriteDIBBits( SvStream& rOStm, BitmapReadAccess& rAcc,
-                                                             ULONG nCompression, ULONG& rImageSize );
+                                                             ULONG nCompression, sal_uInt32& rImageSize );
     SAL_DLLPRIVATE static void          ImplDecodeRLE( BYTE* pBuffer, DIBInfoHeader& rHeader,
                                            BitmapWriteAccess& rAcc, BOOL bRLE4 );
     SAL_DLLPRIVATE static BOOL          ImplWriteRLE( SvStream& rOStm, BitmapReadAccess& rAcc, BOOL bRLE4 );
Index: vcl/inc/dockwin.hxx
===================================================================
RCS file: /cvs/gsl/vcl/inc/dockwin.hxx,v
retrieving revision 1.9
retrieving revision 1.8.40.2
diff -u -p -u -p -r1.9 -r1.8.40.2
--- vcl/inc/dockwin.hxx	13 Jan 2005 17:30:41 -0000	1.9
+++ vcl/inc/dockwin.hxx	10 Mar 2005 02:17:23 -0000	1.8.40.2
@@ -140,10 +140,10 @@ private:
 	long			mnTrackY;
 	long			mnTrackWidth;
 	long			mnTrackHeight;
-	long			mnDockLeft;
-	long			mnDockTop;
-	long			mnDockRight;
-	long			mnDockBottom;
+	sal_Int32		mnDockLeft;
+	sal_Int32		mnDockTop;
+	sal_Int32		mnDockRight;
+	sal_Int32		mnDockBottom;
 	WinBits 		mnFloatBits;
 	BOOL			mbDockCanceled:1,
 					mbFloatPrevented:1,
Index: vcl/inc/imgcons.hxx
===================================================================
RCS file: /cvs/gsl/vcl/inc/imgcons.hxx,v
retrieving revision 1.3
retrieving revision 1.2.144.2
diff -u -p -u -p -r1.3 -r1.2.144.2
--- vcl/inc/imgcons.hxx	13 Jan 2005 17:36:46 -0000	1.3
+++ vcl/inc/imgcons.hxx	10 Mar 2005 02:09:00 -0000	1.2.144.2
@@ -94,8 +94,8 @@ private:
 	Color*				mpPal;
 	Link				maChgLink;
 	Link				maDoneLink;
-	ULONG				mnFormat;
-	ULONG				mnStatus;
+	sal_uInt32			mnFormat;
+	sal_uInt32			mnStatus;
 	BOOL				mbTrans;
 						
 protected:				
@@ -110,7 +110,7 @@ public:					
 	BOOL				GetData( BitmapEx& rBmpEx ) const;
 	BOOL				GetData( Image& rImage ) const;
 	const Rectangle&	GetChangedRect() const { return maChangedRect; }
-	ULONG				GetStatus() const;
+	sal_uInt32			GetStatus() const;
 						
 	void				SetDataChangedLink( const Link& rLink ) { maChgLink = rLink; }
 	const Link&			GetDataChangedLink() const { return maChgLink; }
@@ -120,22 +120,22 @@ public:					
 
 public:
 
-	virtual void		Init( ULONG nWidth, ULONG nHeight );
+	virtual void		Init( sal_uInt32 nWidth, sal_uInt32 nHeight );
 
 	virtual void		SetColorModel( USHORT nBitCount,
-									   ULONG nPalEntries, const ULONG* pRGBAPal, 
-									   ULONG nRMask, ULONG nGMask, ULONG nBMask, ULONG nAMask  );
+									   sal_uInt32 nPalEntries, const sal_uInt32* pRGBAPal, 
+									   sal_uInt32 nRMask, sal_uInt32 nGMask, sal_uInt32 nBMask, sal_uInt32 nAMask  );
 						
-	virtual	void		SetPixelsByBytes( ULONG nConsX, ULONG nConsY, 
-										  ULONG nConsWidth, ULONG nConsHeight,
-										  const BYTE* pProducerData, ULONG nOffset, ULONG nScanSize );
-						
-	virtual	void		SetPixelsByLongs( ULONG nConsX, ULONG nConsY, 
-										  ULONG nConsWidth, ULONG nConsHeight,
-										  const ULONG* pProducerData, ULONG nOffset, ULONG nScanSize );
+	virtual	void		SetPixelsByBytes( sal_uInt32 nConsX, sal_uInt32 nConsY, 
+										  sal_uInt32 nConsWidth, sal_uInt32 nConsHeight,
+										  const BYTE* pProducerData, sal_uInt32 nOffset, sal_uInt32 nScanSize );
+						
+	virtual	void		SetPixelsByLongs( sal_uInt32 nConsX, sal_uInt32 nConsY, 
+										  sal_uInt32 nConsWidth, sal_uInt32 nConsHeight,
+										  const sal_uInt32* pProducerData, sal_uInt32 nOffset, sal_uInt32 nScanSize );
 						
-	virtual void		Completed( ULONG nStatus );
-//	virtual void		Completed( ULONG nStatus, ImageProducer& rProducer );
+	virtual void		Completed( sal_uInt32 nStatus );
+//	virtual void		Completed( sal_uInt32 nStatus, ImageProducer& rProducer );
 };
 
 #endif // _IMGCONS_HXX
Index: vcl/source/app/dbggui.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/app/dbggui.cxx,v
retrieving revision 1.18
retrieving revision 1.16.68.3
diff -u -p -u -p -r1.18 -r1.16.68.3
--- vcl/source/app/dbggui.cxx	31 Jan 2005 13:20:50 -0000	1.18
+++ vcl/source/app/dbggui.cxx	10 Mar 2005 02:37:48 -0000	1.16.68.3
@@ -60,12 +60,11 @@
  ************************************************************************/
 
 
-
 #ifdef DBG_UTIL
 
 #include "svdata.hxx"
-#include <cstdio>
-#include <cstring>
+#include <stdio.h>
+#include <string.h>
 #include <limits.h>
 #include <svsys.h>
 
Index: vcl/source/control/ilstbox.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/control/ilstbox.cxx,v
retrieving revision 1.50
retrieving revision 1.47.6.3
diff -u -p -u -p -r1.50 -r1.47.6.3
--- vcl/source/control/ilstbox.cxx	26 Nov 2004 20:41:57 -0000	1.50
+++ vcl/source/control/ilstbox.cxx	18 Jan 2005 17:36:18 -0000	1.47.6.3
@@ -2662,7 +2662,7 @@ void ImplWin::ImplDraw( bool bLayout )
 	        // The listbox is painted over the entire control including the
 	        // border, but ImplWin does not contain the border => correction
 	        // needed.
-	        long nLeft, nTop, nRight, nBottom;
+	        sal_Int32 nLeft, nTop, nRight, nBottom;
 	        pWin->GetBorder( nLeft, nTop, nRight, nBottom );
 	        Point aPoint( -nLeft, -nTop );
 	        Region aCtrlRegion( Rectangle( aPoint - GetPosPixel(), pWin->GetSizePixel() ) );
Index: vcl/source/gdi/bitmap2.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/gdi/bitmap2.cxx,v
retrieving revision 1.6
retrieving revision 1.6.6.1
diff -u -p -u -p -r1.6 -r1.6.6.1
--- vcl/source/gdi/bitmap2.cxx	17 Jun 2004 12:14:50 -0000	1.6
+++ vcl/source/gdi/bitmap2.cxx	10 Sep 2004 15:33:33 -0000	1.6.6.1
@@ -870,7 +870,7 @@ BOOL Bitmap::ImplWriteDIBPalette( SvStre
 // ------------------------------------------------------------------
 
 BOOL Bitmap::ImplWriteDIBBits( SvStream& rOStm, BitmapReadAccess& rAcc,
-							   ULONG nCompression, ULONG& rImageSize )
+							   ULONG nCompression, sal_uInt32& rImageSize )
 {
 	if( BITFIELDS == nCompression )
 	{
Index: vcl/source/gdi/imgcons.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/gdi/imgcons.cxx,v
retrieving revision 1.3
retrieving revision 1.3.144.1
diff -u -p -u -p -r1.3 -r1.3.144.1
--- vcl/source/gdi/imgcons.cxx	6 Jan 2004 13:41:30 -0000	1.3
+++ vcl/source/gdi/imgcons.cxx	14 Sep 2004 18:06:33 -0000	1.3.144.1
@@ -160,7 +160,7 @@ ImageConsumer::~ImageConsumer()
 
 // -----------------------------------------------------------------------------
 
-void ImageConsumer::Init( ULONG nWidth, ULONG nHeight )
+void ImageConsumer::Init( sal_uInt32 nWidth, sal_uInt32 nHeight )
 {
 	maSize = Size( nWidth, nHeight );
 	maBitmap = maMask = Bitmap();
@@ -171,8 +171,8 @@ void ImageConsumer::Init( ULONG nWidth, 
 // -----------------------------------------------------------------------------
 
 void ImageConsumer::SetColorModel( USHORT nBitCount,
-								   ULONG nPalEntries, const ULONG* pRGBAPal, 
-								   ULONG nRMask, ULONG nGMask, ULONG nBMask, ULONG nAMask )
+								   sal_uInt32 nPalEntries, const sal_uInt32* pRGBAPal, 
+								   sal_uInt32 nRMask, sal_uInt32 nGMask, sal_uInt32 nBMask, sal_uInt32 nAMask )
 {
 	DBG_ASSERT( maSize.Width() && maSize.Height(), "Missing call to ImageConsumer::Init(...)!" );
 
@@ -247,9 +247,9 @@ void ImageConsumer::SetColorModel( USHOR
 
 // -----------------------------------------------------------------------------
 
-void ImageConsumer::SetPixelsByBytes( ULONG nConsX, ULONG nConsY,
-									  ULONG nConsWidth, ULONG nConsHeight,
-									  const BYTE* pData, ULONG nOffset, ULONG nScanSize )
+void ImageConsumer::SetPixelsByBytes( sal_uInt32 nConsX, sal_uInt32 nConsY,
+									  sal_uInt32 nConsWidth, sal_uInt32 nConsHeight,
+									  const BYTE* pData, sal_uInt32 nOffset, sal_uInt32 nScanSize )
 {
 	DBG_ASSERT( !!maBitmap && !!maMask, "Missing call to ImageConsumer::SetColorModel(...)!" );
 
@@ -384,9 +384,9 @@ void ImageConsumer::SetPixelsByBytes( UL
 
 // -----------------------------------------------------------------------------
 
-void ImageConsumer::SetPixelsByLongs( ULONG nConsX, ULONG nConsY, 
-									  ULONG nConsWidth, ULONG nConsHeight,
-									  const ULONG* pData, ULONG nOffset, ULONG nScanSize )
+void ImageConsumer::SetPixelsByLongs( sal_uInt32 nConsX, sal_uInt32 nConsY, 
+									  sal_uInt32 nConsWidth, sal_uInt32 nConsHeight,
+									  const sal_uInt32* pData, sal_uInt32 nOffset, sal_uInt32 nScanSize )
 {
 	DBG_ASSERT( !!maBitmap && !!maMask, "Missing call to ImageConsumer::SetColorModel(...)!" );
 
@@ -521,7 +521,7 @@ void ImageConsumer::SetPixelsByLongs( UL
 
 // -----------------------------------------------------------------------------
 
-void ImageConsumer::Completed( ULONG nStatus /*, ImageProducer& rProducer */ )
+void ImageConsumer::Completed( sal_uInt32 nStatus /*, ImageProducer& rProducer */ )
 {
 	delete mpMapper;
 	mpMapper = NULL;
@@ -565,7 +565,7 @@ void ImageConsumer::DataChanged()
 
 // -----------------------------------------------------------------------------
 
-ULONG ImageConsumer::GetStatus() const
+sal_uInt32 ImageConsumer::GetStatus() const
 {
 	return mnStatus;
 }
Index: vcl/source/gdi/pdfwriter_impl.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/gdi/pdfwriter_impl.cxx,v
retrieving revision 1.78
retrieving revision 1.75.50.2
diff -u -p -u -p -r1.78 -r1.75.50.2
--- vcl/source/gdi/pdfwriter_impl.cxx	31 Jan 2005 13:23:40 -0000	1.78
+++ vcl/source/gdi/pdfwriter_impl.cxx	10 Mar 2005 02:39:04 -0000	1.75.50.2
@@ -3497,7 +3497,7 @@ void PDFWriterImpl::createDefaultPushBut
     OStringBuffer aDA( 256 );
     appendNonStrokingColor( replaceColor( rWidget.TextColor, rSettings.GetButtonTextColor() ), aDA );
     aDA.append( " /HelvReg " );
-    m_aPages[m_nCurrentPage].appendMappedLength( aFont.GetHeight(), aDA );
+    m_aPages[m_nCurrentPage].appendMappedLength( (sal_Int32)aFont.GetHeight(), aDA );
     aDA.append( " Tf" );
     rButton.m_aDAString = aDA.makeStringAndClear();
 
@@ -3554,7 +3554,7 @@ void PDFWriterImpl::createDefaultEditApp
     OStringBuffer aDA( 32 );
     appendNonStrokingColor( replaceColor( rWidget.TextColor, rSettings.GetFieldTextColor() ), aDA );
     aDA.append( " /HelvReg " );
-    m_aPages[ m_nCurrentPage ].appendMappedLength( aFont.GetHeight(), aDA );
+    m_aPages[ m_nCurrentPage ].appendMappedLength( (sal_Int32)aFont.GetHeight(), aDA );
     aDA.append( " Tf" );
 
     /*  create an empty appearance stream, let the viewer create
@@ -3655,7 +3655,7 @@ void PDFWriterImpl::createDefaultListBox
 #endif
     appendNonStrokingColor( replaceColor( rWidget.TextColor, rSettings.GetFieldTextColor() ), aDA );
     aDA.append( " /HelvReg " );
-    m_aPages[ m_nCurrentPage ].appendMappedLength( aFont.GetHeight(), aDA );
+    m_aPages[ m_nCurrentPage ].appendMappedLength( (sal_Int32)aFont.GetHeight(), aDA );
     aDA.append( " Tf" );
     rBox.m_aDAString = aDA.makeStringAndClear();
 }
@@ -3743,7 +3743,7 @@ void PDFWriterImpl::createDefaultCheckBo
     aDA.append( "/Tx BMC\r\nq BT\r\n" );
     appendNonStrokingColor( replaceColor( rWidget.TextColor, rSettings.GetRadioCheckTextColor() ), aDA );
     aDA.append( " /ZaDb " );
-    m_aPages[ m_nCurrentPage ].appendMappedLength( aCheckRect.GetHeight(), aDA );
+    m_aPages[ m_nCurrentPage ].appendMappedLength( (sal_Int32)aCheckRect.GetHeight(), aDA );
     aDA.append( " Tf\r\n" );
     m_aPages[ m_nCurrentPage ].appendMappedLength( nCharXOffset, aDA );
     aDA.append( " " );
@@ -3838,7 +3838,7 @@ void PDFWriterImpl::createDefaultRadioBu
     aDA.append( "/Tx BMC\r\nq BT\r\n" );
     appendNonStrokingColor( replaceColor( rWidget.TextColor, rSettings.GetRadioCheckTextColor() ), aDA );
     aDA.append( " /ZaDb " );
-    m_aPages[m_nCurrentPage].appendMappedLength( aCheckRect.GetHeight(), aDA );
+    m_aPages[m_nCurrentPage].appendMappedLength( (sal_Int32)aCheckRect.GetHeight(), aDA );
     aDA.append( " Tf\r\n0 0 Td\r\nET\r\nQ\r\n" );
     writeBuffer( aDA.getStr(), aDA.getLength() );
     setFillColor( replaceColor( rWidget.TextColor, rSettings.GetRadioCheckTextColor() ) );
Index: vcl/source/gdi/pngwrite.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/gdi/pngwrite.cxx,v
retrieving revision 1.4
retrieving revision 1.3.6.2
diff -u -p -u -p -r1.4 -r1.3.6.2
--- vcl/source/gdi/pngwrite.cxx	28 Jun 2004 16:23:56 -0000	1.4
+++ vcl/source/gdi/pngwrite.cxx	20 Oct 2004 09:48:49 -0000	1.3.6.2
@@ -149,7 +149,7 @@ private:
 	void				ImplWritePalette();
 	void				ImplOpenChunk( ULONG nChunkType );
 	void				ImplWriteChunk( BYTE nNumb );
-	void				ImplWriteChunk( ULONG nNumb );
+	void				ImplWriteChunk( sal_uInt32 nNumb );
 	void				ImplWriteChunk( unsigned char* pSource, sal_uInt32 nDatSize );
 	void				ImplCloseChunk( void );
 };
@@ -331,8 +331,8 @@ std::vector< vcl::PNGWriter::ChunkData >
 BOOL PNGWriterImpl::ImplWriteHeader()
 {
 	ImplOpenChunk(PNGCHUNK_IHDR);
-	ImplWriteChunk( ( mnWidth = (ULONG)mpAccess->Width() ) );
-	ImplWriteChunk( ( mnHeight = (ULONG)mpAccess->Height() ) );
+	ImplWriteChunk( (sal_uInt32)( mnWidth =  mpAccess->Width() ) );
+	ImplWriteChunk( (sal_uInt32)( mnHeight = mpAccess->Height() ) );
 
 	if ( mnWidth && mnHeight && mnBitsPerPixel && mbStatus )
 	{
@@ -689,7 +689,7 @@ void PNGWriterImpl::ImplWriteChunk ( BYT
 	maChunkSeq.back().aData.push_back( nSource );
 }
 
-void PNGWriterImpl::ImplWriteChunk ( ULONG nSource )
+void PNGWriterImpl::ImplWriteChunk ( sal_uInt32 nSource )
 {
 	vcl::PNGWriter::ChunkData& rChunkData = maChunkSeq.back();
 	rChunkData.aData.push_back( (sal_uInt8)( nSource >> 24 ) );
Index: vcl/source/window/dockmgr.cxx
===================================================================
RCS file: /cvs/gsl/vcl/source/window/dockmgr.cxx,v
retrieving revision 1.10
retrieving revision 1.4.40.4
diff -u -p -u -p -r1.10 -r1.4.40.4
--- vcl/source/window/dockmgr.cxx	31 Jan 2005 13:25:12 -0000	1.10
+++ vcl/source/window/dockmgr.cxx	10 Mar 2005 02:45:01 -0000	1.4.40.4
@@ -241,7 +241,7 @@ IMPL_LINK( ImplDockFloatWin2, DockingHdl
         {
             Point aPt;
             Rectangle aBorderRect( aPt, pBorder->GetSizePixel() );
-            long nLeft, nTop, nRight, nBottom;
+            sal_Int32 nLeft, nTop, nRight, nBottom;
             GetBorder( nLeft, nTop, nRight, nBottom );
             // limit borderrect to the caption part only and without the resizing borders
             aBorderRect.nBottom = aBorderRect.nTop + nTop;
Index: vcl/unx/gtk/gdi/salnativewidgets-gtk.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/gtk/gdi/salnativewidgets-gtk.cxx,v
retrieving revision 1.10
retrieving revision 1.2.48.4
diff -u -p -u -p -r1.10 -r1.2.48.4
--- vcl/unx/gtk/gdi/salnativewidgets-gtk.cxx	31 Jan 2005 09:20:23 -0000	1.10
+++ vcl/unx/gtk/gdi/salnativewidgets-gtk.cxx	10 Mar 2005 02:27:53 -0000	1.2.48.4
@@ -64,8 +64,8 @@
 
 #include <pspgraphics.h>
 
-#include <cstdio>
-#include <cmath>
+#include <stdio.h>
+#include <math.h>
 #include <vector>
 #include <algorithm>
 #include <hash_map>
Index: vcl/unx/inc/pspgraphics.h
===================================================================
RCS file: /cvs/gsl/vcl/unx/inc/pspgraphics.h,v
retrieving revision 1.7
retrieving revision 1.3.6.4
diff -u -p -u -p -r1.7 -r1.3.6.4
--- vcl/unx/inc/pspgraphics.h	13 Jan 2005 18:10:51 -0000	1.7
+++ vcl/unx/inc/pspgraphics.h	10 Mar 2005 02:29:46 -0000	1.3.6.4
@@ -178,7 +178,7 @@ public:
     virtual void			drawPolyLine( ULONG nPoints, const SalPoint* pPtAry );
     virtual void			drawPolygon( ULONG nPoints, const SalPoint* pPtAry );
     virtual void			drawPolyPolygon( ULONG nPoly,
-                                             const ULONG* pPoints,
+                                             const unsigned long* pPoints,
                                              PCONSTSALPOINT* pPtAry );
     virtual sal_Bool		drawPolyLineBezier( ULONG nPoints,
                                                 const SalPoint* pPtAry,
@@ -187,7 +187,7 @@ public:
                                                const SalPoint* pPtAry,
                                                const BYTE* pFlgAry );
     virtual sal_Bool		drawPolyPolygonBezier( ULONG nPoly,
-                                                   const ULONG* pPoints,
+                                                   const unsigned long* pPoints,
                                                    const SalPoint* const* pPtAry,
                                                    const BYTE* const* pFlgAry );
     virtual void			copyArea( long nDestX,
Index: vcl/unx/source/app/i18n_cb.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/app/i18n_cb.cxx,v
retrieving revision 1.22
retrieving revision 1.21.144.2
diff -u -p -u -p -r1.22 -r1.21.144.2
--- vcl/unx/source/app/i18n_cb.cxx	8 Sep 2004 15:37:43 -0000	1.22
+++ vcl/unx/source/app/i18n_cb.cxx	20 Oct 2004 09:38:01 -0000	1.21.144.2
@@ -573,8 +573,8 @@ PreeditCaretCallback ( XIC ic, XPointer 
 		case XIMDontChange:   direction = "Dont change";   break;
 	}
 
-	fprintf (stderr, "PreeditCaretCallback( ic=%i, client=%i,\n",
-		(unsigned int)ic, (unsigned int)client_data );
+	fprintf (stderr, "PreeditCaretCallback( ic=%p, client=%p,\n",
+		ic, client_data );
 	fprintf (stderr, "\t position=%i, direction=\"%s\", style=\"%s\" )\n",
 		call_data->position, direction, style );
 
Index: vcl/unx/source/app/saldata.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/app/saldata.cxx,v
retrieving revision 1.39
retrieving revision 1.36.6.3
diff -u -p -u -p -r1.39 -r1.36.6.3
--- vcl/unx/source/app/saldata.cxx	9 Nov 2004 16:47:56 -0000	1.39
+++ vcl/unx/source/app/saldata.cxx	18 Jan 2005 17:20:58 -0000	1.36.6.3
@@ -58,7 +58,6 @@
  *
  *
  ************************************************************************/
-
 #ifdef USE_XTOOLKIT
 #  define SAL_XT
 #endif
@@ -68,9 +67,9 @@
 #include <unistd.h>
 #include <fcntl.h>
 
-#include <cstdio>
-#include <cstring>
-#include <cstdlib>
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
 #include <limits.h>
 #include <errno.h>
 #include <pthread.h>
Index: vcl/unx/source/gdi/pspgraphics.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/gdi/pspgraphics.cxx,v
retrieving revision 1.9
retrieving revision 1.4.4.4
diff -u -p -u -p -r1.9 -r1.4.4.4
--- vcl/unx/source/gdi/pspgraphics.cxx	13 Oct 2004 08:59:19 -0000	1.9
+++ vcl/unx/source/gdi/pspgraphics.cxx	18 Jan 2005 17:22:51 -0000	1.4.4.4
@@ -411,7 +411,7 @@ void PspGraphics::drawPolygon( ULONG nPo
 }
 
 void PspGraphics::drawPolyPolygon( ULONG			nPoly,
-								   const ULONG	   *pPoints,
+								   const unsigned long	   *pPoints,
 								   PCONSTSALPOINT  *pPtAry )
 {
     m_pPrinterGfx->DrawPolyPolygon (nPoly, pPoints, (const Point**)pPtAry);
@@ -430,7 +430,7 @@ sal_Bool PspGraphics::drawPolygonBezier(
 }
 
 sal_Bool PspGraphics::drawPolyPolygonBezier( ULONG nPoly,
-                                             const ULONG* pPoints,
+                                             const unsigned long* pPoints,
                                              const SalPoint* const* pPtAry,
                                              const BYTE* const* pFlgAry )
 {
Index: vcl/unx/source/gdi/salgdi3.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/gdi/salgdi3.cxx,v
retrieving revision 1.123
retrieving revision 1.119.4.4
diff -u -p -u -p -r1.123 -r1.119.4.4
--- vcl/unx/source/gdi/salgdi3.cxx	7 Jan 2005 09:26:25 -0000	1.123
+++ vcl/unx/source/gdi/salgdi3.cxx	18 Jan 2005 17:23:11 -0000	1.119.4.4
@@ -475,7 +475,7 @@ SalDisplay::GetFont( const ExtendedXlfd 
 				if( pFontCache_->GetCurPos() )
 				{
 					pFontCache_->Remove( pItem );
-					pFontCache_->Insert( pItem, (sal_uInt32)0 );
+					pFontCache_->Insert( pItem, (unsigned long)0 );
 				}
 				return pItem;
 			}
@@ -503,7 +503,7 @@ SalDisplay::GetFont( const ExtendedXlfd 
 	ExtendedFontStruct *pItem = new ExtendedFontStruct( GetDisplay(),
 										rPixelSize, bVertical,
 										const_cast<ExtendedXlfd*>(pRequestedFont) );
-	pFontCache_->Insert( pItem, (sal_uInt32)0 );
+	pFontCache_->Insert( pItem, (unsigned long)0 );
 	pItem->AddRef();
 
 	return pItem;
Index: vcl/unx/source/plugadapt/salplug.cxx
===================================================================
RCS file: /cvs/gsl/vcl/unx/source/plugadapt/salplug.cxx,v
retrieving revision 1.13
retrieving revision 1.9.30.4
diff -u -p -u -p -r1.13 -r1.9.30.4
--- vcl/unx/source/plugadapt/salplug.cxx	21 Jan 2005 13:38:29 -0000	1.13
+++ vcl/unx/source/plugadapt/salplug.cxx	10 Mar 2005 02:33:09 -0000	1.9.30.4
@@ -77,7 +77,7 @@
 #include <salinst.hxx>
 #include <saldata.hxx>
 
-#include <cstdio>
+#include <stdio.h>
 #include <unistd.h>
 
 using namespace rtl;
Index: chart2/source/controller/dialogs/dlg_ChartType.cxx
===================================================================
RCS file: /cvs/graphics/chart2/source/controller/dialogs/dlg_ChartType.cxx,v
retrieving revision 1.8
retrieving revision 1.8.10.1
diff -u -p -u -p -r1.8 -r1.8.10.1
--- chart2/source/controller/dialogs/dlg_ChartType.cxx	8 Sep 2004 17:01:22 -0000	1.8
+++ chart2/source/controller/dialogs/dlg_ChartType.cxx	21 Jan 2005 14:53:23 -0000	1.8.10.1
@@ -1258,7 +1258,7 @@ void SchDiagramTypeDlg::SwitchNumLines( 
     }
 }
 
-void SchDiagramTypeDlg::SetMaximumNumberOfLines( long nMaxLines )
+void SchDiagramTypeDlg::SetMaximumNumberOfLines( sal_Int32 nMaxLines )
 {
     aMtrFldNumLines.SetLast( nMaxLines );
     aMtrFldNumLines.SetMax( nMaxLines );
Index: chart2/source/controller/dialogs/tp_Scale.cxx
===================================================================
RCS file: /cvs/graphics/chart2/source/controller/dialogs/tp_Scale.cxx,v
retrieving revision 1.2
retrieving revision 1.2.42.1
diff -u -p -u -p -r1.2 -r1.2.42.1
--- chart2/source/controller/dialogs/tp_Scale.cxx	26 Jan 2004 09:11:55 -0000	1.2
+++ chart2/source/controller/dialogs/tp_Scale.cxx	21 Jan 2005 14:55:21 -0000	1.2.42.1
@@ -380,7 +380,7 @@ int SchScaleYAxisTabPage::DeactivatePage
         return LEAVE_PAGE;
     }
 
-	ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+	sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 	Edit* pEdit = NULL;
 	USHORT nErrStrId = 0;
 	double fDummy;
cvs diff: cannot open CVS/Entries for reading: No such file or directory
cvs [diff aborted]: no repository
Index: svtools/inc/cacheoptions.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/cacheoptions.hxx,v
retrieving revision 1.2
retrieving revision 1.2.638.2
diff -u -p -u -p -r1.2 -r1.2.638.2
--- svtools/inc/cacheoptions.hxx	8 May 2001 09:05:17 -0000	1.2
+++ svtools/inc/cacheoptions.hxx	21 Jan 2005 17:16:00 -0000	1.2.638.2
@@ -159,14 +159,14 @@ class SvtCacheOptions
 
 		sal_Int32	GetWriterOLE_Objects() const;
 		sal_Int32	GetDrawingEngineOLE_Objects() const;
-		sal_Int32	GetGraphicManagerTotalCacheSize() const; 
-		sal_Int32	GetGraphicManagerObjectCacheSize() const;
+		sal_Size	GetGraphicManagerTotalCacheSize() const; 
+		sal_Size	GetGraphicManagerObjectCacheSize() const;
 		sal_Int32	GetGraphicManagerObjectReleaseTime() const;
 
 		void		SetWriterOLE_Objects( sal_Int32 nObjects );
 		void		SetDrawingEngineOLE_Objects( sal_Int32 nObjects );
-		void		SetGraphicManagerTotalCacheSize( sal_Int32 nTotalCacheSize );
-		void		SetGraphicManagerObjectCacheSize( sal_Int32 nObjectCacheSize );
+		void		SetGraphicManagerTotalCacheSize( sal_Size nTotalCacheSize );
+		void		SetGraphicManagerObjectCacheSize( sal_Size nObjectCacheSize );
 		void        SetGraphicManagerObjectReleaseTime( sal_Int32 nReleaseTimeSeconds );
 
 	//-------------------------------------------------------------------------------------------------------------
Index: svtools/inc/calendar.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/calendar.hxx,v
retrieving revision 1.2
retrieving revision 1.1.1.1.650.2
diff -u -p -u -p -r1.2 -r1.1.1.1.650.2
--- svtools/inc/calendar.hxx	28 Jun 2004 17:06:00 -0000	1.2
+++ svtools/inc/calendar.hxx	19 Oct 2004 16:31:48 -0000	1.1.1.1.650.2
@@ -222,7 +222,7 @@ private:
 	Rectangle		maPrevRect;
 	Rectangle		maNextRect;
 	String			maDayOfWeekText;
-	long			mnDayOfWeekAry[7];
+	sal_Int32		mnDayOfWeekAry[7];
 	Date			maOldFormatFirstDate;
 	Date			maOldFormatLastDate;
 	Date			maFirstDate;
Index: svtools/inc/filerec.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/filerec.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/inc/filerec.hxx	18 Sep 2000 16:58:50 -0000	1.1.1.1
+++ svtools/inc/filerec.hxx	21 Jul 2004 17:34:07 -0000	1.1.1.1.650.1
@@ -72,24 +72,24 @@
 
 #include <tools/stream.hxx>
 
-SV_DECL_VARARR( SfxUINT32s, UINT32, 8, 8 );
+SV_DECL_VARARR( SfxUINT32s, sal_uInt32, 8, 8 );
 
 //------------------------------------------------------------------------
 
-#define SFX_BOOL_DONTCARE				BOOL(2) 	// Don't-Care-Wert f"ur BOOLs
+#define SFX_BOOL_DONTCARE				sal_Bool(2) 	// Don't-Care-Wert f"ur BOOLs
 
-#define SFX_REC_PRETAG_EXT				BYTE(0x00)	// Pre-Tag f"ur Extended-Records
-#define SFX_REC_PRETAG_EOR				BYTE(0xFF)	// Pre-Tag f"ur End-Of-Records
+#define SFX_REC_PRETAG_EXT				sal_uInt8(0x00)	// Pre-Tag f"ur Extended-Records
+#define SFX_REC_PRETAG_EOR				sal_uInt8(0xFF)	// Pre-Tag f"ur End-Of-Records
 
-#define SFX_REC_TYPE_NONE				BYTE(0x00)	// unbekannter Record-Typ
-#define SFX_REC_TYPE_FIRST				BYTE(0x01)
-#define SFX_REC_TYPE_SINGLE 			BYTE(0x01)	// Single-Content-Record
-#define SFX_REC_TYPE_FIXSIZE			BYTE(0x02)	// Fix-Size-Multi-Content-Record
-#define SFX_REC_TYPE_VARSIZE_RELOC      BYTE(0x03)	// variable Rec-Size
-#define SFX_REC_TYPE_VARSIZE            BYTE(0x04)	// alt (nicht verschiebbar)
-#define SFX_REC_TYPE_MIXTAGS_RELOC  	BYTE(0x07)	// Mixed Tag Content-Record
-#define SFX_REC_TYPE_MIXTAGS			BYTE(0x08)	// alt (nicht verschiebbar)
-#define SFX_REC_TYPE_LAST				BYTE(0x08)
+#define SFX_REC_TYPE_NONE				sal_uInt8(0x00)	// unbekannter Record-Typ
+#define SFX_REC_TYPE_FIRST				sal_uInt8(0x01)
+#define SFX_REC_TYPE_SINGLE 			sal_uInt8(0x01)	// Single-Content-Record
+#define SFX_REC_TYPE_FIXSIZE			sal_uInt8(0x02)	// Fix-Size-Multi-Content-Record
+#define SFX_REC_TYPE_VARSIZE_RELOC      sal_uInt8(0x03)	// variable Rec-Size
+#define SFX_REC_TYPE_VARSIZE            sal_uInt8(0x04)	// alt (nicht verschiebbar)
+#define SFX_REC_TYPE_MIXTAGS_RELOC  	sal_uInt8(0x07)	// Mixed Tag Content-Record
+#define SFX_REC_TYPE_MIXTAGS			sal_uInt8(0x08)	// alt (nicht verschiebbar)
+#define SFX_REC_TYPE_LAST				sal_uInt8(0x08)
 #define SFX_REC_TYPE_MINI					0x100	// Mini-Record
 #define SFX_REC_TYPE_DRAWENG				0x400	// Drawing-Engine-Record
 #define SFX_REC_TYPE_EOR					0xF00	// End-Of-Records
@@ -263,18 +263,18 @@ class SfxMiniRecordWriter
 {
 protected:
 	SvStream*		_pStream;	//	<SvStream>, in dem der Record liegt
-	UINT32			_nStartPos; //	Start-Position des Gesamt-Records im Stream
+	sal_uInt32	_nStartPos; //	Start-Position des Gesamt-Records im Stream
 	FASTBOOL		_bHeaderOk; /*	TRUE, wenn der Header schon geschrieben ist;
 									bei DBG_UTIL wird SFX_BOOL_DONTCARE ver-
 									wendet, um die Gr"o\se von Fix-Sized-Records
 									zu pr"ufen. */
-	BYTE			_nPreTag;	//	in den Header zu schreibendes 'Pre-Tag'
+	sal_uInt8			_nPreTag;	//	in den Header zu schreibendes 'Pre-Tag'
 
 public:
 	inline			SfxMiniRecordWriter( SvStream *pStream,
-										 BYTE nTag );
-	inline			SfxMiniRecordWriter( SvStream *pStream, BYTE nTag,
-										 UINT32 nSize );
+										 sal_uInt8 nTag );
+	inline			SfxMiniRecordWriter( SvStream *pStream, sal_uInt8 nTag,
+										 sal_uInt32 nSize );
 
 	inline			~SfxMiniRecordWriter();
 
@@ -282,7 +282,7 @@ public:
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 
 private:
 					// not implementend, not allowed
@@ -322,35 +322,35 @@ class SfxMiniRecordReader
 {
 protected:
 	SvStream*			_pStream;	//	<SvStream>, aus dem gelesen wird
-	UINT32				_nEofRec;	//	Position direkt hinter dem Record
+	sal_uInt32		_nEofRec;	//	Position direkt hinter dem Record
 	FASTBOOL			_bSkipped;	//	TRUE: der Record wurde explizit geskippt
-	BYTE				_nPreTag;	//	aus dem Header gelesenes Pre-Tag
+	sal_uInt8			_nPreTag;	//	aus dem Header gelesenes Pre-Tag
 
 						// Drei-Phasen-Ctor f"ur Subklassen
 						SfxMiniRecordReader() {}
-   void 				Construct_Impl( SvStream *pStream, BYTE nTag )
+   void 				Construct_Impl( SvStream *pStream, sal_uInt8 nTag )
 						{
 							_pStream = pStream;
 							_bSkipped = FALSE;
 							_nPreTag = nTag;
 						}
-	inline FASTBOOL 	SetHeader_Impl( UINT32 nHeader );
+	inline FASTBOOL 	SetHeader_Impl( sal_uInt32 nHeader );
 
 						// als ung"ultig markieren und zur"uck-seeken
-	void				SetInvalid_Impl( UINT32 nRecordStartPos )
+	void				SetInvalid_Impl( sal_uInt32 nRecordStartPos )
 						{
 							_nPreTag = SFX_REC_PRETAG_EOR;
 							_pStream->Seek( nRecordStartPos );
 						}
 
 public:
-	static USHORT   	ScanRecordType( SvStream *pStream );
+	static sal_uInt16   	ScanRecordType( SvStream *pStream );
 
 						SfxMiniRecordReader( SvStream *pStream );
-						SfxMiniRecordReader( SvStream *pStream, BYTE nTag );
+						SfxMiniRecordReader( SvStream *pStream, sal_uInt8 nTag );
 	inline				~SfxMiniRecordReader();
 
-	inline BYTE 		GetTag() const;
+	inline sal_uInt8 		GetTag() const;
 	inline FASTBOOL 	IsValid() const;
 
 	inline SvStream&	operator*() const;
@@ -405,20 +405,20 @@ class SfxSingleRecordWriter: public SfxM
 
 {
 protected:
-					SfxSingleRecordWriter( BYTE nRecordType,
+					SfxSingleRecordWriter( sal_uInt8 nRecordType,
 										   SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer );
 
 public:
 					SfxSingleRecordWriter( SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer );
 					SfxSingleRecordWriter( SvStream *pStream,
-										   UINT16 nTag, BYTE nCurVer,
-										   UINT32 nSize );
+										   sal_uInt16 nTag, sal_uInt8 nCurVer,
+										   sal_uInt32 nSize );
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -454,9 +454,9 @@ class SfxSingleRecordReader: public SfxM
 
 {
 protected:
-	UINT16				_nRecordTag;	// Art des Gesamt-Inhalts
-	BYTE				_nRecordVer;	// Version des Gesamt-Inhalts
-	BYTE				_nRecordType;	// Record Type aus dem Header
+	sal_uInt16		_nRecordTag;	// Art des Gesamt-Inhalts
+	sal_uInt8			_nRecordVer;	// Version des Gesamt-Inhalts
+	sal_uInt8			_nRecordType;	// Record Type aus dem Header
 
 						// Drei-Phasen-Ctor f"ur Subklassen
 						SfxSingleRecordReader() {}
@@ -465,17 +465,17 @@ protected:
 							SfxMiniRecordReader::Construct_Impl(
 									pStream, SFX_REC_PRETAG_EXT );
 						}
-	FASTBOOL			FindHeader_Impl( UINT16 nTypes, UINT16 nTag );
-	FASTBOOL            ReadHeader_Impl( USHORT nTypes );
+	FASTBOOL			FindHeader_Impl( sal_uInt16 nTypes, sal_uInt16 nTag );
+	FASTBOOL            ReadHeader_Impl( sal_uInt16 nTypes );
 
 public:
 						SfxSingleRecordReader( SvStream *pStream );
-						SfxSingleRecordReader( SvStream *pStream, USHORT nTag );
+						SfxSingleRecordReader( SvStream *pStream, sal_uInt16 nTag );
 
-	inline UINT16		GetTag() const;
+	inline sal_uInt16		GetTag() const;
 
-	inline BYTE 		GetVersion() const;
-	inline FASTBOOL 	HasVersion( USHORT nVersion ) const;
+	inline sal_uInt8 		GetVersion() const;
+	inline FASTBOOL 	HasVersion( sal_uInt16 nVersion ) const;
 };
 
 //------------------------------------------------------------------------
@@ -520,7 +520,7 @@ class SfxMultiFixRecordWriter: public Sf
 
 	{
 		SfxMultiFixRecordWriter aRecord( pStream, MY_TAG_X, MY_VERSION );
-		for ( USHORT n = 0; n < Count(); ++n )
+		for ( sal_uInt16 n = 0; n < Count(); ++n )
 		{
 			aRecord.NewContent();
 			*aRecord << aMember1[n];
@@ -531,28 +531,28 @@ class SfxMultiFixRecordWriter: public Sf
 
 {
 protected:
-	UINT32			_nContentStartPos;	/*	Startposition des jeweiligen
+	sal_uInt32			_nContentStartPos;	/*	Startposition des jeweiligen
 											Contents - nur bei DBG_UTIL
 											und f"ur Subklassen */
-	UINT32			_nContentSize;		//	Gr"o\se jedes Contents
-	UINT16			_nContentCount; 	//	jeweilige Anzahl der Contents
+	sal_uInt32			_nContentSize;		//	Gr"o\se jedes Contents
+	sal_uInt16			_nContentCount; 	//	jeweilige Anzahl der Contents
 
-					SfxMultiFixRecordWriter( BYTE nRecordType,
+					SfxMultiFixRecordWriter( sal_uInt8 nRecordType,
 											 SvStream *pStream,
-											 UINT16 nTag, BYTE nCurVer,
-											 UINT32 nContentSize );
+											 sal_uInt16 nTag, sal_uInt8 nCurVer,
+											 sal_uInt32 nContentSize );
 
 public:
 					SfxMultiFixRecordWriter( SvStream *pStream,
-											 UINT16 nTag, BYTE nCurVer,
-											 UINT32 nContentSize );
+											 sal_uInt16 nTag, sal_uInt8 nCurVer,
+											 sal_uInt32 nContentSize );
 	inline			~SfxMultiFixRecordWriter();
 
 	inline void 	NewContent();
 
 	inline void		Reset();
 
-	UINT32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	sal_uInt32			Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -596,7 +596,7 @@ class SfxMultiVarRecordWriter: public Sf
 
 	{
 		SfxMultiVarRecordWriter aRecord( pStream, MY_TAG_X, MY_VERSION );
-		for ( USHORT n = 0; n < Count(); ++n )
+		for ( sal_uInt16 n = 0; n < Count(); ++n )
 		{
 			aRecord.NewContent();
 			*aRecord << aMember1[n];
@@ -608,24 +608,24 @@ class SfxMultiVarRecordWriter: public Sf
 {
 protected:
 	SfxUINT32s  		_aContentOfs;
-	USHORT              _nContentVer;   // nur f"ur SfxMultiMixRecordWriter
+	sal_uInt16              _nContentVer;   // nur f"ur SfxMultiMixRecordWriter
 
-						SfxMultiVarRecordWriter( BYTE nRecordType,
+						SfxMultiVarRecordWriter( sal_uInt8 nRecordType,
 												 SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 
 	void                FlushContent_Impl();
 
 public:
 						SfxMultiVarRecordWriter( SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 						~SfxMultiVarRecordWriter();
 
 	void				NewContent();
 
-	virtual UINT32		Close( FASTBOOL bSeekToEndOfRec = TRUE );
+	virtual sal_uInt32		Close( FASTBOOL bSeekToEndOfRec = TRUE );
 };
 
 //------------------------------------------------------------------------
@@ -668,10 +668,10 @@ class SfxMultiMixRecordWriter: public Sf
 {
 public:
 	inline				SfxMultiMixRecordWriter( SvStream *pStream,
-												 USHORT nRecordTag,
-												 BYTE nRecordVer );
+												 sal_uInt16 nRecordTag,
+												 sal_uInt8 nRecordVer );
 
-	void				NewContent( USHORT nTag, BYTE nVersion );
+	void				NewContent( sal_uInt16 nTag, sal_uInt8 nVersion );
 
 // private: geht nicht, da einige Compiler dann auch vorherige privat machen
 	void                NewContent()
@@ -697,7 +697,7 @@ class SfxMultiRecordReader: public SfxSi
 
 	{
 		SfxMultiRecordReader aRecord( pStream );
-		for ( USHORT nRecNo = 0; aRecord.GetContent(); ++nRecNo )
+		for ( sal_uInt16 nRecNo = 0; aRecord.GetContent(); ++nRecNo )
 		{
 			switch ( aRecord.GetTag() )
 			{
@@ -716,30 +716,30 @@ class SfxMultiRecordReader: public SfxSi
 */
 
 {
-	UINT32				_nStartPos;		//	Start-Position des Records
-	UINT32* 			_pContentOfs;	//	Offsets der Startpositionen
-	UINT32				_nContentSize;	//	Size jedes einzelnen / Tabellen-Pos
-	UINT16				_nContentCount; //	Anzahl der Contents im Record
-	UINT16				_nContentNo;	/*	der Index des aktuellen Contents
+	sal_uInt32				_nStartPos;		//	Start-Position des Records
+	sal_uInt32* 			_pContentOfs;	//	Offsets der Startpositionen
+	sal_uInt32				_nContentSize;	//	Size jedes einzelnen / Tabellen-Pos
+	sal_uInt16				_nContentCount; //	Anzahl der Contents im Record
+	sal_uInt16				_nContentNo;	/*	der Index des aktuellen Contents
 											enth"alt jeweils den Index des
 											Contents, der beim n"achsten
 											GetContent() geholt wird */
-	UINT16				_nContentTag;	//	Art-Kennung des aktuellen Contents
-	BYTE				_nContentVer;	//	Versions-Kennung des akt. Contents
+	sal_uInt16				_nContentTag;	//	Art-Kennung des aktuellen Contents
+	sal_uInt8				_nContentVer;	//	Versions-Kennung des akt. Contents
 
 	FASTBOOL			ReadHeader_Impl();
 
 public:
 						SfxMultiRecordReader( SvStream *pStream );
-						SfxMultiRecordReader( SvStream *pStream, UINT16 nTag );
+						SfxMultiRecordReader( SvStream *pStream, sal_uInt16 nTag );
 						~SfxMultiRecordReader();
 
 	FASTBOOL			GetContent();
-	inline UINT16		GetContentTag();
-	inline BYTE 		GetContentVersion() const;
-	inline FASTBOOL 	HasContentVersion( USHORT nVersion ) const;
+	inline sal_uInt16		GetContentTag();
+	inline sal_uInt8 		GetContentVersion() const;
+	inline FASTBOOL 	HasContentVersion( sal_uInt16 nVersion ) const;
 
-	inline UINT32		ContentCount() const;
+	inline sal_uInt32		ContentCount() const;
 };
 
 //=========================================================================
@@ -747,7 +747,7 @@ public:
 inline SfxMiniRecordWriter::SfxMiniRecordWriter
 (
 	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	BYTE            nTag            // Record-Tag zwischen 0x01 und 0xFE
+	sal_uInt8            nTag            // Record-Tag zwischen 0x01 und 0xFE
 )
 
 /*  [Beschreibung]
@@ -773,8 +773,8 @@ inline SfxMiniRecordWriter::SfxMiniRecor
 inline SfxMiniRecordWriter::SfxMiniRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	BYTE			nTag,			// Record-Tag zwischen 0x01 und 0xFE
-	UINT32			nSize			// Gr"o\se der Daten in Bytes
+	sal_uInt8			nTag,			// Record-Tag zwischen 0x01 und 0xFE
+	sal_uInt32			nSize			// Gr"o\se der Daten in Bytes
 )
 
 /*	[Beschreibung]
@@ -869,7 +869,7 @@ inline void SfxMiniRecordReader::Skip()
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxMiniRecordReader::GetTag() const
+inline sal_uInt8 SfxMiniRecordReader::GetTag() const
 
 /*	[Beschreibung]
 
@@ -916,18 +916,18 @@ inline SvStream& SfxMiniRecordReader::op
 
 //=========================================================================
 
-inline UINT32 SfxSingleRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+inline sal_uInt32 SfxSingleRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 //	siehe <SfxMiniRecordWriter::Close(FASTBOOL)>
 
 {
-	UINT32 nRet = 0;
+	sal_uInt32 nRet = 0;
 
 	// wurde der Header noch nicht geschrieben?
 	if ( !_bHeaderOk )
 	{
 		// Basisklassen-Header schreiben
-		UINT32 nEndPos = SfxMiniRecordWriter::Close( bSeekToEndOfRec );
+		sal_uInt32 nEndPos = SfxMiniRecordWriter::Close( bSeekToEndOfRec );
 
 		// ggf. ans Ende des eigenen Headers seeken oder hinter Rec bleiben
 		if ( !bSeekToEndOfRec )
@@ -956,7 +956,7 @@ inline void	SfxSingleRecordWriter::Reset
 
 //=========================================================================
 
-inline UINT16 SfxSingleRecordReader::GetTag() const
+inline sal_uInt16 SfxSingleRecordReader::GetTag() const
 
 /*  [Beschreibung]
 
@@ -969,7 +969,7 @@ inline UINT16 SfxSingleRecordReader::Get
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxSingleRecordReader::GetVersion() const
+inline sal_uInt8 SfxSingleRecordReader::GetVersion() const
 
 /*	[Beschreibung]
 
@@ -982,7 +982,7 @@ inline BYTE SfxSingleRecordReader::GetVe
 
 //-------------------------------------------------------------------------
 
-inline FASTBOOL SfxSingleRecordReader::HasVersion( USHORT nVersion ) const
+inline FASTBOOL SfxSingleRecordReader::HasVersion( sal_uInt16 nVersion ) const
 
 /*	[Beschreibung]
 
@@ -1048,8 +1048,8 @@ inline void SfxMultiFixRecordWriter::New
 inline SfxMultiMixRecordWriter::SfxMultiMixRecordWriter
 (
 	SvStream*		pStream,	// Stream, in dem der Record angelegt wird
-	USHORT			nRecordTag, // Gesamt-Record-Art-Kennung
-	BYTE			nRecordVer	// Gesamt-Record-Versions-Kennung
+	sal_uInt16			nRecordTag, // Gesamt-Record-Art-Kennung
+	sal_uInt8			nRecordVer	// Gesamt-Record-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -1076,7 +1076,7 @@ inline void	SfxMultiFixRecordWriter::Res
 
 //=========================================================================
 
-inline UINT16 SfxMultiRecordReader::GetContentTag()
+inline sal_uInt16 SfxMultiRecordReader::GetContentTag()
 
 /*	[Beschreibung]
 
@@ -1090,7 +1090,7 @@ inline UINT16 SfxMultiRecordReader::GetC
 
 //-------------------------------------------------------------------------
 
-inline BYTE SfxMultiRecordReader::GetContentVersion() const
+inline sal_uInt8 SfxMultiRecordReader::GetContentVersion() const
 
 /*  [Beschreibung]
 
@@ -1104,7 +1104,7 @@ inline BYTE SfxMultiRecordReader::GetCon
 
 //-------------------------------------------------------------------------
 
-inline FASTBOOL SfxMultiRecordReader::HasContentVersion( USHORT nVersion ) const
+inline FASTBOOL SfxMultiRecordReader::HasContentVersion( sal_uInt16 nVersion ) const
 
 /*  [Beschreibung]
 
@@ -1119,7 +1119,7 @@ inline FASTBOOL SfxMultiRecordReader::Ha
 
 //-------------------------------------------------------------------------
 
-inline UINT32 SfxMultiRecordReader::ContentCount() const
+inline sal_uInt32 SfxMultiRecordReader::ContentCount() const
 
 /*	[Beschreibung]
 
Index: svtools/inc/flbytes.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/flbytes.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/inc/flbytes.hxx	18 Sep 2000 16:58:50 -0000	1.1.1.1
+++ svtools/inc/flbytes.hxx	21 Jul 2004 17:34:07 -0000	1.1.1.1.650.1
@@ -73,7 +73,7 @@
 class SvFillLockBytes : public SvLockBytes
 {
 	SvLockBytesRef xLockBytes;
-	ULONG nFilledSize;
+	sal_Size nFilledSize;
 	BOOL bTerminated;
 	BOOL bSync;
 public:
@@ -81,17 +81,17 @@ public:
 
 	SvFillLockBytes( SvLockBytes* pLockBytes );
 	virtual ErrCode ReadAt(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const;
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const;
 	virtual ErrCode WriteAt(
-		ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten );
+		sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten );
 	virtual ErrCode Flush() const;
-	virtual ErrCode SetSize( ULONG nSize );
-	virtual ErrCode LockRegion( ULONG nPos, ULONG nCount, LockType );
-	virtual ErrCode UnlockRegion( ULONG nPos, ULONG nCount, LockType );
+	virtual ErrCode SetSize( sal_Size nSize );
+	virtual ErrCode LockRegion( sal_Size nPos, sal_Size nCount, LockType );
+	virtual ErrCode UnlockRegion( sal_Size nPos, sal_Size nCount, LockType );
 	virtual ErrCode Stat( SvLockBytesStat*, SvLockBytesStatFlag ) const;
-	ErrCode FillAppend( const void* pBuffer, ULONG nCount, ULONG *pWritten );
-	ULONG   Tell() const { return nFilledSize; }
-	void    Seek( ULONG nPos ) { nFilledSize = nPos; }
+	ErrCode FillAppend( const void* pBuffer, sal_Size nCount, sal_Size *pWritten );
+	sal_Size   Tell() const { return nFilledSize; }
+	void    Seek( sal_Size nPos ) { nFilledSize = nPos; }
 
 	void Terminate();
 };
@@ -133,34 +133,34 @@ public:
 	virtual BOOL IsSynchronMode() const
 	{ return m_xAsyncLockBytes->IsSynchronMode(); }
 
-	virtual ErrCode ReadAt(ULONG nPos, void * pBuffer, ULONG nCount,
-						   ULONG * pRead) const;
+	virtual ErrCode ReadAt(sal_Size nPos, void * pBuffer, sal_Size nCount,
+						   sal_Size * pRead) const;
 
-	virtual ErrCode WriteAt(ULONG nPos, const void * pBuffer, ULONG nCount,
-							ULONG * pWritten);
+	virtual ErrCode WriteAt(sal_Size nPos, const void * pBuffer, sal_Size nCount,
+							sal_Size * pWritten);
 
 	virtual ErrCode Flush() const { return m_xAsyncLockBytes->Flush(); }
 
-	virtual ErrCode SetSize(ULONG nSize)
+	virtual ErrCode SetSize(sal_Size nSize)
 	{ return m_xAsyncLockBytes->SetSize(nSize); }
 
-	virtual ErrCode LockRegion(ULONG nPos, ULONG nCount, LockType eType)
+	virtual ErrCode LockRegion(sal_Size nPos, sal_Size nCount, LockType eType)
 	{ return m_xAsyncLockBytes->LockRegion(nPos, nCount, eType); }
 
-	virtual ErrCode UnlockRegion(ULONG nPos, ULONG nCount, LockType eType)
+	virtual ErrCode UnlockRegion(sal_Size nPos, sal_Size nCount, LockType eType)
 	{ return m_xAsyncLockBytes->UnlockRegion(nPos, nCount, eType); }
 
 	virtual ErrCode Stat(SvLockBytesStat * pStat, SvLockBytesStatFlag eFlag)
 		const
 	{ return m_xAsyncLockBytes->Stat(pStat, eFlag); }
 
-	virtual ErrCode FillAppend(const void * pBuffer, ULONG nCount,
-							   ULONG * pWritten)
+	virtual ErrCode FillAppend(const void * pBuffer, sal_Size nCount,
+							   sal_Size * pWritten)
 	{ return m_xAsyncLockBytes->FillAppend(pBuffer, nCount, pWritten); }
 
-	virtual ULONG Tell() const { return m_xAsyncLockBytes->Tell(); }
+	virtual sal_Size Tell() const { return m_xAsyncLockBytes->Tell(); }
 
-	virtual ULONG Seek(ULONG nPos)
+	virtual sal_Size Seek(sal_Size nPos)
 	{ return m_xAsyncLockBytes->Seek(nPos); }
 
 	virtual void Terminate() { m_xAsyncLockBytes->Terminate(); }
@@ -187,19 +187,19 @@ public:
 	SvCompositeLockBytes( );
 	~SvCompositeLockBytes();
 
-	void Append( SvLockBytes* pLockBytes, ULONG nPos, ULONG nOffset );
-	ULONG RelativeOffset( ULONG nPos ) const;
+	void Append( SvLockBytes* pLockBytes, sal_Size nPos, sal_Size nOffset );
+	sal_Size RelativeOffset( sal_Size nPos ) const;
 	void  SetIsPending( BOOL bSet );
 	SvLockBytes*    GetLastLockBytes() const;
 
 	virtual ErrCode ReadAt(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const;
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const;
 	virtual ErrCode WriteAt(
-		ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten );
+		sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten );
 	virtual ErrCode Flush() const;
-	virtual ErrCode SetSize( ULONG nSize );
-	virtual ErrCode LockRegion( ULONG nPos, ULONG nCount, LockType );
-	virtual ErrCode UnlockRegion( ULONG nPos, ULONG nCount, LockType );
+	virtual ErrCode SetSize( sal_Size nSize );
+	virtual ErrCode LockRegion( sal_Size nPos, sal_Size nCount, LockType );
+	virtual ErrCode UnlockRegion( sal_Size nPos, sal_Size nCount, LockType );
 	virtual ErrCode Stat( SvLockBytesStat*, SvLockBytesStatFlag ) const;
 };
 
Index: svtools/inc/itempool.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/itempool.hxx,v
retrieving revision 1.3
retrieving revision 1.3.464.1
diff -u -p -u -p -r1.3 -r1.3.464.1
--- svtools/inc/itempool.hxx	27 Mar 2003 14:36:20 -0000	1.3
+++ svtools/inc/itempool.hxx	21 Jan 2005 17:19:38 -0000	1.3.464.1
@@ -164,9 +164,9 @@ public:
 	//---------------------------------------------------------------------
 
 protected:
-	static inline void				SetRefCount( SfxPoolItem& rItem, ULONG n );
-	static inline ULONG				AddRef( const SfxPoolItem& rItem, ULONG n = 1 );
-	static inline ULONG				ReleaseRef( const SfxPoolItem& rItem, ULONG n = 1);
+	static inline void				SetRefCount( SfxPoolItem& rItem, sal_uInt32 n );
+	static inline sal_uInt32				AddRef( const SfxPoolItem& rItem, sal_uInt32 n = 1 );
+	static inline sal_uInt32				ReleaseRef( const SfxPoolItem& rItem, sal_uInt32 n = 1);
 
 public:
 									SfxItemPool( const SfxItemPool &rPool,
@@ -290,19 +290,19 @@ private:
 // --------------- Inline Implementierungen ------------------------------
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline void SfxItemPool::SetRefCount( SfxPoolItem& rItem, ULONG n )
+inline void SfxItemPool::SetRefCount( SfxPoolItem& rItem, sal_uInt32 n )
 {
 	rItem.SetRefCount(n);
 }
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline ULONG SfxItemPool::AddRef( const SfxPoolItem& rItem, ULONG n )
+inline sal_uInt32 SfxItemPool::AddRef( const SfxPoolItem& rItem, sal_uInt32 n )
 {
 	return rItem.AddRef(n);
 }
 
 // nur der Pool darf den Referenz-Zaehler manipulieren !!!
-inline ULONG SfxItemPool::ReleaseRef( const SfxPoolItem& rItem, ULONG n )
+inline sal_uInt32 SfxItemPool::ReleaseRef( const SfxPoolItem& rItem, sal_uInt32 n )
 {
 	return rItem.ReleaseRef(n);
 }
Index: svtools/inc/roadmap.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/roadmap.hxx,v
retrieving revision 1.5
retrieving revision 1.2.52.3
diff -u -p -u -p -r1.5 -r1.2.52.3
--- svtools/inc/roadmap.hxx	17 Feb 2005 11:14:47 -0000	1.5
+++ svtools/inc/roadmap.hxx	9 Mar 2005 23:06:05 -0000	1.2.52.3
@@ -196,7 +196,7 @@ namespace svt
 
 
     protected:
-        sal_Int32       PreNotify( NotifyEvent& rNEvt );
+        long            PreNotify( NotifyEvent& rNEvt );
 
     protected:
         /// called when an item has been selected by any means
Index: svtools/inc/strmadpt.hxx
===================================================================
RCS file: /cvs/util/svtools/inc/strmadpt.hxx,v
retrieving revision 1.2
retrieving revision 1.2.628.1
diff -u -p -u -p -r1.2 -r1.2.628.1
--- svtools/inc/strmadpt.hxx	28 Sep 2001 13:02:30 -0000	1.2
+++ svtools/inc/strmadpt.hxx	21 Jul 2004 17:34:08 -0000	1.2.628.1
@@ -83,7 +83,7 @@ class SvOutputStreamOpenLockBytes: publi
 {
 	com::sun::star::uno::Reference< com::sun::star::io::XOutputStream >
 	    m_xOutputStream;
-	sal_uInt32 m_nPosition;
+	sal_Size m_nPosition;
 
 public:
 	TYPEINFO();
@@ -94,23 +94,23 @@ public:
 			    rTheOutputStream):
 		m_xOutputStream(rTheOutputStream), m_nPosition(0) {}
 
-	virtual ErrCode ReadAt(ULONG, void *, ULONG, ULONG *) const;
+	virtual ErrCode ReadAt(sal_Size, void *, sal_Size, sal_Size *) const;
 
-	virtual ErrCode WriteAt(ULONG nPos, const void * pBuffer, ULONG nCount,
-							ULONG * pWritten);
+	virtual ErrCode WriteAt(sal_Size nPos, const void * pBuffer, sal_Size nCount,
+							sal_Size * pWritten);
 
 	virtual ErrCode Flush() const;
 
-	virtual ErrCode SetSize(ULONG);
+	virtual ErrCode SetSize(sal_Size);
 
 	virtual ErrCode Stat(SvLockBytesStat * pStat, SvLockBytesStatFlag) const;
 
-	virtual ErrCode FillAppend(const void * pBuffer, ULONG nCount,
-							   ULONG * pWritten);
+	virtual ErrCode FillAppend(const void * pBuffer, sal_Size nCount,
+							   sal_Size * pWritten);
 
-	virtual ULONG Tell() const;
+	virtual sal_Size Tell() const;
 
-	virtual ULONG Seek(ULONG);
+	virtual sal_Size Seek(sal_Size);
 
 	virtual void Terminate();
 };
Index: svtools/source/config/cacheoptions.cxx
===================================================================
RCS file: /cvs/util/svtools/source/config/cacheoptions.cxx,v
retrieving revision 1.5
retrieving revision 1.5.16.2
diff -u -p -u -p -r1.5 -r1.5.16.2
--- svtools/source/config/cacheoptions.cxx	16 Jun 2004 10:06:14 -0000	1.5
+++ svtools/source/config/cacheoptions.cxx	21 Jan 2005 17:16:13 -0000	1.5.16.2
@@ -141,14 +141,14 @@ public:
 
 	sal_Int32		GetWriterOLE_Objects() const;
 	sal_Int32		GetDrawingEngineOLE_Objects() const;
-	sal_Int32		GetGraphicManagerTotalCacheSize() const; 
-	sal_Int32		GetGraphicManagerObjectCacheSize() const;
+	sal_Size		GetGraphicManagerTotalCacheSize() const; 
+	sal_Size		GetGraphicManagerObjectCacheSize() const;
 	sal_Int32		GetGraphicManagerObjectReleaseTime() const;
 					
 	void			SetWriterOLE_Objects( sal_Int32 nObjects );
 	void			SetDrawingEngineOLE_Objects( sal_Int32 nObjects );
-	void			SetGraphicManagerTotalCacheSize( sal_Int32 nTotalCacheSize );
-	void			SetGraphicManagerObjectCacheSize( sal_Int32 nObjectCacheSize );
+	void			SetGraphicManagerTotalCacheSize( sal_Size nTotalCacheSize );
+	void			SetGraphicManagerObjectCacheSize( sal_Size nObjectCacheSize );
 	void            SetGraphicManagerObjectReleaseTime( sal_Int32 nReleaseTimeSeconds );
 
 //-------------------------------------------------------------------------------------------------------------
@@ -167,8 +167,8 @@ private:
 
 		sal_Int32	mnWriterOLE;
 		sal_Int32	mnDrawingOLE;
-		sal_Int32	mnGrfMgrTotalSize;
-		sal_Int32	mnGrfMgrObjectSize;
+		sal_Size	mnGrfMgrTotalSize;
+		sal_Size	mnGrfMgrObjectSize;
         sal_Int32   mnGrfMgrObjectRelease;
 };
 
@@ -306,7 +306,7 @@ sal_Int32 SvtCacheOptions_Impl::GetDrawi
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-sal_Int32 SvtCacheOptions_Impl::GetGraphicManagerTotalCacheSize() const
+sal_Size SvtCacheOptions_Impl::GetGraphicManagerTotalCacheSize() const
 {
 	return mnGrfMgrTotalSize;
 }
@@ -314,7 +314,7 @@ sal_Int32 SvtCacheOptions_Impl::GetGraph
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-sal_Int32 SvtCacheOptions_Impl::GetGraphicManagerObjectCacheSize() const
+sal_Size SvtCacheOptions_Impl::GetGraphicManagerObjectCacheSize() const
 {
 	return mnGrfMgrObjectSize;
 }
@@ -348,7 +348,7 @@ void SvtCacheOptions_Impl::SetDrawingEng
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-void SvtCacheOptions_Impl::SetGraphicManagerTotalCacheSize( sal_Int32 nGrfMgrTotalSize )
+void SvtCacheOptions_Impl::SetGraphicManagerTotalCacheSize( sal_Size nGrfMgrTotalSize )
 {
 	mnGrfMgrTotalSize = nGrfMgrTotalSize;
 	SetModified();
@@ -357,7 +357,7 @@ void SvtCacheOptions_Impl::SetGraphicMan
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-void SvtCacheOptions_Impl::SetGraphicManagerObjectCacheSize( sal_Int32 nGrfMgrObjectSize )
+void SvtCacheOptions_Impl::SetGraphicManagerObjectCacheSize( sal_Size nGrfMgrObjectSize )
 {
 	mnGrfMgrObjectSize = nGrfMgrObjectSize;
 	SetModified();
@@ -455,7 +455,7 @@ sal_Int32 SvtCacheOptions::GetDrawingEng
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-sal_Int32 SvtCacheOptions::GetGraphicManagerTotalCacheSize() const
+sal_Size SvtCacheOptions::GetGraphicManagerTotalCacheSize() const
 {
     MutexGuard aGuard( GetOwnStaticMutex() );
 	return m_pDataContainer->GetGraphicManagerTotalCacheSize();
@@ -464,7 +464,7 @@ sal_Int32 SvtCacheOptions::GetGraphicMan
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-sal_Int32 SvtCacheOptions::GetGraphicManagerObjectCacheSize() const
+sal_Size SvtCacheOptions::GetGraphicManagerObjectCacheSize() const
 {
     MutexGuard aGuard( GetOwnStaticMutex() );
 	return m_pDataContainer->GetGraphicManagerObjectCacheSize();
@@ -500,7 +500,7 @@ void SvtCacheOptions::SetDrawingEngineOL
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-void SvtCacheOptions::SetGraphicManagerTotalCacheSize( sal_Int32 nGrfMgrTotalSize )
+void SvtCacheOptions::SetGraphicManagerTotalCacheSize( sal_Size nGrfMgrTotalSize )
 {
     MutexGuard aGuard( GetOwnStaticMutex() );
 	m_pDataContainer->SetGraphicManagerTotalCacheSize( nGrfMgrTotalSize );
@@ -509,7 +509,7 @@ void SvtCacheOptions::SetGraphicManagerT
 //*****************************************************************************************************************
 //	public method
 //*****************************************************************************************************************
-void SvtCacheOptions::SetGraphicManagerObjectCacheSize( sal_Int32 nGrfMgrObjectSize )
+void SvtCacheOptions::SetGraphicManagerObjectCacheSize( sal_Size nGrfMgrObjectSize )
 {
     MutexGuard aGuard( GetOwnStaticMutex() );
 	m_pDataContainer->SetGraphicManagerObjectCacheSize( nGrfMgrObjectSize );
Index: svtools/source/control/fmtfield.cxx
===================================================================
RCS file: /cvs/util/svtools/source/control/fmtfield.cxx,v
retrieving revision 1.29
retrieving revision 1.29.62.1
diff -u -p -u -p -r1.29 -r1.29.62.1
--- svtools/source/control/fmtfield.cxx	3 Dec 2004 14:28:21 -0000	1.29
+++ svtools/source/control/fmtfield.cxx	21 Jan 2005 17:16:19 -0000	1.29.62.1
@@ -714,7 +714,7 @@ void FormattedField::SetFormatter(SvNumb
 		LanguageType aOldLang;
 		GetFormat(sOldFormat, aOldLang);
 
-		ULONG nDestKey = pFormatter->TestNewString(sOldFormat);
+		sal_uInt32 nDestKey = pFormatter->TestNewString(sOldFormat);
 		if (nDestKey == NUMBERFORMAT_ENTRY_NOT_FOUND)
 		{
 			// die Sprache des neuen Formatters
@@ -747,7 +747,7 @@ void FormattedField::GetFormat(XubString
 BOOL FormattedField::SetFormat(const XubString& rFormatString, LanguageType eLang)
 {
 	DBG_CHKTHIS(FormattedField, NULL);
-	ULONG nNewKey = ImplGetFormatter()->TestNewString(rFormatString, eLang);
+	sal_uInt32 nNewKey = ImplGetFormatter()->TestNewString(rFormatString, eLang);
 	if (nNewKey == NUMBERFORMAT_ENTRY_NOT_FOUND)
 	{
 		USHORT nCheckPos;
@@ -798,7 +798,7 @@ void FormattedField::SetThousandsSep(BOO
 	ImplGetFormatter()->GenerateFormat(sFmtDescription, m_nFormatKey, eLang, _bUseSeparator, IsRed, nPrecision, nAnzLeading);
 	// ... and introduce it to the formatter
 	USHORT nCheckPos;
-	ULONG  nNewKey;
+	sal_uInt32  nNewKey;
 	short nType;
 	ImplGetFormatter()->PutEntry(sFmtDescription, nCheckPos, nType, nNewKey, eLang);
 
@@ -842,7 +842,7 @@ void FormattedField::SetDecimalDigits(US
 	ImplGetFormatter()->GenerateFormat(sFmtDescription, m_nFormatKey, eLang, bThousand, IsRed, _nPrecision, nAnzLeading);
 	// ... and introduce it to the formatter
 	USHORT nCheckPos;
-	ULONG nNewKey;
+	sal_uInt32 nNewKey;
 	short nType;
 	ImplGetFormatter()->PutEntry(sFmtDescription, nCheckPos, nType, nNewKey, eLang);
 
@@ -1065,7 +1065,7 @@ BOOL FormattedField::ImplGetValue(double
 
 	DBG_ASSERT(ImplGetFormatter() != NULL, "FormattedField::ImplGetValue : can't give you a current value without a formatter !");
 
-	ULONG nFormatKey = m_nFormatKey;	// IsNumberFormat veraendert den FormatKey ...
+	sal_uInt32 nFormatKey = m_nFormatKey;	// IsNumberFormat veraendert den FormatKey ...
 
 	if (ImplGetFormatter()->IsTextFormat(nFormatKey) && m_bTreatAsNumber)
 		// damit wir in einem als Text formatierten Feld trotzdem eine Eingabe wie '1,1' erkennen ...
@@ -1079,7 +1079,7 @@ BOOL FormattedField::ImplGetValue(double
 		// the default number format for this language
 		ULONG nStandardNumericFormat = m_pFormatter->GetStandardFormat(NUMBERFORMAT_NUMBER, eLanguage);
 
-		ULONG nTempFormat = nStandardNumericFormat;
+		sal_uInt32 nTempFormat = nStandardNumericFormat;
 		double dTemp;
 		if (m_pFormatter->IsNumberFormat(sText, nTempFormat, dTemp) &&
 			NUMBERFORMAT_NUMBER == m_pFormatter->GetType(nTempFormat))
Index: svtools/source/control/roadmap.cxx
===================================================================
RCS file: /cvs/util/svtools/source/control/roadmap.cxx,v
retrieving revision 1.6
retrieving revision 1.2.52.4
diff -u -p -u -p -r1.6 -r1.2.52.4
--- svtools/source/control/roadmap.cxx	17 Feb 2005 11:15:55 -0000	1.6
+++ svtools/source/control/roadmap.cxx	9 Mar 2005 23:09:59 -0000	1.2.52.4
@@ -689,7 +689,7 @@ namespace svt
     }
 
 	//---------------------------------------------------------------------
-    sal_Int32 ORoadmap::PreNotify( NotifyEvent& _rNEvt )
+    long ORoadmap::PreNotify( NotifyEvent& _rNEvt )
     {
         // capture KeyEvents for taskpane cycling
         if ( _rNEvt.GetType() == EVENT_KEYINPUT )
Index: svtools/source/control/taskmisc.cxx
===================================================================
RCS file: /cvs/util/svtools/source/control/taskmisc.cxx,v
retrieving revision 1.2
retrieving revision 1.2.16.1
diff -u -p -u -p -r1.2 -r1.2.16.1
--- svtools/source/control/taskmisc.cxx	16 Jun 2004 10:13:08 -0000	1.2
+++ svtools/source/control/taskmisc.cxx	21 Jul 2004 17:34:09 -0000	1.2.16.1
@@ -307,10 +307,10 @@ void WindowArrange::ImplCascade( const R
 	long		nRectHeight = nHeight;
 	long		nOff;
 	long		nCascadeWins;
-	long		nLeftBorder;
-	long		nTopBorder;
-	long		nRightBorder;
-	long		nBottomBorder;
+	sal_Int32	nLeftBorder;
+	sal_Int32	nTopBorder;
+	sal_Int32	nRightBorder;
+	sal_Int32	nBottomBorder;
 	long		nStartOverWidth;
 	long		nStartOverHeight;
 	long		nOverWidth = 0;
Index: svtools/source/edit/svmedit.cxx
===================================================================
RCS file: /cvs/util/svtools/source/edit/svmedit.cxx,v
retrieving revision 1.28
retrieving revision 1.26.64.2
diff -u -p -u -p -r1.28 -r1.26.64.2
--- svtools/source/edit/svmedit.cxx	20 Sep 2004 14:10:21 -0000	1.28
+++ svtools/source/edit/svmedit.cxx	19 Oct 2004 16:45:46 -0000	1.26.64.2
@@ -1238,7 +1238,7 @@ Size MultiLineEdit::CalcMinimumSize() co
 {
 	Size aSz = pImpSvMEdit->CalcMinimumSize();
 
-	long nLeft, nTop, nRight, nBottom;
+	sal_Int32 nLeft, nTop, nRight, nBottom;
 	((Window*)this)->GetBorder( nLeft, nTop, nRight, nBottom );
 	aSz.Width() += nLeft+nRight;
 	aSz.Height() += nTop+nBottom;
@@ -1249,14 +1249,14 @@ Size MultiLineEdit::CalcMinimumSize() co
 Size MultiLineEdit::CalcAdjustedSize( const Size& rPrefSize ) const
 {
 	Size aSz = rPrefSize;
-	long nLeft, nTop, nRight, nBottom;
+	sal_Int32 nLeft, nTop, nRight, nBottom;
 	((Window*)this)->GetBorder( nLeft, nTop, nRight, nBottom );
 
 	// In der Hoehe auf ganze Zeilen justieren
 
-	long nHeight = aSz.Height() - nTop - nBottom;
-	long nLineHeight = pImpSvMEdit->CalcSize( 1, 1 ).Height();
-	long nLines = nHeight / nLineHeight;
+	sal_Int32 nHeight = aSz.Height() - nTop - nBottom;
+	sal_Int32 nLineHeight = pImpSvMEdit->CalcSize( 1, 1 ).Height();
+	sal_Int32 nLines = nHeight / nLineHeight;
 	if ( nLines < 1 )
 		nLines = 1;
 
@@ -1270,7 +1270,7 @@ Size MultiLineEdit::CalcSize( USHORT nCo
 {
 	Size aSz = pImpSvMEdit->CalcSize( nColumns, nLines );
 
-	long nLeft, nTop, nRight, nBottom;
+	sal_Int32 nLeft, nTop, nRight, nBottom;
 	((Window*)this)->GetBorder( nLeft, nTop, nRight, nBottom );
 	aSz.Width() += nLeft+nRight;
 	aSz.Height() += nTop+nBottom;
@@ -1389,13 +1389,13 @@ void MultiLineEdit::Draw( OutputDevice* 
 
 	XubString aText = GetText();
 	Size aTextSz( pDev->GetTextWidth( aText ), pDev->GetTextHeight() );
-	ULONG nLines = (ULONG) (aSize.Height() / aTextSz.Height());
+	sal_uInt32 nLines = (sal_uInt32) (aSize.Height() / aTextSz.Height());
 	if ( !nLines )
 		nLines = 1;
 	aTextSz.Height() = nLines*aTextSz.Height();
-	long nOnePixel = GetDrawPixel( pDev, 1 );
-	long nOffX = 3*nOnePixel;
-	long nOffY = 2*nOnePixel;
+	sal_Int32 nOnePixel = GetDrawPixel( pDev, 1 );
+	sal_Int32 nOffX = 3*nOnePixel;
+	sal_Int32 nOffY = 2*nOnePixel;
 
 	// Clipping?
 	if ( ( nOffY < 0  ) || ( (nOffY+aTextSz.Height()) > aSize.Height() ) || ( (nOffX+aTextSz.Width()) > aSize.Width() ) )
Index: svtools/source/filerec/filerec.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filerec/filerec.cxx,v
retrieving revision 1.4
retrieving revision 1.4.8.1
diff -u -p -u -p -r1.4 -r1.4.8.1
--- svtools/source/filerec/filerec.cxx	17 Jun 2004 13:18:52 -0000	1.4
+++ svtools/source/filerec/filerec.cxx	21 Jul 2004 17:34:10 -0000	1.4.8.1
@@ -68,7 +68,7 @@
 
 //========================================================================
 
-SV_IMPL_VARARR( SfxUINT32s, UINT32 );
+SV_IMPL_VARARR( SfxUINT32s, sal_uInt32 );
 
 //========================================================================
 
@@ -94,21 +94,21 @@ SV_IMPL_VARARR( SfxUINT32s, UINT32 );
 */
 
 #define SFX_REC_MINI_HEADER(nPreTag,nStartPos,nEndPos) \
-					( UINT32(nPreTag) | \
-					  UINT32(nEndPos-nStartPos-SFX_REC_HEADERSIZE_MINI) << 8 )
+					( sal_uInt32(nPreTag) | \
+					  sal_uInt32(nEndPos-nStartPos-SFX_REC_HEADERSIZE_MINI) << 8 )
 
 #define SFX_REC_HEADER(nRecType,nContentTag,nContentVer) \
-					( UINT32(nRecType) | \
-					  ( UINT32(nContentVer) << 8 ) | \
-					  ( UINT32(nContentTag) << 16 ) )
+					( sal_uInt32(nRecType) | \
+					  ( sal_uInt32(nContentVer) << 8 ) | \
+					  ( sal_uInt32(nContentTag) << 16 ) )
 
 #define SFX_REC_CONTENT_HEADER(nContentVer,n1StStartPos,nCurStartPos) \
-					( UINT32(nContentVer) | \
-					  UINT32( nCurStartPos - n1StStartPos ) << 8 )
+					( sal_uInt32(nContentVer) | \
+					  sal_uInt32( nCurStartPos - n1StStartPos ) << 8 )
 
 //=========================================================================
 
-UINT32 SfxMiniRecordWriter::Close
+sal_uInt32 SfxMiniRecordWriter::Close
 (
 	FASTBOOL	bSeekToEndOfRec 	/*	TRUE (default)
 										Der Stream wird an das Ende des Records
@@ -131,7 +131,7 @@ UINT32 SfxMiniRecordWriter::Close
 
 	[R"uckgabewert]
 
-	UINT32		!= 0
+	sal_uInt32	!= 0
 				Position im Stream, die direkt hinter dem Record liegt.
 				'bSeekToEndOfRecord==TRUE'
 				=> R"uckgabewert == aktuelle Stream-Position nach Aufruf
@@ -145,13 +145,13 @@ UINT32 SfxMiniRecordWriter::Close
 	if ( !_bHeaderOk )
 	{
 		// Header an den Anfang des Records schreiben
-		UINT32 nEndPos = _pStream->Tell();
-		_pStream->Seek( _nStartPos );
+		sal_uInt32 nEndPos = svstream_Size_to_u32( _pStream->Tell() );
+		_pStream->Seek( svstream_u32_to_Size(_nStartPos) );
 		*_pStream << SFX_REC_MINI_HEADER( _nPreTag, _nStartPos, nEndPos );
 
 		// je nachdem ans Ende des Records seeken oder hinter Header bleiben
 		if ( bSeekToEndOfRec )
-			_pStream->Seek( nEndPos );
+			_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 
 		// Header wurde JETZT geschrieben
 		_bHeaderOk = TRUE;
@@ -162,14 +162,14 @@ UINT32 SfxMiniRecordWriter::Close
 	else if ( SFX_BOOL_DONTCARE == _bHeaderOk )
 	{
 		// Header auslesen, um Soll-Gr"o\se zu bestimmen
-		UINT32 nEndPos = _pStream->Tell();
-		_pStream->Seek( _nStartPos );
-		ULONG nHeader;
+		sal_uInt32 nEndPos = svstream_Size_to_u32( _pStream->Tell() );
+		_pStream->Seek( svstream_u32_to_Size(_nStartPos) );
+		sal_uInt32 nHeader;
 		*_pStream >> nHeader;
-		_pStream->Seek( nEndPos );
+		_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 
 		// Soll-Gr"o\se mit Ist-Gr"o\se vergleichen
-		DBG_ASSERT( nEndPos - SFX_REC_OFS(nHeader) == _nStartPos + sizeof(UINT32),
+		DBG_ASSERT( nEndPos - SFX_REC_OFS(nHeader) == _nStartPos + sizeof(sal_uInt32),
 					"fixed record size incorrect" );
 		DbgOutf( "SfxFileRec: written record until %ul", nEndPos );
 	}
@@ -211,7 +211,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 	[R"uckgabewert]
 
-	USHORT							SFX_REC_TYPE_EOR
+	sal_uInt16						SFX_REC_TYPE_EOR
 									An der aktuellen Position des Streams
 									steht eine End-Of-Records-Kennung.
 
@@ -256,11 +256,11 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 {
 	// die ersten 4 Bytes als Mini-Header lesen
-	ULONG nHeader;
+	sal_uInt32 nHeader;
 	*pStream >> nHeader;
 
 	// k"onnte es sich um einen extended-Record handeln?
-	USHORT nPreTag = SFX_REC_PRE(nHeader);
+	sal_uInt16 nPreTag = SFX_REC_PRE(nHeader);
 	if ( SFX_REC_PRETAG_EXT == nPreTag )
 	{
 		// die n"achsten 4 Bytes als extended-Header lesen
@@ -270,7 +270,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 		pStream->SeekRel(-8);
 
 		// liegt eine g"ultige Record-Kennung vor?
-		USHORT nType = SFX_REC_TYP(nHeader);
+		sal_uInt16 nType = SFX_REC_TYP(nHeader);
 		if ( nType >= SFX_REC_TYPE_FIRST && nType <= SFX_REC_TYPE_LAST )
 			// entsprechenden extended-Record-Typ zur"uckliefern
 			return nType;
@@ -287,7 +287,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 		return nPreTag;
 
 	// liegt ein Drawin-Engine-Record vor?
-	if ( nHeader == UINT32(*"DRMD") || nHeader == UINT32(*"DRVW") )
+	if ( nHeader == sal_uInt32(*"DRMD") || nHeader == sal_uInt32(*"DRVW") )
 		return SFX_REC_TYPE_DRAWENG;
 
 	// alle anderen sind grunds"atzlich g"ultige Mini-Records
@@ -296,7 +296,7 @@ USHORT SfxMiniRecordReader::ScanRecordTy
 
 //-------------------------------------------------------------------------
 
-FASTBOOL SfxMiniRecordReader::SetHeader_Impl( UINT32 nHeader )
+FASTBOOL SfxMiniRecordReader::SetHeader_Impl( sal_uInt32 nHeader )
 
 /*	[Beschreibung]
 
@@ -311,7 +311,7 @@ FASTBOOL SfxMiniRecordReader::SetHeader_
 	FASTBOOL bRet = TRUE;
 
 	// Record-Ende und Pre-Tag aus dem Header ermitteln
-	_nEofRec = _pStream->Tell() + SFX_REC_OFS(nHeader);
+	_nEofRec = svstream_Size_to_u32(_pStream->Tell()) + SFX_REC_OFS(nHeader);
 	_nPreTag = SFX_REC_PRE(nHeader);
 
 	// wenn End-Of-Record-Kennung, dann Fehler
@@ -348,9 +348,9 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	_bSkipped( FALSE )
 {
 	// Header einlesen
-	UINT32 nStartPos = pStream->Tell(); // um im Fehlerfall zur"uck zu-seeken
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() ); // um im Fehlerfall zur"uck zu-seeken
 	DBG( DbgOutf( "SfxFileRec: reading record at %ul", nStartPos ) );
-	UINT32 nHeader;
+	sal_uInt32 nHeader;
 	*pStream >> nHeader;
 
 	// Headerdaten extrahieren
@@ -362,7 +362,7 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	else if ( _nPreTag == SFX_REC_PRETAG_EOR )
 		pStream->SetError( ERRCODE_IO_WRONGFORMAT );
 	if ( !IsValid() )
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 }
 
 //-------------------------------------------------------------------------
@@ -373,7 +373,7 @@ SfxMiniRecordReader::SfxMiniRecordReader
 										Position sich ein <SfxMiniRecord>
 										befindet.
 									*/
-	BYTE			nTag			//	Pre-Tag des gew"unschten Records
+	sal_uInt8		nTag			//	Pre-Tag des gew"unschten Records
 )
 
 /*	[Beschreibung]
@@ -420,14 +420,14 @@ SfxMiniRecordReader::SfxMiniRecordReader
 	}
 
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// passenden Record suchen
 	while(TRUE)
 	{
 		// Header lesen
 		DBG( DbgOutf( "SfxFileRec: searching record at %ul", pStream->Tell() ) );
-		UINT32 nHeader;
+		sal_uInt32 nHeader;
 		*pStream >> nHeader;
 
 		// Headerdaten von Basisklasse extrahieren lassen
@@ -445,12 +445,12 @@ SfxMiniRecordReader::SfxMiniRecordReader
 				break;
 
 			// sonst skippen und weitersuchen
-			pStream->Seek( _nEofRec );
+			pStream->Seek( svstream_u32_to_Size(_nEofRec) );
 			continue;
 		}
 
 		// Fehler => zur"uck-seeken
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 		break;
 	}
 }
@@ -459,10 +459,10 @@ SfxMiniRecordReader::SfxMiniRecordReader
 
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
-	BYTE			nRecordType,	// f"ur Subklassen
+	sal_uInt8		nRecordType,	// f"ur Subklassen
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer 	// Inhalts-Versions-Kennung
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer 	// Inhalts-Versions-Kennung
 )
 
 /*	[Beschreibung]
@@ -481,8 +481,8 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer 	// Inhalts-Versions-Kennung
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer 	// Inhalts-Versions-Kennung
 )
 
 /*	[Beschreibung]
@@ -503,9 +503,9 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 SfxSingleRecordWriter::SfxSingleRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Inhalts-Art-Kennung
-	BYTE			nContentVer,	// Inhalts-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se des Inhalts in Bytes
+	sal_uInt16	nContentTag,	// Inhalts-Art-Kennung
+	sal_uInt8		nContentVer,	// Inhalts-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se des Inhalts in Bytes
 )
 
 /*  [Beschreibung]
@@ -523,7 +523,7 @@ SfxSingleRecordWriter::SfxSingleRecordWr
 
 //=========================================================================
 
-inline FASTBOOL SfxSingleRecordReader::ReadHeader_Impl( USHORT nTypes )
+inline FASTBOOL SfxSingleRecordReader::ReadHeader_Impl( sal_uInt16 nTypes )
 
 /*  [Beschreibung]
 
@@ -537,7 +537,7 @@ inline FASTBOOL SfxSingleRecordReader::R
 	FASTBOOL bRet;
 
 	// Basisklassen-Header einlesen
-	UINT32 nHeader;
+	sal_uInt32 nHeader;
 	*_pStream >> nHeader;
 	if ( !SetHeader_Impl( nHeader ) )
 		bRet = FALSE;
@@ -561,7 +561,7 @@ SfxSingleRecordReader::SfxSingleRecordRe
 :	SfxMiniRecordReader()
 {
 	// Startposition merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 	DBG( DbgOutf( "SfxFileRec: reading record at %ul", nStartPos ) );
 
 	// Basisklasse initialisieren (nicht via Ctor, da der nur MiniRecs akzept.)
@@ -578,17 +578,17 @@ SfxSingleRecordReader::SfxSingleRecordRe
 
 //-------------------------------------------------------------------------
 
-SfxSingleRecordReader::SfxSingleRecordReader( SvStream *pStream, USHORT nTag )
+SfxSingleRecordReader::SfxSingleRecordReader( SvStream *pStream, sal_uInt16 nTag )
 {
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// richtigen Record suchen, ggf. Error-Code setzen und zur"uck-seeken
 	Construct_Impl( pStream );
 	if ( !FindHeader_Impl( SFX_REC_TYPE_SINGLE, nTag ) )
 	{
 		// Error-Code setzen und zur"uck-seeken
-		pStream->Seek( nStartPos );
+		pStream->Seek( svstream_u32_to_Size(nStartPos) );
 		pStream->SetError( ERRCODE_IO_WRONGFORMAT );
 	}
 }
@@ -597,8 +597,8 @@ SfxSingleRecordReader::SfxSingleRecordRe
 
 FASTBOOL SfxSingleRecordReader::FindHeader_Impl
 (
-	UINT16		nTypes, 	// arithm. Veroderung erlaubter Record-Typen
-	UINT16		nTag		// zu findende Record-Art-Kennung
+	sal_uInt16		nTypes, 	// arithm. Veroderung erlaubter Record-Typen
+	sal_uInt16		nTag		// zu findende Record-Art-Kennung
 )
 
 /*	[Beschreibung]
@@ -613,13 +613,13 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 {
 	// StartPos merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	UINT32 nStartPos = _pStream->Tell();
+	sal_uInt32 nStartPos = svstream_Size_to_u32( _pStream->Tell() );
 
 	// richtigen Record suchen
 	while ( !_pStream->IsEof() )
 	{
 		// Header lesen
-		UINT32 nHeader;
+		sal_uInt32 nHeader;
 		DBG( DbgOutf( "SfxFileRec: searching record at %ul", _pStream->Tell() ) );
 		*_pStream >> nHeader;
 		if ( !SetHeader_Impl( nHeader ) )
@@ -649,12 +649,12 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 		// sonst skippen
 		if ( !_pStream->IsEof() )
-			_pStream->Seek( _nEofRec );
+			_pStream->Seek( svstream_u32_to_Size(_nEofRec) );
 	}
 
 	// Fehler setzen und zur"uck-seeken
 	_pStream->SetError( ERRCODE_IO_WRONGFORMAT );
-	_pStream->Seek( nStartPos );
+	_pStream->Seek( svstream_u32_to_Size(nStartPos) );
 	return FALSE;
 }
 
@@ -662,11 +662,11 @@ FASTBOOL SfxSingleRecordReader::FindHead
 
 SfxMultiFixRecordWriter::SfxMultiFixRecordWriter
 (
-	BYTE			nRecordType,	// Subklassen Record-Kennung
+	sal_uInt8		nRecordType,	// Subklassen Record-Kennung
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Content-Art-Kennung
-	BYTE			nContentVer,	// Content-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
+	sal_uInt16	nContentTag,	// Content-Art-Kennung
+	sal_uInt8		nContentVer,	// Content-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
 )
 
 /*  [Beschreibung]
@@ -686,9 +686,9 @@ SfxMultiFixRecordWriter::SfxMultiFixReco
 SfxMultiFixRecordWriter::SfxMultiFixRecordWriter
 (
 	SvStream*		pStream,		// Stream, in dem der Record angelegt wird
-	UINT16			nContentTag,	// Content-Art-Kennung
-	BYTE			nContentVer,	// Content-Versions-Kennung
-	UINT32			nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
+	sal_uInt16	nContentTag,	// Content-Art-Kennung
+	sal_uInt8		nContentVer,	// Content-Versions-Kennung
+	sal_uInt32	nContentSize	// Gr"o\se jedes einzelnen Contents in Bytes
 )
 
 /*  [Beschreibung]
@@ -707,7 +707,7 @@ SfxMultiFixRecordWriter::SfxMultiFixReco
 
 //------------------------------------------------------------------------
 
-UINT32 SfxMultiFixRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+sal_uInt32 SfxMultiFixRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 //	siehe <SfxMiniRecordWriter>
 
@@ -716,7 +716,7 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 	if ( !_bHeaderOk )
 	{
 		// Position hinter Record merken, um sie restaurieren zu k"onnen
-		UINT32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
+		sal_uInt32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
 
 		// gegen"uber SfxSingleRecord erweiterten Header schreiben
 		*_pStream << _nContentCount;
@@ -724,7 +724,7 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 
 		// je nachdem ans Ende des Records seeken oder hinter Header bleiben
 		if ( bSeekToEndOfRec )
-			_pStream->Seek(nEndPos);
+			_pStream->Seek( svstream_u32_to_Size(nEndPos) );
 		return nEndPos;
 	}
 
@@ -736,10 +736,10 @@ UINT32 SfxMultiFixRecordWriter::Close( F
 
 SfxMultiVarRecordWriter::SfxMultiVarRecordWriter
 (
-	BYTE			nRecordType,	// Record-Kennung der Subklasse
-	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	UINT16			nRecordTag, 	// Gesamt-Art-Kennung
-	BYTE			nRecordVer		// Gesamt-Versions-Kennung
+	sal_uInt8		nRecordType,	// Record-Kennung der Subklasse
+	SvStream*		pStream,        // Stream, in dem der Record angelegt wird
+	sal_uInt16	nRecordTag, 	// Gesamt-Art-Kennung
+	sal_uInt8		nRecordVer		// Gesamt-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -757,8 +757,8 @@ SfxMultiVarRecordWriter::SfxMultiVarReco
 SfxMultiVarRecordWriter::SfxMultiVarRecordWriter
 (
 	SvStream*       pStream,        // Stream, in dem der Record angelegt wird
-	UINT16			nRecordTag, 	// Gesamt-Art-Kennung
-	BYTE			nRecordVer		// Gesamt-Versions-Kennung
+	sal_uInt16	nRecordTag, 	// Gesamt-Art-Kennung
+	sal_uInt8		nRecordVer		// Gesamt-Versions-Kennung
 )
 
 /*  [Beschreibung]
@@ -826,13 +826,13 @@ void SfxMultiVarRecordWriter::NewContent
 		FlushContent_Impl();
 
 	// neuen Content beginnen
-	_nContentStartPos = _pStream->Tell();
+	_nContentStartPos = svstream_Size_to_u32( _pStream->Tell() );
 	++_nContentCount;
 }
 
 //-------------------------------------------------------------------------
 
-UINT32 SfxMultiVarRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
+sal_uInt32 SfxMultiVarRecordWriter::Close( FASTBOOL bSeekToEndOfRec )
 
 // siehe <SfxMiniRecordWriter>
 
@@ -845,30 +845,30 @@ UINT32 SfxMultiVarRecordWriter::Close( F
 			FlushContent_Impl();
 
 		// Content-Offset-Tabelle schreiben
-		UINT32 nContentOfsPos = _pStream->Tell();
+		sal_uInt32 nContentOfsPos = svstream_Size_to_u32( _pStream->Tell() );
 		//! darf man das so einr"ucken?
 		#if defined(OSL_LITENDIAN)
 			_pStream->Write( _aContentOfs.GetData(),
-							 sizeof(UINT32)*_nContentCount );
+							 svstream_u32_to_Size(sizeof(sal_uInt32)*_nContentCount) );
 		#else
-			for ( USHORT n = 0; n < _nContentCount; ++n )
-				*_pStream << UINT32(_aContentOfs[n]);
+			for ( sal_uInt16 n = 0; n < _nContentCount; ++n )
+				*_pStream << sal_uInt32(_aContentOfs[n]);
 		#endif
 
 		// SfxMultiFixRecordWriter::Close() "uberspringen!
-		UINT32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
+		sal_uInt32 nEndPos = SfxSingleRecordWriter::Close( FALSE );
 
 		// eigenen Header schreiben
 		*_pStream << _nContentCount;
 		if ( SFX_REC_TYPE_VARSIZE_RELOC == _nPreTag ||
 			 SFX_REC_TYPE_MIXTAGS_RELOC == _nPreTag )
-			*_pStream << nContentOfsPos - ( _pStream->Tell() + sizeof(UINT32) );
+			*_pStream << nContentOfsPos - (sal_uInt32)( svstream_Size_to_u32(_pStream->Tell()) + sizeof(sal_uInt32) );
 		else
 			*_pStream << nContentOfsPos;
 
 		// ans Ende des Records seeken bzw. am Ende des Headers bleiben
 		if ( bSeekToEndOfRec )
-			 _pStream->Seek(nEndPos);
+			 _pStream->Seek(svstream_u32_to_Size(nEndPos));
 		return nEndPos;
 	}
 
@@ -880,8 +880,8 @@ UINT32 SfxMultiVarRecordWriter::Close( F
 
 void SfxMultiMixRecordWriter::NewContent
 (
-	UINT16		nContentTag,	// Kennung f"ur die Art des Contents
-	BYTE		nContentVer 	// Kennung f"ur die Version des Contents
+	sal_uInt16	nContentTag,	// Kennung f"ur die Art des Contents
+	sal_uInt8		nContentVer 	// Kennung f"ur die Version des Contents
 )
 
 /*	[Beschreibung]
@@ -897,7 +897,7 @@ void SfxMultiMixRecordWriter::NewContent
 		FlushContent_Impl();
 
 	// Tag vor den Content schreiben, Version und Startposition merken
-	_nContentStartPos = _pStream->Tell();
+	_nContentStartPos = svstream_Size_to_u32( _pStream->Tell() );
 	++_nContentCount;
 	*_pStream << nContentTag;
 	_nContentVer = nContentVer;
@@ -924,21 +924,21 @@ FASTBOOL SfxMultiRecordReader::ReadHeade
 	if ( _nRecordType != SFX_REC_TYPE_FIXSIZE )
 	{
 		// Tabelle aus dem Stream einlesen
-		UINT32 nContentPos = _pStream->Tell();
+		sal_uInt32 nContentPos = svstream_Size_to_u32( _pStream->Tell() );
 		if ( _nRecordType == SFX_REC_TYPE_VARSIZE_RELOC ||
 			 _nRecordType == SFX_REC_TYPE_MIXTAGS_RELOC )
-			_pStream->SeekRel( + _nContentSize );
+			_pStream->SeekRel( + svstream_u32_to_Size(_nContentSize) );
 		else
-			_pStream->Seek( _nContentSize );
-		_pContentOfs = new UINT32[_nContentCount];
+			_pStream->Seek( svstream_u32_to_Size(_nContentSize) );
+		_pContentOfs = new sal_uInt32[_nContentCount];
 		//! darf man jetzt so einr"ucken
 		#if defined(OSL_LITENDIAN)
-			_pStream->Read( _pContentOfs, sizeof(UINT32)*_nContentCount );
+			_pStream->Read( _pContentOfs, svstream_u32_to_Size(sizeof(sal_uInt32)*_nContentCount) );
 		#else
-			for ( USHORT n = 0; n < _nContentCount; ++n )
+			for ( sal_uInt16 n = 0; n < _nContentCount; ++n )
 				*_pStream >> _pContentOfs[n];
 		#endif
-		_pStream->Seek( nContentPos );
+		_pStream->Seek( svstream_u32_to_Size(nContentPos) );
 	}
 
 	// Header konnte gelesen werden, wenn am Stream kein Error gesetzt ist
@@ -951,7 +951,7 @@ SfxMultiRecordReader::SfxMultiRecordRead
 :	_nContentNo(0), _pContentOfs( NULL )
 {
 	// Position im Stream merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	_nStartPos = pStream->Tell();
+	_nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// Basisklasse konstruieren (normaler Ctor w"urde nur SingleRecs lesen)
 	SfxSingleRecordReader::Construct_Impl( pStream );
@@ -971,7 +971,7 @@ SfxMultiRecordReader::SfxMultiRecordRead
 :	_nContentNo(0)
 {
 	// Position im Stream merken, um im Fehlerfall zur"uck-seeken zu k"onnen
-	_nStartPos = pStream->Tell();
+	_nStartPos = svstream_Size_to_u32( pStream->Tell() );
 
 	// passenden Record suchen und Basisklasse initialisieren
 	SfxSingleRecordReader::Construct_Impl( pStream );
@@ -1015,10 +1015,10 @@ FASTBOOL SfxMultiRecordReader::GetConten
 	if ( _nContentNo < _nContentCount )
 	{
 		// den Stream an den Anfang des Contents positionieren
-		UINT32 nOffset = _nRecordType == SFX_REC_TYPE_FIXSIZE
+		sal_uInt32 nOffset = _nRecordType == SFX_REC_TYPE_FIXSIZE
 					? _nContentNo * _nContentSize
 					: SFX_REC_CONTENT_OFS(_pContentOfs[_nContentNo]);
-		UINT32 nNewPos = _nStartPos + nOffset;
+		sal_uInt32 nNewPos = _nStartPos + nOffset;
 		DBG_ASSERT( nNewPos >= _pStream->Tell(), "SfxMultiRecordReader::GetContent() - New position before current, to much data red!" );
 
 		// #99366#: correct stream pos in every case;
@@ -1027,7 +1027,7 @@ FASTBOOL SfxMultiRecordReader::GetConten
         // gives errors when writing with 5.1 and reading with current
         // versions, so we decided to remove the if clause (KA-05/17/2002)
         // if ( nNewPos > _pStream->Tell() )
-		_pStream->Seek( nNewPos );
+		_pStream->Seek( svstream_u32_to_Size(nNewPos) );
 
 		// ggf. Content-Header lesen
 		if ( _nRecordType == SFX_REC_TYPE_MIXTAGS ||
Index: svtools/source/filter.vcl/filter/dlgexpor.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/filter/dlgexpor.cxx,v
retrieving revision 1.4
retrieving revision 1.4.16.1
diff -u -p -u -p -r1.4 -r1.4.16.1
--- svtools/source/filter.vcl/filter/dlgexpor.cxx	16 Jun 2004 10:16:20 -0000	1.4
+++ svtools/source/filter.vcl/filter/dlgexpor.cxx	21 Jul 2004 17:34:11 -0000	1.4.16.1
@@ -208,7 +208,7 @@ IMPL_LINK( DlgExportPix, OK, void *, EMP
 {
 	// Config-Parameter schreiben
 
-	sal_Int32	nRes = Max( Min( aCbbRes.GetText().ToInt32(), 600L), 75L );
+	sal_Int32	nRes = Max( Min( aCbbRes.GetText().ToInt32(), (sal_Int32)600), (sal_Int32)75 );
 	::com::sun::star::awt::Size aSize(
 		(long)MetricField::ConvertDoubleValue( aMtfSizeX.GetValue(), 2, aMtfSizeX.GetUnit(), MAP_100TH_MM ),
 			(long)MetricField::ConvertDoubleValue( aMtfSizeY.GetValue(), 2, aMtfSizeY.GetUnit(), MAP_100TH_MM ) );
Index: svtools/source/filter.vcl/filter/filter.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/filter/filter.cxx,v
retrieving revision 1.54
retrieving revision 1.48.16.4
diff -u -p -u -p -r1.54 -r1.48.16.4
--- svtools/source/filter.vcl/filter/filter.cxx	16 Feb 2005 18:01:48 -0000	1.54
+++ svtools/source/filter.vcl/filter/filter.cxx	9 Mar 2005 23:15:12 -0000	1.48.16.4
@@ -894,7 +894,7 @@ static Graphic ImpGetScaledGraphic( cons
 				MapMode		aMap( MAP_100TH_INCH );
 
 				sal_Int32	nDPI = rConfigItem.ReadInt32( String( ResId( KEY_RES, pResMgr ) ), 75 );
-				Fraction	aFrac( 1, Min( Max( nDPI, 75L ), 600L ) );
+				Fraction	aFrac( 1, Min( Max( nDPI, 75 ), 600 ) );
 
 				aMap.SetScaleX( aFrac );
 				aMap.SetScaleY( aFrac );
Index: svtools/source/filter.vcl/wmf/emfwr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/emfwr.cxx,v
retrieving revision 1.10
retrieving revision 1.10.16.1
diff -u -p -u -p -r1.10 -r1.10.16.1
--- svtools/source/filter.vcl/wmf/emfwr.cxx	16 Jun 2004 10:18:45 -0000	1.10
+++ svtools/source/filter.vcl/wmf/emfwr.cxx	21 Jul 2004 17:34:12 -0000	1.10.16.1
@@ -770,26 +770,26 @@ void EMFWriter::ImplWriteBmpRecord( cons
 
 // -----------------------------------------------------------------------------
 
-void EMFWriter::ImplWriteTextRecord( const Point& rPos, const String rText, const long* pDXArray, UINT32 nWidth )
+void EMFWriter::ImplWriteTextRecord( const Point& rPos, const String rText, const sal_Int32* pDXArray, sal_uInt32 nWidth )
 {
 	UINT32 nLen = rText.Len(), i;
 
 	if( nLen )
 	{
-		unsigned long nNormWidth;
-		long*		pOwnArray;
-		long*		pDX;
+		sal_uInt32	nNormWidth;
+		sal_Int32*	pOwnArray;
+		sal_Int32*	pDX;
 
 		// get text sizes
 		if( pDXArray )
 		{
 			pOwnArray = NULL;
 			nNormWidth = maVDev.GetTextWidth( rText );
-			pDX = (long*) pDXArray;
+			pDX = (sal_Int32*) pDXArray;
 		}
 		else
 		{	
-			pOwnArray = new long[ nLen ];
+			pOwnArray = new sal_Int32[ nLen ];
 			nNormWidth = maVDev.GetTextArray( rText, pOwnArray );
 			pDX = pOwnArray;
 		}
Index: svtools/source/filter.vcl/wmf/emfwr.hxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/emfwr.hxx,v
retrieving revision 1.2
retrieving revision 1.2.612.1
diff -u -p -u -p -r1.2 -r1.2.612.1
--- svtools/source/filter.vcl/wmf/emfwr.hxx	4 Jul 2002 14:58:40 -0000	1.2
+++ svtools/source/filter.vcl/wmf/emfwr.hxx	21 Jul 2004 17:34:12 -0000	1.2.612.1
@@ -115,7 +115,7 @@ private:
 	void				ImplWritePolygonRecord( const Polygon& rPoly, BOOL bClose );
 	void				ImplWritePolyPolygonRecord( const PolyPolygon& rPolyPoly );
 	void				ImplWriteBmpRecord( const Bitmap& rBmp, const Point& rPt, const Size& rSz, UINT32 nROP );
-	void				ImplWriteTextRecord( const Point& rPos, const String rText, const long* pDXArray, UINT32 nWidth );
+	void				ImplWriteTextRecord( const Point& rPos, const String rText, const sal_Int32* pDXArray, sal_uInt32 nWidth );
 
 	void				ImplWrite( const GDIMetaFile& rMtf );
 
Index: svtools/source/filter.vcl/wmf/wmfwr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/wmfwr.cxx,v
retrieving revision 1.20
retrieving revision 1.19.8.3
diff -u -p -u -p -r1.20 -r1.19.8.3
--- svtools/source/filter.vcl/wmf/wmfwr.cxx	6 Jul 2004 12:12:30 -0000	1.20
+++ svtools/source/filter.vcl/wmf/wmfwr.cxx	21 Jan 2005 17:16:36 -0000	1.19.8.3
@@ -655,7 +655,7 @@ sal_Bool WMFWriter::WMFRecord_Escape_Uni
 }
 
 void WMFWriter::WMFRecord_ExtTextOut( const Point & rPoint,
-    const String & rString, const long * pDXAry )
+    const String & rString, const sal_Int32 * pDXAry )
 {
     sal_uInt16 nOriginalTextLen = rString.Len();
 
@@ -669,8 +669,8 @@ void WMFWriter::WMFRecord_ExtTextOut( co
     TrueExtTextOut(rPoint,rString,aByteString,pDXAry);
 }
 
-void WMFWriter::TrueExtTextOut( const Point & rPoint, const String & rString,
-    const ByteString & rByteString, const long * pDXAry )
+void WMFWriter::TrueExtTextOut( const Point & rPoint, const String & rString, 
+    const ByteString & rByteString, const sal_Int32 * pDXAry )
 {
 	WriteRecordHeader( 0, W_META_EXTTEXTOUT );
 	WritePointYX( rPoint );
@@ -920,7 +920,7 @@ void WMFWriter::WMFRecord_StretchDIB( co
 	// erzeugt, schreiben wir zuerst die Bitmap an die richtige Position
 	// Und ueberschreiben hinterher den FILEHEADER mit den Parametern.
 	nPosAnf=pWMF->Tell(); // Position merken, wo Parameter hin sollen
-	*pWMF << (long)0 << (long)0; // 8 bytes auffuellen (diese 8 bytes +
+	*pWMF << (sal_Int32)0 << (sal_Int32)0; // 8 bytes auffuellen (diese 8 bytes +
 								 // 14 bytes ueberfluessigen FILEHEADER
 								 // = 22 bytes Parameter)
 	*pWMF << rBitmap; // Bitmap schreiben
@@ -1291,7 +1291,7 @@ void WMFWriter::WriteRecords( const GDIM
 
 					pVirDev->SetFont( aSrcFont );
 					nLen = aTemp.Len();
-					sal_Int32* pDXAry = nLen ? new long[ nLen ] : NULL;
+					sal_Int32* pDXAry = nLen ? new sal_Int32[ nLen ] : NULL;
 					nNormSize = pVirDev->GetTextArray( aTemp, pDXAry );
 					for ( i = 0; i < ( nLen - 1 ); i++ )
 						pDXAry[ i ] = pDXAry[ i ] * (sal_Int32)pA->GetWidth() / nNormSize;
Index: svtools/source/filter.vcl/wmf/wmfwr.hxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/wmfwr.hxx,v
retrieving revision 1.7
retrieving revision 1.7.380.1
diff -u -p -u -p -r1.7 -r1.7.380.1
--- svtools/source/filter.vcl/wmf/wmfwr.hxx	6 Jun 2003 10:47:51 -0000	1.7
+++ svtools/source/filter.vcl/wmf/wmfwr.hxx	21 Jul 2004 17:34:12 -0000	1.7.380.1
@@ -188,11 +188,11 @@ private:
 	void WMFRecord_DeleteObject(USHORT nObjectHandle);
 	void WMFRecord_Ellipse(const Rectangle & rRect);
 	void WMFRecord_Escape( sal_uInt32 nEsc, sal_uInt32 nLen, const sal_Int8* pData );
-	sal_Bool WMFRecord_Escape_Unicode( const Point& rPoint, const String& rStr, const long * pDXAry );
-	void WMFRecord_ExtTextOut(const Point & rPoint, const String & rString, const long * pDXAry);
+	sal_Bool WMFRecord_Escape_Unicode( const Point& rPoint, const String& rStr, const sal_Int32 * pDXAry );
+	void WMFRecord_ExtTextOut(const Point & rPoint, const String & rString, const sal_Int32 * pDXAry);
 
     void TrueExtTextOut(const Point & rPoint, const String & rString, 
-        const ByteString & rByteString, const long * pDXAry);
+        const ByteString & rByteString, const sal_Int32 * pDXAry);
     void TrueTextOut(const Point & rPoint, const ByteString& rString);
 	void WMFRecord_LineTo(const Point & rPoint);
 	void WMFRecord_MoveTo(const Point & rPoint);
Index: svtools/source/items/rectitem.cxx
===================================================================
RCS file: /cvs/util/svtools/source/items/rectitem.cxx,v
retrieving revision 1.5
retrieving revision 1.5.614.1
diff -u -p -u -p -r1.5 -r1.5.614.1
--- svtools/source/items/rectitem.cxx	28 May 2002 14:17:17 -0000	1.5
+++ svtools/source/items/rectitem.cxx	21 Jul 2004 17:34:13 -0000	1.5.614.1
@@ -194,10 +194,10 @@ BOOL SfxRectangleItem::QueryValue( com::
 											 aVal.getHeight() );
             break;
         }
-        case MID_RECT_LEFT:  rVal <<= aVal.getX(); break;
-        case MID_RECT_RIGHT: rVal <<= aVal.getY(); break;
-        case MID_WIDTH: rVal <<= aVal.getWidth(); break;
-        case MID_HEIGHT: rVal <<= aVal.getHeight(); break;
+        case MID_RECT_LEFT:  rVal <<= (sal_Int32)aVal.getX(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_RECT_RIGHT: rVal <<= (sal_Int32)aVal.getY(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_WIDTH: rVal <<=  (sal_Int32)aVal.getWidth(); break;	// FIXME: possible truncation in 64-bit mode
+        case MID_HEIGHT: rVal <<= (sal_Int32)aVal.getHeight(); break;	// FIXME: possible truncation in 64-bit mode
         default: DBG_ERROR("Wrong MemberID!"); return FALSE;
     }
 
Index: svtools/source/items/szitem.cxx
===================================================================
RCS file: /cvs/util/svtools/source/items/szitem.cxx,v
retrieving revision 1.4
retrieving revision 1.4.614.1
diff -u -p -u -p -r1.4 -r1.4.614.1
--- svtools/source/items/szitem.cxx	28 May 2002 11:37:16 -0000	1.4
+++ svtools/source/items/szitem.cxx	21 Jul 2004 17:34:13 -0000	1.4.614.1
@@ -198,9 +198,9 @@ BOOL  SfxSizeItem::QueryValue( com::sun:
             break;
         }
         case MID_WIDTH:
-            rVal <<= aTmp.getWidth(); break;
+            rVal <<= (sal_Int32)aTmp.getWidth(); break;	// FIXME: possible truncation in 64-bit mode
         case MID_HEIGHT:
-            rVal <<= aTmp.getHeight(); break;
+            rVal <<= (sal_Int32)aTmp.getHeight(); break;	// FIXME: possible truncation in 64-bit mode
         default: DBG_ERROR("Wrong MemberId!"); return FALSE;
     }
 
Index: svtools/source/misc/flbytes.cxx
===================================================================
RCS file: /cvs/util/svtools/source/misc/flbytes.cxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.1
--- svtools/source/misc/flbytes.cxx	18 Sep 2000 16:59:02 -0000	1.1.1.1
+++ svtools/source/misc/flbytes.cxx	21 Jul 2004 17:34:14 -0000	1.1.1.1.650.1
@@ -79,9 +79,9 @@ namespace unnamed_svtools_flbytes {} usi
 //============================================================================
 namespace unnamed_svtools_flbytes {
 
-inline ULONG MyMin( long a, long b )
+inline sal_Int32 MyMin( sal_Int32 a, sal_Int32 b )
 {
-	return Max( long( Min(  a ,  b ) ), 0L );
+	return Max( sal_Int32( Min(  a ,  b ) ), 0 );
 }
 
 }
@@ -103,14 +103,14 @@ SvFillLockBytes::SvFillLockBytes( SvLock
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::ReadAt( ULONG nPos, void* pBuffer, ULONG nCount,
-							 ULONG *pRead ) const
+ErrCode SvFillLockBytes::ReadAt( sal_Size nPos, void* pBuffer, sal_Size nCount,
+							 sal_Size *pRead ) const
 {
 	if( bTerminated )
 		return xLockBytes->ReadAt( nPos, pBuffer, nCount, pRead );
 	else
 	{
-		ULONG nWanted = nPos + nCount;
+		sal_Size nWanted = nPos + nCount;
 		if( IsSynchronMode() )
 		{
 			while( nWanted > nFilledSize && !bTerminated )
@@ -119,8 +119,8 @@ ErrCode SvFillLockBytes::ReadAt( ULONG n
 		}
 		else
 		{
-			ULONG nRead = MyMin( nCount, long( nFilledSize ) - nPos );
-			ULONG nErr = xLockBytes->ReadAt( nPos, pBuffer, nRead, pRead );
+			sal_Size nRead = MyMin( nCount, sal_Size( nFilledSize ) - nPos );
+			sal_Size nErr = xLockBytes->ReadAt( nPos, pBuffer, nRead, pRead );
 			return ( !nCount || nRead == nCount || nErr ) ?
 				nErr : ERRCODE_IO_PENDING;
 		}
@@ -128,14 +128,14 @@ ErrCode SvFillLockBytes::ReadAt( ULONG n
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::WriteAt( ULONG nPos, const void* pBuffer,
-								  ULONG nCount, ULONG *pWritten )
+ErrCode SvFillLockBytes::WriteAt( sal_Size nPos, const void* pBuffer,
+								  sal_Size nCount, sal_Size *pWritten )
 {
 	if( bTerminated )
 		return xLockBytes->WriteAt( nPos, pBuffer, nCount, pWritten );
 	else
 	{
-		ULONG nWanted = nPos + nCount;
+		sal_Size nWanted = nPos + nCount;
 		if( IsSynchronMode() )
 		{
 			while( nWanted > nFilledSize && !bTerminated )
@@ -144,8 +144,8 @@ ErrCode SvFillLockBytes::WriteAt( ULONG 
 		}
 		else
 		{
-			ULONG nRead = MyMin( nCount, long( nFilledSize ) - nPos );
-			ULONG nErr = xLockBytes->WriteAt( nPos, pBuffer, nRead, pWritten );
+			sal_Size nRead = MyMin( nCount, sal_Size( nFilledSize ) - nPos );
+			sal_Size nErr = xLockBytes->WriteAt( nPos, pBuffer, nRead, pWritten );
 			return ( !nCount || nRead == nCount || nErr ) ?
 				nErr : ERRCODE_IO_PENDING;
 		}
@@ -159,20 +159,20 @@ ErrCode SvFillLockBytes::Flush() const
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::SetSize( ULONG nSize )
+ErrCode SvFillLockBytes::SetSize( sal_Size nSize )
 {
 	return xLockBytes->SetSize( nSize );
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::LockRegion( ULONG nPos, ULONG nCount, LockType eType)
+ErrCode SvFillLockBytes::LockRegion( sal_Size nPos, sal_Size nCount, LockType eType)
 {
 	return xLockBytes->LockRegion( nPos, nCount, eType );
 }
 
 //============================================================================
 ErrCode SvFillLockBytes::UnlockRegion(
-	ULONG nPos, ULONG nCount, LockType eType)
+	sal_Size nPos, sal_Size nCount, LockType eType)
 {
 	return xLockBytes->UnlockRegion( nPos, nCount, eType );
 }
@@ -185,7 +185,7 @@ ErrCode SvFillLockBytes::Stat(
 }
 
 //============================================================================
-ErrCode SvFillLockBytes::FillAppend( const void* pBuffer, ULONG nCount, ULONG *pWritten )
+ErrCode SvFillLockBytes::FillAppend( const void* pBuffer, sal_Size nCount, sal_Size *pWritten )
 {
 	ErrCode nRet = xLockBytes->WriteAt(
 		nFilledSize, pBuffer, nCount, pWritten );
@@ -212,12 +212,12 @@ TYPEINIT1(SvSyncLockBytes, SvOpenLockByt
 
 //============================================================================
 // virtual
-ErrCode SvSyncLockBytes::ReadAt(ULONG nPos, void * pBuffer, ULONG nCount,
-								ULONG * pRead) const
+ErrCode SvSyncLockBytes::ReadAt(sal_Size nPos, void * pBuffer, sal_Size nCount,
+								sal_Size * pRead) const
 {
-	for (ULONG nReadTotal = 0;;)
+	for (sal_Size nReadTotal = 0;;)
 	{
-		ULONG nReadCount = 0;
+		sal_Size nReadCount = 0;
 		ErrCode nError = m_xAsyncLockBytes->ReadAt(nPos, pBuffer, nCount,
 												   &nReadCount);
 		nReadTotal += nReadCount;
@@ -236,12 +236,12 @@ ErrCode SvSyncLockBytes::ReadAt(ULONG nP
 
 //============================================================================
 // virtual
-ErrCode SvSyncLockBytes::WriteAt(ULONG nPos, const void * pBuffer,
-								 ULONG nCount, ULONG * pWritten)
+ErrCode SvSyncLockBytes::WriteAt(sal_Size nPos, const void * pBuffer,
+								 sal_Size nCount, sal_Size * pWritten)
 {
-	for (ULONG nWrittenTotal = 0;;)
+	for (sal_Size nWrittenTotal = 0;;)
 	{
-		ULONG nWrittenCount = 0;
+		sal_Size nWrittenCount = 0;
 		ErrCode nError = m_xAsyncLockBytes->WriteAt(nPos, pBuffer, nCount,
 													&nWrittenCount);
 		nWrittenTotal += nWrittenCount;
@@ -270,34 +270,34 @@ struct SvCompositeLockBytes_Impl
 	SvULongs              aPositions;
 	SvULongs              aOffsets;
 	BOOL                  bPending;
-	ULONG RelativeOffset( ULONG nPos ) const;
+	sal_Size RelativeOffset( sal_Size nPos ) const;
 	ErrCode ReadWrite_Impl(
-		ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pProcessed,
+		sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pProcessed,
 		BOOL bRead );
 	SvCompositeLockBytes_Impl() : bPending( FALSE ){}
 };
 
 //============================================================================
-ULONG SvCompositeLockBytes_Impl::RelativeOffset( ULONG nPos ) const
+sal_Size SvCompositeLockBytes_Impl::RelativeOffset( sal_Size nPos ) const
 {
 	const SvULongs& rPositions = aPositions;
 	const SvULongs& rOffsets = aOffsets;
 
-	USHORT nMinPos = 0;
-	USHORT nListCount = rPositions.Count();
+	sal_uInt16 nMinPos = 0;
+	sal_uInt16 nListCount = rPositions.Count();
 
 	// Erster Lockbytes, der bearbeitet werden muss
 	while( nMinPos + 1 < nListCount && rPositions[ nMinPos + 1 ] <= nPos )
 		nMinPos ++;
-	ULONG nSectionStart = rPositions[ nMinPos ];
+	sal_Size nSectionStart = rPositions[ nMinPos ];
 	if( nSectionStart > nPos )
-		return ULONG_MAX;
+		return SAL_MAX_SIZE;
 	return rOffsets[ nMinPos ] + nPos - nSectionStart;
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes_Impl::ReadWrite_Impl(
-	ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pProcessed,
+	sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pProcessed,
 	BOOL bRead )
 {
 	ErrCode nErr = ERRCODE_NONE;
@@ -305,14 +305,14 @@ ErrCode SvCompositeLockBytes_Impl::ReadW
 	SvULongs& rOffsets = aOffsets;
 	SvLockBytesMemberList& rLockBytes = aLockBytes;
 
-	ULONG nBytes = nCount;
-	USHORT nListCount = rPositions.Count();
-	USHORT nMinPos = 0;
+	sal_Size nBytes = nCount;
+	sal_uInt16 nListCount = rPositions.Count();
+	sal_uInt16 nMinPos = 0;
 
 	// Erster Lockbytes, der bearbeitet werden muss
 	while( nMinPos + 1 < nListCount && rPositions[ nMinPos + 1 ] <= nPos )
 		nMinPos ++;
-	ULONG nSectionStart = rPositions[ nMinPos ];
+	sal_Size nSectionStart = rPositions[ nMinPos ];
 
 	if( nSectionStart > nPos )
 	{
@@ -321,22 +321,22 @@ ErrCode SvCompositeLockBytes_Impl::ReadW
 		return ERRCODE_IO_CANTREAD;
 	}
 
-	ULONG nDone;
+	sal_Size nDone;
 	while( nMinPos < nListCount )
 	{
-		ULONG nToProcess;
-		ULONG nSectionStop;
+		sal_Size nToProcess;
+		sal_Size nSectionStop;
 		if( nMinPos + 1 < nListCount )
 		{
 			nSectionStop = rPositions[ nMinPos + 1 ];
-			nToProcess = MyMin( long( nSectionStop ) - nPos, nBytes );
+			nToProcess = MyMin( sal_sSize( nSectionStop ) - nPos, nBytes );
 		}
 		else
 		{
 			nToProcess = nBytes;
 			nSectionStop = 0;
 		}
-		ULONG nAbsPos = nPos - nSectionStart + rOffsets[ nMinPos ];
+		sal_Size nAbsPos = nPos - nSectionStart + rOffsets[ nMinPos ];
 		SvLockBytes* pLB = rLockBytes.GetObject( nMinPos );
 		if( bRead )
 			nErr = pLB->ReadAt( nAbsPos, pBuffer, nToProcess, &nDone );
@@ -382,21 +382,21 @@ void  SvCompositeLockBytes::SetIsPending
 }
 
 //============================================================================
-ULONG SvCompositeLockBytes::RelativeOffset( ULONG nPos ) const
+sal_Size SvCompositeLockBytes::RelativeOffset( sal_Size nPos ) const
 {
 	return  pImpl->RelativeOffset( nPos );
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes::ReadAt(
-	ULONG nPos, void* pBuffer, ULONG nCount, ULONG* pRead ) const
+	sal_Size nPos, void* pBuffer, sal_Size nCount, sal_Size* pRead ) const
 {
 	return pImpl->ReadWrite_Impl( nPos, pBuffer, nCount, pRead, TRUE );
 }
 
 //============================================================================
 ErrCode SvCompositeLockBytes::WriteAt(
-	ULONG nPos, const void* pBuffer, ULONG nCount, ULONG* pWritten )
+	sal_Size nPos, const void* pBuffer, sal_Size nCount, sal_Size* pWritten )
 {
 	return pImpl->ReadWrite_Impl(
 		nPos, const_cast< void * >(pBuffer), nCount, pWritten, FALSE );
@@ -407,20 +407,20 @@ ErrCode SvCompositeLockBytes::Flush() co
 {
 	SvLockBytesMemberList& rLockBytes = pImpl->aLockBytes;
 	ErrCode nErr = ERRCODE_NONE;
-	for( USHORT nCount = (USHORT)rLockBytes.Count(); !nErr && nCount--; )
+	for( sal_uInt16 nCount = (sal_uInt16)rLockBytes.Count(); !nErr && nCount--; )
 		nErr = rLockBytes.GetObject( nCount )->Flush();
 	return nErr;
 }
 
 //============================================================================
-ErrCode SvCompositeLockBytes::SetSize( ULONG nSize )
+ErrCode SvCompositeLockBytes::SetSize( sal_Size nSize )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
 }
 
 //============================================================================
-ErrCode SvCompositeLockBytes::LockRegion( ULONG nPos, ULONG nCount, LockType )
+ErrCode SvCompositeLockBytes::LockRegion( sal_Size nPos, sal_Size nCount, LockType )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
@@ -428,7 +428,7 @@ ErrCode SvCompositeLockBytes::LockRegion
 
 //============================================================================
 ErrCode SvCompositeLockBytes::UnlockRegion(
-	ULONG nPos, ULONG nCount, LockType )
+	sal_Size nPos, sal_Size nCount, LockType )
 {
 	DBG_ERROR( "not implemented" );
 	return ERRCODE_IO_NOTSUPPORTED;
@@ -438,7 +438,7 @@ ErrCode SvCompositeLockBytes::UnlockRegi
 ErrCode SvCompositeLockBytes::Stat(
 	SvLockBytesStat* pStat, SvLockBytesStatFlag eFlag) const
 {
-	USHORT nMax = pImpl->aPositions.Count() - 1;
+	sal_uInt16 nMax = pImpl->aPositions.Count() - 1;
 
 	SvLockBytesStat aStat;
 	ErrCode nErr = pImpl->aLockBytes.GetObject( nMax )->Stat( &aStat, eFlag );
@@ -449,9 +449,9 @@ ErrCode SvCompositeLockBytes::Stat(
 
 //============================================================================
 void SvCompositeLockBytes::Append(
-	SvLockBytes* pLockBytes, ULONG nPos, ULONG nOffset )
+	SvLockBytes* pLockBytes, sal_Size nPos, sal_Size nOffset )
 {
-	USHORT nCount = pImpl->aOffsets.Count();
+	sal_uInt16 nCount = pImpl->aOffsets.Count();
 	pImpl->aLockBytes.Insert( pLockBytes, nCount );
 	pImpl->aPositions.Insert( nPos, nCount );
 	pImpl->aOffsets.Insert( nOffset, nCount );
Index: svtools/source/misc/graphictools.cxx
===================================================================
RCS file: /cvs/util/svtools/source/misc/graphictools.cxx,v
retrieving revision 1.6
retrieving revision 1.6.8.1
diff -u -p -u -p -r1.6 -r1.6.8.1
--- svtools/source/misc/graphictools.cxx	17 Jun 2004 13:21:09 -0000	1.6
+++ svtools/source/misc/graphictools.cxx	21 Jul 2004 17:34:14 -0000	1.6.8.1
@@ -361,13 +361,13 @@ SvStream& operator<<( SvStream& rOStm, c
     rClass.maEndArrow.Write( rOStm );
     rOStm << rClass.mfTransparency;
     rOStm << rClass.mfStrokeWidth;
-    UINT16 nTmp = rClass.maCapType;
+    sal_uInt16 nTmp = rClass.maCapType;
     rOStm << nTmp;
     nTmp = rClass.maJoinType;
     rOStm << nTmp;
     rOStm << rClass.mfMiterLimit;
 
-    rOStm << (sal_Size)rClass.maDashArray.size();
+    rOStm << svstream_Size_to_u32( rClass.maDashArray.size() );
     size_t i;
     for(i=0; i<rClass.maDashArray.size(); ++i)
         rOStm << rClass.maDashArray[i];
@@ -384,15 +384,16 @@ SvStream& operator>>( SvStream& rIStm, S
     rClass.maEndArrow.Read( rIStm );
     rIStm >> rClass.mfTransparency;
     rIStm >> rClass.mfStrokeWidth;
-    UINT16 nTmp;
+    sal_uInt16 nTmp;
     rIStm >> nTmp;
     rClass.maCapType = SvtGraphicStroke::CapType(nTmp);
     rIStm >> nTmp;
     rClass.maJoinType = SvtGraphicStroke::JoinType(nTmp);
     rIStm >> rClass.mfMiterLimit;
 
-    sal_Size nSize;
-    rIStm >> nSize;
+    sal_uInt32 nTemp;
+    rIStm >> nTemp;
+    sal_Size nSize = svstream_u32_to_Size(nTemp);
     rClass.maDashArray.resize(nSize);
     size_t i;
     for(i=0; i<rClass.maDashArray.size(); ++i)
Index: svtools/source/numbers/numfmuno.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numfmuno.cxx,v
retrieving revision 1.6
retrieving revision 1.6.16.1
diff -u -p -u -p -r1.6 -r1.6.16.1
--- svtools/source/numbers/numfmuno.cxx	16 Jun 2004 10:27:44 -0000	1.6
+++ svtools/source/numbers/numfmuno.cxx	21 Jan 2005 17:16:44 -0000	1.6.16.1
@@ -230,7 +230,7 @@ sal_Int32 SAL_CALL SvNumberFormatterServ
 	if (pFormatter)
 	{
 		String aTemp = aString;
-		ULONG nUKey = nKey;
+		sal_uInt32 nUKey = nKey;
 		double fValue = 0.0;
 		if ( pFormatter->IsNumberFormat(aTemp, nUKey, fValue) )
 			nRet = nUKey;
@@ -254,7 +254,7 @@ double SAL_CALL SvNumberFormatterService
 	if (pFormatter)
 	{
 		String aTemp = aString;
-		ULONG nUKey = nKey;
+		sal_uInt32 nUKey = nKey;
 		double fValue = 0.0;
 		if ( pFormatter->IsNumberFormat(aTemp, nUKey, fValue) )
 			fRet = fValue;
@@ -507,15 +507,15 @@ uno::Sequence<sal_Int32> SAL_CALL SvNumb
 	SvNumberFormatter* pFormatter = pSupplier ? pSupplier->GetNumberFormatter() : NULL;
 	if ( pFormatter )
 	{
-		ULONG nIndex = 0;
+		sal_uInt32 nIndex = 0;
 		LanguageType eLang = lcl_GetLanguage( nLocale );
 		SvNumberFormatTable& rTable = bCreate ?
 										pFormatter->ChangeCL( nType, nIndex, eLang ) :
 										pFormatter->GetEntryTable( nType, nIndex, eLang );
-		ULONG nCount = rTable.Count();
+		sal_uInt32 nCount = rTable.Count();
 		uno::Sequence<sal_Int32> aSeq(nCount);
 		sal_Int32* pAry = aSeq.getArray();
-		for (ULONG i=0; i<nCount; i++)
+		for (sal_uInt32 i=0; i<nCount; i++)
 			pAry[i] = rTable.GetObjectKey( i );
 
 		return aSeq;
@@ -562,7 +562,7 @@ sal_Int32 SAL_CALL SvNumberFormatsObj::a
 	{
 		String aFormStr = aFormat;
 		LanguageType eLang = lcl_GetLanguage( nLocale );
-		ULONG nKey = 0;
+		sal_uInt32 nKey = 0;
 		xub_StrLen nCheckPos = 0;
 		short nType = 0;
 		BOOL bOk = pFormatter->PutEntry( aFormStr, nCheckPos, nType, nKey, eLang );
@@ -594,7 +594,7 @@ sal_Int32 SAL_CALL SvNumberFormatsObj::a
 		String aFormStr = aFormat;
 		LanguageType eLang = lcl_GetLanguage( nLocale );
 		LanguageType eNewLang = lcl_GetLanguage( nNewLocale );
-		ULONG nKey = 0;
+		sal_uInt32 nKey = 0;
 		xub_StrLen nCheckPos = 0;
 		short nType = 0;
 		BOOL bOk = pFormatter->PutandConvertEntry( aFormStr, nCheckPos, nType, nKey, eLang, eNewLang );
Index: svtools/source/numbers/numhead.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numhead.cxx,v
retrieving revision 1.4
retrieving revision 1.4.16.3
diff -u -p -u -p -r1.4 -r1.4.16.3
--- svtools/source/numbers/numhead.cxx	16 Jun 2004 10:27:57 -0000	1.4
+++ svtools/source/numbers/numhead.cxx	21 Jan 2005 17:16:49 -0000	1.4.16.3
@@ -82,7 +82,7 @@
 SvNumReadHeader::SvNumReadHeader(SvStream& rNewStream) :
 	rStream( rNewStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
 	nDataEnd = rStream.Tell() + nDataSize;
 }
@@ -91,7 +91,7 @@ SvNumReadHeader::SvNumReadHeader(SvStrea
 
 SvNumReadHeader::~SvNumReadHeader()
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = rStream.Tell();
 	DBG_ASSERT( nReadEnd <= nDataEnd, "zuviele Bytes gelesen" );
 	if ( nReadEnd != nDataEnd )
 		rStream.Seek(nDataEnd); 					// Rest ueberspringen
@@ -99,9 +99,9 @@ SvNumReadHeader::~SvNumReadHeader()
 
 //#pragma SEG_FUNCDEF(numhead_03)
 
-ULONG SvNumReadHeader::BytesLeft() const
+sal_uInt32 SvNumReadHeader::BytesLeft() const
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = rStream.Tell();
 	if (nReadEnd <= nDataEnd)
 		return nDataEnd-nReadEnd;
 
@@ -113,7 +113,7 @@ ULONG SvNumReadHeader::BytesLeft() const
 
 //#pragma SEG_FUNCDEF(numhead_04)
 
-SvNumWriteHeader::SvNumWriteHeader(SvStream& rNewStream, ULONG nDefault) :
+SvNumWriteHeader::SvNumWriteHeader(SvStream& rNewStream, sal_uInt32 nDefault) :
 	rStream( rNewStream )
 {
 	nDataSize = nDefault;
@@ -125,12 +125,12 @@ SvNumWriteHeader::SvNumWriteHeader(SvStr
 
 SvNumWriteHeader::~SvNumWriteHeader()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = rStream.Tell();
 
 	if ( nPos - nDataPos != nDataSize )				// Default getroffen?
 	{
 		nDataSize = nPos - nDataPos;
-		rStream.Seek(nDataPos - sizeof(ULONG));
+		rStream.Seek(nDataPos - sizeof(sal_uInt32));
 		rStream << nDataSize;						// Groesse am Anfang eintragen
 		rStream.Seek(nPos);
 	}
@@ -145,26 +145,26 @@ SvNumWriteHeader::~SvNumWriteHeader()
 ImpSvNumMultipleReadHeader::ImpSvNumMultipleReadHeader(SvStream& rNewStream) :
 	rStream( rNewStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
-	ULONG nDataPos = rStream.Tell();
+	sal_uInt32 nDataPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryEnd = nDataPos;
 
-	rStream.SeekRel(nDataSize);
-	USHORT nID;
+	rStream.SeekRel(svstream_u32_to_Size(nDataSize));
+	sal_uInt16 nID;
 	rStream >> nID;
 	if (nID != SV_NUMID_SIZES)
 	{
 		DBG_ERROR("SV_NUMID_SIZES nicht gefunden");
 	}
-	ULONG nSizeTableLen;
+	sal_uInt32 nSizeTableLen;
 	rStream >> nSizeTableLen;
 	pBuf = new char[nSizeTableLen];
-	rStream.Read( pBuf, nSizeTableLen );
-	pMemStream = new SvMemoryStream( pBuf, nSizeTableLen, STREAM_READ );
+	rStream.Read( pBuf, svstream_u32_to_Size(nSizeTableLen) );
+	pMemStream = new SvMemoryStream( pBuf, svstream_u32_to_Size(nSizeTableLen), STREAM_READ );
 
-	nEndPos = rStream.Tell();
-	rStream.Seek( nDataPos );
+	nEndPos = svstream_Size_to_u32( rStream.Tell() );
+	rStream.Seek( svstream_u32_to_Size(nDataPos) );
 }
 
 //#pragma SEG_FUNCDEF(numhead_07)
@@ -176,43 +176,43 @@ ImpSvNumMultipleReadHeader::~ImpSvNumMul
 	delete pMemStream;
 	delete [] pBuf;
 
-	rStream.Seek(nEndPos);
+	rStream.Seek(svstream_u32_to_Size(nEndPos));
 }
 
 //! mit ctor synchron
 // static
 void ImpSvNumMultipleReadHeader::Skip( SvStream& rStream )
 {
-	ULONG nDataSize;
+	sal_uInt32 nDataSize;
 	rStream >> nDataSize;
-	rStream.SeekRel( nDataSize );
-	USHORT nID;
+	rStream.SeekRel( svstream_u32_to_Size(nDataSize) );
+	sal_uInt16 nID;
 	rStream >> nID;
 	if ( nID != SV_NUMID_SIZES )
 	{
 		DBG_ERROR("SV_NUMID_SIZES nicht gefunden");
 	}
-	ULONG nSizeTableLen;
+	sal_uInt32 nSizeTableLen;
 	rStream >> nSizeTableLen;
-	rStream.SeekRel( nSizeTableLen );
+	rStream.SeekRel( svstream_u32_to_Size(nSizeTableLen) );
 }
 
 //#pragma SEG_FUNCDEF(numhead_08)
 
 void ImpSvNumMultipleReadHeader::EndEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	DBG_ASSERT( nPos <= nEntryEnd, "zuviel gelesen" );
 	if ( nPos != nEntryEnd )
-		rStream.Seek( nEntryEnd );			// Rest ueberspringen
+		rStream.Seek( svstream_u32_to_Size(nEntryEnd) );	// Rest ueberspringen
 }
 
 //#pragma SEG_FUNCDEF(numhead_0d)
 
 void ImpSvNumMultipleReadHeader::StartEntry()
 {
-	ULONG nPos = rStream.Tell();
-	ULONG nEntrySize;
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
+	sal_uInt32 nEntrySize;
 	(*pMemStream) >> nEntrySize;
 
 	nEntryEnd = nPos + nEntrySize;
@@ -220,9 +220,9 @@ void ImpSvNumMultipleReadHeader::StartEn
 
 //#pragma SEG_FUNCDEF(numhead_09)
 
-ULONG ImpSvNumMultipleReadHeader::BytesLeft() const
+sal_uInt32 ImpSvNumMultipleReadHeader::BytesLeft() const
 {
-	ULONG nReadEnd = rStream.Tell();
+	sal_uInt32 nReadEnd = svstream_Size_to_u32( rStream.Tell() );
 	if (nReadEnd <= nEntryEnd)
 		return nEntryEnd-nReadEnd;
 
@@ -235,14 +235,14 @@ ULONG ImpSvNumMultipleReadHeader::BytesL
 //#pragma SEG_FUNCDEF(numhead_0a)
 
 ImpSvNumMultipleWriteHeader::ImpSvNumMultipleWriteHeader(SvStream& rNewStream,
-												   ULONG nDefault) :
+												   sal_uInt32 nDefault) :
 	rStream( rNewStream ),
 	aMemStream( 4096, 4096 )
 {
 	nDataSize = nDefault;
 	rStream << nDataSize;
 
-	nDataPos = rStream.Tell();
+	nDataPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryStart = nDataPos;
 }
 
@@ -250,19 +250,19 @@ ImpSvNumMultipleWriteHeader::ImpSvNumMul
 
 ImpSvNumMultipleWriteHeader::~ImpSvNumMultipleWriteHeader()
 {
-	ULONG nDataEnd = rStream.Tell();
+	sal_uInt32 nDataEnd = svstream_Size_to_u32( rStream.Tell() );
 
-	rStream << (USHORT) SV_NUMID_SIZES;
-	rStream << aMemStream.Tell();
+	rStream << (sal_uInt16) SV_NUMID_SIZES;
+	rStream << svstream_Size_to_u32( aMemStream.Tell() );
 	rStream.Write( aMemStream.GetData(), aMemStream.Tell() );
 
 	if ( nDataEnd - nDataPos != nDataSize )					// Default getroffen?
 	{
 		nDataSize = nDataEnd - nDataPos;
-		ULONG nPos = rStream.Tell();
-		rStream.Seek(nDataPos-sizeof(ULONG));
+		sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
+		rStream.Seek(svstream_u32_to_Size(nDataPos-sizeof(sal_uInt32)));
 		rStream << nDataSize;								// Groesse am Anfang eintragen
-		rStream.Seek(nPos);
+		rStream.Seek(svstream_u32_to_Size(nPos));
 	}
 }
 
@@ -270,7 +270,7 @@ ImpSvNumMultipleWriteHeader::~ImpSvNumMu
 
 void ImpSvNumMultipleWriteHeader::EndEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	aMemStream << nPos - nEntryStart;
 }
 
@@ -278,7 +278,7 @@ void ImpSvNumMultipleWriteHeader::EndEnt
 
 void ImpSvNumMultipleWriteHeader::StartEntry()
 {
-	ULONG nPos = rStream.Tell();
+	sal_uInt32 nPos = svstream_Size_to_u32( rStream.Tell() );
 	nEntryStart = nPos;
 }
 
Index: svtools/source/numbers/numhead.hxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numhead.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.650.2
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.650.2
--- svtools/source/numbers/numhead.hxx	18 Sep 2000 16:59:03 -0000	1.1.1.1
+++ svtools/source/numbers/numhead.hxx	21 Jan 2005 17:16:54 -0000	1.1.1.1.650.2
@@ -115,7 +115,7 @@ public:
 
 	void	StartEntry();
 	void	EndEntry();
-	ULONG	BytesLeft() const;
+	sal_uInt32	BytesLeft() const;
 
 	static void Skip( SvStream& );		// komplett ueberspringen
 };
@@ -130,7 +130,7 @@ private:
 	ULONG			nEntryStart;
 
 public:
-	ImpSvNumMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault = 0);
+	ImpSvNumMultipleWriteHeader(SvStream& rNewStream, sal_uInt32 nDefault = 0);
 	~ImpSvNumMultipleWriteHeader();
 
 	void	StartEntry();
Index: svtools/source/numbers/numuno.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/numuno.cxx,v
retrieving revision 1.3
retrieving revision 1.3.16.1
diff -u -p -u -p -r1.3 -r1.3.16.1
--- svtools/source/numbers/numuno.cxx	16 Jun 2004 10:28:10 -0000	1.3
+++ svtools/source/numbers/numuno.cxx	21 Jan 2005 15:09:36 -0000	1.3.16.1
@@ -117,7 +117,7 @@ void SvNumberFormatsSupplierObj::SetNumb
 	pImpl->pFormatter = pNew;
 }
 
-void SvNumberFormatsSupplierObj::NumberFormatDeleted(ULONG nKey)
+void SvNumberFormatsSupplierObj::NumberFormatDeleted(sal_uInt32 nKey)
 {
 	//	Basis-Implementierung tut nix...
 }
Index: svtools/source/numbers/zforlist.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/zforlist.cxx,v
retrieving revision 1.53
retrieving revision 1.53.146.1
diff -u -p -u -p -r1.53 -r1.53.146.1
--- svtools/source/numbers/zforlist.cxx	25 Jun 2004 17:27:03 -0000	1.53
+++ svtools/source/numbers/zforlist.cxx	21 Jan 2005 17:17:04 -0000	1.53.146.1
@@ -157,7 +157,7 @@ using namespace ::com::sun::star::lang;
 #define UNKNOWN_SUBSTITUTE		LANGUAGE_ENGLISH_US
 
 static BOOL bIndexTableInitialized = FALSE;
-static ULONG __FAR_DATA theIndexTable[NF_INDEX_TABLE_ENTRIES];
+static sal_uInt32 __FAR_DATA theIndexTable[NF_INDEX_TABLE_ENTRIES];
 
 
 // ====================================================================
@@ -181,7 +181,7 @@ public:
                                 { aFormatters.Insert( pThis, LIST_APPEND ); }
             SvNumberFormatter*  Remove( SvNumberFormatter* pThis )
                                     { return (SvNumberFormatter*)aFormatters.Remove( pThis ); }
-            ULONG           Count()
+            sal_uInt32           Count()
                                 { return aFormatters.Count(); }
 
     virtual void            Notify( SvtBroadcaster& rBC, const SfxHint& rHint );
@@ -463,7 +463,7 @@ void SvNumberFormatter::ImpChangeSysCL( 
 	}
 	else if ( bLoadingSO5 )
 	{	// delete additional standard formats
-		ULONG nKey;
+		sal_uInt32 nKey;
 		aFTable.Seek( SV_MAX_ANZ_STANDARD_FORMATE + 1 );
 		while ( (nKey = aFTable.GetCurKey()) > SV_MAX_ANZ_STANDARD_FORMATE &&
 				nKey < SV_COUNTRY_LANGUAGE_OFFSET )
@@ -477,13 +477,13 @@ void SvNumberFormatter::ImpChangeSysCL( 
 
 void SvNumberFormatter::ReplaceSystemCL( LanguageType eOldLanguage )
 {
-    ULONG nCLOffset = ImpGetCLOffset( LANGUAGE_SYSTEM );
+    sal_uInt32 nCLOffset = ImpGetCLOffset( LANGUAGE_SYSTEM );
     if ( nCLOffset > MaxCLOffset )
         return ;    // no SYSTEM entries to replace
 
-    const ULONG nMaxBuiltin = nCLOffset + SV_MAX_ANZ_STANDARD_FORMATE;
-    const ULONG nNextCL = nCLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
-    ULONG nKey;
+    const sal_uInt32 nMaxBuiltin = nCLOffset + SV_MAX_ANZ_STANDARD_FORMATE;
+    const sal_uInt32 nNextCL = nCLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
+    sal_uInt32 nKey;
 
     // remove old builtin formats
     aFTable.Seek( nCLOffset );
@@ -509,7 +509,7 @@ void SvNumberFormatter::ReplaceSystemCL(
 
     // convert additional and user defined from old system to new system
     SvNumberformat* pStdFormat = (SvNumberformat*) aFTable.Get( nCLOffset + ZF_STANDARD );
-    ULONG nLastKey = nMaxBuiltin;
+    sal_uInt32 nLastKey = nMaxBuiltin;
     pFormatScanner->SetConvertMode( eOldLanguage, LANGUAGE_SYSTEM, TRUE );
     aOldTable.First();
     while ( aOldTable.Count() )
@@ -556,7 +556,7 @@ void SvNumberFormatter::ReplaceSystemCL(
 }
 
 
-BOOL SvNumberFormatter::IsTextFormat(ULONG F_Index) const
+BOOL SvNumberFormatter::IsTextFormat(sal_uInt32 F_Index) const
 {
 	SvNumberformat* pFormat = (SvNumberformat*) aFTable.Get(F_Index);
 	if (!pFormat)
@@ -565,7 +565,7 @@ BOOL SvNumberFormatter::IsTextFormat(ULO
 		return pFormat->IsTextFormat();
 }
 
-BOOL SvNumberFormatter::HasTextFormat(ULONG F_Index) const
+BOOL SvNumberFormatter::HasTextFormat(sal_uInt32 F_Index) const
 {
 	SvNumberformat* pFormat = (SvNumberformat*) aFTable.Get(F_Index);
 	if (!pFormat)
@@ -577,7 +577,7 @@ BOOL SvNumberFormatter::HasTextFormat(UL
 BOOL SvNumberFormatter::PutEntry(String& rString,
 								 xub_StrLen& nCheckPos,
 								 short& nType,
-								 ULONG& nKey,			// Formatnummer
+								 sal_uInt32& nKey,			// Formatnummer
 								 LanguageType eLnge)
 {
 	nKey = 0;
@@ -610,7 +610,7 @@ BOOL SvNumberFormatter::PutEntry(String&
 			p_Entry->SetType(NUMBERFORMAT_DEFINED);
 			nType = NUMBERFORMAT_DEFINED;
 		}
-		ULONG CLOffset = ImpGenerateCL(eLge);				// ggfs. neu Standard-
+		sal_uInt32 CLOffset = ImpGenerateCL(eLge);				// ggfs. neu Standard-
 														// formate anlegen
 		nKey = ImpIsEntry(p_Entry->GetFormatstring(),CLOffset, eLge);
 		if (nKey != NUMBERFORMAT_ENTRY_NOT_FOUND)				// schon vorhanden
@@ -619,7 +619,7 @@ BOOL SvNumberFormatter::PutEntry(String&
 		{
 			SvNumberformat* pStdFormat =
 					 (SvNumberformat*) aFTable.Get(CLOffset + ZF_STANDARD);
-			ULONG nPos = CLOffset + pStdFormat->GetLastInsertKey();
+			sal_uInt32 nPos = CLOffset + pStdFormat->GetLastInsertKey();
 			if (nPos - CLOffset >= SV_COUNTRY_LANGUAGE_OFFSET)
 			{
 				Sound::Beep();
@@ -644,7 +644,7 @@ BOOL SvNumberFormatter::PutEntry(String&
 BOOL SvNumberFormatter::PutandConvertEntry(String& rString,
 										   xub_StrLen& nCheckPos,
 										   short& nType,
-										   ULONG& nKey,
+										   sal_uInt32& nKey,
 										   LanguageType eLnge,
 										   LanguageType eNewLnge)
 {
@@ -662,7 +662,7 @@ BOOL SvNumberFormatter::PutandConvertEnt
 BOOL SvNumberFormatter::PutandConvertEntrySystem(String& rString,
 										   xub_StrLen& nCheckPos,
 										   short& nType,
-										   ULONG& nKey,
+										   sal_uInt32& nKey,
 										   LanguageType eLnge,
 										   LanguageType eNewLnge)
 {
@@ -677,7 +677,7 @@ BOOL SvNumberFormatter::PutandConvertEnt
 }
 
 
-void SvNumberFormatter::DeleteEntry(ULONG nKey)
+void SvNumberFormatter::DeleteEntry(sal_uInt32 nKey)
 {
 	SvNumberformat* pEntry = aFTable.Remove(nKey);
 	delete pEntry;
@@ -693,7 +693,7 @@ void SvNumberFormatter::PrepareSave()
 	 }
 }
 
-void SvNumberFormatter::SetFormatUsed(ULONG nFIndex)
+void SvNumberFormatter::SetFormatUsed(sal_uInt32 nFIndex)
 {
 	SvNumberformat* pFormat = (SvNumberformat*) aFTable.Get(nFIndex);
 	if (pFormat)
@@ -709,7 +709,7 @@ BOOL SvNumberFormatter::Load( SvStream& 
 	USHORT nVersion;
 	rStream >> nVersion;
 	SvNumberformat* pEntry;
-	ULONG nPos;
+	sal_uInt32 nPos;
 	LanguageType eSaveSysLang, eLoadSysLang;
 	USHORT nSysOnStore, eLge, eDummy; 			// Dummy fuer kompatibles Format
 	rStream >> nSysOnStore >> eLge;				// Systemeinstellung aus
@@ -726,7 +726,7 @@ BOOL SvNumberFormatter::Load( SvStream& 
 		eLnge = (LanguageType) eLge;
 		ImpGenerateCL( eLnge, TRUE );			// ggfs. neue Standardformate anlegen
 
-		ULONG nOffset = nPos % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
+		sal_uInt32 nOffset = nPos % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
 		BOOL bUserDefined = (nOffset > SV_MAX_ANZ_STANDARD_FORMATE);
 		//! HACK! ER 29.07.97 15:15
 		// SaveLang wurde bei SYSTEM nicht gespeichert sondern war auch SYSTEM,
@@ -895,7 +895,7 @@ BOOL SvNumberFormatter::Load( SvStream& 
 	{
 		LanguageType eLang = aList[j];
 		ChangeIntl( eLang );
-		ULONG CLOffset = ImpGetCLOffset( eLang );
+		sal_uInt32 CLOffset = ImpGetCLOffset( eLang );
 		ImpGenerateAdditionalFormats( CLOffset, aNumberFormatCode, TRUE );
 	}
 	ChangeIntl( eOldLanguage );
@@ -953,7 +953,7 @@ void SvNumberFormatter::GetUsedLanguages
 {
 	rList.Remove( 0, rList.Count() );
 
-	ULONG nOffset = 0;
+	sal_uInt32 nOffset = 0;
 	while (nOffset <= MaxCLOffset)
 	{
 		SvNumberformat* pFormat = (SvNumberformat*) aFTable.Get(nOffset);
@@ -995,10 +995,10 @@ String SvNumberFormatter::GetStandardNam
 }
 
 
-ULONG SvNumberFormatter::ImpGetCLOffset(LanguageType eLnge) const
+sal_uInt32 SvNumberFormatter::ImpGetCLOffset(LanguageType eLnge) const
 {
 	SvNumberformat* pFormat;
-	ULONG nOffset = 0;
+	sal_uInt32 nOffset = 0;
 	while (nOffset <= MaxCLOffset)
 	{
 		pFormat = (SvNumberformat*) aFTable.Get(nOffset);
@@ -1009,8 +1009,8 @@ ULONG SvNumberFormatter::ImpGetCLOffset(
 	return nOffset;
 }
 
-ULONG SvNumberFormatter::ImpIsEntry(const String& rString,
-									   ULONG nCLOffset,
+sal_uInt32 SvNumberFormatter::ImpIsEntry(const String& rString,
+									   sal_uInt32 nCLOffset,
 									   LanguageType eLnge)
 {
 #ifndef NF_COMMENT_IN_FORMATSTRING
@@ -1020,7 +1020,7 @@ ULONG SvNumberFormatter::ImpIsEntry(cons
 	String aStr( rString );
 	SvNumberformat::EraseComment( aStr );
 #endif
-	ULONG res = NUMBERFORMAT_ENTRY_NOT_FOUND;
+	sal_uInt32 res = NUMBERFORMAT_ENTRY_NOT_FOUND;
 	SvNumberformat* pEntry;
 	pEntry = (SvNumberformat*) aFTable.Seek(nCLOffset);
 	while ( res == NUMBERFORMAT_ENTRY_NOT_FOUND &&
@@ -1056,7 +1056,7 @@ ULONG SvNumberFormatter::ImpIsEntry(cons
 
 SvNumberFormatTable& SvNumberFormatter::GetFirstEntryTable(
 													  short& eType,
-													  ULONG& FIndex,
+													  sal_uInt32& FIndex,
 													  LanguageType& rLnge)
 {
 	short eTypetmp = eType;
@@ -1094,10 +1094,10 @@ SvNumberFormatTable& SvNumberFormatter::
 	return GetEntryTable(eTypetmp, FIndex, rLnge);
 }
 
-ULONG SvNumberFormatter::ImpGenerateCL( LanguageType eLnge, BOOL bLoadingSO5 )
+sal_uInt32 SvNumberFormatter::ImpGenerateCL( LanguageType eLnge, BOOL bLoadingSO5 )
 {
 	ChangeIntl(eLnge);
-	ULONG CLOffset = ImpGetCLOffset(ActLnge);
+	sal_uInt32 CLOffset = ImpGetCLOffset(ActLnge);
 	if (CLOffset > MaxCLOffset)
 	{	// new CL combination
 #ifndef PRODUCT
@@ -1153,7 +1153,7 @@ ULONG SvNumberFormatter::ImpGenerateCL( 
 }
 
 SvNumberFormatTable& SvNumberFormatter::ChangeCL(short eType,
-												 ULONG& FIndex,
+												 sal_uInt32& FIndex,
 												 LanguageType eLnge)
 {
 	ImpGenerateCL(eLnge);
@@ -1162,7 +1162,7 @@ SvNumberFormatTable& SvNumberFormatter::
 
 SvNumberFormatTable& SvNumberFormatter::GetEntryTable(
 													short eType,
-													ULONG& FIndex,
+													sal_uInt32& FIndex,
 													LanguageType eLnge)
 {
 	if ( pFormatTable )
@@ -1170,11 +1170,11 @@ SvNumberFormatTable& SvNumberFormatter::
 	else
 		pFormatTable = new SvNumberFormatTable;
 	ChangeIntl(eLnge);
-	ULONG CLOffset = ImpGetCLOffset(ActLnge);
+	sal_uInt32 CLOffset = ImpGetCLOffset(ActLnge);
 
     // Might generate and insert a default format for the given type
     // (e.g. currency) => has to be done before collecting formats.
-    ULONG nDefaultIndex = GetStandardFormat( eType, ActLnge );
+    sal_uInt32 nDefaultIndex = GetStandardFormat( eType, ActLnge );
 
 	SvNumberformat* pEntry;
 	pEntry = (SvNumberformat*) aFTable.Seek(CLOffset);
@@ -1207,7 +1207,7 @@ SvNumberFormatTable& SvNumberFormatter::
 }
 
 BOOL SvNumberFormatter::IsNumberFormat(const String& sString,
-									   ULONG& F_Index,
+									   sal_uInt32& F_Index,
 									   double& fOutNumber)
 {
 	short FType;
@@ -1329,10 +1329,10 @@ BOOL SvNumberFormatter::IsCompatible(sho
 }
 
 
-ULONG SvNumberFormatter::ImpGetDefaultFormat( short nType )
+sal_uInt32 SvNumberFormatter::ImpGetDefaultFormat( short nType )
 {
-	ULONG CLOffset = ImpGetCLOffset( ActLnge );
-	ULONG nSearch;
+	sal_uInt32 CLOffset = ImpGetCLOffset( ActLnge );
+	sal_uInt32 nSearch;
 	switch( nType )
 	{
 		case NUMBERFORMAT_DATE		:
@@ -1353,13 +1353,13 @@ ULONG SvNumberFormatter::ImpGetDefaultFo
 		default:
 			nSearch = CLOffset + ZF_STANDARD;
 	}
-	ULONG nDefaultFormat = (ULONG) aDefaultFormatKeys.Get( nSearch );
+	sal_uInt32 nDefaultFormat = (sal_uInt32)(sal_uIntPtr) aDefaultFormatKeys.Get( nSearch );
 	if ( !nDefaultFormat )
 		nDefaultFormat = NUMBERFORMAT_ENTRY_NOT_FOUND;
 	if ( nDefaultFormat == NUMBERFORMAT_ENTRY_NOT_FOUND )
 	{	// look for a defined standard
-		ULONG nStopKey = CLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
-		ULONG nKey;
+		sal_uInt32 nStopKey = CLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
+		sal_uInt32 nKey;
 		aFTable.Seek( CLOffset );
 		while ( (nKey = aFTable.GetCurKey()) >= CLOffset && nKey < nStopKey )
 		{
@@ -1402,9 +1402,9 @@ ULONG SvNumberFormatter::ImpGetDefaultFo
 }
 
 
-ULONG SvNumberFormatter::GetStandardFormat( short eType, LanguageType eLnge )
+sal_uInt32 SvNumberFormatter::GetStandardFormat( short eType, LanguageType eLnge )
 {
-	ULONG CLOffset = ImpGenerateCL(eLnge);
+	sal_uInt32 CLOffset = ImpGenerateCL(eLnge);
 	switch(eType)
 	{
 		case NUMBERFORMAT_CURRENCY  :
@@ -1432,7 +1432,7 @@ ULONG SvNumberFormatter::GetStandardForm
 	}
 }
 
-BOOL SvNumberFormatter::IsSpecialStandardFormat( ULONG nFIndex,
+BOOL SvNumberFormatter::IsSpecialStandardFormat( sal_uInt32 nFIndex,
 		LanguageType eLnge )
 {
 	return
@@ -1442,7 +1442,7 @@ BOOL SvNumberFormatter::IsSpecialStandar
 		;
 }
 
-ULONG SvNumberFormatter::GetStandardFormat( ULONG nFIndex, short eType,
+sal_uInt32 SvNumberFormatter::GetStandardFormat( sal_uInt32 nFIndex, short eType,
 		LanguageType eLnge )
 {
 	if ( IsSpecialStandardFormat( nFIndex, eLnge ) )
@@ -1451,7 +1451,7 @@ ULONG SvNumberFormatter::GetStandardForm
 		return GetStandardFormat( eType, eLnge );
 }
 
-ULONG SvNumberFormatter::GetStandardFormat( double fNumber, ULONG nFIndex,
+sal_uInt32 SvNumberFormatter::GetStandardFormat( double fNumber, sal_uInt32 nFIndex,
 		short eType, LanguageType eLnge )
 {
 	if ( IsSpecialStandardFormat( nFIndex, eLnge ) )
@@ -1492,7 +1492,7 @@ ULONG SvNumberFormatter::GetStandardForm
 }
 
 void SvNumberFormatter::GetInputLineString(const double& fOutNumber,
-										   ULONG nFIndex,
+										   sal_uInt32 nFIndex,
 										   String& sOutString)
 {
 	SvNumberformat* pFormat;
@@ -1517,7 +1517,7 @@ void SvNumberFormatter::GetInputLineStri
 		nOldPrec = pFormatScanner->GetStandardPrec();
 		ChangeStandardPrec(300);						// Merkwert
 	}
-	ULONG nKey = nFIndex;
+	sal_uInt32 nKey = nFIndex;
 	switch ( eType )
 	{	// #61619# immer vierstelliges Jahr editieren
 		case NUMBERFORMAT_DATE :
@@ -1545,7 +1545,7 @@ void SvNumberFormatter::GetInputLineStri
 }
 
 void SvNumberFormatter::GetOutputString(const double& fOutNumber,
-										ULONG nFIndex,
+										sal_uInt32 nFIndex,
 										String& sOutString,
 										Color** ppColor)
 {
@@ -1562,7 +1562,7 @@ void SvNumberFormatter::GetOutputString(
 }
 
 void SvNumberFormatter::GetOutputString(String& sString,
-										ULONG nFIndex,
+										sal_uInt32 nFIndex,
 										String& sOutString,
 										Color** ppColor)
 {
@@ -1591,7 +1591,7 @@ BOOL SvNumberFormatter::GetPreviewString
 		return FALSE;
 
 	xub_StrLen nCheckPos;
-	ULONG nKey;
+	sal_uInt32 nKey;
 	if (eLnge == LANGUAGE_DONTKNOW)
         eLnge = IniLnge;
 	ChangeIntl(eLnge);							// ggfs. austauschen
@@ -1604,7 +1604,7 @@ BOOL SvNumberFormatter::GetPreviewString
 												 eLnge);
 	if (nCheckPos == 0)									// String ok
 	{
-		ULONG CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
+		sal_uInt32 CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
 														// formate anlegen
 		nKey = ImpIsEntry(p_Entry->GetFormatstring(),CLOffset, eLnge);
 		if (nKey != NUMBERFORMAT_ENTRY_NOT_FOUND)				// schon vorhanden
@@ -1638,8 +1638,8 @@ BOOL SvNumberFormatter::GetPreviewString
 	BOOL bEnglish = (eLnge == LANGUAGE_ENGLISH_US);
 
 	String aFormatStringUpper( pCharClass->upper( sFormatString ) );
-	ULONG nCLOffset = ImpGenerateCL( eLnge );
-	ULONG nKey = ImpIsEntry( aFormatStringUpper, nCLOffset, eLnge );
+	sal_uInt32 nCLOffset = ImpGenerateCL( eLnge );
+	sal_uInt32 nKey = ImpIsEntry( aFormatStringUpper, nCLOffset, eLnge );
 	if ( nKey != NUMBERFORMAT_ENTRY_NOT_FOUND )
 	{	// Zielformat vorhanden
 		GetOutputString( fPreviewNumber, nKey, sOutString, ppColor );
@@ -1716,7 +1716,7 @@ BOOL SvNumberFormatter::GetPreviewString
 	return FALSE;
 }
 
-ULONG SvNumberFormatter::TestNewString(const String& sFormatString,
+sal_uInt32 SvNumberFormatter::TestNewString(const String& sFormatString,
 									  LanguageType eLnge)
 {
 	if (sFormatString.Len() == 0) 						// keinen Leerstring
@@ -1727,7 +1727,7 @@ ULONG SvNumberFormatter::TestNewString(c
         eLnge = IniLnge;
 	ChangeIntl(eLnge);									// ggfs. austauschen
 	eLnge = ActLnge;
-	ULONG nRes;
+	sal_uInt32 nRes;
 	String sTmpString = sFormatString;
 	SvNumberformat* pEntry = new SvNumberformat(sTmpString,
 												pFormatScanner,
@@ -1736,7 +1736,7 @@ ULONG SvNumberFormatter::TestNewString(c
 												eLnge);
 	if (nCheckPos == 0)									// String ok
 	{
-		ULONG CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
+		sal_uInt32 CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
 														// formate anlegen
 		nRes = ImpIsEntry(pEntry->GetFormatstring(),CLOffset, eLnge);
 														// schon vorhanden ?
@@ -1749,7 +1749,7 @@ ULONG SvNumberFormatter::TestNewString(c
 
 SvNumberformat* SvNumberFormatter::ImpInsertFormat(
 			const ::com::sun::star::i18n::NumberFormatCode& rCode,
-			ULONG nPos, BOOL bAfterLoadingSO5, sal_Int16 nOrgIndex )
+			sal_uInt32 nPos, BOOL bAfterLoadingSO5, sal_Int16 nOrgIndex )
 {
 	String aCodeStr( rCode.Code );
 	if ( rCode.Index < NF_INDEX_TABLE_ENTRIES &&
@@ -1792,8 +1792,8 @@ SvNumberformat* SvNumberFormatter::ImpIn
 	}
 	if ( rCode.Index >= NF_INDEX_TABLE_ENTRIES )
 	{
-		ULONG nCLOffset = nPos - (nPos % SV_COUNTRY_LANGUAGE_OFFSET);
-		ULONG nKey = ImpIsEntry( aCodeStr, nCLOffset, ActLnge );
+		sal_uInt32 nCLOffset = nPos - (nPos % SV_COUNTRY_LANGUAGE_OFFSET);
+		sal_uInt32 nKey = ImpIsEntry( aCodeStr, nCLOffset, ActLnge );
 		if ( nKey != NUMBERFORMAT_ENTRY_NOT_FOUND )
 		{
 #ifndef PRODUCT
@@ -1857,7 +1857,7 @@ SvNumberformat* SvNumberFormatter::ImpIn
 
 SvNumberformat* SvNumberFormatter::ImpInsertNewStandardFormat(
 			const ::com::sun::star::i18n::NumberFormatCode& rCode,
-			ULONG nPos, USHORT nVersion, BOOL bAfterLoadingSO5,
+			sal_uInt32 nPos, USHORT nVersion, BOOL bAfterLoadingSO5,
 			sal_Int16 nOrgIndex )
 {
 	SvNumberformat* pNewFormat = ImpInsertFormat( rCode, nPos,
@@ -1868,7 +1868,7 @@ SvNumberformat* SvNumberFormatter::ImpIn
 	return pNewFormat;
 }
 
-void SvNumberFormatter::GetFormatSpecialInfo(ULONG nFormat,
+void SvNumberFormatter::GetFormatSpecialInfo(sal_uInt32 nFormat,
 											 BOOL& bThousand,
 											 BOOL& IsRed,
 											 USHORT& nPrecision,
@@ -1888,7 +1888,7 @@ void SvNumberFormatter::GetFormatSpecial
 	}
 }
 
-USHORT SvNumberFormatter::GetFormatPrecision( ULONG nFormat ) const
+USHORT SvNumberFormatter::GetFormatPrecision( sal_uInt32 nFormat ) const
 {
 	const SvNumberformat* pFormat = aFTable.Get( nFormat );
 	if ( pFormat )
@@ -1898,7 +1898,7 @@ USHORT SvNumberFormatter::GetFormatPreci
 }
 
 
-String SvNumberFormatter::GetFormatDecimalSep( ULONG nFormat ) const
+String SvNumberFormatter::GetFormatDecimalSep( sal_uInt32 nFormat ) const
 {
 	const SvNumberformat* pFormat = aFTable.Get( nFormat );
 	if ( !pFormat || pFormat->GetLanguage() == ActLnge )
@@ -1920,7 +1920,7 @@ String SvNumberFormatter::GetFormatDecim
 }
 
 
-ULONG SvNumberFormatter::GetFormatSpecialInfo( const String& rFormatString,
+sal_uInt32 SvNumberFormatter::GetFormatSpecialInfo( const String& rFormatString,
 			BOOL& bThousand, BOOL& IsRed, USHORT& nPrecision,
 			USHORT& nAnzLeading, LanguageType eLnge )
 
@@ -1947,7 +1947,7 @@ ULONG SvNumberFormatter::GetFormatSpecia
 }
 
 
-inline ULONG SetIndexTable( NfIndexTableOffset nTabOff, ULONG nIndOff )
+inline sal_uInt32 SetIndexTable( NfIndexTableOffset nTabOff, sal_uInt32 nIndOff )
 {
 	if ( !bIndexTableInitialized )
 	{
@@ -2129,7 +2129,7 @@ sal_Int32 SvNumberFormatter::ImpAdjustFo
 }
 
 
-void SvNumberFormatter::ImpGenerateFormats( ULONG CLOffset, BOOL bLoadingSO5 )
+void SvNumberFormatter::ImpGenerateFormats( sal_uInt32 CLOffset, BOOL bLoadingSO5 )
 {
 	using namespace ::com::sun::star;
 
@@ -2555,7 +2555,7 @@ void SvNumberFormatter::ImpGenerateForma
 }
 
 
-void SvNumberFormatter::ImpGenerateAdditionalFormats( ULONG CLOffset,
+void SvNumberFormatter::ImpGenerateAdditionalFormats( sal_uInt32 CLOffset,
 			NumberFormatCodeWrapper& rNumberFormatCode, BOOL bAfterLoadingSO5 )
 {
 	using namespace ::com::sun::star;
@@ -2567,7 +2567,7 @@ void SvNumberFormatter::ImpGenerateAddit
 		DBG_ERRORFILE( "ImpGenerateAdditionalFormats: no GENERAL format" );
 		return ;
 	}
-	ULONG nPos = CLOffset + pStdFormat->GetLastInsertKey();
+	sal_uInt32 nPos = CLOffset + pStdFormat->GetLastInsertKey();
 	rNumberFormatCode.setLocale( GetLocale() );
 	sal_Int32 j;
 
@@ -2649,7 +2649,7 @@ void SvNumberFormatter::ImpGetNegCurrFor
 }
 
 void SvNumberFormatter::GenerateFormat(String& sString,
-									   ULONG nIndex,
+									   sal_uInt32 nIndex,
 									   LanguageType eLnge,
 									   BOOL bThousand,
 									   BOOL IsRed,
@@ -2772,10 +2772,10 @@ BOOL SvNumberFormatter::IsUserDefined(co
 {
 	if (eLnge == LANGUAGE_DONTKNOW)
         eLnge = IniLnge;
-	ULONG CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
+	sal_uInt32 CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
 													// formate anlegen
 	eLnge = ActLnge;
-	ULONG nKey = ImpIsEntry(sStr, CLOffset, eLnge);
+	sal_uInt32 nKey = ImpIsEntry(sStr, CLOffset, eLnge);
 	if (nKey == NUMBERFORMAT_ENTRY_NOT_FOUND)
 		return TRUE;
 	SvNumberformat* pEntry = aFTable.Get(nKey);
@@ -2784,24 +2784,24 @@ BOOL SvNumberFormatter::IsUserDefined(co
 	return FALSE;
 }
 
-ULONG SvNumberFormatter::GetEntryKey(const String& sStr,
+sal_uInt32 SvNumberFormatter::GetEntryKey(const String& sStr,
 									 LanguageType eLnge)
 {
 	if (eLnge == LANGUAGE_DONTKNOW)
         eLnge = IniLnge;
-	ULONG CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
+	sal_uInt32 CLOffset = ImpGenerateCL(eLnge);				// ggfs. neu Standard-
 													// formate anlegen
 	return ImpIsEntry(sStr, CLOffset, eLnge);
 }
 
-ULONG SvNumberFormatter::GetStandardIndex(LanguageType eLnge)
+sal_uInt32 SvNumberFormatter::GetStandardIndex(LanguageType eLnge)
 {
 	if (eLnge == LANGUAGE_DONTKNOW)
         eLnge = IniLnge;
 	return GetStandardFormat(NUMBERFORMAT_NUMBER, eLnge);
 }
 
-short SvNumberFormatter::GetType(ULONG nFIndex)
+short SvNumberFormatter::GetType(sal_uInt32 nFIndex)
 {
 	short eType;
 	SvNumberformat* pFormat = (SvNumberformat*) aFTable.Get(nFIndex);
@@ -2820,7 +2820,7 @@ void SvNumberFormatter::ClearMergeTable(
 {
     if ( pMergeTable )
     {
-        ULONG* pIndex = (ULONG*) pMergeTable->First();
+        sal_uInt32* pIndex = (sal_uInt32*) pMergeTable->First();
         while (pIndex)
         {
             delete pIndex;
@@ -2830,15 +2830,15 @@ void SvNumberFormatter::ClearMergeTable(
     }
 }
 
-SvULONGTable* SvNumberFormatter::MergeFormatter(SvNumberFormatter& rTable)
+Svsal_uInt32Table* SvNumberFormatter::MergeFormatter(SvNumberFormatter& rTable)
 {
     if ( pMergeTable )
         ClearMergeTable();
     else
-        pMergeTable = new SvULONGTable;
-	ULONG nCLOffset = 0;
-	ULONG nOldKey, nOffset, nNewKey;
-	ULONG* pNewIndex;
+        pMergeTable = new Svsal_uInt32Table;
+	sal_uInt32 nCLOffset = 0;
+	sal_uInt32 nOldKey, nOffset, nNewKey;
+	sal_uInt32* pNewIndex;
 	SvNumberformat* pNewEntry;
 	SvNumberformat* pFormat = rTable.aFTable.First();
 	while (pFormat)
@@ -2860,7 +2860,7 @@ SvULONGTable* SvNumberFormatter::MergeFo
 			}
 			if (nNewKey != nOldKey)						// neuer Index
 			{
-				pNewIndex = new ULONG(nNewKey);
+				pNewIndex = new sal_uInt32(nNewKey);
 				if (!pMergeTable->Insert(nOldKey,pNewIndex))
 					delete pNewIndex;
 			}
@@ -2878,7 +2878,7 @@ SvULONGTable* SvNumberFormatter::MergeFo
 			{
 				SvNumberformat* pStdFormat =
 						(SvNumberformat*) aFTable.Get(nCLOffset + ZF_STANDARD);
-				ULONG nPos = nCLOffset + pStdFormat->GetLastInsertKey();
+				sal_uInt32 nPos = nCLOffset + pStdFormat->GetLastInsertKey();
 				nNewKey = nPos+1;
 				if (nPos - nCLOffset >= SV_COUNTRY_LANGUAGE_OFFSET)
 				{
@@ -2894,7 +2894,7 @@ SvULONGTable* SvNumberFormatter::MergeFo
 			}
 			if (nNewKey != nOldKey)						// neuer Index
 			{
-				pNewIndex = new ULONG(nNewKey);
+				pNewIndex = new sal_uInt32(nNewKey);
 				if (!pMergeTable->Insert(nOldKey,pNewIndex))
 					delete pNewIndex;
 			}
@@ -2905,22 +2905,22 @@ SvULONGTable* SvNumberFormatter::MergeFo
 }
 
 
-ULONG SvNumberFormatter::GetFormatForLanguageIfBuiltIn( ULONG nFormat,
+sal_uInt32 SvNumberFormatter::GetFormatForLanguageIfBuiltIn( sal_uInt32 nFormat,
 		LanguageType eLnge )
 {
 	if ( eLnge == LANGUAGE_DONTKNOW )
         eLnge = IniLnge;
     if ( nFormat < SV_COUNTRY_LANGUAGE_OFFSET && eLnge == IniLnge )
 		return nFormat;		// es bleibt wie es ist
-	ULONG nOffset = nFormat % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
+	sal_uInt32 nOffset = nFormat % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
 	if ( nOffset > SV_MAX_ANZ_STANDARD_FORMATE )
 		return nFormat;					// kein eingebautes Format
-	ULONG nCLOffset = ImpGenerateCL(eLnge);		// ggbf. generieren
+	sal_uInt32 nCLOffset = ImpGenerateCL(eLnge);		// ggbf. generieren
 	return nCLOffset + nOffset;
 }
 
 
-ULONG SvNumberFormatter::GetFormatIndex( NfIndexTableOffset nTabOff,
+sal_uInt32 SvNumberFormatter::GetFormatIndex( NfIndexTableOffset nTabOff,
 		LanguageType eLnge )
 {
 	if ( nTabOff >= NF_INDEX_TABLE_ENTRIES
@@ -2928,14 +2928,14 @@ ULONG SvNumberFormatter::GetFormatIndex(
 		return NUMBERFORMAT_ENTRY_NOT_FOUND;
 	if ( eLnge == LANGUAGE_DONTKNOW )
         eLnge = IniLnge;
-	ULONG nCLOffset = ImpGenerateCL(eLnge);		// ggbf. generieren
+	sal_uInt32 nCLOffset = ImpGenerateCL(eLnge);		// ggbf. generieren
 	return nCLOffset + theIndexTable[nTabOff];
 }
 
 
-NfIndexTableOffset SvNumberFormatter::GetIndexTableOffset( ULONG nFormat ) const
+NfIndexTableOffset SvNumberFormatter::GetIndexTableOffset( sal_uInt32 nFormat ) const
 {
-	ULONG nOffset = nFormat % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
+	sal_uInt32 nOffset = nFormat % SV_COUNTRY_LANGUAGE_OFFSET;		// relativIndex
 	if ( nOffset > SV_MAX_ANZ_STANDARD_FORMATE )
 		return NF_INDEX_TABLE_ENTRIES;		// kein eingebautes Format
 	for ( USHORT j = 0; j < NF_INDEX_TABLE_ENTRIES; j++ )
@@ -3089,7 +3089,7 @@ void SvNumberFormatter::ResetDefaultSyst
 }
 
 
-ULONG SvNumberFormatter::ImpGetDefaultSystemCurrencyFormat()
+sal_uInt32 SvNumberFormatter::ImpGetDefaultSystemCurrencyFormat()
 {
 	if ( nDefaultSystemCurrencyFormat == NUMBERFORMAT_ENTRY_NOT_FOUND )
 	{
@@ -3111,18 +3111,18 @@ ULONG SvNumberFormatter::ImpGetDefaultSy
 }
 
 
-ULONG SvNumberFormatter::ImpGetDefaultCurrencyFormat()
+sal_uInt32 SvNumberFormatter::ImpGetDefaultCurrencyFormat()
 {
-	ULONG CLOffset = ImpGetCLOffset( ActLnge );
-	ULONG nDefaultCurrencyFormat =
-		(ULONG) aDefaultFormatKeys.Get( CLOffset + ZF_STANDARD_CURRENCY );
+	sal_uInt32 CLOffset = ImpGetCLOffset( ActLnge );
+	sal_uInt32 nDefaultCurrencyFormat =
+		(sal_uInt32)(sal_uIntPtr) aDefaultFormatKeys.Get( CLOffset + ZF_STANDARD_CURRENCY );
 	if ( !nDefaultCurrencyFormat )
 		nDefaultCurrencyFormat = NUMBERFORMAT_ENTRY_NOT_FOUND;
 	if ( nDefaultCurrencyFormat == NUMBERFORMAT_ENTRY_NOT_FOUND )
 	{
 		// look for a defined standard
-		ULONG nStopKey = CLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
-		ULONG nKey;
+		sal_uInt32 nStopKey = CLOffset + SV_COUNTRY_LANGUAGE_OFFSET;
+		sal_uInt32 nKey;
 		aFTable.Seek( CLOffset );
 		while ( (nKey = aFTable.GetCurKey()) >= CLOffset && nKey < nStopKey )
 		{
@@ -3218,7 +3218,7 @@ inline
 }
 
 
-BOOL SvNumberFormatter::GetNewCurrencySymbolString( ULONG nFormat,
+BOOL SvNumberFormatter::GetNewCurrencySymbolString( sal_uInt32 nFormat,
 			String& rStr, const NfCurrencyEntry** ppEntry /* = NULL */,
 			BOOL* pBank /* = NULL */ ) const
 {
Index: svtools/source/numbers/zformat.cxx
===================================================================
RCS file: /cvs/util/svtools/source/numbers/zformat.cxx,v
retrieving revision 1.62
retrieving revision 1.62.84.1
diff -u -p -u -p -r1.62 -r1.62.84.1
--- svtools/source/numbers/zformat.cxx	9 Nov 2004 11:41:16 -0000	1.62
+++ svtools/source/numbers/zformat.cxx	21 Jan 2005 17:17:15 -0000	1.62.84.1
@@ -1575,7 +1575,7 @@ void SvNumberformat::ConvertLanguage( Sv
         LanguageType eConvertFrom, LanguageType eConvertTo, BOOL bSystem )
 {
     xub_StrLen nCheckPos;
-    ULONG nKey;
+    sal_uInt32 nKey;
     short nType = eType;
     String aFormatString( sFormatstring );
     if ( bSystem )
Index: svtools/source/svhtml/parhtml.cxx
===================================================================
RCS file: /cvs/util/svtools/source/svhtml/parhtml.cxx,v
retrieving revision 1.7
retrieving revision 1.6.16.4
diff -u -p -u -p -r1.7 -r1.6.16.4
--- svtools/source/svhtml/parhtml.cxx	5 Jan 2005 13:29:27 -0000	1.7
+++ svtools/source/svhtml/parhtml.cxx	22 Jan 2005 10:40:03 -0000	1.6.16.4
@@ -191,7 +191,7 @@ HTMLOption::HTMLOption( USHORT nTok, con
 		"HTMLOption: unbekanntes Token" );
 }
 
-ULONG HTMLOption::GetNumber() const
+sal_uInt32 HTMLOption::GetNumber() const
 {
 	DBG_ASSERT( (nToken>=HTML_OPTION_NUMBER_START &&
 				 nToken<HTML_OPTION_NUMBER_END) ||
@@ -202,7 +202,7 @@ ULONG HTMLOption::GetNumber() const
 	String aTmp( aValue );
 	aTmp.EraseLeadingChars();
 	sal_Int32 nTmp = aTmp.ToInt32();
-	return nTmp >= 0L ? (sal_uInt32)nTmp : 0UL;
+	return nTmp >= 0U ? (sal_uInt32)nTmp : 0U;
 }
 
 INT32 HTMLOption::GetSNumber() const
@@ -251,7 +251,7 @@ void HTMLOption::GetNumbers( SvULongs &r
 	{
 		// hier wird auf die korrekte Trennung der Zahlen durch ',' geachtet
 		// und auch mal eine 0 eingefuegt
-		sal_uInt32 nPos = 0UL;
+		ULONG nPos = 0UL;
 		while( nPos < aValue.Len() )
 		{
 			register sal_Unicode c;
Index: svtools/source/uno/unoiface.cxx
===================================================================
RCS file: /cvs/util/svtools/source/uno/unoiface.cxx,v
retrieving revision 1.16
retrieving revision 1.12.48.5
diff -u -p -u -p -r1.16 -r1.12.48.5
--- svtools/source/uno/unoiface.cxx	26 Nov 2004 16:06:31 -0000	1.16
+++ svtools/source/uno/unoiface.cxx	21 Jan 2005 17:17:32 -0000	1.12.48.5
@@ -1750,7 +1750,7 @@ void SVTXRoadmap::setColorModel( sal_Int
 {
 	::vos::OGuard aGuard( GetMutex() );
 
-	maImageConsumer.SetColorModel( BitCount, RGBAPal.getLength(), (const unsigned long*) RGBAPal.getConstArray(), RedMask, GreenMask, BlueMask, AlphaMask );
+	maImageConsumer.SetColorModel( BitCount, RGBAPal.getLength(), (const sal_uInt32*) RGBAPal.getConstArray(), RedMask, GreenMask, BlueMask, AlphaMask );
 }
 
 
@@ -1766,7 +1766,7 @@ void SVTXRoadmap::setPixelsByLongs( sal_
 {
 	::vos::OGuard aGuard( GetMutex() );
 
-	maImageConsumer.SetPixelsByLongs( X, Y, Width, Height, (const unsigned long*) ProducerData.getConstArray(), Offset, Scansize );
+	maImageConsumer.SetPixelsByLongs( X, Y, Width, Height, (const sal_uInt32*) ProducerData.getConstArray(), Offset, Scansize );
 	ImplUpdateImage( sal_True );
 }
 
Index: svtools/workben/svdem.cxx
===================================================================
RCS file: /cvs/util/svtools/workben/svdem.cxx,v
retrieving revision 1.5
retrieving revision 1.4.208.3
diff -u -p -u -p -r1.5 -r1.4.208.3
--- svtools/workben/svdem.cxx	30 Jul 2004 15:20:26 -0000	1.5
+++ svtools/workben/svdem.cxx	24 Feb 2005 20:02:07 -0000	1.4.208.3
@@ -59,8 +59,11 @@
  *
  ************************************************************************/
 #include <stdio.h>
-#include <cppuhelper/servicefactory.hxx>
+#include <sal/main.h>
+#include <com/sun/star/lang/XMultiServiceFactory.hpp>
 #include <comphelper/processfactory.hxx>
+#include <cppuhelper/servicefactory.hxx>
+#include <cppuhelper/bootstrap.hxx>
 
 #include <vcl/wrkwin.hxx>
 #include <vcl/dialog.hxx>
@@ -86,13 +89,13 @@
 #include <prnsetup.hxx>
 #include <printdlg.hxx>
 
+
+using namespace ::com::sun::star::uno;
+using namespace ::com::sun::star::lang;
 // -----------------------------------------------------------------------
 
-class MyApp : public Application
-{
-public:
-	void Main();
-};
+// Forward declaration
+void Main();
 
 // -----------------------------------------------------------------------
 
@@ -254,21 +257,37 @@ public:
 	void			Paint( const Rectangle& rRect );
 	void			Resize();
 };
-
 // -----------------------------------------------------------------------
 
-void MyApp::Main()
+SAL_IMPLEMENT_MAIN()
 {
     try
     {
-        ::com::sun::star::uno::Reference< ::com::sun::star::lang::XMultiServiceFactory >
-              xMSF = cppu::createRegistryServiceFactory(
-                  rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "applicat.rdb" ) ), sal_True );
+        Reference< XMultiServiceFactory > xMS;
+        xMS = cppu::createRegistryServiceFactory( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "applicat.rdb" ) ), sal_True );
+ 
+        ::comphelper::setProcessServiceFactory( xMS );
+
+        InitVCL( xMS );
+        ::Main();
+        DeInitVCL();
+    }
+    catch ( com::sun::star::uno::Exception & e )
+    {
+        fprintf( stderr, "Error during bootstrapping servicemanager: %s\n" ,
+                 rtl::OUStringToOString( e.Message, RTL_TEXTENCODING_ASCII_US ).getStr() );
+    }
+    return 0;
+}
+
 
-        ::comphelper::setProcessServiceFactory( xMSF );
+// -----------------------------------------------------------------------
+
+void Main()
+{
 
         Help aHelp;
-        SetHelp( &aHelp );
+        Application::SetHelp( &aHelp );
         Help::EnableContextHelp();
         Help::EnableExtHelp();
         Help::EnableBalloonHelp();
@@ -277,15 +296,9 @@ void MyApp::Main()
         MyWin aMainWin( NULL, WinBits( WB_APP | WB_STDWORK | WB_CLIPCHILDREN ) );
         aMainWin.SetText( XubString( RTL_CONSTASCII_USTRINGPARAM( "SVTOOLS - Workbench" ) ) );
         aMainWin.GrabFocus();
-        aMainWin.Show();
-        
-        Execute();
-    }
-    catch ( com::sun::star::uno::Exception & e )
-    {
-        fprintf( stderr, "Error during bootstrapping servicemanager: %s\n" ,
-                 rtl::OUStringToOString( e.Message, RTL_TEXTENCODING_ASCII_US ).getStr() );
-    }
+	aMainWin.Show();
+
+	Application::Execute();
 }
 
 // -----------------------------------------------------------------------
@@ -1142,4 +1155,3 @@ void MyWin::Resize()
 
 // -----------------------------------------------------------------------
 
-MyApp aMyApp;
? config_office/autom4te.cache
? config_office/config.log
? config_office/config.parms
? config_office/config.status
? config_office/oowintool
? config_office/set_soenv
? config_office/warn
Index: sc/inc/address.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/address.hxx,v
retrieving revision 1.4
retrieving revision 1.4.78.1
diff -u -p -u -p -r1.4 -r1.4.78.1
--- sc/inc/address.hxx	23 Aug 2004 09:22:05 -0000	1.4
+++ sc/inc/address.hxx	21 Jan 2005 16:33:04 -0000	1.4.78.1
@@ -147,7 +147,7 @@ typedef sal_Int32 SCsCOLROW;
 // size_t typedef to be able to find places where code was changed from USHORT
 // to size_t and is used to read/write from/to streams.
 typedef size_t SCSIZE;
-#ifndef MACOSX
+#if !defined( MACOSX ) && !defined( __x86_64__ )
 // resolve ambiguity, TODO: move to tools/solar.h, or even better use ::std::min/max
 inline size_t Min( size_t a, size_t b) { return a<b ? a : b; }
 inline size_t Max( size_t a, size_t b) { return a<b ? a : b; }
Index: sc/inc/document.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/document.hxx,v
retrieving revision 1.85
retrieving revision 1.85.68.1
diff -u -p -u -p -r1.85 -r1.85.68.1
--- sc/inc/document.hxx	15 Nov 2004 16:32:04 -0000	1.85
+++ sc/inc/document.hxx	21 Jan 2005 16:33:22 -0000	1.85.68.1
@@ -195,10 +195,10 @@ namespace com { namespace sun { namespac
 
 
 #ifdef _ZFORLIST_DECLARE_TABLE
-class SvULONGTable;
+class Svsal_uInt32Table;
 #else
 class Table;
-typedef Table SvULONGTable;
+typedef Table Svsal_uInt32Table;
 #endif
 
 
@@ -287,7 +287,7 @@ private:
 	XColorTable*		pColorTable;
 	ScConditionalFormatList* pCondFormList;				// bedingte Formate
 	ScValidationDataList* pValidationList;				// Gueltigkeit
-	SvULONGTable*		pFormatExchangeList;			// zum Umsetzen von Zahlenformaten
+	Svsal_uInt32Table*	pFormatExchangeList;			// zum Umsetzen von Zahlenformaten
 	ScTable*			pTab[MAXTABCOUNT];
 	ScRangeName*		pRangeName;
 	ScDBCollection*		pDBCollection;
@@ -523,7 +523,7 @@ SC_DLLPUBLIC	ScDBCollection*	GetDBCollec
 	SC_DLLPUBLIC BOOL			GetName( SCTAB nTab, String& rName ) const;
 	BOOL			GetTable( const String& rName, SCTAB& rTab ) const;
 	inline SCTAB	GetTableCount() const { return nMaxTableNumber; }
-	SvULONGTable*	GetFormatExchangeList() const { return pFormatExchangeList; }
+	Svsal_uInt32Table* GetFormatExchangeList() const { return pFormatExchangeList; }
 
 	void			SetDocProtection( BOOL bProtect, const com::sun::star::uno::Sequence <sal_Int8>& aPass );
 	void			SetTabProtection( SCTAB nTab, BOOL bProtect, const com::sun::star::uno::Sequence <sal_Int8>& aPass );
@@ -734,8 +734,8 @@ SC_DLLPUBLIC	ScDBCollection*	GetDBCollec
 	void			GetValue( SCCOL nCol, SCROW nRow, SCTAB nTab, double& rValue );
 	double			RoundValueAsShown( double fVal, ULONG nFormat );
 	void			GetNumberFormat( SCCOL nCol, SCROW nRow, SCTAB nTab,
-									 ULONG& rFormat );
-	ULONG			GetNumberFormat( const ScAddress& ) const;
+									 sal_uInt32& rFormat );
+	sal_uInt32		GetNumberFormat( const ScAddress& ) const;
 					/// if no number format attribute is set the calculated
 					/// number format of the formula cell is returned
 	void			GetNumberFormatInfo( short& nType, ULONG& nIndex,
@@ -1125,7 +1125,7 @@ SC_DLLPUBLIC	ScDBCollection*	GetDBCollec
 									BOOL bPutToPool = FALSE );
 	void			SetPattern( SCCOL nCol, SCROW nRow, SCTAB nTab, const ScPatternAttr& rAttr,
 									BOOL bPutToPool = FALSE );
-	void            DeleteNumberFormat( const ULONG* pDelKeys, ULONG nCount );
+	void            DeleteNumberFormat( const sal_uInt32* pDelKeys, sal_uInt32 nCount );
 
 	void			AutoFormat( SCCOL nStartCol, SCROW nStartRow, SCCOL nEndCol, SCROW nEndRow,
 									USHORT nFormatNo, const ScMarkData& rMark );
Index: sc/inc/rechead.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rechead.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.522.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.522.1
--- sc/inc/rechead.hxx	18 Sep 2000 16:44:49 -0000	1.1.1.1
+++ sc/inc/rechead.hxx	9 Sep 2004 11:02:22 -0000	1.1.1.1.522.1
@@ -221,7 +221,7 @@ private:
 	ULONG			nEntryStart;
 
 public:
-	ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault = 0);
+	ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault = 0);
 	~ScMultipleWriteHeader();
 
 	void	StartEntry();
Index: sc/source/core/data/column3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/column3.cxx,v
retrieving revision 1.16
retrieving revision 1.16.6.1
diff -u -p -u -p -r1.16 -r1.16.6.1
--- sc/source/core/data/column3.cxx	11 Jan 2005 12:38:02 -0000	1.16
+++ sc/source/core/data/column3.cxx	21 Jan 2005 16:33:44 -0000	1.16.6.1
@@ -1257,7 +1257,7 @@ BOOL ScColumn::SetString( SCROW nRow, SC
 		if (rString.Len() > 0)
 		{
 			double nVal;
-			ULONG nIndex, nOldIndex;
+			sal_uInt32 nIndex, nOldIndex;
 			sal_Unicode cFirstChar;
 			SvNumberFormatter* pFormatter = pDocument->GetFormatTable();
 			SfxObjectShell* pDocSh = pDocument->GetDocumentShell();
Index: sc/source/core/data/dociter.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dociter.cxx,v
retrieving revision 1.12
retrieving revision 1.12.68.1
diff -u -p -u -p -r1.12 -r1.12.68.1
--- sc/source/core/data/dociter.cxx	15 Nov 2004 16:33:34 -0000	1.12
+++ sc/source/core/data/dociter.cxx	21 Jan 2005 16:34:00 -0000	1.12.68.1
@@ -524,7 +524,7 @@ ScQueryValueIterator::ScQueryValueIterat
 	for (i=0; (i<nCount) && (aParam.GetEntry(i).bDoQuery); i++)
 	{
 		ScQueryEntry& rEntry = aParam.GetEntry(i);
-		ULONG nIndex = 0;
+		sal_uInt32 nIndex = 0;
 		rEntry.bQueryByString =
 				!(pDoc->GetFormatTable()->IsNumberFormat(*rEntry.pStr, nIndex, rEntry.nVal));
 	}
@@ -806,7 +806,7 @@ ScQueryCellIterator::ScQueryCellIterator
 		for (i=0; (i<MAXQUERY) && (aParam.GetEntry(i).bDoQuery); i++)
 		{
 			ScQueryEntry& rEntry = aParam.GetEntry(i);
-			ULONG nIndex = 0;
+			sal_uInt32 nIndex = 0;
 			rEntry.bQueryByString =
 					 !(pDoc->GetFormatTable()->IsNumberFormat(*rEntry.pStr,
 															  nIndex, rEntry.nVal));
Index: sc/source/core/data/documen2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen2.cxx,v
retrieving revision 1.48
retrieving revision 1.47.68.2
diff -u -p -u -p -r1.48 -r1.47.68.2
--- sc/source/core/data/documen2.cxx	16 Feb 2005 18:05:58 -0000	1.48
+++ sc/source/core/data/documen2.cxx	9 Mar 2005 20:54:26 -0000	1.47.68.2
@@ -1367,7 +1367,7 @@ void ScDocument::SetLostData()
 	bLostData = TRUE;
 }
 
-void ScDocument::DeleteNumberFormat( const ULONG* pDelKeys, ULONG nCount )
+void ScDocument::DeleteNumberFormat( const sal_uInt32* pDelKeys, sal_uInt32 nCount )
 {
 /*
 	for (ULONG i = 0; i < nCount; i++)
@@ -1737,7 +1737,7 @@ ULONG ScDocument::TransferTab( ScDocumen
 		SvNumberFormatter* pOtherFormatter = pSrcDoc->xPoolHelper->GetFormTable();
 		if (pOtherFormatter && pOtherFormatter != pThisFormatter)
 		{
-			SvULONGTable* pExchangeList =
+			Svsal_uInt32Table* pExchangeList =
 					 pThisFormatter->MergeFormatter(*(pOtherFormatter));
 			if (pExchangeList->Count() > 0)
 				pFormatExchangeList = pExchangeList;
Index: sc/source/core/data/documen8.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/documen8.cxx,v
retrieving revision 1.38
retrieving revision 1.38.32.1
diff -u -p -u -p -r1.38 -r1.38.32.1
--- sc/source/core/data/documen8.cxx	23 Dec 2004 10:43:45 -0000	1.38
+++ sc/source/core/data/documen8.cxx	21 Jan 2005 16:35:03 -0000	1.38.32.1
@@ -357,7 +357,7 @@ void ScDocument::CopyStdStylesFrom( ScDo
     SvNumberFormatter* pOtherFormatter = pSrcDoc->xPoolHelper->GetFormTable();
     if (pOtherFormatter && pOtherFormatter != pThisFormatter)
     {
-        SvULONGTable* pExchangeList =
+        Svsal_uInt32Table* pExchangeList =
                 pThisFormatter->MergeFormatter(*(pOtherFormatter));
         if (pExchangeList->Count() > 0)
             pFormatExchangeList = pExchangeList;
Index: sc/source/core/data/document.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/document.cxx,v
retrieving revision 1.64
retrieving revision 1.63.68.2
diff -u -p -u -p -r1.64 -r1.63.68.2
--- sc/source/core/data/document.cxx	16 Feb 2005 18:06:13 -0000	1.64
+++ sc/source/core/data/document.cxx	9 Mar 2005 20:55:27 -0000	1.63.68.2
@@ -1641,7 +1641,7 @@ void ScDocument::CopyFromClip( const ScR
 			SvNumberFormatter* pOtherFormatter = pClipDoc->xPoolHelper->GetFormTable();
 			if (pOtherFormatter && pOtherFormatter != pThisFormatter)
 			{
-				SvULONGTable* pExchangeList =
+				Svsal_uInt32Table* pExchangeList =
 						 pThisFormatter->MergeFormatter(*(pOtherFormatter));
 				if (pExchangeList->Count() > 0)
 					pFormatExchangeList = pExchangeList;
@@ -2131,7 +2131,7 @@ double ScDocument::GetValue( const ScAdd
 
 
 void ScDocument::GetNumberFormat( SCCOL nCol, SCROW nRow, SCTAB nTab,
-								  ULONG& rFormat )
+								  sal_uInt32& rFormat )
 {
 	if (VALIDTAB(nTab))
 		if (pTab[nTab])
@@ -2143,7 +2143,7 @@ void ScDocument::GetNumberFormat( SCCOL 
 }
 
 
-ULONG ScDocument::GetNumberFormat( const ScAddress& rPos ) const
+sal_uInt32 ScDocument::GetNumberFormat( const ScAddress& rPos ) const
 {
 	SCTAB nTab = rPos.Tab();
 	if ( pTab[nTab] )
Index: sc/source/core/data/dpdimsave.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dpdimsave.cxx,v
retrieving revision 1.2
retrieving revision 1.2.100.1
diff -u -p -u -p -r1.2 -r1.2.100.1
--- sc/source/core/data/dpdimsave.cxx	3 Aug 2004 11:30:39 -0000	1.2
+++ sc/source/core/data/dpdimsave.cxx	21 Jan 2005 16:35:19 -0000	1.2.100.1
@@ -156,7 +156,7 @@ void ScDPSaveGroupItem::AddToData( ScDPG
 
     for ( std::vector<String>::const_iterator aIter(aElements.begin()); aIter != aElements.end(); aIter++ )
     {
-        ULONG nFormat = 0;      //! ...
+        sal_uInt32 nFormat = 0;      //! ...
         double fValue;
         if ( pFormatter->IsNumberFormat( *aIter, nFormat, fValue ) )
             aData = ScDPItemData( *aIter, fValue, TRUE );
Index: sc/source/core/data/dpshttab.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/dpshttab.cxx,v
retrieving revision 1.5
retrieving revision 1.5.42.1
diff -u -p -u -p -r1.5 -r1.5.42.1
--- sc/source/core/data/dpshttab.cxx	4 Jun 2004 10:24:58 -0000	1.5
+++ sc/source/core/data/dpshttab.cxx	21 Jan 2005 16:35:39 -0000	1.5.42.1
@@ -130,7 +130,7 @@ ScSheetDPData::ScSheetDPData( ScDocument
             }
             else
             {
-		        ULONG nIndex = 0;
+		        sal_uInt32 nIndex = 0;
 		        rEntry.bQueryByString =
 					        !(pD->GetFormatTable()->
 						        IsNumberFormat(*rEntry.pStr, nIndex, rEntry.nVal));
Index: sc/source/core/data/patattr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/patattr.cxx,v
retrieving revision 1.26
retrieving revision 1.26.32.1
diff -u -p -u -p -r1.26 -r1.26.32.1
--- sc/source/core/data/patattr.cxx	23 Dec 2004 10:44:18 -0000	1.26
+++ sc/source/core/data/patattr.cxx	21 Jan 2005 16:36:02 -0000	1.26.32.1
@@ -941,7 +941,7 @@ SfxStyleSheetBase* lcl_CopyStyleToPool
 		SfxStyleSheetBase*		pSrcStyle,
 		SfxStyleSheetBasePool*	pSrcPool,
         SfxStyleSheetBasePool*	pDestPool,
-        const SvULONGTable*     pFormatExchangeList
+        const Svsal_uInt32Table*     pFormatExchangeList
 	)
 {
 	if ( !pSrcStyle || !pDestPool || !pSrcPool )
@@ -1045,7 +1045,7 @@ ScPatternAttr* ScPatternAttr::PutInPool(
 
 						ScStyleSheetPool* pSrcSPool = pSrcDoc->GetStyleSheetPool();
 						ScStyleSheetPool* pDestSPool = pDestDoc->GetStyleSheetPool();
-                        const SvULONGTable* pFormatExchangeList = pDestDoc->GetFormatExchangeList();
+                        const Svsal_uInt32Table* pFormatExchangeList = pDestDoc->GetFormatExchangeList();
 						USHORT nStlCnt = pOldData->Count();
 						for (USHORT i=0; i<nStlCnt; i++)
 						{
Index: sc/source/core/data/table3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table3.cxx,v
retrieving revision 1.20
retrieving revision 1.16.42.4
diff -u -p -u -p -r1.20 -r1.16.42.4
--- sc/source/core/data/table3.cxx	15 Nov 2004 16:34:51 -0000	1.20
+++ sc/source/core/data/table3.cxx	21 Jan 2005 16:36:18 -0000	1.16.42.4
@@ -1090,7 +1090,7 @@ BOOL ScTable::ValidQuery(SCROW nRow, con
                         bOk = pTransliteration->isEqual( aCellStr, *rEntry.pStr );
 					else
 					{
-                        ::com::sun::star::uno::Sequence< long > xOff;
+                        ::com::sun::star::uno::Sequence< sal_Int32 > xOff;
                         String aCell( pTransliteration->transliterate(
                             aCellStr, ScGlobal::eLnge, 0, aCellStr.Len(),
                             &xOff ) );
@@ -1332,7 +1332,7 @@ SCSIZE ScTable::Query(ScQueryParam& rPar
 
 		if ( rEntry.bQueryByString )
 		{
-			ULONG nIndex = 0;
+			sal_uInt32 nIndex = 0;
 			rEntry.bQueryByString = !(pDocument->GetFormatTable()->
 				IsNumberFormat( *rEntry.pStr, nIndex, rEntry.nVal ));
 		}
Index: sc/source/core/data/validat.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/validat.cxx,v
retrieving revision 1.12
retrieving revision 1.12.42.1
diff -u -p -u -p -r1.12 -r1.12.42.1
--- sc/source/core/data/validat.cxx	4 Jun 2004 10:29:49 -0000	1.12
+++ sc/source/core/data/validat.cxx	21 Jan 2005 16:36:37 -0000	1.12.42.1
@@ -560,7 +560,7 @@ BOOL ScValidationData::IsDataValid( cons
 
 	//	Test, was es denn ist - wie in ScColumn::SetString
 
-	ULONG nFormat = rPattern.GetNumberFormat( pFormatter );
+	sal_uInt32 nFormat = rPattern.GetNumberFormat( pFormatter );
 
 	double nVal;
 	BOOL bIsVal = pFormatter->IsNumberFormat( rTest, nFormat, nVal );
Index: sc/source/core/tool/chartarr.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/chartarr.cxx,v
retrieving revision 1.13
retrieving revision 1.13.76.1
diff -u -p -u -p -r1.13 -r1.13.76.1
--- sc/source/core/tool/chartarr.cxx	20 Aug 2004 09:11:50 -0000	1.13
+++ sc/source/core/tool/chartarr.cxx	21 Jan 2005 16:37:52 -0000	1.13.76.1
@@ -93,14 +93,14 @@ void ScChartArray::CopySettings( SchMemC
 	rDest.SetYAxisTitle( rSource.GetYAxisTitle() );
 	rDest.SetZAxisTitle( rSource.GetZAxisTitle() );
 
-	const long* pArr;
+	sal_Int32* pArr;
 	if ( rSource.GetRowCount() == rDest.GetRowCount() &&
 		 rSource.GetColCount() == rDest.GetColCount() )
 	{
 		//	don't copy column/row number formats here (are set in new MemChart object)
 
-		if ( (pArr = rSource.GetRowTranslation()) ) rDest.SetRowTranslation( pArr );
-		if ( (pArr = rSource.GetColTranslation()) ) rDest.SetColTranslation( pArr );
+		if ( (pArr = (sal_Int32 *) rSource.GetRowTranslation()) ) rDest.SetRowTranslation( pArr );
+		if ( (pArr = (sal_Int32 *) rSource.GetColTranslation()) ) rDest.SetColTranslation( pArr );
 		rDest.SetTranslation( rSource.GetTranslation() );
 	}
 }
@@ -758,7 +758,7 @@ SchMemChart* ScChartArray::CreateMemChar
 							nVal = ((ScValueCell*)pCell)->GetValue();
 							if ( bCalcAsShown && nVal != 0.0 )
 							{
-								ULONG nFormat;
+								sal_uInt32 nFormat;
 								pDocument->GetNumberFormat( pCols[nCol],
 									pRows[nRow], nTab1, nFormat );
 								nVal = pDocument->RoundValueAsShown( nVal, nFormat );
Index: sc/source/core/tool/compiler.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/compiler.cxx,v
retrieving revision 1.52
retrieving revision 1.52.68.1
diff -u -p -u -p -r1.52 -r1.52.68.1
--- sc/source/core/tool/compiler.cxx	15 Nov 2004 15:10:14 -0000	1.52
+++ sc/source/core/tool/compiler.cxx	21 Jan 2005 16:37:10 -0000	1.52.68.1
@@ -888,7 +888,7 @@ BOOL ScCompiler::IsOpCode2( const String
 BOOL ScCompiler::IsValue( const String& rSym )
 {
     double fVal;
-    ULONG nIndex = ( pSymbolTable == pSymbolTableEnglish ?
+    sal_uInt32 nIndex = ( pSymbolTable == pSymbolTableEnglish ?
         pDoc->GetFormatTable()->GetStandardIndex( LANGUAGE_ENGLISH_US ) : 0 );
 //  ULONG nIndex = 0;
 ////    ULONG nIndex = pDoc->GetFormatTable()->GetStandardIndex(ScGlobal::eLnge);
Index: sc/source/core/tool/ddelink.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/ddelink.cxx,v
retrieving revision 1.11
retrieving revision 1.11.48.1
diff -u -p -u -p -r1.11 -r1.11.48.1
--- sc/source/core/tool/ddelink.cxx	4 Oct 2004 20:05:51 -0000	1.11
+++ sc/source/core/tool/ddelink.cxx	21 Jan 2005 16:37:29 -0000	1.11.48.1
@@ -239,7 +239,7 @@ void __EXPORT ScDdeLink::DataChanged( co
 			for (SCSIZE nC=0; nC<nCols; nC++)
 			{
 				aEntry = aLine.GetToken( (xub_StrLen) nC, '\t' );
-				ULONG nIndex = nStdFormat;
+				sal_uInt32 nIndex = nStdFormat;
 				double fVal;
 				if ( nMode != SC_DDE_TEXT && pFormatter->IsNumberFormat( aEntry, nIndex, fVal ) )
 					pResult->PutDouble( fVal, nC, nR );
Index: sc/source/core/tool/interpr1.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr1.cxx,v
retrieving revision 1.33
retrieving revision 1.32.68.2
diff -u -p -u -p -r1.33 -r1.32.68.2
--- sc/source/core/tool/interpr1.cxx	28 Jan 2005 17:20:19 -0000	1.33
+++ sc/source/core/tool/interpr1.cxx	9 Mar 2005 20:56:34 -0000	1.32.68.2
@@ -2355,7 +2355,7 @@ void ScInterpreter::ScT()
 void ScInterpreter::ScValue()
 {
 	String aInputString = GetString();
-	ULONG nFIndex = 0;					// damit default Land/Spr.
+	sal_uInt32 nFIndex = 0;					// damit default Land/Spr.
 	double fVal;
 	if (pFormatter->IsNumberFormat(aInputString, nFIndex, fVal))
 		PushDouble(fVal);
@@ -2665,7 +2665,7 @@ double ScInterpreter::IterateParameters(
 				if( eFunc == ifCOUNT )
 				{
 					String aStr( PopString() );
-					ULONG nFIndex = 0;					// damit default Land/Spr.
+					sal_uInt32 nFIndex = 0;					// damit default Land/Spr.
 					if ( bTextAsZero || pFormatter->IsNumberFormat(aStr, nFIndex, fVal))
 						nCount++;
 				}
@@ -3710,7 +3710,7 @@ void ScInterpreter::ScCountIf()
 			else if( rString.Len() )
 			{
 				rParam.FillInExcelSyntax(rString, 0);
-				ULONG nIndex = 0;
+				sal_uInt32 nIndex = 0;
 				rEntry.bQueryByString =
 					!(pFormatter->IsNumberFormat(
 						*rEntry.pStr, nIndex, rEntry.nVal));
@@ -3892,7 +3892,7 @@ void ScInterpreter::ScSumIf()
 			else
 			{
 				rParam.FillInExcelSyntax(rString, 0);
-				ULONG nIndex = 0;
+				sal_uInt32 nIndex = 0;
 				rEntry.bQueryByString =
 					!(pFormatter->IsNumberFormat(
 						*rEntry.pStr, nIndex, rEntry.nVal));
@@ -5027,7 +5027,7 @@ BOOL ScInterpreter::GetDBParams(SCTAB& r
 						ScQueryEntry& rEntry = rParam.GetEntry(i);
 						if ( rEntry.bDoQuery )
 						{
-							ULONG nIndex = 0;
+							sal_uInt32 nIndex = 0;
 							rEntry.bQueryByString = !pFormatter->IsNumberFormat(
 								*rEntry.pStr, nIndex, rEntry.nVal );
 							if ( rEntry.bQueryByString && !rParam.bRegExp )
Index: sc/source/core/tool/interpr2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr2.cxx,v
retrieving revision 1.23
retrieving revision 1.23.68.1
diff -u -p -u -p -r1.23 -r1.23.68.1
--- sc/source/core/tool/interpr2.cxx	15 Nov 2004 16:35:29 -0000	1.23
+++ sc/source/core/tool/interpr2.cxx	21 Jan 2005 16:38:39 -0000	1.23.68.1
@@ -197,7 +197,7 @@ void ScInterpreter::ScGetHour()
 void ScInterpreter::ScGetDateValue()
 {
 	String aInputString = GetString();
-	ULONG nFIndex = 0;					// damit default Land/Spr.
+	sal_uInt32 nFIndex = 0;					// damit default Land/Spr.
 	double fVal;
 	if (pFormatter->IsNumberFormat(aInputString, nFIndex, fVal))
 	{
@@ -414,7 +414,7 @@ void ScInterpreter::ScGetDiffDate360()
 void ScInterpreter::ScGetTimeValue()
 {
 	String aInputString = GetString();
-	ULONG nFIndex = 0;					// damit default Land/Spr.
+	sal_uInt32 nFIndex = 0;					// damit default Land/Spr.
 	double fVal;
 	if (pFormatter->IsNumberFormat(aInputString, nFIndex, fVal))
 	{
Index: sc/source/core/tool/interpr4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/interpr4.cxx,v
retrieving revision 1.34
retrieving revision 1.32.68.2
diff -u -p -u -p -r1.34 -r1.32.68.2
--- sc/source/core/tool/interpr4.cxx	16 Feb 2005 18:06:55 -0000	1.34
+++ sc/source/core/tool/interpr4.cxx	9 Mar 2005 20:57:03 -0000	1.32.68.2
@@ -1459,7 +1459,7 @@ double ScInterpreter::GetDouble()
 		case svString:
 		{
 			String aStr(PopString());
-			ULONG nFIndex = 0;					// damit default Land/Spr.
+			sal_uInt32 nFIndex = 0;					// damit default Land/Spr.
 			if(!pFormatter->IsNumberFormat( aStr, nFIndex, nVal ) )
 			{
 				SetError(errIllegalArgument);
Index: sc/source/core/tool/rechead.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rechead.cxx,v
retrieving revision 1.2
retrieving revision 1.2.378.1
diff -u -p -u -p -r1.2 -r1.2.378.1
--- sc/source/core/tool/rechead.cxx	26 Mar 2003 18:04:18 -0000	1.2
+++ sc/source/core/tool/rechead.cxx	9 Sep 2004 11:02:24 -0000	1.2.378.1
@@ -217,7 +217,7 @@ ULONG ScMultipleReadHeader::BytesLeft() 
 
 // -----------------------------------------------------------------------
 
-ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault) :
+ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault) :
 	rStream( rNewStream ),
 	aMemStream( 4096, 4096 )
 {
Index: sc/source/core/tool/zforauto.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/zforauto.cxx,v
retrieving revision 1.3
retrieving revision 1.3.52.1
diff -u -p -u -p -r1.3 -r1.3.52.1
--- sc/source/core/tool/zforauto.cxx	17 Sep 2004 19:40:46 -0000	1.3
+++ sc/source/core/tool/zforauto.cxx	21 Jan 2005 16:39:13 -0000	1.3.52.1
@@ -154,7 +154,7 @@ ULONG ScNumFormatAbbrev::GetFormatIndex(
 
 	xub_StrLen nCheckPos;
 	short nType;
-	ULONG nKey = rFormatter.GetEntryKey(sFormatstring, eLnge);
+	sal_uInt32 nKey = rFormatter.GetEntryKey(sFormatstring, eLnge);
 	if (nKey == NUMBERFORMAT_ENTRY_NOT_FOUND)
 	{
 		BOOL res = rFormatter.PutEntry(sFormatstring,
Index: sc/source/filter/dif/difimp.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/dif/difimp.cxx,v
retrieving revision 1.8
retrieving revision 1.7.42.2
diff -u -p -u -p -r1.8 -r1.7.42.2
--- sc/source/filter/dif/difimp.cxx	21 Feb 2005 13:20:55 -0000	1.8
+++ sc/source/filter/dif/difimp.cxx	9 Mar 2005 20:57:12 -0000	1.7.42.2
@@ -520,7 +520,7 @@ DATASET	DifParser::GetNextDataset( void 
 				{	// ...und zur Strafe mit'm Numberformatter...
 					DBG_ASSERT( pNumFormatter, "-DifParser::GetNextDataset(): No Formatter, more fun!" );
 					String			aTestVal( pAkt );
-					ULONG			nFormat = 0;
+					sal_uInt32		nFormat = 0;
 					double			fTmpVal;
 					if( pNumFormatter->IsNumberFormat( aTestVal, nFormat, fTmpVal ) )
 					{
Index: sc/source/filter/excel/excrecds.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/excrecds.cxx,v
retrieving revision 1.78
retrieving revision 1.76.82.2
diff -u -p -u -p -r1.78 -r1.76.82.2
--- sc/source/filter/excel/excrecds.cxx	21 Feb 2005 13:25:15 -0000	1.78
+++ sc/source/filter/excel/excrecds.cxx	9 Mar 2005 21:17:30 -0000	1.76.82.2
@@ -466,7 +466,7 @@ ExcBundlesheetBase::ExcBundlesheetBase()
 void ExcBundlesheetBase::UpdateStreamPos( XclExpStream& rStrm )
 {
 	rStrm.SetStreamPos( nOwnPos );
-	rStrm << nStrPos;
+	rStrm << (sal_uInt32)nStrPos;
 }
 
 
@@ -678,7 +678,7 @@ BOOL XclExpAutofilter::AddEntry( const S
 	else
 	{
 		double	fVal	= 0.0;
-		ULONG	nIndex	= 0;
+		sal_uInt32	nIndex	= 0;
         BOOL    bIsNum  = bLen ? GetFormatter().IsNumberFormat( sText, nIndex, fVal ) : TRUE;
 		String*	pText	= bIsNum ? NULL : &sText;
 
Index: sc/source/filter/excel/xestyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xestyle.cxx,v
retrieving revision 1.18
retrieving revision 1.11.130.5
diff -u -p -u -p -r1.18 -r1.11.130.5
--- sc/source/filter/excel/xestyle.cxx	21 Feb 2005 13:30:50 -0000	1.18
+++ sc/source/filter/excel/xestyle.cxx	9 Mar 2005 21:14:21 -0000	1.11.130.5
@@ -1330,7 +1330,7 @@ void XclExpNumFmtBuffer::WriteFormatReco
             {
                 xub_StrLen nCheckPos;
                 short nType = NUMBERFORMAT_DEFINED;
-                ULONG nKey;
+                sal_uInt32 nKey;
                 String aTemp( pEntry->GetFormatstring() );
                 mxFormatter->PutandConvertEntry( aTemp, nCheckPos, nType, nKey, eLang, LANGUAGE_ENGLISH_US );
                 DBG_ASSERT( nCheckPos == 0, "XclExpNumFmtBuffer::WriteFormatRecord - format code not convertible" );
Index: sc/source/filter/excel/xiescher.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xiescher.cxx,v
retrieving revision 1.33
retrieving revision 1.30.6.2
diff -u -p -u -p -r1.33 -r1.30.6.2
--- sc/source/filter/excel/xiescher.cxx	21 Feb 2005 13:31:50 -0000	1.33
+++ sc/source/filter/excel/xiescher.cxx	9 Mar 2005 21:16:20 -0000	1.30.6.2
@@ -1532,7 +1532,7 @@ SdrObject* XclImpDffManager::ProcessObj(
             // automatic margin is handled by host
             if( GetPropertyBool( DFF_Prop_AutoTextMargin ) )
             {
-                long nMargin = EXC_ESCHER_AUTOMARGIN;
+                sal_Int32 nMargin = EXC_ESCHER_AUTOMARGIN;
                 ScaleEmu( nMargin );
                 pRetSdrObj->SetMergedItem( SdrTextLeftDistItem( nMargin ) );
                 pRetSdrObj->SetMergedItem( SdrTextRightDistItem( nMargin ) );
Index: sc/source/filter/excel/xistyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xistyle.cxx,v
retrieving revision 1.21
retrieving revision 1.20.32.2
diff -u -p -u -p -r1.21 -r1.20.32.2
--- sc/source/filter/excel/xistyle.cxx	21 Feb 2005 13:34:00 -0000	1.21
+++ sc/source/filter/excel/xistyle.cxx	9 Mar 2005 21:17:47 -0000	1.20.32.2
@@ -570,7 +570,7 @@ void XclImpNumFmtBuffer::CreateScFormats
         // insert/convert the Excel number format
         xub_StrLen nCheckPos;
         short nType = NUMBERFORMAT_DEFINED;
-        ULONG nKey;
+        sal_uInt32 nKey;
         if( rNumFmt.maFormat.Len() )
         {
             String aFormat( rNumFmt.maFormat );
Index: sc/source/filter/excel/xlstyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xlstyle.cxx,v
retrieving revision 1.15
retrieving revision 1.10.54.4
diff -u -p -u -p -r1.15 -r1.10.54.4
--- sc/source/filter/excel/xlstyle.cxx	21 Feb 2005 13:35:22 -0000	1.15
+++ sc/source/filter/excel/xlstyle.cxx	9 Mar 2005 21:16:28 -0000	1.10.54.4
@@ -355,7 +355,7 @@ FontStrikeout XclFontData::GetScStrikeou
 
 void XclFontData::SetScHeight( sal_Int32 nTwips )
 {
-    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, 0x7FFFL ) );
+    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, (sal_Int32)0x7FFF ) );
 }
 
 void XclFontData::SetScFamily( FontFamily eScFamily )
Index: sc/source/filter/html/htmlpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/html/htmlpars.cxx,v
retrieving revision 1.24
retrieving revision 1.20.42.5
diff -u -p -u -p -r1.24 -r1.20.42.5
--- sc/source/filter/html/htmlpars.cxx	21 Feb 2005 13:36:40 -0000	1.24
+++ sc/source/filter/html/htmlpars.cxx	9 Mar 2005 21:09:11 -0000	1.20.42.5
@@ -192,7 +192,7 @@ ScHTMLLayoutParser::~ScHTMLLayoutParser(
 }
 
 
-ULONG ScHTMLLayoutParser::Read( SvStream& rStream, const String& rBaseURL )
+sal_uInt32 ScHTMLLayoutParser::Read( SvStream& rStream, const String& rBaseURL )
 {
     Link aOldLink = pEdit->GetImportHdl();
     pEdit->SetImportHdl( LINK( this, ScHTMLLayoutParser, HTMLImportHdl ) );
@@ -221,7 +221,7 @@ ULONG ScHTMLLayoutParser::Read( SvStream
         }
     }
 
-    ULONG nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_HTML, pAttributes );
+    sal_uInt32 nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_HTML, pAttributes );
 
     pEdit->SetImportHdl( aOldLink );
     // Spaltenbreiten erzeugen
@@ -2194,10 +2194,10 @@ void ScHTMLTable::DataOn( const ImportIn
             switch( aIter->GetToken() )
             {
                 case HTML_O_COLSPAN:
-                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_ROWSPAN:
-                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_SDVAL:
                     pValStr.reset( new String( aIter->GetString() ) );
@@ -2993,7 +2993,7 @@ void ScHTMLQueryParser::FontOn( const Im
             break;
             case HTML_O_SIZE :
             {
-                sal_uInt32 nSize = bound( aIter->GetNumber(), 1UL, SC_HTML_FONTSIZES );
+                sal_uInt32 nSize = bound( aIter->GetNumber(), (sal_uInt32)1, SC_HTML_FONTSIZES );
                 mpCurrTable->PutItem( SvxFontHeightItem( maFontHeights[ nSize - 1 ], 100, ATTR_FONT_HEIGHT ) );
             }
             break;
Index: sc/source/filter/inc/eeparser.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/eeparser.hxx,v
retrieving revision 1.4
retrieving revision 1.4.6.1
diff -u -p -u -p -r1.4 -r1.4.6.1
--- sc/source/filter/inc/eeparser.hxx	11 Jan 2005 13:17:58 -0000	1.4
+++ sc/source/filter/inc/eeparser.hxx	21 Jan 2005 16:41:18 -0000	1.4.6.1
@@ -184,7 +184,7 @@ public:
 						ScEEParser( EditEngine* );
 	virtual				~ScEEParser();
 
-    virtual ULONG       Read( SvStream&, const String& rBaseURL ) = 0;
+	virtual sal_uInt32		Read( SvStream&, const String& rBaseURL ) = 0;
 
 	void				GetDimensions( SCCOL& nCols, SCROW& nRows ) const
 							{ nCols = nColMax; nRows = nRowMax; }
Index: sc/source/filter/inc/htmlpars.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/htmlpars.hxx,v
retrieving revision 1.11
retrieving revision 1.11.6.1
diff -u -p -u -p -r1.11 -r1.11.6.1
--- sc/source/filter/inc/htmlpars.hxx	11 Jan 2005 13:18:25 -0000	1.11
+++ sc/source/filter/inc/htmlpars.hxx	21 Jan 2005 16:41:34 -0000	1.11.6.1
@@ -231,7 +231,7 @@ private:
 public:
                         ScHTMLLayoutParser( EditEngine*, const String& rBaseURL, const Size& aPageSize, ScDocument* );
     virtual             ~ScHTMLLayoutParser();
-    virtual ULONG       Read( SvStream&, const String& rBaseURL  );
+    virtual sal_uInt32       Read( SvStream&, const String& rBaseURL  );
     virtual const ScHTMLTable*  GetGlobalTable() const;
 };
 
Index: sc/source/filter/inc/rtfparse.hxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/inc/rtfparse.hxx,v
retrieving revision 1.3
retrieving revision 1.3.6.1
diff -u -p -u -p -r1.3 -r1.3.6.1
--- sc/source/filter/inc/rtfparse.hxx	11 Jan 2005 13:18:39 -0000	1.3
+++ sc/source/filter/inc/rtfparse.hxx	21 Jan 2005 16:41:49 -0000	1.3.6.1
@@ -116,7 +116,7 @@ private:
 public:
 						ScRTFParser( EditEngine* );
 	virtual				~ScRTFParser();
-    virtual ULONG       Read( SvStream&, const String& rBaseURL );
+	virtual sal_uInt32		Read( SvStream&, const String& rBaseURL );
 };
 
 
Index: sc/source/filter/rtf/eeimpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/rtf/eeimpars.cxx,v
retrieving revision 1.12
retrieving revision 1.12.6.1
diff -u -p -u -p -r1.12 -r1.12.6.1
--- sc/source/filter/rtf/eeimpars.cxx	11 Jan 2005 13:18:53 -0000	1.12
+++ sc/source/filter/rtf/eeimpars.cxx	21 Jan 2005 16:42:00 -0000	1.12.6.1
@@ -252,7 +252,7 @@ void ScEEImport::WriteToDocument( BOOL b
 			// HTML
 			String aValStr, aNumStr;
 			double fVal;
-			ULONG nNumForm;
+			sal_uInt32 nNumForm;
 			LanguageType eNumLang;
 			if ( pE->pNumStr )
 			{	// SDNUM muss sein wenn SDVAL
Index: sc/source/filter/rtf/rtfparse.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/rtf/rtfparse.cxx,v
retrieving revision 1.4
retrieving revision 1.4.6.1
diff -u -p -u -p -r1.4 -r1.4.6.1
--- sc/source/filter/rtf/rtfparse.cxx	11 Jan 2005 13:19:20 -0000	1.4
+++ sc/source/filter/rtf/rtfparse.cxx	21 Jan 2005 16:42:09 -0000	1.4.6.1
@@ -119,11 +119,11 @@ ScRTFParser::~ScRTFParser()
 }
 
 
-ULONG ScRTFParser::Read( SvStream& rStream, const String& rBaseURL )
+sal_uInt32 ScRTFParser::Read( SvStream& rStream, const String& rBaseURL )
 {
 	Link aOldLink = pEdit->GetImportHdl();
 	pEdit->SetImportHdl( LINK( this, ScRTFParser, RTFImportHdl ) );
-    ULONG nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_RTF );
+	sal_uInt32 nErr = pEdit->Read( rStream, rBaseURL, EE_FORMAT_RTF );
 	if ( nLastToken == RTF_PAR )
 	{
 		ScEEParseEntry* pE = pList->Last();
Index: sc/source/filter/xcl97/XclImpChangeTrack.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/XclImpChangeTrack.cxx,v
retrieving revision 1.26
retrieving revision 1.25.82.2
diff -u -p -u -p -r1.26 -r1.25.82.2
--- sc/source/filter/xcl97/XclImpChangeTrack.cxx	21 Feb 2005 13:49:20 -0000	1.26
+++ sc/source/filter/xcl97/XclImpChangeTrack.cxx	9 Mar 2005 21:19:48 -0000	1.25.82.2
@@ -169,7 +169,7 @@ void XclImpChangeTrack::DoInsertRange( c
 
 void XclImpChangeTrack::DoDeleteRange( const ScRange& rRange )
 {
-	sal_uInt32 nFirst, nLast;
+	ULONG nFirst, nLast;
 	pChangeTrack->AppendDeleteRange( rRange, NULL, nFirst, nLast );
 	DoAcceptRejectAction( nFirst, nLast );
 }
Index: sc/source/filter/xcl97/xcl97rec.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/xcl97rec.cxx,v
retrieving revision 1.76
retrieving revision 1.67.40.5
diff -u -p -u -p -r1.76 -r1.67.40.5
--- sc/source/filter/xcl97/xcl97rec.cxx	21 Feb 2005 13:50:03 -0000	1.76
+++ sc/source/filter/xcl97/xcl97rec.cxx	9 Mar 2005 21:19:29 -0000	1.67.40.5
@@ -284,7 +284,7 @@ ULONG XclMsodrawinggroup::GetLen() const
 
 // --- class XclMsodrawing --------------------------------------
 
-XclMsodrawing::XclMsodrawing( const XclExpRoot& rRoot, UINT16 nEscherType, UINT32 nInitialSize ) :
+XclMsodrawing::XclMsodrawing( const XclExpRoot& rRoot, UINT16 nEscherType, ULONG nInitialSize ) :
     XclMsodrawing_Base( *rRoot.GetOldRoot().pEscher, nInitialSize )
 {
 	if ( nEscherType )
@@ -590,7 +590,7 @@ void XclObjComment::ProcessEscherObj( co
 	pEx->OpenContainer( ESCHER_SpContainer );
 	pEx->AddShape( ESCHER_ShpInst_TextBox, SHAPEFLAG_HAVEANCHOR | SHAPEFLAG_HAVESPT );
     sal_uInt32 nFlags = 0x000A0000;
-    ::set_flag( nFlags, 2UL, !bVisible );
+    ::set_flag( nFlags, (sal_uInt32)2, !bVisible );
     aPropOpt.AddOpt( ESCHER_Prop_fPrint, nFlags );                  // bool field
 	aPropOpt.Commit( pEx->GetStream() );
 
Index: sc/source/ui/Accessibility/AccessibleCsvControl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleCsvControl.cxx,v
retrieving revision 1.16
retrieving revision 1.15.206.2
diff -u -p -u -p -r1.16 -r1.15.206.2
--- sc/source/ui/Accessibility/AccessibleCsvControl.cxx	23 Aug 2004 09:27:42 -0000	1.16
+++ sc/source/ui/Accessibility/AccessibleCsvControl.cxx	19 Oct 2004 13:27:42 -0000	1.15.206.2
@@ -407,7 +407,7 @@ sal_Int32 lcl_GetApiPos( sal_Int32 nRule
         nApiPos += nStart - nExp + 1;
         nExp *= 10;
     }
-    return ::std::max( nApiPos, 0L );
+    return ::std::max( nApiPos, (sal_Int32)0 );
 }
 
 /** Converts an API text index to a ruler cursor position. */
@@ -626,7 +626,7 @@ sal_Int32 SAL_CALL ScAccessibleCsvRuler:
     ensureAlive();
     ScCsvRuler& rRuler = implGetRuler();
     // #107054# use object's coordinate system, convert to API position
-    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), 0L ), rRuler.GetPosCount() ) );
+    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), (sal_Int32)0 ), rRuler.GetPosCount() ) );
 }
 
 OUString SAL_CALL ScAccessibleCsvRuler::getSelectedText() throw( RuntimeException )
Index: sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx,v
retrieving revision 1.30
retrieving revision 1.29.42.2
diff -u -p -u -p -r1.30 -r1.29.42.2
--- sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	8 Sep 2004 13:52:20 -0000	1.30
+++ sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	19 Oct 2004 13:27:31 -0000	1.29.42.2
@@ -1771,7 +1771,7 @@ void SAL_CALL ScAccessibleDocumentPagePr
 
 //=====  XAccessibleContext  ==============================================
 
-long SAL_CALL ScAccessibleDocumentPagePreview::getAccessibleChildCount(void) throw (uno::RuntimeException)
+sal_Int32 SAL_CALL ScAccessibleDocumentPagePreview::getAccessibleChildCount(void) throw (uno::RuntimeException)
 {
 	ScUnoGuard aGuard;
     IsObjectValid();
Index: sc/source/ui/app/inputhdl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/app/inputhdl.cxx,v
retrieving revision 1.59
retrieving revision 1.58.138.2
diff -u -p -u -p -r1.59 -r1.58.138.2
--- sc/source/ui/app/inputhdl.cxx	16 Feb 2005 18:09:54 -0000	1.59
+++ sc/source/ui/app/inputhdl.cxx	9 Mar 2005 20:36:36 -0000	1.58.138.2
@@ -2096,7 +2096,7 @@ void ScInputHandler::EnterHandler( BYTE 
 			ScDocument* pDoc = pActiveViewSh->GetViewData()->GetDocument();
 			SvNumberFormatter* pFormatter = pDoc->GetFormatTable();
 			// without conditional format, as in ScColumn::SetString
-			ULONG nFormat = pLastPattern->GetNumberFormat( pFormatter );
+			sal_uInt32 nFormat = pLastPattern->GetNumberFormat( pFormatter );
 			double nVal;
 			if ( pFormatter->IsNumberFormat( aString, nFormat, nVal ) )
 			{
Index: sc/source/ui/dbgui/csvgrid.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvgrid.cxx,v
retrieving revision 1.21
retrieving revision 1.19.42.3
diff -u -p -u -p -r1.21 -r1.19.42.3
--- sc/source/ui/dbgui/csvgrid.cxx	11 Oct 2004 12:28:48 -0000	1.21
+++ sc/source/ui/dbgui/csvgrid.cxx	18 Jan 2005 04:32:56 -0000	1.19.42.3
@@ -179,7 +179,7 @@ void ScCsvGrid::UpdateOffsetX()
     sal_Int32 nLastLine = GetLastVisLine() + 1;
     sal_Int32 nDigits = 2;
     while( nLastLine /= 10 ) ++nDigits;
-    nDigits = Max( nDigits, 3L );
+    nDigits = Max( nDigits, (sal_Int32)3 );
     Execute( CSVCMD_SETHDRWIDTH, GetTextWidth( String( '0' ) ) * nDigits );
 }
 
@@ -704,8 +704,8 @@ void ScCsvGrid::MoveCursor( sal_uInt32 n
     {
         sal_Int32 nPosBeg = GetColumnPos( nColIndex );
         sal_Int32 nPosEnd = GetColumnPos( nColIndex + 1 );
-        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, 0L );
-        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + 1L, nMinPos );
+        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, (sal_Int32)0 );
+        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + (sal_Int32)1, nMinPos );
         if( nPosBeg - CSV_SCROLL_DIST + 1 <= GetFirstVisPos() )
             Execute( CSVCMD_SETPOSOFFSET, nMinPos );
         else if( nPosEnd + CSV_SCROLL_DIST >= GetLastVisPos() )
@@ -787,7 +787,7 @@ void ScCsvGrid::ImplSetTextLineSep(
         pChar = ScImportExport::ScanNextFieldFromString( pChar, aCellText, cTextSep, pSepChars, bMergeSep );
 
         // update column width
-        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + 1L );
+        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + (sal_Int32)1 );
         if( IsValidColumn( nColIx ) )
         {
             // expand existing column
@@ -918,7 +918,7 @@ void ScCsvGrid::Tracking( const Tracking
 
         sal_Int32 nPos = (rMEvt.GetPosPixel().X() - GetFirstX()) / GetCharWidth() + GetFirstVisPos();
         // on mouse tracking: keep position valid
-        nPos = Max( Min( nPos, GetPosCount() - 1L ), 0L );
+        nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)0 );
         Execute( CSVCMD_MAKEPOSVISIBLE, nPos );
 
         sal_uInt32 nColIx = GetColumnFromPos( nPos );
@@ -1366,7 +1366,7 @@ void ScCsvGrid::ImplDrawTrackingRect( sa
     if( HasFocus() && IsVisibleColumn( nColIndex ) )
     {
         sal_Int32 nX1 = Max( GetColumnX( nColIndex ), GetFirstX() ) + 1;
-        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - 1L, GetLastX() );
+        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - (sal_Int32)1, GetLastX() );
         sal_Int32 nY2 = Min( GetY( GetLastVisLine() + 1 ), GetHeight() ) - 1;
         InvertTracking( Rectangle( nX1, 0, nX2, nY2 ), SHOWTRACK_SMALL | SHOWTRACK_WINDOW );
     }
Index: sc/source/ui/dbgui/csvruler.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvruler.cxx,v
retrieving revision 1.9
retrieving revision 1.9.378.1
diff -u -p -u -p -r1.9 -r1.9.378.1
--- sc/source/ui/dbgui/csvruler.cxx	26 Mar 2003 18:05:52 -0000	1.9
+++ sc/source/ui/dbgui/csvruler.cxx	9 Sep 2004 11:02:30 -0000	1.9.378.1
@@ -231,7 +231,7 @@ sal_Int32 ScCsvRuler::GetNoScrollPos( sa
         else if( nNewPos > GetLastVisPos() - CSV_SCROLL_DIST - 1L )
         {
             sal_Int32 nScroll = (GetFirstVisPos() < GetMaxPosOffset()) ? CSV_SCROLL_DIST : 0;
-            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - 1L );
+            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - (sal_Int32)1 );
         }
     }
     return nNewPos;
@@ -374,7 +374,7 @@ void ScCsvRuler::MouseMove( const MouseE
         if( IsTracking() )
         {
             // on mouse tracking: keep position valid
-            nPos = Max( Min( nPos, GetPosCount() - 1L ), 1L );
+            nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)1 );
             MoveMouseTracking( nPos );
         }
         else
@@ -513,7 +513,7 @@ void ScCsvRuler::ImplDrawArea( sal_Int32
 
     aRect = maActiveRect;
     aRect.Left() = Max( GetFirstX(), nPosX );
-    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - 1L );
+    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - (sal_Int32)1 );
     if( aRect.Left() <= aRect.Right() )
     {
         maBackgrDev.SetFillColor( maActiveColor );
Index: sc/source/ui/dbgui/csvtablebox.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvtablebox.cxx,v
retrieving revision 1.8
retrieving revision 1.7.378.2
diff -u -p -u -p -r1.8 -r1.7.378.2
--- sc/source/ui/dbgui/csvtablebox.cxx	23 Aug 2004 09:29:32 -0000	1.8
+++ sc/source/ui/dbgui/csvtablebox.cxx	19 Oct 2004 13:19:12 -0000	1.7.378.2
@@ -409,33 +409,33 @@ IMPL_LINK( ScCsvTableBox, CsvCmdHdl, ScC
     switch( eType )
     {
         case CSVCMD_SETPOSCOUNT:
-            maData.mnPosCount = Max( nParam1, 1L );
+            maData.mnPosCount = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETPOSOFFSET:
             ImplSetPosOffset( nParam1 );
         break;
         case CSVCMD_SETHDRWIDTH:
-            maData.mnHdrWidth = Max( nParam1, 0L );
+            maData.mnHdrWidth = Max( nParam1, (sal_Int32)0 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETCHARWIDTH:
-            maData.mnCharWidth = Max( nParam1, 1L );
+            maData.mnCharWidth = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETLINECOUNT:
-            maData.mnLineCount = Max( nParam1, 1L );
+            maData.mnLineCount = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEOFFSET:
             ImplSetLineOffset( nParam1 );
         break;
         case CSVCMD_SETHDRHEIGHT:
-            maData.mnHdrHeight = Max( nParam1, 0L );
+            maData.mnHdrHeight = Max( nParam1, (sal_Int32)0 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEHEIGHT:
-            maData.mnLineHeight = Max( nParam1, 1L );
+            maData.mnLineHeight = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_MOVERULERCURSOR:
Index: sc/source/ui/docshell/docfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docfunc.cxx,v
retrieving revision 1.52
retrieving revision 1.52.56.1
diff -u -p -u -p -r1.52 -r1.52.56.1
--- sc/source/ui/docshell/docfunc.cxx	8 Sep 2004 13:52:34 -0000	1.52
+++ sc/source/ui/docshell/docfunc.cxx	21 Jan 2005 16:43:14 -0000	1.52.56.1
@@ -1008,7 +1008,7 @@ ScBaseCell* ScDocFunc::InterpretEnglishS
 	else		// (nur) auf englisches Zahlformat testen
 	{
 		SvNumberFormatter* pFormatter = pDoc->GetFormatTable();
-		ULONG nEnglish = pFormatter->GetStandardIndex(LANGUAGE_ENGLISH_US);
+		sal_uInt32 nEnglish = pFormatter->GetStandardIndex(LANGUAGE_ENGLISH_US);
 		double fVal;
 		if ( pFormatter->IsNumberFormat( rText, nEnglish, fVal ) )
 			pNewCell = new ScValueCell( fVal );
Index: sc/source/ui/docshell/docsh.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh.cxx,v
retrieving revision 1.78
retrieving revision 1.77.6.2
diff -u -p -u -p -r1.78 -r1.77.6.2
--- sc/source/ui/docshell/docsh.cxx	21 Feb 2005 13:50:23 -0000	1.78
+++ sc/source/ui/docshell/docsh.cxx	9 Mar 2005 20:52:07 -0000	1.77.6.2
@@ -230,7 +230,7 @@ TYPEINIT1( ScDocShell, SfxObjectShell );
 //------------------------------------------------------------------
 
 void __EXPORT ScDocShell::FillClass( SvGlobalName* pClassName,
-										ULONG* pFormat,
+										sal_uInt32* pFormat,
 										String* pAppName,
 										String* pFullTypeName,
 										String* pShortTypeName,
@@ -1530,7 +1530,7 @@ void ScDocShell::AsciiSave( SvStream& rS
                     }
                     else if ( ((ScFormulaCell*)pCell)->IsValue() )
                     {
-                        ULONG nFormat;
+                        sal_uInt32 nFormat;
                         aDocument.GetNumberFormat( nCol, nRow, nTab, nFormat );
                         if ( bFixedWidth )
                         {
@@ -1564,7 +1564,7 @@ void ScDocShell::AsciiSave( SvStream& rS
                 break;
             case CELLTYPE_VALUE :
                 {
-                    ULONG nFormat;
+                    sal_uInt32 nFormat;
                     aDocument.GetNumberFormat( nCol, nRow, nTab, nFormat );
                     if ( bFixedWidth )
                     {
Index: sc/source/ui/docshell/docsh8.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/docsh8.cxx,v
retrieving revision 1.17
retrieving revision 1.17.42.1
diff -u -p -u -p -r1.17 -r1.17.42.1
--- sc/source/ui/docshell/docsh8.cxx	4 Jun 2004 11:24:52 -0000	1.17
+++ sc/source/ui/docshell/docsh8.cxx	21 Jan 2005 16:43:54 -0000	1.17.42.1
@@ -607,7 +607,7 @@ void lcl_GetColumnTypes( ScDocShell& rDo
 				nDbType = sdbc::DataType::VARCHAR;
 			else
 			{
-				ULONG nFormat;
+				sal_uInt32 nFormat;
 				pDoc->GetNumberFormat( nCol, nFirstDataRow, nTab, nFormat );
 				if ( pCell && pCell->GetCellType() == CELLTYPE_FORMULA
 				  && ((nFormat % SV_COUNTRY_LANGUAGE_OFFSET) == 0) )
@@ -994,7 +994,7 @@ ULONG ScDocShell::DBaseExport( const Str
 								}
 								else
 								{
-									ULONG nFormat;
+									sal_uInt32 nFormat;
 									Color* pColor;
 									aDocument.GetNumberFormat( nDocCol, nDocRow, nTab, nFormat );
 									ScCellFormat::GetString( pCell, nFormat, aString, &pColor, *pNumFmt );
Index: sc/source/ui/docshell/impex.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/docshell/impex.cxx,v
retrieving revision 1.31
retrieving revision 1.31.6.1
diff -u -p -u -p -r1.31 -r1.31.6.1
--- sc/source/ui/docshell/impex.cxx	11 Jan 2005 13:20:36 -0000	1.31
+++ sc/source/ui/docshell/impex.cxx	21 Jan 2005 16:44:08 -0000	1.31.6.1
@@ -835,7 +835,7 @@ bool lcl_PutString( ScDocument* pDoc, SC
 		//!	SetString mit Extra-Flag ???
 
 		SvNumberFormatter* pFormatter = pDoc->GetFormatTable();
-		ULONG nEnglish = pFormatter->GetStandardIndex(LANGUAGE_ENGLISH_US);
+		sal_uInt32 nEnglish = pFormatter->GetStandardIndex(LANGUAGE_ENGLISH_US);
 		double fVal;
 		if ( pFormatter->IsNumberFormat( rStr, nEnglish, fVal ) )
 		{
@@ -1539,7 +1539,7 @@ BOOL ScImportExport::Sylk2Doc( SvStream&
                         aCode.Erase( nPos, 1 );
                     xub_StrLen nCheckPos;
                     short nType;
-                    ULONG nKey;
+                    sal_uInt32 nKey;
                     pDoc->GetFormatTable()->PutandConvertEntry(
                         aCode, nCheckPos, nType, nKey, LANGUAGE_ENGLISH_US,
                         ScGlobal::eLnge );
Index: sc/source/ui/inc/AccessibleDocument.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleDocument.hxx,v
retrieving revision 1.24
retrieving revision 1.24.42.1
diff -u -p -u -p -r1.24 -r1.24.42.1
--- sc/source/ui/inc/AccessibleDocument.hxx	4 Jun 2004 11:28:26 -0000	1.24
+++ sc/source/ui/inc/AccessibleDocument.hxx	9 Sep 2004 11:02:31 -0000	1.24.42.1
@@ -158,13 +158,13 @@ public:
 	///=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL
+    virtual sal_Int32 SAL_CALL
     	getAccessibleChildCount(void)
         throw (::com::sun::star::uno::RuntimeException);
 
     ///	Return the specified child or NULL if index is invalid.
     virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-    	getAccessibleChild(long nIndex)
+    	getAccessibleChild(sal_Int32 nIndex)
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException);
 
Index: sc/source/ui/inc/AccessibleDocumentPagePreview.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleDocumentPagePreview.hxx,v
retrieving revision 1.9
retrieving revision 1.9.354.1
diff -u -p -u -p -r1.9 -r1.9.354.1
--- sc/source/ui/inc/AccessibleDocumentPagePreview.hxx	24 Apr 2003 17:14:38 -0000	1.9
+++ sc/source/ui/inc/AccessibleDocumentPagePreview.hxx	9 Sep 2004 11:02:31 -0000	1.9.354.1
@@ -105,7 +105,7 @@ public:
 	///=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL
+    virtual sal_Int32 SAL_CALL
     	getAccessibleChildCount(void)
         throw (::com::sun::star::uno::RuntimeException);
 
Index: sc/source/ui/inc/csvtablebox.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/csvtablebox.hxx,v
retrieving revision 1.5
retrieving revision 1.4.484.2
diff -u -p -u -p -r1.5 -r1.4.484.2
--- sc/source/ui/inc/csvtablebox.hxx	23 Aug 2004 09:33:53 -0000	1.5
+++ sc/source/ui/inc/csvtablebox.hxx	19 Oct 2004 12:49:53 -0000	1.4.484.2
@@ -143,10 +143,10 @@ private:
 
     /** Calculates and sets valid position offset nearest to nPos. */
     SC_DLLPRIVATE inline void                 ImplSetPosOffset( sal_Int32 nPos )
-                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), 0L ); }
+                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), (sal_Int32)0 ); }
     /** Calculates and sets valid line offset nearest to nLine. */
     SC_DLLPRIVATE inline void                 ImplSetLineOffset( sal_Int32 nLine )
-                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), 0L ); }
+                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), (sal_Int32)0 ); }
     /** Moves controls (not cursors!) so that nPos becomes visible. */
     SC_DLLPRIVATE void                        MakePosVisible( sal_Int32 nPos );
 
Index: sc/source/ui/inc/docsh.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/docsh.hxx,v
retrieving revision 1.34
retrieving revision 1.34.6.1
diff -u -p -u -p -r1.34 -r1.34.6.1
--- sc/source/ui/inc/docsh.hxx	11 Jan 2005 13:21:14 -0000	1.34
+++ sc/source/ui/inc/docsh.hxx	21 Jan 2005 16:44:25 -0000	1.34.6.1
@@ -223,7 +223,7 @@ public:
 	virtual SfxUndoManager*     GetUndoManager();
 
 	virtual void	FillClass( SvGlobalName * pClassName,
-							   ULONG * pFormat,
+							   sal_uInt32 * pFormat,
 							   String * pAppName,
 							   String * pFullTypeName,
 							   String * pShortTypeName,
Index: sc/source/ui/inc/viewdata.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/viewdata.hxx,v
retrieving revision 1.18
retrieving revision 1.14.42.4
diff -u -p -u -p -r1.18 -r1.14.42.4
--- sc/source/ui/inc/viewdata.hxx	21 Feb 2005 13:52:01 -0000	1.18
+++ sc/source/ui/inc/viewdata.hxx	9 Mar 2005 20:38:49 -0000	1.14.42.4
@@ -350,7 +350,7 @@ public:
 	BYTE			GetFillMode()				{ return nFillMode; }
 
 					// TRUE: Zelle ist zusammengefasst
-	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix );
+	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix );
 	BOOL			GetPosFromPixel( long nClickX, long nClickY, ScSplitPos eWhich,
 										SCsCOL& rPosX, SCsROW& rPosY,
 										BOOL bTestMerge = TRUE, BOOL bRepair = FALSE,
Index: sc/source/ui/miscdlgs/filldlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/filldlg.cxx,v
retrieving revision 1.4
retrieving revision 1.4.78.1
diff -u -p -u -p -r1.4 -r1.4.78.1
--- sc/source/ui/miscdlgs/filldlg.cxx	23 Aug 2004 09:36:22 -0000	1.4
+++ sc/source/ui/miscdlgs/filldlg.cxx	21 Jan 2005 16:44:38 -0000	1.4.78.1
@@ -268,7 +268,7 @@ void ScFillSeriesDlg::Init( USHORT nPoss
 BOOL __EXPORT ScFillSeriesDlg::CheckStartVal()
 {
 	BOOL bValOk = FALSE;
-	ULONG  nKey = 0;
+	sal_uInt32 nKey = 0;
 	String aStr( aEdStartVal.GetText() );
 
 	if ( aStr.Len() == 0 || aBtnAutoFill.IsChecked())
@@ -287,7 +287,7 @@ BOOL __EXPORT ScFillSeriesDlg::CheckStar
 
 BOOL __EXPORT ScFillSeriesDlg::CheckIncrementVal()
 {
-	ULONG  nKey = 0;
+	sal_uInt32 nKey = 0;
 	String aStr( aEdIncrement.GetText() );
 
 	return rDoc.GetFormatTable()->IsNumberFormat( aStr, nKey, fIncrement );
@@ -299,7 +299,7 @@ BOOL __EXPORT ScFillSeriesDlg::CheckIncr
 BOOL __EXPORT ScFillSeriesDlg::CheckEndVal()
 {
 	BOOL	bValOk = FALSE;
-	ULONG	nKey = 0;
+	sal_uInt32 nKey = 0;
 	String	aStr( aEdEndVal.GetText() );
 
 	if ( aStr.Len() == 0 )
Index: sc/source/ui/miscdlgs/solvrdlg.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/miscdlgs/solvrdlg.cxx,v
retrieving revision 1.7
retrieving revision 1.7.146.1
diff -u -p -u -p -r1.7 -r1.7.146.1
--- sc/source/ui/miscdlgs/solvrdlg.cxx	4 Feb 2004 14:28:04 -0000	1.7
+++ sc/source/ui/miscdlgs/solvrdlg.cxx	21 Jan 2005 16:44:46 -0000	1.7.146.1
@@ -248,7 +248,7 @@ BOOL ScSolverDlg::IsRefInputMode() const
 
 BOOL __EXPORT ScSolverDlg::CheckTargetValue( String& rStrVal )
 {
-	ULONG  n1 = 0;
+	sal_uInt32 n1 = 0;
 	double n2;
 
 	return pDoc->GetFormatTable()->IsNumberFormat( rStrVal, n1, n2 );
Index: sc/source/ui/unoobj/cellsuno.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/unoobj/cellsuno.cxx,v
retrieving revision 1.89
retrieving revision 1.89.30.1
diff -u -p -u -p -r1.89 -r1.89.30.1
--- sc/source/ui/unoobj/cellsuno.cxx	23 Dec 2004 10:46:30 -0000	1.89
+++ sc/source/ui/unoobj/cellsuno.cxx	21 Jan 2005 16:45:11 -0000	1.89.30.1
@@ -1348,7 +1348,7 @@ String lcl_GetInputString( ScDocShell* p
                 // Since the English formatter was constructed with
                 // LANGUAGE_ENGLISH_US the "General" format has index key 0,
                 // we don't have to query.
-				ULONG nNumFmt = bEnglish ?
+				sal_uInt32 nNumFmt = bEnglish ?
 //						pFormatter->GetStandardIndex(LANGUAGE_ENGLISH_US) :
                         0 :
 						pDoc->GetNumberFormat( rPosition );
Index: sc/source/ui/view/cellsh1.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/cellsh1.cxx,v
retrieving revision 1.37
retrieving revision 1.36.48.2
diff -u -p -u -p -r1.37 -r1.36.48.2
--- sc/source/ui/view/cellsh1.cxx	21 Feb 2005 13:53:16 -0000	1.37
+++ sc/source/ui/view/cellsh1.cxx	9 Mar 2005 20:43:15 -0000	1.36.48.2
@@ -619,7 +619,7 @@ void ScCellShell::ExecuteEdit( SfxReques
 					const SfxPoolItem* pItem;
 					String	aFillDir, aFillCmd, aFillDateCmd;
 					String	aFillStep, aFillStart, aFillMax;
-					ULONG	nKey;
+					sal_uInt32 nKey;
 					double	fTmpVal;
 
 					bDoIt=FALSE;
@@ -683,7 +683,7 @@ void ScCellShell::ExecuteEdit( SfxReques
 				else // (pReqArgs == NULL) => Dialog hochziehen
 				{
 					//
-					ULONG nPrivFormat;
+					sal_uInt32 nPrivFormat;
 					CellType eCellType;
 					pDoc->GetNumberFormat( nStartCol, nStartRow, nStartTab, nPrivFormat );
 					pDoc->GetCellType( nStartCol, nStartRow, nStartTab,eCellType );
Index: sc/source/ui/view/gridwin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin.cxx,v
retrieving revision 1.67
retrieving revision 1.55.36.4
diff -u -p -u -p -r1.67 -r1.55.36.4
--- sc/source/ui/view/gridwin.cxx	15 Nov 2004 16:38:47 -0000	1.67
+++ sc/source/ui/view/gridwin.cxx	21 Jan 2005 16:46:06 -0000	1.55.36.4
@@ -604,8 +604,8 @@ void ScGridWindow::DoPageFieldMenue( SCC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -759,8 +759,8 @@ void ScGridWindow::DoScenarioMenue( cons
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -902,8 +902,8 @@ void ScGridWindow::DoAutoFilterMenue( SC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -1443,8 +1443,8 @@ BOOL ScGridWindow::TestMouse( const Mous
 				SCROW nY = aMarkRange.aEnd.Row();
 
 				Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 				aFillPos.X() += nSizeXPix * nLayoutSign;
 				aFillPos.Y() += nSizeYPix;
@@ -1726,8 +1726,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 		if (pAttr->HasAutoFilter())
 		{
 			Point	aScrPos  = pViewData->GetScrPos(nPosX,nPosY,eWhich);
-			long	nSizeX;
-			long	nSizeY;
+			sal_Int32	nSizeX;
+			sal_Int32	nSizeY;
 			Point	aDiffPix = aPos;
 
 			aDiffPix -= aScrPos;
@@ -1739,8 +1739,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 
 			//	Breite des Buttons ist nicht von der Zellhoehe abhaengig
 			Size aButSize = aComboButton.GetSizePixel();
-			long nButWidth  = Min( aButSize.Width(),  nSizeX );
-			long nButHeight = Min( aButSize.Height(), nSizeY );
+			long nButWidth  = Min( (sal_Int32)aButSize.Width(),  nSizeX );
+			long nButHeight = Min( (sal_Int32)aButSize.Height(), nSizeY );
 
 			if ( aDiffPix.X() >= nSizeX - nButWidth &&
 				 aDiffPix.Y() >= nSizeY - nButHeight )
@@ -2817,8 +2817,8 @@ void __EXPORT ScGridWindow::Command( con
 			SCCOL nCurX = pViewData->GetCurX();
 			SCROW nCurY = pViewData->GetCurY();
 			aMenuPos = pViewData->GetScrPos( nCurX, nCurY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nCurX, nCurY, nSizeXPix, nSizeYPix );
 			aMenuPos.X() += nSizeXPix;
 			aMenuPos.Y() += nSizeYPix;
@@ -4079,8 +4079,8 @@ void ScGridWindow::HideCursor()
 			SCROW nY = pViewData->GetCurY();
 
 			Point aScrPos = pViewData->GetScrPos( nX, nY, eWhich );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 			aScrPos.X() -= 2;
 			aScrPos.Y() -= 2;
@@ -4116,8 +4116,8 @@ void ScGridWindow::HideCursor()
 					SCCOL nAutoX = aAutoMarkPos.Col();
 					SCROW nAutoY = aAutoMarkPos.Row();
 					Point aFillPos = pViewData->GetScrPos( nAutoX, nAutoY, eWhich, TRUE );
-					long nSizeXPix;
-					long nSizeYPix;
+					sal_Int32 nSizeXPix;
+					sal_Int32 nSizeYPix;
 					pViewData->GetMergeSizePixel( nAutoX, nAutoY, nSizeXPix, nSizeYPix );
 					aFillPos.X() += nSizeXPix;
 					aFillPos.Y() += nSizeYPix;
@@ -4225,8 +4225,8 @@ BOOL ScGridWindow::HitRangeFinder( const
 //			Point aNext = pViewData->GetScrPos( nPosX+1, nPosY+1, eWhich );
 
 			Point aNext = pViewData->GetScrPos( nPosX, nPosY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nPosX, nPosY, nSizeXPix, nSizeYPix );
 			aNext.X() += nSizeXPix * nLayoutSign;
 			aNext.Y() += nSizeYPix;
@@ -4629,8 +4629,8 @@ BOOL ScGridWindow::GetEditUrlOrError( BO
     Size aPaperSize = Size( 1000000, 1000000 );
     if(pCell->GetCellType() == CELLTYPE_FORMULA)
     {
-        long nSizeX  = 0;
-        long nSizeY  = 0;
+        sal_Int32 nSizeX  = 0;
+        sal_Int32 nSizeY  = 0;
         pViewData->GetMergeSizePixel( nPosX, nPosY, nSizeX, nSizeY );
         aPaperSize = Size(nSizeX, nSizeY );
         aPaperSize = PixelToLogic(aPaperSize);
Index: sc/source/ui/view/gridwin4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin4.cxx,v
retrieving revision 1.26
retrieving revision 1.23.40.3
diff -u -p -u -p -r1.26 -r1.23.40.3
--- sc/source/ui/view/gridwin4.cxx	4 Oct 2004 20:23:40 -0000	1.26
+++ sc/source/ui/view/gridwin4.cxx	21 Jan 2005 16:46:26 -0000	1.23.40.3
@@ -1253,8 +1253,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 						}
 
                     bool bArrowState = bSimpleQuery && bColumnFound;
-					long	nSizeX;
-					long	nSizeY;
+					sal_Int32	nSizeX;
+					sal_Int32	nSizeY;
 
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					aComboButton.SetOptSizePixel();
@@ -1277,8 +1277,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 				if ( pInfo->bPushButton && !pInfo->bHOverlapped && !pInfo->bVOverlapped )
 				{
 					Point aScrPos = pViewData->GetScrPos( nCol, nRow, eWhich );
-					long nSizeX;
-					long nSizeY;
+					sal_Int32 nSizeX;
+					sal_Int32 nSizeY;
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					long nPosX = aScrPos.X();
 					long nPosY = aScrPos.Y();
@@ -1329,8 +1329,8 @@ Rectangle ScGridWindow::GetListValButton
     SCCOL nCol = rButtonPos.Col();
     SCROW nRow = rButtonPos.Row();
 
-    long nCellSizeX;    // width of this cell, including merged
-    long nDummy;
+    sal_Int32 nCellSizeX;    // width of this cell, including merged
+    sal_Int32 nDummy;
     pViewData->GetMergeSizePixel( nCol, nRow, nCellSizeX, nDummy );
 
     // for height, only the cell's row is used, excluding merged cells
@@ -1749,8 +1749,8 @@ void ScGridWindow::DrawCursor()
 		}
 		if ( bMaybeVisible )
 		{
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 
 			if ( bLayoutRTL )
@@ -1797,8 +1797,8 @@ void ScGridWindow::DrawAutoFillMark()
 		BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
 		Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-		long nSizeXPix;
-		long nSizeYPix;
+		sal_Int32 nSizeXPix;
+		sal_Int32 nSizeYPix;
 		pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 		if ( bLayoutRTL )
 			aFillPos.X() -= nSizeXPix + 3;
Index: sc/source/ui/view/output2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/output2.cxx,v
retrieving revision 1.44
retrieving revision 1.39.40.3
diff -u -p -u -p -r1.44 -r1.39.40.3
--- sc/source/ui/view/output2.cxx	28 Oct 2004 09:57:25 -0000	1.44
+++ sc/source/ui/view/output2.cxx	18 Jan 2005 04:30:18 -0000	1.39.40.3
@@ -1712,7 +1712,7 @@ void ScOutputData::DrawStrings( BOOL bPi
 						String aString = aVars.GetString();
 						if (bMetaFile || pFmtDevice != pDev || aZoomX != aZoomY)
 						{
-							long* pDX = new long[aString.Len()];
+							sal_Int32* pDX = new sal_Int32[aString.Len()];
 							pFmtDevice->GetTextArray( aString, pDX );
 
 							if ( !pRefDevice->GetConnectMetaFile() ||
Index: sc/source/ui/view/tabview3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview3.cxx,v
retrieving revision 1.44
retrieving revision 1.37.40.3
diff -u -p -u -p -r1.44 -r1.37.40.3
--- sc/source/ui/view/tabview3.cxx	12 Oct 2004 10:28:29 -0000	1.44
+++ sc/source/ui/view/tabview3.cxx	18 Jan 2005 04:29:52 -0000	1.37.40.3
@@ -590,8 +590,8 @@ void ScTabView::TestHintWindow()
 				 aPos.X() < aWinSize.Width() && aPos.Y() < aWinSize.Height() )
 			{
 				aPos += pWin->GetPosPixel();								// Position auf Frame
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				aViewData.GetMergeSizePixel( nCol, nRow, nSizeXPix, nSizeYPix );
 
 				// HintWindow anlegen, bestimmt seine Groesse selbst
@@ -737,8 +737,8 @@ void ScTabView::AlignToCursor( SCsCOL nC
 		SCsCOL nSizeX = (SCsCOL) aViewData.VisibleCellsX(eAlignX);
 		SCsROW nSizeY = (SCsROW) aViewData.VisibleCellsY(eAlignY);
 
-		long nCellSizeX;
-		long nCellSizeY;
+		sal_Int32 nCellSizeX;
+		sal_Int32 nCellSizeY;
 		if ( nCurX >= 0 && nCurY >= 0 )
 			aViewData.GetMergeSizePixel( (SCCOL)nCurX, (SCROW)nCurY, nCellSizeX, nCellSizeY );
 		else
@@ -781,7 +781,7 @@ void ScTabView::AlignToCursor( SCsCOL nC
 						{
 							//	Cursor ist auf dem Bildschirm
 							Point aStart = aViewData.GetScrPos( nCurX, nCurY, eAlign );
-							long nCSX, nCSY;
+							sal_Int32 nCSX, nCSY;
 							aViewData.GetMergeSizePixel( nCurX, nCurY, nCSX, nCSY );
 							Rectangle aCursor( aStart, Size( nCSX, nCSY ) );
 							if ( aCursor.IsOver( aDlgPixel ) )
Index: sc/source/ui/view/tabvwsh5.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsh5.cxx,v
retrieving revision 1.7
retrieving revision 1.7.42.1
diff -u -p -u -p -r1.7 -r1.7.42.1
--- sc/source/ui/view/tabvwsh5.cxx	4 Jun 2004 12:07:53 -0000	1.7
+++ sc/source/ui/view/tabvwsh5.cxx	21 Jan 2005 16:46:41 -0000	1.7.42.1
@@ -443,11 +443,11 @@ void ScTabViewShell::UpdateNumberFormatt
 						ScDocument* 			 pDoc,
 						const SvxNumberInfoItem& rInfoItem )
 {
-	const ULONG nDelCount = rInfoItem.GetDelCount();
+	const sal_uInt32 nDelCount = rInfoItem.GetDelCount();
 
 	if ( nDelCount > 0 )
 	{
-		const ULONG* pDelArr = rInfoItem.GetDelArray();
+		const sal_uInt32* pDelArr = rInfoItem.GetDelArray();
 
 		for ( USHORT i=0; i<nDelCount; i++ )
 			rInfoItem.GetNumberFormatter()->DeleteEntry( pDelArr[i] );
Index: sc/source/ui/view/tabvwsha.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabvwsha.cxx,v
retrieving revision 1.15
retrieving revision 1.14.48.2
diff -u -p -u -p -r1.15 -r1.14.48.2
--- sc/source/ui/view/tabvwsha.cxx	28 Jan 2005 17:23:33 -0000	1.15
+++ sc/source/ui/view/tabvwsha.cxx	9 Mar 2005 20:43:58 -0000	1.14.48.2
@@ -131,7 +131,7 @@ BOOL ScTabViewShell::GetFunction( String
 		aStr += '=';
 
 		//	Anzahl im Standardformat, die anderen nach Cursorposition
-		ULONG nNumFmt = 0;
+		sal_uInt32 nNumFmt = 0;
 		SvNumberFormatter* pFormatter = pDoc->GetFormatTable();
 		if ( eFunc != SUBTOTAL_FUNC_CNT && eFunc != SUBTOTAL_FUNC_CNT2 )
 		{
@@ -560,7 +560,7 @@ void ScTabViewShell::UpdateInputHandler(
 					//!	Auch bei Zahlformat "Text"? -> dann beim Editieren wegnehmen
 
 					SvNumberFormatter* pFormatter = pDoc->GetFormatTable();
-					ULONG nNumFmt;
+					sal_uInt32 nNumFmt;
 					pDoc->GetNumberFormat( nPosX, nPosY, nTab, nNumFmt );
 					double fDummy;
 					if ( pFormatter->IsNumberFormat(aString, nNumFmt, fDummy) )
Index: sc/source/ui/view/viewdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewdata.cxx,v
retrieving revision 1.50
retrieving revision 1.45.42.4
diff -u -p -u -p -r1.50 -r1.45.42.4
--- sc/source/ui/view/viewdata.cxx	21 Feb 2005 13:55:14 -0000	1.50
+++ sc/source/ui/view/viewdata.cxx	9 Mar 2005 20:42:57 -0000	1.45.42.4
@@ -1637,7 +1637,7 @@ SCROW ScViewData::LastCellsY( ScVSplitPo
 	return CellsAtY( MAXROW+1, -1, eWhichY, SC_SIZE_NONE );
 }
 
-BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix )
+BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix )
 {
 	const ScMergeAttr* pMerge = (const ScMergeAttr*) pDoc->GetAttr( nX,nY,nTabNo, ATTR_MERGE );
 	if ( pMerge->GetColMerge() > 1 || pMerge->GetRowMerge() > 1 )
@@ -1789,8 +1789,8 @@ void ScViewData::GetMouseQuadrant( const
 	long nLayoutSign = bLayoutRTL ? -1 : 1;
 
 	Point aCellStart = GetScrPos( nPosX, nPosY, eWhich, TRUE );
-	long nSizeX;
-	long nSizeY;
+	sal_Int32 nSizeX;
+	sal_Int32 nSizeY;
 	GetMergeSizePixel( nPosX, nPosY, nSizeX, nSizeY );
 	rLeft = ( rClickPos.X() - aCellStart.X() ) * nLayoutSign <= nSizeX / 2;
 	rTop  = rClickPos.Y() - aCellStart.Y() <= nSizeY / 2;
Index: sc/source/ui/view/viewfunc.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewfunc.cxx,v
retrieving revision 1.27
retrieving revision 1.27.56.1
diff -u -p -u -p -r1.27 -r1.27.56.1
--- sc/source/ui/view/viewfunc.cxx	9 Sep 2004 09:31:12 -0000	1.27
+++ sc/source/ui/view/viewfunc.cxx	21 Jan 2005 16:46:48 -0000	1.27.56.1
@@ -999,9 +999,9 @@ void ScViewFunc::ApplyAttributes( const 
 
 	if ( pDialogSet->GetItemState( ATTR_VALUE_FORMAT ) == SFX_ITEM_SET )
 	{	// #82521# don't reset to default SYSTEM GENERAL if not intended
-		ULONG nOldFormat =
+		sal_uInt32 nOldFormat =
 			((const SfxUInt32Item&)pOldSet->Get( ATTR_VALUE_FORMAT )).GetValue();
-		ULONG nNewFormat =
+		sal_uInt32 nNewFormat =
 			((const SfxUInt32Item&)pDialogSet->Get( ATTR_VALUE_FORMAT )).GetValue();
 		if ( nNewFormat != nOldFormat )
 		{
@@ -1019,7 +1019,7 @@ void ScViewFunc::ApplyAttributes( const 
 					SvxLanguageItem( eNewLang, ATTR_LANGUAGE_FORMAT ) );
 
 				//	#40606# nur die Sprache geaendert -> Zahlformat-Attribut nicht anfassen
-				ULONG nNewMod = nNewFormat % SV_COUNTRY_LANGUAGE_OFFSET;
+				sal_uInt32 nNewMod = nNewFormat % SV_COUNTRY_LANGUAGE_OFFSET;
 				if ( nNewMod == ( nOldFormat % SV_COUNTRY_LANGUAGE_OFFSET ) &&
 				 	nNewMod <= SV_MAX_ANZ_STANDARD_FORMATE )
 					aNewAttrs.GetItemSet().ClearItem( ATTR_VALUE_FORMAT );
@@ -2393,7 +2393,7 @@ void ScViewFunc::SetNumberFormat( short 
 		return;
 	}
 
-	ULONG				nNumberFormat = 0;
+	sal_uInt32			nNumberFormat = 0;
 	ScViewData*			pViewData = GetViewData();
 	ScDocument*			pDoc = pViewData->GetDocument();
 	SvNumberFormatter*	pNumberFormatter = pDoc->GetFormatTable();
@@ -2402,7 +2402,7 @@ void ScViewFunc::SetNumberFormat( short 
 
 	//	#67936# always take language from cursor position, even if there is a selection
 
-	ULONG nCurrentNumberFormat;
+	sal_uInt32 nCurrentNumberFormat;
 	pDoc->GetNumberFormat( pViewData->GetCurX(),
 						   pViewData->GetCurY(),
 						   pViewData->GetTabNo(),
@@ -2435,7 +2435,7 @@ void ScViewFunc::SetNumFmtByStr( const S
 
 	//	Sprache immer von Cursorposition
 
-	ULONG nCurrentNumberFormat;
+	sal_uInt32 nCurrentNumberFormat;
 	pDoc->GetNumberFormat( pViewData->GetCurX(), pViewData->GetCurY(),
 						   pViewData->GetTabNo(), nCurrentNumberFormat );
 	const SvNumberformat* pEntry = pFormatter->GetEntry( nCurrentNumberFormat );
@@ -2444,7 +2444,7 @@ void ScViewFunc::SetNumFmtByStr( const S
 	//	Index fuer String bestimmen
 
 	BOOL bOk = TRUE;
-	ULONG nNumberFormat = pFormatter->GetEntryKey( rCode, eLanguage );
+	sal_uInt32 nNumberFormat = pFormatter->GetEntryKey( rCode, eLanguage );
 	if ( nNumberFormat == NUMBERFORMAT_ENTRY_NOT_FOUND )
 	{
 		//	neu eintragen
@@ -2484,7 +2484,7 @@ void ScViewFunc::ChangeNumFmtDecimals( B
 	SCROW nRow = GetViewData()->GetCurY();
 	SCTAB nTab = GetViewData()->GetTabNo();
 
-	ULONG nOldFormat;
+	sal_uInt32 nOldFormat;
 	pDoc->GetNumberFormat( nCol, nRow, nTab, nOldFormat );
 	const SvNumberformat* pOldEntry = pFormatter->GetEntry( nOldFormat );
 	if (!pOldEntry)
@@ -2495,7 +2495,7 @@ void ScViewFunc::ChangeNumFmtDecimals( B
 
 	//	was haben wir denn da?
 
-	ULONG nNewFormat = nOldFormat;
+	sal_uInt32 nNewFormat = nOldFormat;
 	BOOL bError = FALSE;
 
 	LanguageType eLanguage = pOldEntry->GetLanguage();
Index: goodies/source/filter.vcl/eos2met/eos2met.cxx
===================================================================
RCS file: /cvs/graphics/goodies/source/filter.vcl/eos2met/eos2met.cxx,v
retrieving revision 1.11
retrieving revision 1.9.48.2
diff -u -p -u -p -r1.11 -r1.9.48.2
--- goodies/source/filter.vcl/eos2met/eos2met.cxx	9 Sep 2004 11:27:11 -0000	1.11
+++ goodies/source/filter.vcl/eos2met/eos2met.cxx	13 Oct 2004 22:13:47 -0000	1.9.48.2
@@ -1969,7 +1969,7 @@ void METWriter::WriteOrders( const GDIMe
 				const MetaStretchTextAction*	pA = (const MetaStretchTextAction*) pMA;
 				VirtualDevice					aVDev;
 				USHORT							i;
-				long*							pDXAry;
+				sal_Int32*					pDXAry;
 				sal_Int32						nNormSize;
 				String							aStr;
 				Polygon							aPolyDummy(1);
@@ -1994,7 +1994,7 @@ void METWriter::WriteOrders( const GDIMe
 				METSetChrAngle( nOrientation = aGDIFont.GetOrientation() );
 				METSetChrSet(FindChrSet(aGDIFont));
 				aStr=String(pA->GetText(),pA->GetIndex(),pA->GetLen());
-				pDXAry=new long[aStr.Len()];
+				pDXAry=new sal_Int32[aStr.Len()];
 				nNormSize = aVDev.GetTextArray( aStr, pDXAry );
 
 				for ( i = 0; i < aStr.Len(); i++ )
Index: goodies/source/filter.vcl/epict/epict.cxx
===================================================================
RCS file: /cvs/graphics/goodies/source/filter.vcl/epict/epict.cxx,v
retrieving revision 1.12
retrieving revision 1.10.186.2
diff -u -p -u -p -r1.12 -r1.10.186.2
--- goodies/source/filter.vcl/epict/epict.cxx	9 Sep 2004 11:28:34 -0000	1.12
+++ goodies/source/filter.vcl/epict/epict.cxx	13 Oct 2004 22:11:53 -0000	1.10.186.2
@@ -214,7 +214,7 @@ private:
 	void SetAttrForFrame();
 	void SetAttrForText();
 
-	void WriteTextArray(Point & rPoint, const String& rString, const long * pDXAry);
+	void WriteTextArray(Point & rPoint, const String& rString, const sal_Int32 * pDXAry);
 
 	void WriteOpcodes(const GDIMetaFile & rMTF);
 
@@ -1403,7 +1403,7 @@ void PictWriter::SetAttrForText()
 }
 
 
-void PictWriter::WriteTextArray(Point & rPoint, const String& rString, const long * pDXAry)
+void PictWriter::WriteTextArray(Point & rPoint, const String& rString, const sal_Int32 * pDXAry)
 {
 	USHORT i,nLen;
 	sal_Unicode c;
@@ -1761,8 +1761,8 @@ void PictWriter::WriteOpcodes( const GDI
 				Point                           aPt( pA->GetPoint() );
 				String                          aStr( pA->GetText(),pA->GetIndex(),pA->GetLen() );
 				VirtualDevice                   aVirDev;
-				long*                           pDXAry = new long[ aStr.Len() ];
-				sal_Int32						nNormSize( aVirDev.GetTextArray( aStr,pDXAry ) );
+				sal_Int32*                      pDXAry = new sal_Int32[ aStr.Len() ];
+				sal_Int32                       nNormSize( aVirDev.GetTextArray( aStr,pDXAry ) );
 				USHORT                          i;
 
 				if (aSrcFont.GetAlign()!=ALIGN_BASELINE)
Index: rsc/source/parser/rscdb.cxx
===================================================================
RCS file: /cvs/gsl/rsc/source/parser/rscdb.cxx,v
retrieving revision 1.11
retrieving revision 1.8.12.3
diff -u -p -u -p -r1.11 -r1.8.12.3
--- rsc/source/parser/rscdb.cxx	3 Jan 2005 17:25:03 -0000	1.11
+++ rsc/source/parser/rscdb.cxx	18 Jan 2005 19:53:12 -0000	1.8.12.3
@@ -59,7 +59,6 @@
  *
  ************************************************************************/
 /****************** I N C L U D E S **************************************/
-
 #pragma hdrstop
 
 // C and C++ Includes.
Index: rsc/source/res/rscrange.cxx
===================================================================
RCS file: /cvs/gsl/rsc/source/res/rscrange.cxx,v
retrieving revision 1.4
retrieving revision 1.4.2.1
diff -u -p -u -p -r1.4 -r1.4.2.1
--- rsc/source/res/rscrange.cxx	3 Jan 2005 17:29:36 -0000	1.4
+++ rsc/source/res/rscrange.cxx	21 Jan 2005 16:29:49 -0000	1.4.2.1
@@ -238,7 +238,7 @@ RSCINST RscRange::Create( RSCINST * pIns
 void RscRange::WriteSrc( const RSCINST & rInst, FILE * fOutput,
 						 RscTypCont *, sal_uInt32, const char * )
 {
-	fprintf( fOutput, "%ld", ((RscRangeInst *)rInst.pData)->nValue + nMin );
+	fprintf( fOutput, "%ld", long( ((RscRangeInst *)rInst.pData)->nValue + nMin ) );
 }
 
 /*************************************************************************
cvs diff: cannot open CVS/Entries for reading: No such file or directory
cvs [diff aborted]: no repository
Index: sfx2/inc/dispatch.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/dispatch.hxx,v
retrieving revision 1.10
retrieving revision 1.9.12.2
diff -u -p -u -p -r1.10 -r1.9.12.2
--- sfx2/inc/dispatch.hxx	18 Jan 2005 15:51:34 -0000	1.10
+++ sfx2/inc/dispatch.hxx	9 Mar 2005 22:18:01 -0000	1.9.12.2
@@ -168,7 +168,7 @@ friend class SfxViewFrame;
 	DECL_DLLPRIVATE_LINK( PostMsgHandler, SfxRequest * );
 
 	SAL_DLLPRIVATE int Call_Impl( SfxShell& rShell, const SfxSlot &rSlot, SfxRequest &rReq, BOOL bRecord );
-	SAL_DLLPRIVATE ULONG _Update_Impl( BOOL,BOOL,BOOL,SfxMenuBarManager*,SfxWorkWindow*);
+	SAL_DLLPRIVATE sal_uInt32 _Update_Impl( BOOL,BOOL,BOOL,SfxMenuBarManager*,SfxWorkWindow*);
 	SAL_DLLPRIVATE void CollectTools_Impl(SfxWorkWindow*);
 
 protected:
@@ -271,8 +271,8 @@ public:
 
 	BOOL                IsAllowed( USHORT nSlot ) const;
     ::com::sun::star::frame::XDispatch*          GetDispatchInterface( const String& );
-	void				SetDisableFlags( ULONG nFlags );
-	ULONG				GetDisableFlags() const;
+	void				SetDisableFlags( sal_uInt32 nFlags );
+	sal_uInt32				GetDisableFlags() const;
 
 #if _SOLAR__PRIVATE
 	SAL_DLLPRIVATE BOOL HasSlot_Impl( USHORT );
Index: sfx2/inc/docfilt.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/docfilt.hxx,v
retrieving revision 1.9
retrieving revision 1.9.12.1
diff -u -p -u -p -r1.9 -r1.9.12.1
--- sfx2/inc/docfilt.hxx	11 Jan 2005 14:39:58 -0000	1.9
+++ sfx2/inc/docfilt.hxx	21 Jan 2005 17:09:26 -0000	1.9.12.1
@@ -158,7 +158,7 @@ public:
 					SfxFilter( const String &rName,
 							   const String &rWildCard,
 							   SfxFilterFlags nFormatType,
-							   ULONG lFormat,		// Clipboardformat
+							   sal_uInt32 lFormat,		// Clipboardformat
 							   const String &rMacType,	// Dateityp (MAC)
 							   const String &rTypeName, // Dateityp als String (OS/2)
 							   USHORT nDocIcon,         // Dokumenticon OS/2
Index: sfx2/inc/docinf.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/docinf.hxx,v
retrieving revision 1.6
retrieving revision 1.3.546.3
diff -u -p -u -p -r1.6 -r1.3.546.3
--- sfx2/inc/docinf.hxx	11 Jan 2005 14:40:13 -0000	1.6
+++ sfx2/inc/docinf.hxx	18 Jan 2005 20:37:15 -0000	1.3.546.3
@@ -170,14 +170,14 @@ private:
 	String   aDefaultTarget;
 	String   aReloadURL;
 	BOOL     bReloadEnabled;
-	ULONG    nReloadSecs;
+	sal_uInt32    nReloadSecs;
 
 	DateTime aTemplateDate;	// Stamp der Dokumentvorlage
 
 	USHORT	nUserDataSize;
 	USHORT	nDocNo;			// schon mal rein: Dokumentnummer, was immer das sein mag
 	void*	pUserData;		// Benutzer Daten, z.B. Doc-Statistik
-	long	lTime;
+	sal_Int32	lTime;
 
 	SfxDocumentInfo_Impl* pImp;
 
@@ -209,8 +209,8 @@ public:
 	void EnableReload( BOOL bEnable );
 	const String& GetDefaultTarget() const;
 	void SetDefaultTarget( const String& rString );
-	ULONG GetReloadDelay() const;
-	void SetReloadDelay( ULONG nDelay );
+	sal_uInt32 GetReloadDelay() const;
+	void SetReloadDelay( sal_uInt32 nDelay );
 
 	BOOL IsReadOnly() const             { return bReadOnly; }
 	BOOL IsPasswd() const               { return bPasswd; }
@@ -261,7 +261,7 @@ public:
 	BOOL   IsSaveVersionOnClose() const { return bSaveVersionOnClose; }
 
 	void   SetTime(long l) { lTime = l; }
-    long   GetTime() const { return IsUseUserData() ? lTime : 0L; }
+    sal_Int32   GetTime() const { return IsUseUserData() ? lTime : 0L; }
 
 	void*  GetUserData() const { return pUserData; }
 	USHORT GetUserDataSize() const { return nUserDataSize; }
Index: sfx2/inc/fcontnr.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/fcontnr.hxx,v
retrieving revision 1.9
retrieving revision 1.9.12.1
diff -u -p -u -p -r1.9 -r1.9.12.1
--- sfx2/inc/fcontnr.hxx	11 Jan 2005 14:41:33 -0000	1.9
+++ sfx2/inc/fcontnr.hxx	21 Jan 2005 17:09:35 -0000	1.9.12.1
@@ -158,7 +158,7 @@ public:
 
     const SfxFilter* 	GetAnyFilter( SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter* 	GetFilter4Mime( const String& rMime, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
-	const SfxFilter* 	GetFilter4ClipBoardId( ULONG nId, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
+	const SfxFilter* 	GetFilter4ClipBoardId( sal_uInt32 nId, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter* 	GetFilter4EA( const String& rEA, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter* 	GetFilter4Extension( const String& rExt, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter* 	GetFilter4FilterName( const String& rName, SfxFilterFlags nMust = 0, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
@@ -190,12 +190,12 @@ public:
 	DECL_DLLPRIVATE_STATIC_LINK( SfxFilterMatcher, MaybeFileHdl_Impl, String* );
 #endif
 
-	ULONG               GuessFilterIgnoringContent( SfxMedium& rMedium, const SfxFilter **, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
-	ULONG               GuessFilter( SfxMedium& rMedium, const SfxFilter **, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
-	ULONG               DetectFilter( SfxMedium& rMedium, const SfxFilter **, BOOL bPlugIn, BOOL bAPI = FALSE ) const;
+	sal_uInt32               GuessFilterIgnoringContent( SfxMedium& rMedium, const SfxFilter **, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
+	sal_uInt32               GuessFilter( SfxMedium& rMedium, const SfxFilter **, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
+	sal_uInt32               DetectFilter( SfxMedium& rMedium, const SfxFilter **, BOOL bPlugIn, BOOL bAPI = FALSE ) const;
 
 	const SfxFilter*	GetFilter4Mime( const String& rMime, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED) const;
-	const SfxFilter*    GetFilter4ClipBoardId( ULONG nId, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
+	const SfxFilter*    GetFilter4ClipBoardId( sal_uInt32 nId, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter*    GetFilter4EA( const String& rEA, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter*    GetFilter4Extension( const String& rExt, SfxFilterFlags nMust = SFX_FILTER_IMPORT, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
 	const SfxFilter*    GetFilter4FilterName( const String& rName, SfxFilterFlags nMust = 0, SfxFilterFlags nDont = SFX_FILTER_NOTINSTALLED ) const;
Index: sfx2/inc/sfxhtml.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/sfxhtml.hxx,v
retrieving revision 1.4
retrieving revision 1.4.12.1
diff -u -p -u -p -r1.4 -r1.4.12.1
--- sfx2/inc/sfxhtml.hxx	11 Jan 2005 14:51:01 -0000	1.4
+++ sfx2/inc/sfxhtml.hxx	21 Jan 2005 17:09:45 -0000	1.4.12.1
@@ -128,7 +128,7 @@ public:
 								  rtl_TextEncoding& rEnc );
 
 	// <TD SDVAL="..." SDNUM="...">
-	static double GetTableDataOptionsValNum( ULONG& nNumForm,
+	static double GetTableDataOptionsValNum( sal_uInt32& nNumForm,
 			LanguageType& eNumLang, const String& aValStr,
 			const String& aNumStr, SvNumberFormatter& rFormatter );
 
Index: sfx2/inc/viewfrm.hxx
===================================================================
RCS file: /cvs/framework/sfx2/inc/viewfrm.hxx,v
retrieving revision 1.18
retrieving revision 1.17.12.2
diff -u -p -u -p -r1.18 -r1.17.12.2
--- sfx2/inc/viewfrm.hxx	1 Mar 2005 19:57:20 -0000	1.18
+++ sfx2/inc/viewfrm.hxx	9 Mar 2005 22:18:08 -0000	1.17.12.2
@@ -201,8 +201,8 @@ public:
 							TYPEINFO();
 							SFX_DECL_INTERFACE(SFX_INTERFACE_SFXVIEWFRM);
 
-							SfxViewFrame( SfxBindings&, SfxFrame*, SfxObjectShell *pDoc=0, ULONG nType = 0 );
-							SfxViewFrame(SfxObjectShell&, SfxBindings&, SfxFrame*p=0, ULONG nType = 0);
+							SfxViewFrame( SfxBindings&, SfxFrame*, SfxObjectShell *pDoc=0, sal_uInt32 nType = 0 );
+							SfxViewFrame(SfxObjectShell&, SfxBindings&, SfxFrame*p=0, sal_uInt32 nType = 0);
 							SfxViewFrame(
 								const SfxViewFrame &, SfxBindings &, SfxFrame *pFrame);
 
Index: sfx2/source/appl/app.src
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/app.src,v
retrieving revision 1.100
retrieving revision 1.94.42.3
diff -u -p -u -p -r1.100 -r1.94.42.3
--- sfx2/source/appl/app.src	9 Dec 2004 16:45:45 -0000	1.100
+++ sfx2/source/appl/app.src	18 Jan 2005 21:46:31 -0000	1.94.42.3
@@ -646,10 +646,6 @@ ToolBox RID_FULLSCREENTOOLBOX
 	Customize = TRUE ;
 	FloatingMode = TRUE ;
 	Hide = TRUE ;
-	_FloatingPosMapMode = MAP_APPFONT ;
-	_FloatingPosX = -50 ;
-	_FloatingPosY = -70 ;
-	FloatingLines = 1 ;
 	HideWhenDeactivate = TRUE ;
 	Align = BOXALIGN_TOP ;
 	ItemList =
Index: sfx2/source/appl/sfxpicklist.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/appl/sfxpicklist.cxx,v
retrieving revision 1.23
retrieving revision 1.22.76.2
diff -u -p -u -p -r1.23 -r1.22.76.2
--- sfx2/source/appl/sfxpicklist.cxx	2 Feb 2005 14:01:50 -0000	1.23
+++ sfx2/source/appl/sfxpicklist.cxx	9 Mar 2005 22:33:20 -0000	1.22.76.2
@@ -244,7 +244,7 @@ SfxPickList::PickListEntry*	SfxPickList:
 		return 0;
 }
 
-SfxPickList*	SfxPickList::GetOrCreate( const ULONG nMenuSize )
+SfxPickList*	SfxPickList::GetOrCreate( const sal_uInt32 nMenuSize )
 {
 	if ( !pUniqueInstance )
 	{
Index: sfx2/source/bastyp/fltfnc.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/bastyp/fltfnc.cxx,v
retrieving revision 1.65
retrieving revision 1.62.66.2
diff -u -p -u -p -r1.65 -r1.62.66.2
--- sfx2/source/bastyp/fltfnc.cxx	4 Mar 2005 00:18:37 -0000	1.65
+++ sfx2/source/bastyp/fltfnc.cxx	9 Mar 2005 22:40:35 -0000	1.62.66.2
@@ -311,7 +311,7 @@ const SfxFilter* SfxFilterContainer::aMe
 }
 
 IMPL_FORWARD_LOOP( GetFilter4Mime, const String&, rMime );
-IMPL_FORWARD_LOOP( GetFilter4ClipBoardId, ULONG, nId );
+IMPL_FORWARD_LOOP( GetFilter4ClipBoardId, sal_uInt32, nId );
 IMPL_FORWARD_LOOP( GetFilter4EA, const String&, rEA );
 IMPL_FORWARD_LOOP( GetFilter4Extension, const String&, rExt );
 IMPL_FORWARD_LOOP( GetFilter4FilterName, const String&, rName );
Index: sfx2/source/bastyp/sfxhtml.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/bastyp/sfxhtml.cxx,v
retrieving revision 1.12
retrieving revision 1.12.12.1
diff -u -p -u -p -r1.12 -r1.12.12.1
--- sfx2/source/bastyp/sfxhtml.cxx	11 Jan 2005 13:28:50 -0000	1.12
+++ sfx2/source/bastyp/sfxhtml.cxx	21 Jan 2005 17:10:41 -0000	1.12.12.1
@@ -726,12 +726,12 @@ const String& SfxHTMLParser::GetScriptTy
 	return aScriptType;
 }
 
-double SfxHTMLParser::GetTableDataOptionsValNum( ULONG& nNumForm,
+double SfxHTMLParser::GetTableDataOptionsValNum( sal_uInt32& nNumForm,
 		LanguageType& eNumLang, const String& aValStr, const String& aNumStr,
 		SvNumberFormatter& rFormatter )
 {
 	LanguageType eParseLang = (LanguageType )aNumStr.ToInt32();
-	ULONG nParseForm =
+	sal_uInt32 nParseForm =
 		rFormatter.GetFormatForLanguageIfBuiltIn( 0, eParseLang );
 	double fVal;
 	rFormatter.IsNumberFormat( aValStr, nParseForm, fVal );
Index: sfx2/source/doc/docinf.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/docinf.cxx,v
retrieving revision 1.29
retrieving revision 1.25.184.5
diff -u -p -u -p -r1.29 -r1.25.184.5
--- sfx2/source/doc/docinf.cxx	17 Nov 2004 15:33:54 -0000	1.29
+++ sfx2/source/doc/docinf.cxx	21 Jan 2005 17:10:53 -0000	1.25.184.5
@@ -383,11 +383,11 @@ ULONG SfxPSDateTimeProperty_Impl::Save(S
 				   60* aDateTime.GetMin() +
 				   60L*60* aDateTime.GetHour() ));
 
-	BigInt aUlongMax((ULONG)ULONG_MAX);
+	BigInt aUlongMax(UINT_MAX);
 	aUlongMax += 1;
 
-	rStream<<(UINT32)(aTime % aUlongMax) ;
-	rStream<<(UINT32)(aTime / aUlongMax);
+	rStream<<(sal_uInt32)(aTime % aUlongMax) ;
+	rStream<<(sal_uInt32)(aTime / aUlongMax);
 	return rStream.GetErrorCode();
 }
 
@@ -398,13 +398,13 @@ ErrCode SfxPSDateTimeProperty_Impl::Load
 	UINT32 nLow, nHigh;
 	rStream >> nLow;
 	rStream >> nHigh;
-	BigInt aUlongMax( (ULONG)ULONG_MAX );
+	BigInt aUlongMax( UINT_MAX);
 	aUlongMax += 1;
 	BigInt aTime = aUlongMax * BigInt( nHigh );
 	aTime += nLow;
 	BigInt a100nPerSecond(10000000L);
 	BigInt a100nPerDay = a100nPerSecond*BigInt( 60L * 60 * 24 );
-	ULONG nDays = aTime / a100nPerDay;
+	sal_uInt32 nDays = aTime / a100nPerDay;
 	USHORT nYears = (USHORT)
 		(( nDays - ( nDays / ( 4 * 365 ) ) + ( nDays / ( 100 * 365 ) ) -
 		  ( nDays / ( 400 * 365 ) ) ) / 365 );
@@ -417,12 +417,12 @@ ErrCode SfxPSDateTimeProperty_Impl::Load
 		nDaysCount-= Date(  1, nMonths, 1601 + nYears ).GetDaysInMonth();
 	}
 	Date _aDate( (USHORT)( nDays + 1 ), nMonths, nYears + 1601 );
-	Time _aTime( ( aTime / ( a100nPerSecond * BigInt( 60 * 60 ) ) ) %
-				 BigInt( 24 ),
-				 ( aTime / ( a100nPerSecond * BigInt( 60 ) ) ) %
-				 BigInt( 60 ),
-				 ( aTime / ( a100nPerSecond ) ) %
-				 BigInt( 60 ) );
+	Time _aTime( (ULONG)(sal_uInt32)(( aTime / ( a100nPerSecond * BigInt( 60 * 60 ) ) ) %
+				 BigInt( 24 )),
+				 (ULONG)(sal_uInt32)(( aTime / ( a100nPerSecond * BigInt( 60 ) ) ) %
+				 BigInt( 60 )),
+				 (ULONG)(sal_uInt32)(( aTime / ( a100nPerSecond ) ) %
+				 BigInt( 60 )) );
 	aDateTime = DateTime( _aDate, _aTime );
 	aDateTime.ConvertToLocalTime();
 	return rStream.GetErrorCode();
@@ -927,7 +927,7 @@ sal_Bool TestValidity_Impl( const String
 #pragma optimize ( "", off )
 #endif
 
-ULONG SfxDocumentInfo::LoadPropertySet( SotStorage* pStorage )
+sal_uInt32 SfxDocumentInfo::LoadPropertySet( SotStorage* pStorage )
 {
     // TODO: is used for MS format, should stay here for a while
 
@@ -1254,12 +1254,12 @@ void SfxDocumentInfo::SetReloadURL( cons
 	aReloadURL = rString;
 }
 
-ULONG SfxDocumentInfo::GetReloadDelay() const
+sal_uInt32 SfxDocumentInfo::GetReloadDelay() const
 {
 	return nReloadSecs;
 }
 
-void SfxDocumentInfo::SetReloadDelay( ULONG nSec )
+void SfxDocumentInfo::SetReloadDelay( sal_uInt32 nSec )
 {
 	nReloadSecs = nSec;
 }
Index: sfx2/source/doc/objstor.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/objstor.cxx,v
retrieving revision 1.156
retrieving revision 1.134.14.3
diff -u -p -u -p -r1.156 -r1.134.14.3
--- sfx2/source/doc/objstor.cxx	4 Mar 2005 00:19:33 -0000	1.156
+++ sfx2/source/doc/objstor.cxx	9 Mar 2005 22:24:05 -0000	1.134.14.3
@@ -480,7 +480,7 @@ void SfxObjectShell::SetupStorage( const
 	{
 		SvGlobalName aName;
 		String aFullTypeName, aShortTypeName, aAppName;
-        ULONG nClipFormat=0;
+        sal_uInt32 nClipFormat=0;
 
         FillClass( &aName, &nClipFormat, &aAppName, &aFullTypeName, &aShortTypeName, nVersion );
         if ( nClipFormat )
Index: sfx2/source/doc/objuno.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/doc/objuno.cxx,v
retrieving revision 1.18
retrieving revision 1.14.540.3
diff -u -p -u -p -r1.18 -r1.14.540.3
--- sfx2/source/doc/objuno.cxx	17 Nov 2004 13:37:44 -0000	1.18
+++ sfx2/source/doc/objuno.cxx	18 Jan 2005 21:42:21 -0000	1.14.540.3
@@ -913,7 +913,7 @@ void SAL_CALL  SfxDocumentInfoObject::se
 	}
 	else if ( _pInfo && aValue.getValueType() == ::getCppuType((const sal_Int32*)0) )
 	{
-		long nIntVal ;
+		sal_Int32 nIntVal ;
 		aValue >>= nIntVal ;
 		switch ( nHandle )
 		{
Index: sfx2/source/explorer/exptypes.cxx
===================================================================
RCS file: /cvs/framework/sfx2/source/explorer/exptypes.cxx,v
retrieving revision 1.5
retrieving revision 1.5.80.1
diff -u -p -u -p -r1.5 -r1.5.80.1
--- sfx2/source/explorer/exptypes.cxx	21 Apr 2004 13:17:08 -0000	1.5
+++ sfx2/source/explorer/exptypes.cxx	21 Jan 2005 17:11:02 -0000	1.5.80.1
@@ -188,8 +188,8 @@ String ExtendedCreateSizeText( const Big
 	BigInt nSize2 = nSize1;
 	String aSecondUnitStr( ' ' );
 	BOOL bGB = FALSE;
-	ULONG nMega = 1024 * 1024;
-	ULONG nGiga = nMega * 1024;
+	sal_uInt32 nMega = 1024 * 1024;
+	sal_uInt32 nGiga = nMega * 1024;
 
 	static const BigInt nTenKB( 10000 );
 	static const BigInt nOneMB( nMega );
@@ -417,8 +417,8 @@ String CreateExactSizeText( const BigInt
 	BigInt nSize = rSize;
 	double fSize = nSize;
 
-	ULONG nMega = 1024 * 1024;
-	ULONG nGiga = nMega * 1024;
+	sal_uInt32 nMega = 1024 * 1024;
+	sal_uInt32 nGiga = nMega * 1024;
 	static const BigInt nTenKB( 10000 );
 	static const BigInt nOneMB( nMega );
 	static const BigInt nOneGB( nGiga );
Index: sfx2/source/inc/sfxpicklist.hxx
===================================================================
RCS file: /cvs/framework/sfx2/source/inc/sfxpicklist.hxx,v
retrieving revision 1.3
retrieving revision 1.3.558.1
diff -u -p -u -p -r1.3 -r1.3.558.1
--- sfx2/source/inc/sfxpicklist.hxx	20 Nov 2001 16:56:39 -0000	1.3
+++ sfx2/source/inc/sfxpicklist.hxx	21 Jan 2005 17:11:14 -0000	1.3.558.1
@@ -106,7 +106,7 @@ class SfxPickList : public SfxListener
 	sal_uInt32						m_nAllowedMenuSize;
 	::com::sun::star::uno::Reference< ::com::sun::star::util::XStringWidth > m_xStringLength;
 
-							SfxPickList( ULONG nMenuSize );
+							SfxPickList( sal_uInt32 nMenuSize );
 							~SfxPickList();
 
 	static osl::Mutex*		GetOrCreateMutex();
@@ -117,7 +117,7 @@ class SfxPickList : public SfxListener
 	void					RemovePickListEntries();
 
 	public:
-		static SfxPickList*	GetOrCreate( const ULONG nMenuSize );
+		static SfxPickList*	GetOrCreate( const sal_uInt32 nMenuSize );
 		static SfxPickList*	Get();
 		static void			Delete();
 
Index: comphelper/inc/comphelper/basicio.hxx
===================================================================
RCS file: /cvs/util/comphelper/inc/comphelper/basicio.hxx,v
retrieving revision 1.2
retrieving revision 1.1.1.1.232.2
diff -u -p -u -p -r1.2 -r1.1.1.1.232.2
--- comphelper/inc/comphelper/basicio.hxx	16 Feb 2005 15:53:11 -0000	1.2
+++ comphelper/inc/comphelper/basicio.hxx	9 Mar 2005 18:20:21 -0000	1.1.1.1.232.2
@@ -102,10 +102,18 @@ COMPHELPER_DLLPUBLIC const staruno::Refe
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt32& _rValue);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt32 _nValue);
 
-// sal_Int16
+// sal_Int32
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int32& _rValue);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int32 _nValue);
 
+// sal_uInt64
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt64& _rValue);
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt64 _nValue);
+
+// sal_Int64
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int64& _rValue);
+COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int64 _nValue);
+
 // FontDescriptor
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& InStream, starawt::FontDescriptor& rVal);
 COMPHELPER_DLLPUBLIC const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& OutStream, const starawt::FontDescriptor& rVal);
Index: comphelper/source/streaming/basicio.cxx
===================================================================
RCS file: /cvs/util/comphelper/source/streaming/basicio.cxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.232.1
diff -u -p -u -p -r1.1.1.1 -r1.1.1.1.232.1
--- comphelper/source/streaming/basicio.cxx	29 Sep 2000 11:28:15 -0000	1.1.1.1
+++ comphelper/source/streaming/basicio.cxx	9 Sep 2004 11:07:59 -0000	1.1.1.1.232.1
@@ -193,8 +193,40 @@ const staruno::Reference<stario::XObject
 {
 	_rValue = _rxInStream->readLong();
 	return _rxInStream;
+
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_uInt64 _nValue)
+{
+	_rxOutStream->writeLong(_nValue);
+	return _rxOutStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_uInt64& _rValue)
+{
+	_rValue = _rxInStream->readLong();
+	return _rxInStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int64 _nValue)
+{
+	_rxOutStream->writeLong(_nValue);
+	return _rxOutStream;
+}
+
+//------------------------------------------------------------------------------
+const staruno::Reference<stario::XObjectInputStream>& operator >> (const staruno::Reference<stario::XObjectInputStream>& _rxInStream, sal_Int64& _rValue)
+{
+	_rValue = _rxInStream->readLong();
+	return _rxInStream;
 }
 
+
+
+
 //------------------------------------------------------------------------------
 const staruno::Reference<stario::XObjectOutputStream>& operator << (const staruno::Reference<stario::XObjectOutputStream>& _rxOutStream, sal_Int32 _nValue)
 {
