Index: svx/inc/editeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/editeng.hxx,v
retrieving revision 1.45
retrieving revision 1.41.138.5
diff -u -p -u -p -r1.45 -r1.41.138.5
--- svx/inc/editeng.hxx	21 Jan 2005 14:23:04 -0000	1.45
+++ svx/inc/editeng.hxx	9 Mar 2005 23:51:42 -0000	1.41.138.5
@@ -464,7 +464,7 @@ public:
 	virtual	void	ParagraphHeightChanged( USHORT nPara );
 
 	// #101498#
-	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
+	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	virtual String	GetUndoComment( USHORT nUndoId ) const;
 	virtual BOOL	FormattingParagraph( USHORT nPara );
Index: svx/inc/outliner.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/outliner.hxx,v
retrieving revision 1.51
retrieving revision 1.46.138.4
diff -u -p -u -p -r1.51 -r1.46.138.4
--- svx/inc/outliner.hxx	21 Jan 2005 15:04:09 -0000	1.51
+++ svx/inc/outliner.hxx	10 Mar 2005 00:13:02 -0000	1.46.138.4
@@ -438,7 +438,7 @@ public:
 
     const SvxFont&  rFont;
 
-    const long*     pDXArray;
+    const sal_Int32*     pDXArray;
 
 	// #101498# BiDi level needs to be transported, too.
 	BYTE			mnBiDiLevel;
@@ -447,7 +447,7 @@ public:
 	sal_Bool IsRTL() const;
 
     DrawPortionInfo( const Point& rPos, const String& rTxt, USHORT nTxtStart, USHORT nTxtLen,
-		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const long* pDXArr, BYTE nBiDiLevel)
+		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const sal_Int32* pDXArr, BYTE nBiDiLevel)
         :	rStartPos(rPos), rText(rTxt), nPara(nPar), nIndex(nIdx),
 			rFont(rFnt), pDXArray(pDXArr), mnBiDiLevel(nBiDiLevel)
 	    {
@@ -834,7 +839,7 @@ public:
 
 	// #101498#
 	virtual void    DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen,
-						const long* pDXArray, const SvxFont& rFont,
+						const sal_Int32* pDXArray, const SvxFont& rFont,
 						USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	Size            CalcTextSize();
Index: svx/inc/svxfont.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/svxfont.hxx,v
retrieving revision 1.3
retrieving revision 1.2.848.2
diff -u -p -u -p -r1.3 -r1.2.848.2
--- svx/inc/svxfont.hxx	21 Jan 2005 15:34:41 -0000	1.3
+++ svx/inc/svxfont.hxx	9 Mar 2005 23:34:40 -0000	1.2.848.2
@@ -149,10 +149,10 @@ public:
 			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN ) const;
 
 	void QuickDrawText( OutputDevice *pOut, const Point &rPos, const String &rTxt,
-			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const long* pDXArray = NULL ) const;
+			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const sal_Int32* pDXArray = NULL ) const;
 
 	Size QuickGetTextSize( const OutputDevice *pOut, const String &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray = NULL ) const;
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray = NULL ) const;
 
 	void DrawPrev( OutputDevice* pOut, Printer* pPrinter,
 				   const Point &rPos, const String &rTxt,
Index: svx/source/customshapes/EnhancedCustomShapeFontWork.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/customshapes/EnhancedCustomShapeFontWork.cxx,v
retrieving revision 1.7
retrieving revision 1.2.174.3
diff -u -p -u -p -r1.7 -r1.2.174.3
--- svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	21 Feb 2005 16:17:39 -0000	1.7
+++ svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	10 Mar 2005 00:35:59 -0000	1.2.174.3
@@ -345,7 +345,7 @@ void GetTextAreaOutline( const FWData& r
 
 			SvxCharScaleWidthItem& rCharScaleWidthItem = (SvxCharScaleWidthItem&)pCustomShape->GetMergedItem( EE_CHAR_FONTWIDTH );
 			sal_uInt16 nCharScaleWidth = rCharScaleWidthItem.GetValue();
-			long* pDXArry = NULL;
+			sal_Int32* pDXArry = NULL;
 			sal_Int32 nWidth = 0;
 
 			// VERTICAL
@@ -410,7 +410,7 @@ void GetTextAreaOutline( const FWData& r
 			{
 				if ( ( nCharScaleWidth != 100 ) && nCharScaleWidth )
 				{	// applying character spacing
-					pDXArry = new long[ rText.getLength() ];
+					pDXArry = new sal_Int32[ rText.getLength() ];
 					aVirDev.GetTextArray( rText, pDXArry, 0, STRING_LEN );
 					FontMetric aFontMetric( aVirDev.GetFontMetric() );
 					aFont.SetWidth( (sal_Int32)( (double)aFontMetric.GetWidth() * ( (double)100 / (double)nCharScaleWidth ) ) );
Index: svx/source/editeng/editdoc.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc.hxx,v
retrieving revision 1.20
retrieving revision 1.20.364.2
diff -u -p -u -p -r1.20 -r1.20.364.2
--- svx/source/editeng/editdoc.hxx	1 Sep 2003 12:00:48 -0000	1.20
+++ svx/source/editeng/editdoc.hxx	21 Jan 2005 16:09:43 -0000	1.20.364.2
@@ -403,13 +403,13 @@ struct ExtraPortionInfo
     BOOL    bFirstCharIsRightPunktuation;
     BOOL    bCompressed;
 
-    long*    pOrgDXArray;
+    sal_Int32*    pOrgDXArray;
 
 
             ExtraPortionInfo();
             ~ExtraPortionInfo();
 
-    void    SaveOrgDXArray( const long* pDXArray, USHORT nLen );
+    void    SaveOrgDXArray( const sal_Int32* pDXArray, USHORT nLen );
     void    DestroyOrgDXArray();
 };
 
Index: svx/source/editeng/editdoc2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc2.cxx,v
retrieving revision 1.11
retrieving revision 1.11.826.2
diff -u -p -u -p -r1.11 -r1.11.826.2
--- svx/source/editeng/editdoc2.cxx	28 Aug 2002 15:20:19 -0000	1.11
+++ svx/source/editeng/editdoc2.cxx	21 Jan 2005 16:10:20 -0000	1.11.826.2
@@ -200,11 +200,11 @@ ExtraPortionInfo::~ExtraPortionInfo()
     delete[] pOrgDXArray;
 }
 
-void ExtraPortionInfo::SaveOrgDXArray( const long* pDXArray, USHORT nLen ) 
+void ExtraPortionInfo::SaveOrgDXArray( const sal_Int32* pDXArray, USHORT nLen ) 
 {
     delete[] pOrgDXArray;
-    pOrgDXArray = new long[nLen];
-    memcpy( pOrgDXArray, pDXArray, nLen*sizeof(long) );
+    pOrgDXArray = new sal_Int32[nLen];
+    memcpy( pOrgDXArray, pDXArray, nLen*sizeof(sal_Int32) );
 }
 
 void ExtraPortionInfo::DestroyOrgDXArray()
Index: svx/source/editeng/impedit.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit.hxx,v
retrieving revision 1.69
retrieving revision 1.69.26.1
diff -u -p -u -p -r1.69 -r1.69.26.1
--- svx/source/editeng/impedit.hxx	11 Jan 2005 12:59:27 -0000	1.69
+++ svx/source/editeng/impedit.hxx	21 Jan 2005 16:10:55 -0000	1.69.26.1
@@ -680,7 +680,7 @@ private:
 	BOOL				IsScriptChange( const EditPaM& rPaM ) const;
     BOOL                HasScriptType( USHORT nPara, USHORT nType ) const;
 
-    BOOL                ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, long* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray );
+    BOOL                ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, sal_Int32* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray );
     void                ImplExpandCompressedPortions( EditLine* pLine, ParaPortion* pParaPortion, long nRemainingWidth );
 
     void                ImplInitLayoutMode( OutputDevice* pOutDev, USHORT nPara, USHORT nIndex );
@@ -757,7 +757,7 @@ private:
                                               const String&							rTxt,
                                               const USHORT 							nIdx, 
                                               const USHORT 							nLen, 
-                                              const long* 							pDXArray ) const;
+                                              const sal_Int32* 							pDXArray ) const;
 
 protected:
 	virtual void			Notify( SfxBroadcaster& rBC, const SfxHint& rHint );
Index: svx/source/editeng/impedit2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit2.cxx,v
retrieving revision 1.98
retrieving revision 1.95.138.4
diff -u -p -u -p -r1.98 -r1.95.138.4
--- svx/source/editeng/impedit2.cxx	11 Jan 2005 12:59:41 -0000	1.98
+++ svx/source/editeng/impedit2.cxx	21 Jan 2005 16:11:54 -0000	1.95.138.4
@@ -3833,7 +3833,7 @@ long ImpEditEngine::GetXPos( ParaPortion
                     if ( nType == CHAR_PUNCTUATIONRIGHT )
                     {
                         USHORT n = nIndex - nTextPortionStart;
-                        const long* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
+                        const sal_Int32* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
                         long nCharWidth = ( ( (n+1) < pPortion->GetLen() ) ? pDXArray[n] : pPortion->GetSize().Width() )
                                                         - ( n ? pDXArray[n-1] : 0 );
                         if ( (n+1) < pPortion->GetLen() )
Index: svx/source/editeng/impedit3.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit3.cxx,v
retrieving revision 1.94
retrieving revision 1.91.220.4
diff -u -p -u -p -r1.94 -r1.91.220.4
--- svx/source/editeng/impedit3.cxx	26 Nov 2004 18:12:55 -0000	1.94
+++ svx/source/editeng/impedit3.cxx	21 Jan 2005 16:12:20 -0000	1.91.220.4
@@ -211,7 +211,7 @@ BYTE GetCharTypeForCompression( xub_Unic
     }
 }
 
-void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const long* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
+void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const sal_Int32* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
 {
 #ifndef SVX_LIGHT
 	// Aber nur, wenn Font nicht zu klein...
@@ -1258,7 +1258,7 @@ sal_Bool ImpEditEngine::CreateLines( USH
             if ( bCompressedChars && ( pPortion->GetLen() > 1 ) && pPortion->GetExtraInfos() && pPortion->GetExtraInfos()->bCompressed )
             {
                 // I need the manipulated DXArray for determining the break postion...
-                ImplCalcAsianCompression( pNode, pPortion, nPortionStart, (long*)pLine->GetCharPosArray().GetData() + (nPortionStart-pLine->GetStart()), 10000, TRUE );
+                ImplCalcAsianCompression( pNode, pPortion, nPortionStart, const_cast< sal_Int32* >( pLine->GetCharPosArray().GetData() + (nPortionStart-pLine->GetStart()) ), 10000, TRUE );
             }
 			ImpBreakLine( pParaPortion, pLine, pPortion, nPortionStart,
 											nRemainingWidth, bCanHyphenate && bHyphenatePara );
@@ -3004,8 +3004,8 @@ void ImpEditEngine::Paint( OutputDevice*
 								XubString aText;
                                 USHORT nTextStart = 0;
                                 USHORT nTextLen = 0;
-								const long* pDXArray = 0;
-								long* pTmpDXArray = 0;
+								const sal_Int32* pDXArray = 0;
+								sal_Int32* pTmpDXArray = 0;
 
 								if ( pTextPortion->GetKind() == PORTIONKIND_TEXT )
 								{
@@ -3023,7 +3023,7 @@ void ImpEditEngine::Paint( OutputDevice*
                                     nTextStart = 0;
                                     nTextLen = aText.Len();
 
-									pTmpDXArray = new long[ aText.Len() ];
+									pTmpDXArray = new sal_Int32[ aText.Len() ];
 									pDXArray = pTmpDXArray;
 									Font aOldFont( GetRefDevice()->GetFont() );
 									aTmpFont.SetPhysFont( GetRefDevice() );
@@ -4108,7 +4108,7 @@ Color ImpEditEngine::GetAutoColor() cons
 }
 
 
-BOOL ImpEditEngine::ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, long* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray )
+BOOL ImpEditEngine::ImplCalcAsianCompression( ContentNode* pNode, TextPortion* pTextPortion, USHORT nStartPos, sal_Int32* pDXArray, USHORT n100thPercentFromMax, BOOL bManipulateDXArray )
 {
     DBG_ASSERT( GetAsianCompressionMode(), "ImplCalcAsianCompression - Why?" );
     DBG_ASSERT( pTextPortion->GetLen(), "ImplCalcAsianCompression - Empty Portion?" );
@@ -4279,9 +4279,9 @@ void ImpEditEngine::ImplExpandCompressed
                 USHORT nTxtPortion = pParaPortion->GetTextPortions().GetPos( pTP );
                 USHORT nTxtPortionStart = pParaPortion->GetTextPortions().GetStartPos( nTxtPortion );
                 DBG_ASSERT( nTxtPortionStart >= pLine->GetStart(), "Portion doesn't belong to the line!!!" );
-                long* pDXArray = (long*)pLine->GetCharPosArray().GetData()+( nTxtPortionStart-pLine->GetStart() );
+                sal_Int32* pDXArray = const_cast< sal_Int32* >( pLine->GetCharPosArray().GetData()+( nTxtPortionStart-pLine->GetStart() ) );
                 if ( pTP->GetExtraInfos()->pOrgDXArray )
-                    memcpy( pDXArray, pTP->GetExtraInfos()->pOrgDXArray, (pTP->GetLen()-1)*sizeof(long) );
+                    memcpy( pDXArray, pTP->GetExtraInfos()->pOrgDXArray, (pTP->GetLen()-1)*sizeof(sal_Int32) );
                 ImplCalcAsianCompression( pParaPortion->GetNode(), pTP, nTxtPortionStart, pDXArray, (USHORT)nCompressPercent, TRUE );
             }
         }
@@ -4299,7 +4299,7 @@ void ImpEditEngine::ImplDrawWithComments
                                           const String&			rTxt,
                                           const USHORT 			nIdx, 
                                           const USHORT 			nLen, 
-                                          const long* 			pDXArray ) const
+                                          const sal_Int32* 			pDXArray ) const
 {
     Reference< i18n::XBreakIterator > xBI( ImplGetBreakIterator() );
 
Index: svx/source/items/svxfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/svxfont.cxx,v
retrieving revision 1.7
retrieving revision 1.7.298.1
diff -u -p -u -p -r1.7 -r1.7.298.1
--- svx/source/items/svxfont.cxx	6 Jan 2004 15:36:05 -0000	1.7
+++ svx/source/items/svxfont.cxx	9 Sep 2004 09:40:04 -0000	1.7.298.1
@@ -503,7 +503,7 @@ Size SvxFont::GetPhysTxtSize( const Outp
 }
 
 Size SvxFont::QuickGetTextSize( const OutputDevice *pOut, const XubString &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray ) const
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray ) const
 {
 	if ( !IsCaseMap() && !IsKern() )
 		return Size( pOut->GetTextArray( rTxt, pDXArray, nIdx, nLen ),
@@ -590,7 +590,7 @@ void SvxFont::DrawText( OutputDevice *pO
 
 void SvxFont::QuickDrawText( OutputDevice *pOut,
 	const Point &rPos, const XubString &rTxt,
-	const xub_StrLen nIdx, const xub_StrLen nLen, const long* pDXArray ) const
+	const xub_StrLen nIdx, const xub_StrLen nLen, const sal_Int32* pDXArray ) const
 {
 	// Font muss ins OutputDevice selektiert sein...
 	if ( !IsCaseMap() && !IsCapital() && !IsKern() && !IsEsc() )
Index: svx/source/outliner/outleeng.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.cxx,v
retrieving revision 1.9
retrieving revision 1.9.140.1
diff -u -p -u -p -r1.9 -r1.9.140.1
--- svx/source/outliner/outleeng.cxx	27 Apr 2004 15:49:36 -0000	1.9
+++ svx/source/outliner/outleeng.cxx	9 Sep 2004 09:40:05 -0000	1.9.140.1
@@ -173,7 +173,7 @@ XubString OutlinerEditEng::GetUndoCommen
 }
 
 // #101498#
-void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	if ( nIndex == 0 )
 	{
Index: svx/source/outliner/outleeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.hxx,v
retrieving revision 1.7
retrieving revision 1.7.140.1
diff -u -p -u -p -r1.7 -r1.7.140.1
--- svx/source/outliner/outleeng.hxx	27 Apr 2004 15:49:53 -0000	1.7
+++ svx/source/outliner/outleeng.hxx	9 Sep 2004 09:40:05 -0000	1.7.140.1
@@ -85,7 +85,7 @@ public:
 	virtual void 		ParagraphDeleted( USHORT nDeletedParagraph );
 	
 	// #101498#
-	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
+	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
 
 	virtual	void 		StyleSheetChanged( SfxStyleSheet* pStyle );
 	virtual void 		ParaAttribsChanged( USHORT nPara );
Index: svx/source/outliner/outliner.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outliner.cxx,v
retrieving revision 1.58
retrieving revision 1.56.298.2
diff -u -p -u -p -r1.58 -r1.56.298.2
--- svx/source/outliner/outliner.cxx	11 Jan 2005 13:02:09 -0000	1.58
+++ svx/source/outliner/outliner.cxx	19 Jan 2005 02:31:52 -0000	1.56.298.2
@@ -2050,7 +2050,7 @@ void Outliner::StripPortions()
 }
 
 // #101498#
-void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	DBG_CHKTHIS(Outliner,0);
 	
Index: svx/source/xoutdev/_xfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/xoutdev/_xfont.cxx,v
retrieving revision 1.13
retrieving revision 1.13.298.1
diff -u -p -u -p -r1.13 -r1.13.298.1
--- svx/source/xoutdev/_xfont.cxx	6 Jan 2004 15:46:20 -0000	1.13
+++ svx/source/xoutdev/_xfont.cxx	9 Sep 2004 09:40:07 -0000	1.13.298.1
@@ -205,7 +205,7 @@ sal_Bool XOutGetTextOutlines(PolyPolyVec
 
 // #101498# Helper method ImpGetTextLength to get text length taking into account
 // hor/vertical and BIDI, especially right-to-left.
-sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, long* pDXArray, 
+sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft = pInfo->IsRTL();
@@ -236,7 +236,7 @@ sal_Int32 ImpGetTextLength(OutputDevice*
 
 // #101498# Helper method ImpDrawTextArray to draw text taking into account
 // hor/vertical and BIDI, especially right-to-left.
-void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, long* pDXArray, 
+void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft(pInfo->IsRTL());
@@ -284,7 +284,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 	sal_Bool bToLastPoint, sal_Bool bDraw, sal_Bool bIsShadow)
 {
 	Font aFont = pInfo->rFont;
-	const long* pDXArray = pInfo->pDXArray;
+	const sal_Int32* pDXArray = pInfo->pDXArray;
 	sal_Bool bUseBreakIterator(sal_False);
 
 	Reference < com::sun::star::i18n::XBreakIterator > xBreak;
@@ -366,7 +366,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		pDXArray = NULL;
 	}
 
-	nTextWidth = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, 0, pInfo->nTextLen);
+	nTextWidth = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, 0, pInfo->nTextLen);
 
 	if ( eFormTextAdjust != XFT_LEFT && nAbsStart <= 0 )
 	{
@@ -461,7 +461,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		fLen = sqrt(fDx * fDx + fDy * fDy);
 		nLen = (long) (fLen + 0.5);
 
-		nChar1Len = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nGlyphLen);
+		nChar1Len = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nGlyphLen);
 
 		double fXDist, fYDist;
 		double fCos = fDx;
@@ -516,7 +516,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						CharacterIteratorMode::SKIPCELL, 1, nDone) - (nChar + pInfo->nTextStart + nCnt);
 				}
 
-				nTextLen = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nCnt + nNextGlyphLen);
+				nTextLen = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nCnt + nNextGlyphLen);
 
 				nCnt += nNextGlyphLen;
 			}
@@ -585,7 +585,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 					else
@@ -597,7 +597,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 				}
@@ -624,7 +624,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, i);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, i);
 
 						aPolyPos.X() += (long) (fDx * nW / fLen);
 						aPolyPos.Y() += (long) (fDy * nW / fLen);
@@ -675,7 +675,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar + i, nNextGlyphLen);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar + i, nNextGlyphLen);
 
 						aPolyPos.X() -= nW / 2;
 
@@ -696,7 +696,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 							DrawXPolyPolygon(aChar);
 						else
 						{
-							ImpDrawTextArray(pOut, aPolyPos, pInfo, (long*)pDXArray, nChar + i, nNextGlyphLen);
+							ImpDrawTextArray(pOut, aPolyPos, pInfo, (sal_Int32*)pDXArray, nChar + i, nNextGlyphLen);
 						}
 					}
 
