Index: sc/source/filter/xcl97/xcl97rec.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/xcl97rec.cxx,v
retrieving revision 1.76
diff -u -r1.76 xcl97rec.cxx
--- sc/source/filter/xcl97/xcl97rec.cxx	21 Feb 2005 13:50:03 -0000	1.76
+++ sc/source/filter/xcl97/xcl97rec.cxx	5 Jun 2005 11:12:41 -0000
@@ -848,7 +848,8 @@
 	// write only as embedded, not linked
 	String			aStorageName( RTL_CONSTASCII_USTRINGPARAM( "MBD" ) );
 	sal_Char		aBuf[ sizeof(UINT32) * 2 + 1 ];
-	UINT32			nPictureId = UINT32(this);
+    // FIXME Eeek! Is this just a way to get a unique id?
+	UINT32			nPictureId = UINT32(sal_uIntPtr(this) >> 2);
 	sprintf( aBuf, "%08X", nPictureId );        // #100211# - checked
 	aStorageName.AppendAscii( aBuf );
     SotStorageRef    xOleStg = pRootStorage->OpenSotStorage( aStorageName,
