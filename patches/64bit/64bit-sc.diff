Index: sc/inc/rechead.hxx
===================================================================
RCS file: /cvs/sc/sc/inc/rechead.hxx,v
retrieving revision 1.1.1.1
retrieving revision 1.1.1.1.522.1
diff -u -p -u -r1.1.1.1 -r1.1.1.1.522.1
--- sc/inc/rechead.hxx	18 Sep 2000 16:44:49 -0000	1.1.1.1
+++ sc/inc/rechead.hxx	9 Sep 2004 11:02:22 -0000	1.1.1.1.522.1
@@ -221,7 +221,7 @@ private:
 	ULONG			nEntryStart;
 
 public:
-	ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault = 0);
+	ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault = 0);
 	~ScMultipleWriteHeader();
 
 	void	StartEntry();
Index: sc/source/core/data/table3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/data/table3.cxx,v
retrieving revision 1.18
retrieving revision 1.16.42.2
diff -u -p -u -r1.18 -r1.16.42.2
--- sc/source/core/data/table3.cxx	8 Sep 2004 15:56:01 -0000	1.18
+++ sc/source/core/data/table3.cxx	19 Oct 2004 13:49:16 -0000	1.16.42.2
@@ -1083,7 +1083,7 @@ BOOL ScTable::ValidQuery(SCROW nRow, con
                         bOk = pTransliteration->isEqual( aCellStr, *rEntry.pStr );
 					else
 					{
-                        ::com::sun::star::uno::Sequence< long > xOff;
+                        ::com::sun::star::uno::Sequence< sal_Int32 > xOff;
                         String aCell( pTransliteration->transliterate(
                             aCellStr, ScGlobal::eLnge, 0, aCellStr.Len(),
                             &xOff ) );
Index: sc/source/core/tool/rechead.cxx
===================================================================
RCS file: /cvs/sc/sc/source/core/tool/rechead.cxx,v
retrieving revision 1.2
retrieving revision 1.2.378.1
diff -u -p -u -r1.2 -r1.2.378.1
--- sc/source/core/tool/rechead.cxx	26 Mar 2003 18:04:18 -0000	1.2
+++ sc/source/core/tool/rechead.cxx	9 Sep 2004 11:02:24 -0000	1.2.378.1
@@ -217,7 +217,7 @@ ULONG ScMultipleReadHeader::BytesLeft() 
 
 // -----------------------------------------------------------------------
 
-ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, ULONG nDefault) :
+ScMultipleWriteHeader::ScMultipleWriteHeader(SvStream& rNewStream, sal_Size nDefault) :
 	rStream( rNewStream ),
 	aMemStream( 4096, 4096 )
 {
Index: sc/source/filter/excel/XclImpChartsApi.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/XclImpChartsApi.cxx,v
retrieving revision 1.14
retrieving revision 1.14.40.1
diff -u -p -u -r1.14 -r1.14.40.1
--- sc/source/filter/excel/XclImpChartsApi.cxx	4 Jun 2004 10:41:25 -0000	1.14
+++ sc/source/filter/excel/XclImpChartsApi.cxx	9 Sep 2004 11:02:24 -0000	1.14.40.1
@@ -228,7 +228,7 @@ void lcl_GetApiLineStyle(
     rApiDash.Style = drawing::DashStyle_RECT;
     rApiDash.Dots = 0;
     rApiDash.Dashes = 0;
-    rApiDash.Distance = rApiDash.DotLen = Min( static_cast< sal_Int32 >( nXclWidth + 105 ), 210L );
+    rApiDash.Distance = rApiDash.DotLen = Min( static_cast< sal_Int32 >( nXclWidth + 105 ), (sal_Int32) 210 );
     rApiDash.DashLen = rApiDash.DotLen * 4;
     rnApiTrans = 0;
 
@@ -417,8 +417,8 @@ void lcl_SetPosition(
 
 	if( !bSetSize )
 	{
-		aPoint.X = Max( aPoint.X, (long) SC_CHART_MINDIST );
-		aPoint.Y = Max( aPoint.Y, (long) SC_CHART_MINDIST );
+		aPoint.X = Max( aPoint.X, (sal_Int32) SC_CHART_MINDIST );
+		aPoint.Y = Max( aPoint.Y, (sal_Int32) SC_CHART_MINDIST );
 
         sal_Int32 nScRot = XclTools::GetScRotation( nRot );
 		if( (nScRot > 13500) && (nScRot < 31500) )
@@ -426,8 +426,8 @@ void lcl_SetPosition(
 		if( (nScRot > 4500) && (nScRot < 22500) )
 			aPoint.Y += aSize.Height;
 
-		aPoint.X = Min( aPoint.X, (long)(rRealSize.Width() - aSize.Width - SC_CHART_MINDIST) );
-		aPoint.Y = Min( aPoint.Y, (long)(rRealSize.Height() - aSize.Height - SC_CHART_MINDIST) );
+		aPoint.X = Min( aPoint.X, (sal_Int32)(rRealSize.Width() - aSize.Width - SC_CHART_MINDIST) );
+		aPoint.Y = Min( aPoint.Y, (sal_Int32)(rRealSize.Height() - aSize.Height - SC_CHART_MINDIST) );
 	}
 
 	try
Index: sc/source/filter/excel/xlstyle.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/excel/xlstyle.cxx,v
retrieving revision 1.10
retrieving revision 1.10.54.1
diff -u -p -u -r1.10 -r1.10.54.1
--- sc/source/filter/excel/xlstyle.cxx	18 May 2004 12:44:12 -0000	1.10
+++ sc/source/filter/excel/xlstyle.cxx	9 Sep 2004 11:02:26 -0000	1.10.54.1
@@ -358,7 +358,7 @@ FontStrikeout XclFontData::GetScStrikeou
 
 void XclFontData::SetScHeight( sal_Int32 nTwips )
 {
-    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, 0x7FFFL ) );
+    mnHeight = static_cast< sal_uInt16 >( ::std::min( nTwips, (sal_Int32)0x7FFF ) );
 }
 
 void XclFontData::SetScFamily( FontFamily eScFamily )
Index: sc/source/filter/html/htmlpars.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/html/htmlpars.cxx,v
retrieving revision 1.21
retrieving revision 1.20.42.2
diff -u -p -u -r1.21 -r1.20.42.2
--- sc/source/filter/html/htmlpars.cxx	4 Oct 2004 20:08:43 -0000	1.21
+++ sc/source/filter/html/htmlpars.cxx	19 Oct 2004 14:16:53 -0000	1.20.42.2
@@ -2194,10 +2194,10 @@ void ScHTMLTable::DataOn( const ImportIn
             switch( aIter->GetToken() )
             {
                 case HTML_O_COLSPAN:
-                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnCols = static_cast< SCCOL >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_ROWSPAN:
-                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), 1L, 256L ) );
+                    aSpanSize.mnRows = static_cast< SCROW >( bound( aIter->GetString().ToInt32(), (sal_Int32)1, (sal_Int32)256 ) );
                 break;
                 case HTML_O_SDVAL:
                     pValStr.reset( new String( aIter->GetString() ) );
@@ -2993,7 +2993,7 @@ void ScHTMLQueryParser::FontOn( const Im
             break;
             case HTML_O_SIZE :
             {
-                sal_uInt32 nSize = bound( aIter->GetNumber(), 1UL, SC_HTML_FONTSIZES );
+                sal_uInt32 nSize = bound( aIter->GetNumber(), (sal_uInt32)1, SC_HTML_FONTSIZES );
                 mpCurrTable->PutItem( SvxFontHeightItem( maFontHeights[ nSize - 1 ], 100, ATTR_FONT_HEIGHT ) );
             }
             break;
Index: sc/source/filter/xcl97/xcl97rec.cxx
===================================================================
RCS file: /cvs/sc/sc/source/filter/xcl97/xcl97rec.cxx,v
retrieving revision 1.67
retrieving revision 1.67.40.1
diff -u -p -u -r1.67 -r1.67.40.1
--- sc/source/filter/xcl97/xcl97rec.cxx	4 Jun 2004 11:07:31 -0000	1.67
+++ sc/source/filter/xcl97/xcl97rec.cxx	9 Sep 2004 11:02:28 -0000	1.67.40.1
@@ -548,7 +548,7 @@ XclObjComment::XclObjComment( const XclE
 	aPropOpt.AddOpt( ESCHER_Prop_shadowColor, 0x00000000 );
 	aPropOpt.AddOpt( ESCHER_Prop_fshadowObscured, 0x00030003 );		// bool field
     sal_uInt32 nFlags = 0x000A0000;
-    ::set_flag( nFlags, 2UL, !bVisible );
+    ::set_flag( nFlags, (sal_uInt32)2, !bVisible );
     aPropOpt.AddOpt( ESCHER_Prop_fPrint, nFlags );                  // bool field
 	aPropOpt.Commit( pEx->GetStream() );
 
Index: sc/source/ui/Accessibility/AccessibleCsvControl.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleCsvControl.cxx,v
retrieving revision 1.16
retrieving revision 1.15.206.2
diff -u -p -u -r1.16 -r1.15.206.2
--- sc/source/ui/Accessibility/AccessibleCsvControl.cxx	23 Aug 2004 09:27:42 -0000	1.16
+++ sc/source/ui/Accessibility/AccessibleCsvControl.cxx	19 Oct 2004 13:27:42 -0000	1.15.206.2
@@ -407,7 +407,7 @@ sal_Int32 lcl_GetApiPos( sal_Int32 nRule
         nApiPos += nStart - nExp + 1;
         nExp *= 10;
     }
-    return ::std::max( nApiPos, 0L );
+    return ::std::max( nApiPos, (sal_Int32)0 );
 }
 
 /** Converts an API text index to a ruler cursor position. */
@@ -626,7 +626,7 @@ sal_Int32 SAL_CALL ScAccessibleCsvRuler:
     ensureAlive();
     ScCsvRuler& rRuler = implGetRuler();
     // #107054# use object's coordinate system, convert to API position
-    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), 0L ), rRuler.GetPosCount() ) );
+    return lcl_GetApiPos( ::std::min( ::std::max( rRuler.GetPosFromX( rPoint.X ), (sal_Int32)0 ), rRuler.GetPosCount() ) );
 }
 
 OUString SAL_CALL ScAccessibleCsvRuler::getSelectedText() throw( RuntimeException )
Index: sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx,v
retrieving revision 1.30
retrieving revision 1.29.42.2
diff -u -p -u -r1.30 -r1.29.42.2
--- sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	8 Sep 2004 13:52:20 -0000	1.30
+++ sc/source/ui/Accessibility/AccessibleDocumentPagePreview.cxx	19 Oct 2004 13:27:31 -0000	1.29.42.2
@@ -1771,7 +1771,7 @@ void SAL_CALL ScAccessibleDocumentPagePr
 
 //=====  XAccessibleContext  ==============================================
 
-long SAL_CALL ScAccessibleDocumentPagePreview::getAccessibleChildCount(void) throw (uno::RuntimeException)
+sal_Int32 SAL_CALL ScAccessibleDocumentPagePreview::getAccessibleChildCount(void) throw (uno::RuntimeException)
 {
 	ScUnoGuard aGuard;
     IsObjectValid();
Index: sc/source/ui/dbgui/csvgrid.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvgrid.cxx,v
retrieving revision 1.20
retrieving revision 1.19.42.2
diff -u -p -u -r1.20 -r1.19.42.2
--- sc/source/ui/dbgui/csvgrid.cxx	8 Sep 2004 15:53:38 -0000	1.20
+++ sc/source/ui/dbgui/csvgrid.cxx	19 Oct 2004 13:16:58 -0000	1.19.42.2
@@ -179,7 +179,7 @@ void ScCsvGrid::UpdateOffsetX()
     sal_Int32 nLastLine = GetLastVisLine() + 1;
     sal_Int32 nDigits = 2;
     while( nLastLine /= 10 ) ++nDigits;
-    nDigits = Max( nDigits, 3L );
+    nDigits = Max( nDigits, (sal_Int32)3 );
     Execute( CSVCMD_SETHDRWIDTH, GetTextWidth( String( '0' ) ) * nDigits );
 }
 
@@ -704,8 +704,8 @@ void ScCsvGrid::MoveCursor( sal_uInt32 n
     {
         sal_Int32 nPosBeg = GetColumnPos( nColIndex );
         sal_Int32 nPosEnd = GetColumnPos( nColIndex + 1 );
-        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, 0L );
-        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + 1L, nMinPos );
+        sal_Int32 nMinPos = Max( nPosBeg - CSV_SCROLL_DIST, (sal_Int32)0 );
+        sal_Int32 nMaxPos = Min( nPosEnd - GetVisPosCount() + CSV_SCROLL_DIST + (sal_Int32)1, nMinPos );
         if( nPosBeg - CSV_SCROLL_DIST + 1 <= GetFirstVisPos() )
             Execute( CSVCMD_SETPOSOFFSET, nMinPos );
         else if( nPosEnd + CSV_SCROLL_DIST >= GetLastVisPos() )
@@ -787,7 +787,7 @@ void ScCsvGrid::ImplSetTextLineSep(
         pChar = ScImportExport::ScanNextFieldFromString( pChar, aCellText, cTextSep, pSepChars, bMergeSep );
 
         // update column width
-        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + 1L );
+        sal_Int32 nWidth = Max( CSV_MINCOLWIDTH, aCellText.Len() + (sal_Int32)1 );
         if( IsValidColumn( nColIx ) )
         {
             // expand existing column
@@ -918,7 +918,7 @@ void ScCsvGrid::Tracking( const Tracking
 
         sal_Int32 nPos = (rMEvt.GetPosPixel().X() - GetFirstX()) / GetCharWidth() + GetFirstVisPos();
         // on mouse tracking: keep position valid
-        nPos = Max( Min( nPos, GetPosCount() - 1L ), 0L );
+        nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)0 );
         Execute( CSVCMD_MAKEPOSVISIBLE, nPos );
 
         sal_uInt32 nColIx = GetColumnFromPos( nPos );
@@ -1354,7 +1354,7 @@ void ScCsvGrid::ImplDrawTrackingRect( sa
     if( HasFocus() && IsVisibleColumn( nColIndex ) )
     {
         sal_Int32 nX1 = Max( GetColumnX( nColIndex ), GetFirstX() ) + 1;
-        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - 1L, GetLastX() );
+        sal_Int32 nX2 = Min( GetColumnX( nColIndex + 1 ) - (sal_Int32)1, GetLastX() );
         sal_Int32 nY2 = Min( GetY( GetLastVisLine() + 1 ), GetHeight() ) - 1;
         InvertTracking( Rectangle( nX1, 0, nX2, nY2 ), SHOWTRACK_SMALL | SHOWTRACK_WINDOW );
     }
Index: sc/source/ui/dbgui/csvruler.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvruler.cxx,v
retrieving revision 1.9
retrieving revision 1.9.378.1
diff -u -p -u -r1.9 -r1.9.378.1
--- sc/source/ui/dbgui/csvruler.cxx	26 Mar 2003 18:05:52 -0000	1.9
+++ sc/source/ui/dbgui/csvruler.cxx	9 Sep 2004 11:02:30 -0000	1.9.378.1
@@ -231,7 +231,7 @@ sal_Int32 ScCsvRuler::GetNoScrollPos( sa
         else if( nNewPos > GetLastVisPos() - CSV_SCROLL_DIST - 1L )
         {
             sal_Int32 nScroll = (GetFirstVisPos() < GetMaxPosOffset()) ? CSV_SCROLL_DIST : 0;
-            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - 1L );
+            nNewPos = Min( nNewPos, GetLastVisPos() - nScroll - (sal_Int32)1 );
         }
     }
     return nNewPos;
@@ -374,7 +374,7 @@ void ScCsvRuler::MouseMove( const MouseE
         if( IsTracking() )
         {
             // on mouse tracking: keep position valid
-            nPos = Max( Min( nPos, GetPosCount() - 1L ), 1L );
+            nPos = Max( Min( nPos, GetPosCount() - (sal_Int32)1 ), (sal_Int32)1 );
             MoveMouseTracking( nPos );
         }
         else
@@ -513,7 +513,7 @@ void ScCsvRuler::ImplDrawArea( sal_Int32
 
     aRect = maActiveRect;
     aRect.Left() = Max( GetFirstX(), nPosX );
-    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - 1L );
+    aRect.Right() = Min( Min( GetX( GetPosCount() ), GetLastX() ), nPosX + nWidth - (sal_Int32)1 );
     if( aRect.Left() <= aRect.Right() )
     {
         maBackgrDev.SetFillColor( maActiveColor );
Index: sc/source/ui/dbgui/csvtablebox.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/dbgui/csvtablebox.cxx,v
retrieving revision 1.8
retrieving revision 1.7.378.2
diff -u -p -u -r1.8 -r1.7.378.2
--- sc/source/ui/dbgui/csvtablebox.cxx	23 Aug 2004 09:29:32 -0000	1.8
+++ sc/source/ui/dbgui/csvtablebox.cxx	19 Oct 2004 13:19:12 -0000	1.7.378.2
@@ -409,33 +409,33 @@ IMPL_LINK( ScCsvTableBox, CsvCmdHdl, ScC
     switch( eType )
     {
         case CSVCMD_SETPOSCOUNT:
-            maData.mnPosCount = Max( nParam1, 1L );
+            maData.mnPosCount = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETPOSOFFSET:
             ImplSetPosOffset( nParam1 );
         break;
         case CSVCMD_SETHDRWIDTH:
-            maData.mnHdrWidth = Max( nParam1, 0L );
+            maData.mnHdrWidth = Max( nParam1, (sal_Int32)0 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETCHARWIDTH:
-            maData.mnCharWidth = Max( nParam1, 1L );
+            maData.mnCharWidth = Max( nParam1, (sal_Int32)1 );
             ImplSetPosOffset( GetFirstVisPos() );
         break;
         case CSVCMD_SETLINECOUNT:
-            maData.mnLineCount = Max( nParam1, 1L );
+            maData.mnLineCount = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEOFFSET:
             ImplSetLineOffset( nParam1 );
         break;
         case CSVCMD_SETHDRHEIGHT:
-            maData.mnHdrHeight = Max( nParam1, 0L );
+            maData.mnHdrHeight = Max( nParam1, (sal_Int32)0 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_SETLINEHEIGHT:
-            maData.mnLineHeight = Max( nParam1, 1L );
+            maData.mnLineHeight = Max( nParam1, (sal_Int32)1 );
             ImplSetLineOffset( GetFirstVisLine() );
         break;
         case CSVCMD_MOVERULERCURSOR:
Index: sc/source/ui/inc/AccessibleDocument.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleDocument.hxx,v
retrieving revision 1.24
retrieving revision 1.24.42.1
diff -u -p -u -r1.24 -r1.24.42.1
--- sc/source/ui/inc/AccessibleDocument.hxx	4 Jun 2004 11:28:26 -0000	1.24
+++ sc/source/ui/inc/AccessibleDocument.hxx	9 Sep 2004 11:02:31 -0000	1.24.42.1
@@ -158,13 +158,13 @@ public:
 	///=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL
+    virtual sal_Int32 SAL_CALL
     	getAccessibleChildCount(void)
         throw (::com::sun::star::uno::RuntimeException);
 
     ///	Return the specified child or NULL if index is invalid.
     virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-    	getAccessibleChild(long nIndex)
+    	getAccessibleChild(sal_Int32 nIndex)
         throw (::com::sun::star::uno::RuntimeException,
 				::com::sun::star::lang::IndexOutOfBoundsException);
 
Index: sc/source/ui/inc/AccessibleDocumentPagePreview.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/AccessibleDocumentPagePreview.hxx,v
retrieving revision 1.9
retrieving revision 1.9.354.1
diff -u -p -u -r1.9 -r1.9.354.1
--- sc/source/ui/inc/AccessibleDocumentPagePreview.hxx	24 Apr 2003 17:14:38 -0000	1.9
+++ sc/source/ui/inc/AccessibleDocumentPagePreview.hxx	9 Sep 2004 11:02:31 -0000	1.9.354.1
@@ -105,7 +105,7 @@ public:
 	///=====  XAccessibleContext  ==============================================
 
     ///	Return the number of currently visible children.
-    virtual long SAL_CALL
+    virtual sal_Int32 SAL_CALL
     	getAccessibleChildCount(void)
         throw (::com::sun::star::uno::RuntimeException);
 
Index: sc/source/ui/inc/csvtablebox.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/csvtablebox.hxx,v
retrieving revision 1.5
retrieving revision 1.4.484.2
diff -u -p -u -r1.5 -r1.4.484.2
--- sc/source/ui/inc/csvtablebox.hxx	23 Aug 2004 09:33:53 -0000	1.5
+++ sc/source/ui/inc/csvtablebox.hxx	19 Oct 2004 12:49:53 -0000	1.4.484.2
@@ -143,10 +143,10 @@ private:
 
     /** Calculates and sets valid position offset nearest to nPos. */
     SC_DLLPRIVATE inline void                 ImplSetPosOffset( sal_Int32 nPos )
-                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), 0L ); }
+                                    { maData.mnPosOffset = Max( Min( nPos, GetMaxPosOffset() ), (sal_Int32)0 ); }
     /** Calculates and sets valid line offset nearest to nLine. */
     SC_DLLPRIVATE inline void                 ImplSetLineOffset( sal_Int32 nLine )
-                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), 0L ); }
+                                    { maData.mnLineOffset = Max( Min( nLine, GetMaxLineOffset() ), (sal_Int32)0 ); }
     /** Moves controls (not cursors!) so that nPos becomes visible. */
     SC_DLLPRIVATE void                        MakePosVisible( sal_Int32 nPos );
 
Index: sc/source/ui/inc/viewdata.hxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/inc/viewdata.hxx,v
retrieving revision 1.16
retrieving revision 1.14.42.2
diff -u -p -u -r1.16 -r1.14.42.2
--- sc/source/ui/inc/viewdata.hxx	8 Sep 2004 16:50:20 -0000	1.16
+++ sc/source/ui/inc/viewdata.hxx	19 Oct 2004 12:45:53 -0000	1.14.42.2
@@ -349,7 +349,7 @@ public:
 	BYTE			GetFillMode()				{ return nFillMode; }
 
 					// TRUE: Zelle ist zusammengefasst
-	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix );
+	BOOL			GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix );
 	BOOL			GetPosFromPixel( long nClickX, long nClickY, ScSplitPos eWhich,
 										SCsCOL& rPosX, SCsROW& rPosY,
 										BOOL bTestMerge = TRUE, BOOL bRepair = FALSE,
Index: sc/source/ui/view/gridwin.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin.cxx,v
retrieving revision 1.66
retrieving revision 1.55.36.2
diff -u -p -u -r1.66 -r1.55.36.2
--- sc/source/ui/view/gridwin.cxx	4 Oct 2004 20:23:28 -0000	1.66
+++ sc/source/ui/view/gridwin.cxx	19 Oct 2004 13:11:06 -0000	1.55.36.2
@@ -604,8 +604,8 @@ void ScGridWindow::DoPageFieldMenue( SCC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -759,8 +759,8 @@ void ScGridWindow::DoScenarioMenue( cons
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -902,8 +902,8 @@ void ScGridWindow::DoAutoFilterMenue( SC
 	SCTAB nTab = pViewData->GetTabNo();
 	BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
-	long nSizeX  = 0;
-	long nSizeY  = 0;
+	sal_Int32 nSizeX  = 0;
+	sal_Int32 nSizeY  = 0;
 	long nHeight = 0;
 	pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 	Point aPos = pViewData->GetScrPos( nCol, nRow, eWhich );
@@ -1443,8 +1443,8 @@ BOOL ScGridWindow::TestMouse( const Mous
 				SCROW nY = aMarkRange.aEnd.Row();
 
 				Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 				aFillPos.X() += nSizeXPix * nLayoutSign;
 				aFillPos.Y() += nSizeYPix;
@@ -1726,8 +1726,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 		if (pAttr->HasAutoFilter())
 		{
 			Point	aScrPos  = pViewData->GetScrPos(nPosX,nPosY,eWhich);
-			long	nSizeX;
-			long	nSizeY;
+			sal_Int32	nSizeX;
+			sal_Int32	nSizeY;
 			Point	aDiffPix = aPos;
 
 			aDiffPix -= aScrPos;
@@ -1739,8 +1739,8 @@ void __EXPORT ScGridWindow::MouseButtonD
 
 			//	Breite des Buttons ist nicht von der Zellhoehe abhaengig
 			Size aButSize = aComboButton.GetSizePixel();
-			long nButWidth  = Min( aButSize.Width(),  nSizeX );
-			long nButHeight = Min( aButSize.Height(), nSizeY );
+			long nButWidth  = Min( (sal_Int32)aButSize.Width(),  nSizeX );
+			long nButHeight = Min( (sal_Int32)aButSize.Height(), nSizeY );
 
 			if ( aDiffPix.X() >= nSizeX - nButWidth &&
 				 aDiffPix.Y() >= nSizeY - nButHeight )
@@ -2817,8 +2817,8 @@ void __EXPORT ScGridWindow::Command( con
 			SCCOL nCurX = pViewData->GetCurX();
 			SCROW nCurY = pViewData->GetCurY();
 			aMenuPos = pViewData->GetScrPos( nCurX, nCurY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nCurX, nCurY, nSizeXPix, nSizeYPix );
 			aMenuPos.X() += nSizeXPix;
 			aMenuPos.Y() += nSizeYPix;
@@ -4079,8 +4079,8 @@ void ScGridWindow::HideCursor()
 			SCROW nY = pViewData->GetCurY();
 
 			Point aScrPos = pViewData->GetScrPos( nX, nY, eWhich );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 			aScrPos.X() -= 2;
 			aScrPos.Y() -= 2;
@@ -4116,8 +4116,8 @@ void ScGridWindow::HideCursor()
 					SCCOL nAutoX = aAutoMarkPos.Col();
 					SCROW nAutoY = aAutoMarkPos.Row();
 					Point aFillPos = pViewData->GetScrPos( nAutoX, nAutoY, eWhich, TRUE );
-					long nSizeXPix;
-					long nSizeYPix;
+					sal_Int32 nSizeXPix;
+					sal_Int32 nSizeYPix;
 					pViewData->GetMergeSizePixel( nAutoX, nAutoY, nSizeXPix, nSizeYPix );
 					aFillPos.X() += nSizeXPix;
 					aFillPos.Y() += nSizeYPix;
@@ -4225,8 +4225,8 @@ BOOL ScGridWindow::HitRangeFinder( const
 //			Point aNext = pViewData->GetScrPos( nPosX+1, nPosY+1, eWhich );
 
 			Point aNext = pViewData->GetScrPos( nPosX, nPosY, eWhich, TRUE );
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nPosX, nPosY, nSizeXPix, nSizeYPix );
 			aNext.X() += nSizeXPix * nLayoutSign;
 			aNext.Y() += nSizeYPix;
Index: sc/source/ui/view/gridwin4.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/gridwin4.cxx,v
retrieving revision 1.26
retrieving revision 1.23.40.2
diff -u -p -u -r1.26 -r1.23.40.2
--- sc/source/ui/view/gridwin4.cxx	4 Oct 2004 20:23:40 -0000	1.26
+++ sc/source/ui/view/gridwin4.cxx	19 Oct 2004 13:13:29 -0000	1.23.40.2
@@ -1253,8 +1253,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 						}
 
                     bool bArrowState = bSimpleQuery && bColumnFound;
-					long	nSizeX;
-					long	nSizeY;
+					sal_Int32	nSizeX;
+					sal_Int32	nSizeY;
 
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					aComboButton.SetOptSizePixel();
@@ -1277,8 +1277,8 @@ void ScGridWindow::DrawButtons( SCCOL nX
 				if ( pInfo->bPushButton && !pInfo->bHOverlapped && !pInfo->bVOverlapped )
 				{
 					Point aScrPos = pViewData->GetScrPos( nCol, nRow, eWhich );
-					long nSizeX;
-					long nSizeY;
+					sal_Int32 nSizeX;
+					sal_Int32 nSizeY;
 					pViewData->GetMergeSizePixel( nCol, nRow, nSizeX, nSizeY );
 					long nPosX = aScrPos.X();
 					long nPosY = aScrPos.Y();
@@ -1749,8 +1749,8 @@ void ScGridWindow::DrawCursor()
 		}
 		if ( bMaybeVisible )
 		{
-			long nSizeXPix;
-			long nSizeYPix;
+			sal_Int32 nSizeXPix;
+			sal_Int32 nSizeYPix;
 			pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 
 			if ( bLayoutRTL )
@@ -1797,8 +1797,8 @@ void ScGridWindow::DrawAutoFillMark()
 		BOOL bLayoutRTL = pDoc->IsLayoutRTL( nTab );
 
 		Point aFillPos = pViewData->GetScrPos( nX, nY, eWhich, TRUE );
-		long nSizeXPix;
-		long nSizeYPix;
+		sal_Int32 nSizeXPix;
+		sal_Int32 nSizeYPix;
 		pViewData->GetMergeSizePixel( nX, nY, nSizeXPix, nSizeYPix );
 		if ( bLayoutRTL )
 			aFillPos.X() -= nSizeXPix + 3;
Index: sc/source/ui/view/output2.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/output2.cxx,v
retrieving revision 1.42
retrieving revision 1.39.40.2
diff -u -p -u -r1.42 -r1.39.40.2
--- sc/source/ui/view/output2.cxx	20 Sep 2004 13:49:01 -0000	1.42
+++ sc/source/ui/view/output2.cxx	19 Oct 2004 13:04:58 -0000	1.39.40.2
@@ -1657,7 +1657,7 @@ void ScOutputData::DrawStrings( BOOL bPi
 						String aString = aVars.GetString();
 						if (bMetaFile || pFmtDevice != pDev || aZoomX != aZoomY)
 						{
-							long* pDX = new long[aString.Len()];
+							sal_Int32* pDX = new sal_Int32[aString.Len()];
 							pFmtDevice->GetTextArray( aString, pDX );
 
 							if ( !pRefDevice->GetConnectMetaFile() ||
Index: sc/source/ui/view/tabview3.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/tabview3.cxx,v
retrieving revision 1.43
retrieving revision 1.37.40.2
diff -u -p -u -r1.43 -r1.37.40.2
--- sc/source/ui/view/tabview3.cxx	4 Oct 2004 20:25:20 -0000	1.43
+++ sc/source/ui/view/tabview3.cxx	19 Oct 2004 13:03:56 -0000	1.37.40.2
@@ -590,8 +590,8 @@ void ScTabView::TestHintWindow()
 				 aPos.X() < aWinSize.Width() && aPos.Y() < aWinSize.Height() )
 			{
 				aPos += pWin->GetPosPixel();								// Position auf Frame
-				long nSizeXPix;
-				long nSizeYPix;
+				sal_Int32 nSizeXPix;
+				sal_Int32 nSizeYPix;
 				aViewData.GetMergeSizePixel( nCol, nRow, nSizeXPix, nSizeYPix );
 
 				// HintWindow anlegen, bestimmt seine Groesse selbst
@@ -737,8 +737,8 @@ void ScTabView::AlignToCursor( SCsCOL nC
 		SCsCOL nSizeX = (SCsCOL) aViewData.VisibleCellsX(eAlignX);
 		SCsROW nSizeY = (SCsROW) aViewData.VisibleCellsY(eAlignY);
 
-		long nCellSizeX;
-		long nCellSizeY;
+		sal_Int32 nCellSizeX;
+		sal_Int32 nCellSizeY;
 		if ( nCurX >= 0 && nCurY >= 0 )
 			aViewData.GetMergeSizePixel( (SCCOL)nCurX, (SCROW)nCurY, nCellSizeX, nCellSizeY );
 		else
@@ -781,7 +781,7 @@ void ScTabView::AlignToCursor( SCsCOL nC
 						{
 							//	Cursor ist auf dem Bildschirm
 							Point aStart = aViewData.GetScrPos( nCurX, nCurY, eAlign );
-							long nCSX, nCSY;
+							sal_Int32 nCSX, nCSY;
 							aViewData.GetMergeSizePixel( nCurX, nCurY, nCSX, nCSY );
 							Rectangle aCursor( aStart, Size( nCSX, nCSY ) );
 							if ( aCursor.IsOver( aDlgPixel ) )
Index: sc/source/ui/view/viewdata.cxx
===================================================================
RCS file: /cvs/sc/sc/source/ui/view/viewdata.cxx,v
retrieving revision 1.48
retrieving revision 1.45.42.2
diff -u -p -u -r1.48 -r1.45.42.2
--- sc/source/ui/view/viewdata.cxx	4 Oct 2004 20:27:23 -0000	1.48
+++ sc/source/ui/view/viewdata.cxx	19 Oct 2004 13:03:17 -0000	1.45.42.2
@@ -1631,7 +1631,7 @@ SCROW ScViewData::LastCellsY( ScVSplitPo
 	return CellsAtY( MAXROW+1, -1, eWhichY, SC_SIZE_NONE );
 }
 
-BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, long& rSizeXPix, long& rSizeYPix )
+BOOL ScViewData::GetMergeSizePixel( SCCOL nX, SCROW nY, sal_Int32& rSizeXPix, sal_Int32& rSizeYPix )
 {
 	const ScMergeAttr* pMerge = (const ScMergeAttr*) pDoc->GetAttr( nX,nY,nTabNo, ATTR_MERGE );
 	if ( pMerge->GetColMerge() > 1 || pMerge->GetRowMerge() > 1 )
@@ -1783,8 +1783,8 @@ void ScViewData::GetMouseQuadrant( const
 	long nLayoutSign = bLayoutRTL ? -1 : 1;
 
 	Point aCellStart = GetScrPos( nPosX, nPosY, eWhich, TRUE );
-	long nSizeX;
-	long nSizeY;
+	sal_Int32 nSizeX;
+	sal_Int32 nSizeY;
 	GetMergeSizePixel( nPosX, nPosY, nSizeX, nSizeY );
 	rLeft = ( rClickPos.X() - aCellStart.X() ) * nLayoutSign <= nSizeX / 2;
 	rTop  = rClickPos.Y() - aCellStart.Y() <= nSizeY / 2;
