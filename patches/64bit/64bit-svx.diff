Index: svx/inc/editeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/editeng.hxx,v
retrieving revision 1.42
retrieving revision 1.41.138.2
diff -u -p -r1.42 -r1.41.138.2
--- svx/inc/editeng.hxx	17 Sep 2004 14:10:29 -0000	1.42
+++ svx/inc/editeng.hxx	19 Oct 2004 17:02:50 -0000	1.41.138.2
@@ -450,7 +450,7 @@ public:
 	virtual	void	ParagraphHeightChanged( USHORT nPara );
 
 	// #101498#
-	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
+	virtual void	DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	virtual String	GetUndoComment( USHORT nUndoId ) const;
 	virtual BOOL	FormattingParagraph( USHORT nPara );
Index: svx/inc/lrspitem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/lrspitem.hxx,v
retrieving revision 1.4
retrieving revision 1.4.854.1
diff -u -p -r1.4 -r1.4.854.1
--- svx/inc/lrspitem.hxx	9 Jul 2001 20:08:43 -0000	1.4
+++ svx/inc/lrspitem.hxx	9 Sep 2004 09:39:55 -0000	1.4.854.1
@@ -123,8 +123,8 @@ public:
 	TYPEINFO();
 
 	SvxLRSpaceItem( const USHORT nId = ITEMID_LRSPACE );
-	SvxLRSpaceItem( const long nLeft, const long nRight,
-					const long nTLeft = 0, const short nOfset = 0,
+	SvxLRSpaceItem( const sal_Int32 nLeft, const sal_Int32 nRight,
+					const sal_Int32 nTLeft = 0, const short nOfset = 0,
 					const USHORT nId = ITEMID_LRSPACE );
 	inline SvxLRSpaceItem& operator=( const SvxLRSpaceItem &rCpy );
 
Index: svx/inc/msdffimp.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/msdffimp.hxx,v
retrieving revision 1.21
retrieving revision 1.20.98.2
diff -u -p -r1.21 -r1.20.98.2
--- svx/inc/msdffimp.hxx	4 Oct 2004 17:44:20 -0000	1.21
+++ svx/inc/msdffimp.hxx	19 Oct 2004 16:54:38 -0000	1.20.98.2
@@ -567,7 +567,7 @@ public:
 
 	void SetModel(SdrModel* pModel, long nApplicationScale);
 	SdrModel*  GetModel() const { return pSdrModel; }
-	void Scale(long& rVal) const;
+	void Scale(sal_Int32& rVal) const;
 	void Scale(Point& rPos) const;
 	void Scale(Size& rSiz) const;
 	void Scale(Rectangle& rRect) const;
@@ -575,7 +575,7 @@ public:
 	void Scale(PolyPolygon& rPoly) const;
 	void Scale(XPolygon& rPoly) const;
 	void Scale(XPolyPolygon& rPoly) const;
-	void ScaleEmu(long& rVal) const;
+	void ScaleEmu(sal_Int32& rVal) const;
 	UINT32 ScalePt( UINT32 nPt ) const;
 	INT32 ScalePoint( INT32 nVal ) const;
 
Index: svx/inc/outliner.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/outliner.hxx,v
retrieving revision 1.48
retrieving revision 1.46.138.2
diff -u -p -r1.48 -r1.46.138.2
--- svx/inc/outliner.hxx	17 Sep 2004 14:11:10 -0000	1.48
+++ svx/inc/outliner.hxx	19 Oct 2004 17:11:40 -0000	1.46.138.2
@@ -434,7 +434,7 @@ public:
 
     const SvxFont&  rFont;
 
-    const long*     pDXArray;
+    const sal_Int32*     pDXArray;
 
 	// #101498# BiDi level needs to be transported, too.
 	BYTE			mnBiDiLevel;
@@ -443,7 +443,7 @@ public:
 	sal_Bool IsRTL() const;
 
     DrawPortionInfo( const Point& rPos, const String& rTxt, USHORT nTxtStart, USHORT nTxtLen,
-		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const long* pDXArr, BYTE nBiDiLevel)
+		const SvxFont& rFnt, USHORT nPar, xub_StrLen nIdx, const sal_Int32* pDXArr, BYTE nBiDiLevel)
         :	rStartPos(rPos), rText(rTxt), nPara(nPar), nIndex(nIdx), 
 			rFont(rFnt), pDXArray(pDXArr), mnBiDiLevel(nBiDiLevel)
 	    {
@@ -822,7 +822,7 @@ public:
 
 	// #101498#
 	virtual void    DrawingText( const Point& rStartPos, const String& rText, USHORT nTextStart, USHORT nTextLen,
-						const long* pDXArray, const SvxFont& rFont,
+						const sal_Int32* pDXArray, const SvxFont& rFont,
 						USHORT nPara, xub_StrLen nIndex, BYTE nRightToLeft);
 
 	Size            CalcTextSize();
Index: svx/inc/rulritem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/rulritem.hxx,v
retrieving revision 1.6
retrieving revision 1.6.222.1
diff -u -p -r1.6 -r1.6.222.1
--- svx/inc/rulritem.hxx	26 Feb 2004 11:44:14 -0000	1.6
+++ svx/inc/rulritem.hxx	9 Sep 2004 09:39:56 -0000	1.6.222.1
@@ -225,7 +225,7 @@ typedef SvPtrarr SvxColumns;
 class SvxColumnItem : public SfxPoolItem
 {
 	SvxColumns aColumns;// Spaltenarray
-	long	nLeft,		// Linker Rand bei Tabelle
+	sal_Int32	nLeft,		// Linker Rand bei Tabelle
 		   nRight;		// Rechter Rand bei Tabelle; bei Spalten immer gleich
 						// zum umgebenden Rahmen
 	USHORT nActColumn;	// die aktuelle Spalte
@@ -293,10 +293,10 @@ public:
 class SvxObjectItem : public SfxPoolItem
 {
 private:
-	long   nStartX;					   /* Beginn in X-Richtung */
-	long   nEndX;					   /* Ende in X-Richtung */
-	long   nStartY;                    /* Beginn in Y-Richtung */
-	long   nEndY;                      /* Ende in Y-Richtung */
+	sal_Int32   nStartX;					   /* Beginn in X-Richtung */
+	sal_Int32   nEndX;					   /* Ende in X-Richtung */
+	sal_Int32   nStartY;                    /* Beginn in Y-Richtung */
+	sal_Int32   nEndY;                      /* Ende in Y-Richtung */
 	BOOL   bLimits;					   /* Grenzwertkontrolle durch die Applikation */
 protected:
 	virtual int 			 operator==( const SfxPoolItem& ) const;
@@ -321,10 +321,10 @@ public:
 
 	BOOL   HasLimits() const { return bLimits; }
 
-	long   GetStartX() const { return nStartX; }
-	long   GetEndX() const { return nEndX; }
-	long   GetStartY() const { return nStartY; }
-	long   GetEndY() const { return nEndY; }
+	sal_Int32   GetStartX() const { return nStartX; }
+	sal_Int32   GetEndX() const { return nEndX; }
+	sal_Int32   GetStartY() const { return nStartY; }
+	sal_Int32   GetEndY() const { return nEndY; }
 
 	void   SetStartX(long l) { nStartX = l; }
 	void   SetEndX(long l) { nEndX = l; }
Index: svx/inc/svdmodel.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/svdmodel.hxx,v
retrieving revision 1.44
retrieving revision 1.42.108.2
diff -u -p -r1.44 -r1.42.108.2
--- svx/inc/svdmodel.hxx	4 Oct 2004 17:45:08 -0000	1.44
+++ svx/inc/svdmodel.hxx	19 Oct 2004 16:52:58 -0000	1.42.108.2
@@ -418,10 +418,10 @@ public:
 	// Zeichenobjekte verwenden moechte. Setzt man degegen nur vom abstrakten
 	// Basisobjekt SdrObject abgeleitete Objekte ein, so ist man frei in der
 	// Wahl des Pools.
-	SdrModel(SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(const String& rPath, SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts = LOADREFCOUNTS);
-	SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(const String& rPath, SfxItemPool* pPool=NULL, SfxObjectShell* pPers=NULL, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
+	SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts = LOADREFCOUNTS);
 	virtual ~SdrModel();
 
 	// #116168#
Index: svx/inc/svxfont.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/svxfont.hxx,v
retrieving revision 1.2
retrieving revision 1.2.848.1
diff -u -p -r1.2 -r1.2.848.1
--- svx/inc/svxfont.hxx	16 Aug 2001 15:41:26 -0000	1.2
+++ svx/inc/svxfont.hxx	9 Sep 2004 09:39:56 -0000	1.2.848.1
@@ -145,10 +145,10 @@ public:
 			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN ) const;
 
 	void QuickDrawText( OutputDevice *pOut, const Point &rPos, const String &rTxt,
-			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const long* pDXArray = NULL ) const;
+			   const USHORT nIdx = 0, const USHORT nLen = STRING_LEN, const sal_Int32* pDXArray = NULL ) const;
 
 	Size QuickGetTextSize( const OutputDevice *pOut, const String &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray = NULL ) const;
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray = NULL ) const;
 
 	void DrawPrev( OutputDevice* pOut, Printer* pPrinter,
 				   const Point &rPos, const String &rTxt,
Index: svx/inc/tstpitem.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/tstpitem.hxx,v
retrieving revision 1.4
retrieving revision 1.4.676.1
diff -u -p -r1.4 -r1.4.676.1
--- svx/inc/tstpitem.hxx	27 Mar 2003 14:59:52 -0000	1.4
+++ svx/inc/tstpitem.hxx	9 Sep 2004 09:39:56 -0000	1.4.676.1
@@ -84,7 +84,7 @@
 class SvxTabStop
 {
 private:
-	long            nTabPos;
+	sal_Int32            nTabPos;
 
 	SvxTabAdjust    eAdjustment;
 	sal_Unicode		cDecimal;
@@ -106,8 +106,8 @@ public:
 				const sal_Unicode cFil = cDfltFillChar );
 #endif
 
-	long&           GetTabPos() { return nTabPos; }
-	long            GetTabPos() const { return nTabPos; }
+	sal_Int32&           GetTabPos() { return nTabPos; }
+	sal_Int32            GetTabPos() const { return nTabPos; }
 
 	SvxTabAdjust&   GetAdjustment() { return eAdjustment; }
 	SvxTabAdjust    GetAdjustment() const { return eAdjustment; }
Index: svx/inc/xhatch.hxx
===================================================================
RCS file: /cvs/graphics/svx/inc/xhatch.hxx,v
retrieving revision 1.2
retrieving revision 1.2.298.1
diff -u -p -r1.2 -r1.2.298.1
--- svx/inc/xhatch.hxx	6 Jan 2004 15:23:00 -0000	1.2
+++ svx/inc/xhatch.hxx	9 Sep 2004 09:39:56 -0000	1.2.298.1
@@ -77,8 +77,8 @@ class XHatch
 protected:
 	XHatchStyle		eStyle;
 	Color			aColor;
-	long			nDistance;
-	long			nAngle;
+	sal_Int32		nDistance;
+	sal_Int32			nAngle;
 
 public:
 					XHatch() {}
@@ -94,8 +94,8 @@ public:
 
 	XHatchStyle		GetHatchStyle() const { return eStyle; }
 	Color			GetColor() const { return aColor; }
-	long			GetDistance() const { return nDistance; }
-	long			GetAngle() const { return nAngle; }
+	sal_Int32			GetDistance() const { return nDistance; }
+	sal_Int32			GetAngle() const { return nAngle; }
 };
 
 #endif
Index: svx/source/accessibility/AccessibleContextBase.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleContextBase.cxx,v
retrieving revision 1.20
retrieving revision 1.20.642.1
diff -u -p -r1.20 -r1.20.642.1
--- svx/source/accessibility/AccessibleContextBase.cxx	24 Apr 2003 16:52:52 -0000	1.20
+++ svx/source/accessibility/AccessibleContextBase.cxx	9 Sep 2004 09:39:57 -0000	1.20.642.1
@@ -287,7 +287,7 @@ sal_Int32 SAL_CALL
     an exception for a wrong index.
 */
 uno::Reference<XAccessible> SAL_CALL
-    AccessibleContextBase::getAccessibleChild (long nIndex)
+    AccessibleContextBase::getAccessibleChild (sal_Int32 nIndex)
     throw (::com::sun::star::lang::IndexOutOfBoundsException, ::com::sun::star::uno::RuntimeException)
 {
     ThrowIfDisposed ();
Index: svx/source/accessibility/AccessibleShape.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleShape.cxx,v
retrieving revision 1.44
retrieving revision 1.44.222.1
diff -u -p -r1.44 -r1.44.222.1
--- svx/source/accessibility/AccessibleShape.cxx	26 Feb 2004 13:46:25 -0000	1.44
+++ svx/source/accessibility/AccessibleShape.cxx	9 Sep 2004 09:39:57 -0000	1.44.222.1
@@ -1175,7 +1175,7 @@ void AccessibleShape::ViewForwarderChang
     // of the same type.  If such an index where not given to the
     // constructor then use the z-order instead.  If even that does not exist
     // we throw an exception.
-    long nIndex = mnIndex;
+    sal_Int32 nIndex = mnIndex;
     if (nIndex == -1)
     {
         try
Index: svx/source/accessibility/AccessibleStringWrap.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/AccessibleStringWrap.cxx,v
retrieving revision 1.3
retrieving revision 1.3.642.1
diff -u -p -r1.3 -r1.3.642.1
--- svx/source/accessibility/AccessibleStringWrap.cxx	24 Apr 2003 16:55:35 -0000	1.3
+++ svx/source/accessibility/AccessibleStringWrap.cxx	9 Sep 2004 09:39:57 -0000	1.3.642.1
@@ -104,7 +104,7 @@ sal_Bool AccessibleStringWrap::GetCharac
     }
     else
     {
-        long aXArray[2];
+        sal_Int32 aXArray[2];
         mrDev.GetCaretPositions( maText, aXArray, static_cast< USHORT >(nIndex), 1 );
         rRect.Left() = 0;
         rRect.Top() = 0;
Index: svx/source/accessibility/DGColorNameLookUp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/DGColorNameLookUp.cxx,v
retrieving revision 1.2
retrieving revision 1.2.600.1
diff -u -p -r1.2 -r1.2.600.1
--- svx/source/accessibility/DGColorNameLookUp.cxx	26 May 2003 09:05:12 -0000	1.2
+++ svx/source/accessibility/DGColorNameLookUp.cxx	9 Sep 2004 09:39:57 -0000	1.2.600.1
@@ -112,7 +112,7 @@ DGColorNameLookUp& DGColorNameLookUp::In
 
 
 
-OUString DGColorNameLookUp::LookUpColor (long int nColor) const
+OUString DGColorNameLookUp::LookUpColor (sal_Int32 nColor) const
 {
     OUString sColorName;
     tColorValueToNameMap::const_iterator I;
@@ -172,7 +172,7 @@ DGColorNameLookUp::DGColorNameLookUp (vo
             try
             {
                 uno::Any aColor (xNA->getByName (aNames[i]));
-                long nColor;
+                sal_Int32 nColor;
                 aColor >>= nColor;
                 maColorValueToNameMap[nColor] = aNames[i];
             }
Index: svx/source/accessibility/DescriptionGenerator.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/accessibility/DescriptionGenerator.cxx,v
retrieving revision 1.6
retrieving revision 1.6.600.1
diff -u -p -r1.6 -r1.6.600.1
--- svx/source/accessibility/DescriptionGenerator.cxx	26 May 2003 09:05:24 -0000	1.6
+++ svx/source/accessibility/DescriptionGenerator.cxx	9 Sep 2004 09:39:58 -0000	1.6.600.1
@@ -354,7 +354,7 @@ void DescriptionGenerator::AddColor (con
     try
     {
         
-        long nValue;
+        sal_Int32 nValue;
         if (mxSet.is())
         {
             uno::Any aValue = mxSet->getPropertyValue (sPropertyName);
@@ -394,7 +394,7 @@ void DescriptionGenerator::AddInteger (c
         if (mxSet.is())
         {
             uno::Any aValue = mxSet->getPropertyValue (sPropertyName);
-            long nValue;
+            sal_Int32 nValue;
             aValue >>= nValue;
             msDescription.append (nValue);
         }
#Index: svx/source/customshapes/EnhancedCustomShapeFontWork.cxx
#===================================================================
#RCS file: /cvs/graphics/svx/source/customshapes/EnhancedCustomShapeFontWork.cxx,v
#retrieving revision 1.2
#retrieving revision 1.2.174.1
#diff -u -p -r1.2 -r1.2.174.1
#--- svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	2 Apr 2004 14:03:55 -0000	1.2
#+++ svx/source/customshapes/EnhancedCustomShapeFontWork.cxx	9 Sep 2004 09:39:58 -0000	1.2.174.1
#@@ -305,7 +305,7 @@ void GetTextAreaOutline( const FWData& r
# 				{
# 					rtl::OUString aCharText( (sal_Unicode)rText[ i ] );
# 					sal_Int32 nWidth = 0;
#-					const long* pDXArry = NULL;
#+					const sal_Int32* pDXArry = NULL;
# 
# 					if ( aVirDev.GetTextOutlines( aParagraphDataIter->vOutlines, aCharText, 0, 0, STRING_LEN, TRUE, nWidth, pDXArry ) )
# 					{
#@@ -323,7 +323,7 @@ void GetTextAreaOutline( const FWData& r
# 			else
# 			{
# 				sal_Int32 nWidth = 0;
#-				const long* pDXArry = NULL;
#+				const sal_Int32* pDXArry = NULL;
# 
# 				if ( aVirDev.GetTextOutlines( aParagraphDataIter->vOutlines, rText, 0, 0, STRING_LEN, TRUE, nWidth, pDXArry ) )
# 				{
Index: svx/source/dialog/optdict.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optdict.cxx,v
retrieving revision 1.3
retrieving revision 1.3.110.1
diff -u -p -r1.3 -r1.3.110.1
--- svx/source/dialog/optdict.cxx	10 May 2004 16:53:05 -0000	1.3
+++ svx/source/dialog/optdict.cxx	9 Sep 2004 09:39:59 -0000	1.3.110.1
@@ -610,8 +610,8 @@ void SvxEditDictionaryDialog::ShowWords_
 
 	if (aWordsLB.GetEntryCount())
 	{
-		aWordED	  .SetText( aWordsLB.GetEntryText(0LU, 0) );
-		aReplaceED.SetText( aWordsLB.GetEntryText(0LU, 1) );
+		aWordED	  .SetText( aWordsLB.GetEntryText(0U, 0) );
+		aReplaceED.SetText( aWordsLB.GetEntryText(0U, 1) );
 	}
 
 	LeaveWait();
Index: svx/source/dialog/optmemory.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optmemory.cxx,v
retrieving revision 1.5
retrieving revision 1.4.130.2
diff -u -p -r1.5 -r1.4.130.2
--- svx/source/dialog/optmemory.cxx	20 Aug 2004 09:02:03 -0000	1.5
+++ svx/source/dialog/optmemory.cxx	19 Oct 2004 18:41:06 -0000	1.4.130.2
@@ -201,34 +201,34 @@ using namespace ::sfx2;
 #define BYTES2NF		(1.0/NF2BYTES)					// 10/2^20
 
 
-inline long OfaMemoryOptionsPage::GetNfGraphicCacheVal( void ) const
+inline sal_Size OfaMemoryOptionsPage::GetNfGraphicCacheVal( void ) const
 {
 	return aNfGraphicCache.GetValue() << 20;
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicCacheVal( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicCacheVal( sal_Size nSizeInBytes )
 {
 	aNfGraphicCache.SetValue( nSizeInBytes >> 20 );
 }
 
-long OfaMemoryOptionsPage::GetNfGraphicObjectCacheVal( void ) const
+sal_Size OfaMemoryOptionsPage::GetNfGraphicObjectCacheVal( void ) const
 {
-	return long( ::rtl::math::round( double( aNfGraphicObjectCache.GetValue() ) * NF2BYTES ) );
+	return sal_Size( ::rtl::math::round( double( aNfGraphicObjectCache.GetValue() ) * NF2BYTES ) );
 }
 
-void OfaMemoryOptionsPage::SetNfGraphicObjectCacheVal( long nSizeInBytes )
+void OfaMemoryOptionsPage::SetNfGraphicObjectCacheVal( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetValue( long( ::rtl::math::round( double( nSizeInBytes ) * BYTES2NF ) ) );
+	aNfGraphicObjectCache.SetValue( sal_Size( ::rtl::math::round( double( nSizeInBytes ) * BYTES2NF ) ) );
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheMax( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheMax( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetMax( long( double( nSizeInBytes ) * BYTES2NF ) );
+	aNfGraphicObjectCache.SetMax( sal_Size( double( nSizeInBytes ) * BYTES2NF ) );
 }
 
-inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheLast( long nSizeInBytes )
+inline void OfaMemoryOptionsPage::SetNfGraphicObjectCacheLast( sal_Size nSizeInBytes )
 {
-	aNfGraphicObjectCache.SetLast( long( double( nSizeInBytes ) * BYTES2NF ) );
+	aNfGraphicObjectCache.SetLast( sal_Size( double( nSizeInBytes ) * BYTES2NF ) );
 }
 
 int OfaMemoryOptionsPage::DeactivatePage( SfxItemSet* pSet )
@@ -343,7 +343,7 @@ void OfaMemoryOptionsPage::Reset( const 
     aUndoEdit.SaveValue();
 
     // GraphicCache
-	long	n = aCacheOptions.GetGraphicManagerTotalCacheSize();
+	sal_Int32	n = aCacheOptions.GetGraphicManagerTotalCacheSize();
 	SetNfGraphicCacheVal( n );
 	SetNfGraphicObjectCacheVal( Min( GetNfGraphicCacheVal(), aCacheOptions.GetGraphicManagerObjectCacheSize() ) );
 
@@ -365,7 +365,7 @@ void OfaMemoryOptionsPage::Reset( const 
 
 IMPL_LINK( OfaMemoryOptionsPage, GraphicCacheConfigHdl, NumericField*, pEd )
 {
-	long	n = GetNfGraphicCacheVal();
+	sal_Int32	n = GetNfGraphicCacheVal();
 	SetNfGraphicObjectCacheMax( n );
 	SetNfGraphicObjectCacheLast( n );
 
Index: svx/source/dialog/optmemory.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/optmemory.hxx,v
retrieving revision 1.3
retrieving revision 1.3.264.1
diff -u -p -r1.3 -r1.3.264.1
--- svx/source/dialog/optmemory.hxx	11 Feb 2004 16:40:13 -0000	1.3
+++ svx/source/dialog/optmemory.hxx	9 Sep 2004 09:39:59 -0000	1.3.264.1
@@ -110,13 +110,13 @@ private:
 
 	DECL_LINK( GraphicCacheConfigHdl, NumericField* );
 
-	inline long			GetNfGraphicCacheVal( void ) const;					// returns # of Bytes
-	inline void			SetNfGraphicCacheVal( long nSizeInBytes );
+	inline sal_Size			GetNfGraphicCacheVal( void ) const;					// returns # of Bytes
+	inline void			SetNfGraphicCacheVal( sal_Size nSizeInBytes );
 
-	long				GetNfGraphicObjectCacheVal( void ) const;			// returns # of Bytes
-	void				SetNfGraphicObjectCacheVal( long nSizeInBytes );
-	inline void			SetNfGraphicObjectCacheMax( long nSizeInBytes );
-	inline void			SetNfGraphicObjectCacheLast( long nSizeInBytes );
+	sal_Size				GetNfGraphicObjectCacheVal( void ) const;			// returns # of Bytes
+	void				SetNfGraphicObjectCacheVal( sal_Size nSizeInBytes );
+	inline void			SetNfGraphicObjectCacheMax( sal_Size nSizeInBytes );
+	inline void			SetNfGraphicObjectCacheLast( sal_Size nSizeInBytes );
 protected:
 	virtual int         DeactivatePage( SfxItemSet* pSet = NULL );
 
Index: svx/source/dialog/tpline.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/tpline.cxx,v
retrieving revision 1.26
retrieving revision 1.23.270.2
diff -u -p -r1.26 -r1.23.270.2
--- svx/source/dialog/tpline.cxx	4 Oct 2004 17:49:48 -0000	1.26
+++ svx/source/dialog/tpline.cxx	19 Oct 2004 18:21:11 -0000	1.23.270.2
@@ -1035,7 +1035,7 @@ void SvxLineTabPage::Reset( const SfxIte
 		VirtualDevice aVDev;
 		aVDev.SetMapMode(MapMode(MAP_100TH_MM));
 
-		SdrModel* pModel = new SdrModel(NULL, NULL, LOADREFCOUNTS);
+		SdrModel* pModel = new SdrModel((SfxItemPool*)NULL, (SfxObjectShell*)NULL, (sal_Bool)LOADREFCOUNTS);
 		pModel->GetItemPool().FreezeIdRanges();
 		SdrPage* pPage = new SdrPage( *pModel, FALSE );
 		pPage->SetSize(Size(1000,1000));
Index: svx/source/dialog/transfrm.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/transfrm.cxx,v
retrieving revision 1.17
retrieving revision 1.15.316.2
diff -u -p -r1.17 -r1.15.316.2
--- svx/source/dialog/transfrm.cxx	12 Jul 2004 14:34:50 -0000	1.17
+++ svx/source/dialog/transfrm.cxx	19 Oct 2004 18:37:40 -0000	1.15.316.2
@@ -1303,8 +1303,8 @@ int SvxPositionSizeTabPage::DeactivatePa
 {
 	if( pSet )
 	{
-		INT32 lX = maMtrPosX.GetValue();
-		INT32 lY = maMtrPosY.GetValue();
+		long lX = maMtrPosX.GetValue();
+		long lY = maMtrPosY.GetValue();
 
 		// #106330#
 		// The below BugFix assumed that GetTopLeftPosition()
@@ -1599,7 +1599,7 @@ void SvxPositionSizeTabPage::SetMinMaxPo
 
 //------------------------------------------------------------------------
 
-void SvxPositionSizeTabPage::GetTopLeftPosition( INT32& rX, INT32& rY,
+void SvxPositionSizeTabPage::GetTopLeftPosition( long& rX, long& rY,
 												const Rectangle& rRect )
 {
 	switch ( maCtlPos.GetActualRP() )
Index: svx/source/dialog/transfrm.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/dialog/transfrm.hxx,v
retrieving revision 1.3
retrieving revision 1.2.270.2
diff -u -p -r1.3 -r1.2.270.2
--- svx/source/dialog/transfrm.hxx	28 Jun 2004 14:07:02 -0000	1.3
+++ svx/source/dialog/transfrm.hxx	19 Oct 2004 18:45:16 -0000	1.2.270.2
@@ -185,7 +185,7 @@ private:
 //  DECL_LINK( SetOrientHdl, ListBox * );
 
 	void SetMinMaxPosition();
-	void GetTopLeftPosition( INT32& rX, INT32& rY, const Rectangle& rRect );
+	void GetTopLeftPosition( long& rX, long& rY, const Rectangle& rRect );
 #endif
 
 #if _SOLAR__PRIVATE
Index: svx/source/editeng/editdoc.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc.hxx,v
retrieving revision 1.20
retrieving revision 1.20.364.1
diff -u -p -r1.20 -r1.20.364.1
--- svx/source/editeng/editdoc.hxx	1 Sep 2003 12:00:48 -0000	1.20
+++ svx/source/editeng/editdoc.hxx	9 Sep 2004 09:40:00 -0000	1.20.364.1
@@ -484,7 +484,7 @@ public:
 
 class ParaPortion;
 
-SV_DECL_VARARR( CharPosArray, long, 0, CHARPOSGROW );
+SV_DECL_VARARR( CharPosArray, sal_Int32, 0, CHARPOSGROW );
 
 // ------------------------------------------------------------------------
 // class EditLine
Index: svx/source/editeng/editdoc2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editdoc2.cxx,v
retrieving revision 1.11
retrieving revision 1.11.826.1
diff -u -p -r1.11 -r1.11.826.1
--- svx/source/editeng/editdoc2.cxx	28 Aug 2002 15:20:19 -0000	1.11
+++ svx/source/editeng/editdoc2.cxx	9 Sep 2004 09:40:00 -0000	1.11.826.1
@@ -98,7 +98,7 @@
 
 DBG_NAME( EE_ParaPortion );
 
-SV_IMPL_VARARR( CharPosArray, long );
+SV_IMPL_VARARR( CharPosArray, sal_Int32 );
 
 /*
 
Index: svx/source/editeng/editeng.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/editeng.cxx,v
retrieving revision 1.91
retrieving revision 1.90.138.2
diff -u -p -r1.91 -r1.90.138.2
--- svx/source/editeng/editeng.cxx	17 Sep 2004 14:15:19 -0000	1.91
+++ svx/source/editeng/editeng.cxx	19 Oct 2004 17:56:55 -0000	1.90.138.2
@@ -2404,7 +2404,7 @@ ParagraphInfos EditEngine::GetParagraphI
 // =====================================================================
 // ======================   Virtuelle Methoden   =======================
 // =====================================================================
-void __EXPORT EditEngine::DrawingText( const Point&, const XubString&, USHORT nTextStart, USHORT nTextLen, const long*, const SvxFont&, sal_uInt16 nPara, sal_uInt16 nIndex, BYTE nRightToLeft )
+void __EXPORT EditEngine::DrawingText( const Point&, const XubString&, USHORT nTextStart, USHORT nTextLen, const sal_Int32*, const SvxFont&, sal_uInt16 nPara, sal_uInt16 nIndex, BYTE nRightToLeft )
 {
 	DBG_CHKTHIS( EditEngine, 0 );
 }
Index: svx/source/editeng/impedit2.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit2.cxx,v
retrieving revision 1.96
retrieving revision 1.95.138.2
diff -u -p -r1.96 -r1.95.138.2
--- svx/source/editeng/impedit2.cxx	17 Sep 2004 14:16:02 -0000	1.96
+++ svx/source/editeng/impedit2.cxx	19 Oct 2004 17:57:48 -0000	1.95.138.2
@@ -3832,7 +3832,7 @@ long ImpEditEngine::GetXPos( ParaPortion
                     if ( nType == CHAR_PUNCTUATIONRIGHT )
                     {
                         USHORT n = nIndex - nTextPortionStart;
-                        const long* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
+                        const sal_Int32* pDXArray = pLine->GetCharPosArray().GetData()+( nTextPortionStart-pLine->GetStart() );
                         long nCharWidth = ( ( (n+1) < pPortion->GetLen() ) ? pDXArray[n] : pPortion->GetSize().Width() )
                                                         - ( n ? pDXArray[n-1] : 0 );
                         if ( (n+1) < pPortion->GetLen() )
Index: svx/source/editeng/impedit3.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit3.cxx,v
retrieving revision 1.92
retrieving revision 1.91.220.2
diff -u -p -r1.92 -r1.91.220.2
--- svx/source/editeng/impedit3.cxx	8 Sep 2004 16:16:54 -0000	1.92
+++ svx/source/editeng/impedit3.cxx	19 Oct 2004 17:57:56 -0000	1.91.220.2
@@ -208,7 +208,7 @@ BYTE GetCharTypeForCompression( xub_Unic
     }
 }
 
-void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const long* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
+void lcl_DrawRedLines( OutputDevice* pOutDev, long nFontHeight, const Point& rPnt, sal_uInt16 nIndex, sal_uInt16 nMaxEnd, const sal_Int32* pDXArray, WrongList* pWrongs, short nOrientation, const Point& rOrigin, BOOL bVertical )
 {
 #ifndef SVX_LIGHT
 	// Aber nur, wenn Font nicht zu klein...
@@ -770,7 +770,7 @@ sal_Bool ImpEditEngine::CreateLines( USH
 	SvxFont aTmpFont( pNode->GetCharAttribs().GetDefFont() );
 
 	sal_Bool bCalcCharPositions = sal_True;
-	long* pBuf = new long[ pNode->Len() ];
+	sal_Int32* pBuf = new sal_Int32[ pNode->Len() ];
 
 	sal_Bool bSameLineAgain = sal_False;	// Fuer TextRanger, wenn sich die Hoehe aendert.
 	TabInfo aCurrentTab;
@@ -2996,8 +2996,8 @@ void ImpEditEngine::Paint( OutputDevice*
 								XubString aText;
                                 USHORT nTextStart = 0;
                                 USHORT nTextLen = 0;
-								const long* pDXArray = 0;
-								long* pTmpDXArray = 0;
+								const sal_Int32* pDXArray = 0;
+								sal_Int32* pTmpDXArray = 0;
 
 								if ( pTextPortion->GetKind() == PORTIONKIND_TEXT )
 								{
@@ -3015,7 +3015,7 @@ void ImpEditEngine::Paint( OutputDevice*
                                     nTextStart = 0;
                                     nTextLen = aText.Len();
 
-									pTmpDXArray = new long[ aText.Len() ];
+									pTmpDXArray = new sal_Int32[ aText.Len() ];
 									pDXArray = pTmpDXArray;
 									Font aOldFont( GetRefDevice()->GetFont() );
 									aTmpFont.SetPhysFont( GetRefDevice() );
Index: svx/source/editeng/impedit4.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/editeng/impedit4.cxx,v
retrieving revision 1.54
retrieving revision 1.52.136.2
diff -u -p -r1.54 -r1.52.136.2
--- svx/source/editeng/impedit4.cxx	17 Sep 2004 14:16:15 -0000	1.54
+++ svx/source/editeng/impedit4.cxx	19 Oct 2004 17:58:17 -0000	1.52.136.2
@@ -2669,7 +2669,7 @@ EditSelection ImpEditEngine::Translitera
 
 			xub_StrLen nLen = nCurrentEnd - nCurrentStart;
 
-			Sequence <long> aOffsets;
+			Sequence <sal_Int32> aOffsets;
 			String aNewText( aTranslitarationWrapper.transliterate( *pNode, nLanguage, nCurrentStart, nLen, &aOffsets ) );
 
 			if( ( nLen != aNewText.Len() ) || !pNode->Equals( aNewText, nCurrentStart, nLen ) )
@@ -2694,7 +2694,7 @@ EditSelection ImpEditEngine::Translitera
 
                 // Change text without loosing the attributes
                 USHORT nCharsAfterTransliteration = aOffsets.getLength();
-                const long* pOffsets = aOffsets.getConstArray();
+                const sal_Int32* pOffsets = aOffsets.getConstArray();
                 short nDiffs = 0;
                 for ( USHORT n = 0; n < nCharsAfterTransliteration; n++ )
                 {
Index: svx/source/fmcomp/fmgridcl.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/fmcomp/fmgridcl.cxx,v
retrieving revision 1.44
retrieving revision 1.43.108.2
diff -u -p -r1.44 -r1.43.108.2
--- svx/source/fmcomp/fmgridcl.cxx	2 Aug 2004 16:42:58 -0000	1.44
+++ svx/source/fmcomp/fmgridcl.cxx	19 Oct 2004 18:48:15 -0000	1.43.108.2
@@ -2210,7 +2210,7 @@ void FmGridControl::Select()
 	}
 }
 // -----------------------------------------------------------------------------
-long FmGridControl::GetSelectedColumn() const		
+sal_Int32 FmGridControl::GetSelectedColumn() const		
 { 
 	return m_nCurrentSelectedColumn; 
 }
Index: svx/source/form/fmvwimp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/form/fmvwimp.cxx,v
retrieving revision 1.38
retrieving revision 1.33.104.2
diff -u -p -r1.38 -r1.33.104.2
--- svx/source/form/fmvwimp.cxx	20 Sep 2004 09:58:43 -0000	1.38
+++ svx/source/form/fmvwimp.cxx	19 Oct 2004 17:47:48 -0000	1.33.104.2
@@ -1547,8 +1547,8 @@ void FmXFormView::createControlLabelPair
 	aRealSize.Height()= aDefSize.Height();
 
 	// je nach Skalierung des Zieldevices muss die Groesse noch normiert werden (#53523#)
-	aRealSize.Width() = sal_Int32(Fraction(aRealSize.Width(), 1) * eTargetMode.GetScaleX());
-	aRealSize.Height() = sal_Int32(Fraction(aRealSize.Height(), 1) * eTargetMode.GetScaleY());
+	aRealSize.Width() = Fraction(aRealSize.Width(), 1) * eTargetMode.GetScaleX();
+	aRealSize.Height() = Fraction(aRealSize.Height(), 1) * eTargetMode.GetScaleY();
 	_rpLabel->SetLogicRect(
 		::Rectangle(	_pOutDev->LogicToLogic(Point(0, _nYOffsetMM), eSourceMode, eTargetMode),
 					_pOutDev->LogicToLogic(aRealSize, eSourceMode, eTargetMode)
@@ -1568,8 +1568,8 @@ void FmXFormView::createControlLabelPair
 		szControlSize = aDefSize;
 
 	// normieren wie oben
-	szControlSize.Width() = sal_Int32(Fraction(szControlSize.Width(), 1) * eTargetMode.GetScaleX());
-	szControlSize.Height() = sal_Int32(Fraction(szControlSize.Height(), 1) * eTargetMode.GetScaleY());
+	szControlSize.Width() = Fraction(szControlSize.Width(), 1) * eTargetMode.GetScaleX();
+	szControlSize.Height() = Fraction(szControlSize.Height(), 1) * eTargetMode.GetScaleY();
 	_rpControl->SetLogicRect(
 		::Rectangle(	_pOutDev->LogicToLogic(Point(aRealSize.Width(), _nYOffsetMM), eSourceMode, eTargetMode),
 					_pOutDev->LogicToLogic(szControlSize, eSourceMode, eTargetMode)
Index: svx/source/inc/DGColorNameLookUp.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/DGColorNameLookUp.hxx,v
retrieving revision 1.2
retrieving revision 1.2.600.1
diff -u -p -r1.2 -r1.2.600.1
--- svx/source/inc/DGColorNameLookUp.hxx	26 May 2003 09:05:56 -0000	1.2
+++ svx/source/inc/DGColorNameLookUp.hxx	9 Sep 2004 09:40:03 -0000	1.2.600.1
@@ -102,7 +102,7 @@ public:
             color or, when no name exists, a string of the form "#RRGGBB"
             with two hexadecimal digits for each color component.
     */
-    ::rtl::OUString LookUpColor (long int nColor) const;
+    ::rtl::OUString LookUpColor (sal_Int32 nColor) const;
 
 private:
     /// Define hash map type to convert numerical color values to names.
Index: svx/source/inc/GraphCtlAccessibleContext.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/GraphCtlAccessibleContext.hxx,v
retrieving revision 1.9
retrieving revision 1.9.546.1
diff -u -p -r1.9 -r1.9.546.1
--- svx/source/inc/GraphCtlAccessibleContext.hxx	26 Jun 2003 11:10:37 -0000	1.9
+++ svx/source/inc/GraphCtlAccessibleContext.hxx	9 Sep 2004 09:40:03 -0000	1.9.546.1
@@ -210,8 +210,8 @@ public:
 
 	//=====  XAccessibleContext  ==============================================
 
-    virtual long SAL_CALL getAccessibleChildCount (void) throw (::com::sun::star::uno::RuntimeException);
-    virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleChild (long nIndex) throw (::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException);
+    virtual sal_Int32 SAL_CALL getAccessibleChildCount (void) throw (::com::sun::star::uno::RuntimeException);
+    virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleChild (sal_Int32 nIndex) throw (::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException);
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL getAccessibleParent (void) throw (::com::sun::star::uno::RuntimeException);
 	virtual	sal_Int32 SAL_CALL getAccessibleIndexInParent (void) throw (::com::sun::star::uno::RuntimeException);
 	virtual sal_Int16 SAL_CALL getAccessibleRole (void) throw (::com::sun::star::uno::RuntimeException);
Index: svx/source/inc/svxrectctaccessiblecontext.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/inc/svxrectctaccessiblecontext.hxx,v
retrieving revision 1.9
retrieving revision 1.9.606.1
diff -u -p -r1.9 -r1.9.606.1
--- svx/source/inc/svxrectctaccessiblecontext.hxx	22 May 2003 12:55:19 -0000	1.9
+++ svx/source/inc/svxrectctaccessiblecontext.hxx	9 Sep 2004 09:40:03 -0000	1.9.606.1
@@ -225,11 +225,11 @@ public:
 
 	//=====  XAccessibleContext  ==============================================
 
-	virtual long SAL_CALL
+	virtual sal_Int32 SAL_CALL
 		getAccessibleChildCount( void ) throw( ::com::sun::star::uno::RuntimeException );
 
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
-		getAccessibleChild( long nIndex )
+		getAccessibleChild( sal_Int32 nIndex )
 			throw( ::com::sun::star::uno::RuntimeException, ::com::sun::star::lang::IndexOutOfBoundsException );
 
 	virtual ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible> SAL_CALL
Index: svx/source/items/paraitem.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/paraitem.cxx,v
retrieving revision 1.27
retrieving revision 1.27.664.1
diff -u -p -r1.27 -r1.27.664.1
--- svx/source/items/paraitem.cxx	4 Apr 2003 18:03:45 -0000	1.27
+++ svx/source/items/paraitem.cxx	9 Sep 2004 09:40:04 -0000	1.27.664.1
@@ -148,8 +148,8 @@ using namespace ::rtl;
 using namespace ::com::sun::star;
 
 // Konvertierung fuer UNO
-#define TWIP_TO_MM100(TWIP) 	((TWIP) >= 0 ? (((TWIP)*127L+36L)/72L) : (((TWIP)*127L-36L)/72L))
-#define MM100_TO_TWIP(MM100)	((MM100) >= 0 ? (((MM100)*72L+63L)/127L) : (((MM100)*72L-63L)/127L))
+#define TWIP_TO_MM100(TWIP) 	((TWIP) >= 0 ? (((TWIP)*127+36)/72) : (((TWIP)*127-36)/72))
+#define MM100_TO_TWIP(MM100)	((MM100) >= 0 ? (((MM100)*72+63)/127) : (((MM100)*72-63)/127))
 
 
 // STATIC DATA -----------------------------------------------------------
Index: svx/source/items/svxfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/items/svxfont.cxx,v
retrieving revision 1.7
retrieving revision 1.7.298.1
diff -u -p -r1.7 -r1.7.298.1
--- svx/source/items/svxfont.cxx	6 Jan 2004 15:36:05 -0000	1.7
+++ svx/source/items/svxfont.cxx	9 Sep 2004 09:40:04 -0000	1.7.298.1
@@ -503,7 +503,7 @@ Size SvxFont::GetPhysTxtSize( const Outp
 }
 
 Size SvxFont::QuickGetTextSize( const OutputDevice *pOut, const XubString &rTxt,
-						 const USHORT nIdx, const USHORT nLen, long* pDXArray ) const
+						 const USHORT nIdx, const USHORT nLen, sal_Int32* pDXArray ) const
 {
 	if ( !IsCaseMap() && !IsKern() )
 		return Size( pOut->GetTextArray( rTxt, pDXArray, nIdx, nLen ),
@@ -590,7 +590,7 @@ void SvxFont::DrawText( OutputDevice *pO
 
 void SvxFont::QuickDrawText( OutputDevice *pOut,
 	const Point &rPos, const XubString &rTxt,
-	const xub_StrLen nIdx, const xub_StrLen nLen, const long* pDXArray ) const
+	const xub_StrLen nIdx, const xub_StrLen nLen, const sal_Int32* pDXArray ) const
 {
 	// Font muss ins OutputDevice selektiert sein...
 	if ( !IsCaseMap() && !IsCapital() && !IsKern() && !IsEsc() )
Index: svx/source/msfilter/msdffimp.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/msfilter/msdffimp.cxx,v
retrieving revision 1.102
retrieving revision 1.97.10.2
diff -u -p -r1.102 -r1.97.10.2
--- svx/source/msfilter/msdffimp.cxx	4 Oct 2004 17:51:30 -0000	1.102
+++ svx/source/msfilter/msdffimp.cxx	19 Oct 2004 19:09:37 -0000	1.97.10.2
@@ -3580,7 +3580,7 @@ struct EscherBlipCacheEntry
         aUniqueID( rUniqueID ) {}
 };
 
-void SvxMSDffManager::Scale( long& rVal ) const
+void SvxMSDffManager::Scale( sal_Int32& rVal ) const
 {
 	if ( bNeedMap )
 		rVal = BigMulDiv( rVal, nMapMul, nMapDiv );
@@ -3654,7 +3654,7 @@ void SvxMSDffManager::Scale( XPolyPolygo
 		Scale( rPoly[ nPolyNum ] );
 }
 
-void SvxMSDffManager::ScaleEmu( long& rVal ) const
+void SvxMSDffManager::ScaleEmu( sal_Int32& rVal ) const
 {
 	rVal = BigMulDiv( rVal, nEmuMul, nEmuDiv );
 }
@@ -4803,7 +4803,7 @@ SdrObject* SvxMSDffManager::ImportShape(
 	aObjData.bChildAnchor = maShapeRecords.SeekToContent( rSt, DFF_msofbtChildAnchor, SEEK_FROM_CURRENT_AND_RESTART );
 	if ( aObjData.bChildAnchor )
 	{
-        INT32 l, o, r, u;
+        sal_Int32 l, o, r, u;
         rSt >> l >> o >> r >> u;
         Scale( l );
         Scale( o );
@@ -5253,7 +5253,7 @@ Rectangle SvxMSDffManager::GetGlobalChil
 					{
 						sal_Int16 ls, os, rs, us;
 						rSt >> os >> ls >> rs >> us; // etwas seltsame Koordinatenreihenfolge ...
-						long l = ls, o = os, r = rs, u = us;
+						sal_Int32 l = ls, o = os, r = rs, u = us;
 						Scale( l );
 						Scale( o );
 						Scale( r );
Index: svx/source/outliner/outleeng.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.cxx,v
retrieving revision 1.9
retrieving revision 1.9.140.1
diff -u -p -r1.9 -r1.9.140.1
--- svx/source/outliner/outleeng.cxx	27 Apr 2004 15:49:36 -0000	1.9
+++ svx/source/outliner/outleeng.cxx	9 Sep 2004 09:40:05 -0000	1.9.140.1
@@ -173,7 +173,7 @@ XubString OutlinerEditEng::GetUndoCommen
 }
 
 // #101498#
-void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void OutlinerEditEng::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	if ( nIndex == 0 )
 	{
Index: svx/source/outliner/outleeng.hxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outleeng.hxx,v
retrieving revision 1.7
retrieving revision 1.7.140.1
diff -u -p -r1.7 -r1.7.140.1
--- svx/source/outliner/outleeng.hxx	27 Apr 2004 15:49:53 -0000	1.7
+++ svx/source/outliner/outleeng.hxx	9 Sep 2004 09:40:05 -0000	1.7.140.1
@@ -85,7 +85,7 @@ public:
 	virtual void 		ParagraphDeleted( USHORT nDeletedParagraph );
 	
 	// #101498#
-	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
+	virtual void 		DrawingText(const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray, const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft);
 
 	virtual	void 		StyleSheetChanged( SfxStyleSheet* pStyle );
 	virtual void 		ParaAttribsChanged( USHORT nPara );
Index: svx/source/outliner/outliner.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/outliner/outliner.cxx,v
retrieving revision 1.56
retrieving revision 1.56.298.1
diff -u -p -r1.56 -r1.56.298.1
--- svx/source/outliner/outliner.cxx	6 Jan 2004 15:38:57 -0000	1.56
+++ svx/source/outliner/outliner.cxx	9 Sep 2004 09:40:05 -0000	1.56.298.1
@@ -1191,14 +1191,14 @@ void Outliner::PaintBullet( USHORT nPara
 				else
 				{
 					Font aSvxFont( aBulletFont );
-					long* pBuf = new long[ pPara->GetText().Len() ];
+					sal_Int32* pBuf = new sal_Int32[ pPara->GetText().Len() ];
 					pOutDev->GetTextArray( pPara->GetText(), pBuf );
 					// aTextPos ist Bottom, jetzt die Baseline liefern:
 					FontMetric aMetric( pOutDev->GetFontMetric() );
 					aTextPos.Y() -= aMetric.GetDescent();
 				
 					// #101498#
-					DrawingText( aTextPos, pPara->GetText(), 0, pPara->GetText().Len(), pBuf, aSvxFont, nPara, 0xFFFF, 0xFF);
+					DrawingText( aTextPos, pPara->GetText(), 0L, pPara->GetText().Len(), pBuf, aSvxFont, nPara, 0xFFFF, 0xFF);
 					
 					delete[] pBuf;
 				}
@@ -2035,7 +2035,7 @@ void Outliner::StripPortions()
 }
 
 // #101498#
-void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const long* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
+void Outliner::DrawingText( const Point& rStartPos, const XubString& rText, USHORT nTextStart, USHORT nTextLen, const sal_Int32* pDXArray,const SvxFont& rFont, USHORT nPara, USHORT nIndex, BYTE nRightToLeft)
 {
 	DBG_CHKTHIS(Outliner,0);
 	
Index: svx/source/svdraw/svdfppt.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdfppt.cxx,v
retrieving revision 1.123
retrieving revision 1.122.10.2
diff -u -p -r1.123 -r1.122.10.2
--- svx/source/svdraw/svdfppt.cxx	4 Oct 2004 17:53:42 -0000	1.123
+++ svx/source/svdraw/svdfppt.cxx	19 Oct 2004 18:54:41 -0000	1.122.10.2
@@ -830,7 +830,7 @@ void SdrEscherImport::ProcessClientAncho
 {
 	INT16 ls, os, rs, us;
 	rSt >> os >> ls >> rs >> us; // etwas seltsame Koordinatenreihenfolge ...
-	long l = ls, o = os, r = rs, u = us;
+	sal_Int32 l = ls, o = os, r = rs, u = us;
 	Scale( l );
 	Scale( o );
 	Scale( r );
Index: svx/source/svdraw/svdmodel.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdmodel.cxx,v
retrieving revision 1.59
retrieving revision 1.56.8.2
diff -u -p -r1.59 -r1.56.8.2
--- svx/source/svdraw/svdmodel.cxx	4 Oct 2004 17:53:54 -0000	1.59
+++ svx/source/svdraw/svdmodel.cxx	19 Oct 2004 18:58:47 -0000	1.56.8.2
@@ -455,7 +455,7 @@ void SdrModel::ImpCtor(SfxItemPool* pPoo
 	ImpCreateTables();
 }
 
-SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, INT32 bLoadRefCounts):
+SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32)
@@ -468,7 +468,7 @@ SdrModel::SdrModel(SfxItemPool* pPool, S
 	ImpCtor(pPool,pPers,FALSE, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, INT32 bLoadRefCounts):
+SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32),
@@ -482,7 +482,7 @@ SdrModel::SdrModel(const String& rPath, 
 	ImpCtor(pPool,pPers,FALSE, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts):
+SdrModel::SdrModel(SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32)
@@ -495,7 +495,7 @@ SdrModel::SdrModel(SfxItemPool* pPool, S
 	ImpCtor(pPool,pPers,bUseExtColorTable, (FASTBOOL)bLoadRefCounts);
 }
 
-SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, INT32 bLoadRefCounts):
+SdrModel::SdrModel(const String& rPath, SfxItemPool* pPool, SfxObjectShell* pPers, FASTBOOL bUseExtColorTable, sal_Bool bLoadRefCounts):
 //BFS01	aInfo(TRUE),
 	maPages(1024,32,32),
 	maMaPag(1024,32,32),
Index: svx/source/svdraw/svdoattr.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdoattr.cxx,v
retrieving revision 1.40
retrieving revision 1.39.320.2
diff -u -p -r1.40 -r1.39.320.2
--- svx/source/svdraw/svdoattr.cxx	3 Aug 2004 13:21:11 -0000	1.40
+++ svx/source/svdraw/svdoattr.cxx	19 Oct 2004 18:55:38 -0000	1.39.320.2
@@ -570,11 +570,11 @@ INT32 SdrAttrObj::ImpGetLineEndAdd() con
 	nSttWdt /= 2;
 
 	// Lieber etwas mehr, dafuer keine Wurzel ziehen
-	long nSttAdd = Max(nSttWdt, nSttHgt);
+	sal_Int32 nSttAdd = Max(nSttWdt, nSttHgt);
 	nSttAdd *= 3;
 	nSttAdd /= 2;
 
-	long nEndWdt = ((const XLineEndWidthItem&)(rSet.Get(XATTR_LINEENDWIDTH))).GetValue();
+	sal_Int32 nEndWdt = ((const XLineEndWidthItem&)(rSet.Get(XATTR_LINEENDWIDTH))).GetValue();
 
 	if(nEndWdt < 0)
 		nEndWdt = -nLineWdt * nEndWdt / 100; // <0 = relativ
Index: svx/source/svdraw/svdopath.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/svdraw/svdopath.cxx,v
retrieving revision 1.25
retrieving revision 1.25.32.1
diff -u -p -r1.25 -r1.25.32.1
--- svx/source/svdraw/svdopath.cxx	10 Jun 2004 11:34:45 -0000	1.25
+++ svx/source/svdraw/svdopath.cxx	9 Sep 2004 09:40:07 -0000	1.25.32.1
@@ -104,6 +104,8 @@
 // #104018# replace macros above with type-safe methods
 inline sal_Int32 ImplTwipsToMM(sal_Int32 nVal) { return ((nVal * 127 + 36) / 72); }
 inline sal_Int32 ImplMMToTwips(sal_Int32 nVal) { return ((nVal * 72 + 63) / 127); }
+inline long ImplTwipsToMM(sal_Int64 nVal) { return ((nVal * 127 + 36) / 72); }
+inline long ImplMMToTwips(sal_Int64 nVal) { return ((nVal * 72 + 63) / 127); }
 inline double ImplTwipsToMM(double fVal) { return (fVal * (127.0 / 72.0)); }
 inline double ImplMMToTwips(double fVal) { return (fVal * (72.0 / 127.0)); }
 
Index: svx/source/xoutdev/_xfont.cxx
===================================================================
RCS file: /cvs/graphics/svx/source/xoutdev/_xfont.cxx,v
retrieving revision 1.13
retrieving revision 1.13.298.1
diff -u -p -r1.13 -r1.13.298.1
--- svx/source/xoutdev/_xfont.cxx	6 Jan 2004 15:46:20 -0000	1.13
+++ svx/source/xoutdev/_xfont.cxx	9 Sep 2004 09:40:07 -0000	1.13.298.1
@@ -205,7 +205,7 @@ sal_Bool XOutGetTextOutlines(PolyPolyVec
 
 // #101498# Helper method ImpGetTextLength to get text length taking into account
 // hor/vertical and BIDI, especially right-to-left.
-sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, long* pDXArray, 
+sal_Int32 ImpGetTextLength(OutputDevice* pOut, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft = pInfo->IsRTL();
@@ -236,7 +236,7 @@ sal_Int32 ImpGetTextLength(OutputDevice*
 
 // #101498# Helper method ImpDrawTextArray to draw text taking into account
 // hor/vertical and BIDI, especially right-to-left.
-void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, long* pDXArray, 
+void ImpDrawTextArray(OutputDevice* pOut, const Point& rPos, DrawPortionInfo* pInfo, sal_Int32* pDXArray, 
 	xub_StrLen nIndex, xub_StrLen nLen)
 {
 	sal_Bool bRightToLeft(pInfo->IsRTL());
@@ -284,7 +284,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 	sal_Bool bToLastPoint, sal_Bool bDraw, sal_Bool bIsShadow)
 {
 	Font aFont = pInfo->rFont;
-	const long* pDXArray = pInfo->pDXArray;
+	const sal_Int32* pDXArray = pInfo->pDXArray;
 	sal_Bool bUseBreakIterator(sal_False);
 
 	Reference < com::sun::star::i18n::XBreakIterator > xBreak;
@@ -366,7 +366,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		pDXArray = NULL;
 	}
 
-	nTextWidth = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, 0, pInfo->nTextLen);
+	nTextWidth = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, 0, pInfo->nTextLen);
 
 	if ( eFormTextAdjust != XFT_LEFT && nAbsStart <= 0 )
 	{
@@ -461,7 +461,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 		fLen = sqrt(fDx * fDx + fDy * fDy);
 		nLen = (long) (fLen + 0.5);
 
-		nChar1Len = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nGlyphLen);
+		nChar1Len = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nGlyphLen);
 
 		double fXDist, fYDist;
 		double fCos = fDx;
@@ -516,7 +516,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						CharacterIteratorMode::SKIPCELL, 1, nDone) - (nChar + pInfo->nTextStart + nCnt);
 				}
 
-				nTextLen = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, nCnt + nNextGlyphLen);
+				nTextLen = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, nCnt + nNextGlyphLen);
 
 				nCnt += nNextGlyphLen;
 			}
@@ -585,7 +585,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 					else
@@ -597,7 +597,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 						pOut->SetFont(aFont);
 						if(bDraw)
 						{
-							ImpDrawTextArray(pOut, aPos, pInfo, (long*)pDXArray, nChar, nCnt);
+							ImpDrawTextArray(pOut, aPos, pInfo, (sal_Int32*)pDXArray, nChar, nCnt);
 						}
 					}
 				}
@@ -624,7 +624,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar, i);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar, i);
 
 						aPolyPos.X() += (long) (fDx * nW / fLen);
 						aPolyPos.Y() += (long) (fDy * nW / fLen);
@@ -675,7 +675,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 					{
 						long nW;
 
-						nW = ImpGetTextLength(pOut, pInfo, (long*) pDXArray, nChar + i, nNextGlyphLen);
+						nW = ImpGetTextLength(pOut, pInfo, (sal_Int32*) pDXArray, nChar + i, nNextGlyphLen);
 
 						aPolyPos.X() -= nW / 2;
 
@@ -696,7 +696,7 @@ sal_Int32 XOutputDevice::ImpDrawFormText
 							DrawXPolyPolygon(aChar);
 						else
 						{
-							ImpDrawTextArray(pOut, aPolyPos, pInfo, (long*)pDXArray, nChar + i, nNextGlyphLen);
+							ImpDrawTextArray(pOut, aPolyPos, pInfo, (sal_Int32*)pDXArray, nChar + i, nNextGlyphLen);
 						}
 					}
 
