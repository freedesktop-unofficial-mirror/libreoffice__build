Index: sw/source/core/inc/scriptinfo.hxx
===================================================================
RCS file: /cvs/sw/sw/source/core/inc/scriptinfo.hxx,v
retrieving revision 1.10
retrieving revision 1.4.94.3
diff -u -p -u -p -r1.10 -r1.4.94.3
--- sw/source/core/inc/scriptinfo.hxx	26 Nov 2004 14:27:05 -0000	1.10
+++ sw/source/core/inc/scriptinfo.hxx	18 Jan 2005 15:47:29 -0000	1.4.94.3
@@ -267,7 +267,7 @@ public:
     USHORT HasKana( xub_StrLen nStart, const xub_StrLen nEnd ) const;
 
     // modifies the kerning array according to a given compress value
-    long Compress( long* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
+    long Compress( sal_Int32* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
                    const USHORT nCompress, const USHORT nFontHeight,
                    Point* pPoint = NULL ) const;
 
@@ -287,7 +287,7 @@ public:
                 The value which has to be added to a kashida opportunity.
     @return The number of kashida opportunities in the given range
 */
-    USHORT KashidaJustify( long* pKernArray ,long* pScrArray,
+    USHORT KashidaJustify( sal_Int32* pKernArray ,sal_Int32* pScrArray,
                            xub_StrLen nIdx, xub_StrLen nLen,
                            USHORT nSpace = 0 ) const;
 
@@ -318,8 +318,8 @@ public:
                 The value which has to be added to the cells.
     @return The number of extra spaces in the given range
 */
-    static USHORT ThaiJustify( const XubString& rTxt, long* pKernArray,
-                               long* pScrArray, xub_StrLen nIdx,
+    static USHORT ThaiJustify( const XubString& rTxt, sal_Int32* pKernArray,
+                               sal_Int32* pScrArray, xub_StrLen nIdx,
                                xub_StrLen nLen, xub_StrLen nNumberOfBlanks = 0,
                                long nSpaceAdd = 0 );
 
Index: sw/source/core/text/porlay.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/text/porlay.cxx,v
retrieving revision 1.53
retrieving revision 1.48.94.3
diff -u -p -u -p -r1.53 -r1.48.94.3
--- sw/source/core/text/porlay.cxx	22 Oct 2004 08:13:56 -0000	1.53
+++ sw/source/core/text/porlay.cxx	18 Jan 2005 16:22:15 -0000	1.48.94.3
@@ -1503,7 +1503,7 @@ USHORT SwScriptInfo::HasKana( xub_StrLen
  *                      SwScriptInfo::Compress()
  *************************************************************************/
 
-long SwScriptInfo::Compress( long* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
+long SwScriptInfo::Compress( sal_Int32* pKernArray, xub_StrLen nIdx, xub_StrLen nLen,
                              const USHORT nCompress, const USHORT nFontHeight,
                              Point* pPoint ) const
 {
@@ -1619,7 +1619,7 @@ long SwScriptInfo::Compress( long* pKern
  *                      SwScriptInfo::KashidaJustify()
  *************************************************************************/
 
-USHORT SwScriptInfo::KashidaJustify( long* pKernArray, long* pScrArray,
+USHORT SwScriptInfo::KashidaJustify( sal_Int32* pKernArray, sal_Int32* pScrArray,
                                      xub_StrLen nStt, xub_StrLen nLen,
                                      USHORT nSpace ) const
 {
@@ -1706,8 +1706,8 @@ sal_Bool SwScriptInfo::IsArabicLanguage(
  *                      SwScriptInfo::ThaiJustify()
  *************************************************************************/
 
-USHORT SwScriptInfo::ThaiJustify( const XubString& rTxt, long* pKernArray,
-                                  long* pScrArray, xub_StrLen nStt,
+USHORT SwScriptInfo::ThaiJustify( const XubString& rTxt, sal_Int32* pKernArray,
+                                  sal_Int32* pScrArray, xub_StrLen nStt,
                                   xub_StrLen nLen, xub_StrLen nNumberOfBlanks,
                                   long nSpaceAdd )
 {
Index: sw/source/core/txtnode/fntcache.cxx
===================================================================
RCS file: /cvs/sw/sw/source/core/txtnode/fntcache.cxx,v
retrieving revision 1.77
retrieving revision 1.76.270.2
diff -u -p -u -p -r1.77 -r1.76.270.2
--- sw/source/core/txtnode/fntcache.cxx	12 Aug 2004 12:39:51 -0000	1.77
+++ sw/source/core/txtnode/fntcache.cxx	20 Oct 2004 12:19:12 -0000	1.76.270.2
@@ -1018,7 +1018,7 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         if ( pGrid && GRID_LINES_CHARS == pGrid->GetGridType() )
         {
             const USHORT nGridWidth = pGrid->GetBaseHeight();
-            long* pKernArray = new long[rInf.GetLen()];
+            sal_Int32* pKernArray = new sal_Int32[rInf.GetLen()];
 
             if ( pPrinter )
                 pPrinter->GetTextArray( rInf.GetText(), pKernArray,
@@ -1119,7 +1119,7 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         // Simple kerning is handled by DrawStretchText
         if( rInf.GetSpace() || rInf.GetKanaComp() )
         {
-            long *pKernArray = new long[ rInf.GetLen() ];
+            sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                        rInf.GetIdx(), rInf.GetLen() );
 
@@ -1330,12 +1330,12 @@ void SwFntObj::DrawText( SwDrawTextInfo 
         BOOL bBullet = rInf.GetBullet();
         if( bSymbol )
             bBullet = FALSE;
-        long *pKernArray = new long[ rInf.GetLen() ];
+        sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
         CreateScrFont( *rInf.GetShell(), rInf.GetOut() );
         long nScrPos;
 
         // get screen array
-        long* pScrArray = new long[ rInf.GetLen() ];
+        sal_Int32* pScrArray = new sal_Int32[ rInf.GetLen() ];
         rInf.GetOut().GetTextArray( rInf.GetText(), pScrArray,
                                     rInf.GetIdx(), rInf.GetLen() );
 
@@ -1902,7 +1902,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
 		aTxtSize.Width() = pPrinter->GetTextWidth( rInf.GetText(),
                                                    rInf.GetIdx(), nLn );
 		aTxtSize.Height() = pPrinter->GetTextHeight();
-		long *pKernArray = new long[nLn];
+		sal_Int32 *pKernArray = new sal_Int32[nLn];
         CreateScrFont( *rInf.GetShell(), rInf.GetOut() );
         if( !GetScrFont()->IsSameInstance( rInf.GetOut().GetFont() ) )
             rInf.GetOut().SetFont( *pScrFont );
@@ -1920,7 +1920,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
             nScrPos = pKernArray[ nLn - 1 ];
         else
         {
-            long* pScrArray = new long[ rInf.GetLen() ];
+            sal_Int32* pScrArray = new sal_Int32[ rInf.GetLen() ];
             rInf.GetOut().GetTextArray( rInf.GetText(), pScrArray,
                                         rInf.GetIdx(), rInf.GetLen() );
             nScrPos = pScrArray[ 0 ];
@@ -1971,7 +1971,7 @@ Size SwFntObj::GetTextSize( SwDrawTextIn
             rInf.GetOut().SetFont( *pPrtFont );
 		if( bCompress )
 		{
-			long *pKernArray = new long[nLn];
+			sal_Int32 *pKernArray = new sal_Int32[nLn];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                         rInf.GetIdx(), nLn );
             rInf.SetKanaDiff( rInf.GetScriptInfo()->Compress( pKernArray,
@@ -2032,7 +2032,7 @@ xub_StrLen SwFntObj::GetCrsrOfst( SwDraw
     if( 0 != nSperren )
         nKern -= nSperren;
 
-    long *pKernArray = new long[ rInf.GetLen() ];
+    sal_Int32 *pKernArray = new sal_Int32[ rInf.GetLen() ];
 
     if ( pPrinter )
     {
@@ -2329,7 +2329,7 @@ xub_StrLen SwFont::GetTxtBreak( SwDrawTe
         {
             const USHORT nGridWidth = pGrid->GetBaseHeight();
 
-            long* pKernArray = new long[rInf.GetLen()];
+            sal_Int32* pKernArray = new sal_Int32[rInf.GetLen()];
             rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
                                         rInf.GetIdx(), rInf.GetLen() );
 
@@ -2431,7 +2431,7 @@ xub_StrLen SwFont::GetTxtBreak( SwDrawTe
 			nLn = 1;
 		else if( nLn > 2 * nTxtBreak )
 			nLn = 2 * nTxtBreak;
-		long *pKernArray = new long[ nLn ];
+		sal_Int32 *pKernArray = new sal_Int32[ nLn ];
 		rInf.GetOut().GetTextArray( rInf.GetText(), pKernArray,
 									rInf.GetIdx(), nLn );
         if( rInf.GetScriptInfo()->Compress( pKernArray, rInf.GetIdx(), nLn,
