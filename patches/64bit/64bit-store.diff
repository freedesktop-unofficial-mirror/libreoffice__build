? store/unxlngx4.pro
Index: store/inc/store/types.h
===================================================================
RCS file: /cvs/ucb/store/inc/store/types.h,v
retrieving revision 1.5
retrieving revision 1.5.96.1
diff -u -p -u -r1.5 -r1.5.96.1
--- store/inc/store/types.h	26 Nov 2001 20:52:57 -0000	1.5
+++ store/inc/store/types.h	25 Aug 2004 18:58:28 -0000	1.5.96.1
@@ -97,9 +97,9 @@ extern "C" {
 /** Attributes (predefined).
     @see store_attrib()
  */
-#define STORE_ATTRIB_ISLINK  0x10000000UL
-#define STORE_ATTRIB_ISDIR   0x20000000UL
-#define STORE_ATTRIB_ISFILE  0x40000000UL
+#define STORE_ATTRIB_ISLINK  ((sal_uInt32)0x10000000)
+#define STORE_ATTRIB_ISDIR   ((sal_uInt32)0x20000000)
+#define STORE_ATTRIB_ISFILE  ((sal_uInt32)0x40000000)
 
 
 /** Access Mode enumeration.
Index: store/source/storbase.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storbase.cxx,v
retrieving revision 1.6
retrieving revision 1.5.84.2
diff -u -p -u -r1.6 -r1.5.84.2
--- store/source/storbase.cxx	8 Sep 2004 16:13:32 -0000	1.6
+++ store/source/storbase.cxx	14 Oct 2004 02:34:01 -0000	1.5.84.2
@@ -217,12 +217,12 @@ const sal_uInt32 store::OStorePageGuard:
  * crc32.
  */
 sal_uInt32 OStorePageGuard::crc32 (
-	sal_uInt32 nCRC32, const void *pData, sal_uInt32 nSize)
+	sal_uInt32 nCRC32, const void *pData, sal_Size nSize)
 {
 	if (pData)
 	{
 		register const sal_uInt8 *p = (const sal_uInt8*)pData;
-		register sal_uInt32       n;
+		register sal_Size         n;
 
 		nCRC32 = ~nCRC32;
 		for (n = nSize; n > 0; n--)
@@ -275,7 +275,7 @@ storeError OStorePageObject::verify (con
  * OStoreSuperBlock.
  *
  *======================================================================*/
-#define STORE_MAGIC_SUPERBLOCK 0x484D5343UL
+#define STORE_MAGIC_SUPERBLOCK sal_uInt32(0x484D5343)
 
 struct OStoreSuperBlock
 {
@@ -296,7 +296,8 @@ struct OStoreSuperBlock
 	 */
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(D) + 2 * (sizeof(L) + sizeof(sal_uInt32)));
+		return sal_uInt16(sizeof(G) + sizeof(D) +
+						  2 * (sizeof(L) + sizeof(sal_uInt32)));
 	}
 
 	/** Construction.
@@ -456,7 +457,7 @@ struct OStoreStateBlock
 	 */
 	static sal_uInt16 size (void)
 	{
-		return sizeof(sal_uInt32);
+		return sal_uInt16(sizeof(sal_uInt32));
 	}
 
 	/** Construction.
Index: store/source/storbase.hxx
===================================================================
RCS file: /cvs/ucb/store/source/storbase.hxx,v
retrieving revision 1.6
retrieving revision 1.6.22.1
diff -u -p -u -r1.6 -r1.6.22.1
--- store/source/storbase.hxx	6 Oct 2003 17:31:55 -0000	1.6
+++ store/source/storbase.hxx	25 Aug 2004 18:58:29 -0000	1.6.22.1
@@ -122,7 +122,7 @@
 /*
  * __store_memcpy.
  */
-inline void __store_memcpy (void * dst, const void * src, sal_uInt32 n)
+inline void __store_memcpy (void * dst, const void * src, sal_Size n)
 {
 	__STORE_CSTD::memcpy (dst, src, n);
 }
@@ -130,7 +130,7 @@ inline void __store_memcpy (void * dst, 
 /*
  * __store_memmove.
  */
-inline void __store_memmove (void * dst, const void * src, sal_uInt32 n)
+inline void __store_memmove (void * dst, const void * src, sal_Size n)
 {
 	__STORE_CSTD::memmove (dst, src, n);
 }
@@ -138,7 +138,7 @@ inline void __store_memmove (void * dst,
 /*
  * __store_memset.
  */
-inline void __store_memset (void * dst, int val, sal_uInt32 n)
+inline void __store_memset (void * dst, int val, sal_Size n)
 {
 	__STORE_CSTD::memset (dst, val, n);
 }
@@ -205,7 +205,7 @@ struct OStorePageGuard
 	}
 
 	static sal_uInt32 crc32 (
-		sal_uInt32 nCRC32, const void *pData, sal_uInt32 nSize);
+		sal_uInt32 nCRC32, const void *pData, sal_Size nSize);
 };
 	
 /*========================================================================
@@ -423,8 +423,8 @@ struct OStorePageNameBlock
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(K) + sizeof(sal_uInt32) +
-				sizeof(sal_Char[STORE_MAXIMUM_NAMESIZE]));
+		return sal_uInt16(sizeof(G) + sizeof(K) + sizeof(sal_uInt32) +
+						  sizeof(sal_Char[STORE_MAXIMUM_NAMESIZE]));
 	}
 
 	/** initialize.
@@ -536,7 +536,7 @@ struct OStorePageData
 	 */
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(D) + 2 * sizeof(L));
+		return sal_uInt16(sizeof(G) + sizeof(D) + 2 * sizeof(L));
 	}
 
 	/** location.
@@ -558,7 +558,7 @@ struct OStorePageData
 		return rtl_allocateMemory (n);
 	}
 
-	static void* operator new (size_t n, sal_uInt16 nPageSize)
+	static void* operator new (size_t, sal_uInt16 nPageSize)
 	{
 		return rtl_allocateMemory (nPageSize);
 	}
Index: store/source/stordata.hxx
===================================================================
RCS file: /cvs/ucb/store/source/stordata.hxx,v
retrieving revision 1.2
retrieving revision 1.2.112.1
diff -u -p -u -r1.2 -r1.2.112.1
--- store/source/stordata.hxx	13 Mar 2001 20:59:02 -0000	1.2
+++ store/source/stordata.hxx	25 Aug 2004 18:58:29 -0000	1.2.112.1
@@ -93,7 +93,7 @@ namespace store
  * OStoreDataPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_DATAPAGE 0x94190310UL
+#define STORE_MAGIC_DATAPAGE sal_uInt32(0x94190310)
 
 struct OStoreDataPageData : public store::OStorePageData
 {
@@ -110,7 +110,7 @@ struct OStoreDataPageData : public store
 	*/
 	static sal_uInt16 size (void)
 	{
-		return 0;
+		return sal_uInt16(0);
 	}
 
 	/** capacity.
@@ -186,7 +186,7 @@ inline OStoreDataPageObject::OStoreDataP
  * OStoreIndirectionPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_INDIRECTPAGE 0x89191107UL
+#define STORE_MAGIC_INDIRECTPAGE sal_uInt32(0x89191107)
 
 struct OStoreIndirectionPageData : public store::OStorePageData
 {
@@ -205,7 +205,7 @@ struct OStoreIndirectionPageData : publi
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G));
+		return sal_uInt16(sizeof(G));
 	}
 
 	/** capacity.
@@ -223,11 +223,11 @@ struct OStoreIndirectionPageData : publi
 	*/
 	static sal_uInt16 capacityCount (const D& rDescr)
 	{
-		return (capacity(rDescr) / sizeof(sal_uInt32));
+		return sal_uInt16(capacity(rDescr) / sizeof(sal_uInt32));
 	}
 	sal_uInt16 capacityCount (void) const
 	{
-		return (capacity() / sizeof(sal_uInt32));
+		return sal_uInt16(capacity() / sizeof(sal_uInt32));
 	}
 
 	/** Construction.
@@ -454,7 +454,7 @@ struct OStoreDirectoryDataBlock
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G) + sizeof(LinkTable) + sizeof(sal_uInt32));
+		return sal_uInt16(sizeof(G) + sizeof(LinkTable) + sizeof(sal_uInt32));
 	}
 
 	/** initialize.
@@ -601,7 +601,7 @@ struct OStoreDirectoryDataBlock
  * OStoreDirectoryPageData.
  *
  *======================================================================*/
-#define STORE_MAGIC_DIRECTORYPAGE 0x62190120UL
+#define STORE_MAGIC_DIRECTORYPAGE sal_uInt32(0x62190120)
 
 struct OStoreDirectoryPageData : public store::OStorePageData
 {
Index: store/source/storlckb.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storlckb.cxx,v
retrieving revision 1.4
retrieving revision 1.4.14.1
diff -u -p -u -r1.4 -r1.4.14.1
--- store/source/storlckb.cxx	9 Mar 2004 12:26:55 -0000	1.4
+++ store/source/storlckb.cxx	25 Aug 2004 18:58:29 -0000	1.4.14.1
@@ -119,10 +119,10 @@ using namespace store;
 /*
  * __store_convertTextToUnicode.
  */
-inline sal_Int32 __store_convertTextToUnicode (
+inline sal_Size __store_convertTextToUnicode (
 	rtl_TextToUnicodeConverter  hConverter,
-	const sal_Char *pSrcBuffer, sal_Int32 nSrcLength,
-	sal_Unicode    *pDstBuffer, sal_Int32 nDstLength)
+	const sal_Char *pSrcBuffer, sal_Size nSrcLength,
+	sal_Unicode    *pDstBuffer, sal_Size nDstLength)
 {
 	sal_uInt32 nCvtInfo = 0;
 	sal_Size nCvtBytes = 0;
@@ -351,8 +351,8 @@ storeError OStoreDirectory::iterate (sto
 			{
 				// Setup FindData.
 				sal_Char *p = m_pNode->m_aNameBlock.m_pData;
-				sal_Int32 n = rtl_str_getLength (p);
-				sal_Int32 k = rFindData.m_nLength;
+				sal_Size  n = rtl_str_getLength (p);
+				sal_Size  k = rFindData.m_nLength;
 
 				n = __store_convertTextToUnicode (
 					m_hTextCvt, p, n,
Index: store/source/storpage.cxx
===================================================================
RCS file: /cvs/ucb/store/source/storpage.cxx,v
retrieving revision 1.3
retrieving revision 1.3.68.1
diff -u -p -u -r1.3 -r1.3.68.1
--- store/source/storpage.cxx	27 Mar 2003 14:06:37 -0000	1.3
+++ store/source/storpage.cxx	25 Aug 2004 18:58:29 -0000	1.3.68.1
@@ -994,7 +994,7 @@ storeError OStorePageManager::symlink (
 	// Mark 'Source' as symbolic link to 'Destination'.
 	OStoreDirectoryPageObject aPage (*m_pDirect);
 	aPage.attrib (STORE_ATTRIB_ISLINK);
-	aPage.dataLength (sizeof (aDstKey));
+	aPage.dataLength (sal_uInt32(sizeof(aDstKey)));
 
 	// Allocate and save 'Source' directory page.
 	eErrCode = base::allocate (aPage);
Index: store/source/stortree.cxx
===================================================================
RCS file: /cvs/ucb/store/source/stortree.cxx,v
retrieving revision 1.3
retrieving revision 1.3.96.1
diff -u -p -u -r1.3 -r1.3.96.1
--- store/source/stortree.cxx	26 Nov 2001 21:42:55 -0000	1.3
+++ store/source/stortree.cxx	25 Aug 2004 18:58:29 -0000	1.3.96.1
@@ -130,7 +130,7 @@ void OStoreBTreeNodeData::swap (const D&
 #ifdef OSL_BIGENDIAN
 	m_aGuard.swap();
 
-	sal_uInt16 i, n = capacity(rDescr) / sizeof(T);
+	sal_uInt16 i, n = sal_uInt16(capacity(rDescr) / sizeof(T));
 	for (i = 0; i < n; i++)
 		m_pData[i].swap();
 #endif /* OSL_BIGENDIAN */
@@ -177,7 +177,7 @@ void OStoreBTreeNodeData::insert (sal_uI
 
 		// insert.
 		m_pData[i] = t;
-		base::m_aDescr.m_nUsed += sizeof(T);
+		base::m_aDescr.m_nUsed += sal_uInt16(sizeof(T));
 	}
 }
 
@@ -195,7 +195,7 @@ void OStoreBTreeNodeData::remove (sal_uI
 
 		// truncate.
 		m_pData[n - 1] = T();
-		base::m_aDescr.m_nUsed -= sizeof(T);
+		base::m_aDescr.m_nUsed -= sal_uInt16(sizeof(T));
 	}
 }
 
Index: store/source/stortree.hxx
===================================================================
RCS file: /cvs/ucb/store/source/stortree.hxx,v
retrieving revision 1.2
retrieving revision 1.2.112.1
diff -u -p -u -r1.2 -r1.2.112.1
--- store/source/stortree.hxx	13 Mar 2001 21:03:26 -0000	1.2
+++ store/source/stortree.hxx	25 Aug 2004 18:58:30 -0000	1.2.112.1
@@ -160,7 +160,7 @@ struct OStoreBTreeEntry
  * OStoreBTreeNodeData.
  *
  *======================================================================*/
-#define STORE_MAGIC_BTREENODE 0x58190322UL
+#define STORE_MAGIC_BTREENODE sal_uInt32(0x58190322)
 
 struct OStoreBTreeNodeData : public store::OStorePageData
 {
@@ -179,7 +179,7 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	static sal_uInt16 size (void)
 	{
-		return (sizeof(G));
+		return sal_uInt16(sizeof(G));
 	}
 
 	/** capacity.
@@ -197,7 +197,7 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	sal_uInt16 capacityCount (void) const
 	{
-		return (capacity() / sizeof(T));
+		return sal_uInt16(capacity() / sizeof(T));
 	}
 
 	/** usage.
@@ -215,12 +215,12 @@ struct OStoreBTreeNodeData : public stor
 	*/
 	sal_uInt16 usageCount (void) const
 	{
-		return (usage() / sizeof(T));
+		return sal_uInt16(usage() / sizeof(T));
 	}
 	void usageCount (sal_uInt16 nCount)
 	{
 		base::m_aDescr.m_nUsed  = base::size() + self::size();
-		base::m_aDescr.m_nUsed += nCount * sizeof(T);
+		base::m_aDescr.m_nUsed += sal_uInt16(nCount * sizeof(T));
 	}
 
 	/** Construction.
Index: store/workben/t_base.cxx
===================================================================
RCS file: /cvs/ucb/store/workben/t_base.cxx,v
retrieving revision 1.4
retrieving revision 1.4.4.1
diff -u -p -u -r1.4 -r1.4.4.1
--- store/workben/t_base.cxx	17 Jun 2004 12:50:00 -0000	1.4
+++ store/workben/t_base.cxx	25 Aug 2004 18:58:30 -0000	1.4.4.1
@@ -372,13 +372,13 @@ static storeError __store_namei (
 	return eErrCode;
 }
 
-static sal_Int32 __store_convertTextToUnicode (
+static sal_Size __store_convertTextToUnicode (
 	rtl_TextToUnicodeConverter hConvert,
-	const sal_Char *pszText, sal_Int32 nTextLen,
-	sal_Unicode    *pBuffer, sal_Int32 nBuffer)
+	const sal_Char *pszText, sal_Size nTextLen,
+	sal_Unicode    *pBuffer, sal_Size nBuffer)
 {
 	sal_uInt32 nInfo = 0;
-	sal_uInt32 nSrcLen = 0;
+	sal_Size   nSrcLen = 0;
 
 	sal_Int32 nDstLen = rtl_convertTextToUnicode (
 		hConvert, 0,
@@ -461,6 +461,7 @@ static void __store_testUnicode (const s
  *======================================================================*/
 int SAL_CALL main (int argc, char **argv)
 {
+	OSL_PRECOND(argc > 1, "t_base: error: insufficient number of arguments.");
 	if (argc < 2)
 		return 0;
 
