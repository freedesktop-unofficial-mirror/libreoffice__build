--- sch/inc/chaxis.hxx	2003-03-26 19:00:08.000000000 +0100
+++ sch/inc/chaxis.hxx	2005-01-03 14:37:35.425200340 +0100
@@ -63,7 +63,7 @@
 
 class ChartModel;
 class SvNumberFormatter;
-class SvULONGTable;
+class Svsal_uInt32Table;
 class SdrObject;
 class SdrObjList;
 class XPolygon;
@@ -408,7 +408,7 @@ public:
 	//nDir ist Flag, kann sein CHAXIS_MARK_INNER und CHAXIS_MARK_OUTER (oder beides)
 	SdrObject *CreateMarks(long nPosition,long nLen,long nWhichTicks);
 
-	BOOL TranslateMergedNumFormat( SvULONGTable* pTransTable );
+	BOOL TranslateMergedNumFormat( Svsal_uInt32Table* pTransTable );
     long GetUniqueId() const    { return mnUId; }
 
     /** Converts a CHOBJID into an axis UId.
--- sch/inc/chtmodel.hxx	2004-11-16 11:25:47.000000000 +0100
+++ sch/inc/chtmodel.hxx	2005-01-03 14:36:40.708646678 +0100
@@ -149,7 +149,7 @@ class SchModelData;
 class SchObjectId;
 class ChartAxis;
 class SvNumberFormatter;
-class SvULONGTable;
+class Svsal_uInt32Table;
 class SchItemPool;
 class SchMemChart;
 class Vector3D;
@@ -1000,7 +1000,7 @@ public:
 
 	void                SetNumberFormatter( SvNumberFormatter* );
 	void                DataRangeChanged( long _nOldRowCnt = 0, long _nOldColCnt = 0 );
-	void                TranslateAllNumFormatIds( SvULONGTable* );
+	void                TranslateAllNumFormatIds( Svsal_uInt32Table* );
 
 	/** set new doc shell if there was no one before
         returns true if new shell was set */
--- sch/inc/memchrt.hxx	2004-12-29 18:59:53.144644640 +0100
+++ sch/inc/memchrt.hxx	2005-01-04 15:57:25.881713055 +0100
@@ -301,6 +301,18 @@ public:
 
 	const long *GetRowTranslation() const { return pRowTable; }
 	const long *GetColTranslation() const { return pColTable; }
+	void SetRowTranslation( const long* pTransTable )
+	{
+		if( !pRowTable ) return;
+		for( sal_Int32 i=0; i<nRowCnt; i++ )
+			pRowTable[ i ] = pTransTable[ i ];
+	}
+	void SetColTranslation( const long* pTransTable )
+	{
+		if( !pColTable ) return;
+		for( sal_Int32 i=0; i<nColCnt; i++ )
+			pColTable[ i ] = pTransTable[ i ];
+	}
 
 #ifdef SCH_COPY_HACK
 	const long* GetRowNumFmtTable() const { return pRowNumFmtId; }
--- sch/source/core/chartdoc.cxx	2004-11-16 11:26:01.000000000 +0100
+++ sch/source/core/chartdoc.cxx	2005-01-03 14:33:36.889380585 +0100
@@ -289,7 +289,7 @@ SdrModel* ChartModel::AllocModel() const
 	// merge numberformatters
 	if( pNewModel->pOwnNumFormatter && pNumFormatter )
 	{
-		SvULONGTable* pTransTable =
+		Svsal_uInt32Table* pTransTable =
 			pNewModel->pOwnNumFormatter->MergeFormatter( *pNumFormatter );
 
 		if( pTransTable && pTransTable->Count() )
--- sch/source/core/chaxis.cxx	2003-11-24 18:37:30.000000000 +0100
+++ sch/source/core/chaxis.cxx	2005-01-03 14:38:48.039663886 +0100
@@ -2781,7 +2781,7 @@ BOOL ChartAxis::IsValueInRange( double f
 	return  ((mfMin <= fValue) && (fValue <= mfMax));	
 }
 
-BOOL ChartAxis::TranslateMergedNumFormat( SvULONGTable* pTransTable )
+BOOL ChartAxis::TranslateMergedNumFormat( Svsal_uInt32Table* pTransTable )
 {
 	ULONG nFmt, nMrgFmt;
 	BOOL bRet =FALSE;
--- sch/source/core/chtmode5.cxx	2002-09-05 15:03:07.000000000 +0200
+++ sch/source/core/chtmode5.cxx	2005-01-03 14:35:36.218780138 +0100
@@ -403,7 +403,7 @@ void ChartModel::SetChartData(SchMemChar
 				// merge old one to new one and set new one as member
 				if( pNewFormatter && pNumFormatter )
 				{
-					SvULONGTable* pTransTable =
+					Svsal_uInt32Table* pTransTable =
 						pNewFormatter->MergeFormatter( *pNumFormatter );
 
 					SetNumberFormatter( pNewFormatter );
--- sch/source/core/chtmode9.cxx	2004-12-07 14:18:40.000000000 +0100
+++ sch/source/core/chtmode9.cxx	2005-01-03 14:38:23.392919023 +0100
@@ -1910,7 +1910,7 @@ void ChartModel::SetNumberFormatter( SvN
 	}
 }
 
-void ChartModel::TranslateAllNumFormatIds( SvULONGTable* pTransTable )
+void ChartModel::TranslateAllNumFormatIds( Svsal_uInt32Table* pTransTable )
 {
 	if( pChartXAxis->TranslateMergedNumFormat( pTransTable ) &&
         nXLastNumFmt >= 0 )
--- sch/source/ui/dlg/databrws.cxx	2004-11-16 11:26:04.000000000 +0100
+++ sch/source/ui/dlg/databrws.cxx	2005-01-03 14:43:20.527618668 +0100
@@ -736,7 +736,7 @@ sal_Bool ChartDataBrowseBox::SaveModifie
         if( aText.Len() > 0 )
         {
 			SvNumberFormatter* pFormatter = m_pModel->GetNumFormatter();
-			ULONG nFormat =
+			sal_uInt32 nFormat =
 				pFormatter->GetStandardFormat( m_apMemChart->GetDataType(),
                                                LANGUAGE_SYSTEM );
 			if( ! pFormatter->IsNumberFormat( aText, nFormat, fData ))
--- sch/source/ui/dlg/tpscaley.cxx	2004-08-20 10:44:18.000000000 +0200
+++ sch/source/ui/dlg/tpscaley.cxx	2005-01-03 14:45:12.033366317 +0100
@@ -343,7 +343,7 @@ void SchScaleYAxisTabPage::Reset(const S
 
 int SchScaleYAxisTabPage::DeactivatePage(SfxItemSet* pItemSet)
 {
-	ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+	sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 	Edit* pEdit = NULL;
 	USHORT nErrStrId = 0;
 	double fDummy;
@@ -471,7 +471,7 @@ IMPL_LINK( SchScaleYAxisTabPage, HandleL
 
 void SchScaleYAxisTabPage::CheckLogs ()
 {
-	ULONG  nIndex    = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+	sal_uInt32 nIndex    = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 	Edit   *pEdit    = NULL;
 	USHORT nErrStrId = 0;
 	String aNumStr;
@@ -606,7 +606,7 @@ void SchScaleYAxisTabPage::CheckLogContr
 
 	if (aCbxLogarithm.IsChecked ())
 	{
-		ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+		sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 
 		aFmtFldOrigin.Enable (FALSE);
 		aCbxAutoOrigin.Enable (FALSE);
@@ -660,7 +660,7 @@ BOOL SchScaleYAxisTabPage::GetHelpValue 
 	}
 	else
 	{
-		ULONG nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
+		sal_uInt32 nIndex = pNumFormatter->GetStandardIndex(LANGUAGE_SYSTEM);
 		double fDummy;
 
 		fStepHelp = aFmtFldStepHelp.GetValue();
