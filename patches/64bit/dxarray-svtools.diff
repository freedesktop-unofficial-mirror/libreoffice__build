Index: svtools/source/filter.vcl/wmf/emfwr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/emfwr.cxx,v
retrieving revision 1.10
retrieving revision 1.10.16.1
diff -u -p -u -p -r1.10 -r1.10.16.1
--- svtools/source/filter.vcl/wmf/emfwr.cxx	16 Jun 2004 10:18:45 -0000	1.10
+++ svtools/source/filter.vcl/wmf/emfwr.cxx	21 Jul 2004 17:34:12 -0000	1.10.16.1
@@ -770,26 +770,26 @@ void EMFWriter::ImplWriteBmpRecord( cons
 
 // -----------------------------------------------------------------------------
 
-void EMFWriter::ImplWriteTextRecord( const Point& rPos, const String rText, const long* pDXArray, UINT32 nWidth )
+void EMFWriter::ImplWriteTextRecord( const Point& rPos, const String rText, const sal_Int32* pDXArray, sal_uInt32 nWidth )
 {
 	UINT32 nLen = rText.Len(), i;
 
 	if( nLen )
 	{
-		unsigned long nNormWidth;
-		long*		pOwnArray;
-		long*		pDX;
+		sal_uInt32	nNormWidth;
+		sal_Int32*	pOwnArray;
+		sal_Int32*	pDX;
 
 		// get text sizes
 		if( pDXArray )
 		{
 			pOwnArray = NULL;
 			nNormWidth = maVDev.GetTextWidth( rText );
-			pDX = (long*) pDXArray;
+			pDX = (sal_Int32*) pDXArray;
 		}
 		else
 		{	
-			pOwnArray = new long[ nLen ];
+			pOwnArray = new sal_Int32[ nLen ];
 			nNormWidth = maVDev.GetTextArray( rText, pOwnArray );
 			pDX = pOwnArray;
 		}
Index: svtools/source/filter.vcl/wmf/emfwr.hxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/emfwr.hxx,v
retrieving revision 1.2
retrieving revision 1.2.612.1
diff -u -p -u -p -r1.2 -r1.2.612.1
--- svtools/source/filter.vcl/wmf/emfwr.hxx	4 Jul 2002 14:58:40 -0000	1.2
+++ svtools/source/filter.vcl/wmf/emfwr.hxx	21 Jul 2004 17:34:12 -0000	1.2.612.1
@@ -115,7 +115,7 @@ private:
 	void				ImplWritePolygonRecord( const Polygon& rPoly, BOOL bClose );
 	void				ImplWritePolyPolygonRecord( const PolyPolygon& rPolyPoly );
 	void				ImplWriteBmpRecord( const Bitmap& rBmp, const Point& rPt, const Size& rSz, UINT32 nROP );
-	void				ImplWriteTextRecord( const Point& rPos, const String rText, const long* pDXArray, UINT32 nWidth );
+	void				ImplWriteTextRecord( const Point& rPos, const String rText, const sal_Int32* pDXArray, sal_uInt32 nWidth );
 
 	void				ImplWrite( const GDIMetaFile& rMtf );
 
Index: svtools/source/filter.vcl/wmf/wmfwr.cxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/wmfwr.cxx,v
retrieving revision 1.20
retrieving revision 1.19.8.3
diff -u -p -u -p -r1.20 -r1.19.8.3
--- svtools/source/filter.vcl/wmf/wmfwr.cxx	6 Jul 2004 12:12:30 -0000	1.20
+++ svtools/source/filter.vcl/wmf/wmfwr.cxx	21 Jan 2005 17:16:36 -0000	1.19.8.3
@@ -655,7 +655,7 @@ sal_Bool WMFWriter::WMFRecord_Escape_Uni
 }
 
 void WMFWriter::WMFRecord_ExtTextOut( const Point & rPoint,
-    const String & rString, const long * pDXAry )
+    const String & rString, const sal_Int32 * pDXAry )
 {
     sal_uInt16 nOriginalTextLen = rString.Len();
 
@@ -669,8 +669,8 @@ void WMFWriter::WMFRecord_ExtTextOut( co
     TrueExtTextOut(rPoint,rString,aByteString,pDXAry);
 }
 
-void WMFWriter::TrueExtTextOut( const Point & rPoint, const String & rString,
-    const ByteString & rByteString, const long * pDXAry )
+void WMFWriter::TrueExtTextOut( const Point & rPoint, const String & rString, 
+    const ByteString & rByteString, const sal_Int32 * pDXAry )
 {
 	WriteRecordHeader( 0, W_META_EXTTEXTOUT );
 	WritePointYX( rPoint );
@@ -1291,7 +1291,7 @@ void WMFWriter::WriteRecords( const GDIM
 
 					pVirDev->SetFont( aSrcFont );
 					nLen = aTemp.Len();
-					sal_Int32* pDXAry = nLen ? new long[ nLen ] : NULL;
+					sal_Int32* pDXAry = nLen ? new sal_Int32[ nLen ] : NULL;
 					nNormSize = pVirDev->GetTextArray( aTemp, pDXAry );
 					for ( i = 0; i < ( nLen - 1 ); i++ )
 						pDXAry[ i ] = pDXAry[ i ] * (sal_Int32)pA->GetWidth() / nNormSize;
Index: svtools/source/filter.vcl/wmf/wmfwr.hxx
===================================================================
RCS file: /cvs/util/svtools/source/filter.vcl/wmf/wmfwr.hxx,v
retrieving revision 1.7
retrieving revision 1.7.380.1
diff -u -p -u -p -r1.7 -r1.7.380.1
--- svtools/source/filter.vcl/wmf/wmfwr.hxx	6 Jun 2003 10:47:51 -0000	1.7
+++ svtools/source/filter.vcl/wmf/wmfwr.hxx	21 Jul 2004 17:34:12 -0000	1.7.380.1
@@ -188,11 +188,11 @@ private:
 	void WMFRecord_DeleteObject(USHORT nObjectHandle);
 	void WMFRecord_Ellipse(const Rectangle & rRect);
 	void WMFRecord_Escape( sal_uInt32 nEsc, sal_uInt32 nLen, const sal_Int8* pData );
-	sal_Bool WMFRecord_Escape_Unicode( const Point& rPoint, const String& rStr, const long * pDXAry );
-	void WMFRecord_ExtTextOut(const Point & rPoint, const String & rString, const long * pDXAry);
+	sal_Bool WMFRecord_Escape_Unicode( const Point& rPoint, const String& rStr, const sal_Int32 * pDXAry );
+	void WMFRecord_ExtTextOut(const Point & rPoint, const String & rString, const sal_Int32 * pDXAry);
 
     void TrueExtTextOut(const Point & rPoint, const String & rString, 
-        const ByteString & rByteString, const long * pDXAry);
+        const ByteString & rByteString, const sal_Int32 * pDXAry);
     void TrueTextOut(const Point & rPoint, const ByteString& rString);
 	void WMFRecord_LineTo(const Point & rPoint);
 	void WMFRecord_MoveTo(const Point & rPoint);
