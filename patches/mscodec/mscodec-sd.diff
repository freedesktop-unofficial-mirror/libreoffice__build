Index: sd/source/filter/sdpptwrp.cxx
===================================================================
RCS file: /cvs/graphics/sd/source/filter/sdpptwrp.cxx,v
retrieving revision 1.9
retrieving revision 1.9.112.1
diff -u -r1.9 -r1.9.112.1
--- sd/source/filter/sdpptwrp.cxx	3 Feb 2004 20:11:04 -0000	1.9
+++ sd/source/filter/sdpptwrp.cxx	2 Jun 2004 13:39:01 -0000	1.9.112.1
@@ -65,6 +65,7 @@
 #include <sfx2/interno.hxx>
 #include <svx/msoleexp.hxx>
 #include <svx/svxmsbas.hxx>
+#include <svx/svxerr.hxx>
 #include <svtools/fltrcfg.hxx>
 
 #include "sdpptwrp.hxx"
@@ -145,7 +146,12 @@
 			aTracer.StartTracing();
 			SdPPTImport* pImport = new SdPPTImport( &mrDocument, *pDocStream, *pStorage, mrMedium, &aTracer );
 			if ( !( bRet = pImport->Import() ) )
-				mrMedium.SetError( SVSTREAM_WRONGVERSION );
+			{
+				if ( pStorage->IsStream( String( RTL_CONSTASCII_USTRINGPARAM("EncryptedSummary") ) ) )
+					mrMedium.SetError( ERRCODE_SVX_READ_FILTER_PPOINT );
+				else
+					mrMedium.SetError( SVSTREAM_WRONGVERSION );
+			}
 			aTracer.EndTracing();
 			delete pImport;
 			delete pDocStream;
