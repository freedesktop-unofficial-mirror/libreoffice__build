--- ../openoffice/build/OOO_1_1_3_fix2/sd/source/filter/sdpptwrp.cxx	2004-07-21 19:21:33.000000000 +0100
+++ sd/source/filter/sdpptwrp.cxx	2004-09-02 13:14:43.823383416 +0100
@@ -65,6 +65,7 @@
 #include <sfx2/interno.hxx>
 #include <svx/msoleexp.hxx>
 #include <svx/svxmsbas.hxx>
+#include <svx/svxerr.hxx>
 #include <offmgr/app.hxx>
 #include <offmgr/fltrcfg.hxx>
 
@@ -145,7 +146,12 @@
 			aTracer.StartTracing();
 			SdPPTImport* pImport = new SdPPTImport( &mrDocument, *pDocStream, *pStorage, mrMedium, &aTracer );
 			if ( !( bRet = pImport->Import() ) )
-				mrMedium.SetError( SVSTREAM_WRONGVERSION );
+			{
+ 				if ( pStorage->IsStream( String( RTL_CONSTASCII_USTRINGPARAM("EncryptedSummary") ) ) )
+ 					mrMedium.SetError( ERRCODE_SVX_READ_FILTER_PPOINT );
+ 				else
+ 					mrMedium.SetError( SVSTREAM_WRONGVERSION );
+			}
 			if ( aTracer.IsEnabled() )
 			{
 				sal_Int32 nCount = 0;
