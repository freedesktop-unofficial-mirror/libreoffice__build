--- glib-1.2.10/makefile.msc	Thu Mar 15 17:48:49 2001
+++ glib-1.2.10/makefile.msc	Fri Oct 14 12:30:05 2005
@@ -1,16 +1,13 @@
-## Makefile for building the GLib, gmodule and gthread dlls with Microsoft C
+## Makefile for building the GLib and gmodule dlls with Microsoft C
 ## Use: nmake -f makefile.msc install
+# THREAD SUPPORT HAS BEEN HACKED OUT
 
 # Change this to wherever you want to install the DLLs. This directory
 # should be in your PATH.
-BIN = C:\bin
-
-# This is the location of pthreads for Win32, 
-# see http://sourceware.cygnus.com/pthreads-win32/
-# We want the 1999-04-07 snapshot.
-PTHREADS = ..\pthreads-snap-1999-04-07
-PTHREAD_LIB = $(PTHREADS)\pthread.lib
-PTHREAD_INC = -I$(PTHREADS)
+PREFIX=.
+BIN = $(PREFIX)\bin
+LIBDIR = $(PREFIX)\lib
+INCDIR = $(PREFIX)\include
 
 ################################################################
 
@@ -33,17 +30,18 @@
 	glib-$(GLIB_VER).dll	\
 	gmodule\gmoduleconf.h \
 	gmodule-$(GLIB_VER).dll	\
-	gthread-$(GLIB_VER).dll \
 	testglib.exe	\
 	testgmodule.exe	\
 	testgdate.exe	\
 	testgdateparser.exe \
-	testgthread.exe
 
 install : all
 	$(INSTALL) glib-$(GLIB_VER).dll $(BIN)
 	$(INSTALL) gmodule-$(GLIB_VER).dll $(BIN)
-	$(INSTALL) gthread-$(GLIB_VER).dll $(BIN)
+	$(INSTALL) glib-$(GLIB_VER).lib $(LIBDIR)
+	$(INSTALL) gmodule-$(GLIB_VER).lib $(LIBDIR)
+	$(INSTALL) glib.h $(INCDIR)
+	$(INSTALL) glibconfig.h $(INCDIR)
 
 glib_OBJECTS = \
 	garray.obj	\
@@ -96,15 +94,6 @@
 gmodule\gmoduleconf.h: gmodule\gmoduleconf.h.win32
 	copy gmodule\gmoduleconf.h.win32 gmodule\gmoduleconf.h
 
-gthread_OBJECTS = \
-	gthread.obj
-
-gthread-$(GLIB_VER).dll : $(gthread_OBJECTS)
-	$(CC) $(CFLAGS) -LD -Fegthread-$(GLIB_VER).dll $(gthread_OBJECTS) glib-$(GLIB_VER).lib $(PTHREAD_LIB) glib-$(GLIB_VER).lib $(LDFLAGS) /def:gthread\gthread.def
-
-gthread.obj : gthread\gthread.c gthread\gthread-posix.c
-	$(CC) $(CFLAGS) -GD $(PTHREAD_INC) -DG_LOG_DOMAIN=\"GThread\" -c gthread\gthread.c
-
 testglib.exe : glib-$(GLIB_VER).dll testglib.obj
 	$(CC) $(CFLAGS) -Fetestglib.exe testglib.obj glib-$(GLIB_VER).lib $(LDFLAGS) /subsystem:console
 
@@ -141,25 +130,19 @@
 libgplugin_b.obj : gmodule\libgplugin_b.c
 	$(CC) $(CFLAGS) -Igmodule -c gmodule\libgplugin_b.c
 
-testgthread.exe : glib-$(GLIB_VER).dll gthread-$(GLIB_VER).dll testgthread.obj
-	$(CC) $(CFLAGS) testgthread.obj glib-$(GLIB_VER).lib gthread-$(GLIB_VER).lib $(PTHREAD_LIB) $(LDFLAGS) /subsystem:console 
-
-testgthread.obj : gthread\testgthread.c
-	$(CC) $(CFLAGS) $(PTHREAD_INC) -c gthread\testgthread.c
-
 clean:
-	del config.h
-	del glibconfig.h
-	del gmodule\gmoduleconf.h
-	del *.exe
-	del *.obj
-	del *.dll
-	del *.lib
-	del *.err
-	del *.map
-	del *.sym
-	del *.exp
-	del *.lk1
-	del *.mk1
-	del *.pdb
-	del *.ilk
+	-del config.h
+	-del glibconfig.h
+	-del gmodule\gmoduleconf.h
+	-del *.exe
+	-del *.obj
+	-del *.dll
+	-del *.lib
+	-del *.err
+	-del *.map
+	-del *.sym
+	-del *.exp
+	-del *.lk1
+	-del *.mk1
+	-del *.pdb
+	-del *.ilk
