#!/bin/bash
#
# Wrapper for git to handle more subdirs at the same time
#

# no params, no action
if [ "$#" -eq "0" ] ; then
    git
    exit $?
fi

# extra params for some commands, like log
EXTRA=
PAGER=
COMMAND="$1"
shift

case "$COMMAND" in
    log) EXTRA='-1'
	 PAGER='--no-pager'
	 ;;
esac

# do it!
for dir in * ; do
    if [ -d "$dir" -a -d "$dir"/.git ] ; then
	(
	    echo "===== $dir ====="
	    cd $dir
	    git $PAGER "$COMMAND" $EXTRA "$@" || exit $?
	) || exit $?
    fi
done
