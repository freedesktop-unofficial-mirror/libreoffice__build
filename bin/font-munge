#!/usr/bin/perl -pi.bak -w

# This does a partial substitution of the really
# mechanical bits of our fonts.

    # make sure that the MS compatible fonts like Albany, Arial are preferred
    # over the Bitstream Vera fonts

    s/(Bitstream Vera Sans;.*)Albany;/Albany;$1/;
    s/(Bitstream Vera Sans;.*)Arial;/Arial;$1/;
    s/(Bitstream Vera Sans Mono;.*)Cumberland;/Cumberland;$1/;
    s/(Bitstream Vera Sans Mono;.*)Courier New;/Courier New;$1/;
    s/(Bitstream Vera Serif;.*)Thorndale;/Thorndale;$1/;
    s/(Bitstream Vera Serif;.*)Times New Roman;/Times New Roman;$1/;

    # add AMT fonts
    s/Albany;/Albany AMT;Albany;/g;
    s/albany;/albanyamt;albany;/g;
    s/Thorndale;/Thorndale AMT;Thorndale;/g;
    s/thorndale;/thorndaleamt;thorndale;/g;
    s/Cumberland;/Cumberland AMT;Cumberland;/g;
    s/cumberland;/cumberlandamt;cumberland;/g;
    s/comicsansms;/andymt;comicsansms;/g;
    s/kidprint;/andy;kidprint;/g;

# New bits from SUSE:

    # add Nimbus fonts
    s/Arial;/Arial;Nimbus Sans L;/g;
    s/arial;/arial;nimbussansl;/g;
    s/Times New Roman;/Times New Roman;Nimbus Roman No9 L;/g;
    s/timesnewroman;/timesnewroman;nimbusromanno9l;/g;
    s/Courier New;/Courier New;Nimbus Mono L;/g;
    s/couriernew;/couriernew;nimbusmonol;/g;

    # prune duplicates
    s/nimbussansl;\(.*\)nimbussansl;/nimbussansl;$1/;
    s/nimbusmonol;\(.*\)nimbusmonol;/nimbusmonol;$1/;
    s/nimbusromanno9l;\(.*\)nimbusromanno9l;/nimbusromanno9l;$1/;

# Some RedHat CJK bits

    # Backups for Sung Ti
    s/方正宋体;/方正宋体;ZYSong18030;AR PL SungtiL GB;/g;
    # Backups for Ming Ti
    s/方正明體;/方正明體;AR PL Mingti2L Big5;/g;

    # Korean fixes
    s/SunGulim;/SunGulim;Baekmuk Gulim;/g;
    s/SunBatang;/SunBatang;Baekmuk Batang;/g;
    s/SunDotum;/SunDotum;Baekmuk Dotum;/g;

    # The bitstream fonts never make sense _at all_ they are so metrically odd.
    s/Bitstream Vera Sans;//g;
    s/Bitstream Vera Sans Mono;//g;
    s/Bitstream Vera Serif;//g;

# Some Ubuntu bits

    # push SansSerif to the end of the list, some Tamil fonts don't
    # have all ISO-8859-1 characters defined
    s/SansSerif;(.*)</$1;SansSerif</;

    if ($ENV{OOO_VENDOR} =~ /Ubuntu/) {
      # prefer DejaVu as UI font
      if ($uisans) { s/<value>/<value>DejaVuSans;/; };
      if (/UI_SANS/) { $uisans = 1; } else { $uisans = 0; };
      if ($uifixed) { s/<value>/<value>DejaVuMonoSans;/; };
      if (/UI_FIXED/) { $uifixed = 1; } else { $uifixed = 0; };

      # prefer DejaVu for the Help
      if ($helpsans) { s/font-family: */font-family: DejaVuSans,/; };
      if (/^body/) { $helpsans = 1; } else { $helpsans = 0; };
      if ($helpfixed) { s/font-family: */font-family: DejaVuMonoSans,/; };
      if (/^\.code/) { $helpfixed = 1; } else { $helpfixed = 0; };
    };
