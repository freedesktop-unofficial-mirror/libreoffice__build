#!/bin/bash

piece=$1
ooo_build_tag=$2

source $OO_TOOLSDIR/piece/sys-setup

# generate the common file list
$OO_TOOLSDIR/piece/merge-file-lists "files-$piece.txt" $DESTDIR/gid_*
# install the common main_transform.xsl for the helpcontent
mkdir -p $DESTDIR$OO_INSTDIR/basis$VERSION/help
cp -a $OO_TOOLSDIR/../src/main_transform.xsl $DESTDIR$OO_INSTDIR/basis$VERSION/help
echo "%dir $OO_INSTDIR/basis$VERSION/help" >>files-$piece.txt
echo "$OO_INSTDIR/basis$VERSION/help/main_transform.xsl" >>files-$piece.txt

# prune redundant files the scp2 likes to make for us
remove_file "files-$piece.txt" "$OO_INSTDIR/basis-link"
remove_file "files-$piece.txt" "$OO_INSTDIR/basis$VERSION/ure-link"
remove_dir  "files-$piece.txt" "$OO_INSTDIR/ure"

# move the stuff to /usr/share when enabled
if test "$OOO_BUILD_NOARCH" = 'YES' ; then
    $OO_TOOLSDIR/piece/install-l10n-helper $piece $ooo_build_tag "$DESTDIR" files-$piece.txt
    $OO_TOOLSDIR/piece/install-devel-helper $piece $ooo_build_tag
fi
