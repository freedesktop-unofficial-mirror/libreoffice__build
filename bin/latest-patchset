#!/usr/bin/perl -w

$dir = shift (@ARGV) || die "pass path to patches directory";
@entries = ();

$require_buildable = 1;

while ($param = shift (@ARGV)) {
    if ($param eq '--devel') {
	$require_buildable = 0;
    }
}

opendir(Dir, $dir) || die "Can't open $dir";
while ($a = readdir(Dir)) {
    $a =~ /\_(\d+)/ || next;
    push @entries, $a;
}
closedir(Dir);

@recent = sort { ($b =~ /\_(\d+)/)[0] <=> ($a =~ /\_(\d+)/)[0] } @entries;

for $a (@recent) {
    $require_buildable && !-f "$dir/$a/buildable" && next;
    print $a;
    exit 0;
}
print STDERR "Can't find latest buildable set";
print $recent[0];
exit 1;
