#!/usr/bin/perl -w

$dir = shift (@ARGV) || die "pass path to patches directory";

$require_buildable = 1;

while ($param = shift (@ARGV)) {
    if ($param eq '--devel') {
	$require_buildable = 0;
    }
}

my $name = '';

open(Order, "$dir/order") || die "Can't find $dir/order";
while (<Order>) {
    s/\s*#.*//;
    s/\s*(\S+)\s+(\S+)// || next;
    $name = $1;
    my $version = $2;
    my $buildable = m/build/i;

#    print "Name: '$name', Version '$version' [$buildable]\n";
    $require_buildable && !$buildable && next;
    last;
}
close(Order);

print "$name";
if ($name eq '') {
    print STDERR "Can't find latest buildable set";
    exit 1;
}
