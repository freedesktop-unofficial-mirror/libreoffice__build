#!/bin/sh


DICTDIR=$OOINSTDIR/share/dict/ooo

if (! test -d $DICTDIR); then
    echo "Cannot find $DICTDIR; make sure you installed OOo first"
    exit 1;
fi


# the available dictionaries
DICTS="hyph_cs_CZ
	hyph_es_ES
	hyph_fi_FI
	hyph_fr_FR
	hyph_ga_IE
	hyph_hu_HU
	hyph_is_IS
	hyph_it_IT
	hyph_lt_LT
	hyph_nl_NL
	hyph_pl_PL
	hyph_pt_PT
	hyph_sk_SK
	hyph_sv_SE
	hyph_uk_UA
	thes_cs_CZ
	thes_de_DE"

for DICT in $DICTS ; do
  if test -f $SRCDIR/$DICT.tar.bz2 ; then
    echo "Unpacking $DICT dictionary..."
    mkdir -m 755 -p $DOCDIR/dictionaries
    TMPDIR=`mktemp -d /tmp/ooo-build.dict.XXXXXX`
    tar -xjf $SRCDIR/$DICT.tar.bz2 -C $TMPDIR || exit 1;
    chmod 644 $TMPDIR/*.* || exit 1;
    
    DICTNAME=${DICT/thes/th}

    test -f $TMPDIR/$DICTNAME.dic && mv $TMPDIR/$DICTNAME.dic $DICTDIR/
    test -f $TMPDIR/$DICTNAME.dat && mv $TMPDIR/$DICTNAME.dat $DICTDIR/
    test -f $TMPDIR/$DICTNAME.idx && mv $TMPDIR/$DICTNAME.idx $DICTDIR/
    mv $TMPDIR/*.* $DOCDIR/dictionaries || exit 1;
    rmdir $TMPDIR || exit 1; 
  else
    echo "Warning: $DICT dictionary is not available..."
  fi
done

echo "Creating dictionary.lst..."
cd $DICTDIR
> dictionary.lst

# Dictionaries
for i in *.aff; do
    # does any exist?
    if test "z$i" != 'z*.aff' ; then
	LANGUAGE=`echo $i | cut -b1-2`
	COUNTRY=`echo $i | cut -b4-5`
	FULL=`echo $i | cut -b1-5`

	echo "DICT $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
    fi
done

# Hyphenation tables
for i in hyph*.dic; do
    # does any exist?
    if test "z$i" != 'zhyph*.dic' ; then
	LANGUAGE=`echo $i | cut -b6-7`
	COUNTRY=`echo $i | cut -b9-10`
	FULL=`echo $i | cut -b6-10`

	echo "HYPH $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
    fi
done

# Thesauruses
for i in th*.dat; do
    # does any exist?
    if test "z$i" != 'zth*.dat' ; then
	LANGUAGE=`echo $i | cut -b4-5`
	COUNTRY=`echo $i | cut -b7-8`
	FULL=`echo $i | cut -b1-8`

	echo "THES $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
    fi
done
