#!/bin/sh

# See setup for user tweakables.
#
. ./setup

if test "z$2" = "z--force"; then
    FORCE=1
else
    FORCE=0
fi

if (! test -d $SRCDIR); then
    echo "Cannot find $SRCDIR; make sure you already ran build-ooo"
    exit 1;
fi

DICTDIR=$OOINSTDIR/share/dict/ooo

if (! test -d $DICTDIR); then
    echo "Cannot find $DICTDIR; make sure you installed OOo first"
    exit 1;
fi

cd $SRCDIR

DICTIONARIES="			\
    ooo-dict-bg_BG.zip		\
    ooo-dict-ca_ES.zip		\
    ooo-dict-cs_CZ.zip		\
    ooo-dict-da_DK.zip		\
    ooo-dict-de_CH.zip		\
    ooo-dict-de_DE.zip		\
    ooo-dict-el_GR-enhanced.zip	\
    ooo-dict-en_AU.zip		\
    ooo-dict-en_CA.zip		\
    ooo-dict-en_GB.zip		\
    ooo-dict-es_ES.zip		\
    ooo-dict-fr_FR.zip		\
    ooo-dict-ga_IE.zip		\
    ooo-dict-gl_ES.zip		\
    ooo-dict-hr_HR.zip		\
    ooo-dict-hu_HU.zip		\
    ooo-dict-it_IT.zip		\
    ooo-dict-lt_LT.zip		\
    ooo-dict-nb_NO.zip		\
    ooo-dict-nl_NL.zip		\
    ooo-dict-nn_NO.zip		\
    ooo-dict-pl_PL.zip		\
    ooo-dict-pt_BR.zip		\
    ooo-dict-pt_PT.zip		\
    ooo-dict-ru_RU_yo.zip	\
    ooo-dict-sk_SK.zip		\
    ooo-dict-sl_SI.zip		\
    ooo-dict-sv_SE.zip		\
    ooo-dict-uk_UA.zip		\
    ooo-hyph_cs.zip		\
    ooo-hyph_de_CH.zip		\
    ooo-hyph_en_CA.zip		\
    ooo-hyph_en_GB.zip		\
    ooo-hyph_es.zip		\
    ooo-hyph_fr.zip		\
    ooo-hyph_it.zip		\
    ooo-hyph_nl.zip		\
    ooo-hyph_pt_BR.zip		\
    ooo-hyph_pt_PT.zip		\
    ooo-hyph_sk.zip		\
    ooo-hyph_sl.zip		\
    ooo-hyph_uk.zip		\
    ooo-thes-de_DE.zip		\
"

echo "Getting dictionary sources..."
for i in $DICTIONARIES; do
    if (test $FORCE = 1) || (! test -f $i); then
	bb_get $i-1
    fi
done

echo "Unpacking dictionaries..."
for i in $DICTIONARIES; do
    unzip -o -d $DICTDIR -j $i '*.dic' '*.aff' '*.dat' '*.idx'
done

echo "Creating dictionary.lst..."
cd $DICTDIR
> dictionary.lst

# Dictionaries
for i in *.aff; do
    LANGUAGE=`echo $i | cut -b1-2`
    COUNTRY=`echo $i | cut -b4-5`
    FULL=`echo $i | cut -b1-5`

    echo "DICT $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
done

# Hyphenation tables
for i in hyph*.dic; do
    LANGUAGE=`echo $i | cut -b6-7`
    COUNTRY=`echo $i | cut -b9-10`
    FULL=`echo $i | cut -b6-10`

    echo "HYPH $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
done

# Thesauruses
for i in th*.dat; do
    LANGUAGE=`echo $i | cut -b4-5`
    COUNTRY=`echo $i | cut -b7-8`
    FULL=`echo $i | cut -b1-8`

    echo "THES $LANGUAGE $COUNTRY $FULL" >> dictionary.lst
done
