#!/usr/bin/perl -w

my $install_user = 0;
# install dir in /
my $installdir='@OOINSTBASE@';
# user dir in ~
my $home_dir='.ooo-2.0';

# debugging
if ($installdir =~ /^\@/) {
    $installdir = $ENV{OOINSTBASE};
    $installdir = '/usr/lib/ooo-2.0' if (!$installdir);
}

sub print_help_and_exit()
{
    print "ooinstalltemplate [--user] <path-to-template>...\n";
    print "  --user - install in the user's directory not the system\n";
    exit (0);
}

my @files = ();

for my $arg (@ARGV) {
    if ($arg eq '--user') {
	$install_user = 1;
    } elsif ($arg eq '-h' || $arg eq '--help') {
	print_help_and_exit ();
    } else {
	push @files, $arg;
    }
}

@files || print_help_and_exit();

my $dest;
if ($install_user) {
    my $home_dir = ".ooo-2.0";
    print STDERR "Warning: hard-coded home path\n";
    $dest = $ENV{HOME} . $home_dir . "/user/template";
    `mkdir -p $dest`;
} else {
    print STDERR "Warning: nightmarish i18n-path\n";
    $dest = $installdir . "/share/template/en-US";
}

for my $file (@files) {
    `cp $file $dest` && die "Failed to copy $file to $dest: $!";
}
